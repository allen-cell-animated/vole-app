"use strict";(self.webpackChunk_aics_vole_app=self.webpackChunk_aics_vole_app||[]).push([[591],{4850:(e,t,n)=>{n.d(t,{A:()=>s});class s{constructor(e){this.dataMinBin=0,this.dataMaxBin=0,this.maxBin=0,this.bins=new Uint32Array,this.min=0,this.max=0,this.binSize=0;const t=s.calculateHistogram(e,256);this.bins=t.bins,this.min=t.min,this.max=t.max,this.binSize=t.binSize;for(let e=0;e<this.bins.length;e++)if(this.bins[e]>0){this.dataMinBin=e;break}for(let e=this.bins.length-1;e>=0;e--)if(this.bins[e]>0){this.dataMaxBin=e;break}this.pixelCount=e.length,this.maxBin=1;let n=this.bins[1];for(let e=1;e<this.bins.length;e++)this.bins[e]>n&&(this.maxBin=e,n=this.bins[e])}static findBin(e,t,n,s){let r=Math.floor((e-t)/n);return r===s&&r--,r}findBinOfValue(e){return s.findBin(e,this.min,this.binSize,256)}getDataMin(){return this.min}getDataMax(){return this.max}getMin(){return this.dataMinBin}getMax(){return this.dataMaxBin}getNumBins(){return this.bins.length}getBin(e){return this.bins[e]}getBinRange(e){return[this.min+e*this.binSize,this.min+(e+1)*this.binSize]}findBinOfPercentile(e){const t=this.pixelCount*e;let n=0,s=0;for(n=0;n<this.bins.length&&(s+=this.bins[n],!(s>t));++n);return n}findBestFitBins(){const e=this.pixelCount/10;let t=0,n=0;for(t=1;t<this.bins.length&&(n+=this.bins[t],!(n>e));++t);const s=t;for(n=0,t=this.bins.length-1;t>=1&&(n+=this.bins[t],!(n>e));--t);return[s,t]}findAutoIJBins(){const e=this.pixelCount,t=e/10,n=e/5e3;let s=this.bins.length-1,r=1;for(let e=1;e<this.bins.length;++e)if(this.bins[e]>n&&this.bins[e]<=t){s=e;break}for(let e=this.bins.length-1;e>=1;--e)if(this.bins[e]>n&&this.bins[e]<=t){r=e;break}return r<s&&(s=0,r=255),[s,r]}findAutoMinMax(){const e=Math.floor(.1*this.bins[this.maxBin]);let t=0,n=this.bins.length-1;for(let n=1;n<this.bins.length;++n)if(this.bins[n]>e){t=n;break}for(let t=this.bins.length-1;t>=1;--t)if(this.bins[t]>e){n=t;break}return[t,n]}static calculateHistogram(e,t=1){t<1&&(t=1);let n=e[0],r=e[0];for(let t=1;t<e.length;t++)e[t]<n?n=e[t]:e[t]>r&&(r=e[t]);const i=new Uint32Array(t).fill(0),a=(r-n)/t==0?1:(r-n)/t;for(let r=0;r<e.length;r++){const o=e[r];i[s.findBin(o,n,a,t)]++}return{bins:i,min:n,max:r,binSize:a}}}},9519:(e,t,n)=>{n.d(t,{Nl:()=>a,QX:()=>o,jI:()=>i});var s=n(4922);function r(e){return new s.Pq0(e.shape[4],e.shape[3],e.shape[2])}function i(){return{name:"",atlasTileDims:[1,1],subregionSize:[1,1,1],subregionOffset:[0,0,0],combinedNumChannels:1,channelNames:["0"],channelColors:[[255,255,255]],multiscaleLevel:0,multiscaleLevelDims:[{shape:[1,1,1,1,1],spacing:[1,1,1,1,1],spaceUnit:"",timeUnit:"",dataType:"uint8"}],transform:{translation:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}}}class a{constructor(e){this.imageInfo=e||{name:"",atlasTileDims:[1,1],subregionSize:[1,1,1],subregionOffset:[0,0,0],combinedNumChannels:1,channelNames:["0"],channelColors:[[255,255,255]],multiscaleLevel:0,multiscaleLevelDims:[{shape:[1,1,1,1,1],spacing:[1,1,1,1,1],spaceUnit:"",timeUnit:"",dataType:"uint8"}],transform:{translation:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}}}get currentLevelDims(){return this.imageInfo.multiscaleLevelDims[this.imageInfo.multiscaleLevel]}get numChannels(){return this.imageInfo.combinedNumChannels}get originalSize(){return r(this.imageInfo.multiscaleLevelDims[0])}get volumeSize(){return r(this.currentLevelDims)}get physicalPixelSize(){return e=this.imageInfo.multiscaleLevelDims[0],new s.Pq0(e.spacing[4],e.spacing[3],e.spacing[2]);var e}get spatialUnit(){return this.imageInfo.multiscaleLevelDims[0].spaceUnit}get times(){return this.currentLevelDims.shape[0]}get timeScale(){return this.currentLevelDims.spacing[0]}get timeUnit(){return this.currentLevelDims.timeUnit}get numMultiscaleLevels(){return this.imageInfo.multiscaleLevelDims.length}get channelNames(){return this.imageInfo.channelNames}get channelColors(){return this.imageInfo.channelColors}get subregionSize(){return new s.Pq0(...this.imageInfo.subregionSize)}get subregionOffset(){return new s.Pq0(...this.imageInfo.subregionOffset)}get multiscaleLevel(){return this.imageInfo.multiscaleLevel}get atlasTileDims(){return new s.I9Y(...this.imageInfo.atlasTileDims)}get transform(){return{translation:new s.Pq0(...this.imageInfo.transform.translation),rotation:new s.Pq0(...this.imageInfo.transform.rotation),scale:new s.Pq0(...this.imageInfo.transform.scale)}}}function o(e){const{atlasTileDims:t}=e,n=e.multiscaleLevelDims[e.multiscaleLevel];return[t[0]*n.shape[4],t[1]*n.shape[3]]}},3487:(e,t,n)=>{n.d(t,{A:()=>o});const s=e=>e.every((t=>t===e[0])),r=(e,t,n)=>{for(let s=0;s<n;s++)e.push(t)},i=e=>{const t=e>>1;return t+Number(0!==t)};function a(e,t){e<t[0]&&(t[0]=e),e>t[1]&&(t[1]=e)}class o{constructor(e,t,n,o,u=!1){const c=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]];for(const t of e)a(t[0],c[0]),a(t[2],c[1]),a(t[3],c[2]),a(t[4],c[3]);if(c.flat().some((e=>!Number.isFinite(e))))return this.directionStates=[],void(this.priorityDirectionStates=[]);this.directionStates=[],this.priorityDirectionStates=[];for(const[e,i]of c.flat().entries()){const a=e>>1,c=a+Number(0!==a);let h;if(1&e){const e=n.map((e=>Math.min(i+t[a],e[c]-1)));if(s(e))h=e[0];else{h=[];for(const[t,s]of e.entries())r(h,s,n[t][1])}}else h=Math.max(i-t[a],0);const l={direction:e,start:i,end:h,chunks:[]};o&&o.includes(e)?this.priorityDirectionStates.push(l):u||this.directionStates.push(l)}for(const t of e){for(const e of this.directionStates)t[i(e.direction)]===e.start&&e.chunks.push(t);for(const e of this.priorityDirectionStates)t[i(e.direction)]===e.start&&e.chunks.push(t)}}static*iterateDirections(e){let t=1;for(;e.length>0;){e=e.filter((e=>{const n=Array.isArray(e.end)?Math.max(...e.end):e.end;return 1&e.direction?e.start+t<=n:e.start-t>=n}));for(const n of e){const e=t*(1&n.direction?1:-1);for(const t of n.chunks){if(Array.isArray(n.end)&&t[i(n.direction)]+e>n.end[t[1]])continue;const s=t.slice();s[i(n.direction)]+=e,yield s}}t+=1}}*[Symbol.iterator](){if(this.priorityDirectionStates.length>0)for(const e of o.iterateDirections(this.priorityDirectionStates))yield e;for(const e of o.iterateDirections(this.directionStates))yield e}}},7710:(e,t,n)=>{n.d(t,{Di:()=>r,U0:()=>a,WD:()=>o,X_:()=>c,mU:()=>f,yH:()=>u});var s=n(471);function r(e){if(e.omeroMetadata?.channels)return e.omeroMetadata.channels.map((({label:t},n)=>t??`Channel ${n+e.channelOffset}`));const t=e.axesTCZYX[1],n=t<0?1:e.scaleLevels[0].shape[t];return Array.from({length:n},((t,n)=>`Channel ${n+e.channelOffset}`))}const i=([e,t,n])=>2+Number(e>-1)+Number(t>-1)+Number(n>-1);function a(e){const t=[-1,-1,-1,-1,-1],n=["t","c","z","y","x"];e.forEach(((e,r)=>{const i=n.indexOf(e.name);if(!(i>-1))throw new s.nu(`Unrecognized axis in zarr: ${e.name}`,{type:s.f8.INVALID_METADATA});t[i]=r}));const r=-1===t[4];if(r||-1===t[3])throw new s.nu(`Did not find ${r?"an X":"a Y"} axis in zarr`,{type:s.f8.INVALID_METADATA});return t}function o(e,t){const n=i(t),r=Array(n);return t.forEach(((t,i)=>{if(t>=0){if(t>=n)throw new s.nu(`Unexpected axis index in zarr: ${t}`,{type:s.f8.INVALID_METADATA});r[t]=e[i]}})),r}function u(e,t,n){const r=[n,n,n,n,n];return t.forEach(((t,n)=>{if(t>=0){if(t>=e.length)throw new s.nu(`Unexpected axis index in zarr: ${t}`,{type:s.f8.INVALID_METADATA});r[n]=e[t]}})),r}function c(e,t){const n=e.coordinateTransformations;if(void 0===n)return console.warn("WARNING: OMEZarrLoader: no coordinate transformations for scale level."),[1,1,1,1,1];const s=n.find((e=>"scale"===e.type));return s?u(s.scale.slice(),t,1):(console.warn('WARNING: OMEZarrLoader: no coordinate transformation of type "scale" for scale level.'),[1,1,1,1,1])}function h(e,t,n,s){const r=(t[2]>-1?e.shape[t[2]]:1)-(s[2]>-1?n.shape[s[2]]:1),i=e.shape[t[3]]-n.shape[s[3]],a=e.shape[t[4]]-n.shape[s[4]];return 0===r&&0===i&&0===a?0:r<=0&&i<=0&&a<=0?-1:r>=0&&i>=0&&a>=0?1:void 0}const l=(e,t)=>Math.abs(e-t)<1e-5;function d(e,t,n,s){const r=c(e.multiscaleMetadata.datasets[t],e.axesTCZYX),i=c(n.multiscaleMetadata.datasets[s],n.axesTCZYX);return l(r[2],i[2])&&l(r[3],i[3])&&l(r[4],i[4])}function f(e){if(e.length<2)return;const t=Array.from({length:e.length},(()=>[])),n=Array.from({length:e.length},(()=>[])),r=new Array(e.length).fill(0);for(;r.every(((t,n)=>t<e[n].scaleLevels.length));){let i=!0,a=0,o=e[0],u=o.scaleLevels[r[0]];for(let t=1;t<e.length;t++){const n=e[t],c=n.scaleLevels[r[t]],l=h(u,o.axesTCZYX,c,n.axesTCZYX);if(l)i=!1,l>0&&(a=t,o=n,u=c);else{if(void 0===l)throw new s.nu("Incompatible zarr arrays: pixel dimensions are mismatched",{type:s.f8.INVALID_MULTI_SOURCE_ZARR});d(o,r[a],n,r[t])||console.warn("Incompatible zarr arrays: scale levels of equal size have different scale transformations");const e=o.axesTCZYX[0]>-1?u.shape[o.axesTCZYX[0]]:1,i=n.axesTCZYX[0]>-1?c.shape[n.axesTCZYX[0]]:1;e!==i&&console.warn(`Incompatible zarr arrays: different numbers of timesteps: ${e} vs ${i}`)}}if(i)for(let s=0;s<r.length;s++){const i=e[s],a=r[s];t[s].push(i.scaleLevels[a]),n[s].push(i.multiscaleMetadata.datasets[a]),r[s]+=1}else for(const[t,n]of r.entries()){const s=e[t],i=s.scaleLevels[n];0!==h(u,o.axesTCZYX,i,s.axesTCZYX)&&(r[t]+=1)}}if(0===e[0].scaleLevels.length)throw new s.nu("Incompatible zarr arrays: no sets of scale levels found that matched in all sources",{type:s.f8.INVALID_MULTI_SOURCE_ZARR});for(let s=0;s<e.length;s++)e[s].scaleLevels=t[s],e[s].multiscaleMetadata.datasets=n[s]}},4296:(e,t,n)=>{n.d(t,{GB:()=>c,P9:()=>r,iM:()=>u});var s=n(471);const r=e=>e.ome??e;function i(e,t){return"object"==typeof e&&null!==e&&t in e}function a(e,t,n="zarr"){if(!i(e,t))throw new s.nu(`${n} metadata is missing required entry "${t}"`,{type:s.f8.INVALID_METADATA})}function o(e,t,n="zarr"){if(!Array.isArray(e[t]))throw new s.nu(`${n} metadata entry "${t}" is not an array`,{type:s.f8.INVALID_METADATA})}function u(e,t="zarr"){a(e,"multiscales",t),o(e,"multiscales",t)}function c(e,t=0,n="zarr"){const r=e.multiscales[t];if(!r)throw new s.nu(`${n} metadata does not have requested multiscale level ${t}`,{type:s.f8.INVALID_METADATA});const u=`${n} multiscale ${t}${i(r,"name")?` ("${r.name})`:""}`;a(r,"axes",u),o(r,"axes",u),r.axes.forEach(((e,t)=>a(e,"name",`${u} axis ${t}`))),a(r,"datasets",n),o(r,"datasets",n),r.datasets.forEach(((e,t)=>a(e,"path",`${u} dataset ${t}`)))}},5390:(e,t,n)=>{function s(e,t,n,s={}){return void 0!==t&&void 0!==n&&(s={...s,headers:{...s.headers,Range:`bytes=${t}-${t+n-1}`}}),fetch(e,s)}function r(e,t){const n="string"==typeof e?new URL(e):e;n.pathname.endsWith("/")||(n.pathname+="/");const s=new URL(t.slice(1),n);return s.search=n.search,s}async function i(e){if(404!==e.status){if(200===e.status||206===e.status)return new Uint8Array(await e.arrayBuffer());throw new Error(`Unexpected response status ${e.status} ${e.statusText}`)}}n.d(t,{L:()=>c,A:()=>u});const a=class{url;#e;#t;constructor(e,t={}){this.url=e,this.#e=t.overrides??{},this.#t=t.useSuffixRequest??!1}#n(e){return t=this.#e,n=e,{...t,...n,headers:{...t.headers,...n.headers}};var t,n}async get(e,t={}){let n=r(this.url,e).href;return i(await fetch(n,this.#n(t)))}async getRange(e,t,n={}){let a,o=r(this.url,e),u=this.#n(n);return a="suffixLength"in t?await async function(e,t,n,r){if(r)return fetch(e,{...n,headers:{...n.headers,Range:`bytes=-${t}`}});let i=await fetch(e,{...n,method:"HEAD"});if(!i.ok)return i;let a=i.headers.get("Content-Length"),o=Number(a);return s(e,o-t,o,n)}(o,t.suffixLength,u,this.#t):await s(o,t.offset,t.length,u),i(a)}};var o=n(3e3);function u(e,t,n,s){const r=(t.endsWith("/")?t.slice(0,-1):t)+e.path+(e.path.endsWith("/")?"":"/"),i=async(t,i)=>{i?.subscriber&&i.reportChunk&&i.reportChunk(t,i.subscriber);const a=r+t.join(","),u=n?.get(a);if(u&&(0,o.y)(u))return u;let c;return c=s&&i?.subscriber?await s.addRequest(a,i?.subscriber,(()=>e.getChunk(t,i)),i.isPrefetch):await e.getChunk(t,i),n?.insert(a,c),c};return new Proxy(e,{get:(e,t)=>{if("getChunk"===t)return i;const n=e[t];return n instanceof Function?function(...t){return n.apply(e,t)}:n}})}class c extends a{constructor(e,t){super(e,t)}async get(e,t={}){try{return await super.get(e,t)}catch(e){if(e?.message?.startsWith("Unexpected response status 403"))return;throw e}}}},5448:(e,t,n)=>{n.d(t,{A:()=>r});const s="request cancelled";class r{constructor(e=10,t=5){this.allRequests=new Map,this.activeRequests=new Set,this.queue=[],this.queueLowPriority=[],this.maxActiveRequests=e,this.maxLowPriorityRequests=Math.min(e,t)}registerRequest(e,t){let n,s;const r=new Promise(((e,t)=>{n=e,s=t})),i={key:e,action:t,resolve:n,reject:s,promise:r};return this.allRequests.set(e,i),i}addRequestToQueue(e,t){if(this.allRequests.has(e)){const n=this.allRequests.get(e);n&&n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=void 0),this.queue.includes(e)||this.queueLowPriority.includes(e)||(t?this.queueLowPriority.push(e):this.queue.push(e),this.dequeue())}}addRequest(e,t,n=!1,s=0){if(this.allRequests.has(e)){const t=this.queueLowPriority.indexOf(e);t>-1&&!n?(this.queueLowPriority.splice(t,1),this.addRequestToQueue(e)):s<=0&&this.addRequestToQueue(e,n)}else{const r=this.registerRequest(e,t);if(s>0){const t=setTimeout((()=>this.addRequestToQueue(e,n)),s);r.timeoutId=t}else this.addRequestToQueue(e,n)}const r=this.allRequests.get(e)?.promise;if(!r)throw new Error("Found no promise to return when getting stored request data.");return r}addRequests(e,t=!1,n=10){const s=[];for(let r=0;r<e.length;r++){const i=e[r],a=this.addRequest(i.key,i.requestAction,t,n*r);s.push(a)}return s}async dequeue(){const e=this.activeRequests.size;if(e>=this.maxActiveRequests||0===this.queue.length&&(e>=this.maxLowPriorityRequests||0===this.queueLowPriority.length))return;const t=this.queue.shift()??this.queueLowPriority.shift();if(!t)return;if(this.activeRequests.has(t))return void this.dequeue();const n=this.allRequests.get(t);if(!n)return;const s=n.key;this.activeRequests.add(s),await n.action().then(n.resolve,n.reject),this.activeRequests.delete(s),this.allRequests.delete(s),this.dequeue()}cancelRequest(e,t=s){if(!this.allRequests.has(e))return;const n=this.allRequests.get(e);n&&(n.timeoutId&&clearTimeout(n.timeoutId),n.reject(t));const r=this.queue.indexOf(e);if(r>-1)this.queue.splice(r,1);else{const t=this.queueLowPriority.indexOf(e);t>-1&&this.queueLowPriority.splice(t,1)}this.allRequests.delete(e),this.activeRequests.delete(e)}cancelAllRequests(e=s){this.queue=[],this.queueLowPriority=[];for(const t of this.allRequests.keys())this.cancelRequest(t,e)}hasRequest(e){return this.allRequests.has(e)}requestRunning(e){return this.activeRequests.has(e)}}},9565:(e,t,n)=>{n.d(t,{A:()=>r});var s=n(5448);class r{constructor(e,t){this.queue="number"==typeof e||void 0===e?new s.A(e,t):e,this.nextSubscriberId=0,this.subscribers=new Map,this.requests=new Map}resolveAll(e,t){const n=this.requests.get(e);if(n){for(const{resolve:s,subscriberId:r}of n)s(t),this.subscribers.get(r)?.delete(e);this.requests.delete(e)}}rejectAll(e,t){const n=this.requests.get(e);if(n){for(const{reject:s,subscriberId:r}of n)s(t),this.subscribers.get(r)?.delete(e);this.requests.delete(e)}}addSubscriber(){const e=this.nextSubscriberId;return this.nextSubscriberId++,this.subscribers.set(e,new Map),e}addRequest(e,t,n,s,r){if(this.queue.addRequest(e,n,s,r).then((t=>this.resolveAll(e,t))).catch((t=>this.rejectAll(e,t))),this.requests.has(e)||this.requests.set(e,[]),t>=this.nextSubscriberId||t<0)throw new Error(`SubscribableRequestQueue: subscriber id ${t} has not been registered`);if(!this.subscribers.get(t))throw new Error(`SubscribableRequestQueue: subscriber id ${t} has been removed`);return new Promise(((n,s)=>{this.requests.get(e)?.push({resolve:n,reject:s,subscriberId:t});const r=this.subscribers.get(t),i=r?.get(e);i?i.push(s):r?.set(e,[s])}))}rejectSubscription(e,t,n){t(n);const s=this.requests.get(e);if(!s)return;const r=s.findIndex((e=>e.reject===t));r>=0&&s.splice(r,1),s.length<1&&!this.queue.requestRunning(e)&&(this.queue.cancelRequest(e,n),this.requests.delete(e))}cancelRequest(e,t,n){const s=this.subscribers.get(t);if(!s)return!1;const r=s.get(e);if(!r||!r.length)return!1;for(const t of r)this.rejectSubscription(e,t,n);return s.delete(e),!0}removeSubscriber(e,t){const n=this.subscribers.get(e);if(n){for(const[e,s]of n.entries())for(const n of s)this.rejectSubscription(e,n,t);this.subscribers.delete(e)}}hasRequest(e){return this.queue.hasRequest(e)}requestRunning(e){return this.queue.requestRunning(e)}hasSubscriber(e){return this.subscribers.has(e)}isSubscribed(e,t){return this.subscribers.get(e)?.has(t)??!1}}},9177:(e,t,n)=>{n.d(t,{K2:()=>s,VC:()=>r,dE:()=>i});let s=function(e){return e[e.INIT=0]="INIT",e[e.CREATE_LOADER=1]="CREATE_LOADER",e[e.CLOSE_LOADER=2]="CLOSE_LOADER",e[e.CREATE_VOLUME=3]="CREATE_VOLUME",e[e.LOAD_DIMS=4]="LOAD_DIMS",e[e.LOAD_VOLUME_DATA=5]="LOAD_VOLUME_DATA",e[e.SET_PREFETCH_PRIORITY_DIRECTIONS=6]="SET_PREFETCH_PRIORITY_DIRECTIONS",e[e.SYNCHRONIZE_MULTICHANNEL_LOADING=7]="SYNCHRONIZE_MULTICHANNEL_LOADING",e[e.UPDATE_FETCH_OPTIONS=8]="UPDATE_FETCH_OPTIONS",e}({}),r=function(e){return e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.EVENT=2]="EVENT",e}({}),i=function(e){return e[e.METADATA_UPDATE=0]="METADATA_UPDATE",e[e.CHANNEL_LOAD=1]="CHANNEL_LOAD",e}({})},6238:(e,t,n)=>{n.d(t,{N:()=>r});var s=n(4922);function r(e){return{...e,subregion:new s.NRn((new s.Pq0).copy(e.subregion.min),(new s.Pq0).copy(e.subregion.max))}}},6712:(e,t,n)=>{n.d(t,{O3:()=>I,YJ:()=>T,aZ:()=>E,JD:()=>R,zr:()=>k});var s=n(3333);class r{kind="array_to_array";constructor(e,t){(0,s.vA)(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,t){return new r(e,t)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const i=function(){const e=new Uint32Array([305419896]);return!(18===new Uint8Array(e.buffer,e.byteOffset,e.byteLength)[0])}();function a(e){return"BYTES_PER_ELEMENT"in e?e.BYTES_PER_ELEMENT:4}class o{kind="array_to_bytes";#s;#r;#i;#a;#o;constructor(e,t){this.#o=e?.endian,this.#r=(0,s.zA)(t.data_type),this.#a=t.shape,this.#s=(0,s.uV)(t.shape,"C");const n=new this.#r(0);this.#i=n.BYTES_PER_ELEMENT}static fromConfig(e,t){return new o(e,t)}encode(e){let t=new Uint8Array(e.data.buffer);return i&&"big"===this.#o&&(0,s.dq)(t,a(this.#r)),t}decode(e){return i&&"big"===this.#o&&(0,s.dq)(e,a(this.#r)),{data:new this.#r(e.buffer,e.byteOffset,e.byteLength/this.#i),shape:this.#a,stride:this.#s}}}class u{kind="bytes_to_bytes";static fromConfig(){return new u}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class c{kind="bytes_to_bytes";static fromConfig(e){return new c}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const t=await(0,s.mF)(e,{format:"gzip"});return new Uint8Array(t)}}function h(e,t){return(0,s.vA)(!Number.isNaN(t),"JsonCodec allow_nan is false but NaN was encountered during encoding."),(0,s.vA)(t!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),(0,s.vA)(t!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),t}function l(e,t){return t instanceof Object&&!Array.isArray(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t}class d{configuration;kind="array_to_bytes";#u;#c;constructor(e={}){this.configuration=e;const{encoding:t="utf-8",skipkeys:n=!1,ensure_ascii:s=!0,check_circular:r=!0,allow_nan:i=!0,sort_keys:a=!0,indent:o,strict:u=!0}=e;let c=e.separators;c||(c=o?[", ",": "]:[",",":"]),this.#u={encoding:t,skipkeys:n,ensure_ascii:s,check_circular:r,allow_nan:i,indent:o,separators:c,sort_keys:a},this.#c={strict:u}}static fromConfig(e){return new d(e)}encode(e){const{indent:t,encoding:n,ensure_ascii:r,check_circular:i,allow_nan:a,sort_keys:o}=this.#u;(0,s.vA)("utf-8"===n,"JsonCodec does not yet support non-utf-8 encoding.");const u=[];(0,s.vA)(i,"JsonCodec does not yet support skipping the check for circular references during encoding."),a||u.push(h),o&&u.push(l);const c=Array.from(e.data);let d;c.push("|O"),c.push(e.shape),u.length&&(d=(e,t)=>{let n=t;for(let t of u)n=t(e,n);return n});let f=JSON.stringify(c,d,t);return r&&(f=f.replace(/[\u007F-\uFFFF]/g,(e=>{const t=`0000${e.charCodeAt(0).toString(16)}`;return`\\u${t.substring(t.length-4)}`}))),(new TextEncoder).encode(f)}decode(e){const{strict:t}=this.#c;(0,s.vA)(t,"JsonCodec does not yet support non-strict decoding.");const n=(0,s.eg)(e),r=n.pop();return n.pop(),(0,s.vA)(r,"0D not implemented for JsonCodec."),{data:n,shape:r,stride:(0,s.uV)(r,"C")}}}var f=n(3356);function g(e){return e instanceof f.OZ||e instanceof f.Lk||e instanceof f.so?new Proxy(e,{get:(e,t)=>e.get(Number(t)),set:(e,t,n)=>(e.set(Number(t),n),!0)}):e}class m{kind="array_to_array";#h;#l;constructor(e,t){let n=e.order??"C",r=t.shape.length,i=new Array(r),a=new Array(r);if("C"===n)for(let e=0;e<r;++e)i[e]=e,a[e]=e;else if("F"===n)for(let e=0;e<r;++e)i[e]=r-e-1,a[e]=r-e-1;else i=n,i.forEach(((e,t)=>{(0,s.vA)(void 0===a[e],`Invalid permutation: ${JSON.stringify(n)}`),a[e]=t}));this.#h=i,this.#l=a}static fromConfig(e,t){return new m(e,t)}encode(e){return function(e,t){let n=function(e){let t=e.shape.length;return(0,s.vA)(t===e.stride.length,"Shape and stride must have the same length."),e.stride.map(((e,t)=>({stride:e,index:t}))).sort(((e,t)=>t.stride-e.stride)).map((e=>e.index))}(e);return(0,s.vA)(n.length===t.length,"Orders must match"),n.every(((e,n)=>e===t[n]))}(e,this.#l)?e:function(e,t){let n=function(e,t){let n;return n=e.data instanceof f.Lk||e.data instanceof f.so?new e.constructor(e.data.length,e.data.chars):new e.constructor(e.data.length),{data:n,shape:e.shape,stride:(0,s.uV)(e.shape,t)}}(e,t),r=e.shape.length,i=e.data.length,a=Array(r).fill(0),o=g(e.data),u=g(n.data);for(let t=0;t<i;t++){let s=0;for(let e=0;e<r;e++)s+=a[e]*n.stride[e];u[s]=o[t],a[0]+=1;for(let t=0;t<r;t++)if(a[t]===e.shape[t]){if(t+1===r)break;a[t]=0,a[t+1]+=1}}return n}(e,this.#l)}decode(e){return{data:e.data,shape:e.shape,stride:(0,s.uV)(e.shape,this.#h)}}}class y{kind="array_to_bytes";#a;#d;constructor(e){this.#a=e,this.#d=(0,s.uV)(e,"C")}static fromConfig(e,t){return new y(t.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let t=new TextDecoder,n=new DataView(e.buffer),s=Array(n.getUint32(0,!0)),r=4;for(let i=0;i<s.length;i++){let a=n.getUint32(r,!0);r+=4,s[i]=t.decode(e.buffer.slice(r,r+a)),r+=a}return{data:s,shape:this.#a,stride:this.#d}}}class p{kind="bytes_to_bytes";static fromConfig(e){return new p}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const t=await(0,s.mF)(e,{format:"deflate"});return new Uint8Array(t)}}const b=(new Map).set("blosc",(()=>n.e(502).then(n.bind(n,5121)).then((e=>e.default)))).set("lz4",(()=>n.e(274).then(n.bind(n,3274)).then((e=>e.default)))).set("zstd",(()=>n.e(505).then(n.bind(n,7505)).then((e=>e.default)))).set("gzip",(()=>c)).set("zlib",(()=>p)).set("transpose",(()=>m)).set("bytes",(()=>o)).set("crc32c",(()=>u)).set("vlen-utf8",(()=>y)).set("json2",(()=>d)).set("bitround",(()=>r));function _(e){let t;return{async encode(n){t||(t=await w(e));for(const e of t.array_to_array)n=await e.encode(n);let s=await t.array_to_bytes.encode(n);for(const e of t.bytes_to_bytes)s=await e.encode(s);return s},async decode(n){t||(t=await w(e));for(let e=t.bytes_to_bytes.length-1;e>=0;e--)n=await t.bytes_to_bytes[e].decode(n);let s=await t.array_to_bytes.decode(n);for(let e=t.array_to_array.length-1;e>=0;e--)s=await t.array_to_array[e].decode(s);return s}}}async function w(e){let t,n=e.codecs.map((async e=>{let t=await(b.get(e.name)?.());return(0,s.vA)(t,`Unknown codec: ${e.name}`),{Codec:t,meta:e}})),r=[],i=[];for await(let{Codec:s,meta:a}of n){let n=s.fromConfig(a.configuration,e);switch(n.kind){case"array_to_array":r.push(n);break;case"array_to_bytes":t=n;break;default:i.push(n)}}return t||((0,s.vA)("v2:object"!==e.data_type,`Cannot encode ${e.data_type} to bytes without a codec`),t=o.fromConfig({endian:"little"},e)),{array_to_array:r,array_to_bytes:t,bytes_to_bytes:i}}const A=18446744073709551615n;function v(e,t,n,r){(0,s.vA)(e.store.getRange,"Store does not support range requests");let i=e.store.getRange.bind(e.store),a=t.map(((e,t)=>e/r.chunk_shape[t])),o=_({data_type:"uint64",shape:[...a,2],codecs:r.index_codecs}),u={};return async t=>{let s,r=t.map(((e,t)=>Math.floor(e/a[t]))),c=e.resolve(n(r)).path;if(c in u)s=u[c];else{let e=4,t=16*a.reduce(((e,t)=>e*t),1),n=await i(c,{suffixLength:t+e});s=u[c]=n?await o.decode(n):null}if(null===s)return;let{data:h,shape:l,stride:d}=s,f=t.map(((e,t)=>e%l[t])).reduce(((e,t,n)=>e+t*d[n]),0),g=h[f],m=h[f+1];return g!==A||m!==A?i(c,{offset:Number(g),length:Number(m)}):void 0}}class E{store;path;constructor(e,t="/"){this.store=e,this.path=t}resolve(e){let t=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new E(this.store,new URL(e,t).pathname)}}function k(e){return new E(e??new Map)}class T extends E{kind="group";#f;constructor(e,t,n){super(e,t),this.#f=n}get attrs(){return this.#f.attributes}}function L(e){const t=e.find((e=>"transpose"===e.name));return t?.configuration?.order??"C"}const q=Symbol("zarrita.context");function R(e){return e[q]}class I extends E{kind="array";#f;[q];constructor(e,t,n){super(e,t),this.#f={...n,fill_value:(0,s.HM)(n)},this[q]=function(e,t){let{configuration:n}=t.codecs.find(s.X)??{},r={encode_chunk_key:(0,s.c7)(t.chunk_key_encoding),TypedArray:(0,s.zA)(t.data_type),fill_value:t.fill_value};if(n){let i=L(n.codecs);return{...r,kind:"sharded",chunk_shape:n.chunk_shape,codec:_({data_type:t.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides:e=>(0,s.uV)(e,i),get_chunk_bytes:v(e,t.chunk_grid.configuration.chunk_shape,r.encode_chunk_key,n)}}let i=L(t.codecs);return{...r,kind:"regular",chunk_shape:t.chunk_grid.configuration.chunk_shape,codec:_({data_type:t.data_type,shape:t.chunk_grid.configuration.chunk_shape,codecs:t.codecs}),get_strides:e=>(0,s.uV)(e,i),async get_chunk_bytes(t,n){let s=r.encode_chunk_key(t),i=e.resolve(s).path;return e.store.get(i,n)}}}(this,n)}get attrs(){return this.#f.attributes}get shape(){return this.#f.shape}get chunks(){return this[q].chunk_shape}get dtype(){return this.#f.data_type}async getChunk(e,t){let n=this[q],s=await n.get_chunk_bytes(e,t);if(!s){let e=n.chunk_shape.reduce(((e,t)=>e*t),1),t=new n.TypedArray(e);return t.fill(n.fill_value),{data:t,shape:n.chunk_shape,stride:n.get_strides(n.chunk_shape)}}return n.codec.decode(s)}is(e){return(0,s.mf)(this.dtype,e)}}},8613:(e,t,n)=>{n.d(t,{di:()=>s.di});var s=n(5508)},7950:(e,t,n)=>{n.d(t,{Jt:()=>d});var s=n(6712),r=n(5508);class i extends Error{constructor(e){super(e),this.name="IndexError"}}class a{dim_sel;dim_len;dim_chunk_len;nitems;constructor({dim_sel:e,dim_len:t,dim_chunk_len:n}){e=function(e,t){return(e=Math.trunc(e))<0&&(e=t+e),(e>=t||e<0)&&function(e){throw new i(`index out of bounds for dimension with length ${e}`)}(t),e}(e,t),this.dim_sel=e,this.dim_len=t,this.dim_chunk_len=n,this.nitems=1}*[Symbol.iterator](){const e=Math.floor(this.dim_sel/this.dim_chunk_len),t=e*this.dim_chunk_len,n=this.dim_sel-t;yield{dim_chunk_ix:e,dim_chunk_sel:n}}}class o{start;stop;step;dim_len;dim_chunk_len;nitems;nchunks;constructor({dim_sel:e,dim_len:t,dim_chunk_len:n}){const[s,a,o]=(0,r.LS)(e,t);this.start=s,this.stop=a,this.step=o,this.step<1&&function(){throw new i("only slices with step >= 1 are supported")}(),this.dim_len=t,this.dim_chunk_len=n,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const e=Math.floor(this.start/this.dim_chunk_len),t=Math.ceil(this.stop/this.dim_chunk_len);for(const n of(0,r.y1)(e,t)){const e=n*this.dim_chunk_len,t=Math.min(this.dim_len,(n+1)*this.dim_chunk_len),s=t-e;let r=0,i=0;if(this.start<e){const t=(e-this.start)%this.step;t&&(i+=this.step-t),r=Math.ceil((e-this.start)/this.step)}else i=this.start-e;const a=this.stop>t?s:this.stop-e,o=[i,a,this.step],u=[r,r+Math.ceil((a-i)/this.step),1];yield{dim_chunk_ix:n,dim_chunk_sel:o,dim_out_sel:u}}}}class u{dim_indexers;shape;constructor({selection:e,shape:t,chunk_shape:n}){this.dim_indexers=function(e,t){let n=[];return null===e?n=t.map((e=>(0,r.di)(null))):Array.isArray(e)&&(n=e.map((e=>e??(0,r.di)(null)))),function(e,t){e.length>t.length&&function(e,t){throw new i(`too many indicies for array; expected ${t.length}, got ${e.length}`)}(e,t)}(n,t),n}(e,t).map(((e,s)=>new("number"==typeof e?a:o)({dim_sel:e,dim_len:t[s],dim_chunk_len:n[s]}))),this.shape=this.dim_indexers.filter((e=>e instanceof o)).map((e=>e.nitems))}*[Symbol.iterator](){for(const e of(0,r.qM)(...this.dim_indexers)){const t=e.map((e=>e.dim_chunk_ix)),n=e.map((e=>"dim_out_sel"in e?{from:e.dim_chunk_sel,to:e.dim_out_sel}:{from:e.dim_chunk_sel,to:null}));yield{chunk_coords:t,mapping:n}}}}function c(e,t=0,n){let s=n??e.length-t;return{length:s,subarray:(n,r=s)=>c(e,t+n,r-n),set(n,s=0){for(let r=0;r<n.length;r++)e[t+s+r]=n.get(r)},get:n=>e[t+n]}}function h(e){return globalThis.Array.isArray(e.data)?{data:c(e.data),stride:e.stride,bytes_per_element:1}:{data:new Uint8Array(e.data.buffer,e.data.byteOffset,e.data.byteLength),stride:e.stride,bytes_per_element:e.data.BYTES_PER_ELEMENT}}const l={prepare:(e,t,n)=>({data:e,shape:t,stride:n}),set_scalar(e,t,n){let s=h(e);g(s,t,function(e,t){if(globalThis.Array.isArray(e.data))return c([t]);let n=new(function(e){return"chars"in e?e.constructor.bind(null,e.chars):e.constructor}(e.data))([t]);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}(e,n),s.bytes_per_element)},set_from_chunk(e,t,n){let s=h(e);m(s,h(t),s.bytes_per_element,n)}};async function d(e,t=null,n={}){return async function(e,t,n,i){let a=(0,s.JD)(e),o=new u({selection:t,shape:e.shape,chunk_shape:e.chunks}),c=i.prepare(new a.TypedArray(o.shape.reduce(((e,t)=>e*t),1)),o.shape,a.get_strides(o.shape)),h=n.create_queue?.()??(0,r.XB)();for(const{chunk_coords:t,mapping:s}of o)h.add((async()=>{let{data:r,shape:a,stride:o}=await e.getChunk(t,n.opts),u=i.prepare(r,a,o);i.set_from_chunk(c,u,s)}));return await h.onIdle(),0===o.shape.length?function(e){return"get"in e?e.get(0):e[0]}(c.data):c}(e,t,n,l)}function f(e,t,n){return n<0&&t<e?Math.floor((e-t-1)/-n)+1:e<t?Math.floor((t-e-1)/n)+1:0}function g(e,t,n,s){if(0===t.length)return void e.data.set(n,0);const[r,...i]=t,[a,...o]=e.stride;if("number"==typeof r)return void g({data:e.data.subarray(a*r*s),stride:o},i,n,s);const[u,c,h]=r,l=f(u,c,h);if(0!==i.length)for(let t=0;t<l;t++)g({data:e.data.subarray(a*(u+h*t)*s),stride:o},i,n,s);else for(let t=0;t<l;t++)e.data.set(n,a*(u+h*t)*s)}function m(e,t,n,s){const[r,...i]=s,[a,...o]=e.stride,[u,...c]=t.stride;if(null===r.from)return 0===i.length?void e.data.set(t.data.subarray(0,n),r.to*n):void m({data:e.data.subarray(a*r.to*n),stride:o},t,n,i);if(null===r.to){if(0===i.length){let s=r.from*n;return void e.data.set(t.data.subarray(s,s+n),0)}return void m(e,{data:t.data.subarray(u*r.from*n),stride:c},n,i)}const[h,l,d]=r.to,[g,y,p]=r.from,b=f(h,l,d);if(0!==i.length)for(let s=0;s<b;s++)m({data:e.data.subarray(a*(h+s*d)*n),stride:o},{data:t.data.subarray(u*(g+s*p)*n),stride:c},n,i);else{if(1===d&&1===p&&1===a&&1===u){let s=g*n,r=b*n;return void e.data.set(t.data.subarray(s,s+r),h*n)}for(let s=0;s<b;s++){let r=u*(g+p*s)*n;e.data.set(t.data.subarray(r,r+n),a*(h+d*s)*n)}}}},5508:(e,t,n)=>{function*s(e,t,n=1){void 0===t&&(t=e,e=0);for(let s=e;s<t;s+=n)yield s}function*r(...e){if(0===e.length)return;const t=e.map((e=>e[Symbol.iterator]())),n=t.map((e=>e.next()));if(n.some((e=>e.done)))throw new Error("Input contains an empty iterator.");for(let s=0;;){if(n[s].done){if(t[s]=e[s][Symbol.iterator](),n[s]=t[s].next(),++s>=t.length)return}else yield n.map((({value:e})=>e)),s=0;n[s]=t[s].next()}}function i({start:e,stop:t,step:n},s){if(0===n)throw new Error("slice step cannot be zero");const r=(n=n??1)<0,[i,a]=r?[-1,s-1]:[0,s];return null===e?e=r?a:i:e<0?(e+=s)<i&&(e=i):e>a&&(e=a),null===t?t=r?i:a:t<0?(t+=s)<i&&(t=i):t>a&&(t=a),[e,t,n]}function a(e,t,n=null){return void 0===t&&(t=e,e=null),{start:e,stop:t,step:n}}function o(){const e=[];return{add:t=>e.push(t()),onIdle:()=>Promise.all(e)}}n.d(t,{LS:()=>i,XB:()=>o,di:()=>a,qM:()=>r,y1:()=>s})},2081:(e,t,n)=>{n.d(t,{h:()=>c});var s=n(7972),r=n(6712),i=n(3333);let a=function(){let e=new WeakMap;function t(t){let n=e.get(t)??{v2:0,v3:0};return e.set(t,n),n}return{increment(e,n){t(e)[n]+=1},version_max(e){let n=t(e);return n.v3>n.v2?"v3":"v2"}}}();async function o(e,t){let{path:n}=e.resolve(".zarray"),o=await e.store.get(n);if(!o)throw new s._("v2 array",{cause:new s.e(n)});return a.increment(e.store,"v2"),new r.O3(e.store,e.path,(0,i.PQ)((0,i.eg)(o),t))}async function u(e,t){let{path:n}=e.resolve(".zgroup"),o=await e.store.get(n);if(!o)throw new s._("v2 group",{cause:new s.e(n)});return a.increment(e.store,"v2"),new r.YJ(e.store,e.path,(0,i.NO)((0,i.eg)(o),t))}async function c(e,t={}){let n="store"in e?e.store:e,r=a.version_max(n),o="v2"===r?c.v2:c.v3,u="v2"===r?c.v3:c.v2;return o(e,t).catch((n=>((0,i.tz)(n,s._),u(e,t))))}c.v2=async function(e,t={}){let n="store"in e?e:new r.aZ(e),a={};return(t.attrs??1)&&(a=await async function(e){let t=await e.store.get(e.resolve(".zattrs").path);return t?(0,i.eg)(t):{}}(n)),"array"===t.kind?o(n,a):"group"===t.kind?u(n,a):o(n,a).catch((e=>((0,i.tz)(e,s._),u(n,a))))},c.v3=async function(e,t={}){let n="store"in e?e:new r.aZ(e),o=await async function(e){let{store:t,path:n}=e.resolve("zarr.json"),a=await e.store.get(n);if(!a)throw new s._("v3 array or group",{cause:new s.e(n)});let o=(0,i.eg)(a);return"array"===o.node_type&&(o.fill_value=(0,i.HM)(o)),"array"===o.node_type?new r.O3(t,e.path,o):new r.YJ(t,e.path,o)}(n);if(a.increment(n.store,"v3"),void 0===t.kind)return o;if("array"===t.kind&&o instanceof r.O3)return o;if("group"===t.kind&&o instanceof r.YJ)return o;let u=o instanceof r.O3?"array":"group";throw new Error(`Expected node of kind ${t.kind}, found ${u}.`)}},3356:(e,t,n)=>{n.d(t,{Lk:()=>r,OZ:()=>s,so:()=>i});class s{#g;constructor(e,t,n){"number"==typeof e?this.#g=new Uint8Array(e):e instanceof ArrayBuffer?this.#g=new Uint8Array(e,t,n):this.#g=new Uint8Array(Array.from(e,(e=>e?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return this.#g.byteOffset}get byteLength(){return this.#g.byteLength}get buffer(){return this.#g.buffer}get length(){return this.#g.length}get(e){let t=this.#g[e];return"number"==typeof t?0!==t:t}set(e,t){this.#g[e]=t?1:0}fill(e){this.#g.fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class r{_data;chars;#m;constructor(e,t,n,s){if(this.chars=e,this.#m=new TextEncoder,"number"==typeof t)this._data=new Uint8Array(t*e);else if(t instanceof ArrayBuffer)s&&(s*=e),this._data=new Uint8Array(t,n,s);else{let n=Array.from(t);this._data=new Uint8Array(n.length*e);for(let e=0;e<n.length;e++)this.set(e,n[e])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const t=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return(new TextDecoder).decode(t).replace(/\x00/g,"")}set(e,t){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);n.fill(0),n.set(this.#m.encode(t))}fill(e){const t=this.#m.encode(e);for(let e=0;e<this.length;e++)this._data.set(t,e*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class i{#y;chars;constructor(e,t,n,s){if(this.chars=e,"number"==typeof t)this.#y=new Int32Array(t*e);else if(t instanceof ArrayBuffer)s&&(s*=e),this.#y=new Int32Array(t,n,s);else{const n=t,s=new i(e,1);this.#y=new Int32Array(function*(){for(let e of n)s.set(0,e),yield*s.#y}())}}get BYTES_PER_ELEMENT(){return this.#y.BYTES_PER_ELEMENT*this.chars}get byteLength(){return this.#y.byteLength}get byteOffset(){return this.#y.byteOffset}get buffer(){return this.#y.buffer}get length(){return this.#y.length/this.chars}get(e){const t=this.chars*e;let n="";for(let e=0;e<this.chars;e++)n+=String.fromCodePoint(this.#y[t+e]);return n.replace(/\u0000/g,"")}set(e,t){const n=this.chars*e,s=this.#y.subarray(n,n+this.chars);s.fill(0);for(let e=0;e<this.chars;e++)s[e]=t.codePointAt(e)??0}fill(e){this.set(0,e);let t=this.#y.subarray(0,this.chars);for(let e=1;e<this.length;e++)this.#y.set(t,e*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}},3333:(e,t,n)=>{n.d(t,{HM:()=>f,NO:()=>h,PQ:()=>c,X:()=>d,c7:()=>u,dq:()=>i,eg:()=>r,mF:()=>y,mf:()=>l,tz:()=>g,uV:()=>o,vA:()=>m,zA:()=>a});var s=n(3356);function r(e){const t=(new TextDecoder).decode(e);return JSON.parse(t)}function i(e,t){const n=t/2,s=t-1;let r=0;for(let i=0;i<e.length;i+=t)for(let t=0;t<n;t+=1)r=e[i+t],e[i+t]=e[i+s-t],e[i+s-t]=r}function a(e){if("v2:object"===e)return globalThis.Array;let t=e.match(/v2:([US])(\d+)/);if(t){let[,e,n]=t;return("U"===e?s.so:s.Lk).bind(null,Number(n))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:s.OZ}[e];return m(n,`Unknown or unsupported data_type: ${e}`),n}function o(e,t){const n=e.length;"string"==typeof t&&(t="C"===t?Array.from({length:n},((e,t)=>t)):Array.from({length:n},((e,t)=>n-1-t))),m(n===t.length,"Order length must match the number of dimensions.");let s=1,r=new Array(n);for(let n=t.length-1;n>=0;n--)r[t[n]]=s,s*=e[t[n]];return r}function u({name:e,configuration:t}){if("default"===e){const e=t?.separator??"/";return t=>["c",...t].join(e)}if("v2"===e){const e=t?.separator??".";return t=>t.join(e)||"0"}throw new Error(`Unknown chunk key encoding: ${e}`)}function c(e,t={}){let n=[],s=function(e){if("|O"===e)return{data_type:"v2:object"};let t=e.match(/^([<|>])(.*)$/);m(t,`Invalid dtype: ${e}`);let[,n,s]=t,r={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[s]??(s.startsWith("S")||s.startsWith("U")?`v2:${s}`:void 0);return m(r,`Unsupported or unknown dtype: ${e}`),"|"===n?{data_type:r}:{data_type:r,endian:"<"===n?"little":"big"}}(e.dtype);"F"===e.order&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in s&&"big"===s.endian&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:t,...s}of e.filters??[])n.push({name:t,configuration:s});if(e.compressor){let{id:t,...s}=e.compressor;n.push({name:t,configuration:s})}return{zarr_format:3,node_type:"array",shape:e.shape,data_type:s.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:e.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:e.dimension_separator??"."}},codecs:n,fill_value:e.fill_value,attributes:t}}function h(e,t={}){return{zarr_format:3,node_type:"group",attributes:t}}function l(e,t){if("number"!==t&&"bigint"!==t&&"boolean"!==t&&"object"!==t&&"string"!==t)return e===t;let n="bool"===e;if("boolean"===t)return n;let s=e.startsWith("v2:U")||e.startsWith("v2:S");if("string"===t)return s;let r="int64"===e||"uint64"===e;if("bigint"===t)return r;let i="v2:object"===e;return"object"===t?i:!(s||r||n||i)}function d(e){return"sharding_indexed"===e?.name}function f(e){return"uint64"!==e.data_type&&"int64"!==e.data_type||null==e.fill_value?e.fill_value:BigInt(e.fill_value)}function g(e,...t){if(!t.some((t=>e instanceof t)))throw e}function m(e,t=""){if(!e)throw new Error(t)}async function y(e,{format:t,signal:n}){const s=e instanceof Response?e:new Response(e);m(s.body,"Response does not contain body.");try{const e=new Response(s.body.pipeThrough(new DecompressionStream(t),{signal:n}));return await e.arrayBuffer()}catch{throw n?.throwIfAborted(),new Error(`Failed to decode ${t}`)}}}}]);
//# sourceMappingURL=591.bundle.js.map