{"version":3,"file":"688.bundle.js","mappings":"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","sources":["webpack://@aics/vole-app/./src/aics-image-viewer/components/ErrorAlert/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ViewerStateProvider/ResetStateProvider.ts","webpack://@aics/vole-app/./src/aics-image-viewer/components/ViewerStateProvider/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/shared/constants.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/enums.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/hooks.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/datatypes.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/firebase/index.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/math.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/urlParsing.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/viewerChannelSettings.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/viewerState.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/types.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/colorRepresentations.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/controlPointsToLut.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/playControls.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/sceneStore.ts","webpack://@aics/vole-app/./src/aics-image-viewer/components/useVolume.ts","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/NumericInput/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/SmarterSlider.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/AxisClipSliders/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/turnTable.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/index.ts","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/axes.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/boundingBox.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/camera.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/channels.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/closePanel.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/download.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/dropdownArrow.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/metadata.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/preferences.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/resetView.svg","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/ViewerIcon.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/BottomPanel/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/CellViewerCanvasWrapper/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ColorPicker.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/SliderRow/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/TfEditor/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ChannelsWidgetRow/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/SharedCheckBox.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ChannelsWidget.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/CustomizeWidget.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/GlobalVolumeControls.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/MetadataViewer/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ControlPanel/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/Toolbar/DownloadButton.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/Toolbar/ViewModeRadioButtons.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/Toolbar/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/App/ChannelUpdater.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/App/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/sliderValuesToImageValues.ts","webpack://@aics/vole-app/./website/components/Buttons/index.tsx","webpack://@aics/vole-app/./website/components/HelpDropdown.tsx","webpack://@aics/vole-app/./website/utils/react_utils.ts","webpack://@aics/vole-app/./website/components/MiddleTruncatedText.tsx","webpack://@aics/vole-app/./website/components/Modals/LoadModal.tsx"],"sourcesContent":["import { VolumeLoadError, VolumeLoadErrorType } from \"@aics/vole-core\";\nimport { RightOutlined } from \"@ant-design/icons\";\nimport { Alert, Button } from \"antd\";\nimport React from \"react\";\n\nimport { useConstructor } from \"../../shared/utils/hooks\";\n\nimport \"./styles.css\";\n\nconst IssueLink: React.FC<React.PropsWithChildren<{ bug?: boolean }>> = ({ bug, children }) => (\n  <a\n    href={`https://github.com/allen-cell-animated/vole-app/issues/new${bug ? \"?template=bug_report.md\" : \"/choose\"}`}\n    target=\"_blank\"\n    rel=\"noreferrer noopener\"\n  >\n    {children}\n  </a>\n);\n\nconst UNKNOWN_ERROR_DESCRIPTION: React.ReactNode = (\n  <>\n    An unknown error occurred. Check the browser console (F12) for more details. If this looks like a bug,{\" \"}\n    <IssueLink bug>send us a bug report here</IssueLink>.\n  </>\n);\n\nconst ERROR_TYPE_DESCRIPTIONS: { [T in VolumeLoadErrorType]: React.ReactNode } = {\n  [VolumeLoadErrorType.UNKNOWN]: (\n    <>\n      An unknown error occurred while loading volume data. Check the browser console (F12) for more details. If this\n      looks like a bug, <IssueLink bug>send us a bug report here</IssueLink>.\n    </>\n  ),\n  [VolumeLoadErrorType.NOT_FOUND]: (\n    <>\n      The viewer was unable to find any volume data at the specified location. Check that the provided URL is correct\n      and try again.\n    </>\n  ),\n  [VolumeLoadErrorType.TOO_LARGE]: (\n    <>\n      No scale level is available for this volume which fits within our maximum GPU memory footprint. This maximum is\n      tuned to ensure compatibility with the majority of browsers. If you&apos;re trying to load your own OME-Zarr\n      dataset, you may be able to open this volume by including a lower scale level.\n    </>\n  ),\n  [VolumeLoadErrorType.LOAD_DATA_FAILED]: (\n    <>\n      The viewer was able to find a source of volume data at the specified location, but encountered an error while\n      trying to load it. Check that your dataset is complete and properly formatted. You can also check the browser\n      console (F12) for more details about this error. If it looks like a problem on our end,{\" \"}\n      <IssueLink bug>start a bug report here</IssueLink>.\n    </>\n  ),\n  [VolumeLoadErrorType.INVALID_METADATA]: (\n    <>\n      The viewer was unable to read all necessary information from this volume&apos;s metadata. Check that your\n      dataset&apos;s metadata is complete and properly formatted. If you believe your data is valid and should be\n      supported by our viewer, let us know by <IssueLink>opening a GitHub issue</IssueLink>.\n    </>\n  ),\n  [VolumeLoadErrorType.INVALID_MULTI_SOURCE_ZARR]: (\n    <>\n      The viewer is currently configured to consolidate multiple OME-Zarr datasets into a single volume, but the\n      provided datasets can&apos;t all be matched up. Ensure that all dataset URLs are correct and that at least one\n      equivalently-sized scale level exists in all datasets.\n    </>\n  ),\n};\n\nconst getErrorTitle = (error: unknown): string =>\n  (error instanceof Error && error.toString?.()) || (typeof error === \"string\" && error) || \"Unknown error\";\n\nconst getErrorDescription = (error: unknown): React.ReactNode => {\n  const type: VolumeLoadErrorType | undefined = (error as VolumeLoadError).type;\n  if (!type) {\n    return UNKNOWN_ERROR_DESCRIPTION;\n  }\n  return ERROR_TYPE_DESCRIPTIONS[type] ?? UNKNOWN_ERROR_DESCRIPTION;\n};\n\nexport type ErrorAlertProps = {\n  errors: unknown;\n  /** The number of times we've seen an error of the type that is currently being displayed before */\n  firstErrorCount?: number;\n  afterClose?: () => void;\n  onSkipError?: () => void;\n};\n\nconst ErrorAlert: React.FC<ErrorAlertProps> = ({ errors, firstErrorCount = 0, afterClose, onSkipError }) => {\n  const [showDetails, setShowDetails] = React.useState(false);\n  const [errorsSeenCount, setErrorsSeenCount] = React.useState(0);\n  const error = Array.isArray(errors) ? errors[0] : errors;\n\n  const errorMessage = (\n    <>\n      <div>\n        {getErrorTitle(error) + (firstErrorCount > 1 ? ` (${firstErrorCount})` : \"\")}{\" \"}\n        <Button type=\"text\" onClick={() => setShowDetails(!showDetails)}>\n          {showDetails ? \"Show less info\" : \"Show more info\"}\n        </Button>\n      </div>\n      <div style={{ display: showDetails ? undefined : \"none\" }}>{getErrorDescription(error)}</div>\n    </>\n  );\n\n  const skipErrorButton = Array.isArray(errors) && errors.length > 1 && (\n    <Button\n      type=\"text\"\n      onClick={() => {\n        setErrorsSeenCount((count) => count + 1);\n        onSkipError?.();\n      }}\n    >\n      Error {errorsSeenCount + 1} of {errors.length + errorsSeenCount} <RightOutlined />\n    </Button>\n  );\n\n  return (\n    <Alert\n      showIcon\n      type=\"error\"\n      className=\"load-error-alert\"\n      message={errorMessage}\n      closable\n      afterClose={() => {\n        setErrorsSeenCount(0);\n        afterClose?.();\n      }}\n      action={skipErrorButton}\n    />\n  );\n};\n\nexport const useErrorAlert = (): [React.ReactNode, (error: unknown) => void] => {\n  const [errorList, setErrorList] = React.useState<unknown[]>([]);\n  // Keep track of which errors have been seen and how many times\n  const seenErrors = useConstructor(() => new Map<string, number>());\n  const [errorCounts, setErrorCounts] = React.useState<number[]>([]);\n\n  const addError = React.useCallback(\n    (error: unknown) => {\n      console.error(error);\n      const errorTitle = getErrorTitle(error);\n      const errorSeenCount = (seenErrors.get(errorTitle) ?? 0) + 1;\n\n      setErrorList((prev) => [...prev, error]);\n      setErrorCounts((prev) => [...prev, errorSeenCount]);\n      seenErrors.set(errorTitle, errorSeenCount);\n    },\n    [seenErrors]\n  );\n\n  const onSkipError = React.useCallback(() => {\n    setErrorList((prev) => prev.slice(1));\n    setErrorCounts((prev) => prev.slice(1));\n  }, []);\n\n  const afterClose = React.useCallback(() => {\n    setErrorList([]);\n    setErrorCounts([]);\n  }, []);\n\n  const errCount = errorCounts[0];\n  const alertComponent = errorList.length > 0 && (\n    <ErrorAlert errors={errorList} firstErrorCount={errCount} onSkipError={onSkipError} afterClose={afterClose} />\n  );\n  return [alertComponent, addError];\n};\n\nexport default ErrorAlert;\n","import { isEqual } from \"lodash\";\n\nimport { ChannelState, ViewerState, ViewerStateContextType, ResetState } from \"./types\";\nimport {\n  getDefaultViewerState,\n  getDefaultCameraState,\n  getDefaultChannelState,\n  getDefaultViewerChannelSettings,\n  getDefaultChannelColor,\n} from \"../../shared/constants\";\nimport { ViewMode } from \"../../shared/enums\";\nimport {\n  overrideViewerState,\n  overrideChannelStates,\n  getEnabledChannelIndices,\n  initializeOneChannelSetting,\n} from \"../../shared/utils/viewerState\";\nimport { ViewerChannelSettings } from \"../../shared/utils/viewerChannelSettings\";\n\n/**\n * Provides reset functionality for the viewer and channel states.\n */\nexport default class ResetStateProvider implements ResetState {\n  savedViewerState: Partial<ViewerState>;\n  savedViewerChannelSettings: ViewerChannelSettings | undefined;\n  useDefaultViewerChannelSettings: boolean;\n\n  channelsToReset: Set<number>;\n  channelsToResetOnLoad: Set<number>;\n\n  ref: React.MutableRefObject<ViewerStateContextType>;\n\n  constructor(viewerStateRef: React.MutableRefObject<ViewerStateContextType>) {\n    this.ref = viewerStateRef;\n\n    this.savedViewerState = {};\n    this.channelsToReset = new Set();\n    this.channelsToResetOnLoad = new Set();\n    this.savedViewerChannelSettings = undefined;\n    this.useDefaultViewerChannelSettings = false;\n\n    this.resetToSavedViewerState = this.resetToSavedViewerState.bind(this);\n    this.resetToDefaultViewerState = this.resetToDefaultViewerState.bind(this);\n    this.resetToState = this.resetToState.bind(this);\n    this.setSavedViewerState = this.setSavedViewerState.bind(this);\n    this.setSavedViewerChannelSettings = this.setSavedViewerChannelSettings.bind(this);\n    this.getChannelsAwaitingReset = this.getChannelsAwaitingReset.bind(this);\n    this.getChannelsAwaitingResetOnLoad = this.getChannelsAwaitingResetOnLoad.bind(this);\n    this.onResetChannel = this.onResetChannel.bind(this);\n    this.getCurrentViewerChannelSettings = this.getCurrentViewerChannelSettings.bind(this);\n  }\n\n  // Setup Callbacks ////////////////////////////////////////////////////////////////////\n\n  public setSavedViewerState(state: Partial<ViewerState>): void {\n    this.savedViewerState = state;\n  }\n\n  public setSavedViewerChannelSettings(settings: ViewerChannelSettings | undefined): void {\n    this.savedViewerChannelSettings = settings;\n  }\n\n  public getChannelsAwaitingReset(): Set<number> {\n    return this.channelsToReset;\n  }\n\n  public getChannelsAwaitingResetOnLoad(): Set<number> {\n    return this.channelsToResetOnLoad;\n  }\n\n  public onResetChannel(channelIndex: number): void {\n    this.channelsToReset.delete(channelIndex);\n    this.channelsToResetOnLoad.delete(channelIndex);\n  }\n\n  /**\n   * Returns the current viewer channel settings that the viewer should use when\n   * resetting channels to an initial state.\n   */\n  public getCurrentViewerChannelSettings(): ViewerChannelSettings | undefined {\n    if (this.useDefaultViewerChannelSettings) {\n      return getDefaultViewerChannelSettings();\n    }\n    return this.savedViewerChannelSettings;\n  }\n\n  /**\n   * Helper method. Resets the viewer and all channels to the provided state. If new data needs to\n   * be loaded, handles setup so the reset will be applied to each channel as it loads in.\n   */\n  private resetToState(newState: ViewerState, newChannelStates: ChannelState[]): void {\n    const { changeViewerSetting, setChannelSettings, channelSettings, viewMode, time, slice } = this.ref.current;\n\n    // Needs reset on reload if one of the view modes is 2D while the other is 3D,\n    // if the timestamp is different, or if we're on a different z slice.\n    // TODO: Handle stopping playback? Requires playback to be part of ViewerStateContext\n    const isInDifferentViewMode =\n      viewMode !== newState.viewMode && (viewMode === ViewMode.xy || newState.viewMode === ViewMode.xy);\n    const isAtDifferentTime = time !== newState.time;\n    const isAtDifferentZSlice = newState.viewMode === ViewMode.xy && !isEqual(newState.slice.z, slice.z);\n    const willNeedResetOnLoad = isInDifferentViewMode || isAtDifferentTime || isAtDifferentZSlice;\n\n    overrideViewerState(changeViewerSetting, newState);\n    overrideChannelStates(setChannelSettings, channelSettings, newChannelStates);\n\n    this.channelsToReset = new Set(Array(newChannelStates.length).keys());\n    if (willNeedResetOnLoad) {\n      const enabledChannelsAndResetState = getEnabledChannelIndices(newChannelStates);\n      this.channelsToResetOnLoad = new Set(enabledChannelsAndResetState);\n      for (const channelIndex of enabledChannelsAndResetState) {\n        this.channelsToReset.delete(channelIndex);\n      }\n    }\n  }\n\n  /** Resets to the initial saved state of the viewer, as shown to the user on load. */\n  public resetToSavedViewerState(): void {\n    const { channelSettings } = this.ref.current;\n    const newViewerState = {\n      ...getDefaultViewerState(),\n      cameraState: getDefaultCameraState(this.savedViewerState.viewMode || ViewMode.threeD),\n      ...this.savedViewerState,\n    };\n    const newChannelSettings = channelSettings.map((_, index) => {\n      const initialChannelSetting = initializeOneChannelSetting(\n        channelSettings[index].name,\n        index,\n        getDefaultChannelColor(index),\n        this.savedViewerChannelSettings\n      );\n      return {\n        ...initialChannelSetting,\n        plotMin: channelSettings[index].plotMin,\n        plotMax: channelSettings[index].plotMax,\n      };\n    });\n    this.resetToState(newViewerState, newChannelSettings);\n    this.useDefaultViewerChannelSettings = false;\n  }\n\n  /** Reset to global default viewer state, as if loading the volume with no parameters. */\n  public resetToDefaultViewerState(): void {\n    const { channelSettings } = this.ref.current;\n    const defaultViewerState = { ...getDefaultViewerState(), cameraState: getDefaultCameraState(ViewMode.threeD) };\n    const defaultChannelStates = channelSettings.map((_, index) => getDefaultChannelState(index));\n\n    for (let i = 0; i < Math.min(3, defaultChannelStates.length); i++) {\n      defaultChannelStates[i].volumeEnabled = true;\n    }\n\n    this.resetToState(defaultViewerState, defaultChannelStates);\n    this.useDefaultViewerChannelSettings = true;\n  }\n}\n","import { isEqual } from \"lodash\";\nimport React, { useCallback, useContext, useEffect, useMemo, useReducer, useRef } from \"react\";\n\nimport { getDefaultViewerChannelSettings, getDefaultViewerState } from \"../../shared/constants\";\nimport { RenderMode, ViewMode } from \"../../shared/enums\";\nimport { ColorArray } from \"../../shared/utils/colorRepresentations\";\nimport { useConstructor } from \"../../shared/utils/hooks\";\nimport type {\n  ChannelSettingUpdater,\n  ChannelState,\n  ChannelStateKey,\n  PartialIfObject,\n  ViewerSettingChangeHandlers,\n  ViewerSettingUpdater,\n  ViewerState,\n  ViewerStateContextType,\n} from \"./types\";\n\nimport ResetStateProvider from \"./ResetStateProvider\";\n\nconst isObject = <T,>(val: T): val is Extract<T, Record<string, unknown>> =>\n  typeof val === \"object\" && val !== null && !Array.isArray(val);\n\n// Some viewer settings require custom change behaviors to change related settings simultaneously or guard against\n// entering an illegal state (e.g. autorotate must not be on in pathtrace mode). Those behaviors are defined here.\nconst VIEWER_SETTINGS_CHANGE_HANDLERS: ViewerSettingChangeHandlers = {\n  // View mode: if we're switching to 2d, switch to volumetric rendering\n  viewMode: (prevSettings, viewMode) => {\n    const switchToVolumetric = viewMode !== ViewMode.threeD && prevSettings.renderMode === RenderMode.pathTrace;\n    return {\n      ...prevSettings,\n      viewMode,\n      renderMode: switchToVolumetric ? RenderMode.volumetric : prevSettings.renderMode,\n    };\n  },\n  // Render mode: if we're switching to pathtrace, turn off autorotate\n  // Also, do not allow pathtrace mode in any mode other than 3D.\n  renderMode: (prevSettings, renderMode) => {\n    if (renderMode === RenderMode.pathTrace && prevSettings.viewMode !== ViewMode.threeD) {\n      return { ...prevSettings };\n    }\n    return {\n      ...prevSettings,\n      renderMode,\n      autorotate: renderMode === RenderMode.pathTrace ? false : prevSettings.autorotate,\n    };\n  },\n  // Autorotate: do not enable autorotate while in pathtrace mode\n  autorotate: (prevSettings, autorotate) => ({\n    ...prevSettings,\n    // The button should theoretically be unclickable while in pathtrace mode, but this provides extra security\n    autorotate: prevSettings.renderMode === RenderMode.pathTrace ? false : autorotate,\n  }),\n};\n\ntype ViewerStateAction<K extends keyof ViewerState> = {\n  key: K;\n  value: PartialIfObject<ViewerState[K]>;\n};\n\nconst viewerSettingsReducer = <K extends keyof ViewerState>(\n  viewerSettings: ViewerState,\n  { key, value }: ViewerStateAction<K>\n): ViewerState => {\n  const changeHandler = VIEWER_SETTINGS_CHANGE_HANDLERS[key];\n\n  if (changeHandler) {\n    // This setting has a custom change handler. Let it handle creating a new state object.\n    return changeHandler(viewerSettings, value);\n  } else {\n    const setting = viewerSettings[key];\n    if (isObject(setting) && isObject(value)) {\n      // This setting is an object, and we may be updating it with a partial object.\n      return { ...viewerSettings, [key]: { ...setting, ...value } };\n    } else {\n      // This setting is regular. Update it the regular way.\n      return { ...viewerSettings, [key]: value };\n    }\n  }\n};\n\nenum ChannelSettingActionType {\n  UniformUpdate = \"UniformUpdate\",\n  ArrayUpdate = \"ArrayUpdate\",\n  Init = \"Init\",\n}\n\n/** Set channel setting `key` on one or more channels specified by `index` to value `value`. */\ntype ChannelSettingUniformUpdateAction<K extends ChannelStateKey> = {\n  type: ChannelSettingActionType.UniformUpdate;\n  index: number | number[];\n  value: Partial<Record<K, ChannelState[K]>>;\n};\n/** Set the values of channel setting `key` for all channels from an array of values ordered by channel index */\ntype ChannelSettingArrayUpdateAction<K extends ChannelStateKey> = {\n  type: ChannelSettingActionType.ArrayUpdate;\n  key: K;\n  value: ChannelState[K][];\n};\n/** Initialize list of channel states */\ntype ChannelSettingInitAction = {\n  type: ChannelSettingActionType.Init;\n  value: ChannelState[];\n};\n\ntype ChannelStateAction<K extends ChannelStateKey> =\n  | ChannelSettingUniformUpdateAction<K>\n  | ChannelSettingArrayUpdateAction<K>\n  | ChannelSettingInitAction;\n\nconst channelSettingsReducer = <K extends ChannelStateKey>(\n  channelSettings: ChannelState[],\n  action: ChannelStateAction<K>\n): ChannelState[] => {\n  if (action.type === ChannelSettingActionType.Init) {\n    // ChannelSettingInitAction\n    return action.value;\n  } else if (action.type === ChannelSettingActionType.ArrayUpdate) {\n    // ChannelSettingArrayUpdateAction\n    return channelSettings.map((channel, idx) => {\n      return action.value[idx] ? { ...channel, [action.key]: action.value[idx] } : channel;\n    });\n  } else {\n    // type is ChannelSettingActionType.UniformUpdate\n    if (Array.isArray(action.index)) {\n      // ChannelSettingUniformUpdateAction on potentially multiple channels\n      return channelSettings.map((channel, idx) =>\n        (action.index as number[]).includes(idx) ? { ...channel, ...action.value } : channel\n      );\n    } else {\n      // ChannelSettingUniformUpdateAction on a single channel\n      const newSettings = channelSettings.slice();\n      if (action.index >= 0 && action.index < channelSettings.length) {\n        newSettings[action.index] = { ...newSettings[action.index], ...action.value };\n      }\n      return newSettings;\n    }\n  }\n};\n\nconst nullfn = (): void => {};\n\nconst DEFAULT_VIEWER_CONTEXT: ViewerStateContextType = {\n  ...getDefaultViewerState(),\n  channelSettings: [],\n  changeViewerSetting: nullfn,\n  setChannelSettings: nullfn,\n  changeChannelSetting: nullfn,\n  applyColorPresets: nullfn,\n  resetToSavedViewerState: nullfn,\n  resetToDefaultViewerState: nullfn,\n  setSavedViewerChannelSettings: nullfn,\n  getCurrentViewerChannelSettings: () => getDefaultViewerChannelSettings(),\n  getChannelsAwaitingReset: () => new Set(),\n  getChannelsAwaitingResetOnLoad: () => new Set(),\n  onResetChannel: nullfn,\n};\n\nexport const ALL_VIEWER_STATE_KEYS = Object.keys(DEFAULT_VIEWER_CONTEXT) as (keyof ViewerStateContextType)[];\n\nconst DEFAULT_VIEWER_CONTEXT_OUTER = { ref: { current: DEFAULT_VIEWER_CONTEXT } };\n\ntype NoNull<T> = { [K in keyof T]: NonNullable<T[K]> };\ntype ContextRefType = NoNull<React.MutableRefObject<ViewerStateContextType>>;\n\nexport const ViewerStateContext = React.createContext<{ ref: ContextRefType }>(DEFAULT_VIEWER_CONTEXT_OUTER);\n\n/** Provides a central store for the state of the viewer, and the methods to update it. */\nconst ViewerStateProvider: React.FC<{ viewerSettings?: Partial<ViewerState>; children?: React.ReactNode }> = (\n  props\n) => {\n  const [viewerSettings, viewerDispatch] = useReducer(viewerSettingsReducer, { ...getDefaultViewerState() });\n  const [channelSettings, channelDispatch] = useReducer(channelSettingsReducer, []);\n  // Provide viewer state via a ref, so that closures that run asynchronously can capture the ref instead of the\n  // specific values they need and always have the most up-to-date state.\n  const ref = useRef(DEFAULT_VIEWER_CONTEXT);\n\n  const resetProvider = useConstructor(() => new ResetStateProvider(ref));\n  useEffect(() => {\n    resetProvider.setSavedViewerState(props.viewerSettings || {});\n  }, [props.viewerSettings, resetProvider]);\n\n  const changeViewerSetting = useCallback<ViewerSettingUpdater>((key, value) => viewerDispatch({ key, value }), []);\n\n  const changeChannelSetting = useCallback<ChannelSettingUpdater>((index, value) => {\n    channelDispatch({ type: ChannelSettingActionType.UniformUpdate, index, value });\n  }, []);\n\n  const applyColorPresets = useCallback(\n    (value: ColorArray[]): void => channelDispatch({ type: ChannelSettingActionType.ArrayUpdate, key: \"color\", value }),\n    []\n  );\n\n  const setChannelSettings = useCallback(\n    (channels: ChannelState[]) => channelDispatch({ type: ChannelSettingActionType.Init, value: channels }),\n    []\n  );\n\n  // https://react.dev/learn/you-might-not-need-an-effect#adjusting-some-state-when-a-prop-changes\n  const prevViewerSettingsPropsRef = useRef<Partial<ViewerState> | undefined>(undefined);\n  if (props.viewerSettings && !isEqual(props.viewerSettings, prevViewerSettingsPropsRef.current)) {\n    for (const key of Object.keys(props.viewerSettings) as (keyof ViewerState)[]) {\n      if (viewerSettings[key] !== props.viewerSettings[key]) {\n        changeViewerSetting(key, props.viewerSettings[key] as any);\n      }\n    }\n    prevViewerSettingsPropsRef.current = props.viewerSettings;\n  }\n\n  const context = useMemo(() => {\n    ref.current = {\n      ...viewerSettings,\n      channelSettings,\n      changeViewerSetting,\n      setChannelSettings,\n      changeChannelSetting,\n      applyColorPresets,\n      // Reset-related callbacks\n      setSavedViewerChannelSettings: resetProvider.setSavedViewerChannelSettings,\n      getCurrentViewerChannelSettings: resetProvider.getCurrentViewerChannelSettings,\n      getChannelsAwaitingReset: resetProvider.getChannelsAwaitingReset,\n      getChannelsAwaitingResetOnLoad: resetProvider.getChannelsAwaitingResetOnLoad,\n      onResetChannel: resetProvider.onResetChannel,\n      resetToSavedViewerState: resetProvider.resetToSavedViewerState,\n      resetToDefaultViewerState: resetProvider.resetToDefaultViewerState,\n    };\n\n    // `ref` is wrapped in another object to ensure that the context updates when state does.\n    // (`ref` on its own would always compare equal to itself and the context would never update.)\n    return { ref };\n  }, [\n    viewerSettings,\n    channelSettings,\n    applyColorPresets,\n    changeViewerSetting,\n    changeChannelSetting,\n    setChannelSettings,\n    resetProvider,\n  ]);\n\n  return <ViewerStateContext.Provider value={context}>{props.children}</ViewerStateContext.Provider>;\n};\n\n/**\n * Higher-order component that connects a component to the viewer state context.\n *\n * Accepts a `component` and an array of `keys` from the viewer state context, and returns a new memoized component\n * which \"subscribes\" to only those fields of state, and will not re-render if other fields change. This works by\n * creating a component which is \"split in two\" as described\n * [here](https://react.dev/reference/react/memo#updating-a-memoized-component-using-a-context).\n *\n * NOTE that while higher-order components don't seem to be explicitly considered an anti-pattern, they don't appear in\n * modern documentation because they are \"[not commonly used in modern React\n * code](https://legacy.reactjs.org/docs/higher-order-components.html).\" React-redux, which inspired this \"connect\"\n * pattern, has also generally moved away from this pattern [in favor of a hooks-based\n * approach](https://react-redux.js.org/api/hooks). I too would love to use hooks to connect to viewer state, but there\n * is currently no way to hook into context without agreeing to re-render on every change. I feel okay using a higher-\n * order component in this case because, analogous to a custom hook, it extends a provided primitive HOC (`memo`).\n */\nexport function connectToViewerState<\n  Keys extends keyof ViewerStateContextType,\n  Props extends Pick<ViewerStateContextType, Keys>,\n>(component: React.FC<Props>, keys: Keys[]): React.FC<Omit<Props, Keys>> {\n  const MemoedComponent = React.memo(component);\n\n  const ConnectedComponent: React.FC<Omit<Props, Keys>> = (props) => {\n    const viewerState = useContext(ViewerStateContext);\n\n    const mergedProps = { ...props } as Props;\n    for (const key of keys) {\n      (mergedProps as Pick<ViewerStateContextType, Keys>)[key] = viewerState.ref.current[key];\n    }\n\n    return <MemoedComponent {...mergedProps} />;\n  };\n\n  ConnectedComponent.displayName = `Connected(${component.displayName || component.name})`;\n  return ConnectedComponent;\n}\n\nexport default ViewerStateProvider;\n","import { type CameraState, type Channel, PrefetchDirection } from \"@aics/vole-core\";\n\nimport { ChannelState, ViewerState } from \"../components/ViewerStateProvider/types\";\nimport { ImageType, RenderMode, ViewMode } from \"./enums\";\nimport { AxisName } from \"./types\";\nimport { ColorArray } from \"./utils/colorRepresentations\";\nimport { ViewerChannelSettings } from \"./utils/viewerChannelSettings\";\n\n// Add all exported constants here to prevent circular dependencies\nexport const // Control panel will automatically close if viewport is less than this width\n  CONTROL_PANEL_CLOSE_WIDTH = 970,\n  CLIPPING_PANEL_HEIGHT_DEFAULT = 200,\n  CLIPPING_PANEL_HEIGHT_TALL = 235,\n  BACKGROUND_COLOR_DEFAULT: ColorArray = [0, 0, 0],\n  BOUNDING_BOX_COLOR_DEFAULT: ColorArray = [255, 255, 255],\n  AXIS_MARGIN_DEFAULT: [number, number] = [16, 16],\n  SCALE_BAR_MARGIN_DEFAULT: [number, number] = [120, 12],\n  // These settings were chosen to work well with most AICS microscopy pipeline images.\n  // These numbers mean: remap the bottom LUT_MIN_PERCENTILE fraction of pixels to zero intensity,\n  // and linearly increase intensity up to the LUT_MAX_PERCENTILE fraction of pixels.\n  LUT_MIN_PERCENTILE = 0.5,\n  LUT_MAX_PERCENTILE = 0.983,\n  ISOSURFACE_OPACITY_SLIDER_MAX = 255.0,\n  ALPHA_MASK_SLIDER_DEFAULT = 0,\n  BRIGHTNESS_SLIDER_LEVEL_DEFAULT = 70,\n  DENSITY_SLIDER_LEVEL_DEFAULT = 50,\n  LEVELS_SLIDER_DEFAULT: ColorArray = [35.0, 140.0, 255.0],\n  INTERPOLATION_ENABLED_DEFAULT = true,\n  OTHER_CHANNEL_KEY = \"Other\",\n  SINGLE_GROUP_CHANNEL_KEY = \"Channels\";\n\nexport const TFEDITOR_DEFAULT_COLOR: ColorArray = [255, 255, 255];\nexport const TFEDITOR_MAX_BIN = 255;\n\nexport const CACHE_MAX_SIZE = 1_000_000_000;\nexport const QUEUE_MAX_SIZE = 10;\nexport const QUEUE_MAX_LOW_PRIORITY_SIZE = 4;\n\n/** Maps an axis the user can \"play\" through to the direction to prefetch while playing that axis */\nexport const AXIS_TO_LOADER_PRIORITY: Record<AxisName | \"t\", PrefetchDirection> = {\n  t: PrefetchDirection.T_PLUS,\n  z: PrefetchDirection.Z_PLUS,\n  y: PrefetchDirection.Y_PLUS,\n  x: PrefetchDirection.X_PLUS,\n};\n\n/** Maps channel data types to their minimum and maximum values */\nexport const DTYPE_RANGE: { [T in Channel[\"dtype\"]]: { min: number; max: number } } = {\n  int8: { min: -Math.pow(2, 7), max: Math.pow(2, 7) - 1 },\n  int16: { min: -Math.pow(2, 15), max: Math.pow(2, 15) - 1 },\n  int32: { min: -Math.pow(2, 31), max: Math.pow(2, 31) - 1 },\n  uint8: { min: 0, max: Math.pow(2, 8) - 1 },\n  uint16: { min: 0, max: Math.pow(2, 16) - 1 },\n  uint32: { min: 0, max: Math.pow(2, 32) - 1 },\n  // These are obviously not the actual min and max representable values for floats, but the actual ones (`-Infinity`\n  // and `Infinity`) would give us nonsense. These may also produce nonsense, but these types should be rare anyways.\n  float32: { min: 0, max: Math.pow(2, 8) - 1 },\n  float64: { min: 0, max: Math.pow(2, 8) - 1 },\n};\n\nexport const PRESET_COLORS_1: ColorArray[] = [\n  [190, 68, 171],\n  [189, 211, 75],\n  [61, 155, 169],\n  [128, 128, 128],\n  [255, 255, 255],\n  [239, 27, 45],\n  [238, 77, 245],\n  [96, 255, 255],\n];\nexport const PRESET_COLORS_2: ColorArray[] = [\n  [128, 0, 0],\n  [0, 128, 0],\n  [0, 0, 128],\n  [32, 32, 32],\n  [255, 255, 0],\n  [255, 0, 255],\n  [0, 255, 0],\n  [0, 0, 255],\n];\n\nexport const PRESET_COLORS_3: ColorArray[] = [\n  [128, 0, 128],\n  [128, 128, 128],\n  [0, 128, 128],\n  [128, 128, 0],\n  [255, 255, 255],\n  [255, 0, 0],\n  [255, 0, 255],\n  [0, 255, 255],\n];\n\nexport const PRESET_COLORS_0: ColorArray[] = [\n  [226, 205, 179],\n  [111, 186, 17],\n  [141, 163, 192],\n  [245, 241, 203],\n  [224, 227, 209],\n  [221, 155, 245],\n  [227, 244, 245],\n  [255, 98, 0],\n  [247, 219, 120],\n];\n\nexport const PRESET_COLOR_MAP = Object.freeze([\n  {\n    colors: PRESET_COLORS_0,\n    name: \"Default\",\n  },\n  {\n    colors: PRESET_COLORS_1,\n    name: \"Thumbnail colors\",\n  },\n  {\n    colors: PRESET_COLORS_2,\n    name: \"RGB colors\",\n  },\n  {\n    colors: PRESET_COLORS_3,\n    name: \"White structure\",\n  },\n]);\n\n/** Allows the 3D viewer to apply the default camera settings for the view mode. */\nconst USE_VIEW_MODE_DEFAULT_CAMERA = undefined;\n\nconst viewModeToDefaultCameraPosition: Record<ViewMode, [number, number, number]> = {\n  [ViewMode.threeD]: [0, 0, 5],\n  [ViewMode.xy]: [0, 0, 2],\n  [ViewMode.xz]: [0, 2, 0],\n  [ViewMode.yz]: [2, 0, 0],\n};\n\nconst viewModeToDefaultCameraUp: Record<ViewMode, [number, number, number]> = {\n  [ViewMode.threeD]: [0, 1, 0],\n  [ViewMode.xy]: [0, 1, 0],\n  [ViewMode.xz]: [0, 0, 1],\n  [ViewMode.yz]: [0, 0, 1],\n};\n\n/**\n * Reflects the default camera settings the 3D viewer uses on volume load.\n * These SHOULD NOT be changed; otherwise, existing shared links that don't specify the\n * camera settings will use the new defaults and may be in unexpected orientations or positions.\n */\nexport const getDefaultCameraState = (viewMode: ViewMode = ViewMode.threeD): CameraState => ({\n  // Default position varies by view mode\n  position: viewModeToDefaultCameraPosition[viewMode],\n  target: [0, 0, 0],\n  up: viewModeToDefaultCameraUp[viewMode],\n  fov: 20,\n  orthoScale: 0.5,\n});\n\nexport const getDefaultViewerChannelSettings = (): ViewerChannelSettings => ({\n  groups: [\n    {\n      name: \"Channels\",\n      channels: [\n        { match: [0, 1, 2], enabled: true },\n        { match: \"(.+)\", enabled: false },\n      ],\n    },\n  ],\n});\n\n/**\n * Returns the default viewer state as a new object.\n */\nexport const getDefaultViewerState = (): ViewerState => ({\n  viewMode: ViewMode.threeD, // \"XY\", \"XZ\", \"YZ\"\n  renderMode: RenderMode.volumetric, // \"pathtrace\", \"maxproject\"\n  imageType: ImageType.segmentedCell,\n  showAxes: false,\n  showBoundingBox: false,\n  backgroundColor: BACKGROUND_COLOR_DEFAULT,\n  boundingBoxColor: BOUNDING_BOX_COLOR_DEFAULT,\n  autorotate: false,\n  maskAlpha: ALPHA_MASK_SLIDER_DEFAULT,\n  brightness: BRIGHTNESS_SLIDER_LEVEL_DEFAULT,\n  density: DENSITY_SLIDER_LEVEL_DEFAULT,\n  levels: LEVELS_SLIDER_DEFAULT,\n  interpolationEnabled: INTERPOLATION_ENABLED_DEFAULT,\n  region: { x: [0, 1], y: [0, 1], z: [0, 1] },\n  slice: { x: 0.5, y: 0.5, z: 0.5 },\n  time: 0,\n  scene: 0,\n  // Do not override camera position, target, etc. by default;\n  // instead, let the viewer apply default camera settings based on the view mode.\n  // This prevents a bug where the camera's position and view mode are set to\n  // incompatible states and the viewport becomes blank.\n  cameraState: USE_VIEW_MODE_DEFAULT_CAMERA,\n  resetIntensityPerVolume: true,\n});\n\nconst INIT_COLORS = PRESET_COLORS_0;\n\n/** Returns the default color for a channel, by its index. */\nexport function getDefaultChannelColor(channelIndex: number): ColorArray {\n  return INIT_COLORS[channelIndex % INIT_COLORS.length];\n}\n\n/**\n * Returns the default channel state as a new object. If an index is provided, uses the default\n * color preset for that index.\n * @param index Optional channel index to use for the color preset.\n * @returns a default ChannelState object.\n */\nexport const getDefaultChannelState = (index: number = 0): ChannelState => {\n  return {\n    name: \"\",\n    displayName: \"\",\n    volumeEnabled: false,\n    isosurfaceEnabled: false,\n    colorizeEnabled: false,\n    colorizeAlpha: 1.0,\n    isovalue: 128,\n    opacity: 1.0,\n    color: getDefaultChannelColor(index),\n    useControlPoints: false,\n    ramp: [0, TFEDITOR_MAX_BIN],\n    controlPoints: [\n      { x: 0, opacity: 0, color: [255, 255, 255] },\n      { x: 255, opacity: 1, color: [255, 255, 255] },\n    ],\n    plotMin: 0,\n    plotMax: TFEDITOR_MAX_BIN,\n  };\n};\n","export enum ViewMode {\n  threeD = \"3D\",\n  xy = \"XY\",\n  xz = \"XZ\",\n  yz = \"YZ\",\n}\n\nexport enum RenderMode {\n  volumetric = \"volumetric\",\n  maxProject = \"maxproject\",\n  pathTrace = \"pathtrace\",\n}\n\nexport enum ImageType {\n  segmentedCell = \"cell\",\n  fullField = \"fov\",\n}\n","import { MutableRefObject, useCallback, useRef } from \"react\";\n\n/**\n * Wraps a setter function and keeps a ref updated to follow the set value. Useful for making the most up-to-date value\n * of some state accessible to a closure that might be called after the value is updated.\n */\n// TODO should this replace `useStateWithGetter`?\nexport function useRefWithSetter<T>(setter: (value: T) => void): [MutableRefObject<T | undefined>, (value: T) => void];\nexport function useRefWithSetter<T>(setter: (value: T) => void, init: T): [MutableRefObject<T>, (value: T) => void];\nexport function useRefWithSetter<T>(\n  setter: (value: T) => void,\n  init?: T\n): [MutableRefObject<T | undefined>, (value: T) => void] {\n  const value = useRef<T | undefined>(init);\n  const wrappedSetter = useCallback(\n    (newValue: T) => {\n      value.current = newValue;\n      setter(newValue);\n    },\n    [setter, value]\n  );\n  return [value, wrappedSetter];\n}\n\n/**\n * For objects which are persistent for the lifetime of the component, not\n * a member of state, and require a constructor to create. Wraps `useRef`.\n */\nexport function useConstructor<T>(constructor: () => T): T {\n  const value = useRef<T | null>(null);\n  if (value.current === null) {\n    value.current = constructor();\n  }\n  return value.current;\n}\n","import { isEqual } from \"lodash\";\n\n/**\n * Returns a (shallow) copy of an object with all properties that are\n * `undefined` removed.\n */\nexport function removeUndefinedProperties<T>(obj: T): Partial<T> {\n  const result: Partial<T> = {};\n  for (const key in obj) {\n    if (obj[key] !== undefined) {\n      result[key] = obj[key];\n    }\n  }\n  return result;\n}\n\n/**\n * Returns a copy of `obj` where all properties with values that match the properties of `match`\n * are removed. Matching is determined by deep equality (see `isDeepEqual()`).\n */\nexport function removeMatchingProperties<T extends Object>(obj: Partial<T>, match: T): Partial<T> {\n  const result: Partial<T> = {};\n  for (const key in obj) {\n    if (!isEqual(obj[key], match[key])) {\n      result[key] = obj[key];\n    }\n  }\n  return result;\n}\n","import {\n  DocumentData,\n  DocumentReference,\n  DocumentSnapshot,\n  FirebaseFirestore,\n  QuerySnapshot,\n} from \"@firebase/firestore-types\";\n\n// TODO: These types are shared with Cell Feature Explorer. Can they be moved to\n// a shared package?\n\nexport interface DatasetMetaData {\n  name: string;\n  version: string;\n  datasets?: { [key: string]: DatasetMetaData };\n  id: string;\n  description: string;\n  image: string;\n  link?: string;\n  manifest?: string;\n  production?: boolean;\n  userData: {\n    isNew: boolean;\n    inReview: boolean;\n    totalTaggedStructures: number;\n    totalCells: number;\n    totalFOVs: number;\n  };\n}\nexport interface FileInfo {\n  CellId: string;\n  CellLineName: string;\n  FOVId: string;\n  structureProteinName: string;\n  fovThumbnailPath: string;\n  fovVolumeviewerPath: string;\n  thumbnailPath: string;\n  volumeviewerPath: string;\n}\n\ninterface ManifestDocumentData extends DocumentData {\n  featuresDataPath: string;\n  cellLineDataPath: string;\n  thumbnailRoot: string;\n  downloadRoot: string;\n  volumeViewerDataRoot: string;\n  featuresDisplayOrder: string[];\n  defaultXAxis: string;\n  defaultYAxis: string;\n  fileInfoPath: string;\n  featuresDataOrder: string[];\n  albumPath: string;\n  featureDefsPath: string;\n}\n\nfunction isDevOrStagingSite(host: string): boolean {\n  // first condition is for testing with no client\n  return !host || host.includes(\"localhost\") || host.includes(\"staging\") || host.includes(\"stg\");\n}\n\nclass FirebaseRequest {\n  private firestore: FirebaseFirestore;\n  private fileInfoPath: string;\n\n  // TODO: These properties are private and unused. Remove?\n  private collectionRef: DocumentReference;\n  private featuresDataPath: string;\n  private cellLineDataPath: string;\n  private thumbnailRoot: string;\n  private downloadRoot: string;\n  private volumeViewerDataRoot: string;\n  private featuresDisplayOrder: string[];\n  private datasetId: string;\n  private featuresDataOrder: string[];\n  private albumPath: string;\n  private featureDefsPath: string;\n\n  constructor(firestore: FirebaseFirestore) {\n    this.firestore = firestore;\n    this.featuresDataPath = \"\";\n    this.cellLineDataPath = \"\";\n    this.thumbnailRoot = \"\";\n    this.downloadRoot = \"\";\n    this.volumeViewerDataRoot = \"\";\n    this.featuresDisplayOrder = [];\n    this.fileInfoPath = \"\";\n    this.datasetId = \"\";\n    this.featuresDataOrder = [];\n    this.albumPath = \"\";\n    this.featureDefsPath = \"\";\n    this.collectionRef = firestore.collection(\"cfe-datasets\").doc(\"v1\");\n  }\n\n  private getDoc = (docPath: string): Promise<DocumentSnapshot<DocumentData>> => {\n    return this.firestore.doc(docPath).get();\n  };\n\n  public getAvailableDatasets = (): Promise<DatasetMetaData[]> => {\n    return this.firestore\n      .collection(\"dataset-descriptions\")\n      .get()\n      .then((snapShot: QuerySnapshot) => {\n        const datasets: DatasetMetaData[] = [];\n\n        snapShot.forEach((doc) => {\n          const metadata = doc.data() as DatasetMetaData;\n          /** if running the site in a local development env or on staging.cfe.allencell.org\n           * include all cards, otherwise, only include cards with a production flag.\n           * this is based on hostname instead of a build time variable so we don't\n           * need a separate build for staging and production\n           */\n\n          if (isDevOrStagingSite(location.hostname)) {\n            datasets.push(metadata);\n          } else if (metadata.production) {\n            datasets.push(metadata);\n          }\n        });\n        return datasets;\n      });\n  };\n\n  public setCollectionRef = (id: string): void => {\n    this.collectionRef = this.firestore.collection(\"cfe-datasets\").doc(id);\n  };\n\n  private getManifest = (ref: string): Promise<ManifestDocumentData> => {\n    return this.firestore\n      .doc(ref)\n      .get()\n      .then((manifestDoc: DocumentData) => {\n        return manifestDoc.data();\n      });\n  };\n\n  public selectDataset = (ref: string): Promise<ManifestDocumentData> => {\n    return this.getManifest(ref).then((data) => {\n      this.featuresDataPath = data.featuresDataPath;\n      this.thumbnailRoot = data.thumbnailRoot;\n      this.downloadRoot = data.downloadRoot;\n      this.volumeViewerDataRoot = data.volumeViewerDataRoot;\n      this.featuresDisplayOrder = data.featuresDisplayOrder;\n      this.cellLineDataPath = data.cellLineDataPath;\n      this.fileInfoPath = data.fileInfoPath;\n      this.featuresDataOrder = data.featuresDataOrder;\n      this.featureDefsPath = data.featureDefsPath;\n      this.albumPath = data.albumPath;\n      return { ...data };\n    });\n  };\n\n  public getFileInfoByCellId = (cellId: string): Promise<FileInfo | undefined> => {\n    return this.getDoc(`${this.fileInfoPath}/${cellId}`).then((doc) => {\n      const data = doc.data() as FileInfo;\n      if (!data) {\n        return;\n      }\n      return {\n        ...data,\n        CellId: data.CellId.toString(),\n        FOVId: data.FOVId.toString(),\n      };\n    });\n  };\n\n  public getFileInfoByArrayOfCellIds = (cellIds: string[]): Promise<(FileInfo | undefined)[]> => {\n    return Promise.all(\n      cellIds.map((id: string) => {\n        return this.getDoc(`${this.fileInfoPath}/${id}`).then((doc) => {\n          const data = doc.data() as FileInfo;\n          if (!data) {\n            return;\n          }\n          return {\n            ...data,\n            CellId: data.CellId.toString(),\n            FOVId: data.FOVId.toString(),\n          };\n        });\n      })\n    );\n  };\n}\n\nexport default FirebaseRequest;\n","export function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n","import { CameraState, ControlPoint } from \"@aics/vole-core\";\nimport { FirebaseFirestore } from \"@firebase/firestore-types\";\nimport { isEqual } from \"lodash\";\n\nimport type { AppProps, MultisceneUrls } from \"../../components/App/types\";\nimport type { ChannelState, ViewerState, ViewerStateContextType } from \"../../components/ViewerStateProvider/types\";\nimport { getDefaultCameraState, getDefaultChannelState, getDefaultViewerState } from \"../constants\";\nimport { ImageType, RenderMode, ViewMode } from \"../enums\";\nimport type { ManifestJson, MetadataRecord, PerAxis } from \"../types\";\nimport { ColorArray } from \"./colorRepresentations\";\nimport { removeMatchingProperties, removeUndefinedProperties } from \"./datatypes\";\nimport FirebaseRequest, { type DatasetMetaData } from \"./firebase\";\nimport { clamp } from \"./math\";\nimport type { ViewerChannelSetting, ViewerChannelSettings } from \"./viewerChannelSettings\";\n\nexport const ENCODED_COMMA_REGEX = /%2C/g;\nexport const ENCODED_COLON_REGEX = /%3A/g;\nconst DEFAULT_CONTROL_POINT_COLOR: [number, number, number] = [255, 255, 255];\nconst DEFAULT_CONTROL_POINT_COLOR_CODE = \"1\";\n\n/** If the `url` query param equals this, parse image url(s) and metadata from local storage instead of params */\nconst URL_FETCH_FROM_STORAGE = \"storage\";\n\n// TODO: refactor regexes to be composed of one another rather than duplicating code\n// const COLOR_CODES: Record<string, ColorArray> = {\n//   \"0\": [0, 0, 0],\n//   \"1\": [255, 255, 255],\n//   \"-1\": [255, 255, 255],\n//   w: [255, 255, 255],\n//   k: [0, 0, 0],\n// };\n// const COLOR_CODE_REGEX = new RegExp(`(${Object.keys(COLOR_CODES).join(\"|\")})`);\n// const HEX_COLOR_REGEX = new RegExp(`(([0-9a-fA-F]{6})|${COLOR_CODE_REGEX.source})`);\n\nconst CHANNEL_STATE_KEY_REGEX = /^c[0-9]+$/;\n/** Match colon-separated pairs of alphanumeric strings */\nconst LUT_REGEX = /^-?[a-z0-9.]*:[ ]*-?[a-z0-9.]*$/;\n/** Match colon-separated pairs of numeric strings */\nconst RAMP_REGEX = /^-?[0-9.]*:-?[0-9.]*$/;\n/**\n * Match comma-separated triplet of numeric strings.\n */\nconst SLICE_REGEX = /^[0-9.]*,[0-9.]*,[0-9.]*$/;\n/**\n * Matches a sequence of three comma-separated min:max number pairs, representing\n * the x, y, and z axes.\n */\nconst REGION_REGEX = /^([0-9.]*:[0-9.]*)(,[0-9.]*:[0-9.]*){2}$/;\n\nconst HEX_COLOR_REGEX = new RegExp(`(([0-9a-fA-F]{6})|${DEFAULT_CONTROL_POINT_COLOR_CODE})`);\nconst NUMERIC_REGEX = /-?[0-9.]*/;\nconst CONTROL_POINT_REGEX = new RegExp(`(${NUMERIC_REGEX.source}:${NUMERIC_REGEX.source}:${HEX_COLOR_REGEX.source})`);\n\nconst HEX_COLOR_STR_REGEX = new RegExp(`^${HEX_COLOR_REGEX.source}$`);\n\n/**\n * LEGACY: Matches a COMMA-separated list of control points, where each control point is represented\n * by a triplet of `{x}:{opacity}:{hex color}`.\n * The hex color can be replaced with `w` to represent white (`ffffff`).\n */\nexport const LEGACY_CONTROL_POINTS_REGEX = new RegExp(\n  `^${CONTROL_POINT_REGEX.source}(,${CONTROL_POINT_REGEX.source})*$`\n);\n/**\n * Matches a COLON-separated list of control points, where each control point is represented\n * by a triplet of `{x}:{opacity}:{hex color}`.\n * The hex color can be replaced with `w` to represent white (`ffffff`).\n */\nexport const CONTROL_POINTS_REGEX = new RegExp(`^${CONTROL_POINT_REGEX.source}(:${CONTROL_POINT_REGEX.source})*$`);\n\n/**\n * Enum keys for URL parameters. These are stored as enums for better readability,\n * and are mapped to types in `ViewerStateParams`.\n */\nexport enum ViewerStateKeys {\n  View = \"view\",\n  Mode = \"mode\",\n  Mask = \"mask\",\n  Image = \"image\",\n  Axes = \"axes\",\n  BoundingBox = \"bb\",\n  BoundingBoxColor = \"bbcol\",\n  BackgroundColor = \"bgcol\",\n  Autorotate = \"rot\",\n  Brightness = \"bright\",\n  Density = \"dens\",\n  Levels = \"lvl\",\n  Interpolation = \"interp\",\n  Region = \"reg\",\n  Slice = \"slice\",\n  Time = \"t\",\n  Scene = \"scene\",\n  CameraState = \"cam\",\n  ResetIntensityPerVolume = \"reset\",\n}\n\nexport enum CameraTransformKeys {\n  /** Camera position in 3D coordinates. */\n  Position = \"pos\",\n  /** Target position of the trackball controls in 3D coordinates. */\n  Target = \"tar\",\n  /** The up vector of the camera. Will be normalized to magnitude of 1. */\n  Up = \"up\",\n  /** Scale factor for orthographic cameras. */\n  OrthoScale = \"ort\",\n  /** Vertical FOV of the camera view frustum, from top to bottom, in degrees. */\n  Fov = \"fov\",\n}\n\n/**\n * Mapped to types in `ViewerChannelSettingParams`\n */\nexport enum ViewerChannelSettingKeys {\n  Color = \"col\",\n  Colorize = \"clz\",\n  ColorizeAlpha = \"cza\",\n  IsosurfaceAlpha = \"isa\",\n  Lut = \"lut\",\n  Ramp = \"rmp\",\n  ControlPoints = \"cps\",\n  ControlPointsEnabled = \"cpe\",\n  VolumeEnabled = \"ven\",\n  SurfaceEnabled = \"sen\",\n  IsosurfaceValue = \"isv\",\n}\n\n/**\n * The serialized form of a ViewerChannelSetting, as a dictionary object.\n */\nexport class ViewerChannelSettingParams {\n  /** Color, as a 6-digit hex color.  */\n  [ViewerChannelSettingKeys.Color]?: string = undefined;\n  /** Colorize. \"1\" is enabled. Disabled by default. */\n  [ViewerChannelSettingKeys.Colorize]?: \"1\" | \"0\" = undefined;\n  /** Colorize alpha, in the [0, 1] range. Set to `1.0` by default. */\n  [ViewerChannelSettingKeys.ColorizeAlpha]?: string = undefined;\n  /** Isosurface alpha, in the [0, 1 range]. Set to `1.0` by default.*/\n  [ViewerChannelSettingKeys.IsosurfaceAlpha]?: string = undefined;\n  /**\n   * Lookup table (LUT) to map from volume intensity to opacity. Should be two\n   * alphanumeric values separated by a colon, where the first value is the\n   * minimum and the second is the maximum. Defaults to [0, 255].\n   *\n   * Min and max values are determined as following:\n   * - Plain numbers are indices of histogram bins, typically in the range [0,\n   *   255].\n   * - `v{n}` represents a raw intensity value, where `n` is a number.\n   * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100]\n   *   range.\n   * - `m{n}` represents the median multiplied by `n / 100`.\n   * - `autoij` in either the min or max fields will use the \"auto\" algorithm\n   *   from ImageJ to select the min and max.\n   *\n   * Values will be used to determine the initial control points and ramp if\n   * those fields are not provided.\n   *\n   * @example\n   * ```\n   * \"0:255\"    // min: intensity 0, max: intensity 255.\n   * \"p50:p90\"  // min: 50th percentile, max: 90th percentile.\n   * \"m1:p75\"   // min: median, max: 75th percentile.\n   * \"autoij:0\" // use Auto-IJ to calculate min and max.\n   * ```\n   */\n  [ViewerChannelSettingKeys.Lut]?: string = undefined;\n  /**\n   * Control points for the transfer function. If provided, overrides the\n   * `lut` field when calculating the control points. Should be a list\n   * of `x:opacity:color` triplets, separated by colon.\n   * - `x` is a numeric intensity value.\n   * - `opacity` is a float in the [0, 1] range.\n   * - `color` is a 6-digit hex color, e.g. `ff0000`.\n   */\n  [ViewerChannelSettingKeys.ControlPoints]?: string = undefined;\n  /**\n   * Whether to show advanced mode, which will show control points instead of\n   * ramp values defined by the LUT. \"1\" is enabled, disabled by default.\n   */\n  [ViewerChannelSettingKeys.ControlPointsEnabled]?: \"1\" | \"0\" = undefined;\n  /**\n   * Raw ramp values, which should be two numeric values separated by a colon.\n   * If provided, overrides the `lut` field when calculating the ramp values.\n   */\n  [ViewerChannelSettingKeys.Ramp]?: string = undefined;\n  /** Volume enabled. \"1\" is enabled. Disabled by default. */\n  [ViewerChannelSettingKeys.VolumeEnabled]?: \"1\" | \"0\" = undefined;\n  /** Isosurface enabled. \"1\" is enabled. Disabled by default. */\n  [ViewerChannelSettingKeys.SurfaceEnabled]?: \"1\" | \"0\" = undefined;\n  /** Isosurface value, in the [0, 255] range. Set to `128` by default. */\n  [ViewerChannelSettingKeys.IsosurfaceValue]?: string = undefined;\n}\n/**\n * Channels, matching the pattern `c0`, `c1`, etc. corresponding to the index of the channel being configured.\n * The channel parameter should have a value that is a comma-separated list of `key:value` pairs, with keys\n * defined in `ViewerChannelSettingJson`.\n */\ntype ChannelParams = { [_ in `c${number}`]?: string };\n\n/** Serialized version of `ViewerState`. */\nexport class ViewerStateParams {\n  /** Axis to view. Valid values are \"3D\", \"X\", \"Y\", and \"Z\". Defaults to \"3D\". */\n  [ViewerStateKeys.View]?: string = undefined;\n  /**\n   * Render mode. Valid values are \"volumetric\", \"maxproject\", and \"pathtrace\".\n   * Defaults to \"volumetric\".\n   */\n  [ViewerStateKeys.Mode]?: string = undefined;\n  /** The opacity of the mask channel, an integer in the range [0, 100]. Defaults to 50. */\n  [ViewerStateKeys.Mask]?: string = undefined;\n  /** The type of image to display. Valid values are \"cell\" and \"fov\". Defaults to \"cell\". */\n  [ViewerStateKeys.Image]?: string = undefined;\n  /** Whether to show the axes helper. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.Axes]?: string = undefined;\n  /** Whether to show the bounding box. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.BoundingBox]?: string = undefined;\n  /** The color of the bounding box, as a 6-digit hex color. */\n  [ViewerStateKeys.BoundingBoxColor]?: string = undefined;\n  /** The background color, as a 6-digit hex color. */\n  [ViewerStateKeys.BackgroundColor]?: string = undefined;\n  /** Whether to autorotate the view. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.Autorotate]?: string = undefined;\n  /** The brightness of the image, an float in the range [0, 100]. Defaults to 70. */\n  [ViewerStateKeys.Brightness]?: string = undefined;\n  /** Density, a float in the range [0, 100]. Defaults to 50. */\n  [ViewerStateKeys.Density]?: string = undefined;\n  /**\n   * Levels for image intensity adjustment. Should be three numeric values separated\n   * by commas, representing the low, middle, and high values in a [0, 255] range.\n   * Values will be sorted in ascending order; empty values will be parsed as 0.\n   */\n  [ViewerStateKeys.Levels]?: string = undefined;\n  /** Whether to enable interpolation. \"1\" is enabled. Enabled by default. */\n  [ViewerStateKeys.Interpolation]?: string = undefined;\n  /** Subregions per axis, as min:max pairs separated by commas.\n   * Defaults to full range (`0:1`) for each axis.\n   */\n  [ViewerStateKeys.Region]?: string = undefined;\n  /** Slice position per X, Y, and Z axes, as a list of comma-separated floats.\n   * 0.5 for all axes by default (e.g. `0.5,0.5,0.5`)\n   */\n  [ViewerStateKeys.Slice]?: string = undefined;\n  /** Frame number, for time-series volumes. 0 by default. */\n  [ViewerStateKeys.Time]?: string = undefined;\n  /** Scene number, for multiscene images. 0 by default. */\n  [ViewerStateKeys.Scene]?: string = undefined;\n  /**\n   * Camera transform settings, as a list of `key:value` pairs separated by commas.\n   * Valid keys are defined in `CameraTransformKeys`:\n   * - `pos`: position\n   * - `tar`: target\n   * - `up`: up\n   * - `rot`: rotation\n   * - `ort`: orthographic scales\n   *\n   * All values are an array of three floats, separated by commas and\n   * encoded using `encodeURIComponent`.\n   */\n  [ViewerStateKeys.CameraState]?: string = undefined;\n  /** Whether to reset intensity settings when a new volume is loaded. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.ResetIntensityPerVolume]?: string = undefined;\n}\n\n/** URL parameters that define data sources when loading volumes. */\nclass DataParams {\n  /**\n   * One or more volume URLs to load. If multiple URLs are provided, they should\n   * be separated by commas.\n   */\n  url?: string = undefined;\n  /**\n   * The URL of a JSON manifest. The JSON should contain two properties:\n   *  - \"scenes\": A string array of volume URLs.\n   *  - \"meta\": An array of metadata dictionary objects.\n   *\n   * See `ManifestJson` for the type definition.\n   */\n  manifest?: string = undefined;\n  /**\n   * The name of a dataset in the Cell Feature Explorer database. Used with `id`.\n   */\n  dataset?: string = undefined;\n  /**\n   * The ID of a cell within the loaded dataset. Used with `dataset`.\n   */\n  id?: string = undefined;\n}\n\nclass DeprecatedParams {\n  /** Deprecated query parameter for channel settings. */\n  ch?: string = undefined;\n  /** Deprecated query parameter for LUT settings. */\n  luts?: string = undefined;\n  /** Deprecated query parameter for channel colors. */\n  colors?: string = undefined;\n}\n\ntype AppParams = Partial<ViewerStateParams & DataParams & DeprecatedParams & ChannelParams>;\n\nconst allowedParamKeys: Array<keyof AppParams> = [\n  ...Object.keys(new ViewerStateParams()),\n  ...Object.keys(new DataParams()),\n  ...Object.keys(new DeprecatedParams()),\n] as Array<keyof AppParams>;\nconst isParamKey = (key: string): key is keyof AppParams => allowedParamKeys.indexOf(key as keyof AppParams) !== -1;\nconst isChannelKey = (key: string): key is keyof ChannelParams => CHANNEL_STATE_KEY_REGEX.test(key);\n\n/**\n * Filters a set of URLSearchParams for only the keys that are valid parameters for the viewer.\n * Non-matching keys are discarded.\n * @param searchParams Input URL search parameters.\n * @returns a dictionary object matching the type of `Params`.\n */\nexport function getAllowedParams(searchParams: URLSearchParams): AppParams {\n  const result: AppParams = {};\n  for (const [key, value] of searchParams.entries()) {\n    if (isParamKey(key) || isChannelKey(key)) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n\nconst decodeURL = (url: string): string => {\n  const decodedUrl = decodeURIComponent(url);\n  return decodedUrl.endsWith(\"/\") ? decodedUrl.slice(0, -1) : decodedUrl;\n};\n\n/** Try to parse a `string` as a list of 2 or more URLs. Returns `undefined` if the string is not a valid URL list. */\nconst tryDecodeURLList = (url: string, delim: string | RegExp = \",\"): string[] | undefined => {\n  if (typeof delim === \"string\" ? !url.includes(delim) : !delim.test(url)) {\n    return undefined;\n  }\n\n  const urls = url.split(delim).map((u) => decodeURL(u));\n\n  // Verify that all urls are valid\n  for (const u of urls) {\n    try {\n      new URL(u);\n    } catch (_e) {\n      return undefined;\n    }\n  }\n\n  return urls;\n};\n\n//// DATA PARSING //////////////////////\n\n/**\n * Parse a string list of comma-separated key:value pairs into\n * a key-value object.\n *\n * @param data The string to parse. Expected to be in the format\n * \"key1:value1,key2:value2,...\". Commas in keys or values\n * must be encoded using `encodeURIComponent`.\n * @returns An object with the parsed key-value pairs. Key and value strings\n *  will be decoded using `decodeURIComponent`.\n */\nexport function parseKeyValueList(data: string): Record<string, string> {\n  if (data === \"\") {\n    return {};\n  }\n  const result: Record<string, string> = {};\n  const keyValuePairs = data.split(\",\");\n  for (const pair of keyValuePairs) {\n    const splitIndex = pair.indexOf(\":\");\n    const key = pair.slice(0, splitIndex);\n    const value = pair.slice(splitIndex + 1);\n    result[decodeURIComponent(key).trim()] = decodeURIComponent(value).trim();\n  }\n  return result;\n}\n\nfunction decodeColons(str: string): string {\n  return str.replace(ENCODED_COLON_REGEX, \":\");\n}\n\nexport function objectToKeyValueList(obj: Record<string, string | undefined>): string {\n  const keyValuePairs: string[] = [];\n  for (const key in obj) {\n    const value = obj[key];\n    if (value === undefined) {\n      continue;\n    }\n    // Allow colon separators to remain unencoded to save URL character length.\n    const escapedValue = decodeColons(encodeURIComponent(value.trim()));\n    keyValuePairs.push(`${encodeURIComponent(key.trim())}:${escapedValue}`);\n  }\n  return keyValuePairs.join(\",\");\n}\n\n/**\n * Parses a string to a float and clamps the result to the [min, max] range.\n * Returns `undefined` if the string is undefined or NaN.\n * @param value String to parse as a float. Will be parsed with `Number.parseFloat`.\n * @param min Minimum value, inclusive.\n * @param max Maximum value, inclusive.\n * @returns\n * - The parsed number, clamped to the [min, max] range.\n * - `undefined` if the string is undefined or NaN.\n */\nexport function parseStringFloat(value: string | undefined, min: number, max: number): number | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  const number = Number.parseFloat(value);\n  return Number.isNaN(number) ? undefined : clamp(number, min, max);\n}\n\n/**\n * Parses a string to an integer and clamps the result to the [min, max] range.\n * @param value String to parse as a float. Assumes base 10, parses with `Number.parseInt(value, 10)`.\n * @param min Minimum value, inclusive.\n * @param max Maximum value, inclusive.\n * @returns\n * - The parsed number, clamped to the [min, max] range.\n * - `undefined` if the string is undefined or NaN.\n */\nexport function parseStringInt(value: string | undefined, min: number, max: number): number | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  const number = Number.parseInt(value, 10);\n  if (Number.isNaN(number)) {\n    return undefined;\n  }\n  return clamp(number, min, max);\n}\n\n/**\n * Parses a string to an enum value; if the string is not in the enum, returns the default value.\n * @param value String to parse.\n * @param enumValues Enum. Cannot be a `const enum`, as these are removed at compile time.\n * @param defaultValue Default value to return if the string is not in the enum.\n * @returns A value from the enum or the default value. Note that the return type includes `undefined`\n * if the `defaultValue` is `undefined`.\n */\nexport function parseStringEnum<E extends string, T extends E | undefined>(\n  value: string | undefined,\n  enumValues: Record<string | number | symbol, E>,\n  defaultValue: T = undefined as T\n): T {\n  if (value === undefined || !Object.values(enumValues).includes(value as E)) {\n    return defaultValue;\n  }\n  return value as T;\n}\n\n/**\n * Parses a string boolean value (\"1\" as true, \"0\" as false), and returns `undefined` if the value is `undefined`.\n */\nfunction parseStringBoolean(value: string | undefined): boolean | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  return value === \"1\";\n}\n\nexport function parseHexColorAsColorArray(hexColor: string | undefined): ColorArray | undefined {\n  if (!hexColor || !HEX_COLOR_STR_REGEX.test(hexColor)) {\n    return undefined;\n  }\n  // if (hexColor in COLOR_CODES) {\n  //   return COLOR_CODES[hexColor];\n  // }\n  if (hexColor === DEFAULT_CONTROL_POINT_COLOR_CODE) {\n    return DEFAULT_CONTROL_POINT_COLOR;\n  }\n  const r = Number.parseInt(hexColor.slice(0, 2), 16);\n  const g = Number.parseInt(hexColor.slice(2, 4), 16);\n  const b = Number.parseInt(hexColor.slice(4, 6), 16);\n  return [r, g, b];\n}\n\nfunction colorArrayToHex(color: ColorArray): string {\n  return color\n    .map((c) => c.toString(16).padStart(2, \"0\"))\n    .join(\"\")\n    .toLowerCase();\n}\n\nfunction parseStringSlice(region: string | undefined): PerAxis<number> | undefined {\n  if (!region || !SLICE_REGEX.test(region)) {\n    return undefined;\n  }\n  const [x, y, z] = region.split(\",\").map((val) => parseStringFloat(val, 0, 1));\n  if (x === undefined || y === undefined || z === undefined) {\n    return undefined;\n  }\n  return { x, y, z };\n}\n\n/**\n * Parses an array of three numbers from a string.\n * @param stringArr The string to parse. Should be three numbers separated by a separator.\n * @param options Optional parameters for parsing:\n * - `min`: Minimum value for each number. Default is negative infinity.\n * - `max`: Maximum value for each number. Default is positive infinity.\n * - `separator`: Separator between numbers. Default is `,`.\n * @returns\n * - undefined if the string is undefined or could not be parsed.\n * - An array of three numbers, clamped to the [min, max] range.\n */\nfunction parseThreeNumberArray(\n  stringArr: string | undefined,\n  options?: { min?: number; max?: number; separator?: string }\n): [number, number, number] | undefined {\n  if (!stringArr) {\n    return undefined;\n  }\n\n  const min = options?.min ?? Number.NEGATIVE_INFINITY;\n  const max = options?.max ?? Number.POSITIVE_INFINITY;\n  const separator = options?.separator ?? \",\";\n\n  const [x, y, z] = stringArr.split(separator).map((val) => parseStringFloat(val, min, max));\n  if (x === undefined || y === undefined || z === undefined) {\n    return undefined;\n  }\n  return [x, y, z];\n}\n\nfunction parseStringRegion(region: string | undefined): PerAxis<[number, number]> | undefined {\n  if (!region || !REGION_REGEX.test(region)) {\n    return undefined;\n  }\n  const [x, y, z] = region.split(\",\").map((axis): [number, number] | undefined => {\n    // each is a min/max pair\n    const [min, max] = axis.split(\":\").map((val) => parseStringFloat(val, 0, 1));\n    if (min === undefined || max === undefined) {\n      return undefined;\n    }\n    // Ensure sorted order\n    return min < max ? [min, max] : [max, min];\n  });\n  // Check for undefined values\n  if (x === undefined || y === undefined || z === undefined) {\n    return undefined;\n  }\n  return { x, y, z };\n}\n\n/**\n * Formats a float or integer value to a string with a maximum precision for float values.\n * @param value The number to format.\n * @param maxPrecision The maximum number of significant digits to display for float values.\n * Default is 7.\n * @returns\n * - For integers, the integer value as a string.\n * - For floats, the float value as a string with a maximum of `maxPrecision` significant digits\n * and any trailing zeroes removed.\n *\n * @example\n * ```\n * formatFloat(1.23456, 3) // \"1.23\"\n * formatFloat(123456, 3) // \"123456\"\n * formatFloat(1.3999999999999999, 3) // \"1.4\"\n * ```\n */\nfunction formatFloat(value: number, maxPrecision: number = 7): string {\n  if (Number.isInteger(value)) {\n    return value.toString();\n  }\n  return Number(value.toPrecision(maxPrecision)).toString();\n}\n\nfunction perAxisToArray<T>(perAxis: PerAxis<T>): T[] {\n  return [perAxis.x, perAxis.y, perAxis.z];\n}\n\n/** Serializes a region into a `x1:x2,y1:y2,z1:z2` string format. */\nfunction serializeRegion(region: PerAxis<[number, number]>): string {\n  return perAxisToArray(region)\n    .map((axis) => axis.map((val) => formatFloat(val)).join(\":\"))\n    .join(\",\");\n}\n\n/** Serializes a slice parameter into a `x,y,z` string format. */\nfunction serializeSlice(slice: PerAxis<number>): string {\n  return perAxisToArray(slice)\n    .map((val) => formatFloat(val))\n    .join(\",\");\n}\n\nfunction serializeBoolean(value: boolean | undefined): \"1\" | \"0\" | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  return value ? \"1\" : \"0\";\n}\n\nfunction parseCameraState(cameraSettings: string | undefined): Partial<CameraState> | undefined {\n  if (!cameraSettings) {\n    return undefined;\n  }\n  const parsedCameraSettings = parseKeyValueList(cameraSettings);\n  const result: Partial<CameraState> = {\n    position: parseThreeNumberArray(parsedCameraSettings[CameraTransformKeys.Position], { separator: \":\" }),\n    target: parseThreeNumberArray(parsedCameraSettings[CameraTransformKeys.Target], { separator: \":\" }),\n    up: parseThreeNumberArray(parsedCameraSettings[CameraTransformKeys.Up], { separator: \":\" }),\n    // Orthographic scales cannot be negative\n    orthoScale: parseStringFloat(parsedCameraSettings[CameraTransformKeys.OrthoScale], 0, Infinity),\n    fov: parseStringFloat(parsedCameraSettings[CameraTransformKeys.Fov], 0, 180),\n  };\n  return removeUndefinedProperties(result);\n}\n\nexport function serializeCameraState(\n  cameraState: Partial<CameraState>,\n  removeDefaults: boolean,\n  viewMode: ViewMode = ViewMode.threeD\n): string | undefined {\n  if (removeDefaults) {\n    // Note that we use the `getDefaultCameraState()` to get the defaults here,\n    // instead of `getDefaultViewerState().cameraState`. The latter is undefined, which signals\n    // that the camera should not be modified for URLs that don't specify it.\n    cameraState = removeMatchingProperties(cameraState, getDefaultCameraState(viewMode));\n    if (Object.keys(cameraState).length === 0) {\n      return undefined;\n    }\n  }\n  const cameraString = objectToKeyValueList({\n    [CameraTransformKeys.Position]:\n      cameraState.position && cameraState.position.map((value) => formatFloat(value)).join(\":\"),\n    [CameraTransformKeys.Target]: cameraState.target && cameraState.target.map((value) => formatFloat(value)).join(\":\"),\n    [CameraTransformKeys.Up]: cameraState.up && cameraState.up.map((value) => formatFloat(value)).join(\":\"),\n    [CameraTransformKeys.OrthoScale]:\n      cameraState.orthoScale === undefined ? undefined : formatFloat(cameraState.orthoScale),\n    [CameraTransformKeys.Fov]: cameraState.fov === undefined ? undefined : formatFloat(cameraState.fov),\n  });\n  return cameraString === \"\" ? undefined : cameraString;\n}\n\nfunction serializeControlPoints(controlPoints: ControlPoint[]): string {\n  return controlPoints\n    .map((cp) => {\n      const x = formatFloat(cp.x);\n      const opacity = formatFloat(cp.opacity);\n      // Default color is empty string\n      // TODO: Substitute\n      const color = isEqual(cp.color, DEFAULT_CONTROL_POINT_COLOR)\n        ? DEFAULT_CONTROL_POINT_COLOR_CODE\n        : colorArrayToHex(cp.color);\n      return `${x}:${opacity}:${color}`;\n    })\n    .join(\":\");\n}\n\nfunction parseControlPoints(controlPoints: string | undefined): ControlPoint[] | undefined {\n  if (\n    !(controlPoints && (CONTROL_POINTS_REGEX.test(controlPoints) || LEGACY_CONTROL_POINTS_REGEX.test(controlPoints)))\n  ) {\n    return undefined;\n  }\n\n  // Parse raw control point data from the string into an array of [x, opacity, color] triplets.\n  let rawControlPointData: string[][];\n  if (LEGACY_CONTROL_POINTS_REGEX.test(controlPoints)) {\n    // Legacy format uses commas to separate control points.\n    rawControlPointData = controlPoints.split(\",\").map((cp) => cp.split(\":\"));\n  } else {\n    // New format is all colon-separated, where every three elements represent a control point.\n    rawControlPointData = controlPoints.split(\":\").reduce((acc, _val, i, array) => {\n      if ((i + 1) % 3 === 0) {\n        acc.push([array[i - 2], array[i - 1], array[i]]);\n      }\n      return acc;\n    }, [] as string[][]);\n  }\n\n  const newControlPoints = rawControlPointData.map((cp) => {\n    const [x, opacity, color] = cp;\n    return {\n      x: parseStringFloat(x, -Infinity, Infinity) ?? 0,\n      opacity: parseStringFloat(opacity, 0, 1) ?? 1.0,\n      color: parseHexColorAsColorArray(color) ?? DEFAULT_CONTROL_POINT_COLOR,\n    };\n  });\n  // Sort control points by x value\n  return newControlPoints.sort((a, b) => a.x - b.x);\n}\n\n//// DATA SERIALIZATION //////////////////////\n\n/**\n * Parses a ViewerChannelSetting from a JSON object.\n * @param channelIndex Index of the channel, to be turned into a `match` value.\n * @param jsonState The serialized ViewerChannelSetting to parse, as an object.\n * @returns A ViewerChannelSetting object.\n */\nexport function deserializeViewerChannelSetting(\n  channelIndex: number,\n  jsonState: ViewerChannelSettingParams\n): ViewerChannelSetting {\n  // Missing/undefined fields should be handled downstream.\n  const result: ViewerChannelSetting = {\n    match: channelIndex,\n    enabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.VolumeEnabled]),\n    surfaceEnabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.SurfaceEnabled]),\n    isovalue: parseStringFloat(jsonState[ViewerChannelSettingKeys.IsosurfaceValue], 0, 255),\n    surfaceOpacity: parseStringFloat(jsonState[ViewerChannelSettingKeys.IsosurfaceAlpha], 0, 1),\n    colorizeEnabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.Colorize]),\n    colorizeAlpha: parseStringFloat(jsonState[ViewerChannelSettingKeys.ColorizeAlpha], 0, 1),\n    controlPointsEnabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.ControlPointsEnabled]),\n  };\n  if (jsonState[ViewerChannelSettingKeys.Color] && HEX_COLOR_REGEX.test(jsonState.col)) {\n    result.color = jsonState[ViewerChannelSettingKeys.Color];\n  }\n  if (jsonState[ViewerChannelSettingKeys.Lut] && LUT_REGEX.test(jsonState.lut)) {\n    const [min, max] = jsonState[ViewerChannelSettingKeys.Lut].split(\":\");\n    result.lut = [min.trim(), max.trim()];\n  }\n  if (jsonState[ViewerChannelSettingKeys.Ramp] && RAMP_REGEX.test(jsonState.rmp)) {\n    const [min, max] = jsonState[ViewerChannelSettingKeys.Ramp].split(\":\");\n    result.ramp = [Number.parseFloat(min), Number.parseFloat(max)];\n  }\n  if (jsonState[ViewerChannelSettingKeys.ControlPoints]) {\n    result.controlPoints = parseControlPoints(jsonState[ViewerChannelSettingKeys.ControlPoints]);\n  }\n  return result;\n}\n\n/**\n * Serializes a single viewer channel setting into a dictionary of URL parameters\n * (`ViewerChannelSettingParams`).\n * @param channelSetting The channel state object to serialize.\n * @param removeDefaults Whether to remove properties that match the output of `GET_DEFAULT_CHANNEL_STATE`.\n * @returns A `ViewerChannelSettingParams` object with the serialized parameters. Undefined values are removed.\n */\nexport function serializeViewerChannelSetting(\n  channelSetting: Partial<ChannelState>,\n  removeDefaults: boolean\n): Partial<ViewerChannelSettingParams> {\n  if (removeDefaults) {\n    channelSetting = removeMatchingProperties(channelSetting, getDefaultChannelState());\n  }\n  return removeUndefinedProperties({\n    [ViewerChannelSettingKeys.VolumeEnabled]: serializeBoolean(channelSetting.volumeEnabled),\n    [ViewerChannelSettingKeys.SurfaceEnabled]: serializeBoolean(channelSetting.isosurfaceEnabled),\n    [ViewerChannelSettingKeys.IsosurfaceValue]: channelSetting.isovalue?.toString(),\n    [ViewerChannelSettingKeys.IsosurfaceAlpha]: channelSetting.opacity?.toString(),\n    [ViewerChannelSettingKeys.Colorize]: serializeBoolean(channelSetting.colorizeEnabled),\n    [ViewerChannelSettingKeys.ColorizeAlpha]: channelSetting.colorizeAlpha?.toString(),\n    [ViewerChannelSettingKeys.Color]: channelSetting.color && colorArrayToHex(channelSetting.color),\n    [ViewerChannelSettingKeys.ControlPoints]:\n      channelSetting.controlPoints && serializeControlPoints(channelSetting.controlPoints),\n    [ViewerChannelSettingKeys.ControlPointsEnabled]: serializeBoolean(channelSetting.useControlPoints),\n    [ViewerChannelSettingKeys.Ramp]: channelSetting.ramp\n      ?.map((value) => {\n        return formatFloat(value);\n      })\n      .join(\":\"),\n    // Note that Lut is not saved here, as it is expected as user input and is redundant with\n    // the control points and ramp.\n  });\n}\n\nexport function deserializeViewerState(params: ViewerStateParams): Partial<ViewerState> {\n  const result: Partial<ViewerState> = {\n    maskAlpha: parseStringInt(params[ViewerStateKeys.Mask], 0, 100),\n    imageType: parseStringEnum(params[ViewerStateKeys.Image], ImageType),\n    showAxes: parseStringBoolean(params[ViewerStateKeys.Axes]),\n    showBoundingBox: parseStringBoolean(params[ViewerStateKeys.BoundingBox]),\n    boundingBoxColor: parseHexColorAsColorArray(params[ViewerStateKeys.BoundingBoxColor]),\n    backgroundColor: parseHexColorAsColorArray(params[ViewerStateKeys.BackgroundColor]),\n    autorotate: parseStringBoolean(params[ViewerStateKeys.Autorotate]),\n    brightness: parseStringFloat(params[ViewerStateKeys.Brightness], 0, 100),\n    density: parseStringFloat(params[ViewerStateKeys.Density], 0, 100),\n    levels: parseThreeNumberArray(params[ViewerStateKeys.Levels], { min: 0, max: 255 }),\n    interpolationEnabled: parseStringBoolean(params[ViewerStateKeys.Interpolation]),\n    region: parseStringRegion(params[ViewerStateKeys.Region]),\n    slice: parseStringSlice(params[ViewerStateKeys.Slice]),\n    time: parseStringInt(params[ViewerStateKeys.Time], 0, Number.POSITIVE_INFINITY),\n    scene: parseStringInt(params[ViewerStateKeys.Scene], 0, Number.POSITIVE_INFINITY),\n    renderMode: parseStringEnum(params[ViewerStateKeys.Mode], RenderMode),\n    cameraState: parseCameraState(params[ViewerStateKeys.CameraState]),\n    resetIntensityPerVolume: parseStringBoolean(params[ViewerStateKeys.ResetIntensityPerVolume]),\n  };\n\n  // Handle viewmode, since they use different mappings\n  // TODO: Allow lowercase\n  if (params.view) {\n    const viewParamToViewMode = {\n      \"3D\": ViewMode.threeD,\n      Z: ViewMode.xy,\n      Y: ViewMode.xz,\n      X: ViewMode.yz,\n    };\n    const allowedViews = Object.keys(viewParamToViewMode);\n    let view: \"3D\" | \"X\" | \"Y\" | \"Z\";\n    if (allowedViews.includes(params.view.toUpperCase())) {\n      view = params.view.toUpperCase() as \"3D\" | \"X\" | \"Y\" | \"Z\";\n    } else {\n      view = \"3D\";\n    }\n    result.viewMode = viewParamToViewMode[view];\n  }\n\n  return removeUndefinedProperties(result);\n}\n\n/**\n * Serializes a ViewerState object into a dictionary of URL parameters.\n * @param state The ViewerState to serialize.\n * @param removeDefaults If true, remove properties that match the output of `GET_DEFAULT_VIEWER_STATE`.\n * @returns A `ViewerStateParams` object with the serialized parameters. Undefined values are removed.\n */\nexport function serializeViewerState(state: Partial<ViewerState>, removeDefaults: boolean): ViewerStateParams {\n  if (removeDefaults) {\n    state = removeMatchingProperties(state, getDefaultViewerState());\n  }\n  const result: ViewerStateParams = {\n    [ViewerStateKeys.Mode]: state.renderMode,\n    [ViewerStateKeys.Mask]: state.maskAlpha?.toString(),\n    [ViewerStateKeys.Image]: state.imageType,\n    [ViewerStateKeys.Axes]: serializeBoolean(state.showAxes),\n    [ViewerStateKeys.BoundingBox]: serializeBoolean(state.showBoundingBox),\n    [ViewerStateKeys.BoundingBoxColor]: state.boundingBoxColor && colorArrayToHex(state.boundingBoxColor),\n    [ViewerStateKeys.BackgroundColor]: state.backgroundColor && colorArrayToHex(state.backgroundColor),\n    [ViewerStateKeys.Autorotate]: serializeBoolean(state.autorotate),\n    [ViewerStateKeys.Brightness]: state.brightness?.toString(),\n    [ViewerStateKeys.Density]: state.density?.toString(),\n    [ViewerStateKeys.Interpolation]: serializeBoolean(state.interpolationEnabled),\n    [ViewerStateKeys.Region]: state.region && serializeRegion(state.region),\n    [ViewerStateKeys.Slice]: state.slice && serializeSlice(state.slice),\n    [ViewerStateKeys.Levels]: state.levels?.join(\",\"),\n    [ViewerStateKeys.Time]: state.time?.toString(),\n    [ViewerStateKeys.Scene]: state.scene?.toString(),\n    [ViewerStateKeys.CameraState]:\n      state.cameraState && serializeCameraState(state.cameraState as CameraState, removeDefaults, state.viewMode),\n    [ViewerStateKeys.ResetIntensityPerVolume]: serializeBoolean(state.resetIntensityPerVolume),\n  };\n\n  const viewModeToViewParam = {\n    [ViewMode.threeD]: \"3D\",\n    [ViewMode.xy]: \"Z\",\n    [ViewMode.xz]: \"Y\",\n    [ViewMode.yz]: \"X\",\n  };\n  result[ViewerStateKeys.View] = state.viewMode && viewModeToViewParam[state.viewMode];\n  return removeUndefinedProperties(result);\n}\n\nfunction parseDeprecatedChannelSettings(params: DeprecatedParams): ViewerChannelSettings | undefined {\n  // old, deprecated channels model\n  if (params.ch) {\n    // ?ch=1,2\n    // ?luts=0,255,0,255\n    // ?colors=ff0000,00ff00\n    const initialChannelSettings: ViewerChannelSettings = {\n      groups: [{ name: \"Channels\", channels: [] }],\n    };\n    const ch = initialChannelSettings.groups[0].channels;\n\n    const channelsOn = params.ch.split(\",\").map((numstr) => Number.parseInt(numstr, 10));\n    for (let i = 0; i < channelsOn.length; ++i) {\n      ch.push({ match: channelsOn[i], enabled: true });\n    }\n    // look for luts or color\n    if (params.luts) {\n      const luts = params.luts.split(\",\");\n      if (luts.length !== ch.length * 2) {\n        console.warn(\"ILL-FORMED QUERYSTRING: luts must have a min/max for each ch\");\n      } else {\n        for (let i = 0; i < ch.length; ++i) {\n          ch[i][\"lut\"] = [luts[i * 2], luts[i * 2 + 1]];\n        }\n      }\n    }\n    if (params.colors) {\n      const colors = params.colors.split(\",\");\n      if (colors.length !== ch.length) {\n        console.warn(\"ILL-FORMED QUERYSTRING: if colors specified, must have a color for each ch\");\n      } else {\n        for (let i = 0; i < ch.length; ++i) {\n          ch[i][\"color\"] = colors[i];\n        }\n      }\n    }\n    return initialChannelSettings;\n  }\n  return undefined;\n}\n\nfunction parseChannelSettings(params: ChannelParams): ViewerChannelSettings | undefined {\n  // Channels keys are formatted as `c0`, `c1`, etc., and the value is string containing\n  // a comma-separated list of key-value pairs.\n  const channelIndexToSettings: Map<number, ViewerChannelSetting> = new Map();\n  Object.keys(params).forEach((key) => {\n    if (isChannelKey(key)) {\n      const channelIndex = Number.parseInt(key.slice(1), 10);\n      try {\n        const channelData = parseKeyValueList(params[key]!);\n        const channelSetting = deserializeViewerChannelSetting(channelIndex, channelData as ViewerChannelSettingParams);\n        channelIndexToSettings.set(channelIndex, channelSetting);\n      } catch (e) {\n        console.warn(\n          `url_utils.getArgsFromParams: Failed to parse channel settings for channel ${channelIndex} from URL parameters.`,\n          e\n        );\n      }\n    }\n  });\n  if (channelIndexToSettings.size > 0) {\n    const groups: ViewerChannelSettings[\"groups\"] = [\n      {\n        name: \"Channels\",\n        channels: Array.from(channelIndexToSettings.values()),\n      },\n    ];\n    return { groups };\n  }\n\n  return undefined;\n}\n\n//// FULL URL PARSING //////////////////////\nasync function loadDataset(firestore: FirebaseFirestore, dataset: string, id: string): Promise<Partial<AppProps>> {\n  const db = new FirebaseRequest(firestore);\n  const args: Partial<AppProps> = {};\n\n  const datasets = await db.getAvailableDatasets();\n\n  let datasetMeta: DatasetMetaData | undefined = undefined;\n  for (const d of datasets) {\n    const innerDatasets = d.datasets!;\n    const names = Object.keys(innerDatasets);\n    const matchingName = names.find((name) => name === dataset);\n    if (matchingName) {\n      datasetMeta = innerDatasets[matchingName];\n      break;\n    }\n  }\n  if (datasetMeta === undefined) {\n    console.error(`No matching dataset: ${dataset}`);\n    return {};\n  }\n\n  const datasetData = await db.selectDataset(datasetMeta.manifest!);\n  const baseUrl = datasetData.volumeViewerDataRoot + \"/\";\n  args.imageDownloadHref = datasetData.downloadRoot + \"/\" + id;\n  // args.fovDownloadHref = datasetData.downloadRoot + \"/\" + id;\n\n  const fileInfo = await db.getFileInfoByCellId(id);\n  args.imageUrl = baseUrl + fileInfo!.volumeviewerPath;\n  args.parentImageUrl = baseUrl + fileInfo!.fovVolumeviewerPath;\n\n  return args;\n}\n\nfunction isStringArray(arr: any[]): arr is string[] {\n  return Array.isArray(arr) && arr.every((item) => typeof item === \"string\");\n}\n\nfunction isValidScenesArray(arr: any[]): arr is (string | string[])[] {\n  return Array.isArray(arr) && arr.every((item) => typeof item === \"string\" || isStringArray(item));\n}\n\nexport async function loadFromManifest(\n  manifestUrl: string\n): Promise<{ scenes: (string | string[])[]; metadata?: MetadataRecord[] }> {\n  let response: Response;\n  let manifestJson: ManifestJson;\n\n  // Fetch manifest\n  try {\n    response = await fetch(manifestUrl);\n  } catch (error) {\n    console.error(error);\n    throw new Error(`JSON manifest could not be fetched from URL '${manifestUrl}': ${error}`);\n  }\n  if (!response.ok) {\n    throw new Error(\n      `JSON manifest could not be fetched from URL '${manifestUrl}': Received ${response.status} ${response.statusText}`\n    );\n  }\n  // Parse JSON\n  try {\n    manifestJson = await response.json();\n  } catch (error) {\n    throw new Error(`Could not parse JSON manifest from URL '${manifestUrl}': ${error}`);\n  }\n\n  // Parse scenes\n  let scenes = manifestJson.scenes;\n  if (scenes === undefined) {\n    throw new Error(`No 'scenes' property was found in JSON manifest from URL '${manifestUrl}'`);\n  }\n  if (typeof scenes === \"string\") {\n    scenes = [scenes];\n  }\n  if (!Array.isArray(scenes) || scenes.length === 0 || !isValidScenesArray(scenes)) {\n    throw new Error(\n      `Invalid 'scenes' property found in JSON manifest from URL '${manifestUrl}'. 'scenes' must be a non-empty array of strings or string arrays.`\n    );\n  }\n\n  // Parse metadata\n  let metadata: MetadataRecord[] | undefined = undefined;\n  if (manifestJson.meta !== undefined && Array.isArray(manifestJson.meta)) {\n    metadata = manifestJson.meta;\n  }\n  return { scenes, metadata };\n}\n\n/**\n * Parses a set of URL search parameters into props for the viewer.\n * @param urlSearchParams The URLSearchParams object to parse.\n * @param firestore Optional Firestore instance. If provided, the function can\n * load data from a Firestore dataset if the `dataset` and `id` parameters are\n * provided.\n * @returns An object containing:\n * - `args`: Partial AppProps object.\n * - `viewerSettings`: Partial ViewerState object.\n *\n * `args` can be passed as props to the `ImageViewerApp`, and `viewerSettings`\n * can be passed to `ViewerStateProvider`.\n */\nexport async function parseViewerUrlParams(\n  urlSearchParams: URLSearchParams,\n  firestore?: FirebaseFirestore\n): Promise<{\n  args: Partial<AppProps>;\n  viewerSettings: Partial<ViewerState>;\n}> {\n  const params = getAllowedParams(urlSearchParams);\n  let args: Partial<AppProps> = {};\n  // Parse viewer state\n  const viewerSettings: Partial<ViewerState> = deserializeViewerState(params);\n\n  // Parse channel settings. If per-channel settings are provided, they will override\n  // the old `ch` query parameter.\n  const deprecatedChannelSettings = parseDeprecatedChannelSettings(params);\n  const channelSettings = parseChannelSettings(params);\n  args.viewerChannelSettings = channelSettings ?? deprecatedChannelSettings;\n\n  // Parse data sources (URL or dataset/id pair)\n  if (params.manifest !== undefined || params.url !== undefined) {\n    let scenes: (string | string[])[];\n\n    if (params.manifest) {\n      const { scenes: manifestScenes, metadata: manifestMetadata } = await loadFromManifest(params.manifest);\n      scenes = manifestScenes;\n      args.metadata = manifestMetadata ?? undefined;\n    } else {\n      // Load from URL\n      const getFromStorage = params.url === URL_FETCH_FROM_STORAGE;\n      const urlParam = getFromStorage ? (localStorage.getItem(\"url\") ?? params.url!) : params.url!;\n      // split encoded url into a list of one or more scenes...\n      const sceneUrls = tryDecodeURLList(urlParam, /[+ ]/) ?? [urlParam];\n      // ...and each scene into a list of multiple sources, if any.\n      scenes = sceneUrls.map((scene) => tryDecodeURLList(scene) ?? decodeURL(scene));\n      if (getFromStorage) {\n        const metadataJson = localStorage.getItem(\"meta\");\n        args.metadata = metadataJson !== null ? JSON.parse(metadataJson) : undefined;\n      }\n    }\n\n    const firstScene = scenes[0];\n    // Get the very first URL for the download button\n    const firstUrl = Array.isArray(firstScene) ? firstScene[0] : firstScene;\n    // If there's only one url, just pass that\n    const imageUrls: string | MultisceneUrls = scenes.length > 1 || firstScene.length > 1 ? { scenes } : firstScene[0];\n\n    args.cellId = \"1\";\n    args.imageUrl = imageUrls;\n    // this is invalid for zarr?\n    args.imageDownloadHref = firstUrl;\n    args.parentImageUrl = \"\";\n    args.parentImageDownloadHref = \"\";\n    // Check if channel settings are already provided (through per-channel settings or\n    // old `ch` query param, or included in JSON files). If not, make first three\n    // channels visible by default.\n    if (!firstUrl.endsWith(\"json\") && !args.viewerChannelSettings) {\n      args.viewerChannelSettings = {\n        groups: [\n          // first 3 channels on by default!\n          {\n            name: \"Channels\",\n            channels: [\n              { match: [0, 1, 2], enabled: true },\n              { match: \"(.+)\", enabled: false },\n            ],\n          },\n        ],\n      };\n    }\n  } else if (params.dataset && params.id && firestore) {\n    // ?dataset=aics_hipsc_v2020.1&id=232265\n    const datasetArgs = await loadDataset(firestore, params.dataset, params.id);\n    args = { ...args, ...datasetArgs };\n  }\n\n  return { args: removeUndefinedProperties(args), viewerSettings: removeUndefinedProperties(viewerSettings) };\n}\n\n/**\n * Serializes the ViewerState and ChannelState of a ViewerStateContext into a URLSearchParams object.\n * @param state ViewerStateContext to serialize.\n * @param removeDefaults If true, shortens parameters by removing any properties that match the default state.\n * This includes the output of GET_DEFAULT_VIEWER_STATE and GET_DEFAULT_CHANNEL_STATE.\n */\nexport function serializeViewerUrlParams(\n  state: Partial<ViewerStateContextType>,\n  removeDefaults: boolean = true\n): AppParams {\n  const params = serializeViewerState(state, removeDefaults);\n\n  const channelParams = state.channelSettings?.reduce<Record<string, string>>(\n    (acc, channelSetting, index): Record<string, string> => {\n      const key = `c${index}`;\n      acc[key] = objectToKeyValueList(\n        serializeViewerChannelSetting(channelSetting, removeDefaults) as Record<string, string>\n      );\n      return acc;\n    },\n    {} as Record<string, string>\n  );\n\n  return { ...params, ...channelParams };\n}\n","import { ControlPoint } from \"@aics/vole-core\";\n\nimport { OTHER_CHANNEL_KEY, SINGLE_GROUP_CHANNEL_KEY } from \"../constants\";\n\n/** Settings for a single channel, as passed in via props by App users */\nexport interface ViewerChannelSetting {\n  // regex or string or array of regexes or strings or number for raw channel index\n  // if you want to match on channel index, then you must provide the index here.\n  match: (string | number)[] | string | number;\n\n  // name is the display name for this channel.\n  // if name is not given, use raw data channel name for display\n  name?: string;\n\n  // 6 digit hex rrggbb. defaults to auto-assigned by app\n  color?: string;\n  // default to false\n  enabled?: boolean;\n  // default to false\n  surfaceEnabled?: boolean;\n  /**\n   * Min and max values for the intensity lookup table, which maps from raw intensity values\n   * in the volume to opacity and color. Defaults to [0, 255].\n   *\n   * - Plain numbers are indices of histogram bins, in the range [0, 255].\n   * - `v{n}` represents a raw intensity value, where `n` is an integer.\n   * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100] range.\n   * - `m{n}` represents the median multiplied by `n / 100`.\n   * - `autoij` in either the min or max fields will use the \"auto\" algorithm\n   * from ImageJ to select the min and max.\n   */\n  lut?: [string, string];\n  /**\n   * Whether to show control point controls instead of a simpler ramp control.\n   * Defaults to false.\n   */\n  controlPointsEnabled?: boolean;\n  controlPoints?: ControlPoint[];\n  ramp?: [number, number];\n  // valid when surfaceEnabled = true. default 128 or 0.5 of max intensity range\n  isovalue?: number;\n  // valid when surfaceEnabled = true. default 1.0 fully opaque\n  surfaceOpacity?: number;\n  colorizeEnabled?: boolean;\n  colorizeAlpha?: number;\n}\n\nexport interface ViewerChannelGroup {\n  name: string;\n  channels: ViewerChannelSetting[];\n}\n\nexport interface ViewerChannelSettings {\n  maskChannelName?: string;\n  groups: ViewerChannelGroup[];\n}\n\nexport type ChannelGrouping = { [key: string]: number[] };\n\nexport function matchChannel(channelName: string, channelIndex: number, c: ViewerChannelSetting): boolean {\n  // c could be a number, an array of (strings or numbers), or a single regex\n  if (typeof c.match === \"number\") {\n    if (c.match === channelIndex) {\n      return true;\n    }\n  } else if (Array.isArray(c.match)) {\n    for (const r of c.match) {\n      if (typeof r === \"number\") {\n        if (r === channelIndex) {\n          return true;\n        }\n      } else {\n        const re = new RegExp(r);\n        if (re.test(channelName)) {\n          return true;\n        }\n      }\n    }\n  } else if (typeof c.match === \"string\") {\n    const re = new RegExp(c.match);\n    if (re.test(channelName)) {\n      return true;\n    }\n  } else {\n    throw new Error(\n      \"match is required for channel settings groups, and must be a string, number, or array of strings or numbers\"\n    );\n  }\n  return false;\n}\n\nfunction findFirstChannelMatchOfGroup(\n  channel: string,\n  channelIndex: number,\n  g: ViewerChannelGroup\n): ViewerChannelSetting | undefined {\n  for (const c of g.channels) {\n    if (matchChannel(channel, channelIndex, c)) {\n      return c;\n    }\n  }\n  return undefined;\n}\n\nexport function findFirstChannelMatch(\n  channel: string,\n  channelIndex: number,\n  settings: ViewerChannelSettings\n): ViewerChannelSetting | undefined {\n  if (!settings.groups) {\n    return undefined;\n  }\n  for (const g of settings.groups) {\n    const c = findFirstChannelMatchOfGroup(channel, channelIndex, g);\n    if (c !== undefined) {\n      return c;\n    }\n  }\n  return undefined;\n}\n\nexport function getDisplayName(name: string, index: number, settings?: ViewerChannelSettings): string {\n  if (settings) {\n    const c = findFirstChannelMatch(name, index, settings);\n    if (c) {\n      return c.name || name;\n    }\n  }\n  return name;\n}\n\nexport function makeChannelIndexGrouping(channels: string[], settings?: ViewerChannelSettings): ChannelGrouping {\n  if (!channels) {\n    return {};\n  }\n  if (!settings) {\n    // return all channels\n    return { [SINGLE_GROUP_CHANNEL_KEY]: channels.map((_val, index) => index) };\n  }\n\n  const groups = settings.groups;\n  const grouping: ChannelGrouping = {};\n  const channelsMatched: number[] = [];\n  // this is kinda inefficient but we want to ensure the order as specified in viewerChannelSettings\n  if (groups !== undefined) {\n    for (const g of groups) {\n      grouping[g.name] = [];\n      g.channels.forEach((groupMatch) => {\n        // check all channels against the match\n        channels.forEach((channel, index) => {\n          // make sure channel was not already matched someplace.\n          if (!channelsMatched.includes(index)) {\n            if (matchChannel(channel, index, groupMatch)) {\n              grouping[g.name].push(index);\n              channelsMatched.push(index);\n            }\n          }\n        });\n      });\n    }\n  }\n  // now any channels not still matched go in the catchall group.\n  if (channelsMatched.length < channels.length) {\n    const remainderGroupName = groups.length === 0 ? SINGLE_GROUP_CHANNEL_KEY : OTHER_CHANNEL_KEY;\n    grouping[remainderGroupName] = [];\n    channels.forEach((channel, index) => {\n      // make sure channel was not already matched someplace.\n      if (!channelsMatched.includes(index)) {\n        grouping[remainderGroupName].push(index);\n      }\n    });\n  }\n  return grouping;\n}\n","import { ChannelState, ViewerSettingUpdater, ViewerState } from \"../../components/ViewerStateProvider/types\";\nimport { getDefaultChannelState } from \"../constants\";\nimport { ColorArray } from \"./colorRepresentations\";\nimport {\n  findFirstChannelMatch,\n  getDisplayName,\n  ViewerChannelSetting,\n  ViewerChannelSettings,\n} from \"./viewerChannelSettings\";\n\n/** Sets all fields of the viewer state to the values of the `newState`. */\nexport function overrideViewerState(changeViewerSetting: ViewerSettingUpdater, newState: ViewerState): void {\n  for (const key of Object.keys(newState) as (keyof ViewerState)[]) {\n    changeViewerSetting(key, newState[key] as any);\n  }\n\n  // Pathtrace rendering is not allowed in 2D view mode but is in 3D mode.\n  // Since we're not guaranteed on the order of object keys, apply changes to render mode a second time\n  // in case we were previously in 2D view mode and the change was blocked, but we're now in 3D.\n  changeViewerSetting(\"renderMode\", newState.renderMode);\n}\n\nexport function overrideChannelStates(\n  setChannelSettings: (settings: ChannelState[]) => void,\n  currentStates: ChannelState[],\n  newStates: ChannelState[]\n): void {\n  // Match the names in the new state with the existing state so we do not override the names.\n  // Also don't reset the control points or ramps, since these will be reset in the app.\n  for (let i = 0; i < newStates.length; i++) {\n    newStates[i].name = currentStates[i].name;\n    newStates[i].controlPoints = currentStates[i].controlPoints;\n    newStates[i].ramp = currentStates[i].ramp;\n  }\n  setChannelSettings(newStates);\n}\n\n/** Returns the indices of channels that have either the volume or isosurface enabled. */\nexport function getEnabledChannelIndices(channelSettings: ChannelState[]): number[] {\n  const enabledChannels = [];\n  for (let i = 0; i < channelSettings.length; i++) {\n    if (channelSettings[i].volumeEnabled || channelSettings[i].isosurfaceEnabled) {\n      enabledChannels.push(i);\n    }\n  }\n  return enabledChannels;\n}\n\nexport function colorHexToArray(hex: string): ColorArray | null {\n  // hex is a xxxxxx string. split it into array of rgb ints\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  if (result) {\n    return [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)];\n  } else {\n    return null;\n  }\n}\n\nexport function initializeOneChannelSetting(\n  channelName: string,\n  index: number,\n  defaultColor: ColorArray,\n  viewerChannelSettings?: ViewerChannelSettings,\n  defaultChannelState: ChannelState = getDefaultChannelState()\n): ChannelState {\n  let initSettings = {} as Partial<ViewerChannelSetting>;\n  if (viewerChannelSettings) {\n    // search for channel in settings using groups, names and match values\n    initSettings = findFirstChannelMatch(channelName, index, viewerChannelSettings) ?? {};\n  }\n\n  return {\n    name: channelName ?? \"Channel \" + index,\n    displayName: getDisplayName(channelName ?? \"Channel \" + index, index, viewerChannelSettings),\n    volumeEnabled: initSettings.enabled ?? defaultChannelState.volumeEnabled,\n    isosurfaceEnabled: initSettings.surfaceEnabled ?? defaultChannelState.isosurfaceEnabled,\n    colorizeEnabled: initSettings.colorizeEnabled ?? defaultChannelState.colorizeEnabled,\n    colorizeAlpha: initSettings.colorizeAlpha ?? defaultChannelState.colorizeAlpha,\n    isovalue: initSettings.isovalue ?? defaultChannelState.isovalue,\n    opacity: initSettings.surfaceOpacity ?? defaultChannelState.opacity,\n    color: colorHexToArray(initSettings.color ?? \"\") ?? defaultColor,\n    useControlPoints: initSettings.controlPointsEnabled ?? defaultChannelState.useControlPoints,\n    controlPoints: initSettings.controlPoints ?? defaultChannelState.controlPoints,\n    ramp: initSettings.ramp ?? defaultChannelState.ramp,\n    plotMin: defaultChannelState.plotMin,\n    plotMax: defaultChannelState.plotMax,\n    // TODO: Update when this becomes a controllable setting from parameters\n  };\n}\n","import { CSSProperties } from \"react\";\n\nimport { ViewMode } from \"./enums\";\n\nexport type AxisName = \"x\" | \"y\" | \"z\";\nexport type PerAxis<T> = Record<AxisName, T>;\nexport const activeAxisMap: { [A in ViewMode]: AxisName | null } = {\n  [ViewMode.yz]: \"x\",\n  [ViewMode.xz]: \"y\",\n  [ViewMode.xy]: \"z\",\n  [ViewMode.threeD]: null,\n};\n\nexport type IsosurfaceFormat = \"GLTF\" | \"STL\";\n\nexport type Styles = { [key: string]: CSSProperties };\n\nexport type MetadataEntry = string | number | boolean | MetadataRecord | MetadataEntry[] | null | undefined;\nexport type MetadataRecord = { [key: string]: MetadataEntry };\n\nexport type ManifestJson = {\n  scenes?: string | (string | string[])[];\n  meta?: MetadataRecord[];\n};\n","export type ColorObject = { r: number; g: number; b: number };\nexport type ColorArray = [number, number, number];\n\nexport const colorObjectToArray = (obj: ColorObject): ColorArray => [obj.r, obj.g, obj.b];\n\nexport const colorArrayToObject = (arr: ColorArray): ColorObject => ({ r: arr[0], g: arr[1], b: arr[2] });\n\nexport const colorArrayToFloats = (arr: ColorArray): ColorArray => [arr[0] / 255, arr[1] / 255, arr[2] / 255];\n\nexport const colorArrayToString = (arr: ColorArray): string => `rgb(${arr[0]}, ${arr[1]}, ${arr[2]})`;\n","import { Channel, ControlPoint, Histogram, Lut, remapControlPoints, Volume } from \"@aics/vole-core\";\n\nimport { LUT_MAX_PERCENTILE, LUT_MIN_PERCENTILE, TFEDITOR_DEFAULT_COLOR, TFEDITOR_MAX_BIN } from \"../constants\";\nimport { findFirstChannelMatch, ViewerChannelSetting, ViewerChannelSettings } from \"./viewerChannelSettings\";\n\n// @param {Object[]} controlPoints - array of {x:number, opacity:number, color:string}\n// @return {Uint8Array} array of length 256*4 representing the rgba values of the gradient\nexport function controlPointsToLut(controlPoints: ControlPoint[]): Lut {\n  const lut = new Lut().createFromControlPoints(controlPoints);\n  return lut;\n}\n\n/** Returns a default lookup table based on a min/max percentile of the current volume's data. */\nexport function getDefaultLut(histogram: Histogram): Lut {\n  const hmin = histogram.findBinOfPercentile(LUT_MIN_PERCENTILE);\n  const hmax = histogram.findBinOfPercentile(LUT_MAX_PERCENTILE);\n  return new Lut().createFromMinMax(hmin, hmax);\n}\n\n/**\n * Parses a single LUT value from a string, where the value is either a number, a percentile, or a median multiplier.\n */\nfunction parseLutValue(value: string, histogram: Histogram): number {\n  // look at first char of string.\n  const firstChar = value.charAt(0);\n  if (firstChar === \"m\") {\n    // median\n    const parsedValue = parseFloat(value.substring(1)) / 100.0;\n    return histogram.maxBin * parsedValue;\n  } else if (firstChar === \"p\") {\n    // percentile\n    const parsedValue = parseFloat(value.substring(1)) / 100.0;\n    return histogram.findBinOfPercentile(parsedValue);\n  } else if (firstChar === \"v\") {\n    // value\n    const parsedValue = parseFloat(value.substring(1));\n    return histogram.findFractionalBinOfValue(parsedValue);\n  } else {\n    // plain number\n    return parseFloat(value);\n  }\n}\n\n/**\n * Parses a lookup table (LUT) from a `ViewerChannelSetting` object, where the\n * `lut` field is an array of two alphanumeric strings.\n *\n * @returns a Lut object if the `lut` field is valid; otherwise, returns\n * undefined.\n *\n * Min and max values are determined as following:\n * - Plain numbers are indices of histogram bins, typically in the range [0,\n *   255].\n * - `v{n}` represents a raw intensity value, where `n` is a number.\n * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100]\n *   range.\n * - `m{n}` represents the median multiplied by `n / 100`.\n * - `autoij` in either the min or max fields will use the \"auto\" algorithm from\n *   ImageJ to select the min and max.\n *\n * @example\n * ```\n * \"0:255\"    // min: bin 0, max: bin 255.\n * \"v100:v150\" // min: intensity 100, max: intensity 150.\n * \"p50:p90\"  // min: 50th percentile, max: 90th percentile.\n * \"m1:p75\"   // min: median, max: 75th percentile.\n * \"autoij:0\" // use Auto-IJ to calculate min and max.\n * ```\n */\nexport function parseLutFromSettings(histogram: Histogram, initSettings: ViewerChannelSetting): Lut | undefined {\n  // TODO: Consider minimizing the types/classes this function is interacting\n  // with, since it is only using `initSettings.lut` and the returned Lut is a\n  // wrapper around the control point array, e.g.\n  // `parseControlPointsFromLutParam(histogram: Histogram, lutParam: [string,\n  // string] | undefined): ControlPoint[] | undefined`\n  if (initSettings.lut === undefined || initSettings.lut.length !== 2) {\n    return undefined;\n  }\n\n  let lutValues: [number, number];\n  if (initSettings.lut[0] === \"autoij\" || initSettings.lut[1] === \"autoij\") {\n    lutValues = histogram.findAutoIJBins();\n  } else {\n    lutValues = [parseLutValue(initSettings.lut[0], histogram), parseLutValue(initSettings.lut[1], histogram)];\n  }\n  if (!Number.isFinite(lutValues[0]) || !Number.isFinite(lutValues[1])) {\n    return undefined;\n  }\n  const sortedLutValues = [Math.min(lutValues[0], lutValues[1]), Math.max(lutValues[0], lutValues[1])];\n  const controlPoints = [\n    {\n      x: sortedLutValues[0],\n      opacity: 0,\n      color: TFEDITOR_DEFAULT_COLOR,\n    },\n    {\n      x: sortedLutValues[1],\n      opacity: 1,\n      color: TFEDITOR_DEFAULT_COLOR,\n    },\n  ];\n  // Create directly from control points instead of using\n  // `Lut.createFromMinMax()` because it applies clamping to the [0, 255] range.\n  return new Lut().createFromControlPoints(controlPoints);\n}\n\n/**\n * Initializes the lookup table (LUT) that maps from volume intensity values to color + opacity and applies the LUT to the volume.\n *\n * @param aimg The loaded volume data.\n * @param channelIndex The index of the channel to initialize the LUT for.\n * @param channelSettings The ViewerChannelSettings object that may contain settings for this channel. If relevant\n * settings are not found, a default LUT will be used.\n * @returns an object containing the retrieved ramp control points and \"advanced mode\" control points.\n *\n * LUT values will be determined using the following rules:\n * - If no `lut` is provided in the `channelSettings`, a default LUT is calculated using min/max percentiles of the data.\n * - Otherwise, `lut` will be parsed as described in `ViewerChannelSettingParams.lut`.\n * - The `controlPoints` and `ramp` fields in the `channelSettings` will be used to override the returned \"advanced mode\"\n * control points and ramp, respectively.\n *\n * If `controlPointsEnabled` is set to true in the `channelSettings`, the \"advanced mode\" control points will be applied\n * to the volume; otherwise, the ramp will be applied.\n */\nexport function initializeLut(\n  aimg: Volume,\n  channelIndex: number,\n  channelSettings?: ViewerChannelSettings\n): { ramp: ControlPoint[]; controlPoints: ControlPoint[] } {\n  const histogram = aimg.getHistogram(channelIndex);\n  const defaultLut = getDefaultLut(histogram);\n\n  let ramp: ControlPoint[] = [];\n  let controlPoints: ControlPoint[] = [];\n  let lut = defaultLut;\n\n  const name = aimg.channelNames[channelIndex];\n  const initSettings = channelSettings && findFirstChannelMatch(name, channelIndex, channelSettings);\n\n  // Attempt to load a LUT from the settings, which will be used to initialize the control points and ramp\n  if (initSettings && initSettings.lut) {\n    lut = parseLutFromSettings(histogram, initSettings) ?? defaultLut;\n  }\n  // Initialize the control points + ramp using the LUT.\n  // Optionally, override the LUT's control points with the provided control points and/or ramp.\n  controlPoints = initSettings?.controlPoints ?? [...lut.controlPoints];\n  ramp = initSettings?.ramp ? rampToControlPoints(initSettings.ramp) : [...lut.controlPoints];\n\n  // Apply whatever lut is currently visible\n  let visibleLut: Lut;\n  if (initSettings?.controlPointsEnabled) {\n    visibleLut = new Lut().createFromControlPoints(controlPoints);\n  } else {\n    visibleLut = new Lut().createFromControlPoints(ramp);\n  }\n\n  aimg.setLut(channelIndex, visibleLut);\n  return { ramp, controlPoints };\n}\n\nexport function controlPointsToRamp(controlPoints: ControlPoint[]): [number, number] {\n  if (controlPoints.length <= 1) {\n    return [0, TFEDITOR_MAX_BIN];\n  } else if (controlPoints.length === 2) {\n    return [controlPoints[0].x, controlPoints[1].x];\n  } else if (controlPoints.length === 3) {\n    if (\n      controlPoints[0].opacity !== controlPoints[1].opacity &&\n      controlPoints[0].opacity !== controlPoints[2].opacity &&\n      controlPoints[1].opacity !== controlPoints[2].opacity\n    ) {\n      // if all 3 are unequal, assume a ramp from first to last\n      return [controlPoints[0].x, controlPoints[2].x];\n    } else if (controlPoints[0].opacity !== controlPoints[1].opacity) {\n      return [controlPoints[0].x, controlPoints[1].x];\n    } else if (controlPoints[1].opacity !== controlPoints[2].opacity) {\n      return [controlPoints[1].x, controlPoints[2].x];\n    }\n  }\n  return [controlPoints[1].x, controlPoints[controlPoints.length - 2].x];\n}\n\nexport function rampToControlPoints([min, max]: [number, number]): ControlPoint[] {\n  return [\n    { x: Math.min(min - 1, 0), opacity: 0, color: TFEDITOR_DEFAULT_COLOR },\n    { x: min, opacity: 0, color: TFEDITOR_DEFAULT_COLOR },\n    { x: max, opacity: 1, color: TFEDITOR_DEFAULT_COLOR },\n    { x: Math.max(max + 1, TFEDITOR_MAX_BIN), opacity: 1, color: TFEDITOR_DEFAULT_COLOR },\n  ];\n}\n\n/**\n * Remaps an array of control points from an old range (as a 2-tuple) to a new\n * one (extracted from a `Channel`)\n */\nexport function remapControlPointsForChannel(\n  controlPoints: ControlPoint[],\n  oldRange: [number, number] | undefined,\n  { rawMin, rawMax }: Channel\n): ControlPoint[] {\n  if (oldRange === undefined) {\n    return controlPoints;\n  }\n\n  return remapControlPoints(controlPoints, oldRange[0], oldRange[1], rawMin, rawMax);\n}\n\n/**\n * Remaps a ramp from an old range (as a 2-tuple) to a new one (extracted from a\n * `Channel`)\n */\nexport function remapRampForChannel(\n  ramp: [number, number],\n  oldRange: [number, number] | undefined,\n  channel: Channel\n): [number, number] {\n  const rampControlPoints = rampToControlPoints(ramp);\n  const remappedRampControlPoints = remapControlPointsForChannel(rampControlPoints, oldRange, channel);\n  return controlPointsToRamp(remappedRampControlPoints);\n}\n","import { AxisName } from \"../types\";\n\ntype PlayAxisName = AxisName | \"t\";\n\nconst PLAY_STEP_INTERVAL_MS = 125;\n\nexport default class PlayControls {\n  playingAxis: PlayAxisName | null = null;\n  playWaitingForLoad = false;\n  playHolding = false;\n  playTimeoutId = 0;\n\n  public getVolumeIsLoaded?: () => boolean;\n  public stepAxis?: (axis: PlayAxisName) => void;\n  public onPlayingAxisChanged?: (axis: PlayAxisName | null) => void;\n\n  private setPlayingAxis(axis: PlayAxisName | null): void {\n    this.playingAxis = axis;\n    this.onPlayingAxisChanged?.(axis);\n  }\n\n  private playStep(): void {\n    if (!this.playingAxis || this.playHolding || !this.stepAxis) {\n      return;\n    }\n    // If the volume is not loaded, wait for it to load before continuing\n    if (!this.getVolumeIsLoaded?.()) {\n      this.playWaitingForLoad = true;\n      return;\n    }\n\n    this.stepAxis(this.playingAxis);\n    this.playTimeoutId = window.setTimeout(this.playStep.bind(this), PLAY_STEP_INTERVAL_MS);\n  }\n\n  /** Call whenever new data is loaded to resume playback if it was paused for data loading. */\n  onImageLoaded(): void {\n    if (this.playWaitingForLoad) {\n      this.playWaitingForLoad = false;\n      this.playStep();\n    }\n  }\n\n  /**\n   * Pause playback on the currently playing axis.\n   * `willResume` marks this as a temporary suspension, e.g. while the user is scrubbing along the playing axis.\n   */\n  pause(willResume: boolean = false): void {\n    window.clearTimeout(this.playTimeoutId);\n    this.playTimeoutId = 0;\n    this.playWaitingForLoad = false;\n    if (this.playingAxis !== null && !willResume) {\n      this.playHolding = false;\n      this.setPlayingAxis(null);\n    }\n  }\n\n  /** Begin playback on `axis`. */\n  play(axis: PlayAxisName): void {\n    if (this.playingAxis !== null) {\n      this.pause(true);\n    }\n    this.setPlayingAxis(axis);\n    this.playStep();\n  }\n\n  /** If `axis` is currently playing, begin a temporary hold on playback while other input is pending. */\n  startHold(axis: PlayAxisName): void {\n    this.playHolding = true;\n    this.pause(axis === this.playingAxis);\n  }\n\n  /** If a playback hold is active, end it. */\n  endHold(): void {\n    if (this.playHolding) {\n      this.playHolding = false;\n      this.playStep();\n    }\n  }\n}\n","import {\n  CreateLoaderOptions,\n  LoadSpec,\n  PerChannelCallback,\n  PrefetchDirection,\n  RawArrayLoaderOptions,\n  Volume,\n  VolumeFileFormat,\n  VolumeLoaderContext,\n} from \"@aics/vole-core\";\nimport { ThreadableVolumeLoader } from \"@aics/vole-core/es/types/loaders/IVolumeLoader\";\n\nexport default class SceneStore {\n  context: VolumeLoaderContext;\n  loaders: (ThreadableVolumeLoader | undefined)[];\n  paths: (string | string[] | RawArrayLoaderOptions)[];\n  currentScene: number = 0;\n  syncChannels: boolean = false;\n  prefetchPriority: PrefetchDirection[] = [];\n\n  constructor(context: VolumeLoaderContext, paths: (string | string[] | RawArrayLoaderOptions)[]) {\n    this.paths = paths;\n    this.context = context;\n    this.loaders = new Array(paths.length).fill(undefined);\n  }\n\n  /** Get the loader associated with the given scene index, or create it if it doesn't exist */\n  private async getLoader(scene: number): Promise<ThreadableVolumeLoader> {\n    this.currentScene = scene;\n    let loader = this.loaders[scene];\n\n    if (!loader) {\n      let path = this.paths[scene];\n      let options: Partial<CreateLoaderOptions> = {};\n      if (typeof path === \"object\" && !Array.isArray(path)) {\n        options.rawArrayOptions = path;\n        options.fileType = VolumeFileFormat.DATA;\n        path = \"\";\n      }\n\n      await this.context.onOpen();\n      loader = await this.context.createLoader(path, options);\n      this.loaders[scene] = loader;\n    }\n\n    loader.syncMultichannelLoading(this.syncChannels);\n    loader.setPrefetchPriority(this.prefetchPriority);\n    return loader;\n  }\n\n  public async loadScene(\n    scene: number,\n    image: Volume,\n    loadSpec?: LoadSpec,\n    onChannelLoaded?: PerChannelCallback\n  ): Promise<void> {\n    const loader = await this.getLoader(scene);\n    const spec = loadSpec ?? image.loadSpecRequired;\n\n    image.loader = loader;\n    image.imageInfo.imageInfo = (await loader.createImageInfo(spec)).imageInfo;\n    loader.loadVolumeData(image, spec, onChannelLoaded);\n  }\n\n  public async createVolume(scene: number, loadSpec: LoadSpec, onChannelLoaded?: PerChannelCallback): Promise<Volume> {\n    const loader = await this.getLoader(scene);\n    return loader.createVolume(loadSpec, onChannelLoaded);\n  }\n\n  public syncMultichannelLoading(sync: boolean): void {\n    this.syncChannels = sync;\n    const currentLoader = this.loaders[this.currentScene];\n    if (currentLoader) {\n      currentLoader.syncMultichannelLoading(sync);\n    }\n  }\n\n  public setPrefetchPriority(priority: PrefetchDirection[]): void {\n    this.prefetchPriority = priority;\n    const currentLoader = this.loaders[this.currentScene];\n    if (currentLoader) {\n      currentLoader.setPrefetchPriority(priority);\n    }\n  }\n}\n","import { LoadSpec, RawArrayLoaderOptions, View3d, Volume, VolumeLoaderContext } from \"@aics/vole-core\";\nimport { useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\nimport { Box3, Vector3 } from \"three\";\n\nimport {\n  AXIS_TO_LOADER_PRIORITY,\n  CACHE_MAX_SIZE,\n  getDefaultChannelColor,\n  QUEUE_MAX_LOW_PRIORITY_SIZE,\n  QUEUE_MAX_SIZE,\n} from \"../shared/constants\";\nimport { ViewMode } from \"../shared/enums\";\nimport { AxisName } from \"../shared/types\";\nimport { useConstructor, useRefWithSetter } from \"../shared/utils/hooks\";\nimport PlayControls from \"../shared/utils/playControls\";\nimport SceneStore from \"../shared/utils/sceneStore\";\nimport { ChannelGrouping, getDisplayName, makeChannelIndexGrouping } from \"../shared/utils/viewerChannelSettings\";\nimport { initializeOneChannelSetting } from \"../shared/utils/viewerState\";\nimport { ChannelState } from \"./ViewerStateProvider/types\";\n\nimport { ViewerStateContext } from \"./ViewerStateProvider\";\n\nexport type UseVolumeOptions = {\n  /** Callback for when the volume is created. */\n  onCreateImage?: (image: Volume) => void;\n  /** Callback for when a single channel of the volume has loaded. */\n  onChannelLoaded?: (image: Volume, channelIndex: number, isInitialLoad: boolean) => void;\n  /** Callback for when image loading encounters an error. */\n  onError?: (error: unknown) => void;\n  /** The name of a channel which should be treated as a mask rather than as viewable data. */\n  maskChannelName?: string;\n};\n\nexport const enum ImageLoadStatus {\n  REQUESTED,\n  LOADING,\n  LOADED,\n  ERROR,\n}\n\n// Used by `channelVersions` (see below)\nconst CHANNEL_INITIAL_LOAD = -1;\nconst CHANNEL_RELOAD = 0;\n\nexport type ReactiveVolume = {\n  image: Volume | null;\n  /**\n   * Indicates the load status of each channel:\n   *\n   * - `-1` indicates the channel has not yet loaded and will get some extra initialization (e.g. LUTs) when it loads.\n   * - `0` indicates the channel has been loaded once, but is currently waiting for new data.\n   * - `1` or greater indicates the channel is loaded. Note this is not exactly `1` to handle multiple simultaneous\n   *   loads; if multiple loads are issued before the first one completes, _incrementing_ rather than _setting_ the\n   *   version number means we react to each load when it completes, rather than just the first.\n   */\n  channelVersions: number[];\n  imageLoadStatus: ImageLoadStatus;\n  setTime: (view3d: View3d, time: number) => void;\n  setScene: (scene: number) => void;\n  playControls: PlayControls;\n  playingAxis: AxisName | \"t\" | null;\n  channelGroupedByType: ChannelGrouping;\n};\n\n/**\n * Temporary hack while `useEffectEvent` is still experimental.\n *\n * Some functions play the role of event handlers (called to notify that something has happened) _within_ an effect.\n * Without any intervention, the linter will insist the function needs to be in the effect's dependencies, even though\n * it would make no sense to re-run the effect when the handler changes. So we hide the function behind a stable ref.\n *\n * See https://react.dev/learn/separating-events-from-effects#declaring-an-effect-event\n */\nconst useEffectEventRef = <T extends undefined | ((...args: any[]) => void)>(\n  callback: T\n): React.MutableRefObject<T> => {\n  const callbackRef = useRef<T>(callback);\n  useEffect(() => {\n    callbackRef.current = callback;\n  }, [callback]);\n  return callbackRef;\n};\n\n/**\n * Hook to open a volume from one or more sources (URLs or raw data) and provide controls for (re)loading and playback.\n *\n * @param scenePaths An array of volume data sources, one per scene. These can be:\n * - a string URL to a single source, or\n * - an array of strings to load multiple sources as a single volume, or\n * - a `RawArrayLoaderOptions` object to load raw data directly.\n * @param options An optional object with callbacks and other info. See docs for `UseVolumeOptions`.\n * @returns An object with the current image, its load status, and controls for playback and loading.\n */\nconst useVolume = (\n  scenePaths: (string | string[] | RawArrayLoaderOptions)[],\n  options?: UseVolumeOptions\n): ReactiveVolume => {\n  const viewerStateRef = useContext(ViewerStateContext).ref;\n  const onErrorRef = useEffectEventRef(options?.onError);\n  const onChannelLoadedRef = useEffectEventRef(options?.onChannelLoaded);\n  const onCreateImageRef = useEffectEventRef(options?.onCreateImage);\n  const maskChannelName = options?.maskChannelName;\n\n  // set up our big objects: the image, its loading infrastructure, and controls for playback\n  const [image, setImage] = useState<Volume | null>(null);\n  const loadContext = useConstructor(\n    () => new VolumeLoaderContext(CACHE_MAX_SIZE, QUEUE_MAX_SIZE, QUEUE_MAX_LOW_PRIORITY_SIZE)\n  );\n  const sceneLoader = useMemo(() => new SceneStore(loadContext, scenePaths), [loadContext, scenePaths]);\n  const playControls = useConstructor(() => new PlayControls());\n  const [playingAxis, setPlayingAxis] = useState<AxisName | \"t\" | null>(null);\n  useEffect(() => {\n    playControls.onPlayingAxisChanged = (axis) => {\n      const isPlaying = axis !== null;\n      setPlayingAxis(axis);\n      // prioritize prefetching along the playing axis\n      sceneLoader.setPrefetchPriority(axis ? [AXIS_TO_LOADER_PRIORITY[axis]] : []);\n      // sync multichannel loading so we don't show loaded channels one at a time\n      sceneLoader.syncMultichannelLoading(isPlaying);\n      if (image) {\n        // If we're playing and entire axis is not in memory (T always, Z likely), downlevel to speed things up\n        const { volumeSize, subregionSize } = image.imageInfo;\n        const shouldDownlevel = isPlaying && (axis === \"t\" || volumeSize[axis] !== subregionSize[axis]);\n        image.updateRequiredData({ scaleLevelBias: shouldDownlevel ? 1 : 0 });\n      }\n    };\n  }, [sceneLoader, playControls, image]);\n\n  // track which channels have been loaded\n  const [channelVersions, _setChannelVersions] = useState<number[]>([]);\n  const [channelVersionsRef, setChannelVersions] = useRefWithSetter(_setChannelVersions, channelVersions);\n\n  const { channelSettings } = viewerStateRef.current;\n  // Some extra items for tracking load status\n  const [loadThrewError, setLoadThrewError] = useState(false);\n  const inInitialLoadRef = useRef(true);\n\n  // derive whether the image is loaded from whether any and/or all channels are loaded\n  const imageLoadStatus = useMemo(() => {\n    if (loadThrewError) {\n      return ImageLoadStatus.ERROR;\n    }\n\n    const [allLoaded, noneLoaded] = channelVersions.reduce(\n      ([allLoaded, noneLoaded], version, idx) => {\n        const setting = channelSettings[idx];\n        if (setting && (setting.volumeEnabled || setting.isosurfaceEnabled || maskChannelName === setting.name)) {\n          const loaded = version > 0;\n          return [allLoaded && loaded, noneLoaded && !loaded];\n        }\n        return [allLoaded, noneLoaded];\n      },\n      [true, true]\n    );\n\n    if (allLoaded && inInitialLoadRef.current) {\n      inInitialLoadRef.current = false;\n    }\n\n    return noneLoaded ? ImageLoadStatus.REQUESTED : allLoaded ? ImageLoadStatus.LOADED : ImageLoadStatus.LOADING;\n  }, [channelVersions, channelSettings, maskChannelName, loadThrewError]);\n\n  const setIsLoading = useCallback(() => {\n    setLoadThrewError(false);\n    setChannelVersions(channelVersionsRef.current.map((version) => Math.min(version, CHANNEL_RELOAD)));\n  }, [channelVersionsRef, setChannelVersions]);\n\n  const onError = useCallback(\n    (e: unknown): never => {\n      setLoadThrewError(true);\n      onErrorRef.current?.(e);\n      throw e;\n    },\n    [onErrorRef]\n  );\n\n  // channel indexes, sorted by category\n  const [channelGroupedByType, setChannelGroupedByType] = useState<ChannelGrouping>({});\n\n  const onChannelDataLoaded = useCallback(\n    (aimg: Volume, channelIndex: number): void => {\n      // let the hook caller know that this channel has loaded\n      const isInitialLoad = channelVersionsRef.current[channelIndex] === CHANNEL_INITIAL_LOAD;\n      onChannelLoadedRef.current?.(aimg, channelIndex, isInitialLoad);\n\n      // set this channel as loaded\n      const newVersions = channelVersionsRef.current.slice();\n      newVersions[channelIndex] = Math.max(newVersions[channelIndex], CHANNEL_RELOAD) + 1;\n      setChannelVersions(newVersions);\n\n      // if the whole image has loaded, let `playControls` know (if we're playing, it may want to go to the next frame)\n      if (aimg.isLoaded()) {\n        playControls.onImageLoaded();\n      }\n    },\n    [channelVersionsRef, onChannelLoadedRef, playControls, setChannelVersions]\n  );\n\n  // effect to start the initial load of the image\n  useEffect(() => {\n    const { changeViewerSetting, channelSettings, getCurrentViewerChannelSettings, setChannelSettings } =\n      viewerStateRef.current;\n    setChannelVersions(new Array(channelVersionsRef.current.length).fill(CHANNEL_INITIAL_LOAD));\n    setLoadThrewError(false);\n    inInitialLoadRef.current = true;\n\n    const setChannelStateForNewImage = (channelNames: string[]): ChannelState[] | undefined => {\n      const viewerChannelSettings = getCurrentViewerChannelSettings();\n      const grouping = makeChannelIndexGrouping(channelNames, viewerChannelSettings);\n      setChannelGroupedByType(grouping);\n\n      // compare each channel's new displayName to the old displayNames currently in state:\n      // same number of channels, and each channel has same displayName\n      const allNamesAreEqual = channelNames.every((name, idx) => {\n        const displayName = getDisplayName(name, idx, viewerChannelSettings);\n        return displayName === channelSettings[idx]?.displayName;\n      });\n\n      if (allNamesAreEqual) {\n        const newChannelSettings = channelNames.map((channel, index) => {\n          return { ...channelSettings[index], name: channel };\n        });\n        setChannelSettings(newChannelSettings);\n        return newChannelSettings;\n      }\n\n      const newChannelSettings = channelNames.map((channel, index) => {\n        const color = getDefaultChannelColor(index);\n        return initializeOneChannelSetting(channel, index, color, viewerChannelSettings);\n      });\n      setChannelSettings(newChannelSettings);\n      return newChannelSettings;\n    };\n\n    const openImage = async (): Promise<void> => {\n      const { scene, time } = viewerStateRef.current;\n\n      const loadSpec = new LoadSpec();\n      loadSpec.time = time;\n\n      const aimg = await sceneLoader.createVolume(scene, loadSpec, onChannelDataLoaded).catch(onError);\n\n      const channelNames = aimg.imageInfo.channelNames;\n      const newChannelSettings = setChannelStateForNewImage(channelNames);\n\n      setChannelVersions(new Array(channelNames.length).fill(CHANNEL_INITIAL_LOAD));\n      setImage(aimg);\n\n      onCreateImageRef.current?.(aimg);\n\n      playControls.stepAxis = (axis: AxisName | \"t\") => {\n        const { time, slice } = viewerStateRef.current;\n        if (axis === \"t\") {\n          changeViewerSetting(\"time\", (time + 1) % aimg.imageInfo.times);\n        } else {\n          const max = aimg.imageInfo.volumeSize[axis];\n          const current = slice[axis] * max;\n          changeViewerSetting(\"slice\", { ...slice, [axis]: ((current + 1) % max) / max });\n        }\n      };\n      playControls.getVolumeIsLoaded = aimg.isLoaded.bind(aimg);\n\n      const requiredLoadSpec = new LoadSpec();\n      requiredLoadSpec.time = time;\n\n      // make the currently enabled channels \"required\":\n      // find all enabled indices in newChannelSettings:\n      const requiredChannelsToLoad = newChannelSettings\n        ? newChannelSettings.map((channel, index) => (channel.volumeEnabled ? index : -1)).filter((index) => index >= 0)\n        : [];\n\n      // add mask channel to required channels, if specified\n      const maskChannelName = getCurrentViewerChannelSettings()?.maskChannelName;\n      if (maskChannelName) {\n        const maskChannelIndex = channelNames.indexOf(maskChannelName);\n        if (maskChannelIndex >= 0 && !requiredChannelsToLoad.includes(maskChannelIndex)) {\n          requiredChannelsToLoad.push(maskChannelIndex);\n        }\n      }\n      requiredLoadSpec.channels = requiredChannelsToLoad;\n\n      // When in 2D Z-axis view mode, we restrict the subregion to only the current slice. This is\n      // to match an optimization that volume viewer does by loading Z-slices at a higher resolution,\n      // and ensures the very first volume that is loaded is the same as the one that\n      // will be shown whenever we switch back to the same viewer settings (2D Z-axis view mode).\n      // (We don't do this for ZX and YZ modes because we assume that the data won't be chunked along the\n      // X or Y axes in ways that would improve loading resolution, and we load the full 3D volume instead.)\n      if (viewerStateRef.current.viewMode === ViewMode.xy) {\n        const slice = viewerStateRef.current.slice;\n        requiredLoadSpec.subregion = new Box3(new Vector3(0, 0, slice.z), new Vector3(1, 1, slice.z));\n      }\n\n      // initiate loading only after setting up new channel settings,\n      // in case the loader callback fires before the state is set\n      sceneLoader.loadScene(scene, aimg, requiredLoadSpec).catch(onError);\n    };\n\n    openImage();\n  }, [\n    sceneLoader,\n    onError,\n    onCreateImageRef,\n    onChannelLoadedRef,\n    viewerStateRef,\n    channelVersionsRef,\n    setChannelVersions,\n    playControls,\n    setIsLoading,\n    onChannelDataLoaded,\n  ]);\n  // of the above dependencies, we expect only `sceneLoader` to change.\n\n  const setTime = useCallback(\n    (view3d: View3d, time: number): void => {\n      if (image && !inInitialLoadRef.current) {\n        view3d.setTime(image, time, onChannelDataLoaded).catch(onError);\n        setIsLoading();\n      }\n    },\n    [image, onError, setIsLoading, inInitialLoadRef, onChannelDataLoaded]\n  );\n\n  const setScene = useCallback(\n    (scene: number): void => {\n      if (image && !inInitialLoadRef.current) {\n        sceneLoader.loadScene(scene, image, undefined, onChannelDataLoaded).catch(onError);\n        setIsLoading();\n      }\n    },\n    [image, onError, sceneLoader, setIsLoading, inInitialLoadRef, onChannelDataLoaded]\n  );\n\n  return useMemo(\n    () => ({\n      image,\n      channelVersions,\n      imageLoadStatus,\n      setTime,\n      setScene,\n      playControls,\n      playingAxis,\n      channelGroupedByType,\n    }),\n    [image, channelVersions, imageLoadStatus, setTime, setScene, playControls, playingAxis, channelGroupedByType]\n  );\n};\n\nexport default useVolume;\n","import React from \"react\";\nimport { CaretDownOutlined, CaretUpOutlined } from \"@ant-design/icons\";\n\nimport { useRefWithSetter } from \"../../../shared/utils/hooks\";\n\nimport \"./styles.css\";\n\ninterface NumericInputProps {\n  value: number;\n  step?: number;\n  precision?: number;\n  min?: number;\n  max?: number;\n  disabled?: boolean;\n  className?: string;\n  onChange: (value: number) => void;\n}\n\n/**\n * Fully-controlled numeric input (value must be supplied from state in parent).\n * Changeable with arrow keys, typing values, or clickable arrows. Inspired by\n * ant's `InputNumber`, but conforms to our style and behavior expectations.\n */\nconst NumericInput: React.FC<NumericInputProps> = ({\n  value,\n  step = 1,\n  precision = step,\n  min = 0,\n  max = Number.MAX_SAFE_INTEGER,\n  disabled = false,\n  className = \"\",\n  onChange,\n}) => {\n  // While the input has focus, allow invalid input, just don't call `onChange` with it\n  const [hasFocus, _setHasFocus] = React.useState(false);\n  // State doesn't update before focus handler runs - keep a ref following focus state\n  const [hasFocusRef, setHasFocus] = useRefWithSetter(_setHasFocus, hasFocus);\n\n  // Hold the potentially invalid contents of the focused input here\n  const [textContent, setTextContent] = React.useState(\"\");\n\n  const inputRef = React.useRef<HTMLInputElement>(null);\n\n  const clamp = (newValue: number): number => Math.min(Math.max(newValue, min), max);\n  const roundToPrecision = (newValue: number): number => clamp(Math.round(newValue / precision) * precision);\n  const shouldChange = (newValue: number): boolean => !(isNaN(newValue) || newValue === value || disabled);\n\n  const displayedValue = roundToPrecision(value);\n\n  const onFocus = (): void => {\n    if (!hasFocusRef.current) {\n      // propagate current value to `textContent` on focus\n      setTextContent(displayedValue.toString());\n      setHasFocus(true);\n    }\n  };\n\n  const changeByStep = (up: boolean): void => {\n    const delta = up ? step : -step;\n    const newValue = clamp(displayedValue + delta);\n\n    if (shouldChange(newValue)) {\n      onChange(newValue);\n      setTextContent(newValue.toString());\n      // let the focus handler know we've taken care of things, so it won't restore the previous value\n      setHasFocus(true);\n    }\n\n    inputRef.current?.focus();\n  };\n\n  const onKeyDown: React.KeyboardEventHandler<HTMLDivElement> = (event) => {\n    const { key } = event;\n\n    if ([\"Up\", \"ArrowUp\", \"Down\", \"ArrowDown\"].includes(key)) {\n      changeByStep(key === \"Up\" || key === \"ArrowUp\");\n      event.preventDefault();\n    } else if (key === \"Enter\") {\n      inputRef.current?.blur();\n    }\n  };\n\n  const handleTyping = (inputStr: string): void => {\n    setTextContent(inputStr);\n\n    // if the user clears all text, assume they mean 0 (or the extremum closest to it)\n    // this is likely not completely general, but should be reasonable for any of our purposes\n    const inputNum = inputStr === \"\" ? 0 : parseFloat(inputStr);\n    const newValue = roundToPrecision(inputNum);\n\n    if (shouldChange(newValue)) {\n      onChange(newValue);\n    }\n  };\n\n  const fullClassName = \"numinput\" + (disabled ? \" numinput-disabled\" : \"\") + (className && ` ${className}`);\n  return (\n    <div className={fullClassName} onKeyDown={onKeyDown}>\n      <input\n        value={hasFocus ? textContent : displayedValue}\n        step={step}\n        min={min}\n        max={max}\n        disabled={disabled}\n        className=\"numinput-input\"\n        autoComplete=\"off\"\n        role=\"spinbutton\"\n        aria-valuenow={displayedValue}\n        aria-valuemin={min}\n        aria-valuemax={max}\n        ref={inputRef}\n        onChange={({ target }) => handleTyping(target.value)}\n        onFocus={onFocus}\n        onBlur={() => setHasFocus(false)}\n      />\n      <div className=\"numinput-controls\">\n        <div\n          className=\"numinput-controls-button numinput-controls-button-up\"\n          role=\"button\"\n          aria-label=\"Increase Value\"\n          aria-disabled={disabled}\n          onClick={() => changeByStep(true)}\n        >\n          <CaretUpOutlined className=\"numinput-controls-button-icon\" />\n        </div>\n        <div\n          className=\"numinput-controls-button numinput-controls-button-down\"\n          role=\"button\"\n          aria-label=\"Decrease Value\"\n          aria-disabled={disabled}\n          onClick={() => changeByStep(false)}\n        >\n          <CaretDownOutlined className=\"numinput-controls-button-icon\" />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NumericInput;\n","import React from \"react\";\nimport Nouislider, { NouisliderProps } from \"nouislider-react\";\n\ntype CallbackArgs = Parameters<NonNullable<NouisliderProps[\"onStart\"]>>;\n\nconst MemoedNouislider = React.memo(\n  Nouislider as React.ComponentType<NouisliderProps & { noUpdate: boolean }>,\n  (_prevProps, { noUpdate }) => noUpdate\n);\n\n/** A wrapper around `Nouislider` that prevents updates while the slider is being dragged. */\nconst SmarterSlider: React.FC<NouisliderProps> = (props) => {\n  const [noUpdate, setNoUpdate] = React.useState(false);\n  const wrapEventHandler = (shouldNotUpdate: boolean, handler?: (...args: CallbackArgs) => void) => {\n    return (...args: CallbackArgs) => {\n      setNoUpdate(shouldNotUpdate);\n      if (handler) handler(...args);\n    };\n  };\n\n  const onStart = wrapEventHandler(true, props.onStart);\n  const onEnd = wrapEventHandler(false, props.onEnd);\n  return <MemoedNouislider {...{ ...props, noUpdate, onStart, onEnd }} />;\n};\n\nexport default SmarterSlider;\n","import { Volume } from \"@aics/vole-core\";\nimport { CaretRightOutlined, PauseOutlined } from \"@ant-design/icons\";\nimport { Button, Tooltip } from \"antd\";\nimport React, { useCallback, useEffect, useState } from \"react\";\n\nimport { ViewMode } from \"../../shared/enums\";\nimport { activeAxisMap, AxisName, PerAxis } from \"../../shared/types\";\nimport PlayControls from \"../../shared/utils/playControls\";\nimport { ViewerSettingUpdater } from \"../ViewerStateProvider/types\";\n\nimport NumericInput from \"../shared/NumericInput\";\nimport SmarterSlider from \"../shared/SmarterSlider\";\n\nimport \"./styles.css\";\n\nconst AXES: AxisName[] = [\"x\", \"y\", \"z\"];\n\ntype SliderRowProps = {\n  label: string;\n  vals: number[];\n  valsReadout?: number[];\n  max: number;\n  // These event handlers attach to the events of the same names provided by noUiSlider.\n  // Their behavior is documented at https://refreshless.com/nouislider/events-callbacks/\n  onSlide?: (values: number[]) => void;\n  /** `onChange` is called on the corresponding noUiSlider event AND on interaction with a spinbox. */\n  onChange?: (values: number[]) => void;\n  onStart?: () => void;\n  onEnd?: () => void;\n};\n\n/** A single slider row, with a slider, one or two spinbox inputs, and a max value */\nconst SliderRow: React.FC<SliderRowProps> = ({\n  label,\n  vals,\n  valsReadout = vals,\n  max,\n  onSlide,\n  onChange = onSlide,\n  onStart,\n  onEnd,\n}) => {\n  const isRange = vals.length > 1;\n  // If slider is a range, handles represent slice *edges*: the range around only the 1st slice is [0, 1]; the range\n  // around only the last is [max-1, max].\n  // If slider is not a range, just work with slices, but don't 0-index: 1st slice is 1, last is max\n  const min = isRange ? 0 : 1;\n  const wrappedOnSlide = isRange ? onSlide : (values: number[]) => onSlide?.([values[0] - 1]);\n  const wrappedOnChange = isRange ? onChange : (values: number[]) => onChange?.([values[0] - 1]);\n\n  return (\n    <span className=\"axis-slider-container\">\n      <span className=\"slider-name\">{label}</span>\n      {max <= min ? (\n        <i>No values to adjust</i>\n      ) : (\n        <span className=\"axis-slider\">\n          <SmarterSlider\n            className={isRange ? \"\" : \"slider-single-handle\"}\n            connect={true}\n            range={{ min, max }}\n            start={isRange ? vals : [vals[0] + 1]}\n            step={1}\n            margin={1}\n            behaviour=\"drag\"\n            pips={{\n              mode: \"positions\",\n              values: [25, 50, 75],\n              density: 25,\n              format: {\n                // remove labels from pips\n                to: () => \"\",\n              },\n            }}\n            // round slider output to nearest slice; assume any string inputs represent ints\n            format={{ to: Math.round, from: parseInt }}\n            onSlide={wrappedOnSlide}\n            onChange={wrappedOnChange}\n            onStart={onStart}\n            onEnd={onEnd}\n          />\n        </span>\n      )}\n      {max > min && (\n        <span className=\"slider-values\">\n          <NumericInput\n            min={min}\n            max={max}\n            value={valsReadout[0] + (isRange ? 0 : 1)}\n            onChange={(value) => onChange?.(isRange ? [value, vals[1]] : [value - 1])}\n          />\n          {isRange && (\n            <>\n              {\" , \"}\n              <NumericInput\n                min={min}\n                max={max}\n                value={valsReadout[1]}\n                onChange={(value) => onChange?.([vals[0], value])}\n              />\n            </>\n          )}\n          {\" / \"}\n          {max}\n        </span>\n      )}\n    </span>\n  );\n};\n\ntype PlaySliderRowProps = {\n  label: string;\n  val: number;\n  max: number;\n  playing: boolean;\n  updateWhileSliding?: boolean;\n  onTogglePlayback: (play: boolean) => void;\n  // These event handlers attach to the events of the same names provided by noUiSlider.\n  // Their behavior is documented at https://refreshless.com/nouislider/events-callbacks/\n  /**\n   * `onChange`'s behavior depends on `updateWhileSliding`: if true, it's called on slide and on release;\n   * if false, it's called only on slide.\n   */\n  onChange?: (values: number) => void;\n  onStart?: () => void;\n  onEnd?: () => void;\n};\n\n/** Wrapper around `SliderRow` that adds a play button and accounts for the case where not all of an axis is loaded */\nconst PlaySliderRow: React.FC<PlaySliderRowProps> = (props) => {\n  const { onChange, onStart, onEnd } = props;\n  // In partially-loaded axes, stores the displayed value of the slider while the user is sliding it\n  const [valReadout, setValReadout] = useState(props.val);\n  // Tracks when the user is sliding the slider and `valReadout` may have to sub in for props\n  const [sliderHeld, setSliderHeld] = useState(false);\n\n  const wrappedOnChange = useCallback(([val]: number[]) => onChange?.(val), [onChange]);\n  const wrappedSetValReadout = useCallback(([val]: number[]) => setValReadout(val), []);\n  const wrappedOnStart = useCallback((): void => {\n    setValReadout(props.val);\n    setSliderHeld(true);\n    onStart?.();\n  }, [onStart, props.val]);\n  const wrappedOnEnd = useCallback((): void => {\n    setSliderHeld(false);\n    onEnd?.();\n  }, [onEnd]);\n\n  return (\n    <>\n      <SliderRow\n        label={props.label}\n        vals={[props.val]}\n        valsReadout={props.updateWhileSliding || !sliderHeld ? undefined : [valReadout]}\n        max={props.max}\n        onSlide={props.updateWhileSliding ? wrappedOnChange : wrappedSetValReadout}\n        onChange={props.updateWhileSliding ? undefined : wrappedOnChange}\n        onStart={wrappedOnStart}\n        onEnd={wrappedOnEnd}\n      />\n      {props.max > 1 && (\n        <Tooltip placement=\"top\" title=\"Play through sequence\" trigger={[\"hover\", \"focus\"]}>\n          <Button\n            className=\"slider-play-button\"\n            onClick={() => props.onTogglePlayback(!props.playing)}\n            icon={props.playing ? <PauseOutlined /> : <CaretRightOutlined />}\n            aria-label={(props.playing ? \"Pause \" : \"Play \") + props.label}\n          />\n        </Tooltip>\n      )}\n    </>\n  );\n};\n\ntype AxisClipSlidersProps = {\n  mode: ViewMode;\n  image: Volume | null;\n  changeViewerSetting: ViewerSettingUpdater;\n  numSlices: PerAxis<number>;\n  numSlicesLoaded: PerAxis<number>;\n  numScenes: number;\n  region: PerAxis<[number, number]>;\n  slices: PerAxis<number>;\n  numTimesteps: number;\n  time: number;\n  scene: number;\n  playingAxis: AxisName | \"t\" | null;\n  playControls: PlayControls;\n};\n\nconst AxisClipSliders: React.FC<AxisClipSlidersProps> = (props) => {\n  const activeAxis = activeAxisMap[props.mode];\n\n  const pauseOnInput = (axis: AxisName | \"t\"): void => {\n    // Pause on slider input unless user is scrubbing along the playing axis (playback is held while this is happening)\n    if (!props.playControls.playHolding || props.playingAxis !== axis) {\n      props.playControls.pause();\n    }\n  };\n\n  const updateRegion = (axis: AxisName, minval: number, maxval: number): void => {\n    pauseOnInput(axis);\n\n    const { changeViewerSetting, numSlices } = props;\n    // get a value from 0-1\n    const max = numSlices[axis];\n    const start = minval / max;\n    const end = maxval / max;\n    changeViewerSetting(\"region\", { [axis]: [start, end] });\n  };\n\n  const updateSlice = (axis: AxisName, slice: number): void => {\n    pauseOnInput(axis);\n    props.changeViewerSetting(\"slice\", { [axis]: slice / props.numSlices[axis] });\n  };\n\n  const updateTime = (time: number): void => {\n    pauseOnInput(\"t\");\n    props.changeViewerSetting(\"time\", time);\n  };\n\n  // Pause when view mode or volume size has changed\n  useEffect(() => props.playControls.pause(), [props.mode, props.image, props.playControls]);\n\n  const handlePlayPause = (axis: AxisName | \"t\", willPlay: boolean): void => {\n    if (willPlay) {\n      props.playControls.play(axis);\n    } else {\n      props.playControls.pause();\n    }\n  };\n\n  const create2dAxisSlider = (axis: AxisName): React.ReactNode => {\n    const numSlices = props.numSlices[axis];\n    const numSlicesLoaded = props.numSlicesLoaded[axis];\n\n    return (\n      <div key={axis + numSlices + numSlicesLoaded} className={`slider-row slider-${axis}`}>\n        <PlaySliderRow\n          label={axis.toUpperCase()}\n          val={Math.round(props.slices[axis] * numSlices)}\n          max={numSlices}\n          onChange={(val) => updateSlice(axis, val)}\n          onStart={() => props.playControls.startHold(axis)}\n          onEnd={() => props.playControls.endHold()}\n          playing={props.playingAxis === axis}\n          onTogglePlayback={(willPlay) => handlePlayPause(axis, willPlay)}\n          updateWhileSliding={numSlices === numSlicesLoaded}\n        />\n      </div>\n    );\n  };\n\n  const create3dAxisSlider = (axis: AxisName): React.ReactNode => {\n    const numSlices = props.numSlices[axis];\n    if (numSlices === 1) {\n      return null;\n    }\n    const region = props.region[axis];\n\n    return (\n      <div key={axis + numSlices + \"3d\"} className={`slider-row slider-${axis}`}>\n        <SliderRow\n          label={axis.toUpperCase()}\n          vals={[Math.round(region[0] * numSlices), Math.round(region[1] * numSlices)]}\n          max={numSlices}\n          onSlide={(values) => updateRegion(axis, values[0], values[1])}\n          onStart={() => props.playControls.startHold(axis)}\n          onEnd={() => props.playControls.endHold()}\n        />\n      </div>\n    );\n  };\n\n  return (\n    <div className={activeAxis ? \"clip-sliders clip-sliders-2d\" : \"clip-sliders\"}>\n      <span className=\"slider-group\">\n        <h4 className=\"slider-group-title\">ROI</h4>\n        <span className=\"slider-group-rows\">\n          {activeAxis ? create2dAxisSlider(activeAxis) : AXES.map(create3dAxisSlider)}\n        </span>\n      </span>\n\n      {props.numTimesteps > 1 && (\n        <span className=\"slider-group\">\n          <h4 className=\"slider-group-title\">Time</h4>\n          <span className=\"slider-group-rows\">\n            <div className=\"slider-row slider-t\">\n              <PlaySliderRow\n                label={\"\"}\n                val={props.time}\n                max={props.numTimesteps}\n                playing={props.playingAxis === \"t\"}\n                onTogglePlayback={(willPlay) => handlePlayPause(\"t\", willPlay)}\n                onChange={(time) => updateTime(time)}\n                onStart={() => props.playControls.startHold(\"t\")}\n                onEnd={() => props.playControls.endHold()}\n              />\n            </div>\n          </span>\n        </span>\n      )}\n\n      {props.numScenes > 1 && (\n        <span className=\"slider-group\">\n          <h4 className=\"slider-group-title\">Scene</h4>\n          <span className=\"slider-group-rows\">\n            <div className=\"slider-row slider-scene\">\n              <SliderRow\n                label={\"\"}\n                vals={[props.scene]}\n                max={props.numScenes}\n                onChange={([scene]) => props.changeViewerSetting(\"scene\", scene)}\n              />\n            </div>\n          </span>\n        </span>\n      )}\n    </div>\n  );\n};\n\nexport default AxisClipSliders;\n","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-turnTable-f\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"arrow-tail\" d=\"M19.19,7.69c-.09,.16-.19,.3-.3,.44-.26-.29-.55-.56-.85-.8,.34-.28,.58-.61,.61-.99,.05-.55-.4-1.15-.95-1.59-.56-.45-1.23-.79-1.92-1.07-.08-.04-.12-.13-.08-.21,.03-.07,.11-.11,.19-.09,.73,.21,1.46,.48,2.15,.89,.34,.21,.67,.46,.95,.79,.28,.32,.51,.76,.55,1.25,.05,.49-.1,.99-.35,1.38Z\" fill=\"currentColor\"/>\n  <path id=\"arrow-head\" d=\"M7.85,5.12l1.54-1.8c-1.27,.03-2.52,.18-3.73,.46-.71,.16-1.4,.37-2.05,.65-.64,.28-1.25,.63-1.67,1.06-.43,.45-.54,.87-.33,1.29,.22,.45,.76,.88,1.36,1.19,1.13,.6,2.46,.94,3.81,1.15-.27,.42-.51,.87-.7,1.35-1.29-.23-2.56-.6-3.79-1.26-.71-.4-1.46-.9-1.93-1.83-.23-.46-.3-1.05-.16-1.57,.14-.53,.43-.94,.75-1.27,.65-.65,1.39-1.04,2.13-1.35,.75-.32,1.51-.54,2.28-.71,1.39-.31,2.79-.45,4.19-.46L8.28,0l5.86,3.07-6.29,2.05Z\" fill=\"currentColor\"/>\n  <path id=\"button\" d=\"M18.17,8.83c-.31-.36-.66-.67-1.05-.95h-.01c-1.09-.79-2.43-1.26-3.89-1.26-2.16,0-4.09,1.03-5.3,2.63-.33,.42-.61,.88-.82,1.38-.36,.81-.56,1.72-.56,2.67,0,3.69,2.99,6.68,6.68,6.68s6.68-2.99,6.68-6.68c0-1.73-.65-3.29-1.73-4.47Zm-4.95,10.15c-3.13,0-5.68-2.55-5.68-5.68,0-.92,.22-1.79,.62-2.56,.26-.52,.6-1,1.01-1.41,1.03-1.06,2.47-1.71,4.05-1.71,1,0,1.94,.26,2.76,.72,.5,.28,.96,.64,1.35,1.06,.97,1.01,1.57,2.38,1.57,3.9,0,3.13-2.55,5.68-5.68,5.68Z\" fill=\"currentColor\"/>\n  <path id=\"play-head\" d=\"M12.83,10.68l-1.18-.94v7.16l4.48-3.58-3.3-2.64Zm-.18,1.14l1.88,1.5-1.88,1.5v-3Z\" fill=\"currentColor\"/>\n</svg>","import axes from \"./axes.svg\";\nimport boundingBox from \"./boundingBox.svg\";\nimport camera from \"./camera.svg\";\nimport channels from \"./channels.svg\";\nimport closePanel from \"./closePanel.svg\";\nimport download from \"./download.svg\";\nimport dropdownArrow from \"./dropdownArrow.svg\";\nimport metadata from \"./metadata.svg\";\nimport preferences from \"./preferences.svg\";\nimport resetView from \"./resetView.svg\";\nimport turnTable from \"./turnTable.svg\";\n\nexport default {\n  axes,\n  boundingBox,\n  camera,\n  channels,\n  closePanel,\n  download,\n  dropdownArrow,\n  metadata,\n  preferences,\n  resetView,\n  turnTable,\n};\n","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-axes\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <circle id=\"center\" cx=\"6.26\" cy=\"12.84\" r=\"1\" fill=\"currentColor\"/>\n  <path id=\"arrow-x\" d=\"M14.27,15.23l.7-1.64h-6.86c.09-.23,.15-.48,.15-.75s-.06-.52-.15-.75h6.86l-.7-1.64,5.66,2.39-5.66,2.39Z\" fill=\"currentColor\"/>\n  <path id=\"arrow-y\" d=\"M6.26,.03L3.87,5.69l1.64-.69v5.99c.23-.1,.48-.15,.75-.15s.52,.05,.75,.15V5l1.64,.69L6.26,.03Z\" fill=\"currentColor\"/>\n  <path id=\"arrow-z\" d=\"M5.59,17.23L.07,19.91l1.93-5.83,.77,1.6,1.61-1.83s.08-.06,.11-.09c.23,.44,.62,.78,1.09,.95-.02,.04-.04,.09-.07,.12l-1.61,1.84,1.69,.56Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 20 20\">\n    <path id=\"back\" d=\"M.52,13.67m12.76-3.42c0,.21,.17,.38,.38,.38s.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25Zm-2.5,3.42c0-.21-.17-.38-.38-.38h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38Zm3.93,.52l-.68-.67s0,0,0-.01v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.05h-.88c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.1l.68,.67c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53Zm2.31,2.29l-.89-.88c-.15-.15-.38-.14-.53,0-.15,.15-.15,.38,0,.53l.89,.88c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53Zm-12.73-2.81c0-.21-.17-.38-.38-.38h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38ZM13.27,3.75c0,.21,.17,.38,.38,.38s.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25Zm.75,2c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v.08h.75v-.08Zm-.38,1.62c.21,0,.38-.17,.38-.38v-.17h-.75v.17c0,.21,.17,.38,.38,.38Zm0-3.25c.21,0,.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25c0,.21,.17,.38,.38,.38ZM3.9,13.3h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38s-.17-.38-.38-.38Zm1.62,.38c0,.19,.14,.34,.32,.36v-.73c-.18,.03-.32,.18-.32,.36Zm10.59,1.93c-.15-.15-.38-.14-.53,0-.15,.15-.15,.38,0,.53l.89,.88c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53l-.89-.88Zm2.86,2.84l-.56-.55c-.15-.15-.38-.15-.53,0-.15,.15-.15,.38,0,.53l.55,.54h.54v-.52Zm-8.58-5.14h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38s-.17-.38-.38-.38Zm3.62,.22s0,0,0-.01v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.05h-.88c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.1l.68,.67c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53l-.68-.67Zm-.37-2.89c.21,0,.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25c0,.21,.17,.38,.38,.38Zm-6.12,3.05c0-.21-.17-.38-.38-.38h-.3v.75h.3c.21,0,.38-.17,.38-.38Z\" fill=\"currentColor\"/>\n    <path id=\"front\" d=\"M19.83,5.98h0l-.7-.69L14.7,.88s-.23-.23-.69-.69c0,0,0,0,0,0,0,0,0,0,0,0h0c-.09-.09-.21-.15-.35-.15H.52C.24,.04,.02,.26,.02,.54V13.67c0,.14,.06,.26,.15,.35,0,0,0,0,0,0,.46,.46,.7,.69,.7,.69l4.44,4.41s.23,.23,.7,.69c0,0,0,0,0,0,.09,.09,.21,.15,.35,.15h13.13c.28,0,.5-.22,.5-.5V6.33c0-.14-.06-.26-.15-.35ZM5.85,13.31v4.96L1.56,14.01s-.19-.19-.55-.54V1.74L5.3,6s.19,.19,.55,.54v6.77Zm.16-8.02L1.73,1.04H13.44c.36,.36,.55,.55,.55,.55l4.28,4.25H6.55c-.36-.36-.55-.55-.55-.55Zm.84,13.68V6.83h12.13v12.13H6.85Z\" fill=\"currentColor\"/>\n</svg>\n","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"Layer_2\" data-name=\"Layer 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <g id=\"icon-camera\">\n    <path id=\"camera-body\" d=\"M29.54,32H2.46c-1.36,0-2.46-1.1-2.46-2.45V15.34c0-1.35,1.1-2.45,2.46-2.45h6.64c1.21,0,2.34-.54,3.1-1.48l.88-1.09c.75-.94,1.88-1.47,3.08-1.47h6.32c1.21,0,2.33,.54,3.08,1.47l.88,1.09c.76,.94,1.89,1.48,3.1,1.48,1.36,0,2.46,1.1,2.46,2.45v14.21c0,1.35-1.1,2.45-2.46,2.45ZM2.46,13.9c-.8,0-1.46,.65-1.46,1.45v14.21c0,.8,.65,1.45,1.46,1.45H29.54c.8,0,1.46-.65,1.46-1.45V15.34c0-.8-.65-1.45-1.46-1.45-1.52,0-2.93-.68-3.88-1.85l-.88-1.09c-.56-.7-1.4-1.1-2.3-1.1h-6.32c-.9,0-1.74,.4-2.3,1.1l-.88,1.09c-.95,1.18-2.36,1.85-3.88,1.85H2.46Zm4.25,4.85c.58,0,1.04-.46,1.04-1.03s-.47-1.03-1.04-1.03h-1.67c-.58,0-1.04,.46-1.04,1.03s.47,1.03,1.04,1.03h1.67Zm12.61-3.24c2.81,0,5.09,2.29,5.09,5.1s-2.28,5.1-5.09,5.1-5.09-2.29-5.09-5.1,2.28-5.1,5.09-5.1m0-2c-3.91,0-7.09,3.18-7.09,7.1s3.17,7.1,7.09,7.1,7.09-3.18,7.09-7.1-3.17-7.1-7.09-7.1h0Z\" fill=\"currentColor\"/>\n    <path id=\"burst-lines\" d=\"M19.39,3.87c-.28,0-.5-.22-.5-.5V.5c0-.28,.22-.5,.5-.5s.5,.22,.5,.5V3.37c0,.28-.22,.5-.5,.5Zm4.76,1.12l2.15-2.34c.19-.2,.17-.52-.03-.71-.2-.18-.52-.17-.71,.03l-2.15,2.34c-.19,.2-.17,.52,.03,.71,.1,.09,.22,.13,.34,.13,.13,0,.27-.05,.37-.16Zm-8.95,.03c.2-.19,.22-.5,.03-.71l-2.15-2.34c-.19-.2-.5-.21-.71-.03-.2,.19-.22,.5-.03,.71l2.15,2.34c.1,.11,.23,.16,.37,.16,.12,0,.24-.04,.34-.13Z\" fill=\"currentColor\"/>\n  </g>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-channels\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"line-mid\" d=\"M13.55,10.36h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Z\" fill=\"currentColor\"/>\n  <path id=\"line-top\" d=\"M2.65,6.64c-.21,0-.38-.17-.38-.38v-.3c0-.26,.03-.52,.08-.78,.04-.2,.24-.33,.45-.29,.2,.04,.33,.24,.29,.45-.04,.2-.07,.41-.07,.62v.3c0,.21-.17,.38-.38,.38Zm1.06-2.7c-.1,0-.2-.04-.28-.12-.14-.15-.13-.39,.02-.53,.27-.25,.59-.46,.92-.62,.19-.09,.41,0,.5,.18s0,.41-.18,.5c-.27,.12-.51,.29-.73,.49-.07,.07-.16,.1-.25,.1Zm9.78-.86h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Z\" fill=\"currentColor\"/>\n  <path id=\"line-bottom\" d=\"M13.44,17.69h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-2.95-.32c-.05,0-.11-.01-.16-.04-.33-.16-.64-.38-.91-.63-.15-.14-.16-.38-.02-.53s.38-.16,.53-.02c.22,.2,.46,.37,.73,.5,.19,.09,.26,.32,.17,.5-.06,.13-.2,.21-.34,.21Zm-1.78-2.28c-.17,0-.33-.12-.37-.3-.05-.24-.07-.48-.07-.73v-.34c0-.21,.17-.38,.38-.38s.38,.17,.38,.38v.34c0,.19,.02,.39,.06,.58,.04,.2-.09,.4-.29,.44-.02,0-.05,0-.08,0Z\" fill=\"currentColor\"/>\n  <path id=\"channel-composite\" d=\"M5.42,12.69H.01V7.29H5.42v5.4Zm-4.4-1h3.4v-3.4H1.01v3.4Z\" fill=\"currentColor\"/>\n  <path id=\"channel-1\" d=\"M19.99,5.41h-5.4V0h5.4V5.41Zm-4.4-1h3.4V1h-3.4v3.4Z\" fill=\"currentColor\"/>\n  <path id=\"channel-2\" d=\"M19.99,12.69h-5.4V7.29h5.4v5.4Zm-4.4-1h3.4v-3.4h-3.4v3.4Z\" fill=\"currentColor\"/>\n  <path id=\"channel-3\" d=\"M19.99,19.97h-5.4v-5.4h5.4v5.4Zm-4.4-1h3.4v-3.4h-3.4v3.4Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-openPanel\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"chevron-2\" d=\"M10.64,17.78c-.21,0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21L9.83,3.76c-.33-.44-.23-1.07,.21-1.4,.44-.33,1.07-.23,1.4,.21l5.03,6.8c.26,.35,.26,.84,0,1.19l-5.03,6.81c-.2,.27-.5,.41-.81,.41Z\" fill=\"currentColor\"/>\n  <path id=\"chevron-1\" d=\"M4.33,17.84c-.21,0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21L3.53,3.82c-.33-.44-.23-1.07,.21-1.4,.44-.33,1.07-.23,1.4,.21l5.03,6.81c.26,.35,.26,.83,0,1.19l-5.03,6.81c-.2,.27-.5,.41-.81,.41Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"Layer_2\" data-name=\"Layer 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <g id=\"icon-download\">\n    <polygon id=\"arrow\" points=\"17 14.93 17 0 15 0 15 14.93 11.56 13.47 16 24 20.44 13.47 17 14.93\" fill=\"currentColor\"/>\n    <path id=\"base\" d=\"M28.5,32H3.5c-1.38,0-2.5-1.12-2.5-2.5v-9.5h1v9.5c0,.83,.67,1.5,1.5,1.5H28.5c.83,0,1.5-.67,1.5-1.5v-9.5h1v9.5c0,1.38-1.12,2.5-2.5,2.5Z\" fill=\"currentColor\"/>\n  </g>\n</svg>","<svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"14\"\n    height=\"14\"\n    viewBox=\"0 0 12 12\"\n>\n    <path\n        fill=\"currentColor\"\n        d=\"M1.11652 3.1204C1.30891 2.94718 1.6053 2.96271 1.77853 3.1551L6.0059 7.85006L10.2333 3.1551C10.4065 2.96271 10.7029 2.94718 10.8953 3.12041C11.0876 3.29363 11.1032 3.59002 10.9299 3.78241L6.37171 8.84486C6.27496 8.9523 6.1398 9.00459 6.00579 8.99963C5.87185 9.00453 5.73678 8.95224 5.64008 8.84485L1.08183 3.78241C0.908604 3.59002 0.924137 3.29363 1.11652 3.1204Z\"\n    />\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"Layer_2\" data-name=\"Layer 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <g id=\"icon-metadata\">\n    <path id=\"lines\" d=\"M19.46,21.54c0-.28-.22-.5-.5-.5H.5c-.28,0-.5,.22-.5,.5s.22,.5,.5,.5H18.96c.28,0,.5-.22,.5-.5Zm3.52-14.03c0-.28-.22-.5-.5-.5H.51C.23,7.01,0,7.24,0,7.51s.22,.5,.5,.5H22.48c.28,0,.5-.22,.5-.5Zm-4.74,7.01c0-.28-.22-.5-.5-.5H.5c-.28,0-.5,.22-.5,.5s.22,.5,.5,.5H17.75c.28,0,.5-.22,.5-.5ZM32,.5c0-.28-.22-.5-.5-.5H.54C.26,0,.04,.22,.04,.5s.22,.5,.5,.5H31.5c.28,0,.5-.22,.5-.5Z\" fill=\"currentColor\"/>\n    <path id=\"i\" d=\"M23.62,14.79l.16-.56h6.29l-4.67,13.66c-.13,.4-.26,.81-.4,1.23-.13,.42-.2,.81-.2,1.19,0,.32,.09,.6,.28,.83,.18,.23,.46,.34,.83,.34,.42,0,.84-.15,1.25-.44s.78-.64,1.13-1.03c.34-.39,.63-.79,.87-1.19s.41-.73,.51-.97l.47,.2c-.11,.21-.27,.54-.49,.99-.23,.44-.53,.89-.93,1.33-.39,.44-.88,.83-1.46,1.15s-1.26,.48-2.06,.48c-.87,0-1.56-.18-2.08-.54s-.77-.97-.77-1.83c0-.46,.08-.96,.24-1.51,.16-.55,.32-1.05,.48-1.51l4.07-11.81h-3.52Zm4.67-6.57c0,.54,.18,.99,.53,1.35s.8,.54,1.32,.54,.97-.18,1.32-.54,.53-.81,.53-1.35-.18-.99-.53-1.35-.8-.54-1.32-.54-.97,.18-1.32,.54-.53,.81-.53,1.35Z\" fill=\"currentColor\"/>\n  </g>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-preferences\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"bar-1\" d=\"M8.04,3.61H.81C.39,3.61,.06,3.27,.06,2.86s.34-.75,.75-.75h7.23v1.5Zm11.15-1.5h-5.65v1.5h5.65c.41,0,.75-.34,.75-.75s-.34-.75-.75-.75Z\" fill=\"currentColor\"/>\n  <path id=\"slider-head-1\" d=\"M10.79,5.61c-.41,0-.75-.34-.75-.75V.85c0-.41,.34-.75,.75-.75s.75,.34,.75,.75V4.86c0,.41-.34,.75-.75,.75Z\" fill=\"currentColor\"/>\n  <path id=\"bar-2\" d=\"M2.81,10.75H.81c-.41,0-.75-.34-.75-.75s.34-.75,.75-.75H2.81v1.5Zm16.38-1.5H8.31v1.5h10.88c.41,0,.75-.34,.75-.75s-.34-.75-.75-.75Z\" fill=\"currentColor\"/>\n  <path id=\"slider-head-2\" d=\"M5.56,12.76c-.41,0-.75-.34-.75-.75V7.99c0-.41,.34-.75,.75-.75s.75,.34,.75,.75v4.01c0,.41-.34,.75-.75,.75Z\" fill=\"currentColor\"/>\n  <path id=\"bar-3\" d=\"M19.94,17.14c0,.41-.34,.75-.75,.75h-3.08v-1.5h3.08c.41,0,.75,.34,.75,.75Zm-9.33-.75H.81c-.41,0-.75,.34-.75,.75s.34,.75,.75,.75H10.61v-1.5Z\" fill=\"currentColor\"/>\n  <path id=\"slider-head-3\" d=\"M13.36,19.9c-.41,0-.75-.34-.75-.75v-4.01c0-.41,.34-.75,.75-.75s.75,.34,.75,.75v4.01c0,.41-.34,.75-.75,.75Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-resetView-2\" data-name=\"icon-resetView\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"corner-top-left\" d=\"M.6,5.48c-.28,0-.5-.22-.5-.5V.09H4.99c.28,0,.5,.22,.5,.5s-.22,.5-.5,.5H1.1v3.89c0,.28-.22,.5-.5,.5Z\" fill=\"currentColor\"/>\n  <path id=\"corner-bottom-left\" d=\"M4.99,19.91H.1v-4.88c0-.28,.22-.5,.5-.5s.5,.22,.5,.5v3.88h3.89c.28,0,.5,.22,.5,.5s-.22,.5-.5,.5Z\" fill=\"currentColor\"/>\n  <path id=\"corner-bottom-right\" d=\"M19.9,19.91h-4.89c-.28,0-.5-.22-.5-.5s.22-.5,.5-.5h3.89v-3.88c0-.28,.22-.5,.5-.5s.5,.22,.5,.5v4.88Z\" fill=\"currentColor\"/>\n  <path id=\"corner-top-right\" d=\"M19.4,6.11c-.28,0-.5-.22-.5-.5V1.09h-4.51c-.28,0-.5-.22-.5-.5s.22-.5,.5-.5h5.51V5.61c0,.28-.22,.5-.5,.5Z\" fill=\"currentColor\"/>\n  <path id=\"frame\" d=\"M16.46,16.46H3.54V3.54h12.92v12.92Zm-10.92-2H14.46V5.54H5.54V14.46Z\" fill=\"currentColor\"/>\n</svg>","import React from \"react\";\nimport Icon from \"@ant-design/icons\";\nimport { IconComponentProps } from \"@ant-design/icons/lib/components/Icon\";\n\nimport ICONS from \"../../assets/icons\";\n\nconst STYLE = { fontSize: \"19px\" };\ntype ViewerIconProps = { type: keyof typeof ICONS } & Omit<IconComponentProps, \"type\" | \"component\" | \"ref\">;\n\n/** Wrapper component for easy inclusion of our own custom icons. */\nconst ViewerIcon: React.FC<ViewerIconProps> = (props) => {\n  const newProps = { ...props };\n  newProps.style = { ...STYLE, ...props.style };\n  return <Icon component={ICONS[props.type]} {...newProps} />;\n};\n\nexport default ViewerIcon;\n","import { Button, Drawer } from \"antd\";\nimport React, { useCallback, useState } from \"react\";\n\nimport ViewerIcon from \"../shared/ViewerIcon\";\n\nimport \"./styles.css\";\n\ntype BottomPanelProps = {\n  title?: string;\n  open?: boolean;\n  onOpenChange?: (visible: boolean) => void;\n  children?: React.ReactNode;\n  height?: number;\n};\n\nconst BottomPanel: React.FC<BottomPanelProps> = ({ children, open: openProp, title, height, onOpenChange }) => {\n  const [openState, setOpenState] = useState(true);\n  const open = openProp ?? openState;\n\n  const toggleDrawer = useCallback((): void => {\n    if (openProp === undefined) {\n      setOpenState(!open);\n    }\n\n    onOpenChange?.(!open);\n  }, [open, openProp, onOpenChange]);\n\n  const optionsButton = (\n    <Button className=\"options-button\" size=\"small\" onClick={toggleDrawer}>\n      {title || \"Options\"}\n      <ViewerIcon type=\"closePanel\" className=\"button-arrow\" style={{ fontSize: \"15px\" }} />\n    </Button>\n  );\n\n  return (\n    <div className=\"bottom-panel\">\n      <Drawer\n        className=\"drawer\"\n        placement=\"bottom\"\n        closable={false}\n        getContainer={false}\n        open={open}\n        mask={false}\n        title={optionsButton}\n        height={height ?? 190}\n      >\n        <div className=\"drawer-body-wrapper\">{children}</div>\n      </Drawer>\n    </div>\n  );\n};\n\nexport default BottomPanel;\n","import { View3d, Volume } from \"@aics/vole-core\";\nimport { LoadingOutlined } from \"@ant-design/icons\";\nimport React from \"react\";\n\nimport { CLIPPING_PANEL_HEIGHT_DEFAULT, CLIPPING_PANEL_HEIGHT_TALL } from \"../../shared/constants\";\nimport { ViewMode } from \"../../shared/enums\";\nimport { AxisName, PerAxis, Styles } from \"../../shared/types\";\nimport PlayControls from \"../../shared/utils/playControls\";\nimport { ViewerSettingUpdater } from \"../ViewerStateProvider/types\";\n\nimport AxisClipSliders from \"../AxisClipSliders\";\nimport BottomPanel from \"../BottomPanel\";\nimport { connectToViewerState } from \"../ViewerStateProvider\";\n\nimport \"./styles.css\";\n\ntype ViewerWrapperProps = {\n  // From parent\n  view3d: View3d;\n  loadingImage: boolean;\n  appHeight: string;\n  image: Volume | null;\n  numSlices: PerAxis<number>;\n  numSlicesLoaded: PerAxis<number>;\n  playControls: PlayControls;\n  playingAxis: AxisName | \"t\" | null;\n  numTimesteps: number;\n  numScenes: number;\n  visibleControls: {\n    axisClipSliders: boolean;\n  };\n  clippingPanelOpen?: boolean;\n  onClippingPanelOpenChange?: (visible: boolean) => void;\n\n  // From viewer state\n  autorotate: boolean;\n  viewMode: ViewMode;\n  region: PerAxis<[number, number]>;\n  slice: PerAxis<number>;\n  time: number;\n  scene: number;\n  changeViewerSetting: ViewerSettingUpdater;\n};\n\nconst ViewerWrapper: React.FC<ViewerWrapperProps> = (props) => {\n  const view3dviewerRef = React.createRef<HTMLDivElement>();\n\n  React.useEffect(() => {\n    view3dviewerRef.current!.appendChild(props.view3d.getDOMElement());\n  }, [props.view3d, view3dviewerRef]);\n\n  const renderOverlay = (): React.ReactNode => {\n    // Don't show spinner during playback - we may be constantly loading new data, it'll block the view!\n    const showSpinner = props.loadingImage && !props.playingAxis;\n    const spinner = showSpinner ? (\n      <div style={STYLES.noImage}>\n        <LoadingOutlined style={{ fontSize: 60, zIndex: 1000 }} />\n      </div>\n    ) : null;\n\n    const noImageText =\n      !props.loadingImage && !props.image ? <div style={STYLES.noImage}>No image selected</div> : null;\n    if (!!noImageText && props.view3d) {\n      props.view3d.removeAllVolumes();\n    }\n    return noImageText || spinner;\n  };\n\n  const { appHeight, changeViewerSetting, visibleControls, numTimesteps, numScenes, viewMode, region, slice, time } =\n    props;\n  const clippingPanelTall = numTimesteps > 1 && numScenes > 1 && viewMode === ViewMode.threeD;\n\n  return (\n    <div className=\"cell-canvas\" style={{ ...STYLES.viewer, height: appHeight }}>\n      <div ref={view3dviewerRef} style={STYLES.view3d}></div>\n      <BottomPanel\n        title=\"Clipping\"\n        open={props.clippingPanelOpen}\n        onOpenChange={props.onClippingPanelOpenChange}\n        height={clippingPanelTall ? CLIPPING_PANEL_HEIGHT_TALL : CLIPPING_PANEL_HEIGHT_DEFAULT}\n      >\n        {visibleControls.axisClipSliders && !!props.image && (\n          <AxisClipSliders\n            mode={viewMode}\n            image={props.image}\n            changeViewerSetting={changeViewerSetting}\n            numSlices={props.numSlices}\n            numSlicesLoaded={props.numSlicesLoaded}\n            numScenes={numScenes}\n            region={region}\n            slices={slice}\n            numTimesteps={numTimesteps}\n            time={time}\n            scene={props.scene}\n            playControls={props.playControls}\n            playingAxis={props.playingAxis}\n          />\n        )}\n      </BottomPanel>\n      {renderOverlay()}\n    </div>\n  );\n};\n\nexport default connectToViewerState(ViewerWrapper, [\n  \"autorotate\",\n  \"viewMode\",\n  \"region\",\n  \"slice\",\n  \"time\",\n  \"scene\",\n  \"changeViewerSetting\",\n]);\n\nconst STYLES: Styles = {\n  viewer: {\n    display: \"flex\",\n    position: \"relative\",\n  },\n  view3d: {\n    width: \"100%\",\n    display: \"flex\",\n    overflow: \"hidden\",\n  },\n  noImage: {\n    position: \"absolute\",\n    zIndex: 999,\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#eeeee\",\n    color: \"#9b9b9b\",\n    fontSize: \"2em\",\n    opacity: 0.75,\n  },\n};\n","import React from \"react\";\nimport { ColorResult, SketchPicker } from \"react-color\";\nimport { map } from \"lodash\";\n\nimport { ColorObject } from \"../shared/utils/colorRepresentations\";\nimport { Styles } from \"../shared/types\";\n\n// if there are fewer than this many screen pixels below the swatch but more above, open above the swatch\nconst OPEN_ABOVE_MARGIN = 310;\n\ntype ColorChangeHandler = (currentColor: ColorObject, prevColor?: ColorObject, idx?: number) => void;\n\ninterface ColorPickerProps {\n  color: ColorObject;\n  width: number;\n  onColorChange?: ColorChangeHandler;\n  onColorChangeComplete?: ColorChangeHandler;\n  idx?: any;\n  disableAlpha?: boolean;\n}\n\nconst DEFAULT_COLOR = {\n  r: \"241\",\n  g: \"112\",\n  b: \"19\",\n  a: \"1\",\n};\n\nconst ColorPicker: React.FC<ColorPickerProps> = (props) => {\n  const [isOpen, setIsOpen] = React.useState(false);\n  const [openAboveSwatch, setOpenAboveSwatch] = React.useState(false);\n  const [currentColor, setCurrentColor] = React.useState(props.color || DEFAULT_COLOR);\n\n  const swatchRef = React.useRef<HTMLDivElement>(null);\n\n  const handleClick = (): void => {\n    const swatchRect = swatchRef.current!.getBoundingClientRect();\n    const noRoomBelowSwatch = swatchRect.bottom > window.innerHeight - OPEN_ABOVE_MARGIN;\n    setIsOpen(!isOpen);\n    setOpenAboveSwatch(noRoomBelowSwatch && swatchRect.top > OPEN_ABOVE_MARGIN);\n  };\n\n  const handleClose = (): void => setIsOpen(false);\n\n  const handleChange = (color: ColorResult): void => {\n    setCurrentColor(color.rgb);\n    // supply onColorChange callback in props.\n    props.onColorChange?.(color.rgb, currentColor, props.idx);\n  };\n\n  const handleChangeComplete = (color: ColorResult): void => {\n    setCurrentColor(color.rgb);\n    // supply onColorChange callback in props.\n    props.onColorChangeComplete?.(color.rgb, currentColor, props.idx);\n  };\n\n  React.useEffect(() => setCurrentColor(props.color), [props.color]);\n\n  const width = props.width || 36;\n  const popoverDirectionStyle = openAboveSwatch ? { bottom: \"21px\" } : { top: \"0px\" };\n  return (\n    <div>\n      <div style={STYLES.swatch} ref={swatchRef} onClick={handleClick}>\n        <div style={{ ...STYLES.color, width: `${width}px`, background: `rgba(${map(currentColor, (ele) => ele)})` }} />\n      </div>\n      <div style={{ position: \"absolute\" }}>\n        {isOpen ? (\n          <div style={{ ...STYLES.popover, ...popoverDirectionStyle }}>\n            <div style={STYLES.cover} onClick={handleClose} />\n            <SketchPicker\n              color={currentColor}\n              onChange={handleChange}\n              onChangeComplete={handleChangeComplete}\n              disableAlpha={props.disableAlpha}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nexport default ColorPicker;\n\nconst STYLES: Styles = {\n  color: {\n    height: \"14px\",\n    margin: \"3px\",\n    borderRadius: \"2px\",\n  },\n  swatch: {\n    borderRadius: \"3px\",\n    border: \"1px solid var(--color-controlpanel-border)\",\n    display: \"inline-block\",\n    cursor: \"pointer\",\n    verticalAlign: \"middle\",\n  },\n  popover: {\n    position: \"absolute\",\n    zIndex: \"9999\",\n  },\n  cover: {\n    position: \"fixed\",\n    top: \"0px\",\n    right: \"0px\",\n    bottom: \"0px\",\n    left: \"0px\",\n  },\n};\n","import { NouisliderProps } from \"nouislider-react\";\nimport React from \"react\";\n\nimport SmarterSlider from \"../SmarterSlider\";\n\nimport \"./styles.css\";\n\ntype SliderRowProps = {\n  label: React.ReactNode;\n  start?: number | number[];\n  step?: number;\n  formatInteger?: boolean;\n  min?: number;\n  max?: number;\n  onUpdate?: NouisliderProps[\"onUpdate\"];\n  onChange?: NouisliderProps[\"onChange\"];\n  hideSlider?: boolean;\n\n  children?: React.ReactNode;\n};\n\nconst INTEGER_FORMATTER = { to: Math.round, from: Number };\n\n/** A component to ensure a single unified style across the many labeled slider rows in the control panel */\nconst SliderRow: React.FC<SliderRowProps> = (props) => (\n  <div className=\"viewer-control-row\">\n    <div className=\"control-name\">{props.label}</div>\n    <div className=\"control\">\n      {props.start !== undefined && !props.hideSlider && (\n        <div className=\"control-slider\">\n          <SmarterSlider\n            range={{ min: props.min ?? 0, max: props.max }}\n            start={props.start}\n            connect={true}\n            tooltips={true}\n            behaviour=\"drag\"\n            format={props.formatInteger ? INTEGER_FORMATTER : undefined}\n            onUpdate={props.onUpdate}\n            onChange={props.onChange}\n          />\n        </div>\n      )}\n      {props.children && <div className=\"control-extra\">{props.children}</div>}\n    </div>\n  </div>\n);\n\nexport default SliderRow;\n","import { Channel, ControlPoint, Histogram, Lut } from \"@aics/vole-core\";\nimport { LockOutlined, UnlockOutlined } from \"@ant-design/icons\";\nimport { Button, Checkbox, InputNumber, Tooltip } from \"antd\";\nimport * as d3 from \"d3\";\nimport \"nouislider/distribute/nouislider.css\";\nimport React, { useCallback, useMemo, useRef, useState } from \"react\";\nimport { ColorResult, SketchPicker } from \"react-color\";\n\nimport { DTYPE_RANGE, LUT_MAX_PERCENTILE, LUT_MIN_PERCENTILE, TFEDITOR_DEFAULT_COLOR } from \"../../shared/constants\";\nimport {\n  ColorArray,\n  colorArrayToObject,\n  colorArrayToString,\n  colorObjectToArray,\n} from \"../../shared/utils/colorRepresentations\";\nimport { controlPointsToRamp, rampToControlPoints } from \"../../shared/utils/controlPointsToLut\";\nimport { useRefWithSetter } from \"../../shared/utils/hooks\";\nimport type { SingleChannelSettingUpdater } from \"../ViewerStateProvider/types\";\n\nimport SliderRow from \"../shared/SliderRow\";\n\nimport \"./styles.css\";\n\n/**The color picker opens next to control points like a context menu. This constant gives it a bit of space. */\nconst TFEDITOR_COLOR_PICKER_MARGIN_X_PX = 2;\n/** If a control point is within this distance of the bottom of the screen, open the color picker upward */\nconst TFEDITOR_COLOR_PICKER_OPEN_UPWARD_MARGIN_PX = 310;\n\nconst TFEDITOR_GRADIENT_MAX_OPACITY = 0.75;\nconst TFEDITOR_NUM_TICKS = 4;\n/**\n * If the first or last \"round\" tick mark is within this ratio of the end of the x axis, remove it to get it out of the\n * way of the tick mark right at the end.\n *\n * For instance, if the x range is [0, 255], the last tick mark d3 generates will likely be at 250. That should be\n * removed to get it out of the way of the tick mark at 255! But if the range is [0, 390], it may be that the last tick\n * mark is at 300. It would make no sense to remove that tick mark to make space for one at 390.\n */\nconst TFEDITOR_END_TICK_MARGIN = 0.1;\n\nconst TFEDITOR_MARGINS = {\n  top: 18,\n  right: 20,\n  bottom: 30, // includes space for x-axis\n  left: 25,\n};\n\nconst MOUSE_EVENT_BUTTONS_PRIMARY = 1;\n\nconst enum TfEditorRampSliderHandle {\n  Min = \"min\",\n  Max = \"max\",\n}\n\ntype TfEditorProps = {\n  id: string;\n  width: number;\n  height: number;\n  channelData: Channel;\n  changeChannelSetting: SingleChannelSettingUpdater;\n  colorizeEnabled: boolean;\n  colorizeAlpha: number;\n  useControlPoints: boolean;\n  controlPoints: ControlPoint[];\n  ramp: [number, number];\n  plotMin: number;\n  plotMax: number;\n};\n\nconst TF_GENERATORS: Record<string, (histogram: Histogram) => Lut> = {\n  autoXF: (histo) => {\n    // Currently unused. min and max are the first and last bins whose values are >=10% that of the max bin\n    const [hmin, hmax] = histo.findAutoMinMax();\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  auto2XF: (histo) => {\n    const [hmin, hmax] = histo.findAutoIJBins();\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  auto98XF: (histo) => {\n    const hmin = histo.findBinOfPercentile(LUT_MIN_PERCENTILE);\n    const hmax = histo.findBinOfPercentile(LUT_MAX_PERCENTILE);\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  bestFitXF: (histo) => {\n    const [hmin, hmax] = histo.findBestFitBins();\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  resetXF: (_histo) => new Lut().createFullRange(),\n};\n\n// *---*\n// |   |\n// |   |\n//  \\ /\n//   *\n// width: 0.65 * height; height of rectangle: 0.6 * height; height of triangle: 0.4 * height\nconst sliderHandleSymbol: d3.SymbolType = {\n  draw: (context, size) => {\n    // size is symbol area in px^2\n    const height = Math.sqrt(size * 1.9);\n    const triangleHeight = height * 0.4;\n    const halfWidth = height * 0.325;\n\n    context.moveTo(-halfWidth, -height);\n    context.lineTo(halfWidth, -height);\n    context.lineTo(halfWidth, -triangleHeight);\n    context.lineTo(0, 0);\n    context.lineTo(-halfWidth, -triangleHeight);\n    context.closePath();\n  },\n};\n\nfunction binToAbsolute(value: number, histogram: Histogram): number {\n  return histogram.getValueFromBinIndex(value);\n}\n\nfunction absoluteToBin(value: number, histogram: Histogram): number {\n  return histogram.findFractionalBinOfValue(value);\n}\n\nfunction controlPointToAbsolute(cp: ControlPoint, histogram: Histogram): number {\n  // the x value of the control point is in the range [0, 255]\n  // because of the way the histogram is generated\n  // (see LUT_ENTRIES and the fact that we use Uint8Array)\n  return binToAbsolute(cp.x, histogram);\n}\n\n/** For when all control points are outside the plot's range: just fill the plot with the settings from 1 point */\nconst coverRangeWithPoint = (point: ControlPoint, plotMin: number, plotMax: number): ControlPoint[] => {\n  return [\n    { ...point, x: plotMin },\n    { ...point, x: plotMax },\n  ];\n};\n\n/** For when some control points are outside the plot's range: create an intermediate point on the edge of the range */\nconst createPointOnRangeBoundary = (outOfRangePt: ControlPoint, inRangePt: ControlPoint, x: number): ControlPoint => {\n  const rangeRatio = (x - outOfRangePt.x) / (inRangePt.x - outOfRangePt.x);\n  const opacity = outOfRangePt.opacity + (inRangePt.opacity - outOfRangePt.opacity) * rangeRatio;\n  const color = outOfRangePt.color.map((c, i) => c + (inRangePt.color[i] - c) * rangeRatio) as ColorArray;\n  return { x, opacity, color };\n};\n\n/**\n * Ensures the list of `controlPoints` exactly covers the range from `plotMin` to `plotMax` by removing any\n * out-of-range points and adding new points right at the edges of the range.\n */\nconst fitControlPointsToRange = (controlPoints: ControlPoint[], plotMin: number, plotMax: number): ControlPoint[] => {\n  const points = controlPoints.slice();\n\n  const firstPoint = points[0];\n  const lastPoint = points[points.length - 1];\n\n  // If all control points are outside the range, just fill the range with the first or last point.\n  if (lastPoint.x < plotMin) {\n    return coverRangeWithPoint(lastPoint, plotMin, plotMax);\n  }\n  if (firstPoint.x > plotMax) {\n    return coverRangeWithPoint(firstPoint, plotMin, plotMax);\n  }\n\n  if (firstPoint.x > plotMin) {\n    // If the control points don't go all the way to the min, add a new point at the min.\n    points.unshift({ ...firstPoint, x: plotMin });\n  } else {\n    // If some control points are out of range, remove those points...\n    let outOfRangePoint: ControlPoint | undefined = undefined;\n    while (points[0].x < plotMin && points.length > 1) {\n      outOfRangePoint = points.shift();\n    }\n\n    // ...and create a new point at the edge of the range.\n    if (outOfRangePoint !== undefined) {\n      points.unshift(createPointOnRangeBoundary(outOfRangePoint, points[0], plotMin));\n    }\n  }\n\n  if (lastPoint.x < plotMax) {\n    // If the control points don't go all the way to the max, add a new point at the max.\n    points.push({ ...lastPoint, x: plotMax });\n  } else {\n    // If some control points are out of range, remove those points...\n    let outOfRangePoint: ControlPoint | undefined = undefined;\n    while (points[points.length - 1].x > plotMax && points.length > 1) {\n      outOfRangePoint = points.pop();\n    }\n\n    // ...and create a new point at the edge of the range.\n    if (outOfRangePoint !== undefined) {\n      points.push(createPointOnRangeBoundary(outOfRangePoint, points[points.length - 1], plotMax));\n    }\n  }\n\n  return points;\n};\n\n/** Defines an SVG gradient with id `id` based on the provided `controlPoints` */\nconst ControlPointGradientDef: React.FC<{ controlPoints: ControlPoint[]; id: string }> = ({ controlPoints, id }) => {\n  const range = controlPoints[controlPoints.length - 1].x - controlPoints[0].x;\n  return (\n    <defs>\n      <linearGradient id={id} gradientUnits=\"objectBoundingBox\" spreadMethod=\"pad\" x2=\"100%\">\n        {controlPoints.map((cp, i) => {\n          const offset = `${((cp.x - controlPoints[0].x) / range) * 100}%`;\n          const opacity = Math.min(cp.opacity, TFEDITOR_GRADIENT_MAX_OPACITY);\n          return <stop key={i} stopColor={colorArrayToString(cp.color)} stopOpacity={opacity} offset={offset} />;\n        })}\n      </linearGradient>\n    </defs>\n  );\n};\n\n/** Retrieves the bin contents and max bin value from `histogram` */\nfunction getHistogramBinLengths(histogram: Histogram): { binLengths: number[]; max: number } {\n  const binLengths = [];\n  // TODO: Change `histogram.bins` to be readable/readonly\n  // so we don't have to copy it here!\n  let max = Number.NEGATIVE_INFINITY;\n  for (let i = 0; i < histogram.getNumBins(); i++) {\n    const binLength = histogram.getBin(i);\n    binLengths.push(binLength);\n    max = Math.max(max, binLength);\n  }\n  return { binLengths, max };\n}\n\nconst colorPickerPositionToStyle = ([x, y]: [number, number]): React.CSSProperties => ({\n  position: \"absolute\",\n  [x < 0 ? \"right\" : \"left\"]: Math.abs(x),\n  [y < 0 ? \"bottom\" : \"top\"]: y,\n});\n\nconst numberFormatter = (v: number | string | undefined): string =>\n  v === undefined ? \"\" : Math.round(Number(v)).toString();\n\nconst clamp = (value: number, min: number, max: number): number => Math.min(Math.max(value, min), max);\n\nconst TfEditor: React.FC<TfEditorProps> = (props) => {\n  const { changeChannelSetting, plotMin, plotMax } = props;\n\n  const innerWidth = props.width - TFEDITOR_MARGINS.left - TFEDITOR_MARGINS.right;\n  const innerHeight = props.height - TFEDITOR_MARGINS.top - TFEDITOR_MARGINS.bottom;\n\n  const [selectedPointIdx, setSelectedPointIdx] = useState<number | null>(null);\n  const [draggedPointIdx, _setDraggedPointIdx] = useState<number | TfEditorRampSliderHandle | null>(null);\n\n  const _setCPs = useCallback(\n    (p: ControlPoint[]) => changeChannelSetting({ controlPoints: p }),\n    [changeChannelSetting]\n  );\n  const setRamp = useCallback((ramp: [number, number]) => changeChannelSetting({ ramp: ramp }), [changeChannelSetting]);\n\n  // these bits of state need their freshest, most up-to-date values available in mouse event handlers. make refs!\n  const [controlPointsRef, setControlPoints] = useRefWithSetter(_setCPs, props.controlPoints);\n  const [draggedPointIdxRef, setDraggedPointIdx] = useRefWithSetter(_setDraggedPointIdx, draggedPointIdx);\n\n  // Either `null` when the control panel is closed, or an x offset into the plot to position the color picker.\n  // Positive: offset right from the left edge of the plot; negative: offset left from the right edge of the plot.\n  const [colorPickerPosition, setColorPickerPosition] = useState<[number, number] | null>(null);\n  const lastColorRef = useRef<ColorArray>(TFEDITOR_DEFAULT_COLOR);\n\n  const svgRef = useRef<SVGSVGElement>(null); // need access to SVG element to measure mouse position\n\n  const { histogram } = props.channelData;\n  const typeRange = DTYPE_RANGE[props.channelData.dtype];\n\n  // d3 scales define the mapping between data and screen space (and do the heavy lifting of generating plot axes)\n  /** `xScale` is in raw intensity range, not U8 range. We use `u8ToAbsolute` and `absoluteToU8` to translate to U8. */\n  const xScale = useMemo(\n    () => d3.scaleLinear().domain([plotMin, plotMax]).range([0, innerWidth]),\n    [innerWidth, plotMin, plotMax]\n  );\n  const plotMinU8 = useMemo(() => absoluteToBin(plotMin, histogram), [plotMin, histogram]);\n  const plotMaxU8 = useMemo(() => absoluteToBin(plotMax, histogram), [plotMax, histogram]);\n  const yScale = useMemo(() => d3.scaleLinear().domain([0, 1]).range([innerHeight, 0]), [innerHeight]);\n\n  const mouseEventToControlPointValues = (event: MouseEvent | React.MouseEvent): [number, number] => {\n    const svgRect = svgRef.current?.getBoundingClientRect() ?? { x: 0, y: 0 };\n    return [\n      absoluteToBin(xScale.invert(clamp(event.clientX - svgRect.x - TFEDITOR_MARGINS.left, 0, innerWidth)), histogram),\n      yScale.invert(clamp(event.clientY - svgRect.y - TFEDITOR_MARGINS.top, 0, innerHeight)),\n    ];\n  };\n\n  const dragControlPoint = (draggedIdx: number, x: number, opacity: number): void => {\n    const newControlPoints = [...controlPointsRef.current];\n    const draggedPoint = newControlPoints[draggedIdx];\n    draggedPoint.x = x;\n    draggedPoint.opacity = opacity;\n\n    // Remove control points to keep the list sorted by x value\n    const bisector = d3.bisector<ControlPoint, ControlPoint>((a, b) => a.x - b.x);\n    const idxLeft = bisector.left(newControlPoints, draggedPoint);\n    const idxRight = bisector.right(newControlPoints, draggedPoint);\n\n    if (idxLeft < draggedIdx) {\n      const numPointsToRemove = draggedIdx - idxLeft; // should almost always be 1\n      newControlPoints.splice(idxLeft, numPointsToRemove);\n\n      const newIdx = draggedIdx - numPointsToRemove;\n      setDraggedPointIdx(newIdx);\n      setSelectedPointIdx(newIdx);\n    } else if (idxRight > draggedIdx + 1) {\n      newControlPoints.splice(draggedIdx + 1, idxRight - draggedIdx - 1);\n    }\n\n    setControlPoints(newControlPoints);\n  };\n\n  const dragRampSlider = (handle: TfEditorRampSliderHandle, x: number): void => {\n    if (handle === TfEditorRampSliderHandle.Min) {\n      const max = props.ramp[1];\n      setRamp([Math.min(x, max), max]);\n    } else {\n      const min = props.ramp[0];\n      setRamp([min, Math.max(x, min)]);\n    }\n  };\n\n  const handlePlotPointerDown: React.PointerEventHandler<SVGSVGElement> = (event) => {\n    if (props.useControlPoints) {\n      // Advanced mode - we're either creating a new control point or selecting/dragging an existing one\n      if (draggedPointIdxRef.current === null && event.button === 0) {\n        // this click is not on an existing point - create a new one\n        const [x, opacity] = mouseEventToControlPointValues(event);\n        const point = { x, opacity, color: lastColorRef.current };\n\n        // add new control point to controlPoints\n        const index = d3.bisector<ControlPoint, ControlPoint>((a, b) => a.x - b.x).left(props.controlPoints, point);\n        setDraggedPointIdx(index);\n\n        const newControlPoints = [...props.controlPoints];\n        newControlPoints.splice(index, 0, point);\n        setControlPoints(newControlPoints);\n      } else {\n        // this click is on an existing point - update current points to ref (may have been remapped since last edit)\n        controlPointsRef.current = props.controlPoints;\n      }\n\n      if (typeof draggedPointIdxRef.current !== \"string\") {\n        setSelectedPointIdx(draggedPointIdxRef.current);\n      }\n    }\n\n    if (event.button === 0 && draggedPointIdxRef.current !== null) {\n      // get set up to drag the point around, even if the mouse leaves the SVG element\n      event.currentTarget.setPointerCapture(event.nativeEvent.pointerId);\n    } else {\n      setDraggedPointIdx(null);\n    }\n  };\n\n  const handlePlotPointerMove: React.PointerEventHandler<SVGSVGElement> = (event) => {\n    if (draggedPointIdxRef.current === null) {\n      return;\n    }\n\n    if ((event.buttons & MOUSE_EVENT_BUTTONS_PRIMARY) === 0) {\n      handleDragEnd(event);\n      return;\n    }\n\n    event.stopPropagation();\n    event.preventDefault();\n    const [x, opacity] = mouseEventToControlPointValues(event);\n\n    // `draggedPointIdxRef` may either be a number (control point index) or a string (ramp slider handle).\n    // The result of this check should always be the same as `props.useControlPoints`, but this narrows the type for TS\n    if (typeof draggedPointIdxRef.current === \"number\") {\n      dragControlPoint(draggedPointIdxRef.current, x, opacity);\n    } else {\n      dragRampSlider(draggedPointIdxRef.current, x);\n    }\n  };\n\n  const handleDragEnd: React.PointerEventHandler<SVGSVGElement> = (event) => {\n    setDraggedPointIdx(null);\n    event.currentTarget.releasePointerCapture(event.pointerId);\n  };\n\n  const handleControlPointContextMenu: React.MouseEventHandler<SVGCircleElement> = (event) => {\n    event.preventDefault();\n    if (!event.target || !svgRef.current) {\n      setColorPickerPosition(null);\n      return;\n    }\n\n    const svgRect = svgRef.current.getBoundingClientRect();\n    const cpRect = (event.target as SVGCircleElement).getBoundingClientRect();\n    const cpRectCenter = cpRect.left + cpRect.width / 2;\n\n    // If the control point is closer to the left edge of the SVG, open the color picker to the right\n    const openLeft = cpRectCenter - svgRect.left < svgRect.width / 2;\n    const xPosition = openLeft\n      ? cpRect.right - svgRect.left + TFEDITOR_COLOR_PICKER_MARGIN_X_PX\n      : cpRect.left - svgRect.right - TFEDITOR_COLOR_PICKER_MARGIN_X_PX;\n\n    // If the control point is too close to the bottom of the screen, open the color picker upward\n    const openUp = window.innerHeight - cpRect.bottom < TFEDITOR_COLOR_PICKER_OPEN_UPWARD_MARGIN_PX;\n    const yPosition = openUp ? svgRect.top - cpRect.bottom : cpRect.top - svgRect.top;\n    setColorPickerPosition([xPosition, yPosition]);\n  };\n\n  const handleChangeColor = (color: ColorResult): void => {\n    lastColorRef.current = colorObjectToArray(color.rgb);\n    if (selectedPointIdx !== null) {\n      const newControlPoints = [...props.controlPoints];\n      newControlPoints[selectedPointIdx].color = lastColorRef.current;\n      setControlPoints(newControlPoints);\n    }\n  };\n\n  const controlPointsToRender = useMemo(() => {\n    const points = props.useControlPoints ? props.controlPoints.slice() : rampToControlPoints(props.ramp);\n    return fitControlPointsToRange(points, plotMinU8, plotMaxU8);\n  }, [props.controlPoints, props.ramp, props.useControlPoints, plotMinU8, plotMaxU8]);\n\n  /** d3-generated svg data string representing both the line between points and the region filled with gradient */\n  const areaPath = useMemo(() => {\n    const areaGenerator = d3\n      .area<ControlPoint>()\n      .x((d) => xScale(controlPointToAbsolute(d, histogram)))\n      .y0((d) => yScale(d.opacity))\n      .y1(innerHeight)\n      .curve(d3.curveLinear);\n    return areaGenerator(controlPointsToRender) ?? undefined;\n  }, [controlPointsToRender, xScale, yScale, innerHeight, histogram]);\n\n  /** d3-generated svg data string representing the \"basic mode\" min/max slider handles */\n  const sliderHandlePath = useMemo(() => d3.symbol().type(sliderHandleSymbol).size(80)() ?? undefined, []);\n\n  // The below `useCallback`s are used as \"ref callbacks\" - passed as the `ref` prop of SVG elements in order to render\n  // these elements' content using D3. They are called when the ref'd component mounts and unmounts, and whenever their\n  // identity changes (i.e. whenever their dependencies change).\n\n  const xAxisRef = useCallback(\n    (el: SVGGElement) => {\n      // generate tick marks\n      const ticks = xScale.ticks(TFEDITOR_NUM_TICKS);\n\n      // make sure we have sensible tick marks right at the min and max of the x axis\n      const [min, max] = xScale.domain();\n      const domain = max - min;\n\n      if ((ticks[0] - min) / domain < TFEDITOR_END_TICK_MARGIN) {\n        ticks[0] = min;\n      } else {\n        ticks.unshift(min);\n      }\n\n      if ((ticks[ticks.length - 1] - min) / domain > 1 - TFEDITOR_END_TICK_MARGIN) {\n        ticks[ticks.length - 1] = max;\n      } else {\n        ticks.push(max);\n      }\n\n      // now make the axis!\n      d3.select(el).call(\n        d3\n          .axisBottom(xScale)\n          .tickValues(ticks)\n          .tickPadding(props.useControlPoints ? 3 : 10) // get tick labels out of the way of sliders in \"basic\" mode\n      );\n    },\n    [xScale, props.useControlPoints]\n  );\n\n  const yAxisRef = useCallback(\n    (el: SVGGElement) => d3.select(el).call(d3.axisLeft(yScale).ticks(TFEDITOR_NUM_TICKS)),\n    [yScale]\n  );\n\n  const histogramRef = useCallback(\n    (el: SVGGElement) => {\n      if (el === null) {\n        return;\n      }\n      const numBins = histogram.getNumBins();\n      if (numBins < 1) {\n        return;\n      }\n      const { binLengths, max } = getHistogramBinLengths(histogram);\n      const start = Math.max(0, Math.ceil(plotMinU8));\n      const end = Math.min(numBins, Math.floor(plotMaxU8));\n      const binLengthsToRender = binLengths.slice(start, end);\n\n      const barWidth = innerWidth / (plotMaxU8 - plotMinU8);\n      const binScale = d3.scaleLog().domain([0.1, max]).range([innerHeight, 0]).base(2).clamp(true);\n\n      d3.select(el)\n        .selectAll(\".bar\") // select all the bars of the histogram\n        .data(binLengthsToRender) // bind the histogram bins to this selection\n        .join(\"rect\") // ensure we have exactly as many bound `rect` elements in the DOM as we have histogram bins\n        .attr(\"class\", \"bar\")\n        .attr(\"width\", barWidth)\n        .attr(\"x\", (_len, idx) => xScale(binToAbsolute(idx + start, histogram))) // set position and height from data\n        .attr(\"y\", (len) => binScale(len))\n        .attr(\"height\", (len) => innerHeight - binScale(len));\n    },\n    [xScale, histogram, innerWidth, innerHeight, plotMinU8, plotMaxU8]\n  );\n\n  const applyTFGenerator = useCallback(\n    (generator: string): void => {\n      setSelectedPointIdx(null);\n      lastColorRef.current = TFEDITOR_DEFAULT_COLOR;\n      const lut = TF_GENERATORS[generator](histogram);\n      if (props.useControlPoints) {\n        setControlPoints(lut.controlPoints.map((cp) => ({ ...cp, color: TFEDITOR_DEFAULT_COLOR })));\n      } else {\n        setRamp(controlPointsToRamp(lut.controlPoints));\n      }\n    },\n    [histogram, props.useControlPoints, setControlPoints, setRamp]\n  );\n\n  const createTFGeneratorButton = (generator: string, name: string, description: string): React.ReactNode => (\n    <Tooltip title={description} placement=\"top\">\n      <Button size=\"small\" onClick={() => applyTFGenerator(generator)}>\n        {name}\n      </Button>\n    </Tooltip>\n  );\n\n  // create one svg circle element for each control point\n  const controlPointCircles = props.useControlPoints\n    ? props.controlPoints\n        .filter((cp) => plotMinU8 <= cp.x && cp.x <= plotMaxU8) // filter out-of-range points\n        .map((cp, i) => (\n          <circle\n            key={i}\n            className={i === selectedPointIdx ? \"selected\" : \"\"}\n            cx={xScale(controlPointToAbsolute(cp, histogram))}\n            cy={yScale(cp.opacity)}\n            style={{ fill: colorArrayToString(cp.color) }}\n            r={5}\n            onPointerDown={() => setDraggedPointIdx(i)}\n            onContextMenu={handleControlPointContextMenu}\n          />\n        ))\n    : null;\n  // move selected control point to the end so it's drawn last and not occluded by other nearby points\n  if (controlPointCircles !== null && selectedPointIdx !== null) {\n    controlPointCircles.push(controlPointCircles.splice(selectedPointIdx, 1)[0]);\n  }\n\n  const viewerModeString = props.useControlPoints ? \"advanced\" : \"basic\";\n\n  // When data is loading, levelMin and levelMax may be NaN. Disable min/max\n  // limits on numeric inputs when this happens to prevent error styling from\n  // appearing, and keep the last valid levels displayed to avoid value\n  // jumping/empty inputs.\n  const lastValidLevel = useRef([0, 1]);\n  let levelMin = binToAbsolute(props.ramp[0], histogram);\n  let levelMax = binToAbsolute(props.ramp[1], histogram);\n  const isLoadingData = Number.isNaN(levelMin) || Number.isNaN(levelMax);\n  if (!isLoadingData) {\n    lastValidLevel.current = [levelMin, levelMax];\n  }\n  levelMin = lastValidLevel.current[0];\n  levelMax = lastValidLevel.current[1];\n\n  return (\n    <div>\n      {/* ----- PRESET BUTTONS ----- */}\n      <div className=\"button-row\">\n        {createTFGeneratorButton(\"auto98XF\", \"Default\", \"Ramp from 50th percentile to 98th\")}\n        {createTFGeneratorButton(\"auto2XF\", \"IJ Auto\", `Emulates ImageJ's \"auto\" button`)}\n        {createTFGeneratorButton(\"resetXF\", \"Auto 1\", \"Ramp over the full data range (0% to 100%)\")}\n        {createTFGeneratorButton(\"bestFitXF\", \"Auto 2\", \"Ramp over the middle 80% of data\")}\n        <Checkbox\n          checked={props.useControlPoints}\n          onChange={(e) => changeChannelSetting({ useControlPoints: e.target.checked })}\n          style={{ marginLeft: \"auto\" }}\n        >\n          Advanced\n        </Checkbox>\n      </div>\n\n      {/* ----- MIN/MAX SPINBOXES ----- */}\n      <div className=\"tf-editor-control-row ramp-row\">\n        {!props.useControlPoints && (\n          <div className=\"tf-editor-control-row\">\n            Levels min/max\n            <InputNumber\n              value={levelMin}\n              onChange={(v) => v !== null && setRamp([absoluteToBin(v, histogram), props.ramp[1]])}\n              formatter={numberFormatter}\n              min={isLoadingData ? undefined : typeRange.min}\n              max={isLoadingData ? undefined : Math.min(levelMax, typeRange.max)}\n              size=\"small\"\n              controls={false}\n            />\n            <InputNumber\n              value={levelMax}\n              onChange={(v) => v !== null && setRamp([props.ramp[0], absoluteToBin(v, histogram)])}\n              formatter={numberFormatter}\n              min={isLoadingData ? undefined : Math.max(typeRange.min, levelMin)}\n              max={isLoadingData ? undefined : typeRange.max}\n              size=\"small\"\n              controls={false}\n            />\n          </div>\n        )}\n      </div>\n\n      {/* ----- CONTROL POINT COLOR PICKER ----- */}\n      {colorPickerPosition !== null && (\n        <div className=\"tf-editor-popover\">\n          <div className=\"tf-editor-cover\" onClick={() => setColorPickerPosition(null)} />\n          <div style={colorPickerPositionToStyle(colorPickerPosition)}>\n            <SketchPicker\n              color={colorArrayToObject(lastColorRef.current)}\n              onChange={handleChangeColor}\n              disableAlpha={true}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* ----- PLOT SVG ----- */}\n      <svg\n        className={`tf-editor-svg ${viewerModeString}${draggedPointIdx !== null ? \" dragging\" : \"\"}`}\n        ref={svgRef}\n        width={props.width}\n        height={props.height}\n        onPointerDown={handlePlotPointerDown}\n        onPointerMove={handlePlotPointerMove}\n        onPointerUp={handleDragEnd}\n      >\n        <ControlPointGradientDef controlPoints={controlPointsToRender} id={`tfGradient-${props.id}`} />\n        <g transform={`translate(${TFEDITOR_MARGINS.left},${TFEDITOR_MARGINS.top})`}>\n          {/* histogram bars */}\n          <g ref={histogramRef} />\n          {/* line between control points, and the gradient under it */}\n          <path className=\"line\" fill={`url(#tfGradient-${props.id})`} d={areaPath} />\n          {/* plot axes */}\n          <g ref={xAxisRef} className=\"axis\" transform={`translate(0,${innerHeight})`} />\n          <g ref={yAxisRef} className=\"axis\" />\n          {/* \"advanced mode\" control points */}\n          {controlPointCircles}\n          {/* \"basic mode\" sliders */}\n          {!props.useControlPoints && (\n            <g className=\"ramp-sliders\">\n              {plotMinU8 <= props.ramp[0] && props.ramp[0] <= plotMaxU8 && (\n                <g transform={`translate(${xScale(binToAbsolute(props.ramp[0], histogram))})`}>\n                  <line y1={innerHeight} strokeDasharray=\"5,5\" strokeWidth={2} />\n                  <line\n                    className=\"ramp-slider-click-target\"\n                    y1={innerHeight}\n                    strokeWidth={6}\n                    onPointerDown={() => setDraggedPointIdx(TfEditorRampSliderHandle.Min)}\n                  />\n                  <path\n                    d={sliderHandlePath}\n                    transform={`translate(0,${innerHeight}) rotate(180)`}\n                    onPointerDown={() => setDraggedPointIdx(TfEditorRampSliderHandle.Min)}\n                  />\n                </g>\n              )}\n              {plotMinU8 <= props.ramp[1] && props.ramp[1] <= plotMaxU8 && (\n                <g transform={`translate(${xScale(binToAbsolute(props.ramp[1], histogram))})`}>\n                  <line y1={innerHeight} strokeDasharray=\"5,5\" strokeWidth={2} />\n                  <line\n                    className=\"ramp-slider-click-target\"\n                    y1={innerHeight}\n                    strokeWidth={6}\n                    onPointerDown={() => setDraggedPointIdx(TfEditorRampSliderHandle.Max)}\n                  />\n                  <path d={sliderHandlePath} onPointerDown={() => setDraggedPointIdx(TfEditorRampSliderHandle.Max)} />\n                </g>\n              )}\n            </g>\n          )}\n        </g>\n      </svg>\n\n      {/* ----- PLOT RANGE ----- */}\n      <div className=\"tf-editor-control-row plot-range-row\">\n        Plot min/max\n        <InputNumber\n          value={plotMin}\n          onChange={(v) => v !== null && changeChannelSetting({ plotMin: v, plotMax: Math.max(v + 1, plotMax) })}\n          formatter={numberFormatter}\n          min={isLoadingData ? undefined : typeRange.min}\n          max={isLoadingData ? undefined : typeRange.max - 1}\n          size=\"small\"\n          controls={false}\n        />\n        <InputNumber\n          value={plotMax}\n          onChange={(v) => v !== null && changeChannelSetting({ plotMax: v, plotMin: Math.min(v - 1, plotMin) })}\n          formatter={numberFormatter}\n          min={isLoadingData ? undefined : typeRange.min + 1}\n          max={isLoadingData ? undefined : typeRange.max}\n          size=\"small\"\n          controls={false}\n        />\n        <Button\n          size=\"small\"\n          style={{ marginLeft: \"12px\" }}\n          onClick={() => changeChannelSetting({ plotMin: props.channelData.rawMin, plotMax: props.channelData.rawMax })}\n        >\n          Fit to data\n        </Button>\n        <Button size=\"small\" onClick={() => changeChannelSetting({ plotMin: typeRange.min, plotMax: typeRange.max })}>\n          Full range\n        </Button>\n      </div>\n\n      {/* ----- COLORIZE SLIDER ----- */}\n      <SliderRow\n        label={\n          <Checkbox\n            checked={props.colorizeEnabled}\n            onChange={(e) => changeChannelSetting({ colorizeEnabled: e.target.checked })}\n          >\n            Colorize\n          </Checkbox>\n        }\n        max={1}\n        start={props.colorizeAlpha}\n        onUpdate={(values) => changeChannelSetting({ colorizeAlpha: values[0] })}\n        hideSlider={!props.colorizeEnabled}\n      />\n    </div>\n  );\n};\n\nexport default TfEditor;\n","import { Channel } from \"@aics/vole-core\";\nimport { Button, Checkbox, InputNumber, List } from \"antd\";\nimport { CheckboxChangeEvent } from \"antd/lib/checkbox\";\nimport React, { useCallback, useState } from \"react\";\n\nimport { DTYPE_RANGE, ISOSURFACE_OPACITY_SLIDER_MAX } from \"../../shared/constants\";\nimport { IsosurfaceFormat } from \"../../shared/types\";\nimport { colorArrayToObject, ColorObject, colorObjectToArray } from \"../../shared/utils/colorRepresentations\";\nimport {\n  type ChannelSettingUpdater,\n  type ChannelState,\n  type SingleChannelSettingUpdater,\n} from \"../ViewerStateProvider/types\";\n\nimport ColorPicker from \"../ColorPicker\";\nimport SliderRow from \"../shared/SliderRow\";\nimport ViewerIcon from \"../shared/ViewerIcon\";\nimport TfEditor from \"../TfEditor\";\n\nimport \"./styles.css\";\n\ninterface ChannelsWidgetRowProps {\n  index: number;\n  name: string;\n  channelState: ChannelState;\n  channelDataForChannel: Channel;\n\n  changeChannelSetting: ChannelSettingUpdater;\n\n  saveIsosurface: (channelIndex: number, type: IsosurfaceFormat) => void;\n  onColorChangeComplete?: (newRGB: ColorObject, oldRGB?: ColorObject, index?: number) => void;\n}\n\nconst ChannelsWidgetRow: React.FC<ChannelsWidgetRowProps> = (props: ChannelsWidgetRowProps) => {\n  const { index, changeChannelSetting, saveIsosurface, channelState } = props;\n  const [controlsOpen, setControlsOpen] = useState(false);\n\n  const changeSettingForThisChannel = useCallback<SingleChannelSettingUpdater>(\n    (value) => changeChannelSetting(index, value),\n    [changeChannelSetting, index]\n  );\n\n  const volumeCheckHandler = ({ target }: CheckboxChangeEvent): void => {\n    changeChannelSetting(index, { volumeEnabled: target.checked });\n  };\n\n  const isosurfaceCheckHandler = ({ target }: CheckboxChangeEvent): void => {\n    changeChannelSetting(index, { isosurfaceEnabled: target.checked });\n  };\n\n  const onColorChange = (newRGB: ColorObject, _oldRGB?: ColorObject, index?: number): void => {\n    const color = colorObjectToArray(newRGB);\n    props.changeChannelSetting(index!, { color: color });\n  };\n\n  const createColorPicker = (): React.ReactNode => (\n    <ColorPicker\n      color={colorArrayToObject(channelState.color)}\n      onColorChange={onColorChange}\n      onColorChangeComplete={props.onColorChangeComplete}\n      disableAlpha={true}\n      idx={index}\n      width={18}\n    />\n  );\n\n  const visibilityControls = (\n    <div className=\"channel-visibility-controls\">\n      <Checkbox checked={channelState.volumeEnabled} onChange={volumeCheckHandler}>\n        Vol\n      </Checkbox>\n      <Checkbox checked={channelState.isosurfaceEnabled} onChange={isosurfaceCheckHandler}>\n        Surf\n      </Checkbox>\n      <Button\n        icon={<ViewerIcon type=\"preferences\" style={{ fontSize: \"16px\" }} />}\n        onClick={() => setControlsOpen(!controlsOpen)}\n        title=\"Open channel settings\"\n        type=\"text\"\n      />\n    </div>\n  );\n\n  const createTFEditor = (): React.ReactNode => {\n    const { controlPoints, colorizeEnabled, colorizeAlpha, useControlPoints, ramp, plotMin, plotMax } = channelState;\n    return (\n      <TfEditor\n        id={\"TFEditor\" + index}\n        width={418}\n        height={145}\n        channelData={props.channelDataForChannel}\n        controlPoints={controlPoints}\n        changeChannelSetting={changeSettingForThisChannel}\n        colorizeEnabled={colorizeEnabled}\n        colorizeAlpha={colorizeAlpha}\n        useControlPoints={useControlPoints}\n        ramp={ramp}\n        plotMin={plotMin}\n        plotMax={plotMax}\n      />\n    );\n  };\n\n  const renderSurfaceControls = (): React.ReactNode => {\n    const range = DTYPE_RANGE[props.channelDataForChannel.dtype];\n    return (\n      <div>\n        <SliderRow\n          label=\"Isovalue\"\n          min={range.min}\n          max={range.max}\n          start={channelState.isovalue}\n          onChange={([isovalue]) => changeSettingForThisChannel({ isovalue })}\n          formatInteger={true}\n        >\n          <InputNumber\n            value={channelState.isovalue}\n            onChange={(isovalue) => isovalue !== null && changeSettingForThisChannel({ isovalue })}\n            formatter={(v) => (v === undefined ? \"\" : Number(v).toFixed(0))}\n            min={range.min}\n            max={range.max}\n            size=\"small\"\n            controls={false}\n            style={{ width: \"64px\", marginLeft: \"8px\" }}\n          />\n        </SliderRow>\n        <SliderRow\n          label=\"Opacity\"\n          max={ISOSURFACE_OPACITY_SLIDER_MAX}\n          start={channelState.opacity * ISOSURFACE_OPACITY_SLIDER_MAX}\n          onChange={([opacity]) => changeSettingForThisChannel({ opacity: opacity / ISOSURFACE_OPACITY_SLIDER_MAX })}\n          formatInteger={true}\n        />\n        <div className=\"button-row\">\n          <Button onClick={() => saveIsosurface(index, \"GLTF\")}>Export GLTF</Button>\n          <Button onClick={() => saveIsosurface(index, \"STL\")}>Export STL</Button>\n        </div>\n      </div>\n    );\n  };\n\n  const renderControls = (): React.ReactNode => {\n    if (!channelState.volumeEnabled && !channelState.isosurfaceEnabled) {\n      return <h4 style={{ fontStyle: \"italic\" }}>Not currently visible</h4>;\n    }\n    return (\n      <>\n        {channelState.volumeEnabled && (\n          <>\n            <h4>Volume settings:</h4>\n            {createTFEditor()}\n          </>\n        )}\n        {channelState.isosurfaceEnabled && (\n          <>\n            <h4>Surface settings:</h4>\n            {renderSurfaceControls()}\n          </>\n        )}\n      </>\n    );\n  };\n\n  const rowClass = controlsOpen ? \"channel-row\" : \"channel-row controls-closed\";\n  return (\n    <List.Item key={index} className={rowClass}>\n      <List.Item.Meta title={props.name} avatar={createColorPicker()} />\n      {visibilityControls}\n      {controlsOpen && <div style={{ width: \"100%\" }}>{renderControls()}</div>}\n    </List.Item>\n  );\n};\n\nexport default ChannelsWidgetRow;\n","import React from \"react\";\nimport { Checkbox } from \"antd\";\nimport { CheckboxChangeEvent } from \"antd/lib/checkbox\";\n\ntype SharedCheckboxProps<T> = React.PropsWithChildren<{\n  allOptions: T[];\n  checkedList: T[];\n  onChange: (checked: boolean, checkedList: T[]) => void;\n  style?: React.CSSProperties;\n}>;\n\nconst SharedCheckbox = <T,>(props: SharedCheckboxProps<T>): React.ReactElement => {\n  const onCheckAllChange = ({ target }: CheckboxChangeEvent): void => props.onChange(target.checked, props.allOptions);\n\n  const indeterminate = !!props.checkedList.length && props.checkedList.length < props.allOptions.length;\n  const checkAll = props.checkedList.length === props.allOptions.length;\n\n  return (\n    <Checkbox indeterminate={indeterminate} onChange={onCheckAllChange} checked={checkAll} style={props.style}>\n      {props.children}\n    </Checkbox>\n  );\n};\n\nexport default SharedCheckbox;\n","import { Channel } from \"@aics/vole-core\";\nimport { Collapse, CollapseProps, List } from \"antd\";\nimport React from \"react\";\n\nimport type { IsosurfaceFormat } from \"../shared/types\";\nimport type { ColorArray, ColorObject } from \"../shared/utils/colorRepresentations\";\nimport type { ChannelGrouping, ViewerChannelSettings } from \"../shared/utils/viewerChannelSettings\";\nimport { getDisplayName } from \"../shared/utils/viewerChannelSettings\";\nimport type { ChannelSettingUpdater, ChannelState, ChannelStateKey } from \"./ViewerStateProvider/types\";\n\nimport ChannelsWidgetRow from \"./ChannelsWidgetRow\";\nimport SharedCheckBox from \"./shared/SharedCheckBox\";\nimport { connectToViewerState } from \"./ViewerStateProvider\";\n\nexport type ChannelsWidgetProps = {\n  // From parent\n  channelDataChannels: Channel[] | undefined;\n  channelGroupedByType: ChannelGrouping;\n  viewerChannelSettings?: ViewerChannelSettings;\n\n  saveIsosurface: (channelIndex: number, type: IsosurfaceFormat) => void;\n  onApplyColorPresets: (presets: ColorArray[]) => void;\n\n  filterFunc?: (key: string) => boolean;\n  onColorChangeComplete?: (newRGB: ColorObject, oldRGB?: ColorObject, index?: number) => void;\n\n  // From viewer state\n  channelSettings: ChannelState[];\n  changeChannelSetting: ChannelSettingUpdater;\n};\n\nconst ChannelsWidget: React.FC<ChannelsWidgetProps> = (props: ChannelsWidgetProps) => {\n  const { channelGroupedByType, channelSettings, channelDataChannels, filterFunc, viewerChannelSettings } = props;\n\n  const createCheckboxHandler = (key: ChannelStateKey) => (value: boolean, channelArray: number[]) => {\n    props.changeChannelSetting(channelArray, { [key]: value });\n  };\n\n  const showVolumes = createCheckboxHandler(\"volumeEnabled\");\n  const showSurfaces = createCheckboxHandler(\"isosurfaceEnabled\");\n\n  const renderVisibilityControls = (channelArray: number[]): React.ReactNode => {\n    let volChecked: number[] = [];\n    let isoChecked: number[] = [];\n    channelArray.forEach((channelIndex: number) => {\n      const channelSetting = channelSettings[channelIndex];\n      if (!channelSetting) return;\n      if (channelSetting.volumeEnabled) {\n        volChecked.push(channelIndex);\n      }\n      if (channelSetting.isosurfaceEnabled) {\n        isoChecked.push(channelIndex);\n      }\n    });\n\n    return (\n      <>\n        <SharedCheckBox allOptions={channelArray} checkedList={volChecked} onChange={showVolumes}>\n          All Vol\n        </SharedCheckBox>\n        <SharedCheckBox\n          allOptions={channelArray}\n          checkedList={isoChecked}\n          onChange={showSurfaces}\n          // keep checkboxes lined up when channel rows have settings icon and headers don't\n          style={{ flex: 5 }}\n        >\n          All Surf\n        </SharedCheckBox>\n      </>\n    );\n  };\n\n  const renderChannelRow = (channelIndex: number): React.ReactNode => {\n    const thisChannelSettings = channelSettings[channelIndex];\n\n    return thisChannelSettings ? (\n      <ChannelsWidgetRow\n        key={`${channelIndex}_${thisChannelSettings.name}_${channelIndex}`}\n        index={channelIndex}\n        channelDataForChannel={channelDataChannels![channelIndex]}\n        name={getDisplayName(thisChannelSettings.name, channelIndex, viewerChannelSettings)}\n        channelState={thisChannelSettings}\n        changeChannelSetting={props.changeChannelSetting}\n        onColorChangeComplete={props.onColorChangeComplete}\n        saveIsosurface={props.saveIsosurface}\n      />\n    ) : null;\n  };\n\n  const firstKey = Object.keys(channelGroupedByType)[0];\n  const rows: CollapseProps[\"items\"] =\n    channelDataChannels &&\n    Object.entries(channelGroupedByType)\n      .filter(([key, channelArray]) => channelArray.length > 0 && (!filterFunc || filterFunc(key)))\n      .map(([key, channelArray]) => {\n        const children = <List itemLayout=\"horizontal\" dataSource={channelArray} renderItem={renderChannelRow} />;\n\n        return {\n          key,\n          label: key,\n          children,\n          extra: renderVisibilityControls(channelArray),\n        };\n      });\n\n  return <Collapse bordered={false} defaultActiveKey={firstKey} items={rows} collapsible=\"icon\" />;\n};\n\nexport default connectToViewerState(ChannelsWidget, [\"channelSettings\", \"changeChannelSetting\"]);\n","import React from \"react\";\n\nimport ColorPicker from \"./ColorPicker\";\nimport { ColorArray, colorArrayToObject, colorObjectToArray } from \"../shared/utils/colorRepresentations\";\nimport { Styles } from \"../shared/types\";\nimport { ViewerSettingUpdater } from \"./ViewerStateProvider/types\";\nimport { connectToViewerState } from \"./ViewerStateProvider\";\n\nconst ColorPickerRow: React.FC<{\n  color: ColorArray;\n  onColorChange: (color: ColorArray) => void;\n  children?: React.ReactNode;\n}> = ({ color, onColorChange, children }) => (\n  <div style={STYLES.colorPickerRow}>\n    <span style={STYLES.colorPicker}>\n      <ColorPicker\n        color={colorArrayToObject(color)}\n        onColorChange={(color) => onColorChange(colorObjectToArray(color))}\n        width={18}\n        disableAlpha={true}\n      />\n    </span>\n    <span>{children}</span>\n  </div>\n);\n\nexport interface CustomizeWidgetProps {\n  // From parent\n  visibleControls: {\n    backgroundColorPicker: boolean;\n    boundingBoxColorPicker: boolean;\n  };\n\n  // From viewer state\n  showBoundingBox: boolean;\n  backgroundColor: ColorArray;\n  boundingBoxColor: ColorArray;\n\n  changeViewerSetting: ViewerSettingUpdater;\n}\n\nconst CustomizeWidget: React.FC<CustomizeWidgetProps> = (props) => (\n  <>\n    {props.visibleControls.backgroundColorPicker && (\n      <ColorPickerRow\n        color={props.backgroundColor}\n        onColorChange={(color) => props.changeViewerSetting(\"backgroundColor\", color)}\n      >\n        Background color\n      </ColorPickerRow>\n    )}\n    {props.visibleControls.boundingBoxColorPicker && (\n      <ColorPickerRow\n        color={props.boundingBoxColor}\n        onColorChange={(color) => props.changeViewerSetting(\"boundingBoxColor\", color)}\n      >\n        Bounding box color\n        {!props.showBoundingBox && <i> - bounding box turned off</i>}\n      </ColorPickerRow>\n    )}\n  </>\n);\n\nconst STYLES: Styles = {\n  colorPickerRow: {\n    padding: \"14px 0\",\n    display: \"flex\",\n    borderBottom: \"1px solid #6e6e6e\",\n    color: \"var(--color-controlpanel-text)\",\n  },\n  colorPicker: {\n    marginRight: \"16px\",\n  },\n};\n\nexport default connectToViewerState(CustomizeWidget, [\n  \"showBoundingBox\",\n  \"backgroundColor\",\n  \"boundingBoxColor\",\n  \"changeViewerSetting\",\n]);\n","import { Checkbox } from \"antd\";\nimport React from \"react\";\n\nimport { ViewerSettingUpdater } from \"./ViewerStateProvider/types\";\n\nimport SliderRow from \"./shared/SliderRow\";\nimport { connectToViewerState } from \"./ViewerStateProvider\";\n\ntype GlobalVolumeControlKey = \"maskAlpha\" | \"brightness\" | \"density\" | \"levels\";\n\nexport interface GlobalVolumeControlsProps {\n  // From parent\n  imageName: string | undefined;\n  pixelSize: [number, number, number];\n  visibleControls: {\n    alphaMaskSlider: boolean;\n    brightnessSlider: boolean;\n    densitySlider: boolean;\n    levelsSliders: boolean;\n    interpolationControl: boolean;\n  };\n\n  // From viewer state\n  maskAlpha: number;\n  brightness: number;\n  density: number;\n  levels: [number, number, number];\n  interpolationEnabled: boolean;\n\n  changeViewerSetting: ViewerSettingUpdater;\n}\n\nconst GlobalVolumeControls: React.FC<GlobalVolumeControlsProps> = (props) => {\n  const createSliderRow = (\n    label: string,\n    start: number | number[],\n    max: number,\n    propKey: GlobalVolumeControlKey\n  ): React.ReactNode => {\n    const onUpdate = (_strValues: string[], _handle: number, values: number[]): void => {\n      const selectValue = values.length === 1 ? values[0] : (values as [number, number, number]);\n      props.changeViewerSetting(propKey, selectValue);\n    };\n\n    return <SliderRow label={label} start={start} max={max} onUpdate={onUpdate} />;\n  };\n\n  const { visibleControls: showControls, maskAlpha, brightness, density, levels } = props;\n\n  return (\n    <div style={{ paddingTop: 18, paddingBottom: 22 }}>\n      {showControls.alphaMaskSlider && createSliderRow(\"mask cell\", maskAlpha, 100, \"maskAlpha\")}\n      {showControls.brightnessSlider && createSliderRow(\"brightness\", brightness, 100, \"brightness\")}\n      {showControls.densitySlider && createSliderRow(\"density\", density, 100, \"density\")}\n      {showControls.levelsSliders && createSliderRow(\"levels\", levels, 255, \"levels\")}\n      {showControls.interpolationControl && (\n        <SliderRow label=\"interpolate\" hideSlider={true}>\n          <Checkbox\n            checked={props.interpolationEnabled}\n            onChange={({ target }) => props.changeViewerSetting(\"interpolationEnabled\", target.checked)}\n          />\n        </SliderRow>\n      )}\n    </div>\n  );\n};\n\nexport default connectToViewerState(GlobalVolumeControls, [\n  \"maskAlpha\",\n  \"brightness\",\n  \"density\",\n  \"levels\",\n  \"interpolationEnabled\",\n  \"changeViewerSetting\",\n]);\n","import { RightOutlined } from \"@ant-design/icons\";\nimport React from \"react\";\n\nimport { MetadataEntry, MetadataRecord } from \"../../shared/types\";\n\nimport \"./styles.css\";\n\ntype MetadataTableProps = {\n  metadata: MetadataRecord | MetadataEntry[];\n  topLevel?: boolean;\n};\n\ntype CollapsibleCategoryProps = {\n  metadata: MetadataRecord | MetadataEntry[];\n  title: string;\n};\n\nconst isCategory = (entry: MetadataEntry): entry is MetadataRecord | MetadataEntry[] =>\n  typeof entry === \"object\" && entry !== null;\n\nconst sortCategoriesFirst = (entry: MetadataEntry): MetadataEntry => {\n  if (!isCategory(entry) || Array.isArray(entry)) {\n    return entry;\n  }\n\n  const cats: MetadataRecord = {};\n  const vals: MetadataRecord = {};\n  for (const key in entry) {\n    if (isCategory(entry[key])) {\n      cats[key] = entry[key];\n    } else {\n      vals[key] = entry[key];\n    }\n  }\n\n  return { ...cats, ...vals };\n};\n\n/** Component to hold collapse state */\nconst MetadataCategory: React.FC<CollapsibleCategoryProps> = ({ metadata, title }) => {\n  const [collapsed, setCollapsed] = React.useState(true);\n  const collapsedClass = collapsed ? \" metadata-collapse-collapsed\" : \"\";\n\n  return (\n    <>\n      <tr className={\"metadata-row-collapse-title\" + collapsedClass} onClick={() => setCollapsed(!collapsed)}>\n        <td colSpan={2}>\n          <span className=\"metadata-collapse-caret\">\n            <RightOutlined style={{ transform: `rotate(${collapsed ? 0 : 90}deg)` }} />\n          </span>\n          {title}\n        </td>\n      </tr>\n      <tr className={\"metadata-row-collapse-content\" + collapsedClass}>\n        <td className=\"metadata-collapse-content\" colSpan={2}>\n          <MetadataTable metadata={metadata} />\n        </td>\n      </tr>\n    </>\n  );\n};\n\nconst MetadataTable: React.FC<MetadataTableProps> = ({ metadata, topLevel }) => {\n  const metadataKeys = Object.keys(metadata);\n  const metadataIsArray = Array.isArray(metadata);\n\n  return (\n    <table className={\"viewer-metadata-table\" + (topLevel ? \" metadata-top-level\" : \"\")}>\n      <tbody>\n        {metadataKeys.map((key, idx) => {\n          const metadataValue = sortCategoriesFirst(metadataIsArray ? metadata[idx] : metadata[key]);\n\n          if (isCategory(metadataValue)) {\n            return <MetadataCategory key={key} metadata={metadataValue} title={key} />;\n          } else {\n            return (\n              <tr key={key}>\n                <td className=\"metadata-key\">{key}</td>\n                <td className=\"metadata-value\">{metadataValue + \"\"}</td>\n              </tr>\n            );\n          }\n        })}\n      </tbody>\n    </table>\n  );\n};\n\nconst MetadataViewer: React.FC<{ metadata: MetadataRecord }> = ({ metadata }) => (\n  <MetadataTable metadata={metadata} topLevel={true} />\n);\n\nexport default MetadataViewer;\n","import { Button, Checkbox, Collapse, CollapseProps, Dropdown, Flex, MenuProps, Tooltip } from \"antd\";\nimport { MenuInfo } from \"rc-menu/lib/interface\";\nimport React, { useContext } from \"react\";\n\nimport { PRESET_COLOR_MAP } from \"../../shared/constants\";\nimport { MetadataRecord } from \"../../shared/types\";\n\nimport ChannelsWidget from \"../ChannelsWidget\";\nimport CustomizeWidget, { CustomizeWidgetProps } from \"../CustomizeWidget\";\nimport GlobalVolumeControls, { GlobalVolumeControlsProps } from \"../GlobalVolumeControls\";\nimport MetadataViewer from \"../MetadataViewer\";\nimport ViewerIcon from \"../shared/ViewerIcon\";\nimport { connectToViewerState, ViewerStateContext } from \"../ViewerStateProvider\";\n\nimport \"./styles.css\";\n\ntype PropsOf<T> = T extends React.ComponentType<infer P> ? P : never;\n\ninterface ControlPanelProps\n  extends PropsOf<typeof ChannelsWidget>,\n    PropsOf<typeof GlobalVolumeControls>,\n    PropsOf<typeof CustomizeWidget> {\n  hasImage: boolean;\n  visibleControls: GlobalVolumeControlsProps[\"visibleControls\"] &\n    CustomizeWidgetProps[\"visibleControls\"] & {\n      colorPresetsDropdown: boolean;\n      metadataViewer: boolean;\n    };\n  getMetadata: () => MetadataRecord;\n  collapsed: boolean;\n  setCollapsed: (value: boolean) => void;\n  resetToDefaultViewerState: () => void;\n}\n\nconst enum ControlTab {\n  Channels,\n  Advanced,\n  Metadata,\n}\n\nconst ControlTabNames = {\n  [ControlTab.Channels]: \"Channel Settings\",\n  [ControlTab.Advanced]: \"Advanced Settings\",\n  [ControlTab.Metadata]: \"Metadata\",\n};\n\nfunction ControlPanel(props: ControlPanelProps): React.ReactElement {\n  const [tab, _setTab] = React.useState(ControlTab.Channels);\n  const setTab = (newTab: ControlTab): void => {\n    _setTab(newTab);\n    props.setCollapsed(false);\n  };\n\n  const viewerState = useContext(ViewerStateContext).ref;\n  const { changeViewerSetting, resetIntensityPerVolume } = viewerState.current;\n\n  const controlPanelContainerRef = React.useRef<HTMLDivElement>(null);\n  const getDropdownContainer = controlPanelContainerRef.current ? () => controlPanelContainerRef.current! : undefined;\n\n  const { viewerChannelSettings, visibleControls, hasImage } = props;\n\n  // TODO key is a number, but MenuInfo assumes keys will always be strings\n  //   if future versions of antd make this type more permissive, remove ugly double-cast\n  const makeTurnOnPresetFn = ({ key }: MenuInfo): void =>\n    props.onApplyColorPresets(PRESET_COLOR_MAP[key as unknown as number].colors);\n\n  const renderColorPresetsDropdown = (): React.ReactNode => {\n    const dropDownMenuProps: MenuProps = {\n      items: PRESET_COLOR_MAP.map((preset, index) => {\n        return { key: index, label: preset.name };\n      }),\n      onClick: makeTurnOnPresetFn,\n    };\n    return (\n      <div className=\"color-presets-dropdown\">\n        <Dropdown trigger={[\"click\"]} menu={dropDownMenuProps} getPopupContainer={getDropdownContainer}>\n          <Button>\n            <div style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\", gap: \"4px\" }}>\n              Apply palette\n              <ViewerIcon type=\"dropdownArrow\" style={{ fontSize: \"14px\" }} />\n            </div>\n          </Button>\n        </Dropdown>\n      </div>\n    );\n  };\n\n  const renderTab = (thisTab: ControlTab, icon: React.ReactNode): React.ReactNode => (\n    <Tooltip title={ControlTabNames[thisTab]} placement=\"right\" {...(!props.collapsed && { open: false })}>\n      <Button\n        className={tab === thisTab ? \"ant-btn-icon-only btn-tabactive\" : \"ant-btn-icon-only\"}\n        onClick={() => setTab(thisTab)}\n        icon={typeof icon === \"string\" ? icon : undefined}\n      >\n        {typeof icon === \"object\" && icon}\n      </Button>\n    </Tooltip>\n  );\n\n  const renderAdvancedSettings = (): React.ReactNode => {\n    const items: CollapseProps[\"items\"] = [\n      {\n        key: 0,\n        label: \"Rendering adjustments\",\n        children: (\n          <GlobalVolumeControls\n            imageName={props.imageName}\n            pixelSize={props.pixelSize}\n            visibleControls={visibleControls}\n          />\n        ),\n      },\n    ];\n    const showCustomize = visibleControls.backgroundColorPicker || visibleControls.boundingBoxColorPicker;\n\n    if (showCustomize) {\n      items.push({\n        key: 1,\n        label: \"Customize\",\n        children: <CustomizeWidget visibleControls={props.visibleControls} />,\n      });\n    }\n\n    return (\n      <Flex gap={10} vertical>\n        <Collapse bordered={false} defaultActiveKey={showCustomize ? [0, 1] : 0} items={items} />\n        <div style={{ margin: \"0 10px\", width: \"fit-content\" }}>\n          <Tooltip\n            trigger={[\"hover\", \"focus\"]}\n            placement=\"right\"\n            title=\"Clears ALL rendering settings and channel configuration to the default viewer state.\n            This will replace any edits to channel settings, color presets, and rendering adjustments.\"\n          >\n            <Button onClick={props.resetToDefaultViewerState}>Clear all settings</Button>\n          </Tooltip>\n        </div>\n      </Flex>\n    );\n  };\n\n  return (\n    <div className=\"control-panel-col-container\" ref={controlPanelContainerRef}>\n      <div className=\"control-panel-tab-col\" style={{ flex: \"0 0 50px\" }}>\n        <Button\n          className={\"ant-btn-icon-only btn-collapse\" + (props.collapsed ? \" btn-collapse-collapsed\" : \"\")}\n          onClick={() => props.setCollapsed(!props.collapsed)}\n        >\n          <ViewerIcon type=\"closePanel\" />\n        </Button>\n\n        <div className=\"tab-divider\" />\n\n        {renderTab(ControlTab.Channels, <ViewerIcon type=\"channels\" />)}\n        {renderTab(ControlTab.Advanced, <ViewerIcon type=\"preferences\" />)}\n        {props.visibleControls.metadataViewer && renderTab(ControlTab.Metadata, <ViewerIcon type=\"metadata\" />)}\n      </div>\n      <div className=\"control-panel-col\" style={{ flex: \"0 0 450px\" }}>\n        <h2 className=\"control-panel-title\">{ControlTabNames[tab]}</h2>\n        {visibleControls.colorPresetsDropdown && tab === ControlTab.Channels && (\n          <div className=\"control-panel-actions\">\n            {renderColorPresetsDropdown()}\n            <Tooltip\n              title=\"When enabled, resets volume intensity settings to defaults when switching between volumes.\"\n              // TODO: Non-magic number here\n              zIndex={10000}\n              trigger={[\"focus\", \"hover\"]}\n            >\n              <Checkbox\n                checked={resetIntensityPerVolume}\n                onChange={(e) => changeViewerSetting(\"resetIntensityPerVolume\", e.target.checked)}\n                style={{ color: \"var(--color-controlpanel-text)\" }}\n              >\n                Auto-reset intensity\n              </Checkbox>\n            </Tooltip>\n          </div>\n        )}\n        {hasImage && (\n          <div className=\"channel-rows-list\">\n            {tab === ControlTab.Channels && (\n              <ChannelsWidget\n                channelDataChannels={props.channelDataChannels}\n                channelGroupedByType={props.channelGroupedByType}\n                saveIsosurface={props.saveIsosurface}\n                onColorChangeComplete={props.onColorChangeComplete}\n                onApplyColorPresets={props.onApplyColorPresets}\n                filterFunc={props.filterFunc}\n                viewerChannelSettings={viewerChannelSettings}\n              />\n            )}\n            {tab === ControlTab.Advanced && renderAdvancedSettings()}\n            {tab === ControlTab.Metadata && <MetadataViewer metadata={props.getMetadata()} />}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default connectToViewerState(ControlPanel, [\"resetToDefaultViewerState\"]);\n","import React from \"react\";\nimport { Dropdown, Button, MenuProps, Tooltip } from \"antd\";\n\nimport ViewerIcon from \"../shared/ViewerIcon\";\n\ninterface DownloadButtonProps {\n  cellDownloadHref: string;\n  fovDownloadHref: string;\n  hasFov: boolean;\n}\n\nconst DownloadButton: React.FC<DownloadButtonProps> = ({ fovDownloadHref, cellDownloadHref, hasFov }) => {\n  if (hasFov) {\n    const menu: MenuProps = {\n      className: \"download-dropdown\",\n      items: [\n        {\n          key: \"1\",\n          label: (\n            <a href={cellDownloadHref}>\n              <ViewerIcon type=\"download\" /> Segmented cell\n            </a>\n          ),\n        },\n        {\n          key: \"2\",\n          label: (\n            <a href={fovDownloadHref}>\n              <ViewerIcon type=\"download\" /> Full field image\n            </a>\n          ),\n        },\n      ],\n    };\n    return (\n      <Tooltip trigger={[\"hover\", \"focus\"]} placement=\"bottom\" title={\"Download volume data\"}>\n        <Dropdown menu={menu} placement=\"bottomRight\" trigger={[\"click\"]}>\n          <Button className=\"ant-btn-icon-only btn-borderless\">\n            <ViewerIcon type=\"download\" />\n          </Button>\n        </Dropdown>\n      </Tooltip>\n    );\n  } else if (cellDownloadHref) {\n    return (\n      <Tooltip trigger={[\"hover\", \"focus\"]} placement=\"bottom\" title={\"Download volume data\"}>\n        <Button className=\"ant-btn-icon-only btn-borderless\" href={cellDownloadHref}>\n          <ViewerIcon type=\"download\" />\n        </Button>\n      </Tooltip>\n    );\n  } else {\n    return null;\n  }\n};\n\nexport default DownloadButton;\n","import { Radio } from \"antd\";\nimport { RadioChangeEvent } from \"antd/lib/radio\";\nimport React from \"react\";\n\nimport { ViewMode } from \"../../shared/enums\";\n\nconst viewModes = [ViewMode.threeD, ViewMode.xy, ViewMode.xz, ViewMode.yz];\n\ninterface ViewModeRadioButtonsProps {\n  mode: ViewMode;\n  onViewModeChange: (newMode: ViewMode) => void;\n}\n\nconst ViewModeRadioButtons: React.FC<ViewModeRadioButtonsProps> = (props) => {\n  const onChangeButton = ({ target }: RadioChangeEvent): void => {\n    if (props.mode !== target.value) {\n      props.onViewModeChange(target.value);\n    }\n  };\n\n  return (\n    <Radio.Group onChange={onChangeButton} value={props.mode.toString()}>\n      {viewModes.map((mode, index) => (\n        <Radio.Button key={index} value={mode.toString()}>\n          {mode}\n        </Radio.Button>\n      ))}\n    </Radio.Group>\n  );\n};\n\nexport default ViewModeRadioButtons;\n","import { ReloadOutlined } from \"@ant-design/icons\";\nimport { Button, Radio, Select, Tooltip } from \"antd\";\nimport { debounce } from \"lodash\";\nimport React from \"react\";\n\nimport { ImageType, RenderMode, ViewMode } from \"../../shared/enums\";\nimport { ViewerSettingUpdater } from \"../ViewerStateProvider/types\";\n\nimport ViewerIcon from \"../shared/ViewerIcon\";\nimport { connectToViewerState } from \"../ViewerStateProvider\";\nimport DownloadButton from \"./DownloadButton\";\nimport ViewModeRadioButtons from \"./ViewModeRadioButtons\";\n\nimport \"./styles.css\";\n\ntype ToolbarProps = {\n  // From parent\n  cellDownloadHref: string;\n  fovDownloadHref: string;\n  hasCellId: boolean;\n  hasParentImage: boolean;\n  canPathTrace: boolean;\n\n  resetCamera: () => void;\n  downloadScreenshot: () => void;\n\n  visibleControls: {\n    autoRotateButton: boolean;\n    viewModeRadioButtons: boolean;\n    fovCellSwitchControls: boolean;\n    resetCameraButton: boolean;\n    showAxesButton: boolean;\n    showBoundingBoxButton: boolean;\n  };\n\n  // From viewer state\n  imageType: ImageType;\n  renderMode: RenderMode;\n  viewMode: ViewMode;\n  autorotate: boolean;\n  showAxes: boolean;\n  showBoundingBox: boolean;\n  changeViewerSetting: ViewerSettingUpdater;\n  resetToSavedViewerState: () => void;\n};\n\nconst RESIZE_DEBOUNCE_DELAY = 50;\n\nconst visuallyHiddenStyle: React.CSSProperties = {\n  position: \"absolute\",\n  width: \"1px\",\n  height: \"1px\",\n  padding: \"0\",\n  margin: \"-1px\",\n  overflow: \"hidden\",\n  clip: \"rect(0, 0, 0, 0)\",\n  whiteSpace: \"nowrap\",\n  borderWidth: \"0\",\n};\n\nconst Toolbar: React.FC<ToolbarProps> = (props) => {\n  const containerRef = React.useRef<HTMLDivElement>(null);\n  const barRef = React.useRef<HTMLDivElement>(null);\n  const leftRef = React.useRef<HTMLDivElement>(null);\n  const rightRef = React.useRef<HTMLDivElement>(null);\n  const centerRef = React.useRef<HTMLDivElement>(null);\n\n  const [scrollMode, setScrollMode] = React.useState(false);\n  const [showScrollBtnLeft, setScrollBtnLeft] = React.useState(false);\n  const [showScrollBtnRight, setScrollBtnRight] = React.useState(false);\n\n  // Scroll buttons are only visible when toolbar can be scrolled in that direction.\n  // This may change on either scroll or resize.\n  const checkScrollBtnVisible = React.useCallback((): void => {\n    const barEl = barRef.current;\n    if (!barEl) {\n      return;\n    }\n    setScrollBtnLeft(barEl.scrollLeft > 0);\n    setScrollBtnRight(barEl.scrollLeft < barEl.scrollWidth - barEl.clientWidth);\n  }, []);\n\n  // This is effectively a `useCallback` - it memoizes a function - but since we're feeding the whole function into\n  // lodash's `debounce`, using `useMemo` memoizes the transformation done by `debounce` as well.\n  const checkSize = React.useMemo(() => {\n    return debounce((): void => {\n      if (!leftRef.current || !centerRef.current || !rightRef.current || !barRef.current) {\n        return;\n      }\n      const leftRect = leftRef.current.getBoundingClientRect();\n      const centerRect = centerRef.current.getBoundingClientRect();\n      const rightRect = rightRef.current.getBoundingClientRect();\n\n      // when calculating width required to leave scroll mode, add a bit of extra width to ensure that triggers\n      // for entering and leaving scroll mode never overlap (causing toolbar to rapidly switch when resizing)\n      const SCROLL_OFF_EXTRA_WIDTH = 15;\n\n      setScrollMode((mode) => {\n        if (mode) {\n          // Leave scroll mode if there is enough space for centered controls not to overlap left/right-aligned ones\n          const barWidth = barRef.current!.getBoundingClientRect().width;\n          const requiredWidth =\n            Math.max(leftRect.width, rightRect.width) * 2 + centerRect.width + SCROLL_OFF_EXTRA_WIDTH;\n          return barWidth <= requiredWidth;\n        } else {\n          // Enter scroll mode if centered controls are overlapping either left/right-aligned ones\n          return leftRect.right > centerRect.left || centerRect.right > rightRect.left;\n        }\n      });\n      checkScrollBtnVisible();\n    }, RESIZE_DEBOUNCE_DELAY);\n  }, [checkScrollBtnVisible]);\n\n  React.useEffect(() => {\n    // Make sure `checkSize` is run once on mount\n    checkSize();\n    window.addEventListener(\"resize\", checkSize);\n    return () => window.removeEventListener(\"resize\", checkSize);\n  }, [checkSize]);\n\n  const scrollX = (amount: number): number => (barRef.current!.scrollLeft += amount);\n\n  // Translate vertical scrolling into horizontal scrolling\n  const wheelHandler: React.WheelEventHandler<HTMLDivElement> = (e) => {\n    e.preventDefault();\n    if (e.deltaY === 0) {\n      return;\n    }\n    scrollX(e.deltaY);\n  };\n\n  const toggleAxis = (): void => props.changeViewerSetting(\"showAxes\", !props.showAxes);\n  const toggleBoundingBox = (): void => props.changeViewerSetting(\"showBoundingBox\", !props.showBoundingBox);\n  // TODO remove ant-btn-icon-only hack when upgrading antd\n  const classForToggleBtn = (active: boolean): string =>\n    \"ant-btn-icon-only btn-borderless\" + (active ? \" btn-active\" : \"\");\n\n  const { changeViewerSetting, resetToSavedViewerState, visibleControls, showAxes, showBoundingBox, autorotate } =\n    props;\n  const twoDMode = props.viewMode !== ViewMode.threeD;\n\n  const renderGroup1 =\n    visibleControls.viewModeRadioButtons || visibleControls.resetCameraButton || visibleControls.autoRotateButton;\n  const renderGroup4 = visibleControls.showAxesButton || visibleControls.showBoundingBoxButton;\n\n  const axesToggleTitle = showAxes ? \"Hide axes\" : \"Show axes\";\n  const boundingBoxToggleTitle = showBoundingBox ? \"Hide bounding box\" : \"Show bounding box\";\n  const turntableToggleTitle = autorotate ? \"Turn off turntable\" : \"Turn on turntable\";\n\n  const getPopupContainer = containerRef.current ? () => containerRef.current! : undefined;\n\n  return (\n    <div className={`viewer-toolbar-container${scrollMode ? \" viewer-toolbar-scroll\" : \"\"}`} ref={containerRef}>\n      <div\n        className=\"viewer-toolbar-scroll-left\"\n        style={{ display: showScrollBtnLeft ? \"flex\" : \"none\" }}\n        onClick={() => scrollX(-100)}\n      >\n        <ViewerIcon type=\"closePanel\" style={{ fontSize: \"12px\", transform: \"rotate(180deg)\" }} />\n      </div>\n      <div className=\"viewer-toolbar\" ref={barRef} onWheel={wheelHandler} onScroll={checkScrollBtnVisible}>\n        <div className=\"viewer-toolbar-left\" ref={leftRef}>\n          <Tooltip placement=\"bottom\" title=\"Reset to initial settings\" trigger={[\"focus\", \"hover\"]}>\n            <Button className=\"ant-btn-icon-only btn-borderless\" onClick={resetToSavedViewerState}>\n              <ReloadOutlined />\n              <span style={visuallyHiddenStyle}>Reset to initial settings</span>\n            </Button>\n          </Tooltip>\n        </div>\n        <div className=\"viewer-toolbar-center\" ref={centerRef}>\n          {renderGroup1 && (\n            <div className=\"viewer-toolbar-group\">\n              {visibleControls.viewModeRadioButtons && (\n                <ViewModeRadioButtons\n                  mode={props.viewMode}\n                  onViewModeChange={(newMode) => changeViewerSetting(\"viewMode\", newMode)}\n                />\n              )}\n              {visibleControls.resetCameraButton && (\n                <Tooltip placement=\"bottom\" title=\"Reset camera\">\n                  <Button className=\"ant-btn-icon-only btn-borderless\" onClick={props.resetCamera}>\n                    <ViewerIcon type=\"resetView\" />\n                  </Button>\n                </Tooltip>\n              )}\n              {visibleControls.autoRotateButton && (\n                <Tooltip placement=\"bottom\" title={turntableToggleTitle}>\n                  <Button\n                    className={classForToggleBtn(autorotate && !twoDMode)}\n                    disabled={twoDMode || props.renderMode === RenderMode.pathTrace}\n                    onClick={() => changeViewerSetting(\"autorotate\", !autorotate)}\n                  >\n                    <ViewerIcon type=\"turnTable\" />\n                  </Button>\n                </Tooltip>\n              )}\n            </div>\n          )}\n\n          {visibleControls.fovCellSwitchControls && props.hasCellId && props.hasParentImage && (\n            <div className=\"viewer-toolbar-group\">\n              <Radio.Group\n                value={props.imageType}\n                onChange={({ target }) => changeViewerSetting(\"imageType\", target.value)}\n              >\n                <Radio.Button value={ImageType.segmentedCell}>Single cell</Radio.Button>\n                <Radio.Button value={ImageType.fullField}>Full field</Radio.Button>\n              </Radio.Group>\n            </div>\n          )}\n\n          <div className=\"viewer-toolbar-group\">\n            <Select\n              className=\"select-render-setting\"\n              popupClassName=\"viewer-toolbar-dropdown\"\n              value={props.renderMode}\n              onChange={(value) => changeViewerSetting(\"renderMode\", value)}\n              getPopupContainer={getPopupContainer}\n            >\n              <Select.Option value={RenderMode.volumetric} key={RenderMode.volumetric}>\n                Volumetric\n              </Select.Option>\n              {props.canPathTrace && (\n                <Select.Option value={RenderMode.pathTrace} key={RenderMode.pathTrace} disabled={twoDMode}>\n                  Path trace\n                </Select.Option>\n              )}\n              <Select.Option value={RenderMode.maxProject} key={RenderMode.maxProject}>\n                Max project\n              </Select.Option>\n            </Select>\n          </div>\n\n          {renderGroup4 && (\n            <div className=\"viewer-toolbar-group\">\n              {visibleControls.showAxesButton && (\n                <Tooltip placement=\"bottom\" title={axesToggleTitle}>\n                  <Button className={classForToggleBtn(showAxes)} onClick={toggleAxis}>\n                    <ViewerIcon type=\"axes\" />\n                  </Button>\n                </Tooltip>\n              )}\n              {visibleControls.showBoundingBoxButton && (\n                <Tooltip placement=\"bottom\" title={boundingBoxToggleTitle}>\n                  <Button className={classForToggleBtn(showBoundingBox)} onClick={toggleBoundingBox}>\n                    <ViewerIcon type=\"boundingBox\" />\n                  </Button>\n                </Tooltip>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"viewer-toolbar-right viewer-toolbar-group\" ref={rightRef}>\n          <Tooltip placement=\"bottom\" title=\"Download\">\n            <DownloadButton\n              cellDownloadHref={props.cellDownloadHref}\n              fovDownloadHref={props.fovDownloadHref}\n              hasFov={props.hasCellId && props.hasParentImage}\n            />\n          </Tooltip>\n          <Tooltip placement=\"bottom\" title=\"Screenshot\">\n            <Button className=\"ant-btn-icon-only btn-borderless\" onClick={props.downloadScreenshot}>\n              <ViewerIcon type=\"camera\" />\n            </Button>\n          </Tooltip>\n        </div>\n      </div>\n      <div\n        className=\"viewer-toolbar-scroll-right\"\n        style={{ display: showScrollBtnRight ? \"flex\" : \"none\" }}\n        onClick={() => scrollX(100)}\n      >\n        <ViewerIcon type=\"closePanel\" style={{ fontSize: \"12px\" }} />\n      </div>\n    </div>\n  );\n};\n\nexport default connectToViewerState(Toolbar, [\n  \"imageType\",\n  \"renderMode\",\n  \"viewMode\",\n  \"autorotate\",\n  \"showAxes\",\n  \"showBoundingBox\",\n  \"changeViewerSetting\",\n  \"resetToSavedViewerState\",\n]);\n","import { Lut, View3d, Volume } from \"@aics/vole-core\";\nimport React, { useEffect } from \"react\";\n\nimport { controlPointsToLut, rampToControlPoints } from \"../../shared/utils/controlPointsToLut\";\nimport { ChannelState } from \"../ViewerStateProvider/types\";\nimport { UseImageEffectType } from \"./types\";\n\ninterface ChannelUpdaterProps {\n  index: number;\n  channelState: ChannelState;\n  view3d: View3d;\n  image: Volume | null;\n  version: number;\n}\n\n/**\n * A component that doesn't render anything, but reacts to the provided `ChannelState`\n * and keeps it in sync with the viewer.\n */\nconst ChannelUpdater: React.FC<ChannelUpdaterProps> = ({ index, channelState, view3d, image, version }) => {\n  const { volumeEnabled, isosurfaceEnabled, isovalue, colorizeEnabled, colorizeAlpha, opacity, color } = channelState;\n\n  // Effects to update channel settings should check if image is present and channel is loaded first\n  const useImageEffect: UseImageEffectType = (effect, deps) => {\n    useEffect(() => {\n      if (image && version > 0) {\n        return effect(image);\n      }\n      // react-hooks will check that `deps` match `effect`'s dependencies, so we can safely exclude `effect` here\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [...deps, image, version]);\n  };\n\n  // enable/disable channel can't be dependent on channel load state because it may trigger the channel to load\n  useEffect(() => {\n    if (image) {\n      view3d.setVolumeChannelEnabled(image, index, volumeEnabled);\n      view3d.updateLuts(image);\n    }\n  }, [image, volumeEnabled, index, view3d]);\n\n  useEffect(() => {\n    if (image) {\n      view3d.setVolumeChannelOptions(image, index, { isosurfaceEnabled });\n    }\n  }, [image, isosurfaceEnabled, index, view3d]);\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeChannelOptions(currentImage, index, { isovalue }),\n    [isovalue, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeChannelOptions(currentImage, index, { isosurfaceOpacity: opacity }),\n    [opacity, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      view3d.setVolumeChannelOptions(currentImage, index, { color });\n      view3d.updateLuts(currentImage);\n    },\n    [color, index, view3d]\n  );\n\n  const { controlPoints, ramp, useControlPoints } = channelState;\n  useImageEffect(\n    (currentImage) => {\n      if (useControlPoints && controlPoints.length < 2) {\n        return;\n      }\n      const controlPointsToUse = useControlPoints ? controlPoints : rampToControlPoints(ramp);\n      const gradient = controlPointsToLut(controlPointsToUse);\n      currentImage.setLut(index, gradient);\n      view3d.updateLuts(currentImage);\n    },\n    [controlPoints, ramp, useControlPoints, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      if (colorizeEnabled) {\n        // TODO get the labelColors from the tf editor component\n        const lut = new Lut().createLabelColors(currentImage.getHistogram(index));\n        currentImage.setColorPalette(index, lut.lut);\n        // following effect will also run and call `updateLuts`\n      }\n    },\n    [colorizeEnabled, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      currentImage.setColorPaletteAlpha(index, colorizeEnabled ? colorizeAlpha : 0);\n      view3d.updateLuts(currentImage);\n    },\n    [colorizeEnabled, colorizeAlpha, index, view3d]\n  );\n\n  return null;\n};\n\nexport default ChannelUpdater;\n","// 3rd Party Imports\nimport {\n  ControlPoint,\n  RawArrayLoaderOptions,\n  RENDERMODE_PATHTRACE,\n  RENDERMODE_RAYMARCH,\n  View3d,\n  Volume,\n} from \"@aics/vole-core\";\nimport { Layout } from \"antd\";\nimport { debounce, isEqual } from \"lodash\";\nimport React, { useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\n\nimport {\n  AXIS_MARGIN_DEFAULT,\n  CLIPPING_PANEL_HEIGHT_DEFAULT,\n  CLIPPING_PANEL_HEIGHT_TALL,\n  CONTROL_PANEL_CLOSE_WIDTH,\n  DTYPE_RANGE,\n  getDefaultViewerState,\n  SCALE_BAR_MARGIN_DEFAULT,\n} from \"../../shared/constants\";\nimport { ImageType, RenderMode, ViewMode } from \"../../shared/enums\";\nimport { activeAxisMap, AxisName, IsosurfaceFormat, MetadataRecord, PerAxis } from \"../../shared/types\";\nimport { colorArrayToFloats } from \"../../shared/utils/colorRepresentations\";\nimport {\n  controlPointsToRamp,\n  initializeLut,\n  remapControlPointsForChannel,\n  remapRampForChannel,\n} from \"../../shared/utils/controlPointsToLut\";\nimport { useConstructor } from \"../../shared/utils/hooks\";\nimport {\n  alphaSliderToImageValue,\n  brightnessSliderToImageValue,\n  densitySliderToImageValue,\n  gammaSliderToImageValues,\n} from \"../../shared/utils/sliderValuesToImageValues\";\nimport { findFirstChannelMatch } from \"../../shared/utils/viewerChannelSettings\";\nimport useVolume, { ImageLoadStatus } from \"../useVolume\";\nimport type { AppProps, ControlVisibilityFlags, MultisceneUrls, UseImageEffectType } from \"./types\";\n\nimport CellViewerCanvasWrapper from \"../CellViewerCanvasWrapper\";\nimport ControlPanel from \"../ControlPanel\";\nimport { useErrorAlert } from \"../ErrorAlert\";\nimport StyleProvider from \"../StyleProvider\";\nimport Toolbar from \"../Toolbar\";\nimport { ViewerStateContext } from \"../ViewerStateProvider\";\nimport ChannelUpdater from \"./ChannelUpdater\";\n\nimport \"../../assets/styles/globals.css\";\nimport \"./styles.css\";\n\nconst { Sider, Content } = Layout;\n\nconst defaultVisibleControls: ControlVisibilityFlags = {\n  alphaMaskSlider: true,\n  autoRotateButton: true,\n  axisClipSliders: true,\n  brightnessSlider: true,\n  backgroundColorPicker: true,\n  boundingBoxColorPicker: true,\n  colorPresetsDropdown: true,\n  densitySlider: true,\n  levelsSliders: true,\n  interpolationControl: true,\n  saveSurfaceButtons: true,\n  fovCellSwitchControls: true,\n  viewModeRadioButtons: true,\n  resetCameraButton: true,\n  showAxesButton: true,\n  showBoundingBoxButton: true,\n  metadataViewer: true,\n};\n\nconst defaultProps: AppProps = {\n  // rawData has a \"dtype\" which is expected to be \"uint8\", a \"shape\":[c,z,y,x] and a \"buffer\" which is a DataView\n  rawData: undefined,\n  // rawDims is the volume dims that normally come from a json file\n  rawDims: undefined,\n\n  imageUrl: \"\",\n  parentImageUrl: \"\",\n\n  appHeight: \"100vh\",\n  visibleControls: defaultVisibleControls,\n  viewerSettings: getDefaultViewerState(),\n  cellId: \"\",\n  imageDownloadHref: \"\",\n  parentImageDownloadHref: \"\",\n  pixelSize: undefined,\n  canvasMargin: \"0 0 0 0\",\n  view3dRef: undefined,\n  showError: undefined,\n};\n\nconst CLIPPING_PANEL_ANIMATION_DURATION_MS = 300;\n\nconst setIndicatorPositions = (\n  view3d: View3d,\n  panelOpen: boolean,\n  hasTime: boolean,\n  hasScenes: boolean,\n  isMode3d: boolean\n): void => {\n  // The height of the clipping panel includes the button, but we're trying to put these elements next to the button\n  const CLIPPING_PANEL_BUTTON_HEIGHT = 40;\n  // Move scale bars this far to the left when showing time series, to make room for timestep indicator\n  const SCALE_BAR_TIME_SERIES_OFFSET = 120;\n\n  let axisY = AXIS_MARGIN_DEFAULT[1];\n  let [scaleBarX, scaleBarY] = SCALE_BAR_MARGIN_DEFAULT;\n  if (panelOpen) {\n    // If we have Time, Scene, X, Y, and Z sliders, the drawer will need to be a bit taller\n    let isTall = hasTime && hasScenes && isMode3d;\n    let clippingPanelFullHeight = isTall ? CLIPPING_PANEL_HEIGHT_TALL : CLIPPING_PANEL_HEIGHT_DEFAULT;\n    let clippingPanelHeight = clippingPanelFullHeight - CLIPPING_PANEL_BUTTON_HEIGHT;\n    // Move indicators up out of the way of the clipping panel\n    axisY += clippingPanelHeight;\n    scaleBarY += clippingPanelHeight;\n  }\n  if (hasTime) {\n    // Move scale bar left out of the way of timestep indicator\n    scaleBarX += SCALE_BAR_TIME_SERIES_OFFSET;\n    // Make sure the timestep indicator is showing\n    view3d.setShowTimestepIndicator(true);\n  }\n\n  view3d.setAxisPosition(AXIS_MARGIN_DEFAULT[0], axisY);\n  view3d.setTimestepIndicatorPosition(SCALE_BAR_MARGIN_DEFAULT[0], scaleBarY);\n  view3d.setScaleBarPosition(scaleBarX, scaleBarY);\n};\n\nconst App: React.FC<AppProps> = (props) => {\n  props = { ...defaultProps, ...props };\n\n  // State management /////////////////////////////////////////////////////////\n  const viewerState = useContext(ViewerStateContext).ref;\n  const {\n    imageType,\n    viewMode,\n    channelSettings,\n    changeChannelSetting,\n    applyColorPresets,\n    setSavedViewerChannelSettings,\n    getCurrentViewerChannelSettings,\n    // TODO: Show a loading spinner while any channels are awaiting reset.\n    getChannelsAwaitingReset,\n    onResetChannel,\n  } = viewerState.current;\n  const { onControlPanelToggle, onImageTitleChange, metadata, metadataFormatter } = props;\n\n  useMemo(() => {\n    if (props.viewerChannelSettings) {\n      setSavedViewerChannelSettings(props.viewerChannelSettings);\n    }\n  }, [props.viewerChannelSettings, setSavedViewerChannelSettings]);\n\n  const view3d = useConstructor(() => new View3d());\n  if (props.view3dRef !== undefined) {\n    props.view3dRef.current = view3d;\n  }\n\n  // Allows AppWrapper to pass in its own `useErrorAlert` callbacks, but still keeps error\n  // messaging when App is used standalone.\n  const [errorAlert, _showError] = useErrorAlert();\n  const showError = props.showError ?? _showError;\n\n  useEffect(() => {\n    // Get notifications of loading errors which occur after the initial load, e.g. on time change or new channel load\n    view3d.setLoadErrorHandler((_vol, e) => showError(e));\n    return () => view3d.setLoadErrorHandler(undefined);\n  }, [view3d, showError]);\n\n  const imageUrlRef = useRef<string | string[] | MultisceneUrls>(\"\");\n  const scenesRef = useRef<(string | string[])[] | [RawArrayLoaderOptions]>([]);\n  const { imageUrl, parentImageUrl, rawData, rawDims } = props;\n  const scenes = useMemo((): (string | string[])[] | [RawArrayLoaderOptions] => {\n    if (rawData && rawDims) {\n      return [{ data: rawData, metadata: rawDims }];\n    } else {\n      const showParentImage = imageType === ImageType.fullField && parentImageUrl !== undefined;\n      const path = showParentImage ? parentImageUrl : imageUrl;\n      // Don't reload if we're already looking at this image\n      if (isEqual(path, imageUrlRef.current)) {\n        return scenesRef.current;\n      }\n      imageUrlRef.current = path;\n\n      const result = (path as MultisceneUrls).scenes ?? [path];\n      scenesRef.current = result;\n      return result;\n    }\n  }, [imageUrl, parentImageUrl, rawData, rawDims, imageType]);\n\n  const maskChannelName = getCurrentViewerChannelSettings()?.maskChannelName;\n\n  // we need to keep track of channel ranges for remapping control points\n  const channelRangesRef = useRef<([number, number] | undefined)[]>([]);\n\n  const onCreateImage = useCallback(\n    (newImage: Volume): void => {\n      if (newImage === null) {\n        return;\n      }\n\n      const { channelSettings, resetIntensityPerVolume } = viewerState.current;\n      const { channelNames } = newImage;\n      channelRangesRef.current = channelNames.map((_, i) => {\n        const shouldKeepCurrentRange = !resetIntensityPerVolume;\n        return shouldKeepCurrentRange ? channelRangesRef.current[i] : undefined;\n      });\n\n      // If the image has channel color metadata, apply those colors now\n      const viewerChannelSettings = getCurrentViewerChannelSettings();\n      const channelColorMeta = newImage.imageInfo.channelColors?.map((color, index) => {\n        // Filter out channels that have colors in `viewerChannelSettings`\n        if (viewerChannelSettings === undefined) {\n          return color;\n        }\n        const settings = findFirstChannelMatch(channelNames[index], index, viewerChannelSettings);\n        if (settings?.color !== undefined) {\n          return undefined;\n        } else {\n          return color;\n        }\n      });\n      if (Array.isArray(channelColorMeta)) {\n        channelColorMeta.forEach((color, index) => {\n          if (Array.isArray(color) && index < channelNames.length) {\n            changeChannelSetting(index, { color });\n          }\n        });\n      }\n\n      view3d.addVolume(newImage, {\n        // Immediately passing down channel parameters isn't strictly necessary, but keeps things looking consistent on load\n        channels: newImage.channelNames.map((name, index) => {\n          // TODO do we really need to be searching by name here?\n          const ch = channelSettings.find((channel) => channel.name === name);\n          if (!ch) {\n            return {};\n          }\n          return {\n            enabled: ch.volumeEnabled,\n            isosurfaceEnabled: ch.isosurfaceEnabled,\n            isovalue: ch.isovalue,\n            isosurfaceOpacity: ch.opacity,\n            color: channelColorMeta?.[index] ?? ch.color,\n          };\n        }),\n      });\n\n      onImageTitleChange?.(newImage.imageInfo.imageInfo.name);\n      view3d.updateActiveChannels(newImage);\n    },\n    [view3d, viewerState, onImageTitleChange, changeChannelSetting, getCurrentViewerChannelSettings]\n  );\n\n  const onChannelLoaded = useCallback(\n    (image: Volume, channelIndex: number, isInitialLoad: boolean): void => {\n      // TODO this was once a search by name - is that still necessary or will the index always be correct?\n      const thisChannelSettings = channelSettings[channelIndex];\n      const {\n        getChannelsAwaitingResetOnLoad,\n        getCurrentViewerChannelSettings,\n        changeChannelSetting,\n        resetIntensityPerVolume,\n      } = viewerState.current;\n      const thisChannel = image.getChannel(channelIndex);\n      const dtype = thisChannel.dtype;\n      const noLut = !thisChannelSettings || !thisChannelSettings.controlPoints || !thisChannelSettings.ramp;\n      const oldRange = channelRangesRef.current[channelIndex];\n\n      const initializeToExistingRange = isInitialLoad && !resetIntensityPerVolume && oldRange !== undefined;\n      const initializeToDefaults = isInitialLoad && !initializeToExistingRange;\n\n      if (initializeToDefaults || noLut || getChannelsAwaitingResetOnLoad().has(channelIndex)) {\n        // This channel needs its LUT initialized\n        const { ramp, controlPoints } = initializeLut(image, channelIndex, getCurrentViewerChannelSettings());\n        const range = DTYPE_RANGE[thisChannel.dtype];\n\n        changeChannelSetting(channelIndex, {\n          controlPoints: controlPoints,\n          ramp: controlPointsToRamp(ramp),\n          // set the default range of the transfer function editor to cover the full range of the data type\n          plotMin: DTYPE_RANGE[dtype].min,\n          plotMax: DTYPE_RANGE[dtype].max,\n          isovalue: range.min + (range.max - range.min) / 2,\n        });\n      } else if (initializeToExistingRange) {\n        // This is an initial load, but we only want to remap the existing\n        // control points + ramp.\n        changeChannelSetting(channelIndex, {\n          controlPoints: remapControlPointsForChannel(thisChannelSettings.controlPoints, oldRange, thisChannel),\n          ramp: remapRampForChannel(thisChannelSettings.ramp, oldRange, thisChannel),\n        });\n      } else {\n        // This channel has already been initialized, but its LUT was just\n        // remapped (e.g. due to a time or scale level update) and we need to\n        // update the ramp and control points.\n        let controlPoints: ControlPoint[];\n        let ramp: [number, number];\n\n        // The LUT represents the currently visible control points or ramp, so\n        // we can use it directly for the visible setting and remap the other to\n        // thge new range.\n        if (thisChannelSettings.useControlPoints) {\n          controlPoints = thisChannel.lut.controlPoints;\n          ramp = remapRampForChannel(thisChannelSettings.ramp, oldRange, thisChannel);\n        } else {\n          ramp = controlPointsToRamp(thisChannel.lut.controlPoints);\n          controlPoints = remapControlPointsForChannel(thisChannelSettings.controlPoints, oldRange, thisChannel);\n        }\n\n        changeChannelSetting(channelIndex, {\n          controlPoints,\n          ramp,\n        });\n      }\n\n      // When new data loads in, expand the plot range to include the new data's\n      // full range as needed. (This keeps the range consistent when switching\n      // between multiple volumes.)\n      changeChannelSetting(channelIndex, {\n        plotMin: Math.min(thisChannel.rawMin, thisChannelSettings.plotMin),\n        plotMax: Math.max(thisChannel.rawMax, thisChannelSettings.plotMax),\n      });\n\n      // save the channel's new range for remapping next time\n      channelRangesRef.current[channelIndex] = [thisChannel.rawMin, thisChannel.rawMax];\n\n      view3d.updateLuts(image);\n      view3d.onVolumeData(image, [channelIndex]);\n\n      if (image.channelNames[channelIndex] === maskChannelName) {\n        view3d.setVolumeChannelAsMask(image, channelIndex);\n      }\n      if (image.isLoaded()) {\n        view3d.updateActiveChannels(image);\n      }\n    },\n    [view3d, channelSettings, maskChannelName, viewerState]\n  );\n\n  const onError = useCallback(\n    (error: unknown) => {\n      showError(error);\n      onImageTitleChange?.(undefined);\n    },\n    [showError, onImageTitleChange]\n  );\n\n  const volume = useVolume(scenes, {\n    onCreateImage,\n    onChannelLoaded,\n    onError,\n    maskChannelName,\n  });\n  const { image, setTime, setScene } = volume;\n\n  const hasRawImage = !!(props.rawData && props.rawDims);\n  const numScenes = hasRawImage ? 1 : ((props.imageUrl as MultisceneUrls).scenes?.length ?? 1);\n  const numSlices: PerAxis<number> = image?.imageInfo.volumeSize ?? { x: 1, y: 1, z: 1 };\n  const numSlicesLoaded: PerAxis<number> = image?.imageInfo.subregionSize ?? { x: 0, y: 0, z: 0 };\n  const numTimesteps = image?.imageInfo.times ?? 1;\n\n  // const [channelGroupedByType, setChannelGroupedByType] = useState<ChannelGrouping>({});\n  const [controlPanelClosed, setControlPanelClosed] = useState(() => window.innerWidth < CONTROL_PANEL_CLOSE_WIDTH);\n  // Only allow auto-close once while the screen is too narrow.\n  const [hasAutoClosedControlPanel, setHasAutoClosedControlPanel] = useState(false);\n\n  const [clippingPanelOpen, setClippingPanelOpen] = useState(true);\n  const clippingPanelOpenTimeout = useRef<number>(0);\n\n  // Imperative callbacks /////////////////////////////////////////////////////\n\n  const viewerSettings = viewerState.current;\n\n  const saveIsosurface = useCallback(\n    (channelIndex: number, type: IsosurfaceFormat): void => {\n      if (image) view3d.saveChannelIsosurface(image, channelIndex, type);\n    },\n    [image, view3d]\n  );\n\n  const saveScreenshot = useCallback((): void => {\n    view3d.capture((dataUrl: string) => {\n      const anchor = document.createElement(\"a\");\n      anchor.href = dataUrl;\n      anchor.download = \"screenshot.png\";\n      anchor.click();\n    });\n  }, [view3d]);\n\n  const getMetadata = useCallback((): MetadataRecord => {\n    let imageMetadata = image?.imageMetadata as MetadataRecord;\n    if (imageMetadata && metadataFormatter) {\n      imageMetadata = metadataFormatter(imageMetadata);\n    }\n\n    let sceneMeta: MetadataRecord | undefined;\n    if (Array.isArray(metadata)) {\n      // If metadata is an array, try to index it by scene\n      if (metadata.length >= numScenes) {\n        sceneMeta = metadata[viewerState.current.scene];\n      } else {\n        sceneMeta = metadata[0];\n      }\n    } else {\n      sceneMeta = metadata;\n    }\n\n    if (imageMetadata && Object.keys(imageMetadata).length > 0) {\n      return { Image: imageMetadata, ...sceneMeta };\n    } else {\n      return sceneMeta ?? {};\n    }\n  }, [metadata, metadataFormatter, image, numScenes, viewerState]);\n\n  useEffect((): void => {\n    const hasTime = numTimesteps > 1;\n    const hasScenes = numScenes > 1;\n    const mode3d = viewerSettings.viewMode === ViewMode.threeD;\n\n    setIndicatorPositions(view3d, clippingPanelOpen, hasTime, hasScenes, mode3d);\n\n    // Hide indicators while clipping panel is in motion - otherwise they pop to the right place prematurely\n    if (clippingPanelOpen) {\n      view3d.setShowScaleBar(false);\n      view3d.setShowTimestepIndicator(false);\n      view3d.setShowAxis(false);\n\n      window.clearTimeout(clippingPanelOpenTimeout.current);\n      clippingPanelOpenTimeout.current = window.setTimeout(() => {\n        view3d.setShowScaleBar(true);\n        view3d.setShowTimestepIndicator(true);\n        if (viewerSettings.showAxes) {\n          view3d.setShowAxis(true);\n        }\n      }, CLIPPING_PANEL_ANIMATION_DURATION_MS);\n    }\n  }, [view3d, numTimesteps, numScenes, viewerSettings.viewMode, viewerSettings.showAxes, clippingPanelOpen]);\n\n  // Effects //////////////////////////////////////////////////////////////////\n\n  // On mount\n  useEffect(() => {\n    const onResize = (): void => {\n      if (window.innerWidth < CONTROL_PANEL_CLOSE_WIDTH) {\n        if (!hasAutoClosedControlPanel) {\n          setControlPanelClosed(true);\n          setHasAutoClosedControlPanel(true);\n        }\n      } else {\n        setHasAutoClosedControlPanel(false);\n      }\n    };\n    const onResizeDebounced = debounce(onResize, 500);\n\n    window.addEventListener(\"resize\", onResizeDebounced);\n    return () => window.removeEventListener(\"resize\", onResizeDebounced);\n  }, [hasAutoClosedControlPanel]);\n\n  useEffect(\n    () => onControlPanelToggle && onControlPanelToggle(controlPanelClosed),\n    [controlPanelClosed, onControlPanelToggle]\n  );\n\n  useEffect(() => {\n    // delayed for the animation to finish\n    window.setTimeout(() => {\n      window.dispatchEvent(new Event(\"resize\"));\n    }, 200);\n  }, [controlPanelClosed]);\n\n  /** Custom effect hook for viewer updates that depend on `image`, so we don't have to repeatedly null-check it */\n  const useImageEffect: UseImageEffectType = (effect, deps) => {\n    useEffect(() => {\n      if (image && volume.imageLoadStatus === ImageLoadStatus.LOADED) {\n        return effect(image);\n      }\n      // react-hooks will check that `deps` match `effect`'s dependencies, so we can safely exclude `effect` here\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [...deps, image, volume.imageLoadStatus]);\n  };\n\n  // Effects to imperatively sync `viewerSettings` to `view3d`\n  useImageEffect(\n    (_currentImage) => {\n      view3d.setCameraMode(viewerSettings.viewMode);\n      view3d.resize(null);\n    },\n    [viewerSettings.viewMode, view3d]\n  );\n\n  useImageEffect(\n    (_currentImage) => {\n      if (viewerSettings.cameraState) {\n        view3d.setCameraState(viewerSettings.cameraState);\n      }\n    },\n    [viewerSettings.cameraState, view3d]\n  );\n\n  useImageEffect(\n    (_currentImage) => view3d.setAutoRotate(viewerSettings.autorotate),\n    [viewerSettings.autorotate, view3d]\n  );\n\n  useImageEffect((_currentImage) => view3d.setShowAxis(viewerSettings.showAxes), [viewerSettings.showAxes, view3d]);\n\n  useImageEffect(\n    (_currentImage) => view3d.setBackgroundColor(colorArrayToFloats(viewerSettings.backgroundColor)),\n    [viewerSettings.backgroundColor, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setBoundingBoxColor(currentImage, colorArrayToFloats(viewerSettings.boundingBoxColor)),\n    [viewerSettings.boundingBoxColor, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setShowBoundingBox(currentImage, viewerSettings.showBoundingBox),\n    [viewerSettings.showBoundingBox, view3d]\n  );\n\n  useImageEffect(\n    (image) => {\n      // Check whether any channels are marked to be reset and apply it.\n      const channelsAwaitingReset = getChannelsAwaitingReset();\n      for (let i = 0; i < channelSettings.length; i++) {\n        if (channelsAwaitingReset.has(i)) {\n          const { ramp, controlPoints } = initializeLut(image, i, getCurrentViewerChannelSettings());\n          changeChannelSetting(i, { controlPoints: controlPoints, ramp: controlPointsToRamp(ramp) });\n          onResetChannel(i);\n        }\n      }\n    },\n    [changeChannelSetting, channelSettings, getChannelsAwaitingReset, getCurrentViewerChannelSettings, onResetChannel]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      const renderMode = viewerSettings.renderMode;\n      view3d.setMaxProjectMode(currentImage, renderMode === RenderMode.maxProject);\n      view3d.setVolumeRenderMode(renderMode === RenderMode.pathTrace ? RENDERMODE_PATHTRACE : RENDERMODE_RAYMARCH);\n      view3d.updateActiveChannels(currentImage);\n    },\n    [viewerSettings.renderMode, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      view3d.updateMaskAlpha(currentImage, alphaSliderToImageValue(viewerSettings.maskAlpha));\n      view3d.updateActiveChannels(currentImage);\n    },\n    [viewerSettings.maskAlpha, view3d]\n  );\n\n  useImageEffect(\n    (_currentImage) => {\n      const brightness = brightnessSliderToImageValue(viewerSettings.brightness);\n      view3d.updateExposure(brightness);\n    },\n    [viewerSettings.brightness, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      const density = densitySliderToImageValue(viewerSettings.density);\n      view3d.updateDensity(currentImage, density);\n    },\n    [viewerSettings.density, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      const imageValues = gammaSliderToImageValues(viewerSettings.levels);\n      view3d.setGamma(currentImage, imageValues.min, imageValues.scale, imageValues.max);\n    },\n    [viewerSettings.levels, view3d]\n  );\n\n  // `time` and `scene` have their own special handlers via `volume`, since they both trigger loads\n  useEffect(() => setTime(view3d, viewerSettings.time), [view3d, viewerSettings.time, setTime]);\n  useEffect(() => setScene(viewerSettings.scene), [viewerSettings.scene, setScene]);\n\n  useImageEffect(\n    (currentImage) => view3d.setInterpolationEnabled(currentImage, viewerSettings.interpolationEnabled),\n    [viewerSettings.interpolationEnabled, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeTranslation(currentImage, props.transform?.translation || [0, 0, 0]),\n    [props.transform?.translation, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeRotation(currentImage, props.transform?.rotation || [0, 0, 0]),\n    [props.transform?.rotation, view3d]\n  );\n\n  const usePerAxisClippingUpdater = (\n    axis: AxisName,\n    [minval, maxval]: [number, number],\n    slice: number,\n    viewMode: ViewMode\n  ): void => {\n    useImageEffect(\n      // Logic to determine axis clipping range, for each of x,y,z,3d slider:\n      // if slider was same as active axis view mode:  [viewerSettings.slice[axis], viewerSettings.slice[axis] + 1.0/volumeSize[axis]]\n      // if in 3d mode: viewerSettings.region[axis]\n      // else: [0,1]\n      (currentImage) => {\n        let isOrthoAxis = false;\n        let axismin = 0.0;\n        let axismax = 1.0;\n        if (viewMode === ViewMode.threeD) {\n          axismin = minval;\n          axismax = maxval;\n          isOrthoAxis = false;\n        } else {\n          isOrthoAxis = activeAxisMap[viewMode] === axis;\n          const oneSlice = 1 / currentImage.imageInfo.volumeSize[axis];\n          axismin = isOrthoAxis ? slice : 0.0;\n          axismax = isOrthoAxis ? slice + oneSlice : 1.0;\n          if (axis === \"z\" && viewMode === ViewMode.xy) {\n            view3d.setZSlice(currentImage, Math.floor(slice * currentImage.imageInfo.volumeSize.z));\n          }\n        }\n        // view3d wants the coordinates in the -0.5 to 0.5 range\n        view3d.setAxisClip(currentImage, axis, axismin - 0.5, axismax - 0.5, isOrthoAxis);\n        view3d.setCameraMode(viewMode);\n        // TODO under some circumstances, this effect will trigger a load. Ideally, this would be reflected in the load\n        //   state managed by `useVolume`. This is complicated by the fact that the relevant methods (`setAxisClip` and\n        //   `setZSlice`) don't provide a channel load callback like other load-triggering methods (e.g. `setTime`).\n      },\n      [axis, minval, maxval, slice, viewMode]\n    );\n  };\n\n  usePerAxisClippingUpdater(\"x\", viewerSettings.region.x, viewerSettings.slice.x, viewMode);\n  usePerAxisClippingUpdater(\"y\", viewerSettings.region.y, viewerSettings.slice.y, viewMode);\n  usePerAxisClippingUpdater(\"z\", viewerSettings.region.z, viewerSettings.slice.z, viewMode);\n\n  // Rendering ////////////////////////////////////////////////////////////////\n\n  const visibleControls = useMemo(\n    (): ControlVisibilityFlags => ({ ...defaultVisibleControls, ...props.visibleControls }),\n    [props.visibleControls]\n  );\n  const pixelSize = useMemo(\n    (): [number, number, number] => (image ? image.imageInfo.physicalPixelSize.toArray() : [1, 1, 1]),\n    [image]\n  );\n  const resetCamera = useMemo(() => view3d.resetCamera.bind(view3d), [view3d]);\n\n  return (\n    <StyleProvider>\n      {errorAlert}\n      <Layout className=\"cell-viewer-app\" style={{ height: props.appHeight }}>\n        {channelSettings.map((channelState, index) => (\n          <ChannelUpdater\n            key={`${index}_${channelState.name}`}\n            {...{ channelState, index }}\n            view3d={view3d}\n            image={image}\n            version={volume.channelVersions[index]}\n          />\n        ))}\n        <Sider\n          className=\"control-panel-holder\"\n          collapsible={true}\n          defaultCollapsed={false}\n          collapsedWidth={50}\n          trigger={null}\n          collapsed={controlPanelClosed}\n          width={500}\n        >\n          <ControlPanel\n            visibleControls={visibleControls}\n            collapsed={controlPanelClosed}\n            // image state\n            imageName={image?.name}\n            hasImage={!!image}\n            pixelSize={pixelSize}\n            channelDataChannels={image?.channels}\n            channelGroupedByType={volume.channelGroupedByType}\n            // functions\n            setCollapsed={setControlPanelClosed}\n            saveIsosurface={saveIsosurface}\n            onApplyColorPresets={applyColorPresets}\n            viewerChannelSettings={props.viewerChannelSettings}\n            getMetadata={getMetadata}\n          />\n        </Sider>\n        <Layout className=\"cell-viewer-wrapper\" style={{ margin: props.canvasMargin }}>\n          <Content>\n            <Toolbar\n              fovDownloadHref={props.parentImageDownloadHref}\n              cellDownloadHref={props.imageDownloadHref}\n              hasParentImage={!!props.parentImageUrl}\n              hasCellId={!!props.cellId}\n              canPathTrace={view3d ? view3d.hasWebGL2() : false}\n              resetCamera={resetCamera}\n              downloadScreenshot={saveScreenshot}\n              visibleControls={visibleControls}\n            />\n            <CellViewerCanvasWrapper\n              view3d={view3d}\n              image={image}\n              loadingImage={volume.imageLoadStatus === ImageLoadStatus.REQUESTED}\n              numSlices={numSlices}\n              numSlicesLoaded={numSlicesLoaded}\n              numTimesteps={numTimesteps}\n              numScenes={numScenes}\n              playControls={volume.playControls}\n              playingAxis={volume.playingAxis}\n              appHeight={props.appHeight}\n              visibleControls={visibleControls}\n              clippingPanelOpen={clippingPanelOpen}\n              onClippingPanelOpenChange={setClippingPanelOpen}\n            />\n          </Content>\n        </Layout>\n      </Layout>\n    </StyleProvider>\n  );\n};\n\nexport default App;\n","type ImageValues = {\n  min: number;\n  max: number;\n  scale: number;\n};\n\nexport const gammaSliderToImageValues = (sliderValues: [number, number, number]): ImageValues => {\n  let min = Number(sliderValues[0]);\n  let mid = Number(sliderValues[1]);\n  let max = Number(sliderValues[2]);\n\n  if (mid > max || mid < min) {\n    mid = 0.5 * (min + max);\n  }\n  let div = 255;\n  min /= div;\n  max /= div;\n  mid /= div;\n  let diff = max - min;\n  let x = (mid - min) / diff;\n  let scale = 4 * x * x;\n  if ((mid - 0.5) * (mid - 0.5) < 0.0005) {\n    scale = 1.0;\n  }\n  return {\n    min,\n    max,\n    scale,\n  };\n};\n\n// Density and brightness were once overloaded for the two rendering modes in the volume viewer (raymarch & pathtrace).\n// Now both work the same, and the mapping from slider values to numbers in vole-core is relatively straightforward.\n// But the mapping can still be tweaked here in the future, should we want to.\n\n/** vole-core expects a value from 0..1 for density. */\nexport const densitySliderToImageValue = (sliderValue: number): number => sliderValue / 100.0;\n\n/** vole-core expects a value from 0..1 for brigness. */\nexport const brightnessSliderToImageValue = (sliderValue: number): number => sliderValue / 100.0;\n\n/** vole-core expects a value from 0..1 for alpha, and its scale is inverted from the app's slider. */\nexport const alphaSliderToImageValue = (sliderValue: number): number => 1 - sliderValue / 100.0;\n","import { Button } from \"antd\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\n// TODO: Make exports here for primary/tertiary buttons to abstract away\n// Ant button styling.\n\n// Enforce the primary type for behavior on hover.\nconst PrimaryButton = React.forwardRef<HTMLButtonElement, { children?: React.ReactNode }>((props, ref) => (\n  <Button {...props} ref={ref} type=\"primary\">\n    {props.children}\n  </Button>\n));\n// Used for debugging in React. Eslint complains if not set.\nPrimaryButton.displayName = \"PrimaryButton\";\n\n// Secondary button is outlined but turns solid on hover (uses primary button behavior).\nexport const SecondaryButton = styled(PrimaryButton)`\n  &&& {\n    background-color: var(--color-button-secondary-bg);\n    border: 1px solid var(--color-button-secondary-outline);\n    color: var(--color-button-secondary-text);\n  }\n` as typeof Button;\n","import { Button, Dropdown, MenuProps, Modal } from \"antd\";\nimport React, { ReactElement, useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { DropdownSVG } from \"../assets/icons\";\nimport { FlexColumnAlignCenter, FlexRowAlignCenter } from \"./LandingPage/utils\";\n\nimport { SecondaryButton } from \"./Buttons\";\n\n// Defined in webpack config\ndeclare const VOLEAPP_VERSION: string;\ndeclare const VOLECORE_VERSION: string;\n\nexport default function HelpDropdown(): ReactElement {\n  const [container, setContainer] = useState<HTMLDivElement | null>();\n  const containerRef = React.useRef<HTMLDivElement>(null);\n\n  const [showVersionModal, setShowVersionModal] = useState(false);\n\n  const items: MenuProps[\"items\"] = [\n    {\n      key: \"github\",\n      label: (\n        <Link to=\"https://github.com/allen-cell-animated/vole-app\" target=\"_blank\" rel=\"noreferrer noopener\">\n          Visit GitHub repository\n        </Link>\n      ),\n    },\n    {\n      key: \"github-issue\",\n      label: (\n        <Link\n          to=\"https://github.com/allen-cell-animated/vole-app/issues/new/choose\"\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n        >\n          Report issue via GitHub\n        </Link>\n      ),\n    },\n    {\n      key: \"forum\",\n      label: (\n        <Link to=\"https://forum.allencell.org/c/software-code/11\" target=\"_blank\" rel=\"noreferrer noopener\">\n          Allen Cell Discussion Forum\n        </Link>\n      ),\n    },\n    {\n      key: \"version\",\n      label: \"Version info\",\n      onClick: () => {\n        setShowVersionModal(true);\n      },\n    },\n  ];\n\n  // Use state update here to force a re-render so Dropdown is rendered with a valid `getContainer` callback.\n  // Otherwise, the `getContainer` callback will be undefined on the first render.\n  useEffect(() => {\n    setContainer(containerRef.current);\n  }, []);\n  const getContainer = container !== null ? () => container! : undefined;\n\n  const closeVersionModal = (): void => setShowVersionModal(false);\n\n  return (\n    <div ref={containerRef}>\n      <Dropdown menu={{ items: items }} getPopupContainer={getContainer} trigger={[\"click\"]}>\n        <SecondaryButton>\n          <FlexRowAlignCenter $gap={6}>\n            Help <DropdownSVG />\n          </FlexRowAlignCenter>\n        </SecondaryButton>\n      </Dropdown>\n      <Modal\n        open={showVersionModal}\n        title=\"Version info\"\n        getContainer={getContainer}\n        onCancel={() => setShowVersionModal(false)}\n        footer={<Button onClick={closeVersionModal}>Close</Button>}\n      >\n        <FlexColumnAlignCenter $gap={0}>\n          <p style={{ margin: 0 }}>Vol-E App v{VOLEAPP_VERSION}</p>\n          <p style={{ margin: 0 }}>Vol-E Core package v{VOLECORE_VERSION}</p>\n        </FlexColumnAlignCenter>\n      </Modal>\n    </div>\n  );\n}\n","import { useCallback, useMemo } from \"react\";\nimport { useLocalStorage } from \"usehooks-ts\";\n\n/** Key for local storage to read/write recently opened datasets */\nconst RECENT_DATASETS_STORAGE_KEY = \"WEBSITE_3D_CELL_VIEWER.recentDatasets\";\nconst MAX_RECENT_URLS = 100;\n\n// Label and URL are stored separately, so if a user provides an input URL (the label) that is transformed into an absolute\n// URL, we can check for duplicates using the absolute URL while still showing the user's input.\n// This is more relevant in nucmorph, where we're resolving filepaths to absolute URLs, but it's useful functionality to bake in\n// for future use.\n\nexport type RecentDataUrl = {\n  /** The absolute URL path, post any transformation or remapping. Stored for comparison between urls. */\n  url: string;\n  /** The user input that was used to load the data. */\n  label: string;\n};\n\n/**\n * Wrapper around locally-stored recent urls.\n * @returns an array containing the list of recent data urls and a function to add a new url to the list.\n */\nexport const useRecentDataUrls = (): [RecentDataUrl[], (newEntry: RecentDataUrl) => void] => {\n  const [storedRecentEntries, setRecentEntries] = useLocalStorage<RecentDataUrl[]>(RECENT_DATASETS_STORAGE_KEY, []);\n\n  // Sanitize/validate recent entries\n  let recentEntries: RecentDataUrl[] = useMemo(\n    () => storedRecentEntries.filter(({ url, label }) => typeof url === \"string\" && typeof label === \"string\"),\n    [storedRecentEntries]\n  );\n  if (recentEntries.length !== storedRecentEntries.length) {\n    setRecentEntries(recentEntries);\n  }\n\n  /** Adds a new URL entry (url + label) to the list of recent datasets. */\n  const addRecentEntry = useCallback(\n    (newEntry: RecentDataUrl): void => {\n      if (recentEntries === null) {\n        setRecentEntries([newEntry]);\n        return;\n      }\n\n      // Find matches by absolute URL and move to front of the list if a match exists.\n      const datasetIndex = recentEntries.findIndex(({ url }) => url === newEntry.url);\n      if (datasetIndex === -1) {\n        // New entry, add to front while maintaining max length\n        setRecentEntries([newEntry as RecentDataUrl, ...recentEntries.slice(0, MAX_RECENT_URLS - 1)]);\n      } else {\n        // Move to front; this also updates the label if it changed.\n        setRecentEntries([\n          newEntry as RecentDataUrl,\n          ...recentEntries.slice(0, datasetIndex),\n          ...recentEntries.slice(datasetIndex + 1),\n        ]);\n      }\n    },\n    [recentEntries, setRecentEntries]\n  );\n\n  return [recentEntries || [], addRecentEntry];\n};\n","import React, { ReactElement } from \"react\";\nimport styled, { css } from \"styled-components\";\n\n// Adapted from \"CSS-only middle truncation with ellipsis\"\n// by Mark Chitty https://codepen.io/markchitty/pen/RNZbRE\n\ntype MiddleTruncatedTextProps = {\n  text: string;\n  /** Minimum characters to show at the start of the text. 3 by default. */\n  startCharacters?: number;\n  /**\n   * Minimum characters to show at the end of the text. Hidden by start characters if the container\n   * does not have enough space. 35 by default.\n   */\n  endCharacters?: number;\n};\n\nconst defaultProps: Partial<MiddleTruncatedTextProps> = {\n  startCharacters: 3,\n  endCharacters: 35,\n};\n\nconst MiddleTruncatedTextContainer = styled.div<{ $startChars: number; $endChars: number }>`\n  display: flex;\n  flex-direction: row;\n  vertical-align: bottom;\n  white-space: nowrap;\n\n  ${(props) => {\n    // Determined experimentally. If this is too high, excess padding will appear to the right of\n    // the end text. If this is too low, the end text will be clipped.\n    const characterPxWidthToFontSizeRatio = 0.5;\n    return css`\n      --startWidth: calc(1em * ${props.$startChars + 3} * ${characterPxWidthToFontSizeRatio});\n      --endWidth: calc(1em * ${props.$endChars} * ${characterPxWidthToFontSizeRatio});\n\n      & span {\n        display: inline-block;\n        vertical-align: bottom;\n        white-space: nowrap;\n        overflow: hidden;\n      }\n\n      & span:first-child {\n        max-width: calc(100% - var(--endWidth));\n        min-width: var(--startWidth);\n        text-overflow: ellipsis;\n        overflow: hidden;\n      }\n\n      & span:last-child {\n        max-width: calc(100% - var(--startWidth));\n        direction: rtl;\n        z-index: 800;\n      }\n    `;\n  }}\n`;\n\n/**\n * Renders text that will be truncated with ellipses in the middle of the text if there isn't\n * enough space to show the full text. The number of characters shown at the start and end of the text are configurable.\n *\n * @example\n * ```\n * <MiddleTruncatedText text=\"This is a long text that will be truncated in the middle\" startCharacters={3} endCharacters={5} />\n * ```\n * can be rendered as any of the following depending on the available space:\n * - `This is a long text that will be truncated in the middle`\n * - `This is a long text that will ...iddle`\n * - `This is a long text...iddle`\n * - `Thi...iddle`\n * - `Thi...`\n */\nexport default function MiddleTruncatedText(inputProps: MiddleTruncatedTextProps): ReactElement {\n  const props = { ...defaultProps, ...inputProps } as Required<MiddleTruncatedTextProps>;\n\n  let startChars = Math.max(0, props.startCharacters);\n  let endChars = Math.max(0, props.endCharacters);\n  if (props.text.length <= startChars + endChars) {\n    endChars = props.text.length - startChars;\n  }\n\n  const splitIndex = Math.max(0, props.text.length - endChars);\n  const startText = props.text.slice(0, splitIndex);\n  const endText = props.text.slice(splitIndex);\n\n  // TODO: Text characters in endText can be partially clipped. Is there a way to prevent this from happening?\n\n  return (\n    <MiddleTruncatedTextContainer\n      $startChars={startChars}\n      $endChars={endChars}\n      aria-label={props.text}\n      title={props.text}\n    >\n      {\n        // The `$lrm;` is a non-printing character that indicates text punctuation should be rendered as left-to-right instead of rtl.\n        // It's included to prevent a visual bug where punctuation at the start (ex: !?_.:, etc.)\n        // of `endText` is rendered at the end instead. See https://en.wikipedia.org/wiki/Left-to-right_mark.\n        // (we are using rtl rendering so that the ellipses render on the left side of the text. )\n      }\n      <span>{startText}</span>\n      <span>&lrm;{endText}</span>\n    </MiddleTruncatedTextContainer>\n  );\n}\n","import { UploadOutlined } from \"@ant-design/icons\";\nimport { AutoComplete, Button, Modal } from \"antd\";\nimport Fuse from \"fuse.js\";\nimport React, { ReactElement, useMemo, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport { AppDataProps } from \"../../types\";\nimport { RecentDataUrl, useRecentDataUrls } from \"../../utils/react_utils\";\nimport { isValidUrl } from \"../../utils/urls\";\nimport { FlexRow } from \"../LandingPage/utils\";\n\nimport MiddleTruncatedText from \"../MiddleTruncatedText\";\n\nconst MAX_RECENT_URLS_TO_DISPLAY = 20;\n\ntype LoadModalProps = {\n  onLoad: (appProps: AppDataProps) => void;\n};\n\nconst ModalContainer = styled.div`\n  // Get the dropdown to size itself based on the webpage width, but resize itself to match the\n  // input area (~100vw - 100px of padding) when the webpage is very narrow\n  .ant-select-dropdown {\n    // TODO: Size to max-content so there isn't extra dead space past the end of the current items.\n    // Setting width to max-content directly causes the dropdown to collapse to a width of\n    // 0 pixels when more than 8 items are present and scrolling becomes enabled.\n    width: 100% !important;\n    max-width: calc(max(50vw, min(400px, 100vw - 100px)));\n  }\n`;\n\nexport default function LoadModal(props: LoadModalProps): ReactElement {\n  const [showModal, _setShowModal] = useState(false);\n  const [urlInput, setUrlInput] = useState(\"\");\n  const [errorText, setErrorText] = useState<string>(\"\");\n\n  const [recentDataUrls, addRecentDataUrl] = useRecentDataUrls();\n\n  const modalContainerRef = useRef<HTMLDivElement>(null);\n\n  const setShowModal = (show: boolean): void => {\n    if (show) {\n      setUrlInput(\"\");\n      setErrorText(\"\");\n    }\n    _setShowModal(show);\n  };\n\n  const onClickLoad = (): void => {\n    // TODO: Handle multiple URLs?\n    // TODO: Do any transformation of URLs here? Currently just using the labels directly.\n    if (!isValidUrl(urlInput)) {\n      setErrorText(\"Please enter a valid URL.\");\n      return;\n    }\n\n    const appProps: AppDataProps = {\n      imageUrl: urlInput,\n      imageDownloadHref: urlInput,\n      cellId: \"1\",\n      parentImageUrl: \"\",\n      parentImageDownloadHref: \"\",\n      // Enable first three channels by default\n      viewerChannelSettings: {\n        groups: [\n          {\n            name: \"Channels\",\n            channels: [\n              { match: [0, 1, 2], enabled: true },\n              { match: \"(.+)\", enabled: false },\n            ],\n          },\n        ],\n      },\n    };\n    props.onLoad(appProps);\n    addRecentDataUrl({ url: urlInput, label: urlInput });\n    setShowModal(false);\n  };\n\n  // Set up fuse for fuzzy searching on the labels of recent datasets\n  const fuse = useMemo(() => {\n    return new Fuse(recentDataUrls, {\n      keys: [\"label\"],\n      isCaseSensitive: false,\n      shouldSort: true, // sorts by match score\n      ignoreLocation: true, // search more than first 60 characters\n      findAllMatches: true, // return all matches\n    });\n  }, [recentDataUrls]);\n\n  // This search could be done using a transition if needed, but since there is a max of 100 urls,\n  // performance hits should be minimal.\n  const autoCompleteOptions: { label: React.ReactNode; value: string }[] = useMemo(() => {\n    let filteredItems: RecentDataUrl[] = [];\n    if (urlInput === \"\") {\n      // Show first 20 recent data urls\n      filteredItems = recentDataUrls.slice(0, MAX_RECENT_URLS_TO_DISPLAY);\n    } else {\n      // Show first 20 search results\n      filteredItems = fuse\n        .search(urlInput)\n        .slice(0, MAX_RECENT_URLS_TO_DISPLAY)\n        .map((option) => option.item);\n    }\n    return filteredItems.map((item) => {\n      return {\n        label: <MiddleTruncatedText text={item.label} />,\n        value: item.url,\n      };\n    });\n  }, [urlInput, fuse, recentDataUrls]);\n\n  const getAutoCompletePopupContainer = modalContainerRef.current ? () => modalContainerRef.current! : undefined;\n\n  return (\n    <ModalContainer ref={modalContainerRef}>\n      <Button type=\"link\" onClick={() => setShowModal(!showModal)}>\n        <UploadOutlined />\n        Load\n      </Button>\n      <Modal\n        open={showModal}\n        title={\"Load\"}\n        onCancel={() => setShowModal(false)}\n        getContainer={modalContainerRef.current || undefined}\n        okButtonProps={{}}\n        footer={\n          <Button type=\"default\" onClick={() => setShowModal(false)}>\n            Cancel\n          </Button>\n        }\n        destroyOnClose={true}\n      >\n        <p style={{ fontSize: \"16px\" }}>Provide the URL to load your OME-Zarr or OME-TIFF* data.</p>\n        <p style={{ fontSize: \"12px\" }}>\n          <i>*Note: this tool is intended for OME-Zarr use. Large {\"(> 100 MB)\"} OME-TIFF files are not supported.</i>\n        </p>\n        <FlexRow $gap={6}>\n          <AutoComplete\n            value={urlInput}\n            onChange={(value) => setUrlInput(value)}\n            onSelect={setUrlInput}\n            style={{ width: \"100%\" }}\n            allowClear={true}\n            options={autoCompleteOptions}\n            getPopupContainer={getAutoCompletePopupContainer}\n            placeholder=\"Enter a URL...\"\n            autoFocus={true}\n          ></AutoComplete>\n          <Button type=\"primary\" onClick={onClickLoad}>\n            Load\n          </Button>\n        </FlexRow>\n        {errorText !== \"\" && <p style={{ color: \"var(--color-text-error)\" }}>{errorText}</p>}\n      </Modal>\n    </ModalContainer>\n  );\n}\n"],"names":["IssueLink","_ref","bug","children","React","href","concat","target","rel","UNKNOWN_ERROR_DESCRIPTION","ERROR_TYPE_DESCRIPTIONS","_defineProperty","VolumeLoadErrorType","UNKNOWN","NOT_FOUND","TOO_LARGE","LOAD_DATA_FAILED","INVALID_METADATA","INVALID_MULTI_SOURCE_ZARR","getErrorTitle","error","_error$toString","Error","toString","call","ErrorAlert","_ref2","errors","_ref2$firstErrorCount","firstErrorCount","afterClose","onSkipError","_React$useState2","_slicedToArray","showDetails","setShowDetails","_React$useState4","errorsSeenCount","setErrorsSeenCount","Array","isArray","errorMessage","Button","type","onClick","style","display","undefined","_ERROR_TYPE_DESCRIPTI2","getErrorDescription","skipErrorButton","length","count","RightOutlined","Alert","showIcon","className","message","closable","action","useErrorAlert","_React$useState6","errorList","setErrorList","seenErrors","useConstructor","Map","_React$useState8","errorCounts","setErrorCounts","addError","_seenErrors$get","console","errorTitle","errorSeenCount","get","prev","_toConsumableArray","set","slice","errCount","ResetStateProvider","viewerStateRef","_classCallCheck","this","ref","savedViewerState","channelsToReset","Set","channelsToResetOnLoad","savedViewerChannelSettings","useDefaultViewerChannelSettings","resetToSavedViewerState","bind","resetToDefaultViewerState","resetToState","setSavedViewerState","setSavedViewerChannelSettings","getChannelsAwaitingReset","getChannelsAwaitingResetOnLoad","onResetChannel","getCurrentViewerChannelSettings","key","value","state","settings","channelIndex","getDefaultViewerChannelSettings","newState","newChannelStates","_this$ref$current","current","changeViewerSetting","setChannelSettings","channelSettings","viewMode","time","isInDifferentViewMode","ViewMode","xy","isAtDifferentTime","isAtDifferentZSlice","isEqual","z","willNeedResetOnLoad","overrideViewerState","overrideChannelStates","keys","enabledChannelsAndResetState","getEnabledChannelIndices","_step","_iterator","_createForOfIteratorHelper","s","n","done","err","e","f","_this","newViewerState","_objectSpread","getDefaultViewerState","cameraState","getDefaultCameraState","threeD","newChannelSettings","map","_","index","initializeOneChannelSetting","name","getDefaultChannelColor","plotMin","plotMax","defaultViewerState","defaultChannelStates","getDefaultChannelState","i","Math","min","volumeEnabled","isObject","val","_typeof","VIEWER_SETTINGS_CHANGE_HANDLERS","prevSettings","switchToVolumetric","renderMode","RenderMode","pathTrace","volumetric","autorotate","viewerSettingsReducer","viewerSettings","changeHandler","setting","ChannelSettingActionType","channelSettingsReducer","Init","ArrayUpdate","channel","idx","includes","newSettings","nullfn","DEFAULT_VIEWER_CONTEXT","changeChannelSetting","applyColorPresets","ALL_VIEWER_STATE_KEYS","Object","DEFAULT_VIEWER_CONTEXT_OUTER","ViewerStateContext","connectToViewerState","component","MemoedComponent","ConnectedComponent","props","viewerState","useContext","mergedProps","displayName","_useReducer2","useReducer","viewerDispatch","_useReducer4","channelDispatch","useRef","resetProvider","useEffect","useCallback","UniformUpdate","channels","prevViewerSettingsPropsRef","_i","_arr","context","useMemo","Provider","CONTROL_PANEL_CLOSE_WIDTH","CLIPPING_PANEL_HEIGHT_DEFAULT","CLIPPING_PANEL_HEIGHT_TALL","BACKGROUND_COLOR_DEFAULT","BOUNDING_BOX_COLOR_DEFAULT","AXIS_MARGIN_DEFAULT","SCALE_BAR_MARGIN_DEFAULT","LUT_MIN_PERCENTILE","LUT_MAX_PERCENTILE","ISOSURFACE_OPACITY_SLIDER_MAX","LEVELS_SLIDER_DEFAULT","OTHER_CHANNEL_KEY","SINGLE_GROUP_CHANNEL_KEY","TFEDITOR_DEFAULT_COLOR","TFEDITOR_MAX_BIN","CACHE_MAX_SIZE","QUEUE_MAX_SIZE","QUEUE_MAX_LOW_PRIORITY_SIZE","AXIS_TO_LOADER_PRIORITY","t","PrefetchDirection","T_PLUS","Z_PLUS","y","Y_PLUS","x","X_PLUS","DTYPE_RANGE","int8","pow","max","int16","int32","uint8","uint16","uint32","float32","float64","PRESET_COLORS_0","PRESET_COLOR_MAP","freeze","colors","viewModeToDefaultCameraPosition","xz","yz","viewModeToDefaultCameraUp","arguments","position","up","fov","orthoScale","groups","match","enabled","imageType","ImageType","segmentedCell","showAxes","showBoundingBox","backgroundColor","boundingBoxColor","maskAlpha","brightness","density","levels","interpolationEnabled","region","scene","resetIntensityPerVolume","INIT_COLORS","isosurfaceEnabled","colorizeEnabled","colorizeAlpha","isovalue","opacity","color","useControlPoints","ramp","controlPoints","useRefWithSetter","setter","init","wrappedSetter","newValue","constructor","removeUndefinedProperties","obj","result","removeMatchingProperties","_createClass","FirebaseRequest","firestore","docPath","doc","collection","then","snapShot","datasets","forEach","host","metadata","data","location","hostname","production","push","id","collectionRef","manifestDoc","getManifest","featuresDataPath","thumbnailRoot","downloadRoot","volumeViewerDataRoot","featuresDisplayOrder","cellLineDataPath","fileInfoPath","featuresDataOrder","featureDefsPath","albumPath","cellId","getDoc","CellId","FOVId","cellIds","Promise","all","datasetId","clamp","_regeneratorRuntime","r","prototype","hasOwnProperty","o","defineProperty","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","arg","h","l","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","_invoke","AsyncIterator","invoke","resolve","__await","callInvokeWithMethodAndArg","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","isGeneratorFunction","mark","setPrototypeOf","__proto__","awrap","async","reverse","pop","charAt","stop","rval","handle","complete","finish","delegateYield","ownKeys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","apply","getOwnPropertyDescriptors","defineProperties","asyncGeneratorStep","_asyncToGenerator","_next","_throw","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_n","F","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_nonIterableSpread","test","_defineProperties","_toPropertyKey","toPrimitive","String","_toPrimitive","ENCODED_COMMA_REGEX","ENCODED_COLON_REGEX","DEFAULT_CONTROL_POINT_COLOR","DEFAULT_CONTROL_POINT_COLOR_CODE","CHANNEL_STATE_KEY_REGEX","LUT_REGEX","RAMP_REGEX","SLICE_REGEX","REGION_REGEX","HEX_COLOR_REGEX","RegExp","NUMERIC_REGEX","CONTROL_POINT_REGEX","source","HEX_COLOR_STR_REGEX","LEGACY_CONTROL_POINTS_REGEX","CONTROL_POINTS_REGEX","ViewerStateKeys","CameraTransformKeys","ViewerChannelSettingKeys","Color","Colorize","ColorizeAlpha","IsosurfaceAlpha","Lut","ControlPoints","ControlPointsEnabled","Ramp","VolumeEnabled","SurfaceEnabled","IsosurfaceValue","_ViewerStateKeys$View","View","_ViewerStateKeys$Mode","Mode","_ViewerStateKeys$Mask","Mask","_ViewerStateKeys$Imag","Image","_ViewerStateKeys$Axes","Axes","_ViewerStateKeys$Boun","BoundingBox","_ViewerStateKeys$Boun2","BoundingBoxColor","_ViewerStateKeys$Back","BackgroundColor","_ViewerStateKeys$Auto","Autorotate","_ViewerStateKeys$Brig","Brightness","_ViewerStateKeys$Dens","Density","_ViewerStateKeys$Leve","Levels","_ViewerStateKeys$Inte","Interpolation","_ViewerStateKeys$Regi","Region","_ViewerStateKeys$Slic","Slice","_ViewerStateKeys$Time","Time","_ViewerStateKeys$Scen","Scene","_ViewerStateKeys$Came","CameraState","_ViewerStateKeys$Rese","ResetIntensityPerVolume","ViewerStateParams","DataParams","DeprecatedParams","allowedParamKeys","isParamKey","indexOf","isChannelKey","getAllowedParams","searchParams","entries","_step$value","decodeURL","url","decodedUrl","decodeURIComponent","endsWith","tryDecodeURLList","delim","_step2","urls","split","_iterator2","URL","_e","parseKeyValueList","_step3","_iterator3","pair","splitIndex","trim","objectToKeyValueList","keyValuePairs","escapedValue","encodeURIComponent","replace","join","parseStringFloat","number","Number","parseFloat","parseStringInt","parseInt","parseStringEnum","enumValues","defaultValue","parseStringBoolean","parseHexColorAsColorArray","hexColor","colorArrayToHex","padStart","toLowerCase","parseStringSlice","_region$split$map2","parseThreeNumberArray","stringArr","options","_options$min","_options$max","_options$separator","NEGATIVE_INFINITY","POSITIVE_INFINITY","separator","_stringArr$split$map2","parseStringRegion","_region$split$map3","axis","_axis$split$map2","_region$split$map4","formatFloat","maxPrecision","isInteger","toPrecision","perAxisToArray","perAxis","serializeBoolean","parseCameraState","cameraSettings","parsedCameraSettings","Position","Target","Up","OrthoScale","Infinity","Fov","deserializeViewerState","params","view","viewParamToViewMode","Z","Y","X","toUpperCase","parseDeprecatedChannelSettings","ch","initialChannelSettings","channelsOn","numstr","luts","warn","parseChannelSettings","channelIndexToSettings","channelSetting","jsonState","surfaceEnabled","surfaceOpacity","controlPointsEnabled","col","lut","_jsonState$ViewerChan2","rmp","_jsonState$ViewerChan4","cp","reduce","acc","_val","array","_parseStringFloat","_parseStringFloat2","_parseHexColorAsColor","_cp","sort","b","parseControlPoints","deserializeViewerChannelSetting","size","loadDataset","_x","_x2","_x3","_loadDataset","_callee","dataset","db","args","datasetMeta","_iterator4","_step4","innerDatasets","names","matchingName","datasetData","baseUrl","fileInfo","_context","getAvailableDatasets","find","t0","selectDataset","manifest","imageDownloadHref","getFileInfoByCellId","imageUrl","volumeviewerPath","parentImageUrl","fovVolumeviewerPath","loadFromManifest","_x4","_loadFromManifest","_callee2","manifestUrl","response","manifestJson","scenes","_context2","fetch","ok","status","statusText","json","t1","arr","every","item","isStringArray","meta","parseViewerUrlParams","_x5","_x6","_parseViewerUrlParams","_callee3","urlSearchParams","deprecatedChannelSettings","_yield$loadFromManife","manifestScenes","manifestMetadata","_localStorage$getItem","_tryDecodeURLList","getFromStorage","urlParam","sceneUrls","metadataJson","firstScene","firstUrl","imageUrls","datasetArgs","_context3","viewerChannelSettings","localStorage","getItem","_tryDecodeURLList2","JSON","parse","parentImageDownloadHref","serializeViewerUrlParams","_state$channelSetting","removeDefaults","_state$maskAlpha","_state$brightness","_state$density","_state$levels","_state$time","_state$scene","_result","cameraString","serializeCameraState","viewModeToViewParam","serializeViewerState","channelParams","_channelSetting$isova","_channelSetting$opaci","_channelSetting$color","_channelSetting$ramp","serializeViewerChannelSetting","matchChannel","channelName","findFirstChannelMatchOfGroup","findFirstChannelMatch","getDisplayName","makeChannelIndexGrouping","grouping","channelsMatched","_loop","groupMatch","remainderGroupName","currentStates","newStates","enabledChannels","defaultColor","_initSettings$enabled","_initSettings$surface","_initSettings$coloriz","_initSettings$coloriz2","_initSettings$isovalu","_initSettings$surface2","_colorHexToArray","_initSettings$color","_initSettings$control","_initSettings$control2","_initSettings$ramp","_findFirstChannelMatc","hex","defaultChannelState","initSettings","exec","activeAxisMap","colorObjectToArray","colorArrayToObject","colorArrayToFloats","colorArrayToString","parseLutValue","histogram","firstChar","parsedValue","substring","maxBin","findBinOfPercentile","findFractionalBinOfValue","initializeLut","aimg","_parseLutFromSettings","visibleLut","getHistogram","defaultLut","hmin","hmax","createFromMinMax","getDefaultLut","channelNames","lutValues","findAutoIJBins","isFinite","sortedLutValues","createFromControlPoints","parseLutFromSettings","rampToControlPoints","setLut","controlPointsToRamp","remapControlPointsForChannel","oldRange","_ref3","rawMin","rawMax","remapControlPoints","remapRampForChannel","PlayControls","_this$onPlayingAxisCh","playingAxis","onPlayingAxisChanged","_this$getVolumeIsLoad","playHolding","stepAxis","getVolumeIsLoaded","playTimeoutId","window","setTimeout","playStep","playWaitingForLoad","willResume","clearTimeout","setPlayingAxis","pause","SceneStore","paths","loaders","fill","_getLoader","loader","path","currentScene","rawArrayOptions","fileType","VolumeFileFormat","DATA","onOpen","createLoader","syncMultichannelLoading","syncChannels","setPrefetchPriority","prefetchPriority","_loadScene","image","loadSpec","onChannelLoaded","spec","getLoader","loadSpecRequired","createImageInfo","imageInfo","loadVolumeData","_createVolume","createVolume","_x7","_x8","sync","currentLoader","priority","ImageLoadStatus","useEffectEventRef","callback","callbackRef","scenePaths","onErrorRef","onError","onChannelLoadedRef","onCreateImageRef","onCreateImage","maskChannelName","_useState2","useState","setImage","loadContext","VolumeLoaderContext","sceneLoader","playControls","_useState4","isPlaying","_image$imageInfo","volumeSize","subregionSize","shouldDownlevel","updateRequiredData","scaleLevelBias","_useState6","channelVersions","_setChannelVersions","_useRefWithSetter2","channelVersionsRef","setChannelVersions","_useState8","loadThrewError","setLoadThrewError","inInitialLoadRef","imageLoadStatus","ERROR","_channelVersions$redu","version","allLoaded","noneLoaded","loaded","_channelVersions$redu2","REQUESTED","LOADED","LOADING","setIsLoading","_onErrorRef$current","_useState10","channelGroupedByType","setChannelGroupedByType","onChannelDataLoaded","_onChannelLoadedRef$c","isInitialLoad","newVersions","isLoaded","onImageLoaded","_viewerStateRef$curre","setChannelStateForNewImage","_channelSettings$idx","openImage","_onCreateImageRef$cur","_getCurrentViewerChan","_viewerStateRef$curre2","requiredLoadSpec","requiredChannelsToLoad","maskChannelIndex","LoadSpec","_viewerStateRef$curre3","times","subregion","Box3","Vector3","loadScene","setTime","view3d","setScene","_ref$step","step","_ref$precision","precision","_ref$min","_ref$max","MAX_SAFE_INTEGER","_ref$disabled","disabled","_ref$className","onChange","hasFocus","_setHasFocus","hasFocusRef","setHasFocus","textContent","setTextContent","inputRef","roundToPrecision","round","shouldChange","displayedValue","changeByStep","_inputRef$current","focus","fullClassName","onKeyDown","event","preventDefault","_inputRef$current2","blur","autoComplete","role","inputStr","inputNum","handleTyping","onFocus","onBlur","CaretUpOutlined","CaretDownOutlined","MemoedNouislider","Nouislider","_prevProps","noUpdate","setNoUpdate","wrapEventHandler","shouldNotUpdate","handler","onStart","onEnd","AXES","SliderRow","label","vals","_ref$valsReadout","valsReadout","onSlide","_ref$onChange","isRange","wrappedOnSlide","wrappedOnChange","SmarterSlider","connect","range","start","margin","behaviour","pips","mode","format","to","NumericInput","PlaySliderRow","valReadout","setValReadout","sliderHeld","setSliderHeld","wrappedSetValReadout","_ref4","wrappedOnStart","wrappedOnEnd","updateWhileSliding","Tooltip","placement","title","trigger","onTogglePlayback","playing","icon","PauseOutlined","CaretRightOutlined","activeAxis","pauseOnInput","numSlices","numSlicesLoaded","handlePlayPause","willPlay","play","slices","updateSlice","startHold","endHold","minval","maxval","updateRegion","numTimesteps","updateTime","numScenes","_ref6","axes","_extends","xmlns","width","height","viewBox","cx","cy","boundingBox","camera","closePanel","download","dropdownArrow","preferences","resetView","turnTable","STYLE","fontSize","newProps","Icon","ICONS","openProp","open","onOpenChange","openState","setOpenState","toggleDrawer","optionsButton","ViewerIcon","Drawer","getContainer","mask","view3dviewerRef","appendChild","getDOMElement","spinner","noImageText","appHeight","visibleControls","clippingPanelTall","STYLES","viewer","BottomPanel","clippingPanelOpen","onClippingPanelOpenChange","axisClipSliders","AxisClipSliders","loadingImage","noImage","LoadingOutlined","zIndex","removeAllVolumes","overflow","top","left","bottom","right","justifyContent","alignItems","DEFAULT_COLOR","isOpen","setIsOpen","openAboveSwatch","setOpenAboveSwatch","currentColor","setCurrentColor","swatchRef","popoverDirectionStyle","swatch","swatchRect","getBoundingClientRect","noRoomBelowSwatch","innerHeight","background","ele","popover","cover","SketchPicker","_props$onColorChange","rgb","onColorChange","onChangeComplete","_props$onColorChangeC","onColorChangeComplete","disableAlpha","borderRadius","border","cursor","verticalAlign","INTEGER_FORMATTER","_props$min","hideSlider","tooltips","formatInteger","onUpdate","TfEditorRampSliderHandle","TF_GENERATORS","autoXF","histo","_histo$findAutoMinMax2","findAutoMinMax","auto2XF","_histo$findAutoIJBins2","auto98XF","bestFitXF","_histo$findBestFitBin2","findBestFitBins","resetXF","_histo","createFullRange","sliderHandleSymbol","draw","sqrt","triangleHeight","halfWidth","moveTo","lineTo","closePath","binToAbsolute","getValueFromBinIndex","absoluteToBin","controlPointToAbsolute","coverRangeWithPoint","point","createPointOnRangeBoundary","outOfRangePt","inRangePt","rangeRatio","ControlPointGradientDef","gradientUnits","spreadMethod","x2","offset","stopColor","stopOpacity","numberFormatter","innerWidth","selectedPointIdx","setSelectedPointIdx","draggedPointIdx","_setDraggedPointIdx","_setCPs","setRamp","controlPointsRef","setControlPoints","_useRefWithSetter4","draggedPointIdxRef","setDraggedPointIdx","colorPickerPosition","setColorPickerPosition","lastColorRef","svgRef","channelData","typeRange","dtype","xScale","d3","domain","plotMinU8","plotMaxU8","yScale","mouseEventToControlPointValues","_svgRef$current$getBo","_svgRef$current","svgRect","invert","clientX","clientY","handleDragEnd","currentTarget","releasePointerCapture","pointerId","handleControlPointContextMenu","cpRect","xPosition","yPosition","controlPointsToRender","points","firstPoint","lastPoint","unshift","outOfRangePoint","shift","fitControlPointsToRange","areaPath","_areaGenerator","y0","y1","curve","areaGenerator","sliderHandlePath","_d3$symbol$type$size","xAxisRef","el","ticks","_xScale$domain2","tickValues","tickPadding","yAxisRef","histogramRef","numBins","getNumBins","_getHistogramBinLengt","binLengths","binLength","getBin","getHistogramBinLengths","ceil","end","floor","binLengthsToRender","barWidth","binScale","base","selectAll","attr","_len","len","applyTFGenerator","generator","createTFGeneratorButton","description","controlPointCircles","onPointerDown","onContextMenu","splice","viewerModeString","lastValidLevel","levelMin","levelMax","isLoadingData","Checkbox","checked","marginLeft","InputNumber","formatter","controls","abs","newControlPoints","button","_mouseEventToControlP2","setPointerCapture","nativeEvent","onPointerMove","buttons","stopPropagation","_mouseEventToControlP4","draggedIdx","draggedPoint","bisector","idxLeft","idxRight","numPointsToRemove","newIdx","dragControlPoint","Min","dragRampSlider","onPointerUp","transform","strokeDasharray","strokeWidth","Max","saveIsosurface","channelState","controlsOpen","setControlsOpen","changeSettingForThisChannel","visibilityControls","rowClass","List","Item","Meta","avatar","ColorPicker","newRGB","_oldRGB","TfEditor","channelDataForChannel","toFixed","_ref5","fontStyle","indeterminate","checkedList","allOptions","checkAll","channelDataChannels","filterFunc","createCheckboxHandler","channelArray","showVolumes","showSurfaces","renderVisibilityControls","volChecked","isoChecked","SharedCheckBox","flex","renderChannelRow","thisChannelSettings","ChannelsWidgetRow","firstKey","rows","itemLayout","dataSource","renderItem","extra","Collapse","bordered","defaultActiveKey","items","collapsible","ColorPickerRow","colorPickerRow","colorPicker","padding","borderBottom","marginRight","backgroundColorPicker","boundingBoxColorPicker","createSliderRow","propKey","_strValues","_handle","selectValue","showControls","paddingTop","paddingBottom","alphaMaskSlider","brightnessSlider","densitySlider","levelsSliders","interpolationControl","isCategory","entry","MetadataCategory","collapsed","setCollapsed","collapsedClass","colSpan","MetadataTable","topLevel","metadataKeys","metadataIsArray","metadataValue","cats","sortCategoriesFirst","ControlTab","ControlTabNames","Channels","Advanced","Metadata","showCustomize","dropDownMenuProps","tab","_setTab","_viewerState$current","controlPanelContainerRef","getDropdownContainer","hasImage","renderTab","thisTab","metadataViewer","colorPresetsDropdown","preset","onApplyColorPresets","Dropdown","menu","getPopupContainer","flexDirection","gap","ChannelsWidget","GlobalVolumeControls","imageName","pixelSize","CustomizeWidget","Flex","vertical","MetadataViewer","getMetadata","fovDownloadHref","cellDownloadHref","hasFov","viewModes","Radio","onViewModeChange","visuallyHiddenStyle","clip","whiteSpace","borderWidth","containerRef","barRef","leftRef","rightRef","centerRef","scrollMode","setScrollMode","showScrollBtnLeft","setScrollBtnLeft","showScrollBtnRight","setScrollBtnRight","checkScrollBtnVisible","barEl","scrollLeft","scrollWidth","clientWidth","checkSize","debounce","leftRect","centerRect","rightRect","addEventListener","removeEventListener","scrollX","amount","classForToggleBtn","active","twoDMode","renderGroup1","viewModeRadioButtons","resetCameraButton","autoRotateButton","renderGroup4","showAxesButton","showBoundingBoxButton","axesToggleTitle","boundingBoxToggleTitle","turntableToggleTitle","onWheel","deltaY","onScroll","ReloadOutlined","ViewModeRadioButtons","newMode","resetCamera","fovCellSwitchControls","hasCellId","hasParentImage","fullField","Select","popupClassName","Option","canPathTrace","maxProject","DownloadButton","downloadScreenshot","useImageEffect","effect","deps","setVolumeChannelEnabled","updateLuts","setVolumeChannelOptions","currentImage","isosurfaceOpacity","gradient","controlPointsToLut","createLabelColors","setColorPalette","setColorPaletteAlpha","Sider","Layout","Content","defaultVisibleControls","saveSurfaceButtons","defaultProps","rawData","rawDims","canvasMargin","view3dRef","showError","_props$showError","_scenes$length","_scenes2","_image$imageInfo$volu","_image$imageInfo$subr","_image$imageInfo$time","_props$transform2","_props$transform4","_props","onControlPanelToggle","onImageTitleChange","metadataFormatter","View3d","_useErrorAlert2","errorAlert","_showError","setLoadErrorHandler","_vol","imageUrlRef","scenesRef","_props2","_scenes","channelRangesRef","newImage","_newImage$imageInfo$c","_viewerState$current2","channelColorMeta","channelColors","addVolume","_channelColorMeta$ind","updateActiveChannels","_viewerState$current3","thisChannel","getChannel","noLut","initializeToExistingRange","has","_initializeLut","onVolumeData","setVolumeChannelAsMask","volume","useVolume","controlPanelClosed","setControlPanelClosed","hasAutoClosedControlPanel","setHasAutoClosedControlPanel","setClippingPanelOpen","clippingPanelOpenTimeout","saveChannelIsosurface","saveScreenshot","capture","dataUrl","anchor","document","createElement","click","sceneMeta","_sceneMeta","imageMetadata","hasTime","hasScenes","mode3d","panelOpen","isMode3d","axisY","_SCALE_BAR_MARGIN_DEF","scaleBarX","scaleBarY","clippingPanelHeight","setShowTimestepIndicator","setAxisPosition","setTimestepIndicatorPosition","setScaleBarPosition","setIndicatorPositions","setShowScaleBar","setShowAxis","onResizeDebounced","dispatchEvent","Event","_currentImage","setCameraMode","resize","setCameraState","setAutoRotate","setBackgroundColor","setBoundingBoxColor","setShowBoundingBox","channelsAwaitingReset","_initializeLut2","setMaxProjectMode","setVolumeRenderMode","RENDERMODE_PATHTRACE","RENDERMODE_RAYMARCH","updateMaskAlpha","updateExposure","updateDensity","imageValues","sliderValues","mid","scale","gammaSliderToImageValues","setGamma","setInterpolationEnabled","_props$transform","setVolumeTranslation","translation","_props$transform3","setVolumeRotation","rotation","usePerAxisClippingUpdater","isOrthoAxis","axismin","axismax","oneSlice","setZSlice","setAxisClip","physicalPixelSize","toArray","StyleProvider","ChannelUpdater","defaultCollapsed","collapsedWidth","ControlPanel","Toolbar","hasWebGL2","CellViewerCanvasWrapper","PrimaryButton","SecondaryButton","styled","_templateObject","HelpDropdown","container","setContainer","showVersionModal","setShowVersionModal","Link","FlexRowAlignCenter","$gap","DropdownSVG","Modal","onCancel","footer","FlexColumnAlignCenter","VOLEAPP_VERSION","VOLECORE_VERSION","useRecentDataUrls","_useLocalStorage2","useLocalStorage","storedRecentEntries","setRecentEntries","recentEntries","addRecentEntry","newEntry","datasetIndex","findIndex","MAX_RECENT_URLS","startCharacters","endCharacters","MiddleTruncatedTextContainer","div","_taggedTemplateLiteral","css","_templateObject2","$startChars","$endChars","MiddleTruncatedText","inputProps","startChars","endChars","text","startText","endText","MAX_RECENT_URLS_TO_DISPLAY","ModalContainer","LoadModal","showModal","_setShowModal","urlInput","setUrlInput","errorText","setErrorText","_useRecentDataUrls2","recentDataUrls","addRecentDataUrl","modalContainerRef","setShowModal","show","fuse","Fuse","isCaseSensitive","shouldSort","ignoreLocation","findAllMatches","autoCompleteOptions","search","option","getAutoCompletePopupContainer","UploadOutlined","okButtonProps","destroyOnClose","FlexRow","AutoComplete","onSelect","allowClear","placeholder","autoFocus","isValidUrl","appProps","onLoad"],"sourceRoot":""}