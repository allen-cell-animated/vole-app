/*! For license information please see 620.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_aics_vole_app=self.webpackChunk_aics_vole_app||[]).push([[620],{6855:(e,t,n)=>{n.d(t,{IG:()=>I,rm:()=>L,DK:()=>N,Ay:()=>D});var r=n(2543),o=n(6540),a=n(4270),i=n(4381),l=n(4097),c=n(2890);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function h(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}var y=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ref=t,this.savedViewerState={},this.channelsToReset=new Set,this.channelsToResetOnLoad=new Set,this.savedViewerChannelSettings=void 0,this.useDefaultViewerChannelSettings=!1,this.resetToSavedViewerState=this.resetToSavedViewerState.bind(this),this.resetToDefaultViewerState=this.resetToDefaultViewerState.bind(this),this.resetToState=this.resetToState.bind(this),this.setSavedViewerState=this.setSavedViewerState.bind(this),this.setSavedViewerChannelSettings=this.setSavedViewerChannelSettings.bind(this),this.getChannelsAwaitingReset=this.getChannelsAwaitingReset.bind(this),this.getChannelsAwaitingResetOnLoad=this.getChannelsAwaitingResetOnLoad.bind(this),this.onResetChannel=this.onResetChannel.bind(this),this.getCurrentViewerChannelSettings=this.getCurrentViewerChannelSettings.bind(this)},(t=[{key:"setSavedViewerState",value:function(e){this.savedViewerState=e}},{key:"setSavedViewerChannelSettings",value:function(e){this.savedViewerChannelSettings=e}},{key:"getChannelsAwaitingReset",value:function(){return this.channelsToReset}},{key:"getChannelsAwaitingResetOnLoad",value:function(){return this.channelsToResetOnLoad}},{key:"onResetChannel",value:function(e){this.channelsToReset.delete(e),this.channelsToResetOnLoad.delete(e)}},{key:"getCurrentViewerChannelSettings",value:function(){return this.useDefaultViewerChannelSettings?(0,a.EB)():this.savedViewerChannelSettings}},{key:"resetToState",value:function(e,t){var n=this.ref.current,o=n.changeViewerSetting,a=n.setChannelSettings,l=n.channelSettings,u=n.viewMode,s=n.time,f=n.slice,m=u!==e.viewMode&&(u===i.nE.xy||e.viewMode===i.nE.xy),p=s!==e.time,h=e.viewMode===i.nE.xy&&!(0,r.isEqual)(e.slice.z,f.z),y=m||p||h;if((0,c.Ib)(o,e),(0,c.C5)(a,l,t),this.channelsToReset=new Set(Array(t.length).keys()),y){var v=(0,c.S8)(t);this.channelsToResetOnLoad=new Set(v);var b,g=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}(v);try{for(g.s();!(b=g.n()).done;){var w=b.value;this.channelsToReset.delete(w)}}catch(e){g.e(e)}finally{g.f()}}}},{key:"resetToSavedViewerState",value:function(){var e=this,t=this.ref.current.channelSettings,n=f(f({},(0,a.$m)()),{},{cameraState:(0,a.kP)(this.savedViewerState.viewMode||i.nE.threeD)},this.savedViewerState),r=t.map((function(n,r){return(0,c.uO)(t[r].name,r,(0,a.iz)(r),e.savedViewerChannelSettings)}));this.resetToState(n,r),this.useDefaultViewerChannelSettings=!1}},{key:"resetToDefaultViewerState",value:function(){for(var e=this.ref.current.channelSettings,t=f(f({},(0,a.$m)()),{},{cameraState:(0,a.kP)(i.nE.threeD)}),n=e.map((function(e,t){return(0,a.g1)(t)})),r=0;r<Math.min(3,n.length);r++)n[r].volumeEnabled=!0;this.resetToState(t,n),this.useDefaultViewerChannelSettings=!0}}])&&p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return(t=function(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}var x=function(e){return"object"===C(e)&&null!==e&&!Array.isArray(e)},O={viewMode:function(e,t){var n=t!==i.nE.threeD&&e.renderMode===i.G9.pathTrace;return S(S({},e),{},{viewMode:t,renderMode:n?i.G9.volumetric:e.renderMode})},renderMode:function(e,t){return t===i.G9.pathTrace&&e.viewMode!==i.nE.threeD?S({},e):S(S({},e),{},{renderMode:t,autorotate:t!==i.G9.pathTrace&&e.autorotate})},autorotate:function(e,t){return S(S({},e),{},{autorotate:e.renderMode!==i.G9.pathTrace&&t})}},A=function(e,t){var n=t.key,r=t.value,o=O[n];if(o)return o(e,r);var a=e[n];return x(a)&&x(r)?S(S({},e),{},E({},n,S(S({},a),r))):S(S({},e),{},E({},n,r))},j=function(e){return e.UniformUpdate="UniformUpdate",e.ArrayUpdate="ArrayUpdate",e.Init="Init",e}(j||{}),P=function(e,t){if(t.type===j.Init)return t.value;if(t.type===j.ArrayUpdate)return e.map((function(e,n){return t.value[n]?S(S({},e),{},E({},t.key,t.value[n])):e}));if(Array.isArray(t.index))return e.map((function(e,n){return t.index.includes(n)?S(S({},e),t.value):e}));var n=e.slice();return t.index>=0&&t.index<e.length&&(n[t.index]=S(S({},n[t.index]),t.value)),n},k=function(){},M=S(S({},(0,a.$m)()),{},{channelSettings:[],changeViewerSetting:k,setChannelSettings:k,changeChannelSetting:k,applyColorPresets:k,resetToSavedViewerState:k,resetToDefaultViewerState:k,setSavedViewerChannelSettings:k,getCurrentViewerChannelSettings:function(){return(0,a.EB)()},getChannelsAwaitingReset:function(){return new Set},getChannelsAwaitingResetOnLoad:function(){return new Set},onResetChannel:k}),I=Object.keys(M),T={ref:{current:M}},L=o.createContext(T);function N(e,t){var n=o.memo(e),r=function(e){var r,a=(0,o.useContext)(L),i=S({},e),l=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=b(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw o}}}}(t);try{for(l.s();!(r=l.n()).done;){var c=r.value;i[c]=a.ref.current[c]}}catch(e){l.e(e)}finally{l.f()}return o.createElement(n,i)};return r.displayName="Connected(".concat(e.displayName||e.name,")"),r}const D=function(e){var t=v((0,o.useReducer)(A,S({},(0,a.$m)())),2),n=t[0],i=t[1],c=v((0,o.useReducer)(P,[]),2),u=c[0],s=c[1],f=(0,o.useRef)(M),m=(0,l.Q)((function(){return new y(f)}));(0,o.useEffect)((function(){m.setSavedViewerState(e.viewerSettings||{})}),[e.viewerSettings,m]);var d=(0,o.useCallback)((function(e,t){return i({key:e,value:t})}),[]),p=(0,o.useCallback)((function(e,t){s({type:j.UniformUpdate,index:e,value:t})}),[]),h=(0,o.useCallback)((function(e){return s({type:j.ArrayUpdate,key:"color",value:e})}),[]),b=(0,o.useCallback)((function(e){return s({type:j.Init,value:e})}),[]),g=(0,o.useRef)(void 0);if(e.viewerSettings&&!(0,r.isEqual)(e.viewerSettings,g.current)){for(var w=0,E=Object.keys(e.viewerSettings);w<E.length;w++){var C=E[w];n[C]!==e.viewerSettings[C]&&d(C,e.viewerSettings[C])}g.current=e.viewerSettings}var x=(0,o.useMemo)((function(){return f.current=S(S({},n),{},{channelSettings:u,changeViewerSetting:d,setChannelSettings:b,changeChannelSetting:p,applyColorPresets:h,setSavedViewerChannelSettings:m.setSavedViewerChannelSettings,getCurrentViewerChannelSettings:m.getCurrentViewerChannelSettings,getChannelsAwaitingReset:m.getChannelsAwaitingReset,getChannelsAwaitingResetOnLoad:m.getChannelsAwaitingResetOnLoad,onResetChannel:m.onResetChannel,resetToSavedViewerState:m.resetToSavedViewerState,resetToDefaultViewerState:m.resetToDefaultViewerState}),{ref:f}}),[n,u,h,d,p,b,m]);return o.createElement(L.Provider,{value:x},e.children)}},4097:(e,t,n)=>{n.d(t,{G:()=>o,Q:()=>a});var r=n(6540);function o(e,t){var n=(0,r.useRef)(t),o=(0,r.useCallback)((function(t){n.current=t,e(t)}),[e,n]);return[n,o]}function a(e){var t=(0,r.useRef)(null);return null===t.current&&(t.current=e()),t.current}},6373:(e,t,n)=>{n.d(t,{Mn:()=>s,oj:()=>u,zK:()=>f});var r=n(4270);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){if("number"==typeof n.match){if(n.match===t)return!0}else if(Array.isArray(n.match)){var r,o=a(n.match);try{for(o.s();!(r=o.n()).done;){var i=r.value;if("number"==typeof i){if(i===t)return!0}else if(new RegExp(i).test(e))return!0}}catch(e){o.e(e)}finally{o.f()}}else{if("string"!=typeof n.match)throw new Error("match is required for channel settings groups, and must be a string, number, or array of strings or numbers");if(new RegExp(n.match).test(e))return!0}return!1}function c(e,t,n){var r,o=a(n.channels);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(l(e,t,i))return i}}catch(e){o.e(e)}finally{o.f()}}function u(e,t,n){if(n.groups){var r,o=a(n.groups);try{for(o.s();!(r=o.n()).done;){var i=c(e,t,r.value);if(void 0!==i)return i}}catch(e){o.e(e)}finally{o.f()}}}function s(e,t,n){if(n){var r=u(e,t,n);if(r)return r.name||e}return e}function f(e,t){if(!e)return{};if(!t)return n={},i=r.n1,c=e.map((function(e,t){return t})),(i=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(i))in n?Object.defineProperty(n,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[i]=c,n;var n,i,c,u=t.groups,s={},f=[];if(void 0!==u){var m,d=a(u);try{var p=function(){var t=m.value;s[t.name]=[],t.channels.forEach((function(n){e.forEach((function(e,r){f.includes(r)||l(e,r,n)&&(s[t.name].push(r),f.push(r))}))}))};for(d.s();!(m=d.n()).done;)p()}catch(e){d.e(e)}finally{d.f()}}if(f.length<e.length){var h=0===u.length?r.n1:r.jR;s[h]=[],e.forEach((function(e,t){f.includes(t)||s[h].push(t)}))}return s}},2890:(e,t,n)=>{n.d(t,{C5:()=>i,Ib:()=>a,S8:()=>l,uO:()=>c});var r=n(4270),o=n(6373);function a(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];e(o,t[o])}e("renderMode",t.renderMode)}function i(e,t,n){for(var r=0;r<n.length;r++)n[r].name=t[r].name,n[r].controlPoints=t[r].controlPoints,n[r].ramp=t[r].ramp;e(n)}function l(e){for(var t=[],n=0;n<e.length;n++)(e[n].volumeEnabled||e[n].isosurfaceEnabled)&&t.push(n);return t}function c(e,t,n,a){var i,l,c,u,s,f,m,d,p,h,y,v,b,g,w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,r.g1)(),S={};return a&&(S=null!==(v=(0,o.oj)(e,t,a))&&void 0!==v?v:{}),{name:null!=e?e:"Channel "+t,displayName:(0,o.Mn)(null!=e?e:"Channel "+t,t,a),volumeEnabled:null!==(i=S.enabled)&&void 0!==i?i:w.volumeEnabled,isosurfaceEnabled:null!==(l=S.surfaceEnabled)&&void 0!==l?l:w.isosurfaceEnabled,colorizeEnabled:null!==(c=S.colorizeEnabled)&&void 0!==c?c:w.colorizeEnabled,colorizeAlpha:null!==(u=S.colorizeAlpha)&&void 0!==u?u:w.colorizeAlpha,isovalue:null!==(s=S.isovalue)&&void 0!==s?s:w.isovalue,opacity:null!==(f=S.surfaceOpacity)&&void 0!==f?f:w.opacity,color:null!==(b=null!==(d=S.color)&&void 0!==d?d:"",g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b),m=g?[parseInt(g[1],16),parseInt(g[2],16),parseInt(g[3],16)]:null)&&void 0!==m?m:n,useControlPoints:null!==(p=S.controlPointsEnabled)&&void 0!==p?p:w.useControlPoints,controlPoints:null!==(h=S.controlPoints)&&void 0!==h?h:w.controlPoints,ramp:null!==(y=S.ramp)&&void 0!==y?y:w.ramp,plotMin:w.plotMin,plotMax:w.plotMax}}},3072:(e,t,n)=>{n.d(t,{N$:()=>Qn,nE:()=>c.nE,TV:()=>H.Ay});var r=n(4421),o=n(5448),a=n(2543),i=n(6540),l=n(4270),c=n(4381);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t,n){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=s(s(s(s({},c.nE.yz,"x"),c.nE.xz,"y"),c.nE.xy,"z"),c.nE.threeD,null),m=function(e){return[e.r,e.g,e.b]},d=function(e){return{r:e[0],g:e[1],b:e[2]}},p=function(e){return[e[0]/255,e[1]/255,e[2]/255]},h=function(e){return"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")")},y=n(6373);function v(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t){var n=e.charAt(0);if("m"===n){var r=parseFloat(e.substring(1))/100;return t.maxBin*r}if("p"===n){var o=parseFloat(e.substring(1))/100;return t.findBinOfPercentile(o)}if("v"===n){var a=parseFloat(e.substring(1));return t.findFractionalBinOfValue(a)}return parseFloat(e)}function S(e,t,n){var o,a,i,c,u,s=e.getHistogram(t),f=function(e){var t=e.findBinOfPercentile(l.BO),n=e.findBinOfPercentile(l.xB);return(new r.Sd).createFromMinMax(t,n)}(s),m=f,d=e.channelNames[t],p=n&&(0,y.oj)(d,t,n);return p&&p.lut&&(m=null!==(c=function(e,t){var n;if(void 0!==t.lut&&2===t.lut.length&&(n="autoij"===t.lut[0]||"autoij"===t.lut[1]?e.findAutoIJBins():[w(t.lut[0],e),w(t.lut[1],e)],!Number.isNaN(n[0])&&!Number.isNaN(n[1]))){var o=[Math.min(n[0],n[1]),Math.max(n[0],n[1])],a=[{x:o[0],opacity:0,color:l.YT},{x:o[1],opacity:1,color:l.YT}];return(new r.Sd).createFromControlPoints(a)}}(s,p))&&void 0!==c?c:f),i=null!==(o=null==p?void 0:p.controlPoints)&&void 0!==o?o:v(m.controlPoints),a=null!=p&&p.ramp?C(p.ramp):v(m.controlPoints),u=null!=p&&p.controlPointsEnabled?(new r.Sd).createFromControlPoints(i):(new r.Sd).createFromControlPoints(a),e.setLut(t,u),{ramp:a,controlPoints:i}}function E(e){if(e.length<=1)return[0,l.Lr];if(2===e.length)return[e[0].x,e[1].x];if(3===e.length){if(e[0].opacity!==e[1].opacity&&e[0].opacity!==e[2].opacity&&e[1].opacity!==e[2].opacity)return[e[0].x,e[2].x];if(e[0].opacity!==e[1].opacity)return[e[0].x,e[1].x];if(e[1].opacity!==e[2].opacity)return[e[1].x,e[2].x]}return[e[1].x,e[e.length-2].x]}function C(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||b(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1];return[{x:Math.min(o-1,0),opacity:0,color:l.YT},{x:o,opacity:0,color:l.YT},{x:a,opacity:1,color:l.YT},{x:Math.max(a+1,l.Lr),opacity:1,color:l.YT}]}function x(e,t,n){var o=n.rawMin,a=n.rawMax;return void 0===t?e:(0,r._Q)(e,t[0],t[1],o,a)}var O=n(4097),A=n(4922);function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}function k(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){var t=function(e){if("object"!=j(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}var I=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,"playingAxis",null),k(this,"playWaitingForLoad",!1),k(this,"playHolding",!1),k(this,"playTimeoutId",0)},t=[{key:"setPlayingAxis",value:function(e){var t;this.playingAxis=e,null===(t=this.onPlayingAxisChanged)||void 0===t||t.call(this,e)}},{key:"playStep",value:function(){var e;this.playingAxis&&!this.playHolding&&this.stepAxis&&(null!==(e=this.getVolumeIsLoaded)&&void 0!==e&&e.call(this)?(this.stepAxis(this.playingAxis),this.playTimeoutId=window.setTimeout(this.playStep.bind(this),125)):this.playWaitingForLoad=!0)}},{key:"onImageLoaded",value:function(){this.playWaitingForLoad&&(this.playWaitingForLoad=!1,this.playStep())}},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];window.clearTimeout(this.playTimeoutId),this.playTimeoutId=0,this.playWaitingForLoad=!1,null===this.playingAxis||e||(this.playHolding=!1,this.setPlayingAxis(null))}},{key:"play",value:function(e){null!==this.playingAxis&&this.pause(!0),this.setPlayingAxis(e),this.playStep()}},{key:"startHold",value:function(e){this.playHolding=!0,this.pause(e===this.playingAxis)}},{key:"endHold",value:function(){this.playHolding&&(this.playHolding=!1,this.playStep())}}],t&&P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function T(){T=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new M(r||[]);return o(i,"_invoke",{value:A(e,n,l)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var m="suspendedStart",d="suspendedYield",p="executing",h="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,i,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(I([])));E&&E!==n&&r.call(E,i)&&(w=E);var C=g.prototype=v.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,l){var c=f(e[o],e,a);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==L(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,i,l)}),(function(e){n("throw",e,i,l)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function A(t,n,r){var o=m;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var l=r.delegate;if(l){var c=j(l,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===m)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=p;var u=f(t,n,r);if("normal"===u.type){if(o=r.done?h:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=h,r.method="throw",r.arg=u.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=f(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(L(t)+" is not iterable")}return b.prototype=g,o(C,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},x(O.prototype),u(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},x(C),u(C,c,"Generator"),u(C,i,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function N(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){N(a,r,o,i,l,"next",e)}function l(e){N(a,r,o,i,l,"throw",e)}i(void 0)}))}}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,B(r.key),r)}}function R(e,t,n){return(t=B(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){var t=function(e){if("object"!=L(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==L(t)?t:t+""}var z=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"currentScene",0),R(this,"syncChannels",!1),R(this,"prefetchPriority",[]),this.paths=n,this.context=t,this.loaders=new Array(n.length).fill(void 0)},t=[{key:"getLoader",value:(a=D(T().mark((function e(t){var n,o,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentScene=t,n=this.loaders[t]){e.next=12;break}return o=this.paths[t],a={},"object"!==L(o)||Array.isArray(o)||(a.rawArrayOptions=o,a.fileType=r.Ai.DATA,o=""),e.next=8,this.context.onOpen();case 8:return e.next=10,this.context.createLoader(o,a);case 10:n=e.sent,this.loaders[t]=n;case 12:return n.syncMultichannelLoading(this.syncChannels),n.setPrefetchPriority(this.prefetchPriority),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadScene",value:(o=D(T().mark((function e(t,n,r,o){var a,i;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLoader(t);case 2:return a=e.sent,i=null!=r?r:n.loadSpecRequired,n.loader=a,e.next=7,a.createImageInfo(i);case 7:n.imageInfo.imageInfo=e.sent.imageInfo,a.loadVolumeData(n,i,o);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"createVolume",value:(n=D(T().mark((function e(t,n,r){var o;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLoader(t);case 2:return o=e.sent,e.abrupt("return",o.createVolume(n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"syncMultichannelLoading",value:function(e){this.syncChannels=e;var t=this.loaders[this.currentScene];t&&t.syncMultichannelLoading(e)}},{key:"setPrefetchPriority",value:function(e){this.prefetchPriority=e;var t=this.loaders[this.currentScene];t&&t.setPrefetchPriority(e)}}],t&&V(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o,a}(),F=n(2890),H=n(6855);function U(e){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U(e)}function _(){_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new M(r||[]);return o(i,"_invoke",{value:A(e,n,l)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var m="suspendedStart",d="suspendedYield",p="executing",h="completed",y={};function v(){}function b(){}function g(){}var w={};u(w,i,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(I([])));E&&E!==n&&r.call(E,i)&&(w=E);var C=g.prototype=v.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function n(o,a,i,l){var c=f(e[o],e,a);if("throw"!==c.type){var u=c.arg,s=u.value;return s&&"object"==U(s)&&r.call(s,"__await")?t.resolve(s.__await).then((function(e){n("next",e,i,l)}),(function(e){n("throw",e,i,l)})):t.resolve(s).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function A(t,n,r){var o=m;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var l=r.delegate;if(l){var c=j(l,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===m)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=p;var u=f(t,n,r);if("normal"===u.type){if(o=r.done?h:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=h,r.method="throw",r.arg=u.arg)}}}function j(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,j(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var a=f(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,y;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(U(t)+" is not iterable")}return b.prototype=g,o(C,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=u(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},x(O.prototype),u(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new O(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},x(C),u(C,c,"Generator"),u(C,i,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function G(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return(t=function(e){var t=function(e){if("object"!=U(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==U(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var q=function(e){return e[e.REQUESTED=0]="REQUESTED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR",e}({}),X=function(e){var t=(0,i.useRef)(e);return(0,i.useEffect)((function(){t.current=e}),[e]),t};const Q=function(e,t){var n=(0,i.useContext)(H.rm).ref,o=X(null==t?void 0:t.onError),a=X(null==t?void 0:t.onChannelLoaded),u=X(null==t?void 0:t.onCreateImage),s=null==t?void 0:t.maskChannelName,f=Y((0,i.useState)(null),2),m=f[0],d=f[1],p=(0,O.Q)((function(){return new r.nO(l.Ci,l.Wv,l.D_)})),h=(0,i.useMemo)((function(){return new z(p,e)}),[p,e]),v=(0,O.Q)((function(){return new I})),b=Y((0,i.useState)(null),2),g=b[0],w=b[1];(0,i.useEffect)((function(){v.onPlayingAxisChanged=function(e){var t=null!==e;if(w(e),h.setPrefetchPriority(e?[l.N1[e]]:[]),h.syncMultichannelLoading(t),m){var n=m.imageInfo,r=n.volumeSize,o=n.subregionSize,a=t&&("t"===e||r[e]!==o[e]);m.updateRequiredData({scaleLevelBias:a?1:0})}}}),[h,v,m]);var S=Y((0,i.useState)([]),2),E=S[0],C=S[1],x=Y((0,O.G)(C,E),2),j=x[0],P=x[1],k=n.current.channelSettings,M=Y((0,i.useState)(!1),2),T=M[0],L=M[1],N=(0,i.useRef)(!0),D=(0,i.useMemo)((function(){if(T)return q.ERROR;var e=E.reduce((function(e,t,n){var r=Y(e,2),o=r[0],a=r[1],i=k[n];if(i&&(i.volumeEnabled||i.isosurfaceEnabled||s===i.name)){var l=t>0;return[o&&l,a&&!l]}return[o,a]}),[!0,!0]),t=Y(e,2),n=t[0],r=t[1];return n&&N.current&&(N.current=!1),r?q.REQUESTED:n?q.LOADED:q.LOADING}),[E,k,s,T]),V=(0,i.useCallback)((function(){L(!1),P(j.current.map((function(e){return Math.min(e,0)})))}),[j,P]),R=(0,i.useCallback)((function(e){var t;throw L(!0),null===(t=o.current)||void 0===t||t.call(o,e),e}),[o]),B=Y((0,i.useState)({}),2),U=B[0],$=B[1],K=(0,i.useCallback)((function(e,t){var n,r=-1===j.current[t];null===(n=a.current)||void 0===n||n.call(a,e,t,r);var o=j.current.slice();o[t]=Math.max(o[t],0)+1,P(o),e.isLoaded()&&v.onImageLoaded()}),[j,a,v,P]);(0,i.useEffect)((function(){var e=n.current,t=e.changeViewerSetting,o=e.channelSettings,a=e.getCurrentViewerChannelSettings,i=e.setChannelSettings;P(new Array(j.current.length).fill(-1)),L(!1),N.current=!0;var s=function(e){var t=a(),n=(0,y.zK)(e,t);if($(n),e.every((function(e,n){var r;return(0,y.Mn)(e,n,t)===(null===(r=o[n])||void 0===r?void 0:r.displayName)}))){var r=e.map((function(e,t){return W(W({},o[t]),{},{name:e})}));return i(r),r}var c=e.map((function(e,n){var r=(0,l.iz)(n);return(0,F.uO)(e,n,r,t)}));return i(c),c},f=function(){var e,o=(e=_().mark((function e(){var o,i,l,f,m,p,y,b,g,w,S,E,C,x;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=n.current,f=l.scene,m=l.time,(p=new r.wK).time=m,e.next=5,h.createVolume(f,p,K).catch(R);case 5:y=e.sent,b=y.imageInfo.channelNames,g=s(b),P(new Array(b.length).fill(-1)),d(y),null===(o=u.current)||void 0===o||o.call(u,y),v.stepAxis=function(e){var r=n.current,o=r.time,a=r.slice;if("t"===e)t("time",(o+1)%y.imageInfo.times);else{var i=y.imageInfo.volumeSize[e],l=a[e]*i;t("slice",W(W({},a),{},Z({},e,(l+1)%i/i)))}},v.getVolumeIsLoaded=y.isLoaded.bind(y),(w=new r.wK).time=m,S=g?g.map((function(e,t){return e.volumeEnabled?t:-1})).filter((function(e){return e>=0})):[],(E=null===(i=a())||void 0===i?void 0:i.maskChannelName)&&(C=b.indexOf(E))>=0&&!S.includes(C)&&S.push(C),w.channels=S,n.current.viewMode===c.nE.xy&&(x=n.current.slice,w.subregion=new A.NRn(new A.Pq0(0,0,x.z),new A.Pq0(1,1,x.z))),h.loadScene(f,y,w).catch(R);case 21:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){G(a,r,o,i,l,"next",e)}function l(e){G(a,r,o,i,l,"throw",e)}i(void 0)}))});return function(){return o.apply(this,arguments)}}();f()}),[h,R,u,a,n,j,P,v,V,K]);var Q=(0,i.useCallback)((function(e,t){m&&!N.current&&(e.setTime(m,t,K).catch(R),V())}),[m,R,V,N,K]),J=(0,i.useCallback)((function(e){m&&!N.current&&(h.loadScene(e,m,void 0,K).catch(R),V())}),[m,R,h,V,N,K]);return(0,i.useMemo)((function(){return{image:m,channelVersions:E,imageLoadStatus:D,setTime:Q,setScene:J,playControls:v,playingAxis:g,channelGroupedByType:U}}),[m,E,D,Q,J,v,g,U])};var J=n(3567),ee=n(1600),te=n(2153),ne=n(6795),re=n(1917),oe=n(5144),ae=n(4297);function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return le(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const ce=function(e){var t=e.value,n=e.step,r=void 0===n?1:n,o=e.precision,a=void 0===o?r:o,l=e.min,c=void 0===l?0:l,u=e.max,s=void 0===u?Number.MAX_SAFE_INTEGER:u,f=e.disabled,m=void 0!==f&&f,d=e.className,p=void 0===d?"":d,h=e.onChange,y=ie(i.useState(!1),2),v=y[0],b=y[1],g=ie((0,O.G)(b,v),2),w=g[0],S=g[1],E=ie(i.useState(""),2),C=E[0],x=E[1],A=i.useRef(null),j=function(e){return Math.min(Math.max(e,c),s)},P=function(e){return j(Math.round(e/a)*a)},k=function(e){return!(isNaN(e)||e===t||m)},M=P(t),I=function(e){var t,n=j(M+(e?r:-r));k(n)&&(h(n),x(n.toString()),S(!0)),null===(t=A.current)||void 0===t||t.focus()},T="numinput"+(m?" numinput-disabled":"")+(p&&" ".concat(p));return i.createElement("div",{className:T,onKeyDown:function(e){var t=e.key;if(["Up","ArrowUp","Down","ArrowDown"].includes(t))I("Up"===t||"ArrowUp"===t),e.preventDefault();else if("Enter"===t){var n;null===(n=A.current)||void 0===n||n.blur()}}},i.createElement("input",{value:v?C:M,step:r,min:c,max:s,disabled:m,className:"numinput-input",autoComplete:"off",role:"spinbutton","aria-valuenow":M,"aria-valuemin":c,"aria-valuemax":s,ref:A,onChange:function(e){return function(e){x(e);var t=""===e?0:parseFloat(e),n=P(t);k(n)&&h(n)}(e.target.value)},onFocus:function(){w.current||(x(M.toString()),S(!0))},onBlur:function(){return S(!1)}}),i.createElement("div",{className:"numinput-controls"},i.createElement("div",{className:"numinput-controls-button numinput-controls-button-up",role:"button","aria-label":"Increase Value","aria-disabled":m,onClick:function(){return I(!0)}},i.createElement(oe.A,{className:"numinput-controls-button-icon"})),i.createElement("div",{className:"numinput-controls-button numinput-controls-button-down",role:"button","aria-label":"Decrease Value","aria-disabled":m,onClick:function(){return I(!1)}},i.createElement(ae.A,{className:"numinput-controls-button-icon"}))))};var ue=n(7057),se=n.n(ue);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return(t=function(e){var t=function(e){if("object"!=fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ye=i.memo(se(),(function(e,t){return t.noUpdate}));const ve=function(e){var t,n,r=(t=i.useState(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return he(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1],l=function(e,t){return function(){a(e),t&&t.apply(void 0,arguments)}},c=l(!0,e.onStart),u=l(!1,e.onEnd);return i.createElement(ye,de(de({},e),{},{noUpdate:o,onStart:c,onEnd:u}))};function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function ge(e,t,n){return(t=function(e){var t=function(e){if("object"!=be(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==be(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ee=["x","y","z"],Ce=function(e){var t=e.label,n=e.vals,r=e.valsReadout,o=void 0===r?n:r,a=e.max,l=e.onSlide,c=e.onChange,u=void 0===c?l:c,s=e.onStart,f=e.onEnd,m=n.length>1,d=m?0:1,p=m?l:function(e){return null==l?void 0:l([e[0]-1])},h=m?u:function(e){return null==u?void 0:u([e[0]-1])};return i.createElement("span",{className:"axis-slider-container"},i.createElement("span",{className:"slider-name"},t),a<=d?i.createElement("i",null,"No values to adjust"):i.createElement("span",{className:"axis-slider"},i.createElement(ve,{className:m?"":"slider-single-handle",connect:!0,range:{min:d,max:a},start:m?n:[n[0]+1],step:1,margin:1,behaviour:"drag",pips:{mode:"positions",values:[25,50,75],density:25,format:{to:function(){return""}}},format:{to:Math.round,from:parseInt},onSlide:p,onChange:h,onStart:s,onEnd:f})),a>d&&i.createElement("span",{className:"slider-values"},i.createElement(ce,{min:d,max:a,value:o[0]+(m?0:1),onChange:function(e){return null==u?void 0:u(m?[e,n[1]]:[e-1])}}),m&&i.createElement(i.Fragment,null," , ",i.createElement(ce,{min:d,max:a,value:o[1],onChange:function(e){return null==u?void 0:u([n[0],e])}}))," / ",a))},xe=function(e){var t=e.onChange,n=e.onStart,r=e.onEnd,o=we((0,i.useState)(e.val),2),a=o[0],l=o[1],c=we((0,i.useState)(!1),2),u=c[0],s=c[1],f=(0,i.useCallback)((function(e){var n=we(e,1)[0];return null==t?void 0:t(n)}),[t]),m=(0,i.useCallback)((function(e){var t=we(e,1)[0];return l(t)}),[]),d=(0,i.useCallback)((function(){l(e.val),s(!0),null==n||n()}),[n,e.val]),p=(0,i.useCallback)((function(){s(!1),null==r||r()}),[r]);return i.createElement(i.Fragment,null,i.createElement(Ce,{label:e.label,vals:[e.val],valsReadout:e.updateWhileSliding||!u?void 0:[a],max:e.max,onSlide:e.updateWhileSliding?f:m,onChange:e.updateWhileSliding?void 0:f,onStart:d,onEnd:p}),e.max>1&&i.createElement(ne.A,{placement:"top",title:"Play through sequence",trigger:["hover","focus"]},i.createElement(re.Ay,{className:"slider-play-button",onClick:function(){return e.onTogglePlayback(!e.playing)},icon:e.playing?i.createElement(ee.A,null):i.createElement(te.A,null),"aria-label":(e.playing?"Pause ":"Play ")+e.label})))};const Oe=function(e){var t=f[e.mode],n=function(t){e.playControls.playHolding&&e.playingAxis===t||e.playControls.pause()};(0,i.useEffect)((function(){return e.playControls.pause()}),[e.mode,e.image,e.playControls]);var r,o,a,l=function(t,n){n?e.playControls.play(t):e.playControls.pause()};return i.createElement("div",{className:t?"clip-sliders clip-sliders-2d":"clip-sliders"},i.createElement("span",{className:"slider-group"},i.createElement("h4",{className:"slider-group-title"},"ROI"),i.createElement("span",{className:"slider-group-rows"},t?(r=t,o=e.numSlices[r],a=e.numSlicesLoaded[r],i.createElement("div",{key:r+o+a,className:"slider-row slider-".concat(r)},i.createElement(xe,{label:r.toUpperCase(),val:Math.round(e.slices[r]*o),max:o,onChange:function(t){return function(t,r){n(t),e.changeViewerSetting("slice",ge({},t,r/e.numSlices[t]))}(r,t)},onStart:function(){return e.playControls.startHold(r)},onEnd:function(){return e.playControls.endHold()},playing:e.playingAxis===r,onTogglePlayback:function(e){return l(r,e)},updateWhileSliding:o===a}))):Ee.map((function(t){var r=e.numSlices[t];if(1===r)return null;var o=e.region[t];return i.createElement("div",{key:t+r+"3d",className:"slider-row slider-".concat(t)},i.createElement(Ce,{label:t.toUpperCase(),vals:[Math.round(o[0]*r),Math.round(o[1]*r)],max:r,onSlide:function(r){return function(t,r,o){n(t);var a=e.changeViewerSetting,i=e.numSlices[t];a("region",ge({},t,[r/i,o/i]))}(t,r[0],r[1])},onStart:function(){return e.playControls.startHold(t)},onEnd:function(){return e.playControls.endHold()}}))})))),e.numTimesteps>1&&i.createElement("span",{className:"slider-group"},i.createElement("h4",{className:"slider-group-title"},"Time"),i.createElement("span",{className:"slider-group-rows"},i.createElement("div",{className:"slider-row slider-t"},i.createElement(xe,{label:"",val:e.time,max:e.numTimesteps,playing:"t"===e.playingAxis,onTogglePlayback:function(e){return l("t",e)},onChange:function(t){return function(t){n("t"),e.changeViewerSetting("time",t)}(t)},onStart:function(){return e.playControls.startHold("t")},onEnd:function(){return e.playControls.endHold()}})))),e.numScenes>1&&i.createElement("span",{className:"slider-group"},i.createElement("h4",{className:"slider-group-title"},"Scene"),i.createElement("span",{className:"slider-group-rows"},i.createElement("div",{className:"slider-row slider-scene"},i.createElement(Ce,{label:"",vals:[e.scene],max:e.numScenes,onChange:function(t){var n=we(t,1)[0];return e.changeViewerSetting("scene",n)}})))))};var Ae=n(6143),je=n(6933);function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pe.apply(null,arguments)}function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ke.apply(null,arguments)}function Me(){return Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Me.apply(null,arguments)}function Ie(){return Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ie.apply(null,arguments)}function Te(){return Te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Te.apply(null,arguments)}function Le(){return Le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Le.apply(null,arguments)}function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ne.apply(null,arguments)}function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},De.apply(null,arguments)}function Ve(){return Ve=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ve.apply(null,arguments)}function Re(){return Re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Re.apply(null,arguments)}function Be(){return Be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Be.apply(null,arguments)}const ze={axes:function(e){return i.createElement("svg",Pe({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("circle",{cx:6.26,cy:12.84,r:1,fill:"currentColor"}),i.createElement("path",{fill:"currentColor",d:"m14.27 15.23.7-1.64H8.11c.09-.23.15-.48.15-.75s-.06-.52-.15-.75h6.86l-.7-1.64 5.66 2.39zM6.26.03 3.87 5.69 5.51 5v5.99q.345-.15.75-.15c.405 0 .52.05.75.15V5l1.64.69zM5.59 17.23.07 19.91 2 14.08l.77 1.6 1.61-1.83s.08-.06.11-.09c.23.44.62.78 1.09.95-.02.04-.04.09-.07.12L3.9 16.67z"}))},boundingBox:function(e){return i.createElement("svg",ke({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M13.28 10.25a.38.38 0 1 0 .76 0V9a.38.38 0 1 0-.76 0zm-2.5 3.42a.38.38 0 0 0-.38-.38H9.15a.38.38 0 1 0 0 .76h1.25c.21 0 .38-.17.38-.38m3.93.52-.68-.67v-1.26a.38.38 0 1 0-.76 0v1.05h-.88a.38.38 0 1 0 0 .76h1.1l.68.67c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53Zm2.31 2.29-.89-.88a.377.377 0 0 0-.53 0c-.15.15-.15.38 0 .53l.89.88c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53M4.29 13.67a.38.38 0 0 0-.38-.38H2.66a.38.38 0 1 0 0 .76h1.25c.21 0 .38-.17.38-.38m8.98-9.92a.38.38 0 1 0 .76 0V2.5a.38.38 0 1 0-.76 0zm.75 2a.38.38 0 1 0-.76 0v.08h.75v-.08Zm-.38 1.62c.21 0 .38-.17.38-.38v-.17h-.75v.17c0 .21.17.38.38.38Zm0-3.25c.21 0 .38-.17.38-.38V2.49a.38.38 0 1 0-.76 0v1.25c0 .21.17.38.38.38M3.9 13.3H2.65a.38.38 0 1 0 0 .76H3.9a.38.38 0 1 0 0-.76m1.62.38c0 .19.14.34.32.36v-.73c-.18.03-.32.18-.32.36Zm10.59 1.93a.377.377 0 0 0-.53 0c-.15.15-.15.38 0 .53l.89.88c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53zm2.86 2.84-.56-.55a.37.37 0 0 0-.53 0c-.15.15-.15.38 0 .53l.55.54h.54zm-8.58-5.14H9.14a.38.38 0 1 0 0 .76h1.25a.38.38 0 1 0 0-.76m3.62.22v-1.26a.38.38 0 1 0-.76 0v1.05h-.88a.38.38 0 1 0 0 .76h1.1l.68.67c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53l-.68-.67Zm-.37-2.89c.21 0 .38-.17.38-.38V9.01a.38.38 0 1 0-.76 0v1.25c0 .21.17.38.38.38m-6.12 3.05a.38.38 0 0 0-.38-.38h-.3v.75h.3c.21 0 .38-.17.38-.38Z"}),i.createElement("path",{fill:"currentColor",d:"m19.83 5.98-.7-.69L14.7.88l-.69-.69a.5.5 0 0 0-.35-.15H.52c-.28 0-.5.22-.5.5v13.13c0 .14.06.26.15.35.46.46.7.69.7.69l4.44 4.41s.23.23.7.69c.09.09.21.15.35.15h13.13c.28 0 .5-.22.5-.5V6.33a.5.5 0 0 0-.15-.35ZM5.85 13.31v4.96l-4.29-4.26s-.19-.19-.55-.54V1.74L5.3 6s.19.19.55.54zm.16-8.02L1.73 1.04h11.71l.55.55 4.28 4.25H6.55L6 5.29Zm.84 13.68V6.83h12.13v12.13H6.85Z"}))},camera:function(e){return i.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 2",viewBox:"0 0 32 32",role:"img"},e),i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"M29.54 32H2.46C1.1 32 0 30.9 0 29.55V15.34c0-1.35 1.1-2.45 2.46-2.45H9.1c1.21 0 2.34-.54 3.1-1.48l.88-1.09a3.92 3.92 0 0 1 3.08-1.47h6.32c1.21 0 2.33.54 3.08 1.47l.88 1.09a3.97 3.97 0 0 0 3.1 1.48c1.36 0 2.46 1.1 2.46 2.45v14.21C32 30.9 30.9 32 29.54 32M2.46 13.9c-.8 0-1.46.65-1.46 1.45v14.21c0 .8.65 1.45 1.46 1.45h27.08c.8 0 1.46-.65 1.46-1.45V15.34c0-.8-.65-1.45-1.46-1.45-1.52 0-2.93-.68-3.88-1.85l-.88-1.09c-.56-.7-1.4-1.1-2.3-1.1h-6.32c-.9 0-1.74.4-2.3 1.1l-.88 1.09a4.95 4.95 0 0 1-3.88 1.85H2.46Zm4.25 4.85c.58 0 1.04-.46 1.04-1.03s-.47-1.03-1.04-1.03H5.04c-.58 0-1.04.46-1.04 1.03s.47 1.03 1.04 1.03zm12.61-3.24c2.81 0 5.09 2.29 5.09 5.1s-2.28 5.1-5.09 5.1-5.09-2.29-5.09-5.1 2.28-5.1 5.09-5.1m0-2c-3.91 0-7.09 3.18-7.09 7.1s3.17 7.1 7.09 7.1 7.09-3.18 7.09-7.1-3.17-7.1-7.09-7.1M19.39 3.87c-.28 0-.5-.22-.5-.5V.5c0-.28.22-.5.5-.5s.5.22.5.5v2.87c0 .28-.22.5-.5.5m4.76 1.12 2.15-2.34c.19-.2.17-.52-.03-.71a.514.514 0 0 0-.71.03l-2.15 2.34c-.19.2-.17.52.03.71.1.09.22.13.34.13a.5.5 0 0 0 .37-.16m-8.95.03c.2-.19.22-.5.03-.71l-2.15-2.34c-.19-.2-.5-.21-.71-.03-.2.19-.22.5-.03.71l2.15 2.34c.1.11.23.16.37.16.12 0 .24-.04.34-.13"})))},channels:function(e){return i.createElement("svg",Ie({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M13.55 10.36h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76M2.65 6.64a.38.38 0 0 1-.38-.38v-.3c0-.26.03-.52.08-.78.04-.2.24-.33.45-.29.2.04.33.24.29.45-.04.2-.07.41-.07.62v.3c0 .21-.17.38-.38.38Zm1.06-2.7c-.1 0-.2-.04-.28-.12a.38.38 0 0 1 .02-.53c.27-.25.59-.46.92-.62.19-.09.41 0 .5.18s0 .41-.18.5c-.27.12-.51.29-.73.49-.07.07-.16.1-.25.1m9.78-.86h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76M13.44 17.69h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-2.95-.32c-.05 0-.11-.01-.16-.04-.33-.16-.64-.38-.91-.63-.15-.14-.16-.38-.02-.53s.38-.16.53-.02c.22.2.46.37.73.5.19.09.26.32.17.5-.06.13-.2.21-.34.21Zm-1.78-2.28c-.17 0-.33-.12-.37-.3-.05-.24-.07-.48-.07-.73v-.34a.38.38 0 1 1 .76 0v.34c0 .19.02.39.06.58.04.2-.09.4-.29.44h-.08ZM5.42 12.69H.01v-5.4h5.41zm-4.4-1h3.4v-3.4H1.01v3.4ZM19.99 5.41h-5.4V0h5.4zm-4.4-1h3.4V1h-3.4v3.4ZM19.99 12.69h-5.4v-5.4h5.4zm-4.4-1h3.4v-3.4h-3.4zM19.99 19.97h-5.4v-5.4h5.4zm-4.4-1h3.4v-3.4h-3.4z"}))},closePanel:function(e){return i.createElement("svg",Te({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M10.64 17.78c-.21 0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21-4.6-6.21c-.33-.44-.23-1.07.21-1.4s1.07-.23 1.4.21l5.03 6.8c.26.35.26.84 0 1.19l-5.03 6.81a1 1 0 0 1-.81.41Z"}),i.createElement("path",{fill:"currentColor",d:"M4.33 17.84c-.21 0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21-4.59-6.21c-.33-.44-.23-1.07.21-1.4s1.07-.23 1.4.21l5.03 6.81c.26.35.26.83 0 1.19l-5.03 6.81a1 1 0 0 1-.81.41Z"}))},download:function(e){return i.createElement("svg",Le({xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 2",viewBox:"0 0 32 32",role:"img"},e),i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"M17 14.93V0h-2v14.93l-3.44-1.46L16 24l4.44-10.53z"}),i.createElement("path",{d:"M28.5 32h-25A2.5 2.5 0 0 1 1 29.5V20h1v9.5c0 .83.67 1.5 1.5 1.5h25c.83 0 1.5-.67 1.5-1.5V20h1v9.5a2.5 2.5 0 0 1-2.5 2.5"})))},dropdownArrow:function(e){return i.createElement("svg",Ne({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,viewBox:"0 0 12 12",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M1.117 3.12a.47.47 0 0 1 .662.035L6.006 7.85l4.227-4.695a.469.469 0 1 1 .697.627L6.372 8.845A.47.47 0 0 1 6.006 9a.47.47 0 0 1-.366-.155L1.082 3.782a.47.47 0 0 1 .035-.662"}))},metadata:function(e){return i.createElement("svg",De({xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 2",viewBox:"0 0 32 32",role:"img"},e),i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"M19.46 21.54c0-.28-.22-.5-.5-.5H.5c-.28 0-.5.22-.5.5s.22.5.5.5h18.46c.28 0 .5-.22.5-.5m3.52-14.03c0-.28-.22-.5-.5-.5H.51c-.28 0-.51.23-.51.5s.22.5.5.5h21.98c.28 0 .5-.22.5-.5m-4.74 7.01c0-.28-.22-.5-.5-.5H.5c-.28 0-.5.22-.5.5s.22.5.5.5h17.25c.28 0 .5-.22.5-.5ZM32 .5c0-.28-.22-.5-.5-.5H.54c-.28 0-.5.22-.5.5s.22.5.5.5H31.5c.28 0 .5-.22.5-.5M23.62 14.79l.16-.56h6.29L25.4 27.89c-.13.4-.26.81-.4 1.23-.13.42-.2.81-.2 1.19 0 .32.09.6.28.83.18.23.46.34.83.34.42 0 .84-.15 1.25-.44s.78-.64 1.13-1.03c.34-.39.63-.79.87-1.19s.41-.73.51-.97l.47.2c-.11.21-.27.54-.49.99-.23.44-.53.89-.93 1.33-.39.44-.88.83-1.46 1.15S26 32 25.2 32c-.87 0-1.56-.18-2.08-.54s-.77-.97-.77-1.83c0-.46.08-.96.24-1.51s.32-1.05.48-1.51l4.07-11.81h-3.52Zm4.67-6.57c0 .54.18.99.53 1.35s.8.54 1.32.54.97-.18 1.32-.54.53-.81.53-1.35-.18-.99-.53-1.35-.8-.54-1.32-.54-.97.18-1.32.54-.53.81-.53 1.35"})))},preferences:function(e){return i.createElement("svg",Ve({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M8.04 3.61H.81a.749.749 0 1 1 0-1.5h7.23zm11.15-1.5h-5.65v1.5h5.65c.41 0 .75-.34.75-.75s-.34-.75-.75-.75M10.79 5.61c-.41 0-.75-.34-.75-.75V.85c0-.41.34-.75.75-.75s.75.34.75.75v4.01c0 .41-.34.75-.75.75M2.81 10.75h-2c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2zm16.38-1.5H8.31v1.5h10.88c.41 0 .75-.34.75-.75s-.34-.75-.75-.75M5.56 12.76c-.41 0-.75-.34-.75-.75V7.99c0-.41.34-.75.75-.75s.75.34.75.75V12c0 .41-.34.75-.75.75ZM19.94 17.14c0 .41-.34.75-.75.75h-3.08v-1.5h3.08c.41 0 .75.34.75.75m-9.33-.75H.81c-.41 0-.75.34-.75.75s.34.75.75.75h9.8zM13.36 19.9c-.41 0-.75-.34-.75-.75v-4.01c0-.41.34-.75.75-.75s.75.34.75.75v4.01c0 .41-.34.75-.75.75"}))},resetView:function(e){return i.createElement("svg",Re({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,"data-name":"icon-resetView",viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M.6 5.48c-.28 0-.5-.22-.5-.5V.09h4.89c.28 0 .5.22.5.5s-.22.5-.5.5H1.1v3.89c0 .28-.22.5-.5.5M4.99 19.91H.1v-4.88c0-.28.22-.5.5-.5s.5.22.5.5v3.88h3.89c.28 0 .5.22.5.5s-.22.5-.5.5M19.9 19.91h-4.89c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h3.89v-3.88c0-.28.22-.5.5-.5s.5.22.5.5zM19.4 6.11c-.28 0-.5-.22-.5-.5V1.09h-4.51c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h5.51v5.52c0 .28-.22.5-.5.5M16.46 16.46H3.54V3.54h12.92zm-10.92-2h8.92V5.54H5.54z"}))},turnTable:function(e){return i.createElement("svg",Be({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M19.19 7.69c-.09.16-.19.3-.3.44-.26-.29-.55-.56-.85-.8.34-.28.58-.61.61-.99.05-.55-.4-1.15-.95-1.59-.56-.45-1.23-.79-1.92-1.07-.08-.04-.12-.13-.08-.21.03-.07.11-.11.19-.09.73.21 1.46.48 2.15.89.34.21.67.46.95.79.28.32.51.76.55 1.25.05.49-.1.99-.35 1.38M7.85 5.12l1.54-1.8c-1.27.03-2.52.18-3.73.46-.71.16-1.4.37-2.05.65-.64.28-1.25.63-1.67 1.06-.43.45-.54.87-.33 1.29.22.45.76.88 1.36 1.19 1.13.6 2.46.94 3.81 1.15-.27.42-.51.87-.7 1.35-1.29-.23-2.56-.6-3.79-1.26-.71-.4-1.46-.9-1.93-1.83C.13 6.92.06 6.33.2 5.81c.14-.53.43-.94.75-1.27.65-.65 1.39-1.04 2.13-1.35.75-.32 1.51-.54 2.28-.71 1.39-.31 2.79-.45 4.19-.46L8.28 0l5.86 3.07zM18.17 8.83c-.31-.36-.66-.67-1.05-.95h-.01a6.6 6.6 0 0 0-3.89-1.26c-2.16 0-4.09 1.03-5.3 2.63-.33.42-.61.88-.82 1.38a6.68 6.68 0 0 0 6.12 9.35 6.68 6.68 0 0 0 6.68-6.68c0-1.73-.65-3.29-1.73-4.47m-4.95 10.15c-3.13 0-5.68-2.55-5.68-5.68 0-.92.22-1.79.62-2.56.26-.52.6-1 1.01-1.41a5.63 5.63 0 0 1 4.05-1.71 5.62 5.62 0 0 1 4.11 1.78 5.6 5.6 0 0 1 1.57 3.9c0 3.13-2.55 5.68-5.68 5.68"}),i.createElement("path",{fill:"currentColor",d:"m12.83 10.68-1.18-.94v7.16l4.48-3.58zm-.18 1.14 1.88 1.5-1.88 1.5z"}))}};function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function He(){return He=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},He.apply(null,arguments)}function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){Ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e,t,n){return(t=function(e){var t=function(e){if("object"!=Fe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $e={fontSize:"19px"};const We=function(e){var t=_e({},e);return t.style=_e(_e({},$e),e.style),i.createElement(je.A,He({component:ze[e.type]},t))};function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Ye=function(e){var t,n,r=e.children,o=e.open,a=e.title,l=e.height,c=e.onOpenChange,u=(t=(0,i.useState)(!0),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Ze(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ze(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],f=u[1],m=null!=o?o:s,d=(0,i.useCallback)((function(){void 0===o&&f(!m),null==c||c(!m)}),[m,o,c]),p=i.createElement(re.Ay,{className:"options-button",size:"small",onClick:d},a||"Options",i.createElement(We,{type:"closePanel",className:"button-arrow",style:{fontSize:"15px"}}));return i.createElement("div",{className:"bottom-panel"},i.createElement(Ae.A,{className:"drawer",placement:"bottom",closable:!1,getContainer:!1,open:m,mask:!1,title:p,height:null!=l?l:190},i.createElement("div",{className:"drawer-body-wrapper"},r)))};function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){Qe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qe(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ke(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ke(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ke(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Je=(0,H.DK)((function(e){var t=i.createRef();i.useEffect((function(){t.current.appendChild(e.view3d.getDOMElement())}),[e.view3d,t]);var n,r,o=e.appHeight,a=e.changeViewerSetting,u=e.visibleControls,s=e.numTimesteps,f=e.numScenes,m=e.viewMode,d=e.region,p=e.slice,h=e.time,y=s>1&&f>1&&m===c.nE.threeD;return i.createElement("div",{className:"cell-canvas",style:Xe(Xe({},et.viewer),{},{height:o})},i.createElement("div",{ref:t,style:et.view3d}),i.createElement(Ye,{title:"Clipping",open:e.clippingPanelOpen,onOpenChange:e.onClippingPanelOpenChange,height:y?l.uR:l.CB},u.axisClipSliders&&!!e.image&&i.createElement(Oe,{mode:m,image:e.image,changeViewerSetting:a,numSlices:e.numSlices,numSlicesLoaded:e.numSlicesLoaded,numScenes:f,region:d,slices:p,numTimesteps:s,time:h,scene:e.scene,playControls:e.playControls,playingAxis:e.playingAxis})),(n=e.loadingImage&&!e.playingAxis?i.createElement("div",{style:et.noImage},i.createElement(J.A,{style:{fontSize:60,zIndex:1e3}})):null,(r=e.loadingImage||e.image?null:i.createElement("div",{style:et.noImage},"No image selected"))&&e.view3d&&e.view3d.removeAllVolumes(),r||n))}),["autorotate","viewMode","region","slice","time","scene","changeViewerSetting"]);var et={viewer:{display:"flex",position:"relative"},view3d:{width:"100%",display:"flex",overflow:"hidden"},noImage:{position:"absolute",zIndex:999,top:0,left:0,bottom:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#eeeee",color:"#9b9b9b",fontSize:"2em",opacity:.75}},tt=n(4604),nt=n(3955),rt=n(696),ot=n(8526),at=n(920),it=n(5189);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return(t=function(e){var t=function(e){if("object"!=lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var dt={r:"241",g:"112",b:"19",a:"1"};const pt=function(e){var t=ft(i.useState(!1),2),n=t[0],r=t[1],o=ft(i.useState(!1),2),l=o[0],c=o[1],u=ft(i.useState(e.color||dt),2),s=u[0],f=u[1],m=i.useRef(null);i.useEffect((function(){return f(e.color)}),[e.color]);var d=e.width||36,p=l?{bottom:"21px"}:{top:"0px"};return i.createElement("div",null,i.createElement("div",{style:ht.swatch,ref:m,onClick:function(){var e=m.current.getBoundingClientRect(),t=e.bottom>window.innerHeight-310;r(!n),c(t&&e.top>310)}},i.createElement("div",{style:ut(ut({},ht.color),{},{width:"".concat(d,"px"),background:"rgba(".concat((0,a.map)(s,(function(e){return e})),")")})})),i.createElement("div",{style:{position:"absolute"}},n?i.createElement("div",{style:ut(ut({},ht.popover),p)},i.createElement("div",{style:ht.cover,onClick:function(){return r(!1)}}),i.createElement(it.Xq,{color:s,onChange:function(t){var n;f(t.rgb),null===(n=e.onColorChange)||void 0===n||n.call(e,t.rgb,s,e.idx)},onChangeComplete:function(t){var n;f(t.rgb),null===(n=e.onColorChangeComplete)||void 0===n||n.call(e,t.rgb,s,e.idx)},disableAlpha:e.disableAlpha})):null))};var ht={color:{height:"14px",margin:"3px",borderRadius:"2px"},swatch:{borderRadius:"3px",border:"1px solid var(--color-controlpanel-border)",display:"inline-block",cursor:"pointer",verticalAlign:"middle"},popover:{position:"absolute",zIndex:"9999"},cover:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},yt={to:Math.round,from:Number};const vt=function(e){return i.createElement("div",{className:"viewer-control-row"},i.createElement("div",{className:"control-name"},e.label),i.createElement("div",{className:"control"},void 0===e.start?e.children:!e.hideSlider&&i.createElement(ve,{range:{min:0,max:e.max},start:e.start,connect:!0,tooltips:!0,behaviour:"drag",format:e.formatInteger?yt:void 0,onUpdate:e.onUpdate,onChange:e.onChange})))};var bt=n(126),gt=n(5457);function wt(e){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(e)}function St(e){return function(e){if(Array.isArray(e))return jt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||At(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){xt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xt(e,t,n){return(t=function(e){var t=function(e){if("object"!=wt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||At(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){if(e){if("string"==typeof e)return jt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(e,t):void 0}}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Pt=function(e){return e.Min="min",e.Max="max",e}(Pt||{}),kt={autoXF:function(e){var t=Ot(e.findAutoMinMax(),2),n=t[0],o=t[1];return(new r.Sd).createFromMinMax(n,o)},auto2XF:function(e){var t=Ot(e.findAutoIJBins(),2),n=t[0],o=t[1];return(new r.Sd).createFromMinMax(n,o)},auto98XF:function(e){var t=e.findBinOfPercentile(l.BO),n=e.findBinOfPercentile(l.xB);return(new r.Sd).createFromMinMax(t,n)},bestFitXF:function(e){var t=Ot(e.findBestFitBins(),2),n=t[0],o=t[1];return(new r.Sd).createFromMinMax(n,o)},resetXF:function(e){return(new r.Sd).createFullRange()}},Mt={draw:function(e,t){var n=Math.sqrt(1.9*t),r=.4*n,o=.325*n;e.moveTo(-o,-n),e.lineTo(o,-n),e.lineTo(o,-r),e.lineTo(0,0),e.lineTo(-o,-r),e.closePath()}};function It(e,t){return t.getValueFromBinIndex(e)}function Tt(e,t){return t.findFractionalBinOfValue(e)}function Lt(e,t){return It(e.x,t)}var Nt=function(e,t,n){return[Ct(Ct({},e),{},{x:t}),Ct(Ct({},e),{},{x:n})]},Dt=function(e,t,n){var r=(n-e.x)/(t.x-e.x);return{x:n,opacity:e.opacity+(t.opacity-e.opacity)*r,color:e.color.map((function(e,n){return e+(t.color[n]-e)*r}))}},Vt=function(e){var t=e.controlPoints,n=e.id,r=t[t.length-1].x-t[0].x;return i.createElement("defs",null,i.createElement("linearGradient",{id:n,gradientUnits:"objectBoundingBox",spreadMethod:"pad",x2:"100%"},t.map((function(e,n){var o="".concat((e.x-t[0].x)/r*100,"%"),a=Math.min(e.opacity,.75);return i.createElement("stop",{key:n,stopColor:h(e.color),stopOpacity:a,offset:o})}))))},Rt=function(e){return void 0===e?"":Number(e).toFixed(0)},Bt=function(e,t,n){return Math.min(Math.max(e,t),n)};const zt=function(e){var t=e.changeChannelSetting,n=e.plotMin,r=e.plotMax,o=e.width-25-20,a=e.height-18-30,c=Ot((0,i.useState)(null),2),u=c[0],s=c[1],f=Ot((0,i.useState)(null),2),p=f[0],y=f[1],v=(0,i.useCallback)((function(e){return t({controlPoints:e})}),[t]),b=(0,i.useCallback)((function(e){return t({ramp:e})}),[t]),g=Ot((0,O.G)(v,e.controlPoints),2),w=g[0],S=g[1],x=Ot((0,O.G)(y,p),2),A=x[0],j=x[1],P=Ot((0,i.useState)(null),2),k=P[0],M=P[1],I=(0,i.useRef)(l.YT),T=(0,i.useRef)(null),L=e.channelData.histogram,N=l.L9[e.channelData.dtype],D=(0,i.useMemo)((function(){return gt.m4Y().domain([n,r]).range([0,o])}),[o,n,r]),V=(0,i.useMemo)((function(){return Tt(n,L)}),[n,L]),R=(0,i.useMemo)((function(){return Tt(r,L)}),[r,L]),B=(0,i.useMemo)((function(){return gt.m4Y().domain([0,1]).range([a,0])}),[a]),z=function(e){var t,n,r=null!==(t=null===(n=T.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==t?t:{x:0,y:0};return[Tt(D.invert(Bt(e.clientX-r.x-25,0,o)),L),B.invert(Bt(e.clientY-r.y-18,0,a))]},F=function(e){j(null),e.currentTarget.releasePointerCapture(e.pointerId)},H=function(e){if(e.preventDefault(),e.target&&T.current){var t=T.current.getBoundingClientRect(),n=e.target.getBoundingClientRect(),r=n.left+n.width/2-t.left<t.width/2?n.right-t.left+2:n.left-t.right-2,o=window.innerHeight-n.bottom<310?t.top-n.bottom:n.top-t.top;M([r,o])}else M(null)},U=(0,i.useMemo)((function(){return function(e,t,n){var r=e.slice(),o=r[0],a=r[r.length-1];if(a.x<t)return Nt(a,t,n);if(o.x>n)return Nt(o,t,n);if(o.x>t)r.unshift(Ct(Ct({},o),{},{x:t}));else{for(var i=void 0;r[0].x<t&&r.length>1;)i=r.shift();void 0!==i&&r.unshift(Dt(i,r[0],t))}if(a.x<n)r.push(Ct(Ct({},a),{},{x:n}));else{for(var l=void 0;r[r.length-1].x>n&&r.length>1;)l=r.pop();void 0!==l&&r.push(Dt(l,r[r.length-1],n))}return r}(e.useControlPoints?e.controlPoints.slice():C(e.ramp),V,R)}),[e.controlPoints,e.ramp,e.useControlPoints,V,R]),_=(0,i.useMemo)((function(){var e;return null!==(e=gt.Wcw().x((function(e){return D(Lt(e,L))})).y0((function(e){return B(e.opacity)})).y1(a).curve(gt.lUB)(U))&&void 0!==e?e:void 0}),[U,D,B,a,L]),G=(0,i.useMemo)((function(){var e;return null!==(e=gt.HRO().type(Mt).size(80)())&&void 0!==e?e:void 0}),[]),$=(0,i.useCallback)((function(t){var n=D.ticks(4),r=Ot(D.domain(),2),o=r[0],a=r[1],i=a-o;(n[0]-o)/i<.1?n[0]=o:n.unshift(o),(n[n.length-1]-o)/i>.9?n[n.length-1]=a:n.push(a),gt.Ltv(t).call(gt.l78(D).tickValues(n).tickPadding(e.useControlPoints?3:10))}),[D,e.useControlPoints]),W=(0,i.useCallback)((function(e){return gt.Ltv(e).call(gt.V4s(B).ticks(4))}),[B]),Z=(0,i.useCallback)((function(e){if(null!==e){var t=L.getNumBins();if(!(t<1)){var n=function(e){for(var t=[],n=Number.NEGATIVE_INFINITY,r=0;r<e.getNumBins();r++){var o=e.getBin(r);t.push(o),n=Math.max(n,o)}return{binLengths:t,max:n}}(L),r=n.binLengths,i=n.max,l=Math.max(0,Math.ceil(V)),c=Math.min(t,Math.floor(R)),u=r.slice(l,c),s=o/(R-V),f=gt.ZEH().domain([.1,i]).range([a,0]).base(2).clamp(!0);gt.Ltv(e).selectAll(".bar").data(u).join("rect").attr("class","bar").attr("width",s).attr("x",(function(e,t){return D(It(t+l,L))})).attr("y",(function(e){return f(e)})).attr("height",(function(e){return a-f(e)}))}}}),[D,L,o,a,V,R]),Y=(0,i.useCallback)((function(t){s(null),I.current=l.YT;var n=kt[t](L);e.useControlPoints?S(n.controlPoints.map((function(e){return Ct(Ct({},e),{},{color:l.YT})}))):b(E(n.controlPoints))}),[L,e.useControlPoints,S,b]),K=function(e,t,n){return i.createElement(ne.A,{title:n,placement:"top"},i.createElement(re.Ay,{size:"small",onClick:function(){return Y(e)}},t))},q=e.useControlPoints?e.controlPoints.filter((function(e){return V<=e.x&&e.x<=R})).map((function(e,t){return i.createElement("circle",{key:t,className:t===u?"selected":"",cx:D(Lt(e,L)),cy:B(e.opacity),style:{fill:h(e.color)},r:5,onPointerDown:function(){return j(t)},onContextMenu:H})})):null;null!==q&&null!==u&&q.push(q.splice(u,1)[0]);var X,Q,J,ee,te=e.useControlPoints?"advanced":"basic";return i.createElement("div",null,i.createElement("div",{className:"button-row"},K("auto98XF","Default","Ramp from 50th percentile to 98th"),K("auto2XF","IJ Auto",'Emulates ImageJ\'s "auto" button'),K("resetXF","Auto 1","Ramp over the full data range (0% to 100%)"),K("bestFitXF","Auto 2","Ramp over the middle 80% of data"),i.createElement(at.A,{checked:e.useControlPoints,onChange:function(e){return t({useControlPoints:e.target.checked})},style:{marginLeft:"auto"}},"Advanced")),!e.useControlPoints&&i.createElement("div",{className:"tf-editor-control-row ramp-row"},"Levels min/max",i.createElement(bt.A,{value:It(e.ramp[0],L),onChange:function(t){return null!==t&&b([Tt(t,L),e.ramp[1]])},formatter:Rt,min:N.min,max:Math.min(It(e.ramp[1],L),N.max),size:"small",controls:!1}),i.createElement(bt.A,{value:It(e.ramp[1],L),onChange:function(t){return null!==t&&b([e.ramp[0],Tt(t,L)])},formatter:Rt,min:Math.max(N.min,It(e.ramp[0],L)),max:N.max,size:"small",controls:!1})),null!==k&&i.createElement("div",{className:"tf-editor-popover"},i.createElement("div",{className:"tf-editor-cover",onClick:function(){return M(null)}}),i.createElement("div",{style:(X=k,Q=Ot(X,2),J=Q[0],ee=Q[1],xt(xt({position:"absolute"},J<0?"right":"left",Math.abs(J)),ee<0?"bottom":"top",ee))},i.createElement(it.Xq,{color:d(I.current),onChange:function(t){if(I.current=m(t.rgb),null!==u){var n=St(e.controlPoints);n[u].color=I.current,S(n)}},disableAlpha:!0}))),i.createElement("svg",{className:"tf-editor-svg ".concat(te).concat(null!==p?" dragging":""),ref:T,width:e.width,height:e.height,onPointerDown:function(t){if(e.useControlPoints){if(null===A.current&&0===t.button){var n=Ot(z(t),2),r={x:n[0],opacity:n[1],color:I.current},o=gt.ylB((function(e,t){return e.x-t.x})).left(e.controlPoints,r);j(o);var a=St(e.controlPoints);a.splice(o,0,r),S(a)}else w.current=e.controlPoints;"string"!=typeof A.current&&s(A.current)}0===t.button&&null!==A.current?t.currentTarget.setPointerCapture(t.nativeEvent.pointerId):j(null)},onPointerMove:function(t){if(null!==A.current)if(1&t.buttons){t.stopPropagation(),t.preventDefault();var n=Ot(z(t),2),r=n[0],o=n[1];"number"==typeof A.current?function(e,t,n){var r=St(w.current),o=r[e];o.x=t,o.opacity=n;var a=gt.ylB((function(e,t){return e.x-t.x})),i=a.left(r,o),l=a.right(r,o);if(i<e){var c=e-i;r.splice(i,c);var u=e-c;j(u),s(u)}else l>e+1&&r.splice(e+1,l-e-1);S(r)}(A.current,r,o):function(t,n){if(t===Pt.Min){var r=e.ramp[1];b([Math.min(n,r),r])}else{var o=e.ramp[0];b([o,Math.max(n,o)])}}(A.current,r)}else F(t)},onPointerUp:F},i.createElement(Vt,{controlPoints:U,id:"tfGradient-".concat(e.id)}),i.createElement("g",{transform:"translate(".concat(25,",").concat(18,")")},i.createElement("g",{ref:Z}),i.createElement("path",{className:"line",fill:"url(#tfGradient-".concat(e.id,")"),d:_}),i.createElement("g",{ref:$,className:"axis",transform:"translate(0,".concat(a,")")}),i.createElement("g",{ref:W,className:"axis"}),q,!e.useControlPoints&&i.createElement("g",{className:"ramp-sliders"},V<=e.ramp[0]&&e.ramp[0]<=R&&i.createElement("g",{transform:"translate(".concat(D(It(e.ramp[0],L)),")")},i.createElement("line",{y1:a,strokeDasharray:"5,5",strokeWidth:2}),i.createElement("line",{className:"ramp-slider-click-target",y1:a,strokeWidth:6,onPointerDown:function(){return j(Pt.Min)}}),i.createElement("path",{d:G,transform:"translate(0,".concat(a,") rotate(180)"),onPointerDown:function(){return j(Pt.Min)}})),V<=e.ramp[1]&&e.ramp[1]<=R&&i.createElement("g",{transform:"translate(".concat(D(It(e.ramp[1],L)),")")},i.createElement("line",{y1:a,strokeDasharray:"5,5",strokeWidth:2}),i.createElement("line",{className:"ramp-slider-click-target",y1:a,strokeWidth:6,onPointerDown:function(){return j(Pt.Max)}}),i.createElement("path",{d:G,onPointerDown:function(){return j(Pt.Max)}}))))),i.createElement("div",{className:"tf-editor-control-row plot-range-row"},"Plot min/max",i.createElement(bt.A,{value:n,onChange:function(e){return null!==e&&t({plotMin:e,plotMax:Math.max(e+1,r)})},formatter:Rt,min:N.min,max:N.max-1,size:"small",controls:!1}),i.createElement(bt.A,{value:r,onChange:function(e){return null!==e&&t({plotMax:e,plotMin:Math.min(e-1,n)})},formatter:Rt,min:N.min+1,max:N.max,size:"small",controls:!1}),i.createElement(re.Ay,{size:"small",style:{marginLeft:"12px"},onClick:function(){return t({plotMin:e.channelData.rawMin,plotMax:e.channelData.rawMax})}},"Fit to data"),i.createElement(re.Ay,{size:"small",onClick:function(){return t({plotMin:N.min,plotMax:N.max})}},"Full range")),i.createElement(vt,{label:i.createElement(at.A,{checked:e.colorizeEnabled,onChange:function(e){return t({colorizeEnabled:e.target.checked})}},"Colorize"),max:1,start:e.colorizeAlpha,onUpdate:function(e){return t({colorizeAlpha:e[0]})},hideSlider:!e.colorizeEnabled}))};function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ht(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ht(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Ut=function(e){var t,n,r,o,a,c,u,s=e.index,f=e.changeChannelSetting,p=e.saveIsosurface,h=e.channelState,y=Ft((0,i.useState)(!1),2),v=y[0],b=y[1],g=(0,i.useCallback)((function(e){return f(s,e)}),[f,s]),w=i.createElement("div",{className:"channel-visibility-controls"},i.createElement(at.A,{checked:h.volumeEnabled,onChange:function(e){var t=e.target;f(s,{volumeEnabled:t.checked})}},"Vol"),i.createElement(at.A,{checked:h.isosurfaceEnabled,onChange:function(e){var t=e.target;f(s,{isosurfaceEnabled:t.checked})}},"Surf"),i.createElement(re.Ay,{icon:i.createElement(We,{type:"preferences",style:{fontSize:"16px"}}),onClick:function(){return b(!v)},title:"Open channel settings",type:"text"})),S=v?"channel-row":"channel-row controls-closed";return i.createElement(ot.A.Item,{key:s,className:S},i.createElement(ot.A.Item.Meta,{title:e.name,avatar:i.createElement(pt,{color:d(h.color),onColorChange:function(t,n,r){var o=m(t);e.changeChannelSetting(r,{color:o})},onColorChangeComplete:e.onColorChangeComplete,disableAlpha:!0,idx:s,width:18})}),w,v&&i.createElement("div",{style:{width:"100%"}},h.volumeEnabled||h.isosurfaceEnabled?i.createElement(i.Fragment,null,h.volumeEnabled&&i.createElement(i.Fragment,null,i.createElement("h4",null,"Volume settings:"),(t=h.controlPoints,n=h.colorizeEnabled,r=h.colorizeAlpha,o=h.useControlPoints,a=h.ramp,c=h.plotMin,u=h.plotMax,i.createElement(zt,{id:"TFEditor"+s,width:418,height:145,channelData:e.channelDataForChannel,controlPoints:t,changeChannelSetting:g,colorizeEnabled:n,colorizeAlpha:r,useControlPoints:o,ramp:a,plotMin:c,plotMax:u}))),h.isosurfaceEnabled&&i.createElement(i.Fragment,null,i.createElement("h4",null,"Surface settings:"),i.createElement("div",null,i.createElement(vt,{label:"Isovalue",max:255,start:h.isovalue,onChange:function(e){var t=Ft(e,1)[0];return g({isovalue:t})},formatInteger:!0}),i.createElement(vt,{label:"Opacity",max:l.yu,start:h.opacity*l.yu,onChange:function(e){var t=Ft(e,1)[0];return g({opacity:t/l.yu})},formatInteger:!0}),i.createElement("div",{className:"button-row"},i.createElement(re.Ay,{onClick:function(){return p(s,"GLTF")}},"Export GLTF"),i.createElement(re.Ay,{onClick:function(){return p(s,"STL")}},"Export STL"))))):i.createElement("h4",{style:{fontStyle:"italic"}},"Not currently visible")))},_t=function(e){var t=!!e.checkedList.length&&e.checkedList.length<e.allOptions.length,n=e.checkedList.length===e.allOptions.length;return i.createElement(at.A,{indeterminate:t,onChange:function(t){var n=t.target;return e.onChange(n.checked,e.allOptions)},checked:n,style:e.style},e.children)};function Gt(e){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gt(e)}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Zt=(0,H.DK)((function(e){var t=e.channelGroupedByType,n=e.channelSettings,r=e.channelDataChannels,o=e.filterFunc,a=e.viewerChannelSettings,l=function(t){return function(n,r){var o,a,i;e.changeChannelSetting(r,(o={},i=n,(a=function(e){var t=function(e){if("object"!=Gt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Gt(t)?t:t+""}(a=t))in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i,o))}},c=l("volumeEnabled"),u=l("isosurfaceEnabled"),s=function(e){var t=[],r=[];return e.forEach((function(e){var o=n[e];o&&(o.volumeEnabled&&t.push(e),o.isosurfaceEnabled&&r.push(e))})),i.createElement(i.Fragment,null,i.createElement(_t,{allOptions:e,checkedList:t,onChange:c},"All Vol"),i.createElement(_t,{allOptions:e,checkedList:r,onChange:u,style:{flex:5}},"All Surf"))},f=function(t){var o=n[t];return o?i.createElement(Ut,{key:"".concat(t,"_").concat(o.name,"_").concat(t),index:t,channelDataForChannel:r[t],name:(0,y.Mn)(o.name,t,a),channelState:o,changeChannelSetting:e.changeChannelSetting,onColorChangeComplete:e.onColorChangeComplete,saveIsosurface:e.saveIsosurface}):null},m=Object.keys(t)[0],d=r&&Object.entries(t).filter((function(e){var t=$t(e,2),n=t[0];return t[1].length>0&&(!o||o(n))})).map((function(e){var t=$t(e,2),n=t[0],r=t[1];return{key:n,label:n,children:i.createElement(ot.A,{itemLayout:"horizontal",dataSource:r,renderItem:f}),extra:s(r)}}));return i.createElement(rt.A,{bordered:!1,defaultActiveKey:m,items:d,collapsible:"icon"})}),["channelSettings","changeChannelSetting"]);var Yt=function(e){var t=e.color,n=e.onColorChange,r=e.children;return i.createElement("div",{style:Kt.colorPickerRow},i.createElement("span",{style:Kt.colorPicker},i.createElement(pt,{color:d(t),onColorChange:function(e){return n(m(e))},width:18,disableAlpha:!0})),i.createElement("span",null,r))},Kt={colorPickerRow:{padding:"14px 0",display:"flex",borderBottom:"1px solid #6e6e6e",color:"var(--color-controlpanel-text)"},colorPicker:{marginRight:"16px"}};const qt=(0,H.DK)((function(e){return i.createElement(i.Fragment,null,e.visibleControls.backgroundColorPicker&&i.createElement(Yt,{color:e.backgroundColor,onColorChange:function(t){return e.changeViewerSetting("backgroundColor",t)}},"Background color"),e.visibleControls.boundingBoxColorPicker&&i.createElement(Yt,{color:e.boundingBoxColor,onColorChange:function(t){return e.changeViewerSetting("boundingBoxColor",t)}},"Bounding box color",!e.showBoundingBox&&i.createElement("i",null," - bounding box turned off")))}),["showBoundingBox","backgroundColor","boundingBoxColor","changeViewerSetting"]),Xt=(0,H.DK)((function(e){var t=function(t,n,r,o){return i.createElement(vt,{label:t,start:n,max:r,onUpdate:function(t,n,r){var a=1===r.length?r[0]:r;e.changeViewerSetting(o,a)}})},n=e.visibleControls,r=e.maskAlpha,o=e.brightness,a=e.density,l=e.levels;return i.createElement("div",{style:{paddingTop:18,paddingBottom:22}},n.alphaMaskSlider&&t("mask cell",r,100,"maskAlpha"),n.brightnessSlider&&t("brightness",o,100,"brightness"),n.densitySlider&&t("density",a,100,"density"),n.levelsSliders&&t("levels",l,255,"levels"),n.interpolationControl&&i.createElement(vt,{label:"interpolate"},i.createElement(at.A,{checked:e.interpolationEnabled,onChange:function(t){var n=t.target;return e.changeViewerSetting("interpolationEnabled",n.checked)}})))}),["maskAlpha","brightness","density","levels","interpolationEnabled","changeViewerSetting"]);var Qt=n(8e3);function Jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function en(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?en(Object(n),!0).forEach((function(t){nn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nn(e,t,n){return(t=function(e){var t=function(e){if("object"!=rn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}var on=function(e){return"object"===rn(e)&&null!==e},an=function(e){var t,n,r=e.metadata,o=e.title,a=(t=i.useState(!0),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Jt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jt(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[0],c=a[1],u=l?" metadata-collapse-collapsed":"";return i.createElement(i.Fragment,null,i.createElement("tr",{className:"metadata-row-collapse-title"+u,onClick:function(){return c(!l)}},i.createElement("td",{colSpan:2},i.createElement("span",{className:"metadata-collapse-caret"},i.createElement(Qt.A,{style:{transform:"rotate(".concat(l?0:90,"deg)")}})),o)),i.createElement("tr",{className:"metadata-row-collapse-content"+u},i.createElement("td",{className:"metadata-collapse-content",colSpan:2},i.createElement(ln,{metadata:r}))))},ln=function(e){var t=e.metadata,n=e.topLevel,r=Object.keys(t),o=Array.isArray(t);return i.createElement("table",{className:"viewer-metadata-table"+(n?" metadata-top-level":"")},i.createElement("tbody",null,r.map((function(e,n){var r=function(e){if(!on(e)||Array.isArray(e))return e;var t={},n={};for(var r in e)on(e[r])?t[r]=e[r]:n[r]=e[r];return tn(tn({},t),n)}(o?t[n]:t[e]);return on(r)?i.createElement(an,{key:e,metadata:r,title:e}):i.createElement("tr",{key:e},i.createElement("td",{className:"metadata-key"},e),i.createElement("td",{className:"metadata-value"},r+""))}))))};const cn=function(e){var t=e.metadata;return i.createElement(ln,{metadata:t,topLevel:!0})};function un(){return un=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},un.apply(null,arguments)}function sn(e){return sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sn(e)}function fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function mn(e,t,n){return(t=function(e){var t=function(e){if("object"!=sn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==sn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dn=function(e){return e[e.Channels=0]="Channels",e[e.Advanced=1]="Advanced",e[e.Metadata=2]="Metadata",e}(dn||{}),pn=mn(mn(mn({},dn.Channels,"Channel Settings"),dn.Advanced,"Advanced Settings"),dn.Metadata,"Metadata");const hn=(0,H.DK)((function(e){var t,n,r,o,a,c=(o=i.useState(dn.Channels),a=2,function(e){if(Array.isArray(e))return e}(o)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(o,a)||function(e,t){if(e){if("string"==typeof e)return fn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fn(e,t):void 0}}(o,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],s=c[1],f=i.useRef(null),m=f.current?function(){return f.current}:void 0,d=e.viewerChannelSettings,p=e.visibleControls,h=e.hasImage,y=function(t,n){return i.createElement(ne.A,un({title:pn[t],placement:"right"},!e.collapsed&&{open:!1}),i.createElement(re.Ay,{className:u===t?"ant-btn-icon-only btn-tabactive":"ant-btn-icon-only",onClick:function(){return s(t),void e.setCollapsed(!1)},icon:"string"==typeof n?n:void 0},"object"===sn(n)&&n))};return i.createElement("div",{className:"control-panel-col-container",ref:f},i.createElement("div",{className:"control-panel-tab-col",style:{flex:"0 0 50px"}},i.createElement(re.Ay,{className:"ant-btn-icon-only btn-collapse"+(e.collapsed?" btn-collapse-collapsed":""),onClick:function(){return e.setCollapsed(!e.collapsed)}},i.createElement(We,{type:"closePanel"})),i.createElement("div",{className:"tab-divider"}),y(dn.Channels,i.createElement(We,{type:"channels"})),y(dn.Advanced,i.createElement(We,{type:"preferences"})),e.visibleControls.metadataViewer&&y(dn.Metadata,i.createElement(We,{type:"metadata"}))),i.createElement("div",{className:"control-panel-col",style:{flex:"0 0 450px"}},i.createElement("h2",{className:"control-panel-title"},pn[u]),p.colorPresetsDropdown&&u===dn.Channels&&(r={items:l.D8.map((function(e,t){return{key:t,label:e.name}})),onClick:function(t){var n=t.key;return e.onApplyColorPresets(l.D8[n].colors)}},i.createElement("div",{className:"color-presets-dropdown"},i.createElement(tt.A,{trigger:["click"],menu:r,getPopupContainer:m},i.createElement(re.Ay,null,i.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"4px"}},"Apply palette",i.createElement(We,{type:"dropdownArrow",style:{fontSize:"14px"}})))))),h&&i.createElement("div",{className:"channel-rows-list"},u===dn.Channels&&i.createElement(Zt,{channelDataChannels:e.channelDataChannels,channelGroupedByType:e.channelGroupedByType,saveIsosurface:e.saveIsosurface,onColorChangeComplete:e.onColorChangeComplete,onApplyColorPresets:e.onApplyColorPresets,filterFunc:e.filterFunc,viewerChannelSettings:d}),u===dn.Advanced&&(t=[{key:0,label:"Rendering adjustments",children:i.createElement(Xt,{imageName:e.imageName,pixelSize:e.pixelSize,visibleControls:p})}],(n=p.backgroundColorPicker||p.boundingBoxColorPicker)&&t.push({key:1,label:"Customize",children:i.createElement(qt,{visibleControls:e.visibleControls})}),i.createElement(nt.A,{gap:10,vertical:!0},i.createElement(rt.A,{bordered:!1,defaultActiveKey:n?[0,1]:0,items:t}),i.createElement("div",{style:{margin:"0 10px",width:"fit-content"}},i.createElement(ne.A,{trigger:["hover","focus"],placement:"right",title:"Clears ALL rendering settings and channel configuration to the default viewer state. This will replace any edits to channel settings, color presets, and rendering adjustments."},i.createElement(re.Ay,{onClick:e.resetToDefaultViewerState},"Clear all settings"))))),u===dn.Metadata&&i.createElement(cn,{metadata:e.getMetadata()}))))}),["resetToDefaultViewerState"]);var yn=n(7260);function vn(e){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vn(e)}function bn(e){return function(e){if(Array.isArray(e))return Sn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||wn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||wn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wn(e,t){if(e){if("string"==typeof e)return Sn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sn(e,t):void 0}}function Sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function En(e,t,n){return(t=function(e){var t=function(e){if("object"!=vn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=vn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==vn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cn=function(e){var t=e.bug,n=e.children;return i.createElement("a",{href:"https://github.com/allen-cell-animated/vole-app/issues/new".concat(t?"?template=bug_report.md":"/choose"),target:"_blank",rel:"noreferrer noopener"},n)},xn=i.createElement(i.Fragment,null,"An unknown error occurred. Check the browser console (F12) for more details. If this looks like a bug,"," ",i.createElement(Cn,{bug:!0},"send us a bug report here"),"."),On=En(En(En(En(En(En({},r.f8.UNKNOWN,i.createElement(i.Fragment,null,"An unknown error occurred while loading volume data. Check the browser console (F12) for more details. If this looks like a bug, ",i.createElement(Cn,{bug:!0},"send us a bug report here"),".")),r.f8.NOT_FOUND,i.createElement(i.Fragment,null,"The viewer was unable to find any volume data at the specified location. Check that the provided URL is correct and try again.")),r.f8.TOO_LARGE,i.createElement(i.Fragment,null,"No scale level is available for this volume which fits within our maximum GPU memory footprint. This maximum is tuned to ensure compatibility with the majority of browsers. If you're trying to load your own OME-Zarr dataset, you may be able to open this volume by including a lower scale level.")),r.f8.LOAD_DATA_FAILED,i.createElement(i.Fragment,null,"The viewer was able to find a source of volume data at the specified location, but encountered an error while trying to load it. Check that your dataset is complete and properly formatted. You can also check the browser console (F12) for more details about this error. If it looks like a problem on our end,"," ",i.createElement(Cn,{bug:!0},"start a bug report here"),".")),r.f8.INVALID_METADATA,i.createElement(i.Fragment,null,"The viewer was unable to read all necessary information from this volume's metadata. Check that your dataset's metadata is complete and properly formatted. If you believe your data is valid and should be supported by our viewer, let us know by ",i.createElement(Cn,null,"opening a GitHub issue"),".")),r.f8.INVALID_MULTI_SOURCE_ZARR,i.createElement(i.Fragment,null,"The viewer is currently configured to consolidate multiple OME-Zarr datasets into a single volume, but the provided datasets can't all be matched up. Ensure that all dataset URLs are correct and that at least one equivalently-sized scale level exists in all datasets.")),An=function(e){var t;return e instanceof Error&&(null===(t=e.toString)||void 0===t?void 0:t.call(e))||"Unknown error"},jn=function(e){var t=e.errors,n=e.firstErrorCount,r=void 0===n?0:n,o=e.afterClose,a=e.onSkipError,l=gn(i.useState(!1),2),c=l[0],u=l[1],s=gn(i.useState(0),2),f=s[0],m=s[1],d=Array.isArray(t)?t[0]:t,p=i.createElement(i.Fragment,null,i.createElement("div",null,An(d)+(r>1?" (".concat(r,")"):"")," ",i.createElement(re.Ay,{type:"text",onClick:function(){return u(!c)}},c?"Show less info":"Show more info")),i.createElement("div",{style:{display:c?void 0:"none"}},function(e){var t,n=e.type;return n&&null!==(t=On[n])&&void 0!==t?t:xn}(d))),h=Array.isArray(t)&&t.length>1&&i.createElement(re.Ay,{type:"text",onClick:function(){m((function(e){return e+1})),null==a||a()}},"Error ",f+1," of ",t.length+f," ",i.createElement(Qt.A,null));return i.createElement(yn.A,{showIcon:!0,type:"error",className:"load-error-alert",message:p,closable:!0,afterClose:function(){m(0),null==o||o()},action:h})},Pn=n(1130),kn=n(581),Mn=n(770),In=n(9772);const Tn=function(e){var t=e.fovDownloadHref,n=e.cellDownloadHref;if(e.hasFov){var r={className:"download-dropdown",items:[{key:"1",label:i.createElement("a",{href:n},i.createElement(We,{type:"download"})," Segmented cell")},{key:"2",label:i.createElement("a",{href:t},i.createElement(We,{type:"download"})," Full field image")}]};return i.createElement(ne.A,{trigger:["hover","focus"],placement:"bottom",title:"Download volume data"},i.createElement(tt.A,{menu:r,placement:"bottomRight",trigger:["click"]},i.createElement(re.Ay,{className:"ant-btn-icon-only btn-borderless"},i.createElement(We,{type:"download"}))))}return n?i.createElement(ne.A,{trigger:["hover","focus"],placement:"bottom",title:"Download volume data"},i.createElement(re.Ay,{className:"ant-btn-icon-only btn-borderless",href:n},i.createElement(We,{type:"download"}))):null};var Ln=[c.nE.threeD,c.nE.xy,c.nE.xz,c.nE.yz];const Nn=function(e){return i.createElement(Mn.Ay.Group,{onChange:function(t){var n=t.target;e.mode!==n.value&&e.onViewModeChange(n.value)},value:e.mode.toString()},Ln.map((function(e,t){return i.createElement(Mn.Ay.Button,{key:t,value:e.toString()},e)})))};function Dn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Vn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Rn={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Bn=(0,H.DK)((function(e){var t=i.useRef(null),n=i.useRef(null),r=i.useRef(null),o=i.useRef(null),l=i.useRef(null),u=Dn(i.useState(!1),2),s=u[0],f=u[1],m=Dn(i.useState(!1),2),d=m[0],p=m[1],h=Dn(i.useState(!1),2),y=h[0],v=h[1],b=i.useCallback((function(){var e=n.current;e&&(p(e.scrollLeft>0),v(e.scrollLeft<e.scrollWidth-e.clientWidth))}),[]),g=i.useMemo((function(){return(0,a.debounce)((function(){if(r.current&&l.current&&o.current&&n.current){var e=r.current.getBoundingClientRect(),t=l.current.getBoundingClientRect(),a=o.current.getBoundingClientRect();f((function(r){return r?n.current.getBoundingClientRect().width<=2*Math.max(e.width,a.width)+t.width+15:e.right>t.left||t.right>a.left})),b()}}),50)}),[b]);i.useEffect((function(){return g(),window.addEventListener("resize",g),function(){return window.removeEventListener("resize",g)}}),[g]);var w=function(e){return n.current.scrollLeft+=e},S=function(e){return"ant-btn-icon-only btn-borderless"+(e?" btn-active":"")},E=e.changeViewerSetting,C=e.resetToSavedViewerState,x=e.visibleControls,O=e.showAxes,A=e.showBoundingBox,j=e.autorotate,P=e.viewMode!==c.nE.threeD,k=x.viewModeRadioButtons||x.resetCameraButton||x.autoRotateButton,M=x.showAxesButton||x.showBoundingBoxButton,I=O?"Hide axes":"Show axes",T=A?"Hide bounding box":"Show bounding box",L=j?"Turn off turntable":"Turn on turntable",N=t.current?function(){return t.current}:void 0;return i.createElement("div",{className:"viewer-toolbar-container".concat(s?" viewer-toolbar-scroll":""),ref:t},i.createElement("div",{className:"viewer-toolbar-scroll-left",style:{display:d?"flex":"none"},onClick:function(){return w(-100)}},i.createElement(We,{type:"closePanel",style:{fontSize:"12px",transform:"rotate(180deg)"}})),i.createElement("div",{className:"viewer-toolbar",ref:n,onWheel:function(e){e.preventDefault(),0!==e.deltaY&&w(e.deltaY)},onScroll:b},i.createElement("div",{className:"viewer-toolbar-left",ref:r},i.createElement(ne.A,{placement:"bottom",title:"Reset to initial settings",trigger:["focus","hover"]},i.createElement(re.Ay,{className:"ant-btn-icon-only btn-borderless",onClick:C},i.createElement(kn.A,null),i.createElement("span",{style:Rn},"Reset to initial settings")))),i.createElement("div",{className:"viewer-toolbar-center",ref:l},k&&i.createElement("div",{className:"viewer-toolbar-group"},x.viewModeRadioButtons&&i.createElement(Nn,{mode:e.viewMode,onViewModeChange:function(e){return E("viewMode",e)}}),x.resetCameraButton&&i.createElement(ne.A,{placement:"bottom",title:"Reset camera"},i.createElement(re.Ay,{className:"ant-btn-icon-only btn-borderless",onClick:e.resetCamera},i.createElement(We,{type:"resetView"}))),x.autoRotateButton&&i.createElement(ne.A,{placement:"bottom",title:L},i.createElement(re.Ay,{className:S(j&&!P),disabled:P||e.renderMode===c.G9.pathTrace,onClick:function(){return E("autorotate",!j)}},i.createElement(We,{type:"turnTable"})))),x.fovCellSwitchControls&&e.hasCellId&&e.hasParentImage&&i.createElement("div",{className:"viewer-toolbar-group"},i.createElement(Mn.Ay.Group,{value:e.imageType,onChange:function(e){var t=e.target;return E("imageType",t.value)}},i.createElement(Mn.Ay.Button,{value:c.yj.segmentedCell},"Single cell"),i.createElement(Mn.Ay.Button,{value:c.yj.fullField},"Full field"))),i.createElement("div",{className:"viewer-toolbar-group"},i.createElement(In.A,{className:"select-render-setting",popupClassName:"viewer-toolbar-dropdown",value:e.renderMode,onChange:function(e){return E("renderMode",e)},getPopupContainer:N},i.createElement(In.A.Option,{value:c.G9.volumetric,key:c.G9.volumetric},"Volumetric"),e.canPathTrace&&i.createElement(In.A.Option,{value:c.G9.pathTrace,key:c.G9.pathTrace,disabled:P},"Path trace"),i.createElement(In.A.Option,{value:c.G9.maxProject,key:c.G9.maxProject},"Max project"))),M&&i.createElement("div",{className:"viewer-toolbar-group"},x.showAxesButton&&i.createElement(ne.A,{placement:"bottom",title:I},i.createElement(re.Ay,{className:S(O),onClick:function(){return e.changeViewerSetting("showAxes",!e.showAxes)}},i.createElement(We,{type:"axes"}))),x.showBoundingBoxButton&&i.createElement(ne.A,{placement:"bottom",title:T},i.createElement(re.Ay,{className:S(A),onClick:function(){return e.changeViewerSetting("showBoundingBox",!e.showBoundingBox)}},i.createElement(We,{type:"boundingBox"}))))),i.createElement("div",{className:"viewer-toolbar-right viewer-toolbar-group",ref:o},i.createElement(ne.A,{placement:"bottom",title:"Download"},i.createElement(Tn,{cellDownloadHref:e.cellDownloadHref,fovDownloadHref:e.fovDownloadHref,hasFov:e.hasCellId&&e.hasParentImage})),i.createElement(ne.A,{placement:"bottom",title:"Screenshot"},i.createElement(re.Ay,{className:"ant-btn-icon-only btn-borderless",onClick:e.downloadScreenshot},i.createElement(We,{type:"camera"}))))),i.createElement("div",{className:"viewer-toolbar-scroll-right",style:{display:y?"flex":"none"},onClick:function(){return w(100)}},i.createElement(We,{type:"closePanel",style:{fontSize:"12px"}})))}),["imageType","renderMode","viewMode","autorotate","showAxes","showBoundingBox","changeViewerSetting","resetToSavedViewerState"]);function zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Fn=function(e){var t=e.index,n=e.channelState,o=e.view3d,a=e.image,l=e.version,c=n.volumeEnabled,u=n.isosurfaceEnabled,s=n.isovalue,f=n.colorizeEnabled,m=n.colorizeAlpha,d=n.opacity,p=n.color,h=function(e,t){var n;(0,i.useEffect)((function(){if(a&&l>0)return e(a)}),[].concat(function(e){if(Array.isArray(e))return zn(e)}(n=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return zn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zn(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[a,l]))};(0,i.useEffect)((function(){a&&(o.setVolumeChannelEnabled(a,t,c),o.updateLuts(a))}),[a,c,t,o]),(0,i.useEffect)((function(){a&&o.setVolumeChannelOptions(a,t,{isosurfaceEnabled:u})}),[a,u,t,o]),h((function(e){return o.setVolumeChannelOptions(e,t,{isovalue:s})}),[s,t,o]),h((function(e){return o.setVolumeChannelOptions(e,t,{isosurfaceOpacity:d})}),[d,t,o]),h((function(e){o.setVolumeChannelOptions(e,t,{color:p}),o.updateLuts(e)}),[p,t,o]);var y=n.controlPoints,v=n.ramp,b=n.useControlPoints;return h((function(e){if(!(b&&y.length<2)){var n=function(e){return(new r.Sd).createFromControlPoints(e)}(b?y:C(v));e.setLut(t,n),o.updateLuts(e)}}),[y,v,b,t,o]),h((function(e){if(f){var n=(new r.Sd).createLabelColors(e.getHistogram(t));e.setColorPalette(t,n.lut)}}),[f,t,o]),h((function(e){e.setColorPaletteAlpha(t,f?m:0),o.updateLuts(e)}),[f,m,t,o]),null};function Hn(e){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hn(e)}function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){Gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gn(e,t,n){return(t=function(e){var t=function(e){if("object"!=Hn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Hn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Hn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||Wn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){if(e){if("string"==typeof e)return Zn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zn(e,t):void 0}}function Zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Yn=o.A.Sider,Kn=o.A.Content,qn={alphaMaskSlider:!0,autoRotateButton:!0,axisClipSliders:!0,brightnessSlider:!0,backgroundColorPicker:!0,boundingBoxColorPicker:!0,colorPresetsDropdown:!0,densitySlider:!0,levelsSliders:!0,interpolationControl:!0,saveSurfaceButtons:!0,fovCellSwitchControls:!0,viewModeRadioButtons:!0,resetCameraButton:!0,showAxesButton:!0,showBoundingBoxButton:!0,metadataViewer:!0},Xn={rawData:void 0,rawDims:void 0,imageUrl:"",parentImageUrl:"",appHeight:"100vh",visibleControls:qn,viewerSettings:(0,l.$m)(),cellId:"",imageDownloadHref:"",parentImageDownloadHref:"",pixelSize:void 0,canvasMargin:"0 0 0 0",view3dRef:void 0};const Qn=function(e){var t,n,u,s,m,d,h,y;e=_n(_n({},Xn),e);var v=(0,i.useContext)(H.rm).ref,b=v.current,g=b.imageType,w=b.viewMode,A=b.channelSettings,j=b.changeChannelSetting,P=b.applyColorPresets,k=b.setSavedViewerChannelSettings,M=b.getCurrentViewerChannelSettings,I=b.getChannelsAwaitingReset,T=b.onResetChannel,L=e,N=L.onControlPanelToggle,D=L.metadata,V=L.metadataFormatter;(0,i.useMemo)((function(){e.viewerChannelSettings&&k(e.viewerChannelSettings)}),[e.viewerChannelSettings,k]);var R=(0,O.Q)((function(){return new r.Pg}));void 0!==e.view3dRef&&(e.view3dRef.current=R);var B,z,F,U,_,G,$,W,Z,Y,K,X=$n((z=(B=gn(i.useState([]),2))[0],F=B[1],U=(0,O.Q)((function(){return new Map})),G=(_=gn(i.useState([]),2))[0],$=_[1],W=i.useCallback((function(e){var t;console.error(e);var n=An(e),r=(null!==(t=U.get(n))&&void 0!==t?t:0)+1;F((function(t){return[].concat(bn(t),[e])})),$((function(e){return[].concat(bn(e),[r])})),U.set(n,r)}),[U]),Z=i.useCallback((function(){F((function(e){return e.slice(1)})),$((function(e){return e.slice(1)}))}),[]),Y=i.useCallback((function(){F([]),$([])}),[]),K=G[0],[z.length>0&&i.createElement(jn,{errors:z,firstErrorCount:K,onSkipError:Z,afterClose:Y}),W]),2),J=X[0],ee=X[1];(0,i.useEffect)((function(){return R.setLoadErrorHandler((function(e,t){return ee(t)})),function(){return R.setLoadErrorHandler(void 0)}}),[R,ee]);var te=(0,i.useRef)(""),ne=(0,i.useRef)([]),re=e,oe=re.imageUrl,ae=re.parentImageUrl,ie=re.rawData,le=re.rawDims,ce=(0,i.useMemo)((function(){if(ie&&le)return[{data:ie,metadata:le}];var e,t=g===c.yj.fullField&&void 0!==ae?ae:oe;if((0,a.isEqual)(t,te.current))return ne.current;te.current=t;var n=null!==(e=t.scenes)&&void 0!==e?e:[t];return ne.current=n,n}),[oe,ae,ie,le,g]),ue=null===(t=M())||void 0===t?void 0:t.maskChannelName,se=(0,i.useRef)([]),fe=(0,i.useCallback)((function(e){if(null!==e){se.current=new Array(e.channelNames.length).fill(void 0);var t=v.current.channelSettings;R.addVolume(e,{channels:e.channelNames.map((function(e){var n=t.find((function(t){return t.name===e}));return n?{enabled:n.volumeEnabled,isosurfaceEnabled:n.isosurfaceEnabled,isovalue:n.isovalue,isosurfaceOpacity:n.opacity,color:n.color}:{}}))}),R.updateActiveChannels(e)}}),[R,v]),me=(0,i.useCallback)((function(e,t,n){var r=A[t],o=v.current,a=o.getChannelsAwaitingResetOnLoad,i=o.getCurrentViewerChannelSettings,c=o.changeChannelSetting,u=e.getChannel(t),s=!r||!r.controlPoints||!r.ramp;if(n||s||a().has(t)){var f=S(e,t,i()),m=f.ramp,d=f.controlPoints,p=u.dtype;c(t,{controlPoints:d,ramp:E(m),plotMin:l.L9[p].min,plotMax:l.L9[p].max})}else{var h=se.current[t];if(r.useControlPoints)c(t,{ramp:E(x(C(r.ramp),h,u)),controlPoints:u.lut.controlPoints});else{var y=E(u.lut.controlPoints);c(t,{controlPoints:x(r.controlPoints,h,u),ramp:y})}}se.current[t]=[u.rawMin,u.rawMax],R.updateLuts(e),R.onVolumeData(e,[t]),e.channelNames[t]===ue&&R.setVolumeChannelAsMask(e,t),e.isLoaded()&&R.updateActiveChannels(e)}),[R,A,ue,v]),de=Q(ce,{onCreateImage:fe,onChannelLoaded:me,onError:ee,maskChannelName:ue}),pe=de.image,he=de.setTime,ye=de.setScene,ve=e.rawData&&e.rawDims?1:null!==(n=null===(u=e.imageUrl.scenes)||void 0===u?void 0:u.length)&&void 0!==n?n:1,be=null!==(s=null==pe?void 0:pe.imageInfo.volumeSize)&&void 0!==s?s:{x:1,y:1,z:1},ge=null!==(m=null==pe?void 0:pe.imageInfo.subregionSize)&&void 0!==m?m:{x:0,y:0,z:0},we=null!==(d=null==pe?void 0:pe.imageInfo.times)&&void 0!==d?d:1,Se=$n((0,i.useState)((function(){return window.innerWidth<l.lV})),2),Ee=Se[0],Ce=Se[1],xe=$n((0,i.useState)(!1),2),Oe=xe[0],Ae=xe[1],je=$n((0,i.useState)(!0),2),Pe=je[0],ke=je[1],Me=(0,i.useRef)(0),Ie=v.current,Te=(0,i.useCallback)((function(e,t){pe&&R.saveChannelIsosurface(pe,e,t)}),[pe,R]),Le=(0,i.useCallback)((function(){R.capture((function(e){var t=document.createElement("a");t.href=e,t.download="screenshot.png",t.click()}))}),[R]),Ne=(0,i.useCallback)((function(){var e,t,n=null==pe?void 0:pe.imageMetadata;return n&&V&&(n=V(n)),e=Array.isArray(D)?D.length>=ve?D[v.current.scene]:D[0]:D,n&&Object.keys(n).length>0?_n({Image:n},e):null!==(t=e)&&void 0!==t?t:{}}),[D,V,pe,ve,v]);(0,i.useEffect)((function(){var e=we>1,t=ve>1,n=Ie.viewMode===c.nE.threeD;!function(e,t,n,r,o){var a=l.lI[1],i=$n(l.UB,2),c=i[0],u=i[1];if(t){var s=(n&&r&&o?l.uR:l.CB)-40;a+=s,u+=s}n&&(c+=120,e.setShowTimestepIndicator(!0)),e.setAxisPosition(l.lI[0],a),e.setTimestepIndicatorPosition(l.UB[0],u),e.setScaleBarPosition(c,u)}(R,Pe,e,t,n),Pe&&(R.setShowScaleBar(!1),R.setShowTimestepIndicator(!1),R.setShowAxis(!1),window.clearTimeout(Me.current),Me.current=window.setTimeout((function(){R.setShowScaleBar(!0),R.setShowTimestepIndicator(!0),Ie.showAxes&&R.setShowAxis(!0)}),300))}),[R,we,ve,Ie.viewMode,Ie.showAxes,Pe]),(0,i.useEffect)((function(){var e=(0,a.debounce)((function(){window.innerWidth<l.lV?Oe||(Ce(!0),Ae(!0)):Ae(!1)}),500);return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[Oe]),(0,i.useEffect)((function(){return N&&N(Ee)}),[Ee,N]),(0,i.useEffect)((function(){window.setTimeout((function(){window.dispatchEvent(new Event("resize"))}),200)}),[Ee]);var De=function(e,t){var n;(0,i.useEffect)((function(){if(pe&&de.imageLoadStatus===q.LOADED)return e(pe)}),[].concat(function(e){if(Array.isArray(e))return Zn(e)}(n=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||Wn(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[pe,de.imageLoadStatus]))};De((function(e){R.setCameraMode(Ie.viewMode),R.resize(null)}),[Ie.viewMode,R]),De((function(e){Ie.cameraState&&R.setCameraState(Ie.cameraState)}),[Ie.cameraState,R]),De((function(e){return R.setAutoRotate(Ie.autorotate)}),[Ie.autorotate,R]),De((function(e){return R.setShowAxis(Ie.showAxes)}),[Ie.showAxes,R]),De((function(e){return R.setBackgroundColor(p(Ie.backgroundColor))}),[Ie.backgroundColor,R]),De((function(e){return R.setBoundingBoxColor(e,p(Ie.boundingBoxColor))}),[Ie.boundingBoxColor,R]),De((function(e){return R.setShowBoundingBox(e,Ie.showBoundingBox)}),[Ie.showBoundingBox,R]),De((function(e){for(var t=I(),n=0;n<A.length;n++)if(t.has(n)){var r=S(e,n,M()),o=r.ramp,a=r.controlPoints;j(n,{controlPoints:a,ramp:E(o)}),T(n)}}),[j,A,I,M,T]),De((function(e){var t=Ie.renderMode;R.setMaxProjectMode(e,t===c.G9.maxProject),R.setVolumeRenderMode(t===c.G9.pathTrace?r.Nc:r.CS),R.updateActiveChannels(e)}),[Ie.renderMode,R]),De((function(e){R.updateMaskAlpha(e,1-Ie.maskAlpha/100),R.updateActiveChannels(e)}),[Ie.maskAlpha,R]),De((function(e){var t=Ie.brightness/100;R.updateExposure(t)}),[Ie.brightness,R]),De((function(e){var t=Ie.density/100;R.updateDensity(e,t)}),[Ie.density,R]),De((function(e){var t=function(e){var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);(n>r||n<t)&&(n=.5*(t+r));var o=((n/=255)-(t/=255))/((r/=255)-t),a=4*o*o;return(n-.5)*(n-.5)<5e-4&&(a=1),{min:t,max:r,scale:a}}(Ie.levels);R.setGamma(e,t.min,t.scale,t.max)}),[Ie.levels,R]),(0,i.useEffect)((function(){return he(R,Ie.time)}),[R,Ie.time,he]),(0,i.useEffect)((function(){return ye(Ie.scene)}),[Ie.scene,ye]),De((function(e){return R.setInterpolationEnabled(e,Ie.interpolationEnabled)}),[Ie.interpolationEnabled,R]),De((function(t){var n;return R.setVolumeTranslation(t,(null===(n=e.transform)||void 0===n?void 0:n.translation)||[0,0,0])}),[null===(h=e.transform)||void 0===h?void 0:h.translation,R]),De((function(t){var n;return R.setVolumeRotation(t,(null===(n=e.transform)||void 0===n?void 0:n.rotation)||[0,0,0])}),[null===(y=e.transform)||void 0===y?void 0:y.rotation,R]);var Ve=function(e,t,n,r){var o=$n(t,2),a=o[0],i=o[1];De((function(t){var o=!1,l=0,u=1;if(r===c.nE.threeD)l=a,u=i,o=!1;else{o=f[r]===e;var s=1/t.imageInfo.volumeSize[e];l=o?n:0,u=o?n+s:1,"z"===e&&r===c.nE.xy&&R.setZSlice(t,Math.floor(n*t.imageInfo.volumeSize.z))}R.setAxisClip(t,e,l-.5,u-.5,o),R.setCameraMode(r)}),[e,a,i,n,r])};Ve("x",Ie.region.x,Ie.slice.x,w),Ve("y",Ie.region.y,Ie.slice.y,w),Ve("z",Ie.region.z,Ie.slice.z,w);var Re=(0,i.useMemo)((function(){return _n(_n({},qn),e.visibleControls)}),[e.visibleControls]),Be=(0,i.useMemo)((function(){return pe?pe.imageInfo.physicalPixelSize.toArray():[1,1,1]}),[pe]),ze=(0,i.useMemo)((function(){return R.resetCamera.bind(R)}),[R]);return i.createElement(Pn.A,null,J,i.createElement(o.A,{className:"cell-viewer-app",style:{height:e.appHeight}},A.map((function(e,t){return i.createElement(Fn,{key:"".concat(t,"_").concat(e.name),channelState:e,index:t,view3d:R,image:pe,version:de.channelVersions[t]})})),i.createElement(Yn,{className:"control-panel-holder",collapsible:!0,defaultCollapsed:!1,collapsedWidth:50,trigger:null,collapsed:Ee,width:500},i.createElement(hn,{visibleControls:Re,collapsed:Ee,imageName:null==pe?void 0:pe.name,hasImage:!!pe,pixelSize:Be,channelDataChannels:null==pe?void 0:pe.channels,channelGroupedByType:de.channelGroupedByType,setCollapsed:Ce,saveIsosurface:Te,onApplyColorPresets:P,viewerChannelSettings:e.viewerChannelSettings,getMetadata:Ne})),i.createElement(o.A,{className:"cell-viewer-wrapper",style:{margin:e.canvasMargin}},i.createElement(Kn,null,i.createElement(Bn,{fovDownloadHref:e.parentImageDownloadHref,cellDownloadHref:e.imageDownloadHref,hasParentImage:!!e.parentImageUrl,hasCellId:!!e.cellId,canPathTrace:!!R&&R.hasWebGL2(),resetCamera:ze,downloadScreenshot:Le,visibleControls:Re}),i.createElement(Je,{view3d:R,image:pe,loadingImage:de.imageLoadStatus===q.REQUESTED,numSlices:be,numSlicesLoaded:ge,numTimesteps:we,numScenes:ve,playControls:de.playControls,playingAxis:de.playingAxis,appHeight:e.appHeight,visibleControls:Re,clippingPanelOpen:Pe,onClippingPanelOpenChange:ke})))))}},1408:(e,t,n)=>{n.d(t,{A:()=>g});var r,o=n(4604),a=n(6426),i=n(1917),l=n(6540),c=n(4976),u=n(4368),s=n(3301),f=n(1250);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(null,arguments)}var d=l.forwardRef((function(e,t){return l.createElement(i.Ay,m({},e,{ref:t,type:"primary"}),e.children)}));d.displayName="PrimaryButton";var p,h,y=(0,f.Ay)(d)(r||(p=["\n  &&& {\n    background-color: var(--color-button-secondary-bg);\n    border: 1px solid var(--color-button-secondary-outline);\n    color: var(--color-button-secondary-text);\n  }\n"],h||(h=p.slice(0)),r=Object.freeze(Object.defineProperties(p,{raw:{value:Object.freeze(h)}}))));function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(){var e=v((0,l.useState)(),2),t=e[0],n=e[1],r=l.useRef(null),f=v((0,l.useState)(!1),2),m=f[0],d=f[1],p=[{key:"github",label:l.createElement(c.N_,{to:"https://github.com/allen-cell-animated/vole-app",target:"_blank",rel:"noreferrer noopener"},"Visit GitHub repository")},{key:"github-issue",label:l.createElement(c.N_,{to:"https://github.com/allen-cell-animated/vole-app/issues/new/choose",target:"_blank",rel:"noreferrer noopener"},"Report issue via GitHub")},{key:"forum",label:l.createElement(c.N_,{to:"https://forum.allencell.org/c/software-code/11",target:"_blank",rel:"noreferrer noopener"},"Allen Cell Discussion Forum")},{key:"version",label:"Version info",onClick:function(){d(!0)}}];(0,l.useEffect)((function(){n(r.current)}),[]);var h=null!==t?function(){return t}:void 0;return l.createElement("div",{ref:r},l.createElement(o.A,{menu:{items:p},getPopupContainer:h,trigger:["click"]},l.createElement(y,null,l.createElement(s.eJ,{$gap:6},"Help ",l.createElement(u.en,null)))),l.createElement(a.A,{open:m,title:"Version info",getContainer:h,onCancel:function(){return d(!1)},footer:l.createElement(i.Ay,{onClick:function(){return d(!1)}},"Close")},l.createElement(s.yY,{$gap:0},l.createElement("p",{style:{margin:0}},"Vol-E App v","2.13.5"),l.createElement("p",{style:{margin:0}},"Vol-E Core package v","4.1.0"))))}},9768:(e,t,n)=>{n.d(t,{A:()=>N});var r=n(7028),o=n(1917),a=n(6426),i=n(7457),l=n(5929),c=n(6540),u=n(1250),s=n(8486);function f(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return d(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var p,h,y=function(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,s.Mj)("WEBSITE_3D_CELL_VIEWER.recentDatasets",[]),2),t=e[0],n=e[1],r=(0,c.useMemo)((function(){return t.filter((function(e){var t=e.url,n=e.label;return"string"==typeof t&&"string"==typeof n}))}),[t]);r.length!==t.length&&n(r);var o=(0,c.useCallback)((function(e){if(null!==r){var t=r.findIndex((function(t){return t.url===e.url}));n(-1===t?[e].concat(f(r.slice(0,99))):[e].concat(f(r.slice(0,t)),f(r.slice(t+1))))}else n([e])}),[r,n]);return[r||[],o]},v=n(4205),b=n(3301);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var x,O={startCharacters:3,endCharacters:35},A=u.Ay.div(p||(p=C(["\n  display: flex;\n  flex-direction: row;\n  vertical-align: bottom;\n  white-space: nowrap;\n\n  ","\n"])),(function(e){return(0,u.AH)(h||(h=C(["\n      --startWidth: calc(1em * "," * ",");\n      --endWidth: calc(1em * "," * ",");\n\n      & span {\n        display: inline-block;\n        vertical-align: bottom;\n        white-space: nowrap;\n        overflow: hidden;\n      }\n\n      & span:first-child {\n        max-width: calc(100% - var(--endWidth));\n        min-width: var(--startWidth);\n        text-overflow: ellipsis;\n        overflow: hidden;\n      }\n\n      & span:last-child {\n        max-width: calc(100% - var(--startWidth));\n        direction: rtl;\n        z-index: 800;\n      }\n    "])),e.$startChars+3,.5,e.$endChars,.5)}));function j(e){var t=S(S({},O),e),n=Math.max(0,t.startCharacters),r=Math.max(0,t.endCharacters);t.text.length<=n+r&&(r=t.text.length-n);var o=Math.max(0,t.text.length-r),a=t.text.slice(0,o),i=t.text.slice(o);return c.createElement(A,{$startChars:n,$endChars:r,"aria-label":t.text,title:t.text},c.createElement("span",null,a),c.createElement("span",null,"‎",i))}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var M,I,T=20,L=u.Ay.div(x||(M=["\n  // Get the dropdown to size itself based on the webpage width, but resize itself to match the\n  // input area (~100vw - 100px of padding) when the webpage is very narrow\n  .ant-select-dropdown {\n    // TODO: Size to max-content so there isn't extra dead space past the end of the current items.\n    // Setting width to max-content directly causes the dropdown to collapse to a width of\n    // 0 pixels when more than 8 items are present and scrolling becomes enabled.\n    width: 100% !important;\n    max-width: calc(max(50vw, min(400px, 100vw - 100px)));\n  }\n"],I||(I=M.slice(0)),x=Object.freeze(Object.defineProperties(M,{raw:{value:Object.freeze(I)}}))));function N(e){var t=P((0,c.useState)(!1),2),n=t[0],u=t[1],s=P((0,c.useState)(""),2),f=s[0],m=s[1],d=P((0,c.useState)(""),2),p=d[0],h=d[1],g=P(y(),2),w=g[0],S=g[1],E=(0,c.useRef)(null),C=function(e){e&&(m(""),h("")),u(e)},x=(0,c.useMemo)((function(){return new l.A(w,{keys:["label"],isCaseSensitive:!1,shouldSort:!0,ignoreLocation:!0,findAllMatches:!0})}),[w]),O=(0,c.useMemo)((function(){return(""===f?w.slice(0,T):x.search(f).slice(0,T).map((function(e){return e.item}))).map((function(e){return{label:c.createElement(j,{text:e.label}),value:e.url}}))}),[f,x,w]),A=E.current?function(){return E.current}:void 0;return c.createElement(L,{ref:E},c.createElement(o.Ay,{type:"link",onClick:function(){return C(!n)}},c.createElement(r.A,null),"Load"),c.createElement(a.A,{open:n,title:"Load",onCancel:function(){return C(!1)},getContainer:E.current||void 0,okButtonProps:{},footer:c.createElement(o.Ay,{type:"default",onClick:function(){return C(!1)}},"Cancel"),destroyOnClose:!0},c.createElement("p",{style:{fontSize:"16px"}},"Provide the URL to load your OME-Zarr or OME-TIFF* data."),c.createElement("p",{style:{fontSize:"12px"}},c.createElement("i",null,"*Note: this tool is intended for OME-Zarr use. Large ","(> 100 MB)"," OME-TIFF files are not supported.")),c.createElement(b.Ye,{$gap:6},c.createElement(i.A,{value:f,onChange:function(e){return m(e)},onSelect:m,style:{width:"100%"},allowClear:!0,options:O,getPopupContainer:A,placeholder:"Enter a URL...",autoFocus:!0}),c.createElement(o.Ay,{type:"primary",onClick:function(){if((0,v.AY)(f)){var t={imageUrl:f,imageDownloadHref:f,cellId:"1",parentImageUrl:"",parentImageDownloadHref:"",viewerChannelSettings:{groups:[{name:"Channels",channels:[{match:[0,1,2],enabled:!0},{match:"(.+)",enabled:!1}]}]}};e.onLoad(t),S({url:f,label:f}),C(!1)}else h("Please enter a valid URL.")}},"Load")),""!==p&&c.createElement("p",{style:{color:"var(--color-text-error)"}},p)))}}}]);
//# sourceMappingURL=620.bundle.js.map