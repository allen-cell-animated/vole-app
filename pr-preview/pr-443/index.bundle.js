/*! For license information please see index.bundle.js.LICENSE.txt */
(()=>{var e,t,n,r,i={5748:(e,t,n)=>{"use strict";n.d(t,{z1:()=>C,cM:()=>y,UA:()=>k,uy:()=>b});var r=n(2456),i=n(6250),o=2,a=.16,s=.05,l=.05,c=.15,u=5,h=4,d=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function f(e){var t=e.r,n=e.g,i=e.b,o=(0,r.wE)(t,n,i);return{h:360*o.h,s:o.s,v:o.v}}function p(e){var t=e.r,n=e.g,i=e.b;return"#".concat((0,r.Ob)(t,n,i,!1))}function m(e,t,n){var r;return(r=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-o*t:Math.round(e.h)+o*t:n?Math.round(e.h)+o*t:Math.round(e.h)-o*t)<0?r+=360:r>=360&&(r-=360),r}function g(e,t,n){return 0===e.h&&0===e.s?e.s:((r=n?e.s-a*t:t===h?e.s+a:e.s+s*t)>1&&(r=1),n&&t===u&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2)));var r}function v(e,t,n){var r;return(r=n?e.v+l*t:e.v-c*t)>1&&(r=1),Number(r.toFixed(2))}function y(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],r=(0,i.RO)(e),o=u;o>0;o-=1){var a=f(r),s=p((0,i.RO)({h:m(a,o,!0),s:g(a,o,!0),v:v(a,o,!0)}));n.push(s)}n.push(p(r));for(var l=1;l<=h;l+=1){var c=f(r),y=p((0,i.RO)({h:m(c,l),s:g(c,l),v:v(c,l)}));n.push(y)}return"dark"===t.theme?d.map((function(e){var r,o,a,s=e.index,l=e.opacity;return p((r=(0,i.RO)(t.backgroundColor||"#141414"),a=100*l/100,{r:((o=(0,i.RO)(n[s])).r-r.r)*a+r.r,g:(o.g-r.g)*a+r.g,b:(o.b-r.b)*a+r.b}))})):n}var b={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},_=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];_.primary=_[5];var w=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];w.primary=w[5];var x=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];x.primary=x[5];var S=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];S.primary=S[5];var E=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];E.primary=E[5];var A=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];A.primary=A[5];var M=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];M.primary=M[5];var T=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];T.primary=T[5];var C=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];C.primary=C[5];var I=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];I.primary=I[5];var R=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];R.primary=R[5];var P=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];P.primary=P[5];var L=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];L.primary=L[5];var k={red:_,volcano:w,orange:x,gold:S,yellow:E,lime:A,green:M,cyan:T,blue:C,geekblue:I,purple:R,magenta:P,grey:L},D=["#2a1215","#431418","#58181c","#791a1f","#a61d24","#d32029","#e84749","#f37370","#f89f9a","#fac8c3"];D.primary=D[5];var O=["#2b1611","#441d12","#592716","#7c3118","#aa3e19","#d84a1b","#e87040","#f3956a","#f8b692","#fad4bc"];O.primary=O[5];var N=["#2b1d11","#442a11","#593815","#7c4a15","#aa6215","#d87a16","#e89a3c","#f3b765","#f8cf8d","#fae3b7"];N.primary=N[5];var U=["#2b2111","#443111","#594214","#7c5914","#aa7714","#d89614","#e8b339","#f3cc62","#f8df8b","#faedb5"];U.primary=U[5];var F=["#2b2611","#443b11","#595014","#7c6e14","#aa9514","#d8bd14","#e8d639","#f3ea62","#f8f48b","#fafab5"];F.primary=F[5];var z=["#1f2611","#2e3c10","#3e4f13","#536d13","#6f9412","#8bbb11","#a9d134","#c9e75d","#e4f88b","#f0fab5"];z.primary=z[5];var B=["#162312","#1d3712","#274916","#306317","#3c8618","#49aa19","#6abe39","#8fd460","#b2e58b","#d5f2bb"];B.primary=B[5];var V=["#112123","#113536","#144848","#146262","#138585","#13a8a8","#33bcb7","#58d1c9","#84e2d8","#b2f1e8"];V.primary=V[5];var j=["#111a2c","#112545","#15325b","#15417e","#1554ad","#1668dc","#3c89e8","#65a9f3","#8dc5f8","#b7dcfa"];j.primary=j[5];var H=["#131629","#161d40","#1c2755","#203175","#263ea0","#2b4acb","#5273e0","#7f9ef3","#a8c1f8","#d2e0fa"];H.primary=H[5];var G=["#1a1325","#24163a","#301c4d","#3e2069","#51258f","#642ab5","#854eca","#ab7ae0","#cda8f0","#ebd7fa"];G.primary=G[5];var W=["#291321","#40162f","#551c3b","#75204f","#a02669","#cb2b83","#e0529c","#f37fb7","#f8a8cc","#fad2e3"];W.primary=W[5];var q=["#151515","#1f1f1f","#2d2d2d","#393939","#494949","#5a5a5a","#6a6a6a","#7b7b7b","#888888","#969696"];q.primary=q[5]},4277:(e,t,n)=>{"use strict";n.d(t,{L_:()=>R,oX:()=>E});var r=n(2284),i=n(5544),o=n(4467),a=n(9379),s=n(6540),l=n(2187),c=n(3029),u=n(2901),h=n(9417),d=n(5501),f=n(9426);const p=(0,u.A)((function e(){(0,c.A)(this,e)}));var m="CALC_UNIT",g=new RegExp(m,"g");function v(e){return"number"==typeof e?"".concat(e).concat(m):e}var y=function(e){(0,d.A)(n,e);var t=(0,f.A)(n);function n(e,i){var a;(0,c.A)(this,n),a=t.call(this),(0,o.A)((0,h.A)(a),"result",""),(0,o.A)((0,h.A)(a),"unitlessCssVar",void 0),(0,o.A)((0,h.A)(a),"lowPriority",void 0);var s=(0,r.A)(e);return a.unitlessCssVar=i,e instanceof n?a.result="(".concat(e.result,")"):"number"===s?a.result=v(e):"string"===s&&(a.result=e),a}return(0,u.A)(n,[{key:"add",value:function(e){return e instanceof n?this.result="".concat(this.result," + ").concat(e.getResult()):"number"!=typeof e&&"string"!=typeof e||(this.result="".concat(this.result," + ").concat(v(e))),this.lowPriority=!0,this}},{key:"sub",value:function(e){return e instanceof n?this.result="".concat(this.result," - ").concat(e.getResult()):"number"!=typeof e&&"string"!=typeof e||(this.result="".concat(this.result," - ").concat(v(e))),this.lowPriority=!0,this}},{key:"mul",value:function(e){return this.lowPriority&&(this.result="(".concat(this.result,")")),e instanceof n?this.result="".concat(this.result," * ").concat(e.getResult(!0)):"number"!=typeof e&&"string"!=typeof e||(this.result="".concat(this.result," * ").concat(e)),this.lowPriority=!1,this}},{key:"div",value:function(e){return this.lowPriority&&(this.result="(".concat(this.result,")")),e instanceof n?this.result="".concat(this.result," / ").concat(e.getResult(!0)):"number"!=typeof e&&"string"!=typeof e||(this.result="".concat(this.result," / ").concat(e)),this.lowPriority=!1,this}},{key:"getResult",value:function(e){return this.lowPriority||e?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(e){var t=this,n=(e||{}).unit,r=!0;return"boolean"==typeof n?r=n:Array.from(this.unitlessCssVar).some((function(e){return t.result.includes(e)}))&&(r=!1),this.result=this.result.replace(g,r?"px":""),void 0!==this.lowPriority?"calc(".concat(this.result,")"):this.result}}]),n}(p);const b=function(e){(0,d.A)(n,e);var t=(0,f.A)(n);function n(e){var r;return(0,c.A)(this,n),r=t.call(this),(0,o.A)((0,h.A)(r),"result",0),e instanceof n?r.result=e.result:"number"==typeof e&&(r.result=e),r}return(0,u.A)(n,[{key:"add",value:function(e){return e instanceof n?this.result+=e.result:"number"==typeof e&&(this.result+=e),this}},{key:"sub",value:function(e){return e instanceof n?this.result-=e.result:"number"==typeof e&&(this.result-=e),this}},{key:"mul",value:function(e){return e instanceof n?this.result*=e.result:"number"==typeof e&&(this.result*=e),this}},{key:"div",value:function(e){return e instanceof n?this.result/=e.result:"number"==typeof e&&(this.result/=e),this}},{key:"equal",value:function(){return this.result}}]),n}(p),_=function(e,t){return"".concat([t,e.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};n(1470);const w=function(e,t,n,r){var o=(0,a.A)({},t[e]);null!=r&&r.deprecatedTokens&&r.deprecatedTokens.forEach((function(e){var t,n=(0,i.A)(e,2),r=n[0],a=n[1];(null!=o&&o[r]||null!=o&&o[a])&&(null!==(t=o[a])&&void 0!==t||(o[a]=null==o?void 0:o[r]))}));var s=(0,a.A)((0,a.A)({},n),o);return Object.keys(s).forEach((function(e){s[e]===t[e]&&delete s[e]})),s};var x="undefined"!=typeof CSSINJS_STATISTIC,S=!0;function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!x)return Object.assign.apply(Object,[{}].concat(t));S=!1;var i={};return t.forEach((function(e){"object"===(0,r.A)(e)&&Object.keys(e).forEach((function(t){Object.defineProperty(i,t,{configurable:!0,enumerable:!0,get:function(){return e[t]}})}))})),S=!0,i}var A={};function M(){}const T=function(e,t,n){var r;return"function"==typeof n?n(E(t,null!==(r=t[e])&&void 0!==r?r:{})):null!=n?n:{}};var C=new(function(){function e(){(0,c.A)(this,e),(0,o.A)(this,"map",new Map),(0,o.A)(this,"objectIDMap",new WeakMap),(0,o.A)(this,"nextID",0),(0,o.A)(this,"lastAccessBeat",new Map),(0,o.A)(this,"accessBeat",0)}return(0,u.A)(e,[{key:"set",value:function(e,t){this.clear();var n=this.getCompositeKey(e);this.map.set(n,t),this.lastAccessBeat.set(n,Date.now())}},{key:"get",value:function(e){var t=this.getCompositeKey(e),n=this.map.get(t);return this.lastAccessBeat.set(t,Date.now()),this.accessBeat+=1,n}},{key:"getCompositeKey",value:function(e){var t=this;return e.map((function(e){return e&&"object"===(0,r.A)(e)?"obj_".concat(t.getObjectID(e)):"".concat((0,r.A)(e),"_").concat(e)})).join("|")}},{key:"getObjectID",value:function(e){if(this.objectIDMap.has(e))return this.objectIDMap.get(e);var t=this.nextID;return this.objectIDMap.set(e,t),this.nextID+=1,t}},{key:"clear",value:function(){var e=this;if(this.accessBeat>1e4){var t=Date.now();this.lastAccessBeat.forEach((function(n,r){t-n>6e5&&(e.map.delete(r),e.lastAccessBeat.delete(r))})),this.accessBeat=0}}}]),e}());const I=function(){return{}},R=function(e){var t=e.useCSP,n=void 0===t?I:t,c=e.useToken,u=e.usePrefix,h=e.getResetStyles,d=e.getCommonStyle,f=e.getCompUnitless;function p(t,o,f){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},m=Array.isArray(t)?t:[t,t],g=(0,i.A)(m,1)[0],v=m.join("-"),I=e.layer||{name:"antd"};return function(e){var t,i,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,R=c(),P=R.theme,L=R.realToken,k=R.hashId,D=R.token,O=R.cssVar,N=u(),U=N.rootPrefixCls,F=N.iconPrefixCls,z=n(),B=O?"css":"js",V=(t=function(){var e=new Set;return O&&Object.keys(p.unitless||{}).forEach((function(t){e.add((0,l.Ki)(t,O.prefix)),e.add((0,l.Ki)(t,_(g,O.prefix)))})),function(e,t){var n="css"===e?y:b;return function(e){return new n(e,t)}}(B,e)},i=[B,g,null==O?void 0:O.prefix],s.useMemo((function(){var e=C.get(i);if(e)return e;var n=t();return C.set(i,n),n}),i)),j=function(e){return"js"===e?{max:Math.max,min:Math.min}:{max:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"max(".concat(t.map((function(e){return(0,l.zA)(e)})).join(","),")")},min:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"min(".concat(t.map((function(e){return(0,l.zA)(e)})).join(","),")")}}}(B),H=j.max,G=j.min,W={theme:P,token:D,hashId:k,nonce:function(){return z.nonce},clientOnly:p.clientOnly,layer:I,order:p.order||-999};return"function"==typeof h&&(0,l.IV)((0,a.A)((0,a.A)({},W),{},{clientOnly:!1,path:["Shared",U]}),(function(){return h(D,{prefix:{rootPrefixCls:U,iconPrefixCls:F},csp:z})})),[(0,l.IV)((0,a.A)((0,a.A)({},W),{},{path:[v,e,F]}),(function(){if(!1===p.injectStyle)return[];var t=function(e){var t,n=e,r=M;return x&&"undefined"!=typeof Proxy&&(t=new Set,n=new Proxy(e,{get:function(e,n){var r;return S&&(null===(r=t)||void 0===r||r.add(n)),e[n]}}),r=function(e,n){var r;A[e]={global:Array.from(t),component:(0,a.A)((0,a.A)({},null===(r=A[e])||void 0===r?void 0:r.component),n)}}),{token:n,keys:t,flush:r}}(D),n=t.token,i=t.flush,s=T(g,L,f),c=".".concat(e),u=w(g,L,s,{deprecatedTokens:p.deprecatedTokens});O&&s&&"object"===(0,r.A)(s)&&Object.keys(s).forEach((function(e){s[e]="var(".concat((0,l.Ki)(e,_(g,O.prefix)),")")}));var h=E(n,{componentCls:c,prefixCls:e,iconCls:".".concat(F),antCls:".".concat(U),calc:V,max:H,min:G},O?s:u),v=o(h,{hashId:k,prefixCls:e,rootPrefixCls:U,iconPrefixCls:F});i(g,u);var y="function"==typeof d?d(h,e,m,p.resetFont):null;return[!1===p.resetStyle?null:y,v]})),k]}}return{genStyleHooks:function(e,t,n,r){var u=Array.isArray(e)?e[0]:e;function h(e){return"".concat(String(u)).concat(e.slice(0,1).toUpperCase()).concat(e.slice(1))}var d=(null==r?void 0:r.unitless)||{},m="function"==typeof f?f(e):{},g=(0,a.A)((0,a.A)({},m),{},(0,o.A)({},h("zIndexPopup"),!0));Object.keys(d).forEach((function(e){g[h(e)]=d[e]}));var v=(0,a.A)((0,a.A)({},r),{},{unitless:g,prefixToken:h}),y=p(e,t,n,v),b=function(e,t,n){var r=n.unitless,i=n.injectStyle,o=void 0===i||i,a=n.prefixToken,u=n.ignore,h=function(i){var o=i.rootCls,s=i.cssVar,h=void 0===s?{}:s,d=c().realToken;return(0,l.RC)({path:[e],prefix:h.prefix,key:h.key,unitless:r,ignore:u,token:d,scope:o},(function(){var r=T(e,d,t),i=w(e,d,r,{deprecatedTokens:null==n?void 0:n.deprecatedTokens});return Object.keys(r).forEach((function(e){i[a(e)]=i[e],delete i[e]})),i})),null};return function(t){var n=c().cssVar;return[function(r){return o&&n?s.createElement(s.Fragment,null,s.createElement(h,{rootCls:t,cssVar:n,component:e}),r):r},null==n?void 0:n.key]}}(u,n,v);return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=y(e,t),r=(0,i.A)(n,2)[1],o=b(t),a=(0,i.A)(o,2);return[a[0],r,a[1]]}},genSubStyleComponent:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=p(e,t,n,(0,a.A)({resetStyle:!1,order:-998},r));return function(e){var t=e.prefixCls,n=e.rootCls;return i(t,void 0===n?t:n),null}},genComponentStyleHook:p}}},2187:(e,t,n)=>{"use strict";n.d(t,{Mo:()=>tt,an:()=>T,lO:()=>Y,Ki:()=>N,zA:()=>D,RC:()=>Je,hV:()=>Z,IV:()=>Ze});var r=n(4467),i=n(5544),o=n(436),a=n(9379);const s=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)};var l=n(5089),c=n(6540),u=n.t(c,2),h=(n(8104),n(3210),n(3029)),d=n(2901),f="%";function p(e){return e.join(f)}const m=function(){function e(t){(0,h.A)(this,e),(0,r.A)(this,"instanceId",void 0),(0,r.A)(this,"cache",new Map),this.instanceId=t}return(0,d.A)(e,[{key:"get",value:function(e){return this.opGet(p(e))}},{key:"opGet",value:function(e){return this.cache.get(e)||null}},{key:"update",value:function(e,t){return this.opUpdate(p(e),t)}},{key:"opUpdate",value:function(e,t){var n=t(this.cache.get(e));null===n?this.cache.delete(e):this.cache.set(e,n)}}]),e}();var g="data-token-hash",v="data-css-hash",y="__cssinjs_instance__";const b=c.createContext({hashPriority:"low",cache:function(){var e=Math.random().toString(12).slice(2);if("undefined"!=typeof document&&document.head&&document.body){var t=document.body.querySelectorAll("style[".concat(v,"]"))||[],n=document.head.firstChild;Array.from(t).forEach((function(t){t[y]=t[y]||e,t[y]===e&&document.head.insertBefore(t,n)}));var r={};Array.from(document.querySelectorAll("style[".concat(v,"]"))).forEach((function(t){var n,i=t.getAttribute(v);r[i]?t[y]===e&&(null===(n=t.parentNode)||void 0===n||n.removeChild(t)):r[i]=!0}))}return new m(e)}(),defaultCache:!0});var _=n(2284),w=n(998);new RegExp("CALC_UNIT","g");var x=function(){function e(){(0,h.A)(this,e),(0,r.A)(this,"cache",void 0),(0,r.A)(this,"keys",void 0),(0,r.A)(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return(0,d.A)(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={map:this.cache};return e.forEach((function(e){var t;i=i?null===(t=i)||void 0===t||null===(t=t.map)||void 0===t?void 0:t.get(e):void 0})),null!==(t=i)&&void 0!==t&&t.value&&r&&(i.value[1]=this.cacheCallTimes++),null===(n=i)||void 0===n?void 0:n.value}},{key:"get",value:function(e){var t;return null===(t=this.internalGet(e,!0))||void 0===t?void 0:t[0]}},{key:"has",value:function(e){return!!this.internalGet(e)}},{key:"set",value:function(t,n){var r=this;if(!this.has(t)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var o=this.keys.reduce((function(e,t){var n=(0,i.A)(e,2)[1];return r.internalGet(t)[1]<n?[t,r.internalGet(t)[1]]:e}),[this.keys[0],this.cacheCallTimes]),a=(0,i.A)(o,1)[0];this.delete(a)}this.keys.push(t)}var s=this.cache;t.forEach((function(e,i){if(i===t.length-1)s.set(e,{value:[n,r.cacheCallTimes++]});else{var o=s.get(e);o?o.map||(o.map=new Map):s.set(e,{map:new Map}),s=s.get(e).map}}))}},{key:"deleteByPath",value:function(e,t){var n,r=e.get(t[0]);if(1===t.length)return r.map?e.set(t[0],{map:r.map}):e.delete(t[0]),null===(n=r.value)||void 0===n?void 0:n[0];var i=this.deleteByPath(r.map,t.slice(1));return r.map&&0!==r.map.size||r.value||e.delete(t[0]),i}},{key:"delete",value:function(e){if(this.has(e))return this.keys=this.keys.filter((function(t){return!function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(t,e)})),this.deleteByPath(this.cache,e)}}]),e}();(0,r.A)(x,"MAX_CACHE_SIZE",20),(0,r.A)(x,"MAX_CACHE_OFFSET",5);var S=n(8210),E=0,A=function(){function e(t){(0,h.A)(this,e),(0,r.A)(this,"derivatives",void 0),(0,r.A)(this,"id",void 0),this.derivatives=Array.isArray(t)?t:[t],this.id=E,0===t.length&&(0,S.$e)(t.length>0,"[Ant Design CSS-in-JS] Theme should have at least one derivative function."),E+=1}return(0,d.A)(e,[{key:"getDerivativeToken",value:function(e){return this.derivatives.reduce((function(t,n){return n(e,t)}),void 0)}}]),e}(),M=new x;function T(e){var t=Array.isArray(e)?e:[e];return M.has(t)||M.set(t,new A(t)),M.get(t)}var C=new WeakMap,I={},R=new WeakMap;function P(e){var t=R.get(e)||"";return t||(Object.keys(e).forEach((function(n){var r=e[n];t+=n,r instanceof A?t+=r.id:r&&"object"===(0,_.A)(r)?t+=P(r):t+=r})),t=s(t),R.set(e,t)),t}function L(e,t){return s("".concat(t,"_").concat(P(e)))}"random-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,"");var k=(0,w.A)();function D(e){return"number"==typeof e?"".concat(e,"px"):e}function O(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(arguments.length>4&&void 0!==arguments[4]&&arguments[4])return e;var s=(0,a.A)((0,a.A)({},o),{},(i={},(0,r.A)(i,g,t),(0,r.A)(i,v,n),i)),l=Object.keys(s).map((function(e){var t=s[e];return t?"".concat(e,'="').concat(t,'"'):null})).filter((function(e){return e})).join(" ");return"<style ".concat(l,">").concat(e,"</style>")}var N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"--".concat(t?"".concat(t,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},U=function(e,t,n){return Object.keys(e).length?".".concat(t).concat(null!=n&&n.scope?".".concat(n.scope):"","{").concat(Object.entries(e).map((function(e){var t=(0,i.A)(e,2),n=t[0],r=t[1];return"".concat(n,":").concat(r,";")})).join(""),"}"):""},F=function(e,t,n){var r={},o={};return Object.entries(e).forEach((function(e){var t,a,s=(0,i.A)(e,2),l=s[0],c=s[1];if(null!=n&&null!==(t=n.preserve)&&void 0!==t&&t[l])o[l]=c;else if(!("string"!=typeof c&&"number"!=typeof c||null!=n&&null!==(a=n.ignore)&&void 0!==a&&a[l])){var u,h=N(l,null==n?void 0:n.prefix);r[h]="number"!=typeof c||null!=n&&null!==(u=n.unitless)&&void 0!==u&&u[l]?String(c):"".concat(c,"px"),o[l]="var(".concat(h,")")}})),[o,U(r,t,{scope:null==n?void 0:n.scope})]},z=n(981),B=(0,a.A)({},u).useInsertionEffect;const V=B?function(e,t,n){return B((function(){return e(),t()}),n)}:function(e,t,n){c.useMemo(e,n),(0,z.A)((function(){return t(!0)}),n)},j=void 0!==(0,a.A)({},u).useInsertionEffect?function(e){var t=[],n=!1;return c.useEffect((function(){return n=!1,function(){n=!0,t.length&&t.forEach((function(e){return e()}))}}),e),function(e){n||t.push(e)}}:function(){return function(e){e()}},H=function(){return!1};function G(e,t,n,r,a){var s=c.useContext(b).cache,l=p([e].concat((0,o.A)(t))),u=j([l]),h=(H(),function(e){s.opUpdate(l,(function(t){var r=t||[void 0,void 0],o=(0,i.A)(r,2),a=o[0],s=[void 0===a?0:a,o[1]||n()];return e?e(s):s}))});c.useMemo((function(){h()}),[l]);var d=s.opGet(l)[1];return V((function(){null==a||a(d)}),(function(e){return h((function(t){var n=(0,i.A)(t,2),r=n[0],o=n[1];return e&&0===r&&(null==a||a(d)),[r+1,o]})),function(){s.opUpdate(l,(function(t){var n=t||[],o=(0,i.A)(n,2),a=o[0],c=void 0===a?0:a,h=o[1];return 0==c-1?(u((function(){!e&&s.opGet(l)||null==r||r(h,!1)})),null):[c-1,h]}))}}),[l]),d}var W={},q="css",X=new Map,$=0;var Y=function(e,t,n,r){var i=n.getDerivativeToken(e),o=(0,a.A)((0,a.A)({},i),t);return r&&(o=r(o)),o},K="token";function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,c.useContext)(b),u=r.cache.instanceId,h=r.container,d=n.salt,f=void 0===d?"":d,p=n.override,m=void 0===p?W:p,_=n.formatToken,w=n.getComputedToken,x=n.cssVar,S=function(e,n){for(var r=C,i=0;i<n.length;i+=1){var a=n[i];r.has(a)||r.set(a,new WeakMap),r=r.get(a)}return r.has(I)||r.set(I,Object.assign.apply(Object,[{}].concat((0,o.A)(t)))),r.get(I)}(0,t),E=P(S),A=P(m),M=x?P(x):"",T=G(K,[f,e.id,E,A,M],(function(){var t,n=w?w(S,m,e):Y(S,m,e,_),r=(0,a.A)({},n),o="";if(x){var l=F(n,x.key,{prefix:x.prefix,ignore:x.ignore,unitless:x.unitless,preserve:x.preserve}),c=(0,i.A)(l,2);n=c[0],o=c[1]}var u=L(n,f);n._tokenKey=u,r._tokenKey=L(r,f);var h=null!==(t=null==x?void 0:x.key)&&void 0!==t?t:u;n._themeKey=h,function(e){X.set(e,(X.get(e)||0)+1)}(h);var d="".concat(q,"-").concat(s(u));return n._hashId=d,[n,d,r,o,(null==x?void 0:x.key)||""]}),(function(e){!function(e,t){X.set(e,(X.get(e)||0)-1);var n=Array.from(X.keys()),r=n.filter((function(e){return(X.get(e)||0)<=0}));n.length-r.length>$&&r.forEach((function(e){!function(e,t){"undefined"!=typeof document&&document.querySelectorAll("style[".concat(g,'="').concat(e,'"]')).forEach((function(e){var n;e[y]===t&&(null===(n=e.parentNode)||void 0===n||n.removeChild(e))}))}(e,t),X.delete(e)}))}(e[0]._themeKey,u)}),(function(e){var t=(0,i.A)(e,4),n=t[0],r=t[3];if(x&&r){var o=(0,l.BD)(r,s("css-variables-".concat(n._themeKey)),{mark:v,prepend:"queue",attachTo:h,priority:-999});o[y]=u,o.setAttribute(g,n._themeKey)}}));return T}var Q=n(8168);const J={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var ee="comm",te="rule",ne="decl",re="@import",ie="@keyframes",oe="@layer",ae=Math.abs,se=String.fromCharCode;function le(e){return e.trim()}function ce(e,t,n){return e.replace(t,n)}function ue(e,t,n){return e.indexOf(t,n)}function he(e,t){return 0|e.charCodeAt(t)}function de(e,t,n){return e.slice(t,n)}function fe(e){return e.length}function pe(e,t){return t.push(e),e}function me(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function ge(e,t,n,r){switch(e.type){case oe:if(e.children.length)break;case re:case ne:return e.return=e.return||e.value;case ee:return"";case ie:return e.return=e.value+"{"+me(e.children,r)+"}";case te:if(!fe(e.value=e.props.join(",")))return""}return fe(n=me(e.children,r))?e.return=e.value+"{"+n+"}":""}Object.assign;var ve=1,ye=1,be=0,_e=0,we=0,xe="";function Se(e,t,n,r,i,o,a,s){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:ve,column:ye,length:a,return:"",siblings:s}}function Ee(){return we=_e>0?he(xe,--_e):0,ye--,10===we&&(ye=1,ve--),we}function Ae(){return we=_e<be?he(xe,_e++):0,ye++,10===we&&(ye=1,ve++),we}function Me(){return he(xe,_e)}function Te(){return _e}function Ce(e,t){return de(xe,e,t)}function Ie(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Re(e){return le(Ce(_e-1,ke(91===e?e+2:40===e?e+1:e)))}function Pe(e){for(;(we=Me())&&we<33;)Ae();return Ie(e)>2||Ie(we)>3?"":" "}function Le(e,t){for(;--t&&Ae()&&!(we<48||we>102||we>57&&we<65||we>70&&we<97););return Ce(e,Te()+(t<6&&32==Me()&&32==Ae()))}function ke(e){for(;Ae();)switch(we){case e:return _e;case 34:case 39:34!==e&&39!==e&&ke(we);break;case 40:41===e&&ke(e);break;case 92:Ae()}return _e}function De(e,t){for(;Ae()&&e+we!==57&&(e+we!==84||47!==Me()););return"/*"+Ce(t,_e-1)+"*"+se(47===e?e:Ae())}function Oe(e){for(;!Ie(Me());)Ae();return Ce(e,_e)}function Ne(e){return function(e){return xe="",e}(Ue("",null,null,null,[""],e=function(e){return ve=ye=1,be=fe(xe=e),_e=0,[]}(e),0,[0],e))}function Ue(e,t,n,r,i,o,a,s,l){for(var c=0,u=0,h=a,d=0,f=0,p=0,m=1,g=1,v=1,y=0,b="",_=i,w=o,x=r,S=b;g;)switch(p=y,y=Ae()){case 40:if(108!=p&&58==he(S,h-1)){-1!=ue(S+=ce(Re(y),"&","&\f"),"&\f",ae(c?s[c-1]:0))&&(v=-1);break}case 34:case 39:case 91:S+=Re(y);break;case 9:case 10:case 13:case 32:S+=Pe(p);break;case 92:S+=Le(Te()-1,7);continue;case 47:switch(Me()){case 42:case 47:pe(ze(De(Ae(),Te()),t,n,l),l),5!=Ie(p||1)&&5!=Ie(Me()||1)||!fe(S)||" "===de(S,-1,void 0)||(S+=" ");break;default:S+="/"}break;case 123*m:s[c++]=fe(S)*v;case 125*m:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+u:-1==v&&(S=ce(S,/\f/g,"")),f>0&&(fe(S)-h||0===m&&47===p)&&pe(f>32?Be(S+";",r,n,h-1,l):Be(ce(S," ","")+";",r,n,h-2,l),l);break;case 59:S+=";";default:if(pe(x=Fe(S,t,n,c,u,i,s,b,_=[],w=[],h,o),o),123===y)if(0===u)Ue(S,t,x,x,_,o,h,s,w);else switch(99===d&&110===he(S,3)?100:d){case 100:case 108:case 109:case 115:Ue(e,x,x,r&&pe(Fe(e,x,x,0,0,i,s,b,i,_=[],h,w),w),i,w,h,s,r?_:w);break;default:Ue(S,x,x,x,[""],w,0,s,w)}}c=u=f=0,m=v=1,b=S="",h=a;break;case 58:h=1+fe(S),f=p;default:if(m<1)if(123==y)--m;else if(125==y&&0==m++&&125==Ee())continue;switch(S+=se(y),y*m){case 38:v=u>0?1:(S+="\f",-1);break;case 44:s[c++]=(fe(S)-1)*v,v=1;break;case 64:45===Me()&&(S+=Re(Ae())),d=Me(),u=h=fe(b=S+=Oe(Te())),y++;break;case 45:45===p&&2==fe(S)&&(m=0)}}return o}function Fe(e,t,n,r,i,o,a,s,l,c,u,h){for(var d=i-1,f=0===i?o:[""],p=function(e){return e.length}(f),m=0,g=0,v=0;m<r;++m)for(var y=0,b=de(e,d+1,d=ae(g=a[m])),_=e;y<p;++y)(_=le(g>0?f[y]+" "+b:ce(b,/&\f/g,f[y])))&&(l[v++]=_);return Se(e,t,n,0===i?te:s,l,c,u,h)}function ze(e,t,n,r){return Se(e,t,n,ee,se(we),de(e,2,-2),0,r)}function Be(e,t,n,r,i){return Se(e,t,n,ne,de(e,0,r),de(e,r+1,-1),r,i)}var Ve,je="data-ant-cssinjs-cache-path",He="_FILE_STYLE__",Ge=!0;var We="_multi_value_";function qe(e){return me(Ne(e),ge).replace(/\{%%%\:[^;];}/g,";")}var Xe=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{root:!0,parentSelectors:[]},s=r.root,l=r.injectHash,c=r.parentSelectors,u=n.hashId,h=n.layer,d=(n.path,n.hashPriority),f=n.transformers,p=void 0===f?[]:f,m=(n.linters,""),g={};function v(t){var r=t.getName(u);if(!g[r]){var o=e(t.style,n,{root:!1,parentSelectors:c}),a=(0,i.A)(o,1)[0];g[r]="@keyframes ".concat(t.getName(u)).concat(a)}}var y=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach((function(t){Array.isArray(t)?e(t,n):t&&n.push(t)})),n}(Array.isArray(t)?t:[t]);return y.forEach((function(t){var r="string"!=typeof t||s?t:{};if("string"==typeof r)m+="".concat(r,"\n");else if(r._keyframe)v(r);else{var h=p.reduce((function(e,t){var n;return(null==t||null===(n=t.visit)||void 0===n?void 0:n.call(t,e))||e}),r);Object.keys(h).forEach((function(t){var r=h[t];if("object"!==(0,_.A)(r)||!r||"animationName"===t&&r._keyframe||function(e){return"object"===(0,_.A)(e)&&e&&("_skip_check_"in e||We in e)}(r)){var f;function M(e,t){var n=e.replace(/[A-Z]/g,(function(e){return"-".concat(e.toLowerCase())})),r=t;J[e]||"number"!=typeof r||0===r||(r="".concat(r,"px")),"animationName"===e&&null!=t&&t._keyframe&&(v(t),r=t.getName(u)),m+="".concat(n,":").concat(r,";")}var p=null!==(f=null==r?void 0:r.value)&&void 0!==f?f:r;"object"===(0,_.A)(r)&&null!=r&&r[We]&&Array.isArray(p)?p.forEach((function(e){M(t,e)})):M(t,p)}else{var y=!1,b=t.trim(),w=!1;(s||l)&&u?b.startsWith("@")?y=!0:b=function(e,t,n){if(!t)return e;var r=".".concat(t),i="low"===n?":where(".concat(r,")"):r;return e.split(",").map((function(e){var t,n=e.trim().split(/\s+/),r=n[0]||"",a=(null===(t=r.match(/^\w+/))||void 0===t?void 0:t[0])||"";return[r="".concat(a).concat(i).concat(r.slice(a.length))].concat((0,o.A)(n.slice(1))).join(" ")})).join(",")}("&"===b?"":t,u,d):!s||u||"&"!==b&&""!==b||(b="",w=!0);var x=e(r,n,{root:w,injectHash:y,parentSelectors:[].concat((0,o.A)(c),[b])}),S=(0,i.A)(x,2),E=S[0],A=S[1];g=(0,a.A)((0,a.A)({},g),A),m+="".concat(b).concat(E)}}))}})),s?h&&(m&&(m="@layer ".concat(h.name," {").concat(m,"}")),h.dependencies&&(g["@layer ".concat(h.name)]=h.dependencies.map((function(e){return"@layer ".concat(e,", ").concat(h.name,";")})).join("\n"))):m="{".concat(m,"}"),[m,g]};function $e(e,t){return s("".concat(e.join("%")).concat(t))}function Ye(){return null}var Ke="style";function Ze(e,t){var n=e.token,s=e.path,u=e.hashId,h=e.layer,d=e.nonce,f=e.clientOnly,p=e.order,m=void 0===p?0:p,_=c.useContext(b),x=_.autoClear,S=(_.mock,_.defaultCache),E=_.hashPriority,A=_.container,M=_.ssrInline,T=_.transformers,C=_.linters,I=_.cache,R=_.layer,P=n._tokenKey,L=[P];R&&L.push("layer"),L.push.apply(L,(0,o.A)(s));var D=k,O=G(Ke,L,(function(){var e=L.join("|");if(function(e){return function(){if(!Ve&&(Ve={},(0,w.A)())){var e=document.createElement("div");e.className=je,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var t=getComputedStyle(e).content||"";(t=t.replace(/^"/,"").replace(/"$/,"")).split(";").forEach((function(e){var t=e.split(":"),n=(0,i.A)(t,2),r=n[0],o=n[1];Ve[r]=o}));var n,r=document.querySelector("style[".concat(je,"]"));r&&(Ge=!1,null===(n=r.parentNode)||void 0===n||n.removeChild(r)),document.body.removeChild(e)}}(),!!Ve[e]}(e)){var n=function(e){var t=Ve[e],n=null;if(t&&(0,w.A)())if(Ge)n=He;else{var r=document.querySelector("style[".concat(v,'="').concat(Ve[e],'"]'));r?n=r.innerHTML:delete Ve[e]}return[n,t]}(e),r=(0,i.A)(n,2),o=r[0],a=r[1];if(o)return[o,P,a,{},f,m]}var l=t(),c=Xe(l,{hashId:u,hashPriority:E,layer:R?h:void 0,path:s.join("-"),transformers:T,linters:C}),d=(0,i.A)(c,2),p=d[0],g=d[1],y=qe(p),b=$e(L,y);return[y,P,b,g,f,m]}),(function(e,t){var n=(0,i.A)(e,3)[2];(t||x)&&k&&(0,l.m6)(n,{mark:v})}),(function(e){var t=(0,i.A)(e,4),n=t[0],r=(t[1],t[2]),o=t[3];if(D&&n!==He){var s={mark:v,prepend:!R&&"queue",attachTo:A,priority:m},c="function"==typeof d?d():d;c&&(s.csp={nonce:c});var u=[],h=[];Object.keys(o).forEach((function(e){e.startsWith("@layer")?u.push(e):h.push(e)})),u.forEach((function(e){(0,l.BD)(qe(o[e]),"_layer-".concat(e),(0,a.A)((0,a.A)({},s),{},{prepend:!0}))}));var f=(0,l.BD)(n,r,s);f[y]=I.instanceId,f.setAttribute(g,P),h.forEach((function(e){(0,l.BD)(qe(o[e]),"_effect-".concat(e),s)}))}})),N=(0,i.A)(O,3),U=N[0],F=N[1],z=N[2];return function(e){var t,n;return t=M&&!D&&S?c.createElement("style",(0,Q.A)({},(n={},(0,r.A)(n,g,F),(0,r.A)(n,v,z),n),{dangerouslySetInnerHTML:{__html:U}})):c.createElement(Ye,null),c.createElement(c.Fragment,null,t,e)}}var Qe="cssVar";const Je=function(e,t){var n=e.key,r=e.prefix,a=e.unitless,s=e.ignore,u=e.token,h=e.scope,d=void 0===h?"":h,f=(0,c.useContext)(b),p=f.cache.instanceId,m=f.container,_=u._tokenKey,w=[].concat((0,o.A)(e.path),[n,d,_]);return G(Qe,w,(function(){var e=t(),o=F(e,n,{prefix:r,unitless:a,ignore:s,scope:d}),l=(0,i.A)(o,2),c=l[0],u=l[1];return[c,u,$e(w,u),n]}),(function(e){var t=(0,i.A)(e,3)[2];k&&(0,l.m6)(t,{mark:v})}),(function(e){var t=(0,i.A)(e,3),r=t[1],o=t[2];if(r){var a=(0,l.BD)(r,o,{mark:v,prepend:"queue",attachTo:m,priority:-999});a[y]=p,a.setAttribute(g,n)}}))};var et;et={},(0,r.A)(et,Ke,(function(e,t,n){var r=(0,i.A)(e,6),o=r[0],a=r[1],s=r[2],l=r[3],c=r[4],u=r[5],h=(n||{}).plain;if(c)return null;var d=o,f={"data-rc-order":"prependQueue","data-rc-priority":"".concat(u)};return d=O(o,a,s,f,h),l&&Object.keys(l).forEach((function(e){if(!t[e]){t[e]=!0;var n=O(qe(l[e]),a,"_effect-".concat(e),f,h);e.startsWith("@layer")?d=n+d:d+=n}})),[u,s,d]})),(0,r.A)(et,K,(function(e,t,n){var r=(0,i.A)(e,5),o=r[2],a=r[3],s=r[4],l=(n||{}).plain;if(!a)return null;var c=o._tokenKey;return[-999,c,O(a,s,c,{"data-rc-order":"prependQueue","data-rc-priority":"".concat(-999)},l)]})),(0,r.A)(et,Qe,(function(e,t,n){var r=(0,i.A)(e,4),o=r[1],a=r[2],s=r[3],l=(n||{}).plain;return o?[-999,a,O(o,s,a,{"data-rc-order":"prependQueue","data-rc-priority":"".concat(-999)},l)]:null}));const tt=function(){function e(t,n){(0,h.A)(this,e),(0,r.A)(this,"name",void 0),(0,r.A)(this,"style",void 0),(0,r.A)(this,"_keyframe",!0),this.name=t,this.style=n}return(0,d.A)(e,[{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?"".concat(e,"-").concat(this.name):this.name}}]),e}();function nt(e){return e.notSplit=!0,e}nt(["borderTop","borderBottom"]),nt(["borderTop"]),nt(["borderBottom"]),nt(["borderLeft","borderRight"]),nt(["borderLeft"]),nt(["borderRight"])},9114:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var r=n(8168),i=n(5544),o=n(4467),a=n(3986),s=n(6540),l=n(6942),c=n.n(l),u=n(5748),h=n(1053),d=n(9379),f=n(2860),p=["icon","className","onClick","style","primaryColor","secondaryColor"],m={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1},g=function(e){var t=e.icon,n=e.className,r=e.onClick,i=e.style,o=e.primaryColor,l=e.secondaryColor,c=(0,a.A)(e,p),u=s.useRef(),h=m;if(o&&(h={primaryColor:o,secondaryColor:l||(0,f.Em)(o)}),(0,f.lf)(u),(0,f.$e)((0,f.P3)(t),"icon should be icon definiton, but got ".concat(t)),!(0,f.P3)(t))return null;var g=t;return g&&"function"==typeof g.icon&&(g=(0,d.A)((0,d.A)({},g),{},{icon:g.icon(h.primaryColor,h.secondaryColor)})),(0,f.cM)(g.icon,"svg-".concat(g.name),(0,d.A)((0,d.A)({className:n,onClick:r,style:i,"data-icon":g.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},c),{},{ref:u}))};g.displayName="IconReact",g.getTwoToneColors=function(){return(0,d.A)({},m)},g.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;m.primaryColor=t,m.secondaryColor=n||(0,f.Em)(t),m.calculated=!!n};const v=g;function y(e){var t=(0,f.al)(e),n=(0,i.A)(t,2),r=n[0],o=n[1];return v.setTwoToneColors({primaryColor:r,secondaryColor:o})}var b=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];y(u.z1.primary);var _=s.forwardRef((function(e,t){var n=e.className,l=e.icon,u=e.spin,d=e.rotate,p=e.tabIndex,m=e.onClick,g=e.twoToneColor,y=(0,a.A)(e,b),_=s.useContext(h.A),w=_.prefixCls,x=void 0===w?"anticon":w,S=_.rootClassName,E=c()(S,x,(0,o.A)((0,o.A)({},"".concat(x,"-").concat(l.name),!!l.name),"".concat(x,"-spin"),!!u||"loading"===l.name),n),A=p;void 0===A&&m&&(A=-1);var M=d?{msTransform:"rotate(".concat(d,"deg)"),transform:"rotate(".concat(d,"deg)")}:void 0,T=(0,f.al)(g),C=(0,i.A)(T,2),I=C[0],R=C[1];return s.createElement("span",(0,r.A)({role:"img","aria-label":l.name},y,{ref:t,tabIndex:A,onClick:m,className:E}),s.createElement(v,{icon:l,primaryColor:I,secondaryColor:R,style:M}))}));_.displayName="AntdIcon",_.getTwoToneColor=function(){var e=v.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor},_.setTwoToneColor=y;const w=_},1053:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(6540).createContext)({})},3567:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(8168),i=n(6540);const o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};var a=n(9114),s=function(e,t){return i.createElement(a.A,(0,r.A)({},e,{ref:t,icon:o}))};const l=i.forwardRef(s)},2860:(e,t,n)=>{"use strict";n.d(t,{$e:()=>h,Em:()=>m,P3:()=>d,al:()=>g,cM:()=>p,lf:()=>y,yf:()=>v});var r=n(9379),i=n(2284),o=n(5748),a=n(5089),s=n(2633),l=n(8210),c=n(6540),u=n(1053);function h(e,t){(0,l.Ay)(e,"[@ant-design/icons] ".concat(t))}function d(e){return"object"===(0,i.A)(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===(0,i.A)(e.icon)||"function"==typeof e.icon)}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){var r,i=e[n];return"class"===n?(t.className=i,delete t.class):(delete t[n],t[(r=n,r.replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=i),t}),{})}function p(e,t,n){return n?c.createElement(e.tag,(0,r.A)((0,r.A)({key:t},f(e.attrs)),n),(e.children||[]).map((function(n,r){return p(n,"".concat(t,"-").concat(e.tag,"-").concat(r))}))):c.createElement(e.tag,(0,r.A)({key:t},f(e.attrs)),(e.children||[]).map((function(n,r){return p(n,"".concat(t,"-").concat(e.tag,"-").concat(r))})))}function m(e){return(0,o.cM)(e)[0]}function g(e){return e?Array.isArray(e)?e:[e]:[]}var v={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"},y=function(e){var t=(0,c.useContext)(u.A),n=t.csp,r=t.prefixCls,i="\n.anticon {\n  display: inline-flex;\n  align-items: center;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n";r&&(i=i.replace(/anticon/g,r)),(0,c.useEffect)((function(){var t=e.current,r=(0,s.j)(t);(0,a.BD)(i,"@ant-design-icons",{prepend:!0,csp:n,attachTo:r})}),[])}},2456:(e,t,n)=>{"use strict";n.d(t,{H:()=>h,K6:()=>o,Me:()=>c,Ob:()=>u,YL:()=>s,_:()=>i,g8:()=>f,n6:()=>d,oS:()=>p,wE:()=>l});var r=n(9244);function i(e,t,n){return{r:255*(0,r.Cg)(e,255),g:255*(0,r.Cg)(t,255),b:255*(0,r.Cg)(n,255)}}function o(e,t,n){e=(0,r.Cg)(e,255),t=(0,r.Cg)(t,255),n=(0,r.Cg)(n,255);var i=Math.max(e,t,n),o=Math.min(e,t,n),a=0,s=0,l=(i+o)/2;if(i===o)s=0,a=0;else{var c=i-o;switch(s=l>.5?c/(2-i-o):c/(i+o),i){case e:a=(t-n)/c+(t<n?6:0);break;case t:a=(n-e)/c+2;break;case n:a=(e-t)/c+4}a/=6}return{h:a,s,l}}function a(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function s(e,t,n){var i,o,s;if(e=(0,r.Cg)(e,360),t=(0,r.Cg)(t,100),n=(0,r.Cg)(n,100),0===t)o=n,s=n,i=n;else{var l=n<.5?n*(1+t):n+t-n*t,c=2*n-l;i=a(c,l,e+1/3),o=a(c,l,e),s=a(c,l,e-1/3)}return{r:255*i,g:255*o,b:255*s}}function l(e,t,n){e=(0,r.Cg)(e,255),t=(0,r.Cg)(t,255),n=(0,r.Cg)(n,255);var i=Math.max(e,t,n),o=Math.min(e,t,n),a=0,s=i,l=i-o,c=0===i?0:l/i;if(i===o)a=0;else{switch(i){case e:a=(t-n)/l+(t<n?6:0);break;case t:a=(n-e)/l+2;break;case n:a=(e-t)/l+4}a/=6}return{h:a,s:c,v:s}}function c(e,t,n){e=6*(0,r.Cg)(e,360),t=(0,r.Cg)(t,100),n=(0,r.Cg)(n,100);var i=Math.floor(e),o=e-i,a=n*(1-t),s=n*(1-o*t),l=n*(1-(1-o)*t),c=i%6;return{r:255*[n,s,a,a,l,n][c],g:255*[l,n,n,s,a,a][c],b:255*[a,a,l,n,n,s][c]}}function u(e,t,n,i){var o=[(0,r.wl)(Math.round(e).toString(16)),(0,r.wl)(Math.round(t).toString(16)),(0,r.wl)(Math.round(n).toString(16))];return i&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function h(e,t,n,i,o){var a,s=[(0,r.wl)(Math.round(e).toString(16)),(0,r.wl)(Math.round(t).toString(16)),(0,r.wl)(Math.round(n).toString(16)),(0,r.wl)((a=i,Math.round(255*parseFloat(a)).toString(16)))];return o&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function d(e){return f(e)/255}function f(e){return parseInt(e,16)}function p(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}},2434:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var r={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},6250:(e,t,n)=>{"use strict";n.d(t,{RO:()=>a});var r=n(2456),i=n(2434),o=n(9244);function a(e){var t={r:0,g:0,b:0},n=1,a=null,s=null,l=null,c=!1,d=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(i.D[e])e=i.D[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=u.rgb.exec(e);return n?{r:n[1],g:n[2],b:n[3]}:(n=u.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=u.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=u.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=u.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=u.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=u.hex8.exec(e))?{r:(0,r.g8)(n[1]),g:(0,r.g8)(n[2]),b:(0,r.g8)(n[3]),a:(0,r.n6)(n[4]),format:t?"name":"hex8"}:(n=u.hex6.exec(e))?{r:(0,r.g8)(n[1]),g:(0,r.g8)(n[2]),b:(0,r.g8)(n[3]),format:t?"name":"hex"}:(n=u.hex4.exec(e))?{r:(0,r.g8)(n[1]+n[1]),g:(0,r.g8)(n[2]+n[2]),b:(0,r.g8)(n[3]+n[3]),a:(0,r.n6)(n[4]+n[4]),format:t?"name":"hex8"}:!!(n=u.hex3.exec(e))&&{r:(0,r.g8)(n[1]+n[1]),g:(0,r.g8)(n[2]+n[2]),b:(0,r.g8)(n[3]+n[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(h(e.r)&&h(e.g)&&h(e.b)?(t=(0,r._)(e.r,e.g,e.b),c=!0,d="%"===String(e.r).substr(-1)?"prgb":"rgb"):h(e.h)&&h(e.s)&&h(e.v)?(a=(0,o.Px)(e.s),s=(0,o.Px)(e.v),t=(0,r.Me)(e.h,a,s),c=!0,d="hsv"):h(e.h)&&h(e.s)&&h(e.l)&&(a=(0,o.Px)(e.s),l=(0,o.Px)(e.l),t=(0,r.YL)(e.h,a,l),c=!0,d="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(n=e.a)),n=(0,o.TV)(n),{ok:c,format:e.format||d,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}var s="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),l="[\\s|\\(]+(".concat(s,")[,|\\s]+(").concat(s,")[,|\\s]+(").concat(s,")\\s*\\)?"),c="[\\s|\\(]+(".concat(s,")[,|\\s]+(").concat(s,")[,|\\s]+(").concat(s,")[,|\\s]+(").concat(s,")\\s*\\)?"),u={CSS_UNIT:new RegExp(s),rgb:new RegExp("rgb"+l),rgba:new RegExp("rgba"+c),hsl:new RegExp("hsl"+l),hsla:new RegExp("hsla"+c),hsv:new RegExp("hsv"+l),hsva:new RegExp("hsva"+c),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function h(e){return Boolean(u.CSS_UNIT.exec(String(e)))}},4978:(e,t,n)=>{"use strict";n.d(t,{q:()=>s});var r=n(2456),i=n(2434),o=n(6250),a=n(9244),s=function(){function e(t,n){var i;if(void 0===t&&(t=""),void 0===n&&(n={}),t instanceof e)return t;"number"==typeof t&&(t=(0,r.oS)(t)),this.originalInput=t;var a=(0,o.RO)(t);this.originalInput=t,this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(i=n.format)&&void 0!==i?i:a.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=a.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,r=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=(0,a.TV)(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){return 0===this.toHsl().s},e.prototype.toHsv=function(){var e=(0,r.wE)(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=(0,r.wE)(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(n,"%, ").concat(i,"%)"):"hsva(".concat(t,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=(0,r.K6)(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=(0,r.K6)(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(n,"%, ").concat(i,"%)"):"hsla(".concat(t,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),(0,r.Ob)(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),(0,r.H)(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toHexShortString=function(e){return void 0===e&&(e=!1),1===this.a?this.toHexString(e):this.toHex8String(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(n,")"):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*(0,a.Cg)(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*(0,a.Cg)(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+(0,r.Ob)(this.r,this.g,this.b,!1),t=0,n=Object.entries(i.D);t<n.length;t++){var o=n[t],a=o[0];if(e===o[1])return a}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var n=!1,r=this.a<1&&this.a>=0;return t||!r||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l+=t/100,n.l=(0,a.J$)(n.l),new e(n)},e.prototype.brighten=function(t){void 0===t&&(t=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),new e(n)},e.prototype.darken=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l-=t/100,n.l=(0,a.J$)(n.l),new e(n)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s-=t/100,n.s=(0,a.J$)(n.s),new e(n)},e.prototype.saturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s+=t/100,n.s=(0,a.J$)(n.s),new e(n)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var n=this.toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,new e(n)},e.prototype.mix=function(t,n){void 0===n&&(n=50);var r=this.toRgb(),i=new e(t).toRgb(),o=n/100;return new e({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},e.prototype.analogous=function(t,n){void 0===t&&(t=6),void 0===n&&(n=30);var r=this.toHsl(),i=360/n,o=[this];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(new e(r));return o},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var n=this.toHsv(),r=n.h,i=n.s,o=n.v,a=[],s=1/t;t--;)a.push(new e({h:r,s:i,v:o})),o=(o+s)%1;return a},e.prototype.splitcomplement=function(){var t=this.toHsl(),n=t.h;return[this,new e({h:(n+72)%360,s:t.s,l:t.l}),new e({h:(n+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var n=this.toRgb(),r=new e(t).toRgb(),i=n.a+r.a*(1-n.a);return new e({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var n=this.toHsl(),r=n.h,i=[this],o=360/t,a=1;a<t;a++)i.push(new e({h:(r+a*o)%360,s:n.s,l:n.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}()},9244:(e,t,n)=>{"use strict";function r(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function i(e){return Math.min(1,Math.max(0,e))}function o(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function a(e){return e<=1?"".concat(100*Number(e),"%"):e}function s(e){return 1===e.length?"0"+e:String(e)}n.d(t,{Cg:()=>r,J$:()=>i,Px:()=>a,TV:()=>o,wl:()=>s})},6199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=n(5215),a=n(6336),s=n(5319),l=n(2477),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),u=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",d="[DEFAULT]",f=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new l.Logger("@firebase/app"),m=function(){function e(e,t,n){var r,i,l=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=a.deepCopy(e),this.container=new s.ComponentContainer(t.name),this._addComponent(new s.Component("app",(function(){return l}),"PUBLIC"));try{for(var c=o.__values(this.firebase_.INTERNAL.components.values()),u=c.next();!u.done;u=c.next()){var h=u.value;this._addComponent(h)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){return void 0===t&&(t=d),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=d),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){p.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},e}();m.prototype.name&&m.prototype.options||m.prototype.delete||console.log("dc");var g=function e(){var t=function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=d);var s=o.name;if("string"!=typeof s||!s)throw u.create("bad-app-name",{appName:String(s)});if(a.contains(t,s))throw u.create("duplicate-app",{appName:s});var l=new e(n,o,r);return t[s]=l,l},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=f[e])&&void 0!==r?r:e;n&&(i+="-"+n);var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var l=['Unable to register library "'+i+'" with version "'+t+'":'];return o&&l.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&l.push("and"),a&&l.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void p.warn(l.join(" "))}c(new s.Component(i+"-version",(function(){return{library:i,version:t}}),"VERSION"))},setLogLevel:l.setLogLevel,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw u.create("invalid-log-argument",{appName:name});l.setUserLogHandler(e,t)},apps:null,SDK_VERSION:"7.20.0",INTERNAL:{registerComponent:c,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){return"serverAuth"===t?null:t}}};function i(e){if(e=e||d,!a.contains(t,e))throw u.create("no-app",{appName:e});return t[e]}function c(s){var l,c,h=s.name;if(n.has(h))return p.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var d=function(e){if(void 0===e&&(e=i()),"function"!=typeof e[h])throw u.create("invalid-app-argument",{appName:h});return e[h]()};void 0!==s.serviceProps&&a.deepExtend(d,s.serviceProps),r[h]=d,e.prototype[h]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,h).apply(this,s.multipleInstances?e:[])}}try{for(var f=o.__values(Object.keys(t)),m=f.next();!m.done;m=f.next()){var g=m.value;t[g]._addComponent(s)}}catch(e){l={error:e}}finally{try{m&&!m.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}return"PUBLIC"===s.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),i.App=e,r}(m);return t.INTERNAL=o.__assign(o.__assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){a.deepExtend(t,e)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),t}(),v=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();if(a.isBrowser()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var y=self.firebase.SDK_VERSION;y&&y.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var b=g.initializeApp;g.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.isNode()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),b.apply(void 0,e)};var _=g;!function(e){e.INTERNAL.registerComponent(new s.Component("platform-logger",(function(e){return new v(e)}),"PRIVATE")),e.registerVersion(h,"0.6.11",void 0),e.registerVersion("fire-js","")}(_),t.default=_,t.firebase=_},5319:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5215),i=n(6336),o=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e}(),a="[DEFAULT]",s=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(e){void 0===e&&(e=a);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;this.instancesDeferred.set(t,n);try{var r=this.getOrInitializeService(t);r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=r.__assign({identifier:a,optional:!1},e),n=t.identifier,i=t.optional,o=this.normalizeInstanceIdentifier(n);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(e){if(i)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService(a)}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=r.__read(o.value,2),l=s[0],c=s[1],u=this.normalizeInstanceIdentifier(l);try{var h=this.getOrInitializeService(u);c.resolve(h)}catch(e){}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.clearInstance=function(e){void 0===e&&(e=a),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(r.__spread(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})),e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()}))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.getOrInitializeService=function(e){var t=this.instances.get(e);return!t&&this.component&&(t=this.component.instanceFactory(this.container,function(e){return e===a?void 0:e}(e)),this.instances.set(e,t)),t||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:a:e},e}(),l=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new s(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=o,t.ComponentContainer=l,t.Provider=s},1241:(e,t,n)=>{"use strict";var r=n(5215),i=n(6199),o=n(2477),a=n(6336),s=n(7036),l=n(5319),c=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(i),u={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},h=function(e){function t(t,n){var r=this;return(r=e.call(this,n)||this).code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return r.__extends(t,e),t}(Error),d=new o.Logger("@firebase/firestore");function f(){return d.logLevel}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(d.logLevel<=o.LogLevel.DEBUG){var i=t.map(v);d.debug.apply(d,r.__spreadArrays(["Firestore (7.24.0): "+e],i))}}function m(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(d.logLevel<=o.LogLevel.ERROR){var i=t.map(v);d.error.apply(d,r.__spreadArrays(["Firestore (7.24.0): "+e],i))}}function g(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(d.logLevel<=o.LogLevel.WARN){var i=t.map(v);d.warn.apply(d,r.__spreadArrays(["Firestore (7.24.0): "+e],i))}}function v(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function y(e){void 0===e&&(e="Unexpected state");var t="FIRESTORE (7.24.0) INTERNAL ASSERTION FAILED: "+e;throw m(t),new Error(t)}function b(e,t){e||y()}function _(e,t){return e}function w(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function x(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function S(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var E=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&y(),void 0===n?n=e.length-t:n>e.length-t&&y(),this.segments=e,this.offset=t,this.t=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.i(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.o(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.u=function(e){return e=void 0===e?1:e,this.o(this.segments,this.offset+e,this.length-e)},e.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},e.prototype.l=function(){return this.segments[this.offset]},e.prototype._=function(){return this.get(this.length-1)},e.prototype.get=function(e){return this.segments[this.offset+e]},e.prototype.m=function(){return 0===this.length},e.prototype.T=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.I=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},e.i=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.o=function(e,n,r){return new t(e,n,r)},t.prototype.R=function(){return this.A().join("/")},t.prototype.toString=function(){return this.R()},t.g=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new h(u.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(e){return e.length>0})))}return new t(r)},t.P=function(){return new t([])},t}(E),M=/^[_a-zA-Z][_a-zA-Z0-9]*$/,T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.o=function(e,n,r){return new t(e,n,r)},t.V=function(e){return M.test(e)},t.prototype.R=function(){return this.A().map((function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),t.V(e)||(e="`"+e+"`"),e})).join(".")},t.prototype.toString=function(){return this.R()},t.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},t.v=function(){return new t(["__name__"])},t.S=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new h(u.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new h(u.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var l=e[i+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new h(u.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new h(u.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.P=function(){return new t([])},t}(E),C=function(){function e(e){this.path=e}return e.D=function(t){return new e(A.g(t))},e.C=function(t){return new e(A.g(t).u(5))},e.prototype.N=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===A.i(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.i=function(e,t){return A.i(e.path,t.path)},e.F=function(e){return e.length%2==0},e.$=function(t){return new e(new A(t.slice()))},e}();function I(e,t){if(0!==t.length)throw new h(u.INVALID_ARGUMENT,"Function "+e+"() does not support arguments, but was called with "+X(t.length,"argument")+".")}function R(e,t,n){if(t.length!==n)throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires "+X(n,"argument")+", but was called with "+X(t.length,"argument")+".")}function P(e,t,n){if(t.length<n)throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires at least "+X(n,"argument")+", but was called with "+X(t.length,"argument")+".")}function L(e,t,n,r){if(t.length<n||t.length>r)throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+X(t.length,"argument")+".")}function k(e,t,n,r){z(e,t,q(n)+" argument",r)}function D(e,t,n,r){void 0!==r&&k(e,t,n,r)}function O(e,t,n,r){z(e,t,n+" option",r)}function N(e,t,n,r){void 0!==r&&O(e,t,n,r)}function U(e,t,n,r,i){void 0!==r&&function(e,t,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var l=s[a];if(l===r)return;o.push(V(l))}var c=V(r);throw new h(u.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(e,0,n,r,i)}function F(e,t,n,r){if(!t.some((function(e){return e===r})))throw new h(u.INVALID_ARGUMENT,"Invalid value "+V(r)+" provided to function "+e+"() for its "+q(n)+" argument. Acceptable values: "+t.join(", "));return r}function z(e,t,n,r){if(!("object"===t?B(r):"non-empty string"===t?"string"==typeof r&&""!==r:typeof r===t)){var i=V(r);throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+i)}}function B(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function V(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":y()}function j(e,t,n){if(void 0===n)throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+q(t)+" argument, but it was undefined.")}function H(e,t,n){x(t,(function(t,r){if(n.indexOf(t)<0)throw new h(u.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+e+"(). Available options: "+n.join(", "))}))}function G(e,t,n,r){var i=V(r);return new h(u.INVALID_ARGUMENT,"Function "+e+"() requires its "+q(n)+" argument to be a "+t+", but it was: "+i)}function W(e,t,n){if(n<=0)throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires its "+q(t)+" argument to be a positive number, but it was: "+n+".")}function q(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function X(e,t){return e+" "+t+(1===e?"":"s")}function $(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Y=function(){function e(){}return e.k=function(){for(var e=62*Math.floor(256/62),t="";t.length<20;)for(var n=$(40),r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62));return t},e}();function K(e,t){return e<t?-1:e>t?1:0}function Z(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function Q(e){return e+"\0"}var J=function(){function e(e){this.M=e}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))},e.prototype.toBase64=function(){return e=this.M,btoa(e);var e},e.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.M)},e.prototype.O=function(){return 2*this.M.length},e.prototype.L=function(e){return K(this.M,e.M)},e.prototype.isEqual=function(e){return this.M===e.M},e}();J.B=new J("");var ee=function(){function e(e){this.q=e}return e.fromBase64String=function(t){try{return new e(J.fromBase64String(t))}catch(t){throw new h(u.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},e.fromUint8Array=function(t){return new e(J.fromUint8Array(t))},e.prototype.toBase64=function(){return this.q.toBase64()},e.prototype.toUint8Array=function(){return this.q.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this.q.isEqual(e.q)},e}();function te(){if("undefined"==typeof Uint8Array)throw new h(u.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ne(){if("undefined"==typeof atob)throw new h(u.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.fromBase64String=function(e){R("Blob.fromBase64String",arguments,1),k("Blob.fromBase64String","string",1,e),ne();try{return new t(J.fromBase64String(e))}catch(e){throw new h(u.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(R("Blob.fromUint8Array",arguments,1),te(),!(e instanceof Uint8Array))throw G("Blob.fromUint8Array","Uint8Array",1,e);return new t(J.fromUint8Array(e))},t.prototype.toBase64=function(){return R("Blob.toBase64",arguments,0),ne(),e.prototype.toBase64.call(this)},t.prototype.toUint8Array=function(){return R("Blob.toUint8Array",arguments,0),te(),e.prototype.toUint8Array.call(this)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(ee),ie=function(e,t,n,r,i,o){this.U=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i,this.W=o},oe=function(){function e(e,t){this.projectId=e,this.database=t||"(default)"}return Object.defineProperty(e.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e.prototype.L=function(e){return K(this.projectId,e.projectId)||K(this.database,e.database)},e}(),ae=function(){function e(e,t){this.K=e,this.G=t,this.H={}}return e.prototype.get=function(e){var t=this.K(e),n=this.H[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.G(a,e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.K(e),r=this.H[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.H[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.K(e),n=this.H[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],e))return 1===n.length?delete this.H[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){x(this.H,(function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];e(a,s)}}))},e.prototype.m=function(){return S(this.H)},e}(),se=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new h(u.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new h(u.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new h(u.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new h(u.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,1e6*(t-1e3*n))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype.Y=function(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),le=function(){function e(e){this.timestamp=e}return e.J=function(t){return new e(t)},e.min=function(){return new e(new se(0,0))},e.prototype.L=function(e){return this.timestamp.Y(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.X=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.Z=function(){return this.timestamp},e}();function ce(e){return null==e}function ue(e){return 0===e&&1/e==-1/0}function he(e){return"number"==typeof e&&Number.isInteger(e)&&!ue(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var de=function(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.tt=null};function fe(e,t,n,r,i,o,a){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new de(e,t,n,r,i,o,a)}function pe(e){var t=_(e);if(null===t.tt){var n=t.path.R();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return function(e){return e.field.R()+e.op.toString()+ot(e.value)}(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return(t=e).field.R()+t.dir;var t})).join(","),ce(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=ur(t.startAt)),t.endAt&&(n+="|ub:",n+=ur(t.endAt)),t.tt=n}return t.tt}function me(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!mr(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],o=t.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!tt(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!dr(e.startAt,t.startAt)&&dr(e.endAt,t.endAt)}function ge(e){return C.F(e.path)&&null===e.collectionGroup&&0===e.filters.length}var ve,ye,be=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=le.min()),void 0===o&&(o=le.min()),void 0===a&&(a=J.B),this.target=e,this.targetId=t,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.st=function(t){return new e(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.it=function(t,n){return new e(this.target,this.targetId,this.et,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.rt=function(t){return new e(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},e}(),_e=function(e){this.count=e};function we(e){switch(e){case u.OK:return y();case u.CANCELLED:case u.UNKNOWN:case u.DEADLINE_EXCEEDED:case u.RESOURCE_EXHAUSTED:case u.INTERNAL:case u.UNAVAILABLE:case u.UNAUTHENTICATED:return!1;case u.INVALID_ARGUMENT:case u.NOT_FOUND:case u.ALREADY_EXISTS:case u.PERMISSION_DENIED:case u.FAILED_PRECONDITION:case u.ABORTED:case u.OUT_OF_RANGE:case u.UNIMPLEMENTED:case u.DATA_LOSS:return!0;default:return y()}}function xe(e){if(void 0===e)return m("GRPC error has no .code"),u.UNKNOWN;switch(e){case ve.OK:return u.OK;case ve.CANCELLED:return u.CANCELLED;case ve.UNKNOWN:return u.UNKNOWN;case ve.DEADLINE_EXCEEDED:return u.DEADLINE_EXCEEDED;case ve.RESOURCE_EXHAUSTED:return u.RESOURCE_EXHAUSTED;case ve.INTERNAL:return u.INTERNAL;case ve.UNAVAILABLE:return u.UNAVAILABLE;case ve.UNAUTHENTICATED:return u.UNAUTHENTICATED;case ve.INVALID_ARGUMENT:return u.INVALID_ARGUMENT;case ve.NOT_FOUND:return u.NOT_FOUND;case ve.ALREADY_EXISTS:return u.ALREADY_EXISTS;case ve.PERMISSION_DENIED:return u.PERMISSION_DENIED;case ve.FAILED_PRECONDITION:return u.FAILED_PRECONDITION;case ve.ABORTED:return u.ABORTED;case ve.OUT_OF_RANGE:return u.OUT_OF_RANGE;case ve.UNIMPLEMENTED:return u.UNIMPLEMENTED;case ve.DATA_LOSS:return u.DATA_LOSS;default:return y()}}(ye=ve||(ve={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";var Se=function(){function e(e,t){this.i=e,this.root=t||Ae.EMPTY}return e.prototype.ot=function(t,n){return new e(this.i,this.root.ot(t,n,this.i).copy(null,null,Ae.at,null,null))},e.prototype.remove=function(t){return new e(this.i,this.root.remove(t,this.i).copy(null,null,Ae.at,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.m();){var n=this.i(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.m();){var r=this.i(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.m=function(){return this.root.m()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.ct=function(){return this.root.ct()},e.prototype.ut=function(){return this.root.ut()},e.prototype.ht=function(e){return this.root.ht(e)},e.prototype.forEach=function(e){this.ht((function(t,n){return e(t,n),!1}))},e.prototype.toString=function(){var e=[];return this.ht((function(t,n){return e.push(t+":"+n),!1})),"{"+e.join(", ")+"}"},e.prototype.lt=function(e){return this.root.lt(e)},e.prototype._t=function(){return new Ee(this.root,null,this.i,!1)},e.prototype.ft=function(e){return new Ee(this.root,e,this.i,!1)},e.prototype.dt=function(){return new Ee(this.root,null,this.i,!0)},e.prototype.wt=function(e){return new Ee(this.root,e,this.i,!0)},e}(),Ee=function(){function e(e,t,n,r){this.Tt=r,this.Et=[];for(var i=1;!e.m();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.Tt?e.left:e.right;else{if(0===i){this.Et.push(e);break}this.Et.push(e),e=this.Tt?e.right:e.left}}return e.prototype.It=function(){var e=this.Et.pop(),t={key:e.key,value:e.value};if(this.Tt)for(e=e.left;!e.m();)this.Et.push(e),e=e.right;else for(e=e.right;!e.m();)this.Et.push(e),e=e.left;return t},e.prototype.At=function(){return this.Et.length>0},e.prototype.Rt=function(){if(0===this.Et.length)return null;var e=this.Et[this.Et.length-1];return{key:e.key,value:e.value}},e}(),Ae=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.m=function(){return!1},e.prototype.ht=function(e){return this.left.ht(e)||e(this.key,this.value)||this.right.ht(e)},e.prototype.lt=function(e){return this.right.lt(e)||e(this.key,this.value)||this.left.lt(e)},e.prototype.min=function(){return this.left.m()?this:this.left.min()},e.prototype.ct=function(){return this.min().key},e.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},e.prototype.ot=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.ot(e,t,n))).gt()},e.prototype.Pt=function(){if(this.left.m())return e.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.Pt(),null)).gt()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.m()||i.left.yt()||i.left.left.yt()||(i=i.Vt()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.yt()&&(i=i.bt()),i.right.m()||i.right.yt()||i.right.left.yt()||(i=i.vt()),0===n(t,i.key)){if(i.right.m())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.gt()},e.prototype.yt=function(){return this.color},e.prototype.gt=function(){var e=this;return e.right.yt()&&!e.left.yt()&&(e=e.St()),e.left.yt()&&e.left.left.yt()&&(e=e.bt()),e.left.yt()&&e.right.yt()&&(e=e.Dt()),e},e.prototype.Vt=function(){var e=this.Dt();return e.right.left.yt()&&(e=(e=(e=e.copy(null,null,null,null,e.right.bt())).St()).Dt()),e},e.prototype.vt=function(){var e=this.Dt();return e.left.left.yt()&&(e=(e=e.bt()).Dt()),e},e.prototype.St=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.bt=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.Dt=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.Ct=function(){var e=this.Nt();return Math.pow(2,e)<=this.size+1},e.prototype.Nt=function(){if(this.yt()&&this.left.yt())throw y();if(this.right.yt())throw y();var e=this.left.Nt();if(e!==this.right.Nt())throw y();return e+(this.yt()?0:1)},e}();Ae.EMPTY=null,Ae.RED=!0,Ae.at=!1,Ae.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw y()},enumerable:!1,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.ot=function(e,t,n){return new Ae(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.m=function(){return!0},e.prototype.ht=function(e){return!1},e.prototype.lt=function(e){return!1},e.prototype.ct=function(){return null},e.prototype.ut=function(){return null},e.prototype.yt=function(){return!1},e.prototype.Ct=function(){return!0},e.prototype.Nt=function(){return 0},e}());var Me=function(){function e(e){this.i=e,this.data=new Se(this.i)}return e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.ct()},e.prototype.last=function(){return this.data.ut()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.ht((function(t,n){return e(t),!1}))},e.prototype.Ft=function(e,t){for(var n=this.data.ft(e[0]);n.At();){var r=n.It();if(this.i(r.key,e[1])>=0)return;t(r.key)}},e.prototype.xt=function(e,t){var n;for(n=void 0!==t?this.data.ft(t):this.data._t();n.At();)if(!e(n.It().key))return},e.prototype.$t=function(e){var t=this.data.ft(e);return t.At()?t.It().key:null},e.prototype._t=function(){return new Te(this.data._t())},e.prototype.ft=function(e){return new Te(this.data.ft(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).ot(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.m=function(){return this.data.m()},e.prototype.kt=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data._t(),r=t.data._t();n.At();){var i=n.It().key,o=r.It().key;if(0!==this.i(i,o))return!1}return!0},e.prototype.A=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},e.prototype.toString=function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.i);return n.data=t,n},e}(),Te=function(){function e(e){this.Mt=e}return e.prototype.It=function(){return this.Mt.It().key},e.prototype.At=function(){return this.Mt.At()},e}(),Ce=new Se(C.i);function Ie(){return Ce}function Re(){return Ie()}var Pe=new Se(C.i);function Le(){return Pe}var ke=new Se(C.i),De=new Me(C.i);function Oe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=De,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ne=new Me(K);function Ue(){return Ne}var Fe=function(){function e(e){this.i=e?function(t,n){return e(t,n)||C.i(t.key,n.key)}:function(e,t){return C.i(e.key,t.key)},this.Ot=Le(),this.Lt=new Se(this.i)}return e.Bt=function(t){return new e(t.i)},e.prototype.has=function(e){return null!=this.Ot.get(e)},e.prototype.get=function(e){return this.Ot.get(e)},e.prototype.first=function(){return this.Lt.ct()},e.prototype.last=function(){return this.Lt.ut()},e.prototype.m=function(){return this.Lt.m()},e.prototype.indexOf=function(e){var t=this.Ot.get(e);return t?this.Lt.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){this.Lt.ht((function(t,n){return e(t),!1}))},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.Ot.ot(e.key,e),t.Lt.ot(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.Ot.remove(e),this.Lt.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.Lt._t(),r=t.Lt._t();n.At();){var i=n.It().key,o=r.It().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.i=this.i,r.Ot=t,r.Lt=n,r},e}(),ze=function(){function e(){this.qt=new Se(C.i)}return e.prototype.track=function(e){var t=e.doc.key,n=this.qt.get(t);n?0!==e.type&&3===n.type?this.qt=this.qt.ot(t,e):3===e.type&&1!==n.type?this.qt=this.qt.ot(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.qt=this.qt.ot(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.qt=this.qt.ot(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.qt=this.qt.remove(t):1===e.type&&2===n.type?this.qt=this.qt.ot(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.qt=this.qt.ot(t,{type:2,doc:e.doc}):y():this.qt=this.qt.ot(t,e)},e.prototype.Ut=function(){var e=[];return this.qt.ht((function(t,n){e.push(n)})),e},e}(),Be=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.Qt=n,this.docChanges=r,this.Wt=i,this.fromCache=o,this.jt=a,this.Kt=s}return e.Gt=function(t,n,r,i){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,Fe.Bt(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.Wt.m()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.jt===e.jt&&this.Wt.isEqual(e.Wt)&&Yn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.Qt.isEqual(e.Qt)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),Ve=function(){function e(e,t,n,r,i){this.nt=e,this.zt=t,this.Ht=n,this.Yt=r,this.Jt=i}return e.Xt=function(t,n){var r=new Map;return r.set(t,je.Zt(t,n)),new e(le.min(),r,Ue(),Ie(),Oe())},e}(),je=function(){function e(e,t,n,r,i){this.resumeToken=e,this.te=t,this.ee=n,this.ne=r,this.se=i}return e.Zt=function(t,n){return new e(J.B,n,Oe(),Oe(),Oe())},e}(),He=function(e,t,n,r){this.ie=e,this.removedTargetIds=t,this.key=n,this.re=r},Ge=function(e,t){this.targetId=e,this.oe=t},We=function(e,t,n,r){void 0===n&&(n=J.B),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},qe=function(){function e(){this.ae=0,this.ce=Ye(),this.ue=J.B,this.he=!1,this.le=!0}return Object.defineProperty(e.prototype,"te",{get:function(){return this.he},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),e.prototype.de=function(e){e.O()>0&&(this.le=!0,this.ue=e)},e.prototype.we=function(){var e=Oe(),t=Oe(),n=Oe();return this.ce.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:y()}})),new je(this.ue,this.he,e,t,n)},e.prototype.me=function(){this.le=!1,this.ce=Ye()},e.prototype.Te=function(e,t){this.le=!0,this.ce=this.ce.ot(e,t)},e.prototype.Ee=function(e){this.le=!0,this.ce=this.ce.remove(e)},e.prototype.Ie=function(){this.ae+=1},e.prototype.Ae=function(){this.ae-=1},e.prototype.Re=function(){this.le=!0,this.he=!0},e}(),Xe=function(){function e(e){this.ge=e,this.Pe=new Map,this.ye=Ie(),this.Ve=$e(),this.pe=new Me(K)}return e.prototype.be=function(e){for(var t=0,n=e.ie;t<n.length;t++){var r=n[t];e.re instanceof kn?this.ve(r,e.re):e.re instanceof Dn&&this.Se(r,e.key,e.re)}for(var i=0,o=e.removedTargetIds;i<o.length;i++){var a=o[i];this.Se(a,e.key,e.re)}},e.prototype.De=function(e){var t=this;this.Ce(e,(function(n){var r=t.Ne(n);switch(e.state){case 0:t.Fe(n)&&r.de(e.resumeToken);break;case 1:r.Ae(),r._e||r.me(),r.de(e.resumeToken);break;case 2:r.Ae(),r._e||t.removeTarget(n);break;case 3:t.Fe(n)&&(r.Re(),r.de(e.resumeToken));break;case 4:t.Fe(n)&&(t.xe(n),r.de(e.resumeToken));break;default:y()}}))},e.prototype.Ce=function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Pe.forEach((function(e,r){n.Fe(r)&&t(r)}))},e.prototype.$e=function(e){var t=e.targetId,n=e.oe.count,r=this.ke(t);if(r){var i=r.target;if(ge(i))if(0===n){var o=new C(i.path);this.Se(t,o,new Dn(o,le.min()))}else b(1===n);else this.Me(t)!==n&&(this.xe(t),this.pe=this.pe.add(t))}},e.prototype.Oe=function(e){var t=this,n=new Map;this.Pe.forEach((function(r,i){var o=t.ke(i);if(o){if(r.te&&ge(o.target)){var a=new C(o.target.path);null!==t.ye.get(a)||t.Le(i,a)||t.Se(i,a,new Dn(a,e))}r.fe&&(n.set(i,r.we()),r.me())}}));var r=Oe();this.Ve.forEach((function(e,n){var i=!0;n.xt((function(e){var n=t.ke(e);return!n||2===n.et||(i=!1,!1)})),i&&(r=r.add(e))}));var i=new Ve(e,n,this.pe,this.ye,r);return this.ye=Ie(),this.Ve=$e(),this.pe=new Me(K),i},e.prototype.ve=function(e,t){if(this.Fe(e)){var n=this.Le(e,t.key)?2:0;this.Ne(e).Te(t.key,n),this.ye=this.ye.ot(t.key,t),this.Ve=this.Ve.ot(t.key,this.Be(t.key).add(e))}},e.prototype.Se=function(e,t,n){if(this.Fe(e)){var r=this.Ne(e);this.Le(e,t)?r.Te(t,1):r.Ee(t),this.Ve=this.Ve.ot(t,this.Be(t).delete(e)),n&&(this.ye=this.ye.ot(t,n))}},e.prototype.removeTarget=function(e){this.Pe.delete(e)},e.prototype.Me=function(e){var t=this.Ne(e).we();return this.ge.qe(e).size+t.ee.size-t.se.size},e.prototype.Ie=function(e){this.Ne(e).Ie()},e.prototype.Ne=function(e){var t=this.Pe.get(e);return t||(t=new qe,this.Pe.set(e,t)),t},e.prototype.Be=function(e){var t=this.Ve.get(e);return t||(t=new Me(K),this.Ve=this.Ve.ot(e,t)),t},e.prototype.Fe=function(e){var t=null!==this.ke(e);return t||p("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.ke=function(e){var t=this.Pe.get(e);return t&&t._e?null:this.ge.Ue(e)},e.prototype.xe=function(e){var t=this;this.Pe.set(e,new qe),this.ge.qe(e).forEach((function(n){t.Se(e,n,null)}))},e.prototype.Le=function(e,t){return this.ge.qe(e).has(t)},e}();function $e(){return new Se(C.i)}function Ye(){return new Se(C.i)}function Ke(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ze(e){var t=e.mapValue.fields.__previous_value__;return Ke(t)?Ze(t):t}function Qe(e){var t=st(e.mapValue.fields.__local_write_time__.timestampValue);return new se(t.seconds,t.nanos)}var Je=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function et(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ke(e)?4:10:y()}function tt(e,t){var n=et(e);if(n!==et(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Qe(e).isEqual(Qe(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=st(e.timestampValue),r=st(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ct(e.bytesValue).isEqual(ct(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return lt(e.geoPointValue.latitude)===lt(t.geoPointValue.latitude)&&lt(e.geoPointValue.longitude)===lt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return lt(e.integerValue)===lt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=lt(e.doubleValue),r=lt(t.doubleValue);return n===r?ue(n)===ue(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Z(e.arrayValue.values||[],t.arrayValue.values||[],tt);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(w(n)!==w(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!tt(n[i],r[i])))return!1;return!0}(e,t);default:return y()}}function nt(e,t){return void 0!==(e.values||[]).find((function(e){return tt(e,t)}))}function rt(e,t){var n=et(e),r=et(t);if(n!==r)return K(n,r);switch(n){case 0:return 0;case 1:return K(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=lt(e.integerValue||e.doubleValue),r=lt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return it(e.timestampValue,t.timestampValue);case 4:return it(Qe(e),Qe(t));case 5:return K(e.stringValue,t.stringValue);case 6:return function(e,t){var n=ct(e),r=ct(t);return n.L(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=K(n[i],r[i]);if(0!==o)return o}return K(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=K(lt(e.latitude),lt(t.latitude));return 0!==n?n:K(lt(e.longitude),lt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=rt(n[i],r[i]);if(o)return o}return K(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=K(r[a],o[a]);if(0!==s)return s;var l=rt(n[r[a]],i[o[a]]);if(0!==l)return l}return K(r.length,o.length)}(e.mapValue,t.mapValue);default:throw y()}}function it(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return K(e,t);var n=st(e),r=st(t),i=K(n.seconds,r.seconds);return 0!==i?i:K(n.nanos,r.nanos)}function ot(e){return at(e)}function at(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=st(e);return"time("+t.seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?ct(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,C.C(n).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(e){for(var t="[",n=!0,r=0,i=e.values||[];r<i.length;r++)n?n=!1:t+=",",t+=at(i[r]);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var t="{",n=!0,r=0,i=Object.keys(e.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:t+=",",t+=o+":"+at(e.fields[o])}return t+"}"}(e.mapValue):y();var t,n}function st(e){if(b(!!e),"string"==typeof e){var t=0,n=Je.exec(e);if(b(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:lt(e.seconds),nanos:lt(e.nanos)}}function lt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ct(e){return"string"==typeof e?J.fromBase64String(e):J.fromUint8Array(e)}function ut(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.R()}}function ht(e){return!!e&&"integerValue"in e}function dt(e){return!!e&&"arrayValue"in e}function ft(e){return!!e&&"nullValue"in e}function pt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function mt(e){return!!e&&"mapValue"in e}var gt={asc:"ASCENDING",desc:"DESCENDING"},vt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yt=function(e,t){this.U=e,this.Qe=t};function bt(e){return{integerValue:""+e}}function _t(e,t){if(e.Qe){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ue(t)?"-0":t}}function wt(e,t){return he(t)?bt(t):_t(e,t)}function xt(e,t){return e.Qe?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function St(e,t){return e.Qe?t.toBase64():t.toUint8Array()}function Et(e,t){return xt(e,t.Z())}function At(e){return b(!!e),le.J(function(e){var t=st(e);return new se(t.seconds,t.nanos)}(e))}function Mt(e,t){return function(e){return new A(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).R()}function Tt(e){var t=A.g(e);return b(Kt(t)),t}function Ct(e,t){return Mt(e.U,t.path)}function It(e,t){var n=Tt(t);return b(n.get(1)===e.U.projectId),b(!n.get(3)&&!e.U.database||n.get(3)===e.U.database),new C(kt(n))}function Rt(e,t){return Mt(e.U,t)}function Pt(e){var t=Tt(e);return 4===t.length?A.P():kt(t)}function Lt(e){return new A(["projects",e.U.projectId,"databases",e.U.database]).R()}function kt(e){return b(e.length>4&&"documents"===e.get(4)),e.u(5)}function Dt(e,t,n){return{name:Ct(e,t),fields:n.proto.mapValue.fields}}function Ot(e,t){var n;if(t instanceof wn)n={update:Dt(e,t.key,t.value)};else if(t instanceof Tn)n={delete:Ct(e,t.key)};else if(t instanceof xn)n={update:Dt(e,t.key,t.data),updateMask:Yt(t.We)};else if(t instanceof En)n={transform:{document:Ct(e,t.key),fieldTransforms:t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof tn)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(n instanceof nn)return{fieldPath:t.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof on)return{fieldPath:t.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof sn)return{fieldPath:t.field.R(),increment:n.je};throw y()}(0,e)}))}};else{if(!(t instanceof Cn))return y();n={verify:Ct(e,t.key)}}return t.Ge.Ke||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Et(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y()}(e,t.Ge)),n}function Nt(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?fn.updateTime(At(e.updateTime)):void 0!==e.exists?fn.exists(e.exists):fn.ze()}(t.currentDocument):fn.ze();if(t.update){t.update.name;var r=It(e,t.update.name),i=new In({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new un(t.map((function(e){return T.S(e)})))}(t.updateMask);return new xn(r,i,o,n)}return new wn(r,i,n)}if(t.delete){var a=It(e,t.delete);return new Tn(a,n)}if(t.transform){var s=It(e,t.transform.document),l=t.transform.fieldTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)b("REQUEST_TIME"===t.setToServerValue),n=new tn;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new nn(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new on(i)}else"increment"in t?n=new sn(e,t.increment):y();var o=T.S(t.fieldPath);return new hn(o,n)}(e,t)}));return b(!0===n.exists),new En(s,l)}if(t.verify){var c=It(e,t.verify);return new Cn(c,n)}return y()}function Ut(e,t){return{documents:[Rt(e,t.path)]}}function Ft(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Rt(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Rt(e,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(pt(e.value))return{unaryFilter:{field:Wt(e.field),op:"IS_NAN"}};if(ft(e.value))return{unaryFilter:{field:Wt(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(pt(e.value))return{unaryFilter:{field:Wt(e.field),op:"IS_NOT_NAN"}};if(ft(e.value))return{unaryFilter:{field:Wt(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wt(e.field),op:Gt(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:Wt(e.field),direction:Ht(e.dir)}}(e)}))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(e,t){return e.Qe||ce(t)?t:{value:t}}(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=Vt(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Vt(t.endAt)),n}function zt(e){var t=Pt(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){b(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=Bt(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new fr(qt(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var l=null;n.limit&&(l=function(e){var t;return ce(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=jt(n.startAt));var u=null;return n.endAt&&(u=jt(n.endAt)),Wn(Un(t,i,s,a,l,"F",c,u))}function Bt(e){return e?void 0!==e.unaryFilter?[$t(e)]:void 0!==e.fieldFilter?[Xt(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return Bt(e)})).reduce((function(e,t){return e.concat(t)})):y():[]}function Vt(e){return{before:e.before,values:e.position}}function jt(e){var t=!!e.before,n=e.values||[];return new cr(n,t)}function Ht(e){return gt[e]}function Gt(e){return vt[e]}function Wt(e){return{fieldPath:e.R()}}function qt(e){return T.S(e.fieldPath)}function Xt(e){return er.create(qt(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return y()}}(e.fieldFilter.op),e.fieldFilter.value)}function $t(e){switch(e.unaryFilter.op){case"IS_NAN":var t=qt(e.unaryFilter.field);return er.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=qt(e.unaryFilter.field);return er.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=qt(e.unaryFilter.field);return er.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=qt(e.unaryFilter.field);return er.create(i,"!=",{nullValue:"NULL_VALUE"});default:return y()}}function Yt(e){var t=[];return e.fields.forEach((function(e){return t.push(e.R())})),{fieldPaths:t}}function Kt(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var Zt=function(){this.He=void 0};function Qt(e,t,n){return e instanceof tn?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof nn?rn(e,t):e instanceof on?an(e,t):function(e,t){var n=en(e,t),r=ln(n)+ln(e.je);return ht(n)&&ht(e.je)?bt(r):_t(e.serializer,r)}(e,t)}function Jt(e,t,n){return e instanceof nn?rn(e,t):e instanceof on?an(e,t):n}function en(e,t){return e instanceof sn?ht(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(Zt),nn=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return r.__extends(t,e),t}(Zt);function rn(e,t){for(var n=cn(t),r=function(e){n.some((function(t){return tt(t,e)}))||n.push(e)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var on=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return r.__extends(t,e),t}(Zt);function an(e,t){for(var n=cn(t),r=function(e){n=n.filter((function(t){return!tt(t,e)}))},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var sn=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).serializer=t,r.je=n,r}return r.__extends(t,e),t}(Zt);function ln(e){return lt(e.integerValue||e.doubleValue)}function cn(e){return dt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var un=function(){function e(e){this.fields=e,e.sort(T.i)}return e.prototype.Ye=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].T(e))return!0;return!1},e.prototype.isEqual=function(e){return Z(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))},e}(),hn=function(e,t){this.field=e,this.transform=t},dn=function(e,t){this.version=e,this.transformResults=t},fn=function(){function e(e,t){this.updateTime=e,this.exists=t}return e.ze=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"Ke",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},e}();function pn(e,t){return void 0!==e.updateTime?t instanceof kn&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t instanceof kn}var mn=function(){};function gn(e,t,n){return e instanceof wn?function(e,t,n){return new kn(e.key,n.version,e.value,{hasCommittedMutations:!0})}(e,0,n):e instanceof xn?function(e,t,n){if(!pn(e.Ge,t))return new On(e.key,n.version);var r=Sn(e,t);return new kn(e.key,n.version,r,{hasCommittedMutations:!0})}(e,t,n):e instanceof En?function(e,t,n){if(b(null!=n.transformResults),!pn(e.Ge,t))return new On(e.key,n.version);var r=An(0,t),i=function(e,t,n){var r=[];b(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],a=o.transform,s=null;t instanceof kn&&(s=t.field(o.field)),r.push(Jt(a,s,n[i]))}return r}(e.fieldTransforms,t,n.transformResults),o=n.version,a=Mn(e,r.data(),i);return new kn(e.key,o,a,{hasCommittedMutations:!0})}(e,t,n):function(e,t,n){return new Dn(e.key,n.version,{hasCommittedMutations:!0})}(e,0,n)}function vn(e,t,n,r){return e instanceof wn?function(e,t){if(!pn(e.Ge,t))return t;var n=_n(t);return new kn(e.key,n,e.value,{Je:!0})}(e,t):e instanceof xn?function(e,t){if(!pn(e.Ge,t))return t;var n=_n(t),r=Sn(e,t);return new kn(e.key,n,r,{Je:!0})}(e,t):e instanceof En?function(e,t,n,r){if(!pn(e.Ge,t))return t;var i=An(0,t),o=function(e,t,n,r){for(var i=[],o=0,a=e;o<a.length;o++){var s=a[o],l=s.transform,c=null;n instanceof kn&&(c=n.field(s.field)),null===c&&r instanceof kn&&(c=r.field(s.field)),i.push(Qt(l,c,t))}return i}(e.fieldTransforms,n,t,r),a=Mn(e,i.data(),o);return new kn(e.key,i.version,a,{Je:!0})}(e,t,r,n):function(e,t){return pn(e.Ge,t)?new Dn(e.key,le.min()):t}(e,t)}function yn(e,t){return e instanceof En?function(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],a=t instanceof kn?t.field(o.field):void 0,s=en(o.transform,a||null);null!=s&&(n=null==n?(new Rn).set(o.field,s):n.set(o.field,s))}return n?n.Xe():null}(e,t):null}function bn(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.Ge.isEqual(t.Ge)&&(0===e.type?e.value.isEqual(t.value):1===e.type?e.data.isEqual(t.data)&&e.We.isEqual(t.We):2!==e.type||Z(e.fieldTransforms,e.fieldTransforms,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof nn&&t instanceof nn||e instanceof on&&t instanceof on?Z(e.elements,t.elements,tt):e instanceof sn&&t instanceof sn?tt(e.je,t.je):e instanceof tn&&t instanceof tn}(e.transform,t.transform)}(e,t)})))}function _n(e){return e instanceof kn?e.version:le.min()}var wn=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).key=t,i.value=n,i.Ge=r,i.type=0,i}return r.__extends(t,e),t}(mn),xn=function(e){function t(t,n,r,i){var o=this;return(o=e.call(this)||this).key=t,o.data=n,o.We=r,o.Ge=i,o.type=1,o}return r.__extends(t,e),t}(mn);function Sn(e,t){return function(e,t){var n=new Rn(t);return e.We.fields.forEach((function(t){if(!t.m()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}})),n.Xe()}(e,t instanceof kn?t.data():In.empty())}var En=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.fieldTransforms=n,r.type=2,r.Ge=fn.exists(!0),r}return r.__extends(t,e),t}(mn);function An(e,t){return t}function Mn(e,t,n){for(var r=new Rn(t),i=0;i<e.fieldTransforms.length;i++){var o=e.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var Tn=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.Ge=n,r.type=3,r}return r.__extends(t,e),t}(mn),Cn=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.Ge=n,r.type=4,r}return r.__extends(t,e),t}(mn),In=function(){function e(e){this.proto=e}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(e){if(e.m())return this.proto;for(var t=this.proto,n=0;n<e.length-1;++n){if(!t.mapValue.fields)return null;if(!mt(t=t.mapValue.fields[e.get(n)]))return null}return(t=(t.mapValue.fields||{})[e._()])||null},e.prototype.isEqual=function(e){return tt(this.proto,e.proto)},e}(),Rn=function(){function e(e){void 0===e&&(e=In.empty()),this.Ze=e,this.tn=new Map}return e.prototype.set=function(e,t){return this.en(e,t),this},e.prototype.delete=function(e){return this.en(e,null),this},e.prototype.en=function(e,t){for(var n=this.tn,r=0;r<e.length-1;++r){var i=e.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===et(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(e._(),t)},e.prototype.Xe=function(){var e=this.nn(T.P(),this.tn);return null!=e?new In(e):this.Ze},e.prototype.nn=function(e,t){var n=this,r=!1,i=this.Ze.field(e),o=mt(i)?Object.assign({},i.mapValue.fields):{};return t.forEach((function(t,i){if(t instanceof Map){var a=n.nn(e.child(i),t);null!=a&&(o[i]=a,r=!0)}else null!==t?(o[i]=t,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},e}();function Pn(e){var t=[];return x(e.fields||{},(function(e,n){var r=new T([e]);if(mt(n)){var i=Pn(n.mapValue).fields;if(0===i.length)t.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];t.push(r.child(s))}}else t.push(r)})),new un(t)}var Ln=function(e,t){this.key=e,this.version=t},kn=function(e){function t(t,n,r,i){var o=this;return(o=e.call(this,t,n)||this).sn=r,o.Je=!!i.Je,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return r.__extends(t,e),t.prototype.field=function(e){return this.sn.field(e)},t.prototype.data=function(){return this.sn},t.prototype.rn=function(){return this.sn.proto},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.Je===e.Je&&this.hasCommittedMutations===e.hasCommittedMutations&&this.sn.isEqual(e.sn)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t}(Ln),Dn=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return r.__extends(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.hasCommittedMutations===this.hasCommittedMutations&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Ln),On=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},t}(Ln),Nn=function(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=a,this.endAt=s,this.cn=null,this.un=null,this.startAt,this.endAt};function Un(e,t,n,r,i,o,a,s){return new Nn(e,t,n,r,i,o,a,s)}function Fn(e){return new Nn(e)}function zn(e){return!ce(e.limit)&&"F"===e.an}function Bn(e){return!ce(e.limit)&&"L"===e.an}function Vn(e){return e.on.length>0?e.on[0].field:null}function jn(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.hn())return r.field}return null}function Hn(e){return null!==e.collectionGroup}function Gn(e){var t=_(e);if(null===t.cn){t.cn=[];var n=jn(t),r=Vn(t);if(null!==n&&null===r)n.p()||t.cn.push(new fr(n)),t.cn.push(new fr(T.v(),"asc"));else{for(var i=!1,o=0,a=t.on;o<a.length;o++){var s=a[o];t.cn.push(s),s.field.p()&&(i=!0)}if(!i){var l=t.on.length>0?t.on[t.on.length-1].dir:"asc";t.cn.push(new fr(T.v(),l))}}}return t.cn}function Wn(e){var t=_(e);if(!t.un)if("F"===t.an)t.un=fe(t.path,t.collectionGroup,Gn(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=Gn(t);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new fr(o.field,a))}var s=t.endAt?new cr(t.endAt.position,!t.endAt.before):null,l=t.startAt?new cr(t.startAt.position,!t.startAt.before):null;t.un=fe(t.path,t.collectionGroup,n,t.filters,t.limit,s,l)}return t.un}function qn(e,t,n){return new Nn(e.path,e.collectionGroup,e.on.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Xn(e,t){return new Nn(e.path,e.collectionGroup,e.on.slice(),e.filters.slice(),e.limit,e.an,t,e.endAt)}function $n(e,t){return new Nn(e.path,e.collectionGroup,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,t)}function Yn(e,t){return me(Wn(e),Wn(t))&&e.an===t.an}function Kn(e){return pe(Wn(e))+"|lt:"+e.an}function Zn(e){return"Query(target="+function(e){var t=e.path.R();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: ["+e.filters.map((function(e){return(t=e).field.R()+" "+t.op+" "+ot(t.value);var t})).join(", ")+"]"),ce(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: ["+e.orderBy.map((function(e){return(t=e).field.R()+" ("+t.dir+")";var t})).join(", ")+"]"),e.startAt&&(t+=", startAt: "+ur(e.startAt)),e.endAt&&(t+=", endAt: "+ur(e.endAt)),"Target("+t+")"}(Wn(e))+"; limitType="+e.an+")"}function Qn(e,t){return function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):C.F(e.path)?e.path.isEqual(n):e.path.I(n)}(e,t)&&function(e,t){for(var n=0,r=e.on;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===t.field(i.field))return!1}return!0}(e,t)&&function(e,t){for(var n=0,r=e.filters;n<r.length;n++)if(!r[n].matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!hr(e.startAt,Gn(e),t)||e.endAt&&hr(e.endAt,Gn(e),t))}(e,t)}function Jn(e){return function(t,n){for(var r=!1,i=0,o=Gn(e);i<o.length;i++){var a=o[i],s=pr(a,t,n);if(0!==s)return s;r=r||a.field.p()}return 0}}var er=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).field=t,i.op=n,i.value=r,i}return r.__extends(t,e),t.create=function(e,n,r){if(e.p())return"in"===n||"not-in"===n?this.ln(e,n,r):new tr(e,n,r);if(ft(r)){if("=="!==n&&"!="!==n)throw new h(u.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new t(e,n,r)}if(pt(r)){if("=="!==n&&"!="!==n)throw new h(u.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new t(e,n,r)}return"array-contains"===n?new or(e,r):"in"===n?new ar(e,r):"not-in"===n?new sr(e,r):"array-contains-any"===n?new lr(e,r):new t(e,n,r)},t.ln=function(e,t,n){return"in"===t?new nr(e,n):new rr(e,n)},t.prototype.matches=function(e){var t=e.field(this.field);return"!="===this.op?null!==t&&this._n(rt(t,this.value)):null!==t&&et(this.value)===et(t)&&this._n(rt(t,this.value))},t.prototype._n=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return y()}},t.prototype.hn=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}((function(){})),tr=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,r)||this).key=C.C(r.referenceValue),i}return r.__extends(t,e),t.prototype.matches=function(e){var t=C.i(e.key,this.key);return this._n(t)},t}(er),nr=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"in",n)||this).keys=ir(0,n),r}return r.__extends(t,e),t.prototype.matches=function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))},t}(er),rr=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"not-in",n)||this).keys=ir(0,n),r}return r.__extends(t,e),t.prototype.matches=function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))},t}(er);function ir(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return C.C(e.referenceValue)}))}var or=function(e){function t(t,n){return e.call(this,t,"array-contains",n)||this}return r.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return dt(t)&&nt(t.arrayValue,this.value)},t}(er),ar=function(e){function t(t,n){return e.call(this,t,"in",n)||this}return r.__extends(t,e),t.prototype.matches=function(e){var t=e.field(this.field);return null!==t&&nt(this.value.arrayValue,t)},t}(er),sr=function(e){function t(t,n){return e.call(this,t,"not-in",n)||this}return r.__extends(t,e),t.prototype.matches=function(e){if(nt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.field(this.field);return null!==t&&!nt(this.value.arrayValue,t)},t}(er),lr=function(e){function t(t,n){return e.call(this,t,"array-contains-any",n)||this}return r.__extends(t,e),t.prototype.matches=function(e){var t=this,n=e.field(this.field);return!(!dt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return nt(t.value.arrayValue,e)}))},t}(er),cr=function(e,t){this.position=e,this.before=t};function ur(e){return(e.before?"b":"a")+":"+e.position.map((function(e){return ot(e)})).join(",")}function hr(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],a=e.position[i];if(r=o.field.p()?C.i(C.C(a.referenceValue),n.key):rt(a,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function dr(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!tt(e.position[n],t.position[n]))return!1;return!0}var fr=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t};function pr(e,t,n){var r=e.field.p()?C.i(t.key,n.key):function(e,t,n){var r=t.field(e),i=n.field(e);return null!==r&&null!==i?rt(r,i):y()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}function mr(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}var gr=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},vr=function(){function e(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=e,this.dn=t,this.wn=n,this.mn=r,this.Tn=i,this.En=0,this.In=null,this.An=Date.now(),this.reset()}return e.prototype.reset=function(){this.En=0},e.prototype.Rn=function(){this.En=this.Tn},e.prototype.gn=function(e){var t=this;this.cancel();var n=Math.floor(this.En+this.Pn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);i>0&&p("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.In=this.fn.yn(this.dn,i,(function(){return t.An=Date.now(),e()})),this.En*=this.mn,this.En<this.wn&&(this.En=this.wn),this.En>this.Tn&&(this.En=this.Tn)},e.prototype.Vn=function(){null!==this.In&&(this.In.pn(),this.In=null)},e.prototype.cancel=function(){null!==this.In&&(this.In.cancel(),this.In=null)},e.prototype.Pn=function(){return(Math.random()-.5)*this.En},e}(),yr=function(){function e(e){var t=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,e((function(e){t.Sn=!0,t.result=e,t.bn&&t.bn(e)}),(function(e){t.Sn=!0,t.error=e,t.vn&&t.vn(e)}))}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.Dn&&y(),this.Dn=!0,this.Sn?this.error?this.Cn(n,this.error):this.Nn(t,this.result):new e((function(e,i){r.bn=function(n){r.Nn(t,n).next(e,i)},r.vn=function(t){r.Cn(n,t).next(e,i)}}))},e.prototype.Fn=function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))},e.prototype.xn=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}},e.prototype.Nn=function(t,n){return t?this.xn((function(){return t(n)})):e.resolve(n)},e.prototype.Cn=function(t,n){return t?this.xn((function(){return t(n)})):e.reject(n)},e.resolve=function(t){return new e((function(e,n){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.$n=function(t){return new e((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(e){return n(e)}))})),o=!0,i===r&&e()}))},e.kn=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next((function(n){return n?e.resolve(n):t()}))},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.$n(r)},e}(),br=function(){function e(t,n,r){this.name=t,this.version=n,this.Mn=r,12.2===e.On(a.getUA())&&m("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(e){return p("SimpleDb","Removing database:",e),Ar(window.indexedDB.deleteDatabase(e)).Fn()},e.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(e.Bn())return!0;var t=a.getUA(),n=e.On(t),r=0<n&&n<10,i=e.qn(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.Bn=function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Un)},e.Qn=function(e,t){return e.store(t)},e.On=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},e.qn=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},e.prototype.Wn=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(p("SimpleDb","Opening database:",this.name),t=this,[4,new Promise((function(t,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(e){var n=e.target.result;t(n)},i.onblocked=function(){r(new wr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var n=t.target.error;"VersionError"===n.name?r(new h(u.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new wr(e,n))},i.onupgradeneeded=function(e){p("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.Mn.createOrUpgrade(t,i.transaction,e.oldVersion,n.version).next((function(){p("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:t.db=r.sent(),r.label=2;case 2:return[2,(this.jn&&(this.db.onversionchange=function(e){return n.jn(e)}),this.db)]}}))}))},e.prototype.Kn=function(e){this.jn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},e.prototype.runTransaction=function(e,t,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,a,s,l,c;return r.__generator(this,(function(u){switch(u.label){case 0:o="readonly"===t,a=0,s=function(){var t,s,c,u,h;return r.__generator(this,(function(r){switch(r.label){case 0:++a,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,l.Wn(e)];case 2:return l.db=r.sent(),t=Sr.open(l.db,e,o?"readonly":"readwrite",n),s=i(t).catch((function(e){return t.abort(e),yr.reject(e)})).Fn(),c={},s.catch((function(){})),[4,t.Gn];case 3:return[2,(c.value=(r.sent(),s),c)];case 4:return u=r.sent(),h="FirebaseError"!==u.name&&a<3,p("SimpleDb","Transaction failed with error:",u.message,"Retrying:",h),l.close(),h?[3,5]:[2,{value:Promise.reject(u)}];case 5:return[2]}}))},l=this,u.label=1;case 1:return[5,s()];case 2:if("object"==typeof(c=u.sent()))return[2,c.value];u.label=3;case 3:return[3,1];case 4:return[2]}}))}))},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),_r=function(){function e(e){this.zn=e,this.Hn=!1,this.Yn=null}return Object.defineProperty(e.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Jn",{get:function(){return this.Yn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.zn=e},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Hn=!0},e.prototype.Xn=function(e){this.Yn=e},e.prototype.delete=function(){return Ar(this.zn.delete())},e}(),wr=function(e){function t(t,n){var r=this;return(r=e.call(this,u.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return r.__extends(t,e),t}(h);function xr(e){return"IndexedDbTransactionError"===e.name}var Sr=function(){function e(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new gr,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new wr(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){var r=Tr(t.target.error);n.Zn.reject(new wr(e,r))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new wr(n,t)}},Object.defineProperty(e.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(e){e&&this.Zn.reject(e),this.aborted||(p("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return new Er(t)},e}(),Er=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(p("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(p("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ar(n)},e.prototype.add=function(e){return p("SimpleDb","ADD",this.store.name,e,e),Ar(this.store.add(e))},e.prototype.get=function(e){var t=this;return Ar(this.store.get(e)).next((function(n){return void 0===n&&(n=null),p("SimpleDb","GET",t.store.name,e,n),n}))},e.prototype.delete=function(e){return p("SimpleDb","DELETE",this.store.name,e),Ar(this.store.delete(e))},e.prototype.count=function(){return p("SimpleDb","COUNT",this.store.name),Ar(this.store.count())},e.prototype.ts=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.es(n,(function(e,t){r.push(t)})).next((function(){return r}))},e.prototype.ns=function(e,t){p("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.ss=!1;var r=this.cursor(n);return this.es(r,(function(e,t,n){return n.delete()}))},e.prototype.rs=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.es(r,t)},e.prototype.os=function(e){var t=this.cursor({});return new yr((function(n,r){t.onerror=function(e){var t=Tr(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))},e.prototype.es=function(e,t){var n=[];return new yr((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new _r(i),a=t(i.primaryKey,i.value,o);if(a instanceof yr){var s=a.catch((function(e){return o.done(),yr.reject(e)}));n.push(s)}o.Sn?r():null===o.Jn?i.continue():i.continue(o.Jn)}else r()}})).next((function(){return yr.$n(n)}))},e.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.ss?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function Ar(e){return new yr((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Tr(e.target.error);n(t)}}))}var Mr=!1;function Tr(e){var t=br.On(a.getUA());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new h("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Mr||(Mr=!0,setTimeout((function(){throw r}),0)),r}}return e}function Cr(){return"undefined"!=typeof window?window:null}function Ir(){return"undefined"!=typeof document?document:null}var Rr=function(){function e(e,t,n,r,i){this.cs=e,this.dn=t,this.us=n,this.op=r,this.hs=i,this.ls=new gr,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch((function(e){}))}return e._s=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.fs=setTimeout((function(){return t.ds()}),e)},e.prototype.pn=function(){return this.ds()},e.prototype.cancel=function(e){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new h(u.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.ds=function(){var e=this;this.cs.ws((function(){return null!==e.fs?(e.clearTimeout(),e.op().then((function(t){return e.ls.resolve(t)}))):Promise.resolve()}))},e.prototype.clearTimeout=function(){null!==this.fs&&(this.hs(this),clearTimeout(this.fs),this.fs=null)},e}(),Pr=function(){function e(){var e=this;this.Ts=Promise.resolve(),this.Es=[],this.Is=!1,this.As=[],this.Rs=null,this.gs=!1,this.Ps=[],this.ys=new vr(this,"async_queue_retry"),this.Vs=function(){var t=Ir();t&&p("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ys.Vn()};var t=Ir();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vs)}return Object.defineProperty(e.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),e.prototype.ws=function(e){this.enqueue(e)},e.prototype.bs=function(e){this.vs(),this.Ss(e)},e.prototype.Ds=function(){if(!this.Is){this.Is=!0;var e=Ir();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Vs)}},e.prototype.enqueue=function(e){return this.vs(),this.Is?new Promise((function(e){})):this.Ss(e)},e.prototype.Cs=function(e){var t=this;this.ws((function(){return t.Es.push(e),t.Ns()}))},e.prototype.Ns=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(0===this.Es.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Es[0]()];case 2:return n.sent(),this.Es.shift(),this.ys.reset(),[3,4];case 3:if(!xr(e=n.sent()))throw e;return p("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:this.Es.length>0&&this.ys.gn((function(){return t.Ns()})),n.label=5;case 5:return[2]}}))}))},e.prototype.Ss=function(e){var t=this,n=this.Ts.then((function(){return t.gs=!0,e().catch((function(e){throw t.Rs=e,t.gs=!1,m("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e})).then((function(e){return t.gs=!1,e}))}));return this.Ts=n,n},e.prototype.yn=function(e,t,n){var r=this;this.vs(),this.Ps.indexOf(e)>-1&&(t=0);var i=Rr._s(this,e,t,n,(function(e){return r.Fs(e)}));return this.As.push(i),i},e.prototype.vs=function(){this.Rs&&y()},e.prototype.xs=function(){},e.prototype.$s=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return[4,e=this.Ts];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ts)return[3,0];t.label=3;case 3:return[2]}}))}))},e.prototype.ks=function(e){for(var t=0,n=this.As;t<n.length;t++)if(n[t].dn===e)return!0;return!1},e.prototype.Ms=function(e){var t=this;return this.$s().then((function(){t.As.sort((function(e,t){return e.us-t.us}));for(var n=0,r=t.As;n<r.length;n++){var i=r[n];if(i.pn(),"all"!==e&&i.dn===e)break}return t.$s()}))},e.prototype.Os=function(e){this.Ps.push(e)},e.prototype.Fs=function(e){var t=this.As.indexOf(e);this.As.splice(t,1)},e}();function Lr(e,t){if(m("AsyncQueue",t+": "+e),xr(e))return new h(u.UNAVAILABLE,t+": "+e);throw e}var kr=function(){this.Ls=void 0,this.listeners=[]},Dr=function(){this.Bs=new ae((function(e){return Kn(e)}),Yn),this.onlineState="Unknown",this.qs=new Set};function Or(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:if(n=_(e),i=t.query,o=!1,(a=n.Bs.get(i))||(o=!0,a=new kr),!o)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),s=a,[4,n.Us(i)];case 2:return s.Ls=r.sent(),[3,4];case 3:return l=r.sent(),c=Lr(l,"Initialization of query '"+Zn(t.query)+"' failed"),[2,void t.onError(c)];case 4:return n.Bs.set(i,a),a.listeners.push(t),t.Qs(n.onlineState),a.Ls&&t.Ws(a.Ls)&&zr(n),[2]}}))}))}function Nr(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s;return r.__generator(this,(function(r){return n=_(e),i=t.query,o=!1,(a=n.Bs.get(i))&&(s=a.listeners.indexOf(t))>=0&&(a.listeners.splice(s,1),o=0===a.listeners.length),o?[2,(n.Bs.delete(i),n.js(i))]:[2]}))}))}function Ur(e,t){for(var n=_(e),r=!1,i=0,o=t;i<o.length;i++){var a=o[i],s=a.query,l=n.Bs.get(s);if(l){for(var c=0,u=l.listeners;c<u.length;c++)u[c].Ws(a)&&(r=!0);l.Ls=a}}r&&zr(n)}function Fr(e,t,n){var r=_(e),i=r.Bs.get(t);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.Bs.delete(t)}function zr(e){e.qs.forEach((function(e){e.next()}))}var Br=function(){function e(e,t,n){this.query=e,this.Ks=t,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}return e.prototype.Ws=function(e){if(!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new Be(e.query,e.docs,e.Qt,t,e.Wt,e.fromCache,e.jt,!0)}var o=!1;return this.Gs?this.Hs(e)&&(this.Ks.next(e),o=!0):this.Ys(e,this.onlineState)&&(this.Js(e),o=!0),this.zs=e,o},e.prototype.onError=function(e){this.Ks.error(e)},e.prototype.Qs=function(e){this.onlineState=e;var t=!1;return this.zs&&!this.Gs&&this.Ys(this.zs,e)&&(this.Js(this.zs),t=!0),t},e.prototype.Ys=function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return!(this.options.Xs&&n||e.docs.m()&&"Offline"!==t)},e.prototype.Hs=function(e){if(e.docChanges.length>0)return!0;var t=this.zs&&this.zs.hasPendingWrites!==e.hasPendingWrites;return!(!e.jt&&!t)&&!0===this.options.includeMetadataChanges},e.prototype.Js=function(e){e=Be.Gt(e.query,e.docs,e.Wt,e.fromCache),this.Gs=!0,this.Ks.next(e)},e}(),Vr=function(){function e(e){this.uid=e}return e.prototype.Zs=function(){return null!=this.uid},e.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e}();Vr.UNAUTHENTICATED=new Vr(null),Vr.ei=new Vr("google-credentials-uid"),Vr.ni=new Vr("first-party-uid");var jr=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.si=function(e){return n.ii(e)},this.ri=function(e){return t.oi(e)})}return e.prototype.ii=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.ri&&this.ri(e),e},e}();function Hr(e,t){return"firestore_clients_"+e+"_"+t}function Gr(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.Zs()&&(r+="_"+t.uid),r}function Wr(e,t){return"firestore_targets_"+e+"_"+t}jr.ai=-1;var qr=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}return e.ci=function(t,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new h(i.error.code,i.error.message)),o?new e(t,n,i.state,a):(m("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.ui=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Xr=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n}return e.ci=function(t,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new h(r.error.code,r.error.message)),i?new e(t,r.state,o):(m("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.ui=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),$r=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.ci=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ue(),a=0;i&&a<r.activeTargetIds.length;++a)i=he(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(m("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),Yr=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.ci=function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(m("SharedClientState","Failed to parse online state: "+t),null)},e}(),Kr=function(){function e(){this.activeTargetIds=Ue()}return e.prototype.hi=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.li=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.ui=function(){var e={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),Zr=function(){function e(e,t,n,r,i){this.window=e,this.fn=t,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.mi.bind(this),this.Ti=new Se(K),this.Ei=!1,this.Ii=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=Hr(this.persistenceKey,this._i),this.Ri=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.Ti=this.Ti.ot(this._i,new Kr),this.gi=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Vi=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.window.addEventListener("storage",this.wi)}return e.Ln=function(e){return!(!e||!e.localStorage)},e.prototype.start=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,i,o,a,s,l,c,u,h,d=this;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,this.fi.pi()];case 1:for(e=r.sent(),t=0,n=e;t<n.length;t++)(i=n[t])!==this._i&&(o=this.getItem(Hr(this.persistenceKey,i)))&&(a=$r.ci(i,o))&&(this.Ti=this.Ti.ot(a.clientId,a));for(this.bi(),(s=this.storage.getItem(this.Vi))&&(l=this.vi(s))&&this.Si(l),c=0,u=this.Ii;c<u.length;c++)h=u[c],this.mi(h);return this.Ii=[],this.window.addEventListener("unload",(function(){return d.Di()})),this.Ei=!0,[2]}}))}))},e.prototype.oi=function(e){this.setItem(this.Ri,JSON.stringify(e))},e.prototype.Ci=function(){return this.Ni(this.Ti)},e.prototype.Fi=function(e){var t=!1;return this.Ti.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t},e.prototype.xi=function(e){this.$i(e,"pending")},e.prototype.ki=function(e,t,n){this.$i(e,t,n),this.Mi(e)},e.prototype.Oi=function(e){var t="not-current";if(this.Fi(e)){var n=this.storage.getItem(Wr(this.persistenceKey,e));if(n){var r=Xr.ci(e,n);r&&(t=r.state)}}return this.Li.hi(e),this.bi(),t},e.prototype.Bi=function(e){this.Li.li(e),this.bi()},e.prototype.qi=function(e){return this.Li.activeTargetIds.has(e)},e.prototype.Ui=function(e){this.removeItem(Wr(this.persistenceKey,e))},e.prototype.Qi=function(e,t,n){this.Wi(e,t,n)},e.prototype.ji=function(e,t,n){var r=this;t.forEach((function(e){r.Mi(e)})),this.currentUser=e,n.forEach((function(e){r.xi(e)}))},e.prototype.Ki=function(e){this.Gi(e)},e.prototype.Di=function(){this.Ei&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ei=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return p("SharedClientState","READ",e,t),t},e.prototype.setItem=function(e,t){p("SharedClientState","SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){p("SharedClientState","REMOVE",e),this.storage.removeItem(e)},e.prototype.mi=function(e){var t=this,n=e;if(n.storageArea===this.storage){if(p("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ai)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs((function(){return r.__awaiter(t,void 0,void 0,(function(){var e,t,i,o,a,s;return r.__generator(this,(function(r){if(this.Ei){if(null!==n.key)if(this.gi.test(n.key)){if(null==n.newValue)return e=this.zi(n.key),[2,this.Hi(e,null)];if(t=this.Yi(n.key,n.newValue))return[2,this.Hi(t.clientId,t)]}else if(this.Pi.test(n.key)){if(null!==n.newValue&&(i=this.Ji(n.key,n.newValue)))return[2,this.Xi(i)]}else if(this.yi.test(n.key)){if(null!==n.newValue&&(o=this.Zi(n.key,n.newValue)))return[2,this.tr(o)]}else if(n.key===this.Vi){if(null!==n.newValue&&(a=this.vi(n.newValue)))return[2,this.Si(a)]}else n.key===this.Ri&&(s=function(e){var t=jr.ai;if(null!=e)try{var n=JSON.parse(e);b("number"==typeof n),t=n}catch(e){m("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==jr.ai&&this.si(s)}else this.Ii.push(n);return[2]}))}))}))}},Object.defineProperty(e.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),e.prototype.bi=function(){this.setItem(this.Ai,this.Li.ui())},e.prototype.$i=function(e,t,n){var r=new qr(this.currentUser,e,t,n),i=Gr(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ui())},e.prototype.Mi=function(e){var t=Gr(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.Gi=function(e){var t={clientId:this._i,onlineState:e};this.storage.setItem(this.Vi,JSON.stringify(t))},e.prototype.Wi=function(e,t,n){var r=Wr(this.persistenceKey,e),i=new Xr(e,t,n);this.setItem(r,i.ui())},e.prototype.zi=function(e){var t=this.gi.exec(e);return t?t[1]:null},e.prototype.Yi=function(e,t){var n=this.zi(e);return $r.ci(n,t)},e.prototype.Ji=function(e,t){var n=this.Pi.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return qr.ci(new Vr(i),r,t)},e.prototype.Zi=function(e,t){var n=this.yi.exec(e),r=Number(n[1]);return Xr.ci(r,t)},e.prototype.vi=function(e){return Yr.ci(e)},e.prototype.Xi=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(p("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])}))}))},e.prototype.tr=function(e){return this.fi.nr(e.targetId,e.state,e.error)},e.prototype.Hi=function(e,t){var n=this,r=t?this.Ti.ot(e,t):this.Ti.remove(e),i=this.Ni(this.Ti),o=this.Ni(r),a=[],s=[];return o.forEach((function(e){i.has(e)||a.push(e)})),i.forEach((function(e){o.has(e)||s.push(e)})),this.fi.sr(a,s).then((function(){n.Ti=r}))},e.prototype.Si=function(e){this.Ti.get(e.clientId)&&this.di(e.onlineState)},e.prototype.Ni=function(e){var t=Ue();return e.forEach((function(e,n){t=t.kt(n.activeTargetIds)})),t},e}(),Qr=function(){function e(){this.ir=new Kr,this.rr={},this.di=null,this.si=null}return e.prototype.xi=function(e){},e.prototype.ki=function(e,t,n){},e.prototype.Oi=function(e){return this.ir.hi(e),this.rr[e]||"not-current"},e.prototype.Qi=function(e,t,n){this.rr[e]=t},e.prototype.Bi=function(e){this.ir.li(e)},e.prototype.qi=function(e){return this.ir.activeTargetIds.has(e)},e.prototype.Ui=function(e){delete this.rr[e]},e.prototype.Ci=function(){return this.ir.activeTargetIds},e.prototype.Fi=function(e){return this.ir.activeTargetIds.has(e)},e.prototype.start=function(){return this.ir=new Kr,Promise.resolve()},e.prototype.ji=function(e,t,n){},e.prototype.Ki=function(e){},e.prototype.Di=function(){},e.prototype.oi=function(e){},e}(),Jr=function(){function e(e,t,n,r){this.batchId=e,this.ar=t,this.baseMutations=n,this.mutations=r}return e.prototype.cr=function(e,t,n){for(var r=n.ur,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(e)&&(t=gn(o,t,r[i]))}return t},e.prototype.hr=function(e,t){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(e)&&(t=vn(i,t,t,this.ar))}for(var o=t,a=0,s=this.mutations;a<s.length;a++){var l=s[a];l.key.isEqual(e)&&(t=vn(l,t,o,this.ar))}return t},e.prototype.lr=function(e){var t=this,n=e;return this.mutations.forEach((function(r){var i=t.hr(r.key,e.get(r.key));i&&(n=n.ot(r.key,i))})),n},e.prototype.keys=function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Oe())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&Z(this.mutations,e.mutations,(function(e,t){return bn(e,t)}))&&Z(this.baseMutations,e.baseMutations,(function(e,t){return bn(e,t)}))},e}(),ei=function(){function e(e,t,n,r){this.batch=e,this._r=t,this.ur=n,this.dr=r}return e.from=function(t,n,r){b(t.mutations.length===r.length);for(var i=ke,o=t.mutations,a=0;a<o.length;a++)i=i.ot(o[a].key,r[a].version);return new e(t,n,r,i)},e}(),ti=function(){function e(){this.wr=new ae((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.mr=!1}return Object.defineProperty(e.prototype,"readTime",{get:function(){return this.Tr},set:function(e){this.Tr=e},enumerable:!1,configurable:!0}),e.prototype.Er=function(e,t){this.Ir(),this.readTime=t,this.wr.set(e.key,e)},e.prototype.Ar=function(e,t){this.Ir(),t&&(this.readTime=t),this.wr.set(e,null)},e.prototype.Rr=function(e,t){this.Ir();var n=this.wr.get(t);return void 0!==n?yr.resolve(n):this.gr(e,t)},e.prototype.getEntries=function(e,t){return this.Pr(e,t)},e.prototype.apply=function(e){return this.Ir(),this.mr=!0,this.yr(e)},e.prototype.Ir=function(){},e}(),ni="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ri=function(){function e(){this.Vr=[]}return e.prototype.pr=function(e){this.Vr.push(e)},e.prototype.br=function(){this.Vr.forEach((function(e){return e()}))},e}(),ii=function(){function e(e,t,n){this.vr=e,this.Sr=t,this.Dr=n}return e.prototype.Cr=function(e,t){var n=this;return this.Sr.Nr(e,t).next((function(r){return n.Fr(e,t,r)}))},e.prototype.Fr=function(e,t,n){return this.vr.Rr(e,t).next((function(e){for(var r=0,i=n;r<i.length;r++)e=i[r].hr(t,e);return e}))},e.prototype.$r=function(e,t,n){var r=Re();return t.forEach((function(e,t){for(var i=0,o=n;i<o.length;i++)t=o[i].hr(e,t);r=r.ot(e,t)})),r},e.prototype.kr=function(e,t){var n=this;return this.vr.getEntries(e,t).next((function(t){return n.Mr(e,t)}))},e.prototype.Mr=function(e,t){var n=this;return this.Sr.Or(e,t).next((function(r){var i=n.$r(e,t,r),o=Ie();return i.forEach((function(e,t){t||(t=new Dn(e,le.min())),o=o.ot(e,t)})),o}))},e.prototype.Lr=function(e,t,n){return function(e){return C.F(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Br(e,t.path):Hn(t)?this.qr(e,t,n):this.Ur(e,t,n)},e.prototype.Br=function(e,t){return this.Cr(e,new C(t)).next((function(e){var t=Le();return e instanceof kn&&(t=t.ot(e.key,e)),t}))},e.prototype.qr=function(e,t,n){var r=this,i=t.collectionGroup,o=Le();return this.Dr.Qr(e,i).next((function(a){return yr.forEach(a,(function(a){var s=function(e,t){return new Nn(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt)}(t,a.child(i));return r.Ur(e,s,n).next((function(e){e.forEach((function(e,t){o=o.ot(e,t)}))}))})).next((function(){return o}))}))},e.prototype.Ur=function(e,t,n){var r,i,o=this;return this.vr.Lr(e,t,n).next((function(n){return r=n,o.Sr.Wr(e,t)})).next((function(t){return i=t,o.jr(e,i,r).next((function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var l=s[a],c=l.key,u=r.get(c),h=vn(l,u,u,o.ar);r=h instanceof kn?r.ot(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(e,n){Qn(t,n)||(r=r.remove(e))})),r}))},e.prototype.jr=function(e,t,n){for(var r=Oe(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var l=s[a];l instanceof xn&&null===n.get(l.key)&&(r=r.add(l.key))}var c=n;return this.vr.getEntries(e,r).next((function(e){return e.forEach((function(e,t){null!==t&&t instanceof kn&&(c=c.ot(e,t))})),c}))},e}(),oi=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.Kr=n,this.Gr=r}return e.zr=function(t,n){for(var r=Oe(),i=Oe(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new e(t,n.fromCache,r,i)},e}();function ai(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=K(n,i);return 0===a?K(r,o):a}var si=function(){function e(e){this.Hr=e,this.buffer=new Me(ai),this.Yr=0}return e.prototype.Jr=function(){return++this.Yr},e.prototype.Xr=function(e){var t=[e,this.Jr()];if(this.buffer.size<this.Hr)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();ai(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),li={Zr:!1,eo:0,no:0,so:0},ci=function(){function e(e,t,n){this.io=e,this.ro=t,this.oo=n}return e.ao=function(t){return new e(t,e.co,e.uo)},e}();ci.ho=-1,ci.lo=1048576,ci._o=41943040,ci.co=10,ci.uo=1e3,ci.fo=new ci(ci._o,ci.co,ci.uo),ci.do=new ci(ci.ho,0,0);var ui=function(){function e(e,t){this.wo=e,this.cs=t,this.mo=!1,this.To=null}return e.prototype.start=function(e){this.wo.params.io!==ci.ho&&this.Eo(e)},e.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(e.prototype,"Ei",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),e.prototype.Eo=function(e){var t=this,n=this.mo?3e5:6e4;p("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.To=this.cs.yn("lru_garbage_collection",n,(function(){return r.__awaiter(t,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:this.To=null,this.mo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,e.Io(this.wo)];case 2:return n.sent(),[3,7];case 3:return xr(t=n.sent())?(p("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,Ro(t)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.Eo(e)];case 8:return n.sent(),[2]}}))}))}))},e}(),hi=function(){function e(e,t){this.Ao=e,this.params=t}return e.prototype.Ro=function(e,t){return this.Ao.Po(e).next((function(e){return Math.floor(t/100*e)}))},e.prototype.yo=function(e,t){var n=this;if(0===t)return yr.resolve(jr.ai);var r=new si(t);return this.Ao.Ce(e,(function(e){return r.Xr(e.sequenceNumber)})).next((function(){return n.Ao.Vo(e,(function(e){return r.Xr(e)}))})).next((function(){return r.maxValue}))},e.prototype.po=function(e,t,n){return this.Ao.po(e,t,n)},e.prototype.bo=function(e,t){return this.Ao.bo(e,t)},e.prototype.vo=function(e,t){var n=this;return this.params.io===ci.ho?(p("LruGarbageCollector","Garbage collection skipped; disabled"),yr.resolve(li)):this.So(e).next((function(r){return r<n.params.io?(p("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.io),li):n.Do(e,t)}))},e.prototype.So=function(e){return this.Ao.So(e)},e.prototype.Do=function(e,t){var n,r,i,a,s,l,c,u=this,h=Date.now();return this.Ro(e,this.params.ro).next((function(t){return t>u.params.oo?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+u.params.oo+" from "+t),r=u.params.oo):r=t,a=Date.now(),u.yo(e,r)})).next((function(r){return n=r,s=Date.now(),u.po(e,n,t)})).next((function(t){return i=t,l=Date.now(),u.bo(e,n)})).next((function(e){return c=Date.now(),f()<=o.LogLevel.DEBUG&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(l-s)+"ms\n\tRemoved "+e+" documents in "+(c-l)+"ms\nTotal Duration: "+(c-h)+"ms"),yr.resolve({Zr:!0,eo:r,no:i,so:e})}))},e}();function di(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=pi(t)),t=fi(e.get(n),t);return pi(t)}function fi(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function pi(e){return e+""}function mi(e){var t=e.length;if(b(t>=2),2===t)return b(""===e.charAt(0)&&""===e.charAt(1)),A.P();for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf("",o);switch((a<0||a>n)&&y(),e.charAt(a+1)){case"":var s=e.substring(o,a),l=void 0;0===i.length?l=s:(l=i+=s,i=""),r.push(l);break;case"":i+=e.substring(o,a),i+="\0";break;case"":i+=e.substring(o,a+1);break;default:y()}o=a+2}return new A(r)}var gi=function(e){this.Co=e};function vi(e,t){if(t.document)return function(e,t,n){var r=It(e,t.name),i=At(t.updateTime),o=new In({mapValue:{fields:t.fields}});return new kn(r,i,o,{hasCommittedMutations:!!n})}(e.Co,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=C.$(t.noDocument.path),r=xi(t.noDocument.readTime);return new Dn(n,r,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var i=C.$(t.unknownDocument.path),o=xi(t.unknownDocument.version);return new On(i,o)}return y()}function yi(e,t,n){var r=bi(n),i=t.key.path.h().A();if(t instanceof kn){var o=function(e,t){return{name:Ct(e,t.key),fields:t.rn().mapValue.fields,updateTime:xt(e,t.version.Z())}}(e.Co,t),a=t.hasCommittedMutations;return new $i(null,null,o,a,r,i)}if(t instanceof Dn){var s=t.key.path.A(),l=wi(t.version),c=t.hasCommittedMutations;return new $i(null,new qi(s,l),null,c,r,i)}if(t instanceof On){var u=t.key.path.A(),h=wi(t.version);return new $i(new Xi(u,h),null,null,!0,r,i)}return y()}function bi(e){var t=e.Z();return[t.seconds,t.nanoseconds]}function _i(e){var t=new se(e[0],e[1]);return le.J(t)}function wi(e){var t=e.Z();return new Vi(t.seconds,t.nanoseconds)}function xi(e){var t=new se(e.seconds,e.nanoseconds);return le.J(t)}function Si(e,t){var n=(t.baseMutations||[]).map((function(t){return Nt(e.Co,t)})),r=t.mutations.map((function(t){return Nt(e.Co,t)})),i=se.fromMillis(t.localWriteTimeMs);return new Jr(t.batchId,i,n,r)}function Ei(e){var t,n,r=xi(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?xi(e.lastLimboFreeSnapshotVersion):le.min();return void 0!==e.query.documents?(b(1===(n=e.query).documents.length),t=Wn(Fn(Pt(n.documents[0])))):t=zt(e.query),new be(t,e.targetId,0,e.lastListenSequenceNumber,r,i,J.fromBase64String(e.resumeToken))}function Ai(e,t){var n,r=wi(t.nt),i=wi(t.lastLimboFreeSnapshotVersion);n=ge(t.target)?Ut(e.Co,t.target):Ft(e.Co,t.target);var o=t.resumeToken.toBase64();return new Ki(t.targetId,pe(t.target),r,o,t.sequenceNumber,i,n)}var Mi=function(){function e(e,t,n,r){this.userId=e,this.serializer=t,this.Dr=n,this.No=r,this.Fo={}}return e.xo=function(t,n,r,i){return b(""!==t.uid),new e(t.Zs()?t.uid:"",n,r,i)},e.prototype.$o=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ii(e).rs({index:Gi.userMutationsIndex,range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))},e.prototype.ko=function(e,t,n,r){var i=this,o=Ri(e),a=Ii(e);return a.add({}).next((function(s){b("number"==typeof s);for(var l=new Jr(s,t,n,r),c=function(e,t,n){var r=n.baseMutations.map((function(t){return Ot(e.Co,t)})),i=n.mutations.map((function(t){return Ot(e.Co,t)}));return new Gi(t,n.batchId,n.ar.toMillis(),r,i)}(i.serializer,i.userId,l),u=[],h=new Me((function(e,t){return K(e.R(),t.R())})),d=0,f=r;d<f.length;d++){var p=f[d],m=Wi.key(i.userId,p.key.path,s);h=h.add(p.key.path.h()),u.push(a.put(c)),u.push(o.put(m,Wi.PLACEHOLDER))}return h.forEach((function(t){u.push(i.Dr.Mo(e,t))})),e.pr((function(){i.Fo[s]=l.keys()})),yr.$n(u).next((function(){return l}))}))},e.prototype.Oo=function(e,t){var n=this;return Ii(e).get(t).next((function(e){return e?(b(e.userId===n.userId),Si(n.serializer,e)):null}))},e.prototype.Lo=function(e,t){var n=this;return this.Fo[t]?yr.resolve(this.Fo[t]):this.Oo(e,t).next((function(e){if(e){var r=e.keys();return n.Fo[t]=r,r}return null}))},e.prototype.Bo=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ii(e).rs({index:Gi.userMutationsIndex,range:i},(function(e,t,i){t.userId===n.userId&&(b(t.batchId>=r),o=Si(n.serializer,t)),i.done()})).next((function(){return o}))},e.prototype.qo=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ii(e).rs({index:Gi.userMutationsIndex,range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))},e.prototype.Uo=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ii(e).ts(Gi.userMutationsIndex,n).next((function(e){return e.map((function(e){return Si(t.serializer,e)}))}))},e.prototype.Nr=function(e,t){var n=this,r=Wi.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Ri(e).rs({range:i},(function(r,i,a){var s=r[0],l=r[1],c=r[2],u=mi(l);if(s===n.userId&&t.path.isEqual(u))return Ii(e).get(c).next((function(e){if(!e)throw y();b(e.userId===n.userId),o.push(Si(n.serializer,e))}));a.done()})).next((function(){return o}))},e.prototype.Or=function(e,t){var n=this,r=new Me(K),i=[];return t.forEach((function(t){var o=Wi.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=Ri(e).rs({range:a},(function(e,i,o){var a=e[0],s=e[1],l=e[2],c=mi(s);a===n.userId&&t.path.isEqual(c)?r=r.add(l):o.done()}));i.push(s)})),yr.$n(i).next((function(){return n.Qo(e,r)}))},e.prototype.Wr=function(e,t){var n=this,r=t.path,i=r.length+1,o=Wi.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Me(K);return Ri(e).rs({range:a},(function(e,t,o){var a=e[0],l=e[1],c=e[2],u=mi(l);a===n.userId&&r.T(u)?u.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Qo(e,s)}))},e.prototype.Qo=function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(Ii(e).get(t).next((function(e){if(null===e)throw y();b(e.userId===n.userId),r.push(Si(n.serializer,e))})))})),yr.$n(i).next((function(){return r}))},e.prototype.Wo=function(e,t){var n=this;return Ci(e.jo,this.userId,t).next((function(r){return e.pr((function(){n.Ko(t.batchId)})),yr.forEach(r,(function(t){return n.No.Go(e,t)}))}))},e.prototype.Ko=function(e){delete this.Fo[e]},e.prototype.zo=function(e){var t=this;return this.$o(e).next((function(n){if(!n)return yr.resolve();var r=IDBKeyRange.lowerBound(Wi.prefixForUser(t.userId)),i=[];return Ri(e).rs({range:r},(function(e,n,r){if(e[0]===t.userId){var o=mi(e[1]);i.push(o)}else r.done()})).next((function(){b(0===i.length)}))}))},e.prototype.Ho=function(e,t){return Ti(e,this.userId,t)},e.prototype.Yo=function(e){var t=this;return Pi(e).get(this.userId).next((function(e){return e||new Hi(t.userId,-1,"")}))},e}();function Ti(e,t,n){var r=Wi.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Ri(e).rs({range:o,ss:!0},(function(e,n,r){var o=e[0],s=e[1];e[2],o===t&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function Ci(e,t,n){var r=e.store(Gi.store),i=e.store(Wi.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,l=r.rs({range:a},(function(e,t,n){return s++,n.delete()}));o.push(l.next((function(){b(1===s)})));for(var c=[],u=0,h=n.mutations;u<h.length;u++){var d=h[u],f=Wi.key(t,d.key.path,n.batchId);o.push(i.delete(f)),c.push(d.key)}return yr.$n(o).next((function(){return c}))}function Ii(e){return fo.Qn(e,Gi.store)}function Ri(e){return fo.Qn(e,Wi.store)}function Pi(e){return fo.Qn(e,Hi.store)}var Li=function(){function e(e,t){this.serializer=e,this.Dr=t}return e.prototype.Er=function(e,t,n){return Oi(e).put(Ni(t),n)},e.prototype.Ar=function(e,t){var n=Oi(e),r=Ni(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Jo(e,r)}))},e.prototype.Rr=function(e,t){var n=this;return Oi(e).get(Ni(t)).next((function(e){return n.Xo(e)}))},e.prototype.Zo=function(e,t){var n=this;return Oi(e).get(Ni(t)).next((function(e){var t=n.Xo(e);return t?{ta:t,size:Ui(e)}:null}))},e.prototype.getEntries=function(e,t){var n=this,r=Re();return this.ea(e,t,(function(e,t){var i=n.Xo(t);r=r.ot(e,i)})).next((function(){return r}))},e.prototype.na=function(e,t){var n=this,r=Re(),i=new Se(C.i);return this.ea(e,t,(function(e,t){var o=n.Xo(t);o?(r=r.ot(e,o),i=i.ot(e,Ui(t))):(r=r.ot(e,null),i=i.ot(e,0))})).next((function(){return{sa:r,ia:i}}))},e.prototype.ea=function(e,t,n){if(t.m())return yr.resolve();var r=IDBKeyRange.bound(t.first().path.A(),t.last().path.A()),i=t._t(),o=i.It();return Oi(e).rs({range:r},(function(e,t,r){for(var a=C.$(e);o&&C.i(o,a)<0;)n(o,null),o=i.It();o&&o.isEqual(a)&&(n(o,t),o=i.At()?i.It():null),o?r.Xn(o.path.A()):r.done()})).next((function(){for(;o;)n(o,null),o=i.At()?i.It():null}))},e.prototype.Lr=function(e,t,n){var r=this,i=Le(),o=t.path.length+1,a={};if(n.isEqual(le.min())){var s=t.path.A();a.range=IDBKeyRange.lowerBound(s)}else{var l=t.path.A(),c=bi(n);a.range=IDBKeyRange.lowerBound([l,c],!0),a.index=$i.collectionReadTimeIndex}return Oi(e).rs(a,(function(e,n,a){if(e.length===o){var s=vi(r.serializer,n);t.path.T(s.key.path)?s instanceof kn&&Qn(t,s)&&(i=i.ot(s.key,s)):a.done()}})).next((function(){return i}))},e.prototype.ra=function(e){return new ki(this,!!e&&e.oa)},e.prototype.aa=function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))},e.prototype.getMetadata=function(e){return Di(e).get(Yi.key).next((function(e){return b(!!e),e}))},e.prototype.Jo=function(e,t){return Di(e).put(Yi.key,t)},e.prototype.Xo=function(e){if(e){var t=vi(this.serializer,e);return t instanceof Dn&&t.version.isEqual(le.min())?null:t}return null},e}(),ki=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).ca=t,r.oa=n,r.ua=new ae((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),r}return r.__extends(t,e),t.prototype.yr=function(e){var t=this,n=[],r=0,i=new Me((function(e,t){return K(e.R(),t.R())}));return this.wr.forEach((function(o,a){var s=t.ua.get(o);if(a){var l=yi(t.ca.serializer,a,t.readTime);i=i.add(o.path.h());var c=Ui(l);r+=c-s,n.push(t.ca.Er(e,o,l))}else if(r-=s,t.oa){var u=yi(t.ca.serializer,new Dn(o,le.min()),t.readTime);n.push(t.ca.Er(e,o,u))}else n.push(t.ca.Ar(e,o))})),i.forEach((function(r){n.push(t.ca.Dr.Mo(e,r))})),n.push(this.ca.updateMetadata(e,r)),yr.$n(n)},t.prototype.gr=function(e,t){var n=this;return this.ca.Zo(e,t).next((function(e){return null===e?(n.ua.set(t,0),null):(n.ua.set(t,e.size),e.ta)}))},t.prototype.Pr=function(e,t){var n=this;return this.ca.na(e,t).next((function(e){var t=e.sa;return e.ia.forEach((function(e,t){n.ua.set(e,t)})),t}))},t}(ti);function Di(e){return fo.Qn(e,Yi.store)}function Oi(e){return fo.Qn(e,$i.store)}function Ni(e){return e.path.A()}function Ui(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw y();t=e.noDocument}return JSON.stringify(t).length}var Fi=function(){function e(){this.ha=new zi}return e.prototype.Mo=function(e,t){return this.ha.add(t),yr.resolve()},e.prototype.Qr=function(e,t){return yr.resolve(this.ha.getEntries(t))},e}(),zi=function(){function e(){this.index={}}return e.prototype.add=function(e){var t=e._(),n=e.h(),r=this.index[t]||new Me(A.i),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e._(),n=e.h(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new Me(A.i)).A()},e}(),Bi=function(){function e(e){this.serializer=e}return e.prototype.createOrUpgrade=function(e,t,n,r){var i=this;b(n<r&&n>=0&&r<=10);var o=new Sr("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(ji.store)}(e),function(e){e.createObjectStore(Hi.store,{keyPath:Hi.keyPath}),e.createObjectStore(Gi.store,{keyPath:Gi.keyPath,autoIncrement:!0}).createIndex(Gi.userMutationsIndex,Gi.userMutationsKeyPath,{unique:!0}),e.createObjectStore(Wi.store)}(e),eo(e),function(e){e.createObjectStore($i.store)}(e));var a=yr.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Zi.store),e.deleteObjectStore(Ki.store),e.deleteObjectStore(Qi.store)}(e),eo(e)),a=a.next((function(){return function(e){var t=e.store(Qi.store),n=new Qi(0,0,le.min().Z(),0);return t.put(Qi.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(e,t){return t.store(Gi.store).ts().next((function(n){e.deleteObjectStore(Gi.store),e.createObjectStore(Gi.store,{keyPath:Gi.keyPath,autoIncrement:!0}).createIndex(Gi.userMutationsIndex,Gi.userMutationsKeyPath,{unique:!0});var r=t.store(Gi.store),i=n.map((function(e){return r.put(e)}));return yr.$n(i)}))}(e,o)}))),a=a.next((function(){!function(e){e.createObjectStore(to.store,{keyPath:to.keyPath})}(e)}))),n<5&&r>=5&&(a=a.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(e){e.createObjectStore(Yi.store)}(e),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.createCollectionParentIndex(e,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore($i.store);t.createIndex($i.readTimeIndex,$i.readTimeIndexPath,{unique:!1}),t.createIndex($i.collectionReadTimeIndex,$i.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(a=a.next((function(){return i.rewriteCanonicalIds(o)}))),a},e.prototype.addDocumentGlobal=function(e){var t=0;return e.store($i.store).rs((function(e,n){t+=Ui(n)})).next((function(){var n=new Yi(t);return e.store(Yi.store).put(Yi.key,n)}))},e.prototype.removeAcknowledgedMutations=function(e){var t=this,n=e.store(Hi.store),r=e.store(Gi.store);return n.ts().next((function(n){return yr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ts(Gi.userMutationsIndex,i).next((function(r){return yr.forEach(r,(function(r){b(r.userId===n.userId);var i=Si(t.serializer,r);return Ci(e,n.userId,i).next((function(){}))}))}))}))}))},e.prototype.ensureSequenceNumbers=function(e){var t=e.store(Zi.store),n=e.store($i.store);return e.store(Qi.store).get(Qi.key).next((function(e){var r=[];return n.rs((function(n,i){var o=new A(n),a=function(e){return[0,di(e)]}(o);r.push(t.get(a).next((function(n){return n?yr.resolve():function(n){return t.put(new Zi(0,di(n),e.highestListenSequenceNumber))}(o)})))})).next((function(){return yr.$n(r)}))}))},e.prototype.createCollectionParentIndex=function(e,t){e.createObjectStore(Ji.store,{keyPath:Ji.keyPath});var n=t.store(Ji.store),r=new zi,i=function(e){if(r.add(e)){var t=e._(),i=e.h();return n.put({collectionId:t,parent:di(i)})}};return t.store($i.store).rs({ss:!0},(function(e,t){var n=new A(e);return i(n.h())})).next((function(){return t.store(Wi.store).rs({ss:!0},(function(e,t){e[0];var n=e[1],r=(e[2],mi(n));return i(r.h())}))}))},e.prototype.rewriteCanonicalIds=function(e){var t=this,n=e.store(Ki.store);return n.rs((function(e,r){var i=Ei(r),o=Ai(t.serializer,i);return n.put(o)}))},e}(),Vi=function(e,t){this.seconds=e,this.nanoseconds=t},ji=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};ji.store="owner",ji.key="owner";var Hi=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};Hi.store="mutationQueues",Hi.keyPath="userId";var Gi=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Gi.store="mutations",Gi.keyPath="batchId",Gi.userMutationsIndex="userMutationsIndex",Gi.userMutationsKeyPath=["userId","batchId"];var Wi=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,di(t)]},e.key=function(e,t,n){return[e,di(t),n]},e}();Wi.store="documentMutations",Wi.PLACEHOLDER=new Wi;var qi=function(e,t){this.path=e,this.readTime=t},Xi=function(e,t){this.path=e,this.version=t},$i=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};$i.store="remoteDocuments",$i.readTimeIndex="readTimeIndex",$i.readTimeIndexPath="readTime",$i.collectionReadTimeIndex="collectionReadTimeIndex",$i.collectionReadTimeIndexPath=["parentPath","readTime"];var Yi=function(e){this.byteSize=e};Yi.store="remoteDocumentGlobal",Yi.key="remoteDocumentGlobalKey";var Ki=function(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Ki.store="targets",Ki.keyPath="targetId",Ki.queryTargetsIndexName="queryTargetsIndex",Ki.queryTargetsKeyPath=["canonicalId","targetId"];var Zi=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};Zi.store="targetDocuments",Zi.keyPath=["targetId","path"],Zi.documentTargetsIndex="documentTargetsIndex",Zi.documentTargetsKeyPath=["path","targetId"];var Qi=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Qi.key="targetGlobalKey",Qi.store="targetGlobal";var Ji=function(e,t){this.collectionId=e,this.parent=t};function eo(e){e.createObjectStore(Zi.store,{keyPath:Zi.keyPath}).createIndex(Zi.documentTargetsIndex,Zi.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(Ki.store,{keyPath:Ki.keyPath}).createIndex(Ki.queryTargetsIndexName,Ki.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Qi.store)}Ji.store="collectionParents",Ji.keyPath=["collectionId","parent"];var to=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};to.store="clientMetadata",to.keyPath="clientId";var no=r.__spreadArrays(r.__spreadArrays(r.__spreadArrays([Hi.store,Gi.store,Wi.store,$i.store,Ki.store,ji.store,Qi.store,Zi.store],[to.store]),[Yi.store]),[Ji.store]),ro=function(){function e(){this.la=new zi}return e.prototype.Mo=function(e,t){var n=this;if(!this.la.has(t)){var r=t._(),i=t.h();e.pr((function(){n.la.add(t)}));var o={collectionId:r,parent:di(i)};return io(e).put(o)}return yr.resolve()},e.prototype.Qr=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[Q(t),""],!1,!0);return io(e).ts(r).next((function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(mi(o.parent))}return n}))},e}();function io(e){return fo.Qn(e,Ji.store)}var oo=function(){function e(e){this._a=e}return e.prototype.next=function(){return this._a+=2,this._a},e.fa=function(){return new e(0)},e.da=function(){return new e(-1)},e}(),ao=function(){function e(e,t){this.No=e,this.serializer=t}return e.prototype.wa=function(e){var t=this;return this.ma(e).next((function(n){var r=new oo(n.highestTargetId);return n.highestTargetId=r.next(),t.Ta(e,n).next((function(){return n.highestTargetId}))}))},e.prototype.Ea=function(e){return this.ma(e).next((function(e){return le.J(new se(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))},e.prototype.Ia=function(e){return this.ma(e).next((function(e){return e.highestListenSequenceNumber}))},e.prototype.Aa=function(e,t,n){var r=this;return this.ma(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.Z()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Ta(e,i)}))},e.prototype.Ra=function(e,t){var n=this;return this.ga(e,t).next((function(){return n.ma(e).next((function(r){return r.targetCount+=1,n.Pa(t,r),n.Ta(e,r)}))}))},e.prototype.ya=function(e,t){return this.ga(e,t)},e.prototype.Va=function(e,t){var n=this;return this.pa(e,t.targetId).next((function(){return so(e).delete(t.targetId)})).next((function(){return n.ma(e)})).next((function(t){return b(t.targetCount>0),t.targetCount-=1,n.Ta(e,t)}))},e.prototype.po=function(e,t,n){var r=this,i=0,o=[];return so(e).rs((function(a,s){var l=Ei(s);l.sequenceNumber<=t&&null===n.get(l.targetId)&&(i++,o.push(r.Va(e,l)))})).next((function(){return yr.$n(o)})).next((function(){return i}))},e.prototype.Ce=function(e,t){return so(e).rs((function(e,n){var r=Ei(n);t(r)}))},e.prototype.ma=function(e){return lo(e).get(Qi.key).next((function(e){return b(null!==e),e}))},e.prototype.Ta=function(e,t){return lo(e).put(Qi.key,t)},e.prototype.ga=function(e,t){return so(e).put(Ai(this.serializer,t))},e.prototype.Pa=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.ba=function(e){return this.ma(e).next((function(e){return e.targetCount}))},e.prototype.va=function(e,t){var n=pe(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return so(e).rs({range:r,index:Ki.queryTargetsIndexName},(function(e,n,r){var o=Ei(n);me(t,o.target)&&(i=o,r.done())})).next((function(){return i}))},e.prototype.Sa=function(e,t,n){var r=this,i=[],o=co(e);return t.forEach((function(t){var a=di(t.path);i.push(o.put(new Zi(n,a))),i.push(r.No.Da(e,n,t))})),yr.$n(i)},e.prototype.Ca=function(e,t,n){var r=this,i=co(e);return yr.forEach(t,(function(t){var o=di(t.path);return yr.$n([i.delete([n,o]),r.No.Na(e,n,t)])}))},e.prototype.pa=function(e,t){var n=co(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.Fa=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=co(e),i=Oe();return r.rs({range:n,ss:!0},(function(e,t,n){var r=mi(e[1]),o=new C(r);i=i.add(o)})).next((function(){return i}))},e.prototype.Ho=function(e,t){var n=di(t.path),r=IDBKeyRange.bound([n],[Q(n)],!1,!0),i=0;return co(e).rs({index:Zi.documentTargetsIndex,ss:!0,range:r},(function(e,t,n){var r=e[0];e[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},e.prototype.Ue=function(e,t){return so(e).get(t).next((function(e){return e?Ei(e):null}))},e}();function so(e){return fo.Qn(e,Ki.store)}function lo(e){return fo.Qn(e,Qi.store)}function co(e){return fo.Qn(e,Zi.store)}var uo="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ho=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).jo=t,r.xa=n,r}return r.__extends(t,e),t}(ri),fo=function(){function e(t,n,r,i,o,a,s,l,c,d){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.fn=o,this.window=a,this.document=s,this.$a=c,this.ka=d,this.Ma=null,this.Oa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Qa=function(e){return Promise.resolve()},!e.Ln())throw new h(u.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new go(this,i),this.Wa=n+"main",this.serializer=new gi(l),this.ja=new br(this.Wa,10,new Bi(this.serializer)),this.Ka=new ao(this.No,this.serializer),this.Dr=new ro,this.vr=function(e,t){return new Li(e,t)}(this.serializer,this.Dr),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===d&&m("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.Qn=function(e,t){if(e instanceof ho)return br.Qn(e.jo,t);throw y()},e.prototype.start=function(){var e=this;return this.za().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new h(u.FAILED_PRECONDITION,uo);return e.Ha(),e.Ya(),e.Ja(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.Ka.Ia(t)}))})).then((function(t){e.Ma=new jr(t,e.$a)})).then((function(){e.Oa=!0})).catch((function(t){return e.ja&&e.ja.close(),Promise.reject(t)}))},e.prototype.Xa=function(e){var t=this;return this.Qa=function(n){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){return this.Ei?[2,e(n)]:[2]}))}))},e(this.isPrimary)},e.prototype.Za=function(e){var t=this;this.ja.Kn((function(n){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return null===n.newVersion?[4,e()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},e.prototype.tc=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.fn.ws((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.Ei?[4,this.za()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})))},e.prototype.za=function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return mo(t).put(new to(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next((function(){if(e.isPrimary)return e.ec(t).next((function(t){t||(e.isPrimary=!1,e.fn.Cs((function(){return e.Qa(!1)})))}))})).next((function(){return e.nc(t)})).next((function(n){return e.isPrimary&&!n?e.sc(t).next((function(){return!1})):!!n&&e.ic(t).next((function(){return!0}))}))})).catch((function(t){if(xr(t))return p("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return p("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.fn.Cs((function(){return e.Qa(t)})),e.isPrimary=t}))},e.prototype.ec=function(e){var t=this;return po(e).get(ji.key).next((function(e){return yr.resolve(t.rc(e))}))},e.prototype.oc=function(e){return mo(e).delete(this.clientId)},e.prototype.ac=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o,a=this;return r.__generator(this,(function(r){switch(r.label){case 0:return!this.isPrimary||this.cc(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var n=e.Qn(t,to.store);return n.ts().next((function(e){var t=a.uc(e,18e5),r=e.filter((function(e){return-1===t.indexOf(e)}));return yr.forEach(r,(function(e){return n.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=r.sent(),this.Ga)for(n=0,i=t;n<i.length;n++)o=i[n],this.Ga.removeItem(this.hc(o.clientId));r.label=2;case 2:return[2]}}))}))},e.prototype.Ja=function(){var e=this;this.qa=this.fn.yn("client_metadata_refresh",4e3,(function(){return e.za().then((function(){return e.ac()})).then((function(){return e.Ja()}))}))},e.prototype.rc=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.nc=function(e){var t=this;return this.ka?yr.resolve(!0):po(e).get(ji.key).next((function(n){if(null!==n&&t.cc(n.leaseTimestampMs,5e3)&&!t.lc(n.ownerId)){if(t.rc(n)&&t.networkEnabled)return!0;if(!t.rc(n)){if(!n.allowTabSynchronization)throw new h(u.FAILED_PRECONDITION,uo);return!1}}return!(!t.networkEnabled||!t.inForeground)||mo(e).ts().next((function(e){return void 0===t.uc(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&p("IndexedDbPersistence","Client "+(e?"is":"is not")+" eligible for a primary lease."),e}))},e.prototype.Di=function(){return r.__awaiter(this,void 0,void 0,(function(){var e=this;return r.__generator(this,(function(t){switch(t.label){case 0:return this.Oa=!1,this._c(),this.qa&&(this.qa.cancel(),this.qa=null),this.fc(),this.dc(),[4,this.ja.runTransaction("shutdown","readwrite",[ji.store,to.store],(function(t){var n=new ho(t,jr.ai);return e.sc(n).next((function(){return e.oc(n)}))}))];case 1:return t.sent(),this.ja.close(),this.wc(),[2]}}))}))},e.prototype.uc=function(e,t){var n=this;return e.filter((function(e){return n.cc(e.updateTimeMs,t)&&!n.lc(e.clientId)}))},e.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return mo(t).ts().next((function(t){return e.uc(t,18e5).map((function(e){return e.clientId}))}))}))},Object.defineProperty(e.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),e.prototype.mc=function(e){return Mi.xo(e,this.serializer,this.Dr,this.No)},e.prototype.Tc=function(){return this.Ka},e.prototype.Ec=function(){return this.vr},e.prototype.Ic=function(){return this.Dr},e.prototype.runTransaction=function(e,t,n){var r=this;p("IndexedDbPersistence","Starting transaction:",e);var i,o="readonly"===t?"readonly":"readwrite";return this.ja.runTransaction(e,o,no,(function(o){return i=new ho(o,r.Ma?r.Ma.next():jr.ai),"readwrite-primary"===t?r.ec(i).next((function(e){return!!e||r.nc(i)})).next((function(t){if(!t)throw m("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.fn.Cs((function(){return r.Qa(!1)})),new h(u.FAILED_PRECONDITION,ni);return n(i)})).next((function(e){return r.ic(i).next((function(){return e}))})):r.Ac(i).next((function(){return n(i)}))})).then((function(e){return i.br(),e}))},e.prototype.Ac=function(e){var t=this;return po(e).get(ji.key).next((function(e){if(null!==e&&t.cc(e.leaseTimestampMs,5e3)&&!t.lc(e.ownerId)&&!t.rc(e)&&!(t.ka||t.allowTabSynchronization&&e.allowTabSynchronization))throw new h(u.FAILED_PRECONDITION,uo)}))},e.prototype.ic=function(e){var t=new ji(this.clientId,this.allowTabSynchronization,Date.now());return po(e).put(ji.key,t)},e.Ln=function(){return br.Ln()},e.prototype.sc=function(e){var t=this,n=po(e);return n.get(ji.key).next((function(e){return t.rc(e)?(p("IndexedDbPersistence","Releasing primary lease."),n.delete(ji.key)):yr.resolve()}))},e.prototype.cc=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(m("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.Ha=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){e.fn.ws((function(){return e.inForeground="visible"===e.document.visibilityState,e.za()}))},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},e.prototype.fc=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},e.prototype.Ya=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.La=function(){t._c(),t.fn.ws((function(){return t.Di()}))},this.window.addEventListener("unload",this.La))},e.prototype.dc=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},e.prototype.lc=function(e){var t;try{var n=null!==(null===(t=this.Ga)||void 0===t?void 0:t.getItem(this.hc(e)));return p("IndexedDbPersistence","Client '"+e+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(e){return m("IndexedDbPersistence","Failed to get zombied client id.",e),!1}},e.prototype._c=function(){if(this.Ga)try{this.Ga.setItem(this.hc(this.clientId),String(Date.now()))}catch(e){m("Failed to set zombie client id.",e)}},e.prototype.wc=function(){if(this.Ga)try{this.Ga.removeItem(this.hc(this.clientId))}catch(e){}},e.prototype.hc=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e}();function po(e){return fo.Qn(e,ji.store)}function mo(e){return fo.Qn(e,to.store)}var go=function(){function e(e,t){this.db=e,this.wo=new hi(this,t)}return e.prototype.Po=function(e){var t=this.Rc(e);return this.db.Tc().ba(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.Rc=function(e){var t=0;return this.Vo(e,(function(e){t++})).next((function(){return t}))},e.prototype.Ce=function(e,t){return this.db.Tc().Ce(e,t)},e.prototype.Vo=function(e,t){return this.gc(e,(function(e,n){return t(n)}))},e.prototype.Da=function(e,t,n){return vo(e,n)},e.prototype.Na=function(e,t,n){return vo(e,n)},e.prototype.po=function(e,t,n){return this.db.Tc().po(e,t,n)},e.prototype.Go=function(e,t){return vo(e,t)},e.prototype.Pc=function(e,t){return function(e,t){var n=!1;return Pi(e).os((function(r){return Ti(e,r,t).next((function(e){return e&&(n=!0),yr.resolve(!e)}))})).next((function(){return n}))}(e,t)},e.prototype.bo=function(e,t){var n=this,r=this.db.Ec().ra(),i=[],o=0;return this.gc(e,(function(a,s){if(s<=t){var l=n.Pc(e,a).next((function(t){if(!t)return o++,r.Rr(e,a).next((function(){return r.Ar(a),co(e).delete([0,di(a.path)])}))}));i.push(l)}})).next((function(){return yr.$n(i)})).next((function(){return r.apply(e)})).next((function(){return o}))},e.prototype.removeTarget=function(e,t){var n=t.st(e.xa);return this.db.Tc().ya(e,n)},e.prototype.yc=function(e,t){return vo(e,t)},e.prototype.gc=function(e,t){var n,r=co(e),i=jr.ai;return r.rs({index:Zi.documentTargetsIndex},(function(e,r){var o=e[0],a=(e[1],r.path),s=r.sequenceNumber;0===o?(i!==jr.ai&&t(new C(mi(n)),i),i=s,n=a):i=jr.ai})).next((function(){i!==jr.ai&&t(new C(mi(n)),i)}))},e.prototype.So=function(e){return this.db.Ec().aa(e)},e}();function vo(e,t){return co(e).put(function(e,t){return new Zi(0,di(e.path),t)}(t,e.xa))}function yo(e,t){var n=e.projectId;return e.j||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var bo=function(){function e(e,t,n){this.persistence=e,this.Vc=t,this.bc=new Se(K),this.vc=new ae((function(e){return pe(e)}),me),this.Sc=le.min(),this.Sr=e.mc(n),this.Dc=e.Ec(),this.Ka=e.Tc(),this.Cc=new ii(this.Dc,this.Sr,this.persistence.Ic()),this.Vc.Nc(this.Cc)}return e.prototype.Io=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.vo(n,t.bc)}))},e}();function _o(e,t){var n=_(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Dc.ra({oa:!0});return function(e,t,n,r){var i=n.batch,o=i.keys(),a=yr.resolve();return o.forEach((function(e){a=a.next((function(){return r.Rr(t,e)})).next((function(t){var o=t,a=n.dr.get(e);b(null!==a),(!o||o.version.L(a)<0)&&(o=i.cr(e,o,n))&&r.Er(o,n._r)}))})),a.next((function(){return e.Sr.Wo(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.Sr.zo(e)})).next((function(){return n.Cc.kr(e,r)}))}))}function wo(e){var t=_(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Ka.Ea(e)}))}function xo(e,t){var n=_(e),r=t.nt,i=n.bc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var o=n.Dc.ra({oa:!0});i=n.bc;var a=[];t.zt.forEach((function(t,o){var s=i.get(o);if(s){a.push(n.Ka.Ca(e,t.se,o).next((function(){return n.Ka.Sa(e,t.ee,o)})));var l=t.resumeToken;if(l.O()>0){var c=s.it(l,r).st(e.xa);i=i.ot(o,c),function(e,t,n){return b(t.resumeToken.O()>0),0===e.resumeToken.O()||t.nt.X()-e.nt.X()>=3e8||n.ee.size+n.ne.size+n.se.size>0}(s,c,t)&&a.push(n.Ka.ya(e,c))}}}));var s=Ie(),l=Oe();if(t.Yt.forEach((function(e,t){l=l.add(e)})),a.push(o.getEntries(e,l).next((function(i){t.Yt.forEach((function(l,c){var u=i.get(l);c instanceof Dn&&c.version.isEqual(le.min())?(o.Ar(l,r),s=s.ot(l,c)):null==u||c.version.L(u.version)>0||0===c.version.L(u.version)&&u.hasPendingWrites?(o.Er(c,r),s=s.ot(l,c)):p("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version),t.Jt.has(l)&&a.push(n.persistence.No.yc(e,l))}))}))),!r.isEqual(le.min())){var c=n.Ka.Ea(e).next((function(t){return n.Ka.Aa(e,e.xa,r)}));a.push(c)}return yr.$n(a).next((function(){return o.apply(e)})).next((function(){return n.Cc.Mr(e,s)}))})).then((function(e){return n.bc=i,e}))}function So(e,t){var n=_(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.Sr.Bo(e,t)}))}function Eo(e,t){var n=_(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Ka.va(e,t).next((function(i){return i?(r=i,yr.resolve(r)):n.Ka.wa(e).next((function(i){return r=new be(t,i,0,e.xa),n.Ka.Ra(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.bc.get(e.targetId);return(null===r||e.nt.L(r.nt)>0)&&(n.bc=n.bc.ot(e.targetId,e),n.vc.set(t,e.targetId)),e}))}function Ao(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a,s;return r.__generator(this,(function(r){switch(r.label){case 0:i=_(e),o=i.bc.get(t),a=n?"readwrite":"readwrite-primary",r.label=1;case 1:return r.trys.push([1,4,,5]),n?[3,3]:[4,i.persistence.runTransaction("Release target",a,(function(e){return i.persistence.No.removeTarget(e,o)}))];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:if(!xr(s=r.sent()))throw s;return p("LocalStore","Failed to update sequence numbers for target "+t+": "+s),[3,5];case 5:return i.bc=i.bc.remove(t),i.vc.delete(o.target),[2]}}))}))}function Mo(e,t,n){var r=_(e),i=le.min(),o=Oe();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=_(e),i=r.vc.get(n);return void 0!==i?yr.resolve(r.bc.get(i)):r.Ka.va(t,n)}(r,e,Wn(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ka.Fa(e,t.targetId).next((function(e){o=e}))})).next((function(){return r.Vc.Lr(e,t,n?i:le.min(),n?o:Oe())})).next((function(e){return{documents:e,Fc:o}}))}))}function To(e,t){var n=_(e),r=_(n.Ka),i=n.bc.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.Ue(e,t).next((function(e){return e?e.target:null}))}))}function Co(e){var t=_(e);return t.persistence.runTransaction("Get new document changes","readonly",(function(e){return function(e,t,n){var r=_(e),i=Ie(),o=bi(n),a=Oi(t),s=IDBKeyRange.lowerBound(o,!0);return a.rs({index:$i.readTimeIndex,range:s},(function(e,t){var n=vi(r.serializer,t);i=i.ot(n.key,n),o=t.readTime})).next((function(){return{xc:i,readTime:_i(o)}}))}(t.Dc,e,t.Sc)})).then((function(e){var n=e.xc,r=e.readTime;return t.Sc=r,n}))}function Io(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){return[2,(t=_(e)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(e){return function(e){var t=Oi(e),n=le.min();return t.rs({index:$i.readTimeIndex,reverse:!0},(function(e,t,r){t.readTime&&(n=_i(t.readTime)),r.done()})).next((function(){return n}))}(e)})).then((function(e){t.Sc=e}))]}))}))}function Ro(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){if(e.code!==u.FAILED_PRECONDITION||e.message!==ni)throw e;return p("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}var Po=function(){function e(){this.$c=new Me(Lo.kc),this.Mc=new Me(Lo.Oc)}return e.prototype.m=function(){return this.$c.m()},e.prototype.Da=function(e,t){var n=new Lo(e,t);this.$c=this.$c.add(n),this.Mc=this.Mc.add(n)},e.prototype.Lc=function(e,t){var n=this;e.forEach((function(e){return n.Da(e,t)}))},e.prototype.Na=function(e,t){this.Bc(new Lo(e,t))},e.prototype.qc=function(e,t){var n=this;e.forEach((function(e){return n.Na(e,t)}))},e.prototype.Uc=function(e){var t=this,n=new C(new A([])),r=new Lo(n,e),i=new Lo(n,e+1),o=[];return this.Mc.Ft([r,i],(function(e){t.Bc(e),o.push(e.key)})),o},e.prototype.Qc=function(){var e=this;this.$c.forEach((function(t){return e.Bc(t)}))},e.prototype.Bc=function(e){this.$c=this.$c.delete(e),this.Mc=this.Mc.delete(e)},e.prototype.Wc=function(e){var t=new C(new A([])),n=new Lo(t,e),r=new Lo(t,e+1),i=Oe();return this.Mc.Ft([n,r],(function(e){i=i.add(e.key)})),i},e.prototype.Ho=function(e){var t=new Lo(e,0),n=this.$c.$t(t);return null!==n&&e.isEqual(n.key)},e}(),Lo=function(){function e(e,t){this.key=e,this.jc=t}return e.kc=function(e,t){return C.i(e.key,t.key)||K(e.jc,t.jc)},e.Oc=function(e,t){return K(e.jc,t.jc)||C.i(e.key,t.key)},e}(),ko=function(e,t){this.user=t,this.type="OAuth",this.Kc={},this.Kc.Authorization="Bearer "+e},Do=function(){function e(){this.Gc=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.zc=function(){},e.prototype.Hc=function(e){this.Gc=e,e(Vr.UNAUTHENTICATED)},e.prototype.Yc=function(){this.Gc=null},e}(),Oo=function(){function e(e){var t=this;this.Jc=null,this.currentUser=Vr.UNAUTHENTICATED,this.Xc=!1,this.Zc=0,this.Gc=null,this.forceRefresh=!1,this.Jc=function(){t.Zc++,t.currentUser=t.tu(),t.Xc=!0,t.Gc&&t.Gc(t.currentUser)},this.Zc=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Jc):(this.Jc(null),e.get().then((function(e){t.auth=e,t.Jc&&t.auth.addAuthTokenListener(t.Jc)}),(function(){})))}return e.prototype.getToken=function(){var e=this,t=this.Zc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.Zc!==t?(p("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(b("string"==typeof n.accessToken),new ko(n.accessToken,e.currentUser)):null})):Promise.resolve(null)},e.prototype.zc=function(){this.forceRefresh=!0},e.prototype.Hc=function(e){this.Gc=e,this.Xc&&e(this.currentUser)},e.prototype.Yc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Jc),this.Jc=null,this.Gc=null},e.prototype.tu=function(){var e=this.auth&&this.auth.getUid();return b(null===e||"string"==typeof e),new Vr(e)},e}(),No=function(){function e(e,t){this.eu=e,this.nu=t,this.type="FirstParty",this.user=Vr.ni}return Object.defineProperty(e.prototype,"Kc",{get:function(){var e={"X-Goog-AuthUser":this.nu},t=this.eu.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),e},enumerable:!1,configurable:!0}),e}(),Uo=function(){function e(e,t){this.eu=e,this.nu=t}return e.prototype.getToken=function(){return Promise.resolve(new No(this.eu,this.nu))},e.prototype.Hc=function(e){e(Vr.ni)},e.prototype.Yc=function(){},e.prototype.zc=function(){},e}(),Fo=function(){function e(e,t,n,r,i,o){this.fn=e,this.su=n,this.iu=r,this.ru=i,this.listener=o,this.state=0,this.ou=0,this.au=null,this.stream=null,this.ys=new vr(e,t)}return e.prototype.cu=function(){return 1===this.state||2===this.state||4===this.state},e.prototype.uu=function(){return 2===this.state},e.prototype.start=function(){3!==this.state?this.auth():this.hu()},e.prototype.stop=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.cu()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.lu=function(){this.state=0,this.ys.reset()},e.prototype._u=function(){var e=this;this.uu()&&null===this.au&&(this.au=this.fn.yn(this.su,6e4,(function(){return e.fu()})))},e.prototype.du=function(e){this.wu(),this.stream.send(e)},e.prototype.fu=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.uu()?[2,this.close(0)]:[2]}))}))},e.prototype.wu=function(){this.au&&(this.au.cancel(),this.au=null)},e.prototype.close=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return this.wu(),this.ys.cancel(),this.ou++,3!==e?this.ys.reset():t&&t.code===u.RESOURCE_EXHAUSTED?(m(t.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.ys.Rn()):t&&t.code===u.UNAUTHENTICATED&&this.ru.zc(),null!==this.stream&&(this.mu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.mu=function(){},e.prototype.auth=function(){var e=this;this.state=1;var t=this.Eu(this.ou),n=this.ou;this.ru.getToken().then((function(t){e.ou===n&&e.Iu(t)}),(function(n){t((function(){var t=new h(u.UNKNOWN,"Fetching auth token failed: "+n.message);return e.Au(t)}))}))},e.prototype.Iu=function(e){var t=this,n=this.Eu(this.ou);this.stream=this.Ru(e),this.stream.gu((function(){n((function(){return t.state=2,t.listener.gu()}))})),this.stream.Tu((function(e){n((function(){return t.Au(e)}))})),this.stream.onMessage((function(e){n((function(){return t.onMessage(e)}))}))},e.prototype.hu=function(){var e=this;this.state=4,this.ys.gn((function(){return r.__awaiter(e,void 0,void 0,(function(){return r.__generator(this,(function(e){return this.state=0,this.start(),[2]}))}))}))},e.prototype.Au=function(e){return p("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)},e.prototype.Eu=function(e){var t=this;return function(n){t.fn.ws((function(){return t.ou===e?n():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},e}(),zo=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,a}return r.__extends(t,e),t.prototype.Ru=function(e){return this.iu.Pu("Listen",e)},t.prototype.onMessage=function(e){this.ys.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:y()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.Qe?(b(void 0===t||"string"==typeof t),J.fromBase64String(t||"")):(b(void 0===t||t instanceof Uint8Array),J.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,s=a&&function(e){var t=void 0===e.code?u.UNKNOWN:xe(e.code);return new h(t,e.message||"")}(a);n=new We(r,i,o,s||null)}else if("documentChange"in t){t.documentChange;var l=t.documentChange;l.document,l.document.name,l.document.updateTime;var c=It(e,l.document.name),d=At(l.document.updateTime),f=new In({mapValue:{fields:l.document.fields}}),p=new kn(c,d,f,{}),m=l.targetIds||[],g=l.removedTargetIds||[];n=new He(m,g,p.key,p)}else if("documentDelete"in t){t.documentDelete;var v=t.documentDelete;v.document;var _=It(e,v.document),w=v.readTime?At(v.readTime):le.min(),x=new Dn(_,w),S=v.removedTargetIds||[];n=new He([],S,x.key,x)}else if("documentRemove"in t){t.documentRemove;var E=t.documentRemove;E.document;var A=It(e,E.document),M=E.removedTargetIds||[];n=new He([],M,A,null)}else{if(!("filter"in t))return y();t.filter;var T=t.filter;T.targetId;var C=T.count||0,I=new _e(C),R=T.targetId;n=new Ge(R,I)}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return le.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?le.min():t.readTime?At(t.readTime):le.min()}(e);return this.listener.yu(t,n)},t.prototype.Vu=function(e){var t={};t.database=Lt(this.serializer),t.addTarget=function(e,t){var n,r=t.target;return(n=ge(r)?{documents:Ut(e,r)}:{query:Ft(e,r)}).targetId=t.targetId,t.resumeToken.O()>0&&(n.resumeToken=St(e,t.resumeToken)),n}(this.serializer,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return y()}}(0,t.et);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.du(t)},t.prototype.pu=function(e){var t={};t.database=Lt(this.serializer),t.removeTarget=e,this.du(t)},t}(Fo),Bo=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,a.bu=!1,a}return r.__extends(t,e),Object.defineProperty(t.prototype,"vu",{get:function(){return this.bu},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.bu=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.mu=function(){this.bu&&this.Su([])},t.prototype.Ru=function(e){return this.iu.Pu("Write",e)},t.prototype.onMessage=function(e){if(b(!!e.streamToken),this.lastStreamToken=e.streamToken,this.bu){this.ys.reset();var t=function(e,t){return e&&e.length>0?(b(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?At(e.updateTime):At(t);n.isEqual(le.min())&&(n=At(t));var r=null;return e.transformResults&&e.transformResults.length>0&&(r=e.transformResults),new dn(n,r)}(e,t)}))):[]}(e.writeResults,e.commitTime),n=At(e.commitTime);return this.listener.Du(n,t)}return b(!e.writeResults||0===e.writeResults.length),this.bu=!0,this.listener.Cu()},t.prototype.Nu=function(){var e={};e.database=Lt(this.serializer),this.du(e)},t.prototype.Su=function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Ot(t.serializer,e)}))};this.du(n)},t}(Fo),Vo=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).credentials=t,i.iu=n,i.serializer=r,i.Fu=!1,i}return r.__extends(t,e),t.prototype.xu=function(){if(this.Fu)throw new h(u.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.$u=function(e,t,n){var r=this;return this.xu(),this.credentials.getToken().then((function(i){return r.iu.$u(e,t,n,i)})).catch((function(e){throw e.code===u.UNAUTHENTICATED&&r.credentials.zc(),e}))},t.prototype.ku=function(e,t,n){var r=this;return this.xu(),this.credentials.getToken().then((function(i){return r.iu.ku(e,t,n,i)})).catch((function(e){throw e.code===u.UNAUTHENTICATED&&r.credentials.zc(),e}))},t.prototype.terminate=function(){this.Fu=!1},t}((function(){})),jo=function(){function e(e,t){this.cs=e,this.di=t,this.state="Unknown",this.Mu=0,this.Ou=null,this.Lu=!0}return e.prototype.Bu=function(){var e=this;0===this.Mu&&(this.qu("Unknown"),this.Ou=this.cs.yn("online_state_timeout",1e4,(function(){return e.Ou=null,e.Uu("Backend didn't respond within 10 seconds."),e.qu("Offline"),Promise.resolve()})))},e.prototype.Qu=function(e){"Online"===this.state?this.qu("Unknown"):(this.Mu++,this.Mu>=1&&(this.Wu(),this.Uu("Connection failed 1 times. Most recent error: "+e.toString()),this.qu("Offline")))},e.prototype.set=function(e){this.Wu(),this.Mu=0,"Online"===e&&(this.Lu=!1),this.qu(e)},e.prototype.qu=function(e){e!==this.state&&(this.state=e,this.di(e))},e.prototype.Uu=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Lu?(m(t),this.Lu=!1):p("OnlineStateTracker",t)},e.prototype.Wu=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},e}(),Ho=function(e,t,n,i,o){var a=this;this.ju=e,this.Ku=t,this.cs=n,this.Gu={},this.zu=[],this.Hu=new Map,this.Yu=new Set,this.Ju=[],this.Xu=o,this.Xu.Zu((function(e){n.ws((function(){return r.__awaiter(a,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return Jo(this)?(p("RemoteStore","Restarting streams for network reachability change."),[4,function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return(t=_(e)).Yu.add(4),[4,Wo(t)];case 1:return n.sent(),t.th.set("Unknown"),t.Yu.delete(4),[4,Go(t)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.th=new jo(n,i)};function Go(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:if(!Jo(e))return[3,4];t=0,n=e.Ju,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))}function Wo(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(r){switch(r.label){case 0:t=0,n=e.Ju,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))}function qo(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return t=_(e),p("RemoteStore","RemoteStore shutting down."),t.Yu.add(5),[4,Wo(t)];case 1:return n.sent(),t.Xu.Di(),t.th.set("Unknown"),[2]}}))}))}function Xo(e,t){var n=_(e);n.Hu.has(t.targetId)||(n.Hu.set(t.targetId,t),Qo(n)?Zo(n):pa(n).uu()&&Yo(n,t))}function $o(e,t){var n=_(e),r=pa(n);n.Hu.delete(t),r.uu()&&Ko(n,t),0===n.Hu.size&&(r.uu()?r._u():Jo(n)&&n.th.set("Unknown"))}function Yo(e,t){e.eh.Ie(t.targetId),pa(e).Vu(t)}function Ko(e,t){e.eh.Ie(t),pa(e).pu(t)}function Zo(e){e.eh=new Xe({qe:function(t){return e.Gu.qe(t)},Ue:function(t){return e.Hu.get(t)||null}}),pa(e).start(),e.th.Bu()}function Qo(e){return Jo(e)&&!pa(e).cu()&&e.Hu.size>0}function Jo(e){return 0===_(e).Yu.size}function ea(e){e.eh=void 0}function ta(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return e.Hu.forEach((function(t,n){Yo(e,t)})),[2]}))}))}function na(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){return ea(e),Qo(e)?(e.th.Qu(t),Zo(e)):e.th.set("Unknown"),[2]}))}))}function ra(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a;return r.__generator(this,(function(s){switch(s.label){case 0:if(e.th.set("Online"),!(t instanceof We&&2===t.state&&t.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a;return r.__generator(this,(function(r){switch(r.label){case 0:n=t.cause,i=0,o=t.targetIds,r.label=1;case 1:return i<o.length?(a=o[i],e.Hu.has(a)?[4,e.Gu.nh(a,n)]:[3,3]):[3,5];case 2:r.sent(),e.Hu.delete(a),e.eh.removeTarget(a),r.label=3;case 3:r.label=4;case 4:return i++,[3,1];case 5:return[2]}}))}))}(e,t)];case 2:return s.sent(),[3,5];case 3:return i=s.sent(),p("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),[4,ia(e,i)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof He?e.eh.be(t):t instanceof Ge?e.eh.$e(t):e.eh.De(t),n.isEqual(le.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,wo(e.ju)];case 8:return o=s.sent(),n.L(o)>=0?[4,function(e,t){var n=e.eh.Oe(t);return n.zt.forEach((function(n,r){if(n.resumeToken.O()>0){var i=e.Hu.get(r);i&&e.Hu.set(r,i.it(n.resumeToken,t))}})),n.Ht.forEach((function(t){var n=e.Hu.get(t);if(n){e.Hu.set(t,n.it(J.B,n.nt)),Ko(e,t);var r=new be(n.target,t,1,n.sequenceNumber);Yo(e,r)}})),e.Gu.sh(n)}(e,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return p("RemoteStore","Failed to raise snapshot:",a=s.sent()),[4,ia(e,a)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function ia(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i=this;return r.__generator(this,(function(o){switch(o.label){case 0:if(!xr(t))throw t;return e.Yu.add(1),[4,Wo(e)];case 1:return o.sent(),e.th.set("Offline"),n||(n=function(){return wo(e.ju)}),e.cs.Cs((function(){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return p("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return t.sent(),e.Yu.delete(1),[4,Go(e)];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))}function oa(e,t){return t().catch((function(n){return ia(e,n,t)}))}function aa(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o,a;return r.__generator(this,(function(r){switch(r.label){case 0:t=_(e),n=ma(t),i=t.zu.length>0?t.zu[t.zu.length-1].batchId:-1,r.label=1;case 1:if(!function(e){return Jo(e)&&e.zu.length<10}(t))return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,So(t.ju,i)];case 3:return null===(o=r.sent())?(0===t.zu.length&&n._u(),[3,7]):(i=o.batchId,function(e,t){e.zu.push(t);var n=ma(e);n.uu()&&n.vu&&n.Su(t.mutations)}(t,o),[3,6]);case 4:return a=r.sent(),[4,ia(t,a)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return sa(t)&&la(t),[2]}}))}))}function sa(e){return Jo(e)&&!ma(e).cu()&&e.zu.length>0}function la(e){ma(e).start()}function ca(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){return ma(e).Nu(),[2]}))}))}function ua(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n,i,o;return r.__generator(this,(function(r){for(t=ma(e),n=0,i=e.zu;n<i.length;n++)o=i[n],t.Su(o.mutations);return[2]}))}))}function ha(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return i=e.zu.shift(),o=ei.from(i,t,n),[4,oa(e,(function(){return e.Gu.ih(o)}))];case 1:return r.sent(),[4,aa(e)];case 2:return r.sent(),[2]}}))}))}function da(e,t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return t&&ma(e).vu?[4,function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return we(i=t.code)&&i!==u.ABORTED?(n=e.zu.shift(),ma(e).lu(),[4,oa(e,(function(){return e.Gu.rh(n.batchId,t)}))]):[3,3];case 1:return r.sent(),[4,aa(e)];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return sa(e)&&la(e),[2]}}))}))}function fa(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n;return r.__generator(this,(function(r){switch(r.label){case 0:return n=_(e),t?(n.Yu.delete(2),[4,Go(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Yu.add(2),[4,Wo(n)]);case 3:r.sent(),n.th.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function pa(e){var t=this;return e.oh||(e.oh=function(e,t,n){var r=_(e);return r.xu(),new zo(t,r.iu,r.credentials,r.serializer,n)}(e.Ku,e.cs,{gu:ta.bind(null,e),Tu:na.bind(null,e),yu:ra.bind(null,e)}),e.Ju.push((function(n){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return n?(e.oh.lu(),Qo(e)?Zo(e):e.th.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.oh.stop()];case 2:t.sent(),ea(e),t.label=3;case 3:return[2]}}))}))}))),e.oh}function ma(e){var t=this;return e.ah||(e.ah=function(e,t,n){var r=_(e);return r.xu(),new Bo(t,r.iu,r.credentials,r.serializer,n)}(e.Ku,e.cs,{gu:ca.bind(null,e),Tu:da.bind(null,e),Cu:ua.bind(null,e),Du:ha.bind(null,e)}),e.Ju.push((function(n){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return n?(e.ah.lu(),[4,aa(e)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,e.ah.stop()];case 3:t.sent(),e.zu.length>0&&(p("RemoteStore","Stopping write stream with "+e.zu.length+" pending writes"),e.zu=[]),t.label=4;case 4:return[2]}}))}))}))),e.ah}var ga=function(e){this.key=e},va=function(e){this.key=e},ya=function(){function e(e,t){this.query=e,this.uh=t,this.hh=null,this.te=!1,this.lh=Oe(),this.Wt=Oe(),this._h=Jn(e),this.fh=new Fe(this._h)}return Object.defineProperty(e.prototype,"dh",{get:function(){return this.uh},enumerable:!1,configurable:!0}),e.prototype.wh=function(e,t){var n=this,r=t?t.mh:new ze,i=t?t.fh:this.fh,o=t?t.Wt:this.Wt,a=i,s=!1,l=zn(this.query)&&i.size===this.query.limit?i.last():null,c=Bn(this.query)&&i.size===this.query.limit?i.first():null;if(e.ht((function(e,t){var u=i.get(e),h=t instanceof kn?t:null;h&&(h=Qn(n.query,h)?h:null);var d=!!u&&n.Wt.has(u.key),f=!!h&&(h.Je||n.Wt.has(h.key)&&h.hasCommittedMutations),p=!1;u&&h?u.data().isEqual(h.data())?d!==f&&(r.track({type:3,doc:h}),p=!0):n.Th(u,h)||(r.track({type:2,doc:h}),p=!0,(l&&n._h(h,l)>0||c&&n._h(h,c)<0)&&(s=!0)):!u&&h?(r.track({type:0,doc:h}),p=!0):u&&!h&&(r.track({type:1,doc:u}),p=!0,(l||c)&&(s=!0)),p&&(h?(a=a.add(h),o=f?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))})),zn(this.query)||Bn(this.query))for(;a.size>this.query.limit;){var u=zn(this.query)?a.last():a.first();a=a.delete(u.key),o=o.delete(u.key),r.track({type:1,doc:u})}return{fh:a,mh:r,Eh:s,Wt:o}},e.prototype.Th=function(e,t){return e.Je&&t.hasCommittedMutations&&!t.Je},e.prototype.yr=function(e,t,n){var r=this,i=this.fh;this.fh=e.fh,this.Wt=e.Wt;var o=e.mh.Ut();o.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(e)-n(t)}(e.type,t.type)||r._h(e.doc,t.doc)})),this.Ih(n);var a=t?this.Ah():[],s=0===this.lh.size&&this.te?1:0,l=s!==this.hh;return this.hh=s,0!==o.length||l?{snapshot:new Be(this.query,e.fh,i,o,e.Wt,0===s,l,!1),Rh:a}:{Rh:a}},e.prototype.Qs=function(e){return this.te&&"Offline"===e?(this.te=!1,this.yr({fh:this.fh,mh:new ze,Wt:this.Wt,Eh:!1},!1)):{Rh:[]}},e.prototype.gh=function(e){return!this.uh.has(e)&&!!this.fh.has(e)&&!this.fh.get(e).Je},e.prototype.Ih=function(e){var t=this;e&&(e.ee.forEach((function(e){return t.uh=t.uh.add(e)})),e.ne.forEach((function(e){})),e.se.forEach((function(e){return t.uh=t.uh.delete(e)})),this.te=e.te)},e.prototype.Ah=function(){var e=this;if(!this.te)return[];var t=this.lh;this.lh=Oe(),this.fh.forEach((function(t){e.gh(t.key)&&(e.lh=e.lh.add(t.key))}));var n=[];return t.forEach((function(t){e.lh.has(t)||n.push(new va(t))})),this.lh.forEach((function(e){t.has(e)||n.push(new ga(e))})),n},e.prototype.Ph=function(e){this.uh=e.Fc,this.lh=Oe();var t=this.wh(e.documents);return this.yr(t,!0)},e.prototype.yh=function(){return Be.Gt(this.query,this.fh,this.Wt,0===this.hh)},e}(),ba=function(e,t,n){this.query=e,this.targetId=t,this.view=n},_a=function(e){this.key=e,this.Vh=!1},wa=function(){function e(e,t,n,r,i,o){this.ju=e,this.ph=t,this.bh=n,this.Sh=r,this.currentUser=i,this.Dh=o,this.Ch={},this.Nh=new ae((function(e){return Kn(e)}),Yn),this.Fh=new Map,this.xh=[],this.$h=new Se(C.i),this.kh=new Map,this.Mh=new Po,this.Oh={},this.Lh=new Map,this.Bh=oo.da(),this.onlineState="Unknown",this.qh=void 0}return Object.defineProperty(e.prototype,"Uh",{get:function(){return!0===this.qh},enumerable:!1,configurable:!0}),e}();function xa(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s,l;return r.__generator(this,(function(r){switch(r.label){case 0:return n=$a(e),(a=n.Nh.get(t))?(i=a.targetId,n.Sh.Oi(i),o=a.view.yh(),[3,4]):[3,1];case 1:return[4,Eo(n.ju,Wn(t))];case 2:return s=r.sent(),l=n.Sh.Oi(s.targetId),i=s.targetId,[4,Sa(n,t,i,"current"===l)];case 3:o=r.sent(),n.Uh&&Xo(n.ph,s),r.label=4;case 4:return[2,o]}}))}))}function Sa(e,t,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,a,s,l,c,u;return r.__generator(this,(function(h){switch(h.label){case 0:return e.Qh=function(t,n,i){return function(e,t,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,a,s;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=t.view.wh(n)).Eh?[4,Mo(e.ju,t.query,!1).then((function(e){var n=e.documents;return t.view.wh(n,o)}))]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return a=i&&i.zt.get(t.targetId),s=t.view.yr(o,e.Uh,a),[2,(Da(e,t.targetId,s.Rh),s.snapshot)]}}))}))}(e,t,n,i)},[4,Mo(e.ju,t,!0)];case 1:return o=h.sent(),a=new ya(t,o.Fc),s=a.wh(o.documents),l=je.Zt(n,i&&"Offline"!==e.onlineState),c=a.yr(s,e.Uh,l),Da(e,n,c.Rh),u=new ba(t,n,a),[2,(e.Nh.set(t,u),e.Fh.has(n)?e.Fh.get(n).push(t):e.Fh.set(n,[t]),c.snapshot)]}}))}))}function Ea(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=_(e),i=n.Nh.get(t),(o=n.Fh.get(i.targetId)).length>1?[2,(n.Fh.set(i.targetId,o.filter((function(e){return!Yn(e,t)}))),void n.Nh.delete(t))]:n.Uh?(n.Sh.Bi(i.targetId),n.Sh.Fi(i.targetId)?[3,2]:[4,Ao(n.ju,i.targetId,!1).then((function(){n.Sh.Ui(i.targetId),$o(n.ph,i.targetId),La(n,i.targetId)})).catch(Ro)]):[3,3];case 1:r.sent(),r.label=2;case 2:return[3,5];case 3:return La(n,i.targetId),[4,Ao(n.ju,i.targetId,!0)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))}function Aa(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:n=_(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,xo(n.ju,t)];case 2:return i=r.sent(),t.zt.forEach((function(e,t){var r=n.kh.get(t);r&&(b(e.ee.size+e.ne.size+e.se.size<=1),e.ee.size>0?r.Vh=!0:e.ne.size>0?b(r.Vh):e.se.size>0&&(b(r.Vh),r.Vh=!1))})),[4,Ua(n,i,t)];case 3:return r.sent(),[3,6];case 4:return[4,Ro(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Ma(e,t,n){var r=_(e);if(r.Uh&&0===n||!r.Uh&&1===n){var i=[];r.Nh.forEach((function(e,n){var r=n.view.Qs(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=_(e);n.onlineState=t;var r=!1;n.Bs.forEach((function(e,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Qs(t)&&(r=!0)})),r&&zr(n)}(r.bh,t),i.length&&r.Ch.yu(i),r.onlineState=t,r.Uh&&r.Sh.Ki(t)}}function Ta(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return(i=_(e)).Sh.Qi(t,"rejected",n),o=i.kh.get(t),(a=o&&o.key)?(s=(s=new Se(C.i)).ot(a,new Dn(a,le.min())),l=Oe().add(a),c=new Ve(le.min(),new Map,new Me(K),s,l),[4,Aa(i,c)]):[3,2];case 1:return r.sent(),i.$h=i.$h.remove(a),i.kh.delete(t),Na(i),[3,4];case 2:return[4,Ao(i.ju,t,!1).then((function(){return La(i,t,n)})).catch(Ro)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}function Ca(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:n=_(e),i=t.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,_o(n.ju,t)];case 2:return o=r.sent(),Pa(n,i,null),Ra(n,i),n.Sh.ki(i,"acknowledged"),[4,Ua(n,o)];case 3:return r.sent(),[3,6];case 4:return[4,Ro(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Ia(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o;return r.__generator(this,(function(r){switch(r.label){case 0:i=_(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,function(e,t){var n=_(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.Sr.Oo(e,t).next((function(t){return b(null!==t),r=t.keys(),n.Sr.Wo(e,t)})).next((function(){return n.Sr.zo(e)})).next((function(){return n.Cc.kr(e,r)}))}))}(i.ju,t)];case 2:return o=r.sent(),Pa(i,t,n),Ra(i,t),i.Sh.ki(t,"rejected",n),[4,Ua(i,o)];case 3:return r.sent(),[3,6];case 4:return[4,Ro(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))}function Ra(e,t){(e.Lh.get(t)||[]).forEach((function(e){e.resolve()})),e.Lh.delete(t)}function Pa(e,t,n){var r=_(e),i=r.Oh[r.currentUser.ti()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.Oh[r.currentUser.ti()]=i}}function La(e,t,n){void 0===n&&(n=null),e.Sh.Bi(t);for(var r=0,i=e.Fh.get(t);r<i.length;r++){var o=i[r];e.Nh.delete(o),n&&e.Ch.Wh(o,n)}e.Fh.delete(t),e.Uh&&e.Mh.Uc(t).forEach((function(t){e.Mh.Ho(t)||ka(e,t)}))}function ka(e,t){var n=e.$h.get(t);null!==n&&($o(e.ph,n),e.$h=e.$h.remove(t),e.kh.delete(n),Na(e))}function Da(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof ga?(e.Mh.Da(o.key,t),Oa(e,o)):o instanceof va?(p("SyncEngine","Document no longer in limbo: "+o.key),e.Mh.Na(o.key,t),e.Mh.Ho(o.key)||ka(e,o.key)):y()}}function Oa(e,t){var n=t.key;e.$h.get(n)||(p("SyncEngine","New document in limbo: "+n),e.xh.push(n),Na(e))}function Na(e){for(;e.xh.length>0&&e.$h.size<e.Dh;){var t=e.xh.shift(),n=e.Bh.next();e.kh.set(n,new _a(t)),e.$h=e.$h.ot(t,n),Xo(e.ph,new be(Wn(Fn(t.path)),n,2,jr.ai))}}function Ua(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a,s;return r.__generator(this,(function(l){switch(l.label){case 0:return i=_(e),o=[],a=[],s=[],i.Nh.m()?[3,3]:(i.Nh.forEach((function(e,r){s.push(i.Qh(r,t,n).then((function(e){if(e){i.Uh&&i.Sh.Qi(r.targetId,e.fromCache?"not-current":"current"),o.push(e);var t=oi.zr(r.targetId,e);a.push(t)}})))})),[4,Promise.all(s)]);case 1:return l.sent(),i.Ch.yu(o),[4,function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s,l,c,u,h;return r.__generator(this,(function(r){switch(r.label){case 0:n=_(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return yr.forEach(t,(function(t){return yr.forEach(t.Kr,(function(r){return n.persistence.No.Da(e,t.targetId,r)})).next((function(){return yr.forEach(t.Gr,(function(r){return n.persistence.No.Na(e,t.targetId,r)}))}))}))}))];case 2:return r.sent(),[3,4];case 3:if(!xr(i=r.sent()))throw i;return p("LocalStore","Failed to update sequence numbers: "+i),[3,4];case 4:for(o=0,a=t;o<a.length;o++)s=a[o],l=s.targetId,s.fromCache||(c=n.bc.get(l),u=c.nt,h=c.rt(u),n.bc=n.bc.ot(l,h));return[2]}}))}))}(i.ju,a)];case 2:l.sent(),l.label=3;case 3:return[2]}}))}))}function Fa(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(o){switch(o.label){case 0:return(n=_(e)).currentUser.isEqual(t)?[3,3]:(p("SyncEngine","User change. New user:",t.ti()),[4,function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a;return r.__generator(this,(function(r){switch(r.label){case 0:return n=_(e),i=n.Sr,o=n.Cc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(e){var r;return n.Sr.Uo(e).next((function(a){return r=a,i=n.persistence.mc(t),o=new ii(n.Dc,i,n.persistence.Ic()),i.Uo(e)})).next((function(t){for(var n=[],i=[],a=Oe(),s=0,l=r;s<l.length;s++){var c=l[s];n.push(c.batchId);for(var u=0,h=c.mutations;u<h.length;u++){var d=h[u];a=a.add(d.key)}}for(var f=0,p=t;f<p.length;f++){var m=p[f];i.push(m.batchId);for(var g=0,v=m.mutations;g<v.length;g++){var y=v[g];a=a.add(y.key)}}return o.kr(e,a).next((function(e){return{jh:e,Kh:n,Gh:i}}))}))}))];case 1:return a=r.sent(),[2,(n.Sr=i,n.Cc=o,n.Vc.Nc(n.Cc),a)]}}))}))}(n.ju,t)]);case 1:return i=o.sent(),n.currentUser=t,function(e){e.Lh.forEach((function(e){e.forEach((function(e){e.reject(new h(u.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Lh.clear()}(n),n.Sh.ji(t,i.Kh,i.Gh),[4,Ua(n,i.jh)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}))}function za(e,t){var n=_(e),r=n.kh.get(t);if(r&&r.Vh)return Oe().add(r.key);var i=Oe(),o=n.Fh.get(t);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var l=s[a],c=n.Nh.get(l);i=i.kt(c.view.dh)}return i}function Ba(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,Mo((n=_(e)).ju,t.query,!0)];case 1:return i=r.sent(),o=t.view.Ph(i),[2,(n.Uh&&Da(n,t.targetId,o.Rh),o)]}}))}))}function Va(e,t,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,a;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,function(e,t){var n=_(e),r=_(n.Sr);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Lo(e,t).next((function(t){return t?n.Cc.kr(e,t):yr.resolve(null)}))}))}((o=_(e)).ju,t)];case 1:return null===(a=r.sent())?[3,6]:"pending"!==n?[3,3]:[4,aa(o.ph)];case 2:return r.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Pa(o,t,i||null),Ra(o,t),function(e,t){_(_(e).Sr).Ko(t)}(o.ju,t)):y(),r.label=4;case 4:return[4,Ua(o,a)];case 5:return r.sent(),[3,7];case 6:p("SyncEngine","Cannot apply mutation batch with id: "+t),r.label=7;case 7:return[2]}}))}))}function ja(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s,l,c,u;return r.__generator(this,(function(r){switch(r.label){case 0:return $a(n=_(e)),Ya(n),!0!==t||!0===n.qh?[3,3]:(i=n.Sh.Ci(),[4,Ha(n,i.A())]);case 1:return o=r.sent(),n.qh=!0,[4,fa(n.ph,!0)];case 2:for(r.sent(),a=0,s=o;a<s.length;a++)l=s[a],Xo(n.ph,l);return[3,7];case 3:return!1!==t||!1===n.qh?[3,7]:(c=[],u=Promise.resolve(),n.Fh.forEach((function(e,t){n.Sh.qi(t)?c.push(t):u=u.then((function(){return La(n,t),Ao(n.ju,t,!0)})),$o(n.ph,t)})),[4,u]);case 4:return r.sent(),[4,Ha(n,c)];case 5:return r.sent(),function(e){var t=_(e);t.kh.forEach((function(e,n){$o(t.ph,n)})),t.Mh.Qc(),t.kh=new Map,t.$h=new Se(C.i)}(n),n.qh=!1,[4,fa(n.ph,!1)];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))}function Ha(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s,l,c,u,h,d,f,p,m,g;return r.__generator(this,(function(r){switch(r.label){case 0:n=_(e),i=[],o=[],a=0,s=t,r.label=1;case 1:return a<s.length?(l=s[a],c=void 0,(u=n.Fh.get(l))&&0!==u.length?[4,Eo(n.ju,Wn(u[0]))]:[3,7]):[3,13];case 2:c=r.sent(),h=0,d=u,r.label=3;case 3:return h<d.length?(f=d[h],p=n.Nh.get(f),[4,Ba(n,p)]):[3,6];case 4:(m=r.sent()).snapshot&&o.push(m.snapshot),r.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,To(n.ju,l)];case 8:return g=r.sent(),[4,Eo(n.ju,g)];case 9:return c=r.sent(),[4,Sa(n,Ga(g),l,!1)];case 10:r.sent(),r.label=11;case 11:i.push(c),r.label=12;case 12:return a++,[3,1];case 13:return[2,(n.Ch.yu(o),i)]}}))}))}function Ga(e){return Un(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Wa(e){var t=_(e);return _(_(t.ju).persistence).pi()}function qa(e,t,n,i){return r.__awaiter(this,void 0,void 0,(function(){var o,a,s;return r.__generator(this,(function(r){switch(r.label){case 0:return(o=_(e)).qh?(p("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Fh.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Co(o.ju)];case 3:return a=r.sent(),s=Ve.Xt(t,"current"===n),[4,Ua(o,a,s)];case 4:return r.sent(),[3,8];case 5:return[4,Ao(o.ju,t,!0)];case 6:return r.sent(),La(o,t,i),[3,8];case 7:y(),r.label=8;case 8:return[2]}}))}))}function Xa(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a,s,l,c,u,h,d,f;return r.__generator(this,(function(m){switch(m.label){case 0:if(!(i=$a(e)).qh)return[3,10];o=0,a=t,m.label=1;case 1:return o<a.length?(s=a[o],i.Fh.has(s)?(p("SyncEngine","Adding an already active target "+s),[3,5]):[4,To(i.ju,s)]):[3,6];case 2:return l=m.sent(),[4,Eo(i.ju,l)];case 3:return c=m.sent(),[4,Sa(i,Ga(l),c.targetId,!1)];case 4:m.sent(),Xo(i.ph,c),m.label=5;case 5:return o++,[3,1];case 6:u=function(e){return r.__generator(this,(function(t){switch(t.label){case 0:return i.Fh.has(e)?[4,Ao(i.ju,e,!1).then((function(){$o(i.ph,e),La(i,e)})).catch(Ro)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))},h=0,d=n,m.label=7;case 7:return h<d.length?(f=d[h],[5,u(f)]):[3,10];case 8:m.sent(),m.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function $a(e){var t=_(e);return t.ph.Gu.sh=Aa.bind(null,t),t.ph.Gu.qe=za.bind(null,t),t.ph.Gu.nh=Ta.bind(null,t),t.Ch.yu=Ur.bind(null,t.bh),t.Ch.Wh=Fr.bind(null,t.bh),t}function Ya(e){var t=_(e);return t.ph.Gu.ih=Ca.bind(null,t),t.ph.Gu.rh=Ia.bind(null,t),t}var Ka=function(){function e(){}return e.prototype.Nc=function(e){this.zh=e},e.prototype.Lr=function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.on.length||1===e.on.length&&e.on[0].field.p())}(t)||n.isEqual(le.min())?this.Hh(e,t):this.zh.kr(e,r).next((function(a){var s=i.Yh(t,a);return(zn(t)||Bn(t))&&i.Eh(t.an,s,r,n)?i.Hh(e,t):(f()<=o.LogLevel.DEBUG&&p("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Zn(t)),i.zh.Lr(e,t,n).next((function(e){return s.forEach((function(t){e=e.ot(t.key,t)})),e})))}))},e.prototype.Yh=function(e,t){var n=new Me(Jn(e));return t.forEach((function(t,r){r instanceof kn&&Qn(e,r)&&(n=n.add(r))})),n},e.prototype.Eh=function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},e.prototype.Hh=function(e,t){return f()<=o.LogLevel.DEBUG&&p("IndexFreeQueryEngine","Using full collection scan to execute query:",Zn(t)),this.zh.Lr(e,t,le.min())},e}(),Za=function(){function e(e,t){this.Dr=e,this.No=t,this.Sr=[],this.Jh=1,this.Xh=new Me(Lo.kc)}return e.prototype.$o=function(e){return yr.resolve(0===this.Sr.length)},e.prototype.ko=function(e,t,n,r){var i=this.Jh;this.Jh++,this.Sr.length>0&&this.Sr[this.Sr.length-1];var o=new Jr(i,t,n,r);this.Sr.push(o);for(var a=0,s=r;a<s.length;a++){var l=s[a];this.Xh=this.Xh.add(new Lo(l.key,i)),this.Dr.Mo(e,l.key.path.h())}return yr.resolve(o)},e.prototype.Oo=function(e,t){return yr.resolve(this.Zh(t))},e.prototype.Bo=function(e,t){var n=t+1,r=this.tl(n),i=r<0?0:r;return yr.resolve(this.Sr.length>i?this.Sr[i]:null)},e.prototype.qo=function(){return yr.resolve(0===this.Sr.length?-1:this.Jh-1)},e.prototype.Uo=function(e){return yr.resolve(this.Sr.slice())},e.prototype.Nr=function(e,t){var n=this,r=new Lo(t,0),i=new Lo(t,Number.POSITIVE_INFINITY),o=[];return this.Xh.Ft([r,i],(function(e){var t=n.Zh(e.jc);o.push(t)})),yr.resolve(o)},e.prototype.Or=function(e,t){var n=this,r=new Me(K);return t.forEach((function(e){var t=new Lo(e,0),i=new Lo(e,Number.POSITIVE_INFINITY);n.Xh.Ft([t,i],(function(e){r=r.add(e.jc)}))})),yr.resolve(this.el(r))},e.prototype.Wr=function(e,t){var n=t.path,r=n.length+1,i=n;C.F(i)||(i=i.child(""));var o=new Lo(new C(i),0),a=new Me(K);return this.Xh.xt((function(e){var t=e.key.path;return!!n.T(t)&&(t.length===r&&(a=a.add(e.jc)),!0)}),o),yr.resolve(this.el(a))},e.prototype.el=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.Zh(e);null!==r&&n.push(r)})),n},e.prototype.Wo=function(e,t){var n=this;b(0===this.nl(t.batchId,"removed")),this.Sr.shift();var r=this.Xh;return yr.forEach(t.mutations,(function(i){var o=new Lo(i.key,t.batchId);return r=r.delete(o),n.No.Go(e,i.key)})).next((function(){n.Xh=r}))},e.prototype.Ko=function(e){},e.prototype.Ho=function(e,t){var n=new Lo(t,0),r=this.Xh.$t(n);return yr.resolve(t.isEqual(r&&r.key))},e.prototype.zo=function(e){return this.Sr.length,yr.resolve()},e.prototype.nl=function(e,t){return this.tl(e)},e.prototype.tl=function(e){return 0===this.Sr.length?0:e-this.Sr[0].batchId},e.prototype.Zh=function(e){var t=this.tl(e);return t<0||t>=this.Sr.length?null:this.Sr[t]},e}(),Qa=function(){function e(e,t){this.Dr=e,this.sl=t,this.docs=new Se(C.i),this.size=0}return e.prototype.Er=function(e,t,n){var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.sl(t);return this.docs=this.docs.ot(r,{ta:t,size:a,readTime:n}),this.size+=a-o,this.Dr.Mo(e,r.path.h())},e.prototype.Ar=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.Rr=function(e,t){var n=this.docs.get(t);return yr.resolve(n?n.ta:null)},e.prototype.getEntries=function(e,t){var n=this,r=Re();return t.forEach((function(e){var t=n.docs.get(e);r=r.ot(e,t?t.ta:null)})),yr.resolve(r)},e.prototype.Lr=function(e,t,n){for(var r=Le(),i=new C(t.path.child("")),o=this.docs.ft(i);o.At();){var a=o.It(),s=a.key,l=a.value,c=l.ta,u=l.readTime;if(!t.path.T(s.path))break;u.L(n)<=0||c instanceof kn&&Qn(t,c)&&(r=r.ot(c.key,c))}return yr.resolve(r)},e.prototype.il=function(e,t){return yr.forEach(this.docs,(function(e){return t(e)}))},e.prototype.ra=function(e){return new Ja(this)},e.prototype.aa=function(e){return yr.resolve(this.size)},e}(),Ja=function(e){function t(t){var n=this;return(n=e.call(this)||this).ca=t,n}return r.__extends(t,e),t.prototype.yr=function(e){var t=this,n=[];return this.wr.forEach((function(r,i){i?n.push(t.ca.Er(e,i,t.readTime)):t.ca.Ar(r)})),yr.$n(n)},t.prototype.gr=function(e,t){return this.ca.Rr(e,t)},t.prototype.Pr=function(e,t){return this.ca.getEntries(e,t)},t}(ti),es=function(){function e(e){this.persistence=e,this.rl=new ae((function(e){return pe(e)}),me),this.lastRemoteSnapshotVersion=le.min(),this.highestTargetId=0,this.ol=0,this.al=new Po,this.targetCount=0,this.cl=oo.fa()}return e.prototype.Ce=function(e,t){return this.rl.forEach((function(e,n){return t(n)})),yr.resolve()},e.prototype.Ea=function(e){return yr.resolve(this.lastRemoteSnapshotVersion)},e.prototype.Ia=function(e){return yr.resolve(this.ol)},e.prototype.wa=function(e){return this.highestTargetId=this.cl.next(),yr.resolve(this.highestTargetId)},e.prototype.Aa=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ol&&(this.ol=t),yr.resolve()},e.prototype.ga=function(e){this.rl.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.cl=new oo(t),this.highestTargetId=t),e.sequenceNumber>this.ol&&(this.ol=e.sequenceNumber)},e.prototype.Ra=function(e,t){return this.ga(t),this.targetCount+=1,yr.resolve()},e.prototype.ya=function(e,t){return this.ga(t),yr.resolve()},e.prototype.Va=function(e,t){return this.rl.delete(t.target),this.al.Uc(t.targetId),this.targetCount-=1,yr.resolve()},e.prototype.po=function(e,t,n){var r=this,i=0,o=[];return this.rl.forEach((function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.rl.delete(a),o.push(r.pa(e,s.targetId)),i++)})),yr.$n(o).next((function(){return i}))},e.prototype.ba=function(e){return yr.resolve(this.targetCount)},e.prototype.va=function(e,t){var n=this.rl.get(t)||null;return yr.resolve(n)},e.prototype.Sa=function(e,t,n){return this.al.Lc(t,n),yr.resolve()},e.prototype.Ca=function(e,t,n){this.al.qc(t,n);var r=this.persistence.No,i=[];return r&&t.forEach((function(t){i.push(r.Go(e,t))})),yr.$n(i)},e.prototype.pa=function(e,t){return this.al.Uc(t),yr.resolve()},e.prototype.Fa=function(e,t){var n=this.al.Wc(t);return yr.resolve(n)},e.prototype.Ho=function(e,t){return yr.resolve(this.al.Ho(t))},e}(),ts=function(){function e(e){var t=this;this.ul={},this.Ma=new jr(0),this.Oa=!1,this.Oa=!0,this.No=e(this),this.Ka=new es(this),this.Dr=new Fi,this.vr=function(e){return new Qa(e,(function(e){return t.No.hl(e)}))}(this.Dr)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.Di=function(){return this.Oa=!1,Promise.resolve()},Object.defineProperty(e.prototype,"Ei",{get:function(){return this.Oa},enumerable:!1,configurable:!0}),e.prototype.Za=function(){},e.prototype.tc=function(){},e.prototype.Ic=function(){return this.Dr},e.prototype.mc=function(e){var t=this.ul[e.ti()];return t||(t=new Za(this.Dr,this.No),this.ul[e.ti()]=t),t},e.prototype.Tc=function(){return this.Ka},e.prototype.Ec=function(){return this.vr},e.prototype.runTransaction=function(e,t,n){var r=this;p("MemoryPersistence","Starting transaction:",e);var i=new ns(this.Ma.next());return this.No.ll(),n(i).next((function(e){return r.No._l(i).next((function(){return e}))})).Fn().then((function(e){return i.br(),e}))},e.prototype.fl=function(e,t){return yr.kn(Object.values(this.ul).map((function(n){return function(){return n.Ho(e,t)}})))},e}(),ns=function(e){function t(t){var n=this;return(n=e.call(this)||this).xa=t,n}return r.__extends(t,e),t}(ri),rs=function(){function e(e){this.persistence=e,this.dl=new Po,this.wl=null}return e.ml=function(t){return new e(t)},Object.defineProperty(e.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw y()},enumerable:!1,configurable:!0}),e.prototype.Da=function(e,t,n){return this.dl.Da(n,t),this.Tl.delete(n.toString()),yr.resolve()},e.prototype.Na=function(e,t,n){return this.dl.Na(n,t),this.Tl.add(n.toString()),yr.resolve()},e.prototype.Go=function(e,t){return this.Tl.add(t.toString()),yr.resolve()},e.prototype.removeTarget=function(e,t){var n=this;this.dl.Uc(t.targetId).forEach((function(e){return n.Tl.add(e.toString())}));var r=this.persistence.Tc();return r.Fa(e,t.targetId).next((function(e){e.forEach((function(e){return n.Tl.add(e.toString())}))})).next((function(){return r.Va(e,t)}))},e.prototype.ll=function(){this.wl=new Set},e.prototype._l=function(e){var t=this,n=this.persistence.Ec().ra();return yr.forEach(this.Tl,(function(r){var i=C.D(r);return t.El(e,i).next((function(e){e||n.Ar(i)}))})).next((function(){return t.wl=null,n.apply(e)}))},e.prototype.yc=function(e,t){var n=this;return this.El(e,t).next((function(e){e?n.Tl.delete(t.toString()):n.Tl.add(t.toString())}))},e.prototype.hl=function(e){return 0},e.prototype.El=function(e,t){var n=this;return yr.kn([function(){return yr.resolve(n.dl.Ho(t))},function(){return n.persistence.Tc().Ho(e,t)},function(){return n.persistence.fl(e,t)}])},e}(),is=function(){function e(e){this.Il=e.Il,this.Al=e.Al}return e.prototype.gu=function(e){this.Rl=e},e.prototype.Tu=function(e){this.gl=e},e.prototype.onMessage=function(e){this.Pl=e},e.prototype.close=function(){this.Al()},e.prototype.send=function(e){this.Il(e)},e.prototype.yl=function(){this.Rl()},e.prototype.Vl=function(e){this.gl(e)},e.prototype.pl=function(e){this.Pl(e)},e}(),os={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},as=function(e){function t(t){var n=this;return(n=e.call(this,t)||this).forceLongPolling=t.forceLongPolling,n.W=t.W,n}return r.__extends(t,e),t.prototype.Nl=function(e,t,n,r){return new Promise((function(i,o){var a=new s.XhrIo;a.listenOnce(s.EventType.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case s.ErrorCode.NO_ERROR:var t=a.getResponseJson();p("Connection","XHR received:",JSON.stringify(t)),i(t);break;case s.ErrorCode.TIMEOUT:p("Connection",'RPC "'+e+'" timed out'),o(new h(u.DEADLINE_EXCEEDED,"Request time out"));break;case s.ErrorCode.HTTP_ERROR:var n=a.getStatus();if(p("Connection",'RPC "'+e+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var l=function(e){var t=e.toLowerCase().replace("_","-");return Object.values(u).indexOf(t)>=0?t:u.UNKNOWN}(r.status);o(new h(l,r.message))}else o(new h(u.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new h(u.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{p("Connection",'RPC "'+e+'" completed.')}}));var l=JSON.stringify(r);a.send(t,"POST",l,n,15)}))},t.prototype.Pu=function(e,t){var n=[this.vl,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=s.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.W};this.Cl(i.initMessageHeaders,t),a.isMobileCordova()||a.isReactNative()||a.isElectron()||a.isIE()||a.isUWP()||a.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");p("Connection","Creating WebChannel: "+o,i);var l=r.createWebChannel(o,i),c=!1,d=!1,f=new is({Il:function(e){d?p("Connection","Not sending because WebChannel is closed:",e):(c||(p("Connection","Opening WebChannel transport."),l.open(),c=!0),p("Connection","WebChannel sending:",e),l.send(e))},Al:function(){return l.close()}}),m=function(e,t){l.listen(e,(function(e){try{t(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return m(s.WebChannel.EventType.OPEN,(function(){d||p("Connection","WebChannel transport opened.")})),m(s.WebChannel.EventType.CLOSE,(function(){d||(d=!0,p("Connection","WebChannel transport closed"),f.Vl())})),m(s.WebChannel.EventType.ERROR,(function(e){d||(d=!0,g("Connection","WebChannel transport errored:",e),f.Vl(new h(u.UNAVAILABLE,"The operation could not be completed")))})),m(s.WebChannel.EventType.MESSAGE,(function(e){var t;if(!d){var n=e.data[0];b(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){p("Connection","WebChannel received error:",i);var o=i.status,a=function(e){var t=ve[e];if(void 0!==t)return xe(t)}(o),s=i.message;void 0===a&&(a=u.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),d=!0,f.Vl(new h(a,s)),l.close()}else p("Connection","WebChannel received:",n),f.pl(n)}})),setTimeout((function(){f.yl()}),0),f},t}(function(){function e(e){this.bl=e,this.U=e.U;var t=e.ssl?"https":"http";this.vl=t+"://"+e.host,this.Sl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}return e.prototype.$u=function(e,t,n,r){var i=this.Dl(e,t);p("RestConnection","Sending: ",i,n);var o={};return this.Cl(o,r),this.Nl(e,i,o,n).then((function(e){return p("RestConnection","Received: ",e),e}),(function(t){throw g("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t}))},e.prototype.ku=function(e,t,n,r){return this.$u(e,t,n,r)},e.prototype.Cl=function(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/7.24.0",e["Content-Type"]="text/plain",t)for(var n in t.Kc)t.Kc.hasOwnProperty(n)&&(e[n]=t.Kc[n])},e.prototype.Dl=function(e,t){var n=os[e];return this.vl+"/v1/"+t+":"+n},e}()),ss=function(){function e(){var e=this;this.Fl=function(){return e.xl()},this.$l=function(){return e.kl()},this.Ml=[],this.Ol()}return e.prototype.Zu=function(e){this.Ml.push(e)},e.prototype.Di=function(){window.removeEventListener("online",this.Fl),window.removeEventListener("offline",this.$l)},e.prototype.Ol=function(){window.addEventListener("online",this.Fl),window.addEventListener("offline",this.$l)},e.prototype.xl=function(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.Ml;e<t.length;e++)(0,t[e])(0)},e.prototype.kl=function(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.Ml;e<t.length;e++)(0,t[e])(1)},e.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),ls=function(){function e(){}return e.prototype.Zu=function(e){},e.prototype.Di=function(){},e}();function cs(e){return new yt(e,!0)}var us="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",hs=function(){function e(){}return e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return this.Sh=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.ju=this.Ql(e),[2]}}))}))},e.prototype.Ul=function(e){return null},e.prototype.Ql=function(e){return t=this.persistence,n=new Ka,r=e.Wl,new bo(t,n,r);var t,n,r},e.prototype.Bl=function(e){if(e.persistenceSettings.jl)throw new h(u.FAILED_PRECONDITION,us);return new ts(rs.ml)},e.prototype.Ll=function(e){return new Qr},e.prototype.terminate=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.ql&&this.ql.stop(),[4,this.Sh.Di()];case 1:return e.sent(),[4,this.persistence.Di()];case 2:return e.sent(),[2]}}))}))},e.prototype.clearPersistence=function(e,t){throw new h(u.FAILED_PRECONDITION,us)},e}(),ds=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.initialize=function(t){return r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return o.sent(),n=this.Kl.fi,this.Sh instanceof Zr?(this.Sh.fi={er:Va.bind(null,n),nr:qa.bind(null,n),sr:Xa.bind(null,n),pi:Wa.bind(null,n)},[4,this.Sh.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.Xa((function(e){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,ja(this.Kl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ei?this.ql.start(this.ju):e||this.ql.stop()),[2]}}))}))}))];case 4:return o.sent(),[2]}}))}))},t.prototype.Ll=function(e){if(e.persistenceSettings.jl&&e.persistenceSettings.synchronizeTabs){var t=Cr();if(!Zr.Ln(t))throw new h(u.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=yo(e.bl.U,e.bl.persistenceKey);return new Zr(t,e.cs,n,e.clientId,e.Wl)}return new Qr},t}(function(e){function t(t){var n=this;return(n=e.call(this)||this).Kl=t,n}return r.__extends(t,e),t.prototype.initialize=function(t){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(n){switch(n.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return n.sent(),[4,Io(this.ju)];case 2:return n.sent(),[4,this.Kl.initialize(this,t)];case 3:return n.sent(),[4,Ya(this.Kl.fi)];case 4:return n.sent(),[4,aa(this.Kl.ph)];case 5:return n.sent(),[2]}}))}))},t.prototype.Ul=function(e){var t=this.persistence.No.wo;return new ui(t,e.cs)},t.prototype.Bl=function(e){var t=yo(e.bl.U,e.bl.persistenceKey),n=cs(e.bl.U);return new fo(e.persistenceSettings.synchronizeTabs,t,e.clientId,ci.ao(e.persistenceSettings.cacheSizeBytes),e.cs,Cr(),Ir(),n,this.Sh,e.persistenceSettings.ka)},t.prototype.Ll=function(e){return new Qr},t.prototype.clearPersistence=function(e,t){return function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return br.Ln()?(t=e+"main",[4,br.delete(t)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(yo(e,t))},t}(hs)),fs=function(){function e(){}return e.prototype.initialize=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.ju?[3,2]:(this.ju=e.ju,this.Sh=e.Sh,this.Ku=this.Gl(t),this.ph=this.zl(t),this.bh=this.Hl(t),this.fi=this.Yl(t),this.Sh.di=function(e){return Ma(n.fi,e,1)},this.ph.Gu.Jl=Fa.bind(null,this.fi),[4,fa(this.ph,this.fi.Uh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.Hl=function(e){return new Dr},e.prototype.Gl=function(e){var t,n=cs(e.bl.U),r=(t=e.bl,new as(t));return function(e,t,n){return new Vo(e,t,n)}(e.credentials,r,n)},e.prototype.zl=function(e){var t,n,r,i,o,a=this;return t=this.ju,n=this.Ku,r=e.cs,i=function(e){return Ma(a.fi,e,0)},o=ss.Ln()?new ss:new ls,new Ho(t,n,r,i,o)},e.prototype.Yl=function(e){return function(e,t,n,r,i,o,a){var s=new wa(e,t,n,r,i,o);return a&&(s.qh=!0),s}(this.ju,this.ph,this.bh,this.Sh,e.Wl,e.Dh,!e.persistenceSettings.jl||!e.persistenceSettings.synchronizeTabs)},e.prototype.terminate=function(){return qo(this.ph)},e}(),ps=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.observer.next&&this.Xl(this.observer.next,e)},e.prototype.error=function(e){this.observer.error?this.Xl(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},e.prototype.Zl=function(){this.muted=!0},e.prototype.Xl=function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)},e}(),ms=function(e){!function(e,t){if(!(t instanceof Array)||t.length<1)throw new h(u.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+X(1,"element")+".")}(0,e);for(var t=0;t<e.length;++t)if(k("FieldPath","string",t,e[t]),0===e[t].length)throw new h(u.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.t_=new T(e)},gs=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.call(this,t)||this}return r.__extends(t,e),t.documentId=function(){return new t(T.v().R())},t.prototype.isEqual=function(e){if(!(e instanceof t))throw G("isEqual","FieldPath",1,e);return this.t_.isEqual(e.t_)},t}(ms),vs=new RegExp("[~\\*/\\[\\]]"),ys=function(e){this.e_=e},bs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.n_=function(e){if(2!==e.s_)throw 1===e.s_?e.i_(this.e_+"() can only appear at the top level of your update data"):e.i_(this.e_+"() cannot be used with set() unless you pass {merge:true}");return e.We.push(e.path),null},t.prototype.isEqual=function(e){return e instanceof t},t}(ys);function _s(e,t,n){return new Ls({s_:3,r_:t.settings.r_,methodName:e.e_,o_:n},t.U,t.serializer,t.ignoreUndefinedProperties)}var ws=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.n_=function(e){return new hn(e.path,new tn)},t.prototype.isEqual=function(e){return e instanceof t},t}(ys),xs=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).a_=n,r}return r.__extends(t,e),t.prototype.n_=function(e){var t=_s(this,e,!0),n=this.a_.map((function(e){return Fs(e,t)})),r=new nn(n);return new hn(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(ys),Ss=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).a_=n,r}return r.__extends(t,e),t.prototype.n_=function(e){var t=_s(this,e,!0),n=this.a_.map((function(e){return Fs(e,t)})),r=new on(n);return new hn(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(ys),Es=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).c_=n,r}return r.__extends(t,e),t.prototype.n_=function(e){var t=new sn(e.serializer,wt(e.serializer,this.c_));return new hn(e.path,t)},t.prototype.isEqual=function(e){return this===e},t}(ys),As=function(){function e(e,t){if(R("GeoPoint",arguments,2),k("GeoPoint","number",1,e),k("GeoPoint","number",2,t),!isFinite(e)||e<-90||e>90)throw new h(u.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new h(u.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this.u_=e,this.h_=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this.u_===e.u_&&this.h_===e.h_},e.prototype.toJSON=function(){return{latitude:this.u_,longitude:this.h_}},e.prototype.Y=function(e){return K(this.u_,e.u_)||K(this.h_,e.h_)},e}(),Ms=function(e){this.l_=e},Ts=/^__.*__$/,Cs=function(e,t,n){this.__=e,this.f_=t,this.d_=n},Is=function(){function e(e,t,n){this.data=e,this.We=t,this.fieldTransforms=n}return e.prototype.w_=function(e,t){var n=[];return null!==this.We?n.push(new xn(e,this.data,this.We,t)):n.push(new wn(e,this.data,t)),this.fieldTransforms.length>0&&n.push(new En(e,this.fieldTransforms)),n},e}(),Rs=function(){function e(e,t,n){this.data=e,this.We=t,this.fieldTransforms=n}return e.prototype.w_=function(e,t){var n=[new xn(e,this.data,this.We,t)];return this.fieldTransforms.length>0&&n.push(new En(e,this.fieldTransforms)),n},e}();function Ps(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}var Ls=function(){function e(e,t,n,r,i,o){this.settings=e,this.U=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.m_(),this.fieldTransforms=i||[],this.We=o||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"s_",{get:function(){return this.settings.s_},enumerable:!1,configurable:!0}),e.prototype.T_=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.We)},e.prototype.E_=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.T_({path:n,o_:!1});return r.I_(e),r},e.prototype.A_=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.T_({path:n,o_:!1});return r.m_(),r},e.prototype.R_=function(e){return this.T_({path:void 0,o_:!0})},e.prototype.i_=function(e){return Gs(e,this.settings.methodName,this.settings.g_||!1,this.path,this.settings.r_)},e.prototype.contains=function(e){return void 0!==this.We.find((function(t){return e.T(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.T(t.field)}))},e.prototype.m_=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.I_(this.path.get(e))},e.prototype.I_=function(e){if(0===e.length)throw this.i_("Document fields must not be empty");if(Ps(this.s_)&&Ts.test(e))throw this.i_('Document fields cannot begin and end with "__"')},e}(),ks=function(){function e(e,t,n){this.U=e,this.ignoreUndefinedProperties=t,this.serializer=n||cs(e)}return e.prototype.P_=function(e,t,n,r){return void 0===r&&(r=!1),new Ls({s_:e,methodName:t,r_:n,path:T.P(),o_:!1,g_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},e}();function Ds(e,t,n,r,i,o){void 0===o&&(o={});var a=e.P_(o.merge||o.mergeFields?2:0,t,n,i);Vs("Data must be an object, but it was:",a,r);var s,l,c=zs(r,a);if(o.merge)s=new un(a.We),l=a.fieldTransforms;else if(o.mergeFields){for(var d=[],f=0,p=o.mergeFields;f<p.length;f++){var m=p[f],g=void 0;if(m instanceof ms)g=m.t_;else{if("string"!=typeof m)throw y();g=Hs(t,m,n)}if(!a.contains(g))throw new h(u.INVALID_ARGUMENT,"Field '"+g+"' is specified in your field mask but missing from your input data.");Ws(d,g)||d.push(g)}s=new un(d),l=a.fieldTransforms.filter((function(e){return s.Ye(e.field)}))}else s=null,l=a.fieldTransforms;return new Is(new In(c),s,l)}function Os(e,t,n,r){var i=e.P_(1,t,n);Vs("Data must be an object, but it was:",i,r);var o=[],a=new Rn;x(r,(function(e,r){var s=Hs(t,e,n),l=i.A_(s);if(r instanceof bs||r instanceof Ms&&r.l_ instanceof bs)o.push(s);else{var c=Fs(r,l);null!=c&&(o.push(s),a.set(s,c))}}));var s=new un(o);return new Rs(a.Xe(),s,i.fieldTransforms)}function Ns(e,t,n,r,i,o){var a=e.P_(1,t,n),s=[js(t,r,n)],l=[i];if(o.length%2!=0)throw new h(u.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(js(t,o[c])),l.push(o[c+1]);for(var d=[],f=new Rn,p=s.length-1;p>=0;--p)if(!Ws(d,s[p])){var m=s[p],g=l[p],v=a.A_(m);if(g instanceof bs||g instanceof Ms&&g.l_ instanceof bs)d.push(m);else{var y=Fs(g,v);null!=y&&(d.push(m),f.set(m,y))}}var b=new un(d);return new Rs(f.Xe(),b,a.fieldTransforms)}function Us(e,t,n,r){return void 0===r&&(r=!1),Fs(n,e.P_(r?4:3,t))}function Fs(e,t){if(e instanceof Ms&&(e=e.l_),Bs(e))return Vs("Unsupported field value:",t,e),zs(e,t);if(e instanceof ys)return function(e,t){if(!Ps(t.s_))throw t.i_(e.e_+"() can only be used with update() and set()");if(!t.path)throw t.i_(e.e_+"() is not currently supported inside arrays");var n=e.n_(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(t.path&&t.We.push(t.path),e instanceof Array){if(t.settings.o_&&4!==t.s_)throw t.i_("Nested arrays are not supported");return function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=Fs(o[i],t.R_(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===e)return{nullValue:"NULL_VALUE"};if("number"==typeof e)return wt(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=se.fromDate(e);return{timestampValue:xt(t.serializer,n)}}if(e instanceof se){var r=new se(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:xt(t.serializer,r)}}if(e instanceof As)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ee)return{bytesValue:St(t.serializer,e.q)};if(e instanceof Cs){var i=t.U,o=e.__;if(!o.isEqual(i))throw t.i_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Mt(e.__||t.U,e.f_.path)}}if(void 0===e&&t.ignoreUndefinedProperties)return null;throw t.i_("Unsupported field value: "+V(e))}(e,t)}function zs(e,t){var n={};return S(e)?t.path&&t.path.length>0&&t.We.push(t.path):x(e,(function(e,r){var i=Fs(r,t.E_(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Bs(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof se||e instanceof As||e instanceof ee||e instanceof Cs||e instanceof ys)}function Vs(e,t,n){if(!Bs(n)||!B(n)){var r=V(n);throw"an object"===r?t.i_(e+" a custom object"):t.i_(e+" "+r)}}function js(e,t,n){if(t instanceof ms)return t.t_;if("string"==typeof t)return Hs(e,t);throw Gs("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}function Hs(e,t,n){try{return function(e){if(e.search(vs)>=0)throw new h(u.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(gs.bind.apply(gs,r.__spreadArrays([void 0],e.split("."))))}catch(t){throw new h(u.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(t).t_}catch(t){throw Gs((i=t)instanceof Error?i.message:i.toString(),e,!1,void 0,n)}var i}function Gs(e,t,n,r,i){var o=r&&!r.m(),a=void 0!==i,s="Function "+t+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var l="";return(o||a)&&(l+=" (found",o&&(l+=" in field "+r),a&&(l+=" in document "+i),l+=")"),new h(u.INVALID_ARGUMENT,(s+=". ")+e+l)}function Ws(e,t){return e.some((function(e){return e.isEqual(t)}))}var qs=function(){function e(e){this.Ku=e,this.y_=new Map,this.mutations=[],this.V_=!1,this.p_=null,this.b_=new Set}return e.prototype.v_=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:if(this.S_(),this.mutations.length>0)throw new h(u.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s,l;return r.__generator(this,(function(r){switch(r.label){case 0:return n=_(e),i=Lt(n.serializer)+"/documents",o={documents:t.map((function(e){return Ct(n.serializer,e)}))},[4,n.ku("BatchGetDocuments",i,o)];case 1:return a=r.sent(),s=new Map,a.forEach((function(e){var t=function(e,t){return"found"in t?function(e,t){b(!!t.found),t.found.name,t.found.updateTime;var n=It(e,t.found.name),r=At(t.found.updateTime),i=new In({mapValue:{fields:t.found.fields}});return new kn(n,r,i,{})}(e,t):"missing"in t?function(e,t){b(!!t.missing),b(!!t.readTime);var n=It(e,t.missing),r=At(t.readTime);return new Dn(n,r)}(e,t):y()}(n.serializer,e);s.set(t.key.toString(),t)})),l=[],[2,(t.forEach((function(e){var t=s.get(e.toString());b(!!t),l.push(t)})),l)]}}))}))}(this.Ku,e)];case 1:return[2,((t=i.sent()).forEach((function(e){e instanceof Dn||e instanceof kn?n.D_(e):y()})),t)]}}))}))},e.prototype.set=function(e,t){this.write(t.w_(e,this.Ge(e))),this.b_.add(e.toString())},e.prototype.update=function(e,t){try{this.write(t.w_(e,this.C_(e)))}catch(e){this.p_=e}this.b_.add(e.toString())},e.prototype.delete=function(e){this.write([new Tn(e,this.Ge(e))]),this.b_.add(e.toString())},e.prototype.commit=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t=this;return r.__generator(this,(function(n){switch(n.label){case 0:if(this.S_(),this.p_)throw this.p_;return e=this.y_,this.mutations.forEach((function(t){e.delete(t.key.toString())})),e.forEach((function(e,n){var r=C.D(n);t.mutations.push(new Cn(r,t.Ge(r)))})),[4,function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o;return r.__generator(this,(function(r){switch(r.label){case 0:return n=_(e),i=Lt(n.serializer)+"/documents",o={writes:t.map((function(e){return Ot(n.serializer,e)}))},[4,n.$u("Commit",i,o)];case 1:return r.sent(),[2]}}))}))}(this.Ku,this.mutations)];case 1:return n.sent(),this.V_=!0,[2]}}))}))},e.prototype.D_=function(e){var t;if(e instanceof kn)t=e.version;else{if(!(e instanceof Dn))throw y();t=le.min()}var n=this.y_.get(e.key.toString());if(n){if(!t.isEqual(n))throw new h(u.ABORTED,"Document version changed between two reads.")}else this.y_.set(e.key.toString(),t)},e.prototype.Ge=function(e){var t=this.y_.get(e.toString());return!this.b_.has(e.toString())&&t?fn.updateTime(t):fn.ze()},e.prototype.C_=function(e){var t=this.y_.get(e.toString());if(!this.b_.has(e.toString())&&t){if(t.isEqual(le.min()))throw new h(u.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fn.updateTime(t)}return fn.exists(!0)},e.prototype.write=function(e){this.S_(),this.mutations=this.mutations.concat(e)},e.prototype.S_=function(){},e}(),Xs=function(){function e(e,t,n,r){this.cs=e,this.Ku=t,this.updateFunction=n,this.ls=r,this.N_=5,this.ys=new vr(this.cs,"transaction_retry")}return e.prototype.run=function(){this.F_()},e.prototype.F_=function(){var e=this;this.ys.gn((function(){return r.__awaiter(e,void 0,void 0,(function(){var e,t,n=this;return r.__generator(this,(function(r){return e=new qs(this.Ku),(t=this.x_(e))&&t.then((function(t){n.cs.ws((function(){return e.commit().then((function(){n.ls.resolve(t)})).catch((function(e){n.k_(e)}))}))})).catch((function(e){n.k_(e)})),[2]}))}))}))},e.prototype.x_=function(e){try{var t=this.updateFunction(e);return!ce(t)&&t.catch&&t.then?t:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.ls.reject(e),null}},e.prototype.k_=function(e){var t=this;this.N_>0&&this.M_(e)?(this.N_-=1,this.cs.ws((function(){return t.F_(),Promise.resolve()}))):this.ls.reject(e)},e.prototype.M_=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!we(t)}return!1},e}(),$s=function(){function e(e,t){this.credentials=e,this.cs=t,this.clientId=Y.k(),this.O_=new gr}return e.prototype.start=function(e,t,n,i){var o=this;this.L_(),this.bl=e;var a=new gr,s=!1;return this.credentials.Hc((function(e){if(!s)return s=!0,p("FirestoreClient","Initializing. user=",e.uid),o.B_(t,n,i,e,a).then(o.O_.resolve,o.O_.reject);o.cs.Cs((function(){return function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i;return r.__generator(this,(function(r){switch(r.label){case 0:return(n=_(e)).cs.xs(),p("RemoteStore","RemoteStore received new credentials"),i=Jo(n),n.Yu.add(3),[4,Wo(n)];case 1:return r.sent(),i&&n.th.set("Unknown"),[4,n.Gu.Jl(t)];case 2:return r.sent(),n.Yu.delete(3),[4,Go(n)];case 3:return r.sent(),[2]}}))}))}(o.ph,e)}))})),this.cs.ws((function(){return o.O_.promise})),a.promise},e.prototype.enableNetwork=function(){var e=this;return this.L_(),this.cs.enqueue((function(){return e.persistence.tc(!0),function(e){var t=_(e);return t.Yu.delete(0),Go(t)}(e.ph)}))},e.prototype.B_=function(e,t,n,i,o){return r.__awaiter(this,void 0,void 0,(function(){var a,s,l=this;return r.__generator(this,(function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),a={cs:this.cs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Wl:i,Dh:100,persistenceSettings:n},[4,e.initialize(a)];case 1:return c.sent(),[4,t.initialize(e,a)];case 2:return c.sent(),this.persistence=e.persistence,this.Sh=e.Sh,this.ju=e.ju,this.ql=e.ql,this.Ku=t.Ku,this.ph=t.ph,this.fi=t.fi,this.q_=t.bh,this.q_.Us=xa.bind(null,this.fi),this.q_.js=Ea.bind(null,this.fi),this.persistence.Za((function(){return r.__awaiter(l,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,this.terminate()];case 1:return e.sent(),[2]}}))}))})),o.resolve(),[3,4];case 3:if(s=c.sent(),o.reject(s),!this.U_(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.B_(new hs,new fs,{jl:!1},i,o))];case 4:return[2]}}))}))},e.prototype.U_=function(e){return"FirebaseError"===e.name?e.code===u.FAILED_PRECONDITION||e.code===u.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code},e.prototype.L_=function(){if(this.cs.ps)throw new h(u.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.disableNetwork=function(){var e=this;return this.L_(),this.cs.enqueue((function(){return e.persistence.tc(!1),function(e){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return(t=_(e)).Yu.add(0),[4,Wo(t)];case 1:return n.sent(),t.th.set("Offline"),[2]}}))}))}(e.ph)}))},e.prototype.terminate=function(){var e=this;this.cs.Ds();var t=new gr;return this.cs.bs((function(){return r.__awaiter(e,void 0,void 0,(function(){var e,n;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,qo(this.ph)];case 1:return r.sent(),[4,this.Sh.Di()];case 2:return r.sent(),[4,this.persistence.Di()];case 3:return r.sent(),this.credentials.Yc(),t.resolve(),[3,5];case 4:return e=r.sent(),n=Lr(e,"Failed to shutdown persistence"),t.reject(n),[3,5];case 5:return[2]}}))}))})),t.promise},e.prototype.waitForPendingWrites=function(){var e=this;this.L_();var t=new gr;return this.cs.ws((function(){return function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var n,i,o,a,s;return r.__generator(this,(function(r){switch(r.label){case 0:Jo((n=_(e)).ph)||p("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,function(e){var t=_(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.Sr.qo(e)}))}(n.ju)];case 2:return-1===(i=r.sent())?[2,void t.resolve()]:((o=n.Lh.get(i)||[]).push(t),n.Lh.set(i,o),[3,4]);case 3:return a=r.sent(),s=Lr(a,"Initialization of waitForPendingWrites() operation failed"),t.reject(s),[3,4];case 4:return[2]}}))}))}(e.fi,t)})),t.promise},e.prototype.listen=function(e,t,n){var r=this;this.L_();var i=new ps(n),o=new Br(e,i,t);return this.cs.ws((function(){return Or(r.q_,o)})),function(){i.Zl(),r.cs.ws((function(){return Nr(r.q_,o)}))}},e.prototype.Q_=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return i.sent(),t=new gr,[2,(this.cs.ws((function(){return function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(e,t){var n=_(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.Cc.Cr(e,t)}))}(e,t)];case 1:return(i=r.sent())instanceof kn?n.resolve(i):i instanceof Dn?n.resolve(null):n.reject(new h(u.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return o=r.sent(),a=Lr(o,"Failed to get document '"+t+" from cache"),n.reject(a),[3,3];case 3:return[2]}}))}))}(n.ju,e,t)})),t.promise)]}}))}))},e.prototype.W_=function(e,t){return void 0===t&&(t={}),r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return r.sent(),n=new gr,[2,(this.cs.ws((function(){return function(e,t,n,r,i){var o=new ps({next:function(o){t.ws((function(){return Nr(e,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new h(u.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new h(u.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(e){return i.reject(e)}}),a=new Br(Fn(n.path),o,{includeMetadataChanges:!0,Xs:!0});return Or(e,a)}(i.q_,i.cs,e,t,n)})),n.promise)]}}))}))},e.prototype.j_=function(e){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(i){switch(i.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return i.sent(),t=new gr,[2,(this.cs.ws((function(){return function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a,s,l,c;return r.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Mo(e,t,!0)];case 1:return i=r.sent(),o=new ya(t,i.Fc),a=o.wh(i.documents),s=o.yr(a,!1),n.resolve(s.snapshot),[3,3];case 2:return l=r.sent(),c=Lr(l,"Failed to execute query '"+t+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))}(n.ju,e,t)})),t.promise)]}}))}))},e.prototype.K_=function(e,t){return void 0===t&&(t={}),r.__awaiter(this,void 0,void 0,(function(){var n,i=this;return r.__generator(this,(function(r){switch(r.label){case 0:return this.L_(),[4,this.O_.promise];case 1:return r.sent(),n=new gr,[2,(this.cs.ws((function(){return function(e,t,n,r,i){var o=new ps({next:function(n){t.ws((function(){return Nr(e,a)})),n.fromCache&&"server"===r.source?i.reject(new h(u.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),a=new Br(n,o,{includeMetadataChanges:!0,Xs:!0});return Or(e,a)}(i.q_,i.cs,e,t,n)})),n.promise)]}}))}))},e.prototype.write=function(e){var t=this;this.L_();var n=new gr;return this.cs.ws((function(){return function(e,t,n){return r.__awaiter(this,void 0,void 0,(function(){var i,o,a,s;return r.__generator(this,(function(r){switch(r.label){case 0:i=Ya(e),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,function(e,t){var n,r=_(e),i=se.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Oe());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(e){return r.Cc.kr(e,o).next((function(o){n=o;for(var a=[],s=0,l=t;s<l.length;s++){var c=l[s],u=yn(c,n.get(c.key));null!=u&&a.push(new xn(c.key,u,Pn(u.proto.mapValue),fn.exists(!0)))}return r.Sr.ko(e,i,a,t)}))})).then((function(e){var t=e.lr(n);return{batchId:e.batchId,wr:t}}))}(i.ju,t)];case 2:return o=r.sent(),i.Sh.xi(o.batchId),function(e,t,n){var r=e.Oh[e.currentUser.ti()];r||(r=new Se(K)),r=r.ot(t,n),e.Oh[e.currentUser.ti()]=r}(i,o.batchId,n),[4,Ua(i,o.wr)];case 3:return r.sent(),[4,aa(i.ph)];case 4:return r.sent(),[3,6];case 5:return a=r.sent(),s=Lr(a,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}(t.fi,e,n)})),n.promise},e.prototype.U=function(){return this.bl.U},e.prototype.G_=function(e){var t=this;this.L_();var n=new ps(e);return this.cs.ws((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,function(e,t){_(e).qs.add(t),t.next()}(this.q_,n)]}))}))})),function(){n.Zl(),t.cs.ws((function(){return r.__awaiter(t,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,function(e,t){_(e).qs.delete(t)}(this.q_,n)]}))}))}))}},Object.defineProperty(e.prototype,"z_",{get:function(){return this.cs.ps},enumerable:!1,configurable:!0}),e.prototype.transaction=function(e){var t=this;this.L_();var n=new gr;return this.cs.ws((function(){return new Xs(t.cs,t.Ku,e,n).run(),Promise.resolve()})),n.promise},e}();function Ys(e){return function(e){if("object"!=typeof e||null===e)return!1;for(var t=e,n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(e)}var Ks=function(){function e(e,t,n,r,i){this.U=e,this.timestampsInSnapshots=t,this.H_=n,this.Y_=r,this.J_=i}return e.prototype.X_=function(e){switch(et(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.Z_(e.timestampValue);case 4:return this.tf(e);case 5:return e.stringValue;case 6:return this.J_(ct(e.bytesValue));case 7:return this.ef(e.referenceValue);case 8:return this.nf(e.geoPointValue);case 9:return this.sf(e.arrayValue);case 10:return this.if(e.mapValue);default:throw y()}},e.prototype.if=function(e){var t=this,n={};return x(e.fields||{},(function(e,r){n[e]=t.X_(r)})),n},e.prototype.nf=function(e){return new As(lt(e.latitude),lt(e.longitude))},e.prototype.sf=function(e){var t=this;return(e.values||[]).map((function(e){return t.X_(e)}))},e.prototype.tf=function(e){switch(this.H_){case"previous":var t=Ze(e);return null==t?null:this.X_(t);case"estimate":return this.Z_(Qe(e));default:return null}},e.prototype.Z_=function(e){var t=st(e),n=new se(t.seconds,t.nanos);return this.timestampsInSnapshots?n:n.toDate()},e.prototype.ef=function(e){var t=A.g(e);b(Kt(t));var n=new oe(t.get(1),t.get(3)),r=new C(t.u(5));return n.isEqual(this.U)||m("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Y_(r)},e}(),Zs=ci.ho,Qs=function(){function e(e){var t,n,r,i,o;if(void 0===e.host){if(void 0!==e.ssl)throw new h(u.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else O("settings","non-empty string","host",e.host),this.host=e.host,N("settings","boolean","ssl",e.ssl),this.ssl=null===(t=e.ssl)||void 0===t||t;if(H("settings",e,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","experimentalAutoDetectLongPolling","ignoreUndefinedProperties"]),N("settings","object","credentials",e.credentials),this.credentials=e.credentials,N("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),N("settings","boolean","ignoreUndefinedProperties",e.ignoreUndefinedProperties),!0===e.timestampsInSnapshots?m("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===e.timestampsInSnapshots&&m("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=e.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=e.ignoreUndefinedProperties)&&void 0!==r&&r,N("settings","number","cacheSizeBytes",e.cacheSizeBytes),void 0===e.cacheSizeBytes)this.cacheSizeBytes=ci._o;else{if(e.cacheSizeBytes!==Zs&&e.cacheSizeBytes<ci.lo)throw new h(u.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ci.lo);this.cacheSizeBytes=e.cacheSizeBytes}N("settings","boolean","experimentalForceLongPolling",e.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=e.experimentalForceLongPolling)&&void 0!==i&&i,N("settings","boolean","experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalAutoDetectLongPolling=null!==(o=e.experimentalAutoDetectLongPolling)&&void 0!==o&&o,function(e,t,n,r){if(!0===t&&!0===r)throw new h(u.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties},e}(),Js=function(){function e(t,n,i,o){var a=this;if(void 0===i&&(i=new hs),void 0===o&&(o=new fs),this.rf=i,this.af=o,this.cf=null,this.uf=new Pr,this.INTERNAL={delete:function(){return r.__awaiter(a,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return this.hf(),[4,this.lf.terminate()];case 1:return e.sent(),[2]}}))}))}},"object"==typeof t.options){var s=t;this.cf=s,this.__=e._f(s),this.ff=s.name,this.df=new Oo(n)}else{var l=t;if(!l.projectId)throw new h(u.INVALID_ARGUMENT,"Must provide projectId");this.__=new oe(l.projectId,l.database),this.ff="[DEFAULT]",this.df=new Do}this.wf=new Qs({})}return Object.defineProperty(e.prototype,"mf",{get:function(){return this.Tf||(this.Tf=new ks(this.__,this.wf.ignoreUndefinedProperties)),this.Tf},enumerable:!1,configurable:!0}),e.prototype.settings=function(e){R("Firestore.settings",arguments,1),k("Firestore.settings","object",1,e),e.merge&&delete(e=Object.assign(Object.assign({},this.wf),e)).merge;var t=new Qs(e);if(this.lf&&!this.wf.isEqual(t))throw new h(u.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.wf=t,void 0!==t.credentials&&(this.df=function(e){if(!e)return new Do;switch(e.type){case"gapi":var t=e.client;return b(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Uo(t,e.sessionIndex||"0");case"provider":return e.client;default:throw new h(u.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},e.prototype.enableNetwork=function(){return this.hf(),this.lf.enableNetwork()},e.prototype.disableNetwork=function(){return this.hf(),this.lf.disableNetwork()},e.prototype.enablePersistence=function(e){var t,n;if(this.lf)throw new h(u.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(e&&(void 0!==e.experimentalTabSynchronization&&m("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(t=e.synchronizeTabs)&&void 0!==t?t:e.experimentalTabSynchronization)&&void 0!==n&&n,i=!!e.experimentalForceOwningTab&&e.experimentalForceOwningTab,r&&i))throw new h(u.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ef(this.rf,this.af,{jl:!0,cacheSizeBytes:this.wf.cacheSizeBytes,synchronizeTabs:r,ka:i})},e.prototype.clearPersistence=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t=this;return r.__generator(this,(function(n){if(void 0!==this.lf&&!this.lf.z_)throw new h(u.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return e=new gr,[2,(this.uf.bs((function(){return r.__awaiter(t,void 0,void 0,(function(){var t;return r.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.rf.clearPersistence(this.__,this.ff)];case 1:return n.sent(),e.resolve(),[3,3];case 2:return t=n.sent(),e.reject(t),[3,3];case 3:return[2]}}))}))})),e.promise)]}))}))},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(e.prototype,"If",{get:function(){return this.hf(),this.lf.z_},enumerable:!1,configurable:!0}),e.prototype.waitForPendingWrites=function(){return this.hf(),this.lf.waitForPendingWrites()},e.prototype.onSnapshotsInSync=function(e){if(this.hf(),Ys(e))return this.lf.G_(e);k("Firestore.onSnapshotsInSync","function",1,e);var t={next:e};return this.lf.G_(t)},e.prototype.hf=function(){return this.lf||this.Ef(new hs,new fs,{jl:!1}),this.lf},e.prototype.Af=function(){return new ie(this.__,this.ff,this.wf.host,this.wf.ssl,this.wf.experimentalForceLongPolling,this.wf.experimentalAutoDetectLongPolling)},e.prototype.Ef=function(e,t,n){var r=this.Af();return this.lf=new $s(this.df,this.uf),this.lf.start(r,e,t,n)},e._f=function(e){if(t=e.options,!Object.prototype.hasOwnProperty.call(t,"projectId"))throw new h(u.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var t,n=e.options.projectId;if(!n||"string"!=typeof n)throw new h(u.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new oe(n)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.cf)throw new h(u.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){return R("Firestore.collection",arguments,1),k("Firestore.collection","non-empty string",1,e),this.hf(),new dl(A.g(e),this,null)},e.prototype.doc=function(e){return R("Firestore.doc",arguments,1),k("Firestore.doc","non-empty string",1,e),this.hf(),nl.Rf(A.g(e),this,null)},e.prototype.collectionGroup=function(e){if(R("Firestore.collectionGroup",arguments,1),k("Firestore.collectionGroup","non-empty string",1,e),e.indexOf("/")>=0)throw new h(u.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new ul(function(e){return new Nn(A.P(),e)}(e),this,null)},e.prototype.runTransaction=function(e){var t=this;return R("Firestore.runTransaction",arguments,1),k("Firestore.runTransaction","function",1,e),this.hf().transaction((function(n){return e(new el(t,n))}))},e.prototype.batch=function(){return this.hf(),new tl(this)},Object.defineProperty(e,"logLevel",{get:function(){switch(f()){case o.LogLevel.DEBUG:return"debug";case o.LogLevel.ERROR:return"error";case o.LogLevel.SILENT:return"silent";case o.LogLevel.WARN:return"warn";case o.LogLevel.INFO:return"info";case o.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),e.setLogLevel=function(e){var t;R("Firestore.setLogLevel",arguments,1),F("setLogLevel",["debug","error","silent","warn","info","verbose"],1,e),t=e,d.setLogLevel(t)},e.prototype.gf=function(){return this.wf.timestampsInSnapshots},e.prototype.Pf=function(){return this.wf},e}(),el=function(){function e(e,t){this.yf=e,this.Vf=t}return e.prototype.get=function(e){var t=this;R("Transaction.get",arguments,1);var n=gl("Transaction.get",e,this.yf);return this.Vf.v_([n.f_]).then((function(e){if(!e||1!==e.length)return y();var r=e[0];if(r instanceof Dn)return new il(t.yf,n.f_,null,!1,!1,n.d_);if(r instanceof kn)return new il(t.yf,n.f_,r,!1,!1,n.d_);throw y()}))},e.prototype.set=function(e,t,n){L("Transaction.set",arguments,2,3);var r=gl("Transaction.set",e,this.yf);n=fl("Transaction.set",n);var i=yl(r.d_,t,n),o=Ds(this.yf.mf,"Transaction.set",r.f_,i,null!==r.d_,n);return this.Vf.set(r.f_,o),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof t||t instanceof gs?(P("Transaction.update",arguments,3),r=gl("Transaction.update",e,this.yf),i=Ns(this.yf.mf,"Transaction.update",r.f_,t,n,o)):(R("Transaction.update",arguments,2),r=gl("Transaction.update",e,this.yf),i=Os(this.yf.mf,"Transaction.update",r.f_,t)),this.Vf.update(r.f_,i),this},e.prototype.delete=function(e){R("Transaction.delete",arguments,1);var t=gl("Transaction.delete",e,this.yf);return this.Vf.delete(t.f_),this},e}(),tl=function(){function e(e){this.yf=e,this.pf=[],this.bf=!1}return e.prototype.set=function(e,t,n){L("WriteBatch.set",arguments,2,3),this.vf();var r=gl("WriteBatch.set",e,this.yf);n=fl("WriteBatch.set",n);var i=yl(r.d_,t,n),o=Ds(this.yf.mf,"WriteBatch.set",r.f_,i,null!==r.d_,n);return this.pf=this.pf.concat(o.w_(r.f_,fn.ze())),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.vf(),"string"==typeof t||t instanceof gs?(P("WriteBatch.update",arguments,3),r=gl("WriteBatch.update",e,this.yf),i=Ns(this.yf.mf,"WriteBatch.update",r.f_,t,n,o)):(R("WriteBatch.update",arguments,2),r=gl("WriteBatch.update",e,this.yf),i=Os(this.yf.mf,"WriteBatch.update",r.f_,t)),this.pf=this.pf.concat(i.w_(r.f_,fn.exists(!0))),this},e.prototype.delete=function(e){R("WriteBatch.delete",arguments,1),this.vf();var t=gl("WriteBatch.delete",e,this.yf);return this.pf=this.pf.concat(new Tn(t.f_,fn.ze())),this},e.prototype.commit=function(){return this.vf(),this.bf=!0,this.pf.length>0?this.yf.hf().write(this.pf):Promise.resolve()},e.prototype.vf=function(){if(this.bf)throw new h(u.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),nl=function(e){function t(t,n,r){var i=this;return(i=e.call(this,n.__,t,r)||this).f_=t,i.firestore=n,i.d_=r,i.lf=i.firestore.hf(),i}return r.__extends(t,e),t.Rf=function(e,n,r){if(e.length%2!=0)throw new h(u.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.R()+" has "+e.length);return new t(new C(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new dl(this.f_.path.h(),this.firestore,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.f_.path.R()},enumerable:!1,configurable:!0}),t.prototype.collection=function(e){if(R("DocumentReference.collection",arguments,1),k("DocumentReference.collection","non-empty string",1,e),!e)throw new h(u.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=A.g(e);return new dl(this.f_.path.child(t),this.firestore,null)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw G("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.f_.isEqual(e.f_)&&this.d_===e.d_},t.prototype.set=function(e,t){L("DocumentReference.set",arguments,1,2),t=fl("DocumentReference.set",t);var n=yl(this.d_,e,t),r=Ds(this.firestore.mf,"DocumentReference.set",this.f_,n,null!==this.d_,t);return this.lf.write(r.w_(this.f_,fn.ze()))},t.prototype.update=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof e||e instanceof gs?(P("DocumentReference.update",arguments,2),n=Ns(this.firestore.mf,"DocumentReference.update",this.f_,e,t,r)):(R("DocumentReference.update",arguments,1),n=Os(this.firestore.mf,"DocumentReference.update",this.f_,e)),this.lf.write(n.w_(this.f_,fn.exists(!0)))},t.prototype.delete=function(){return R("DocumentReference.delete",arguments,0),this.lf.write([new Tn(this.f_,fn.ze())])},t.prototype.onSnapshot=function(){for(var e,t,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];L("DocumentReference.onSnapshot",arguments,1,4);var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||Ys(i[s])||(H("DocumentReference.onSnapshot",a=i[s],["includeMetadataChanges"]),N("DocumentReference.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),s++);var l={includeMetadataChanges:a.includeMetadataChanges};if(Ys(i[s])){var c=i[s];i[s]=null===(e=c.next)||void 0===e?void 0:e.bind(c),i[s+1]=null===(t=c.error)||void 0===t?void 0:t.bind(c),i[s+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else k("DocumentReference.onSnapshot","function",s,i[s]),D("DocumentReference.onSnapshot","function",s+1,i[s+1]),D("DocumentReference.onSnapshot","function",s+2,i[s+2]);var u={next:function(e){i[s]&&i[s](r.Sf(e))},error:i[s+1],complete:i[s+2]};return this.lf.listen(Fn(this.f_.path),l,u)},t.prototype.get=function(e){var t=this;L("DocumentReference.get",arguments,0,1),ml("DocumentReference.get",e);var n=this.firestore.hf();return e&&"cache"===e.source?n.Q_(this.f_).then((function(e){return new il(t.firestore,t.f_,e,!0,e instanceof kn&&e.Je,t.d_)})):n.W_(this.f_,e).then((function(e){return t.Sf(e)}))},t.prototype.withConverter=function(e){return new t(this.f_,this.firestore,e)},t.prototype.Sf=function(e){var t=e.docs.get(this.f_);return new il(this.firestore,this.f_,t,e.fromCache,e.hasPendingWrites,this.d_)},t}(Cs),rl=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),il=function(){function e(e,t,n,r,i,o){this.yf=e,this.f_=t,this.Df=n,this.Cf=r,this.Nf=i,this.d_=o}return e.prototype.data=function(e){var t=this;if(L("DocumentSnapshot.data",arguments,0,1),e=pl("DocumentSnapshot.data",e),this.Df){if(this.d_){var n=new ol(this.yf,this.f_,this.Df,this.Cf,this.Nf,null);return this.d_.fromFirestore(n,e)}return new Ks(this.yf.__,this.yf.gf(),e.serverTimestamps||"none",(function(e){return new nl(e,t.yf,null)}),(function(e){return new re(e)})).X_(this.Df.rn())}},e.prototype.get=function(e,t){var n=this;if(L("DocumentSnapshot.get",arguments,1,2),t=pl("DocumentSnapshot.get",t),this.Df){var r=this.Df.data().field(js("DocumentSnapshot.get",e,this.f_));if(null!==r)return new Ks(this.yf.__,this.yf.gf(),t.serverTimestamps||"none",(function(e){return new nl(e,n.yf,n.d_)}),(function(e){return new re(e)})).X_(r)}},Object.defineProperty(e.prototype,"id",{get:function(){return this.f_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new nl(this.f_,this.yf,this.d_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return null!==this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return new rl(this.Nf,this.Cf)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!(t instanceof e))throw G("isEqual","DocumentSnapshot",1,t);return this.yf===t.yf&&this.Cf===t.Cf&&this.f_.isEqual(t.f_)&&(null===this.Df?null===t.Df:this.Df.isEqual(t.Df))&&this.d_===t.d_},e}(),ol=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.data=function(t){return e.prototype.data.call(this,t)},t}(il);function al(e,t,n){if("string"==typeof n){if(""===n)throw new h(u.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hn(t)&&-1!==n.indexOf("/"))throw new h(u.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(A.g(n));if(!C.F(r))throw new h(u.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ut(e,new C(r))}if(n instanceof Cs)return ut(e,n.f_);throw new h(u.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+V(n)+".")}function sl(e,t){if(!Array.isArray(e)||0===e.length)throw new h(u.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new h(u.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===t||"array-contains-any"===t){if(e.indexOf(null)>=0)throw new h(u.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'null' in the value array.");if(e.filter((function(e){return Number.isNaN(e)})).length>0)throw new h(u.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters cannot contain 'NaN' in the value array.")}}function ll(e,t,n){if(!n.isEqual(t))throw new h(u.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function cl(e){if(Bn(e)&&0===e.on.length)throw new h(u.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ul=function(){function e(e,t,n){this.Ff=e,this.firestore=t,this.d_=n}return e.prototype.where=function(t,n,r){R("Query.where",arguments,3),j("Query.where",3,r);var i=F("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,n),o=js("Query.where",t),a=function(e,t,n,r,i,o,a){var s;if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new h(u.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){sl(a,o);for(var l=[],c=0,d=a;c<d.length;c++){var f=d[c];l.push(al(r,e,f))}s={arrayValue:{values:l}}}else s=al(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||sl(a,o),s=Us(n,"Query.where",a,"in"===o||"not-in"===o);var p=er.create(i,o,s);return function(e,t){if(t.hn()){var n=jn(e);if(null!==n&&!n.isEqual(t.field))throw new h(u.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");var r=Vn(e);null!==r&&ll(0,t.field,r)}var i=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(t.indexOf(i.op)>=0)return i.op}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new h(u.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new h(u.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+i.toString()+"' filters.")}(e,p),p}(this.Ff,0,this.firestore.mf,this.firestore.__,o,i,r);return new e(function(e,t){var n=e.filters.concat([t]);return new Nn(e.path,e.collectionGroup,e.on.slice(),n,e.limit,e.an,e.startAt,e.endAt)}(this.Ff,a),this.firestore,this.d_)},e.prototype.orderBy=function(t,n){var r;if(L("Query.orderBy",arguments,1,2),D("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new h(u.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=js("Query.orderBy",t),o=function(e,t,n){if(null!==e.startAt)throw new h(u.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new h(u.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new fr(t,n);return function(e,t){if(null===Vn(e)){var n=jn(e);null!==n&&ll(0,n,t.field)}}(e,r),r}(this.Ff,i,r);return new e(function(e,t){var n=e.on.concat([t]);return new Nn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.an,e.startAt,e.endAt)}(this.Ff,o),this.firestore,this.d_)},e.prototype.limit=function(t){return R("Query.limit",arguments,1),k("Query.limit","number",1,t),W("Query.limit",1,t),new e(qn(this.Ff,t,"F"),this.firestore,this.d_)},e.prototype.limitToLast=function(t){return R("Query.limitToLast",arguments,1),k("Query.limitToLast","number",1,t),W("Query.limitToLast",1,t),new e(qn(this.Ff,t,"L"),this.firestore,this.d_)},e.prototype.startAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.startAt",arguments,1);var i=this.xf("Query.startAt",t,n,!0);return new e(Xn(this.Ff,i),this.firestore,this.d_)},e.prototype.startAfter=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.startAfter",arguments,1);var i=this.xf("Query.startAfter",t,n,!1);return new e(Xn(this.Ff,i),this.firestore,this.d_)},e.prototype.endBefore=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.endBefore",arguments,1);var i=this.xf("Query.endBefore",t,n,!0);return new e($n(this.Ff,i),this.firestore,this.d_)},e.prototype.endAt=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];P("Query.endAt",arguments,1);var i=this.xf("Query.endAt",t,n,!1);return new e($n(this.Ff,i),this.firestore,this.d_)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw G("isEqual","Query",1,t);return this.firestore===t.firestore&&Yn(this.Ff,t.Ff)&&this.d_===t.d_},e.prototype.withConverter=function(t){return new e(this.Ff,this.firestore,t)},e.prototype.xf=function(e,t,n,i){if(j(e,1,t),t instanceof il)return R(e,r.__spreadArrays([t],n),1),function(e,t,n,r,i){if(!r)throw new h(u.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Gn(e);a<s.length;a++){var l=s[a];if(l.field.p())o.push(ut(t,r.key));else{var c=r.field(l.field);if(Ke(c))throw new h(u.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var d=l.field.R();throw new h(u.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+d+"' (used as the orderBy) does not exist.")}o.push(c)}}return new cr(o,i)}(this.Ff,this.firestore.__,e,t.Df,i);var o=[t].concat(n);return function(e,t,n,r,i,o){var a=e.on;if(i.length>a.length)throw new h(u.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],l=0;l<i.length;l++){var c=i[l];if(a[l].field.p()){if("string"!=typeof c)throw new h(u.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Hn(e)&&-1!==c.indexOf("/"))throw new h(u.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var d=e.path.child(A.g(c));if(!C.F(d))throw new h(u.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+d+"' is not because it contains an odd number of segments.");var f=new C(d);s.push(ut(t,f))}else{var p=Us(n,r,c);s.push(p)}}return new cr(s,o)}(this.Ff,this.firestore.__,this.firestore.mf,e,o,i)},e.prototype.onSnapshot=function(){for(var e,t,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];L("Query.onSnapshot",arguments,1,4);var a={},s=0;if("object"!=typeof i[s]||Ys(i[s])||(H("Query.onSnapshot",a=i[s],["includeMetadataChanges"]),N("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),s++),Ys(i[s])){var l=i[s];i[s]=null===(e=l.next)||void 0===e?void 0:e.bind(l),i[s+1]=null===(t=l.error)||void 0===t?void 0:t.bind(l),i[s+2]=null===(n=l.complete)||void 0===n?void 0:n.bind(l)}else k("Query.onSnapshot","function",s,i[s]),D("Query.onSnapshot","function",s+1,i[s+1]),D("Query.onSnapshot","function",s+2,i[s+2]);var c={next:function(e){i[s]&&i[s](new hl(r.firestore,r.Ff,e,r.d_))},error:i[s+1],complete:i[s+2]};return cl(this.Ff),this.firestore.hf().listen(this.Ff,a,c)},e.prototype.get=function(e){var t=this;L("Query.get",arguments,0,1),ml("Query.get",e),cl(this.Ff);var n=this.firestore.hf();return(e&&"cache"===e.source?n.j_(this.Ff):n.K_(this.Ff,e)).then((function(e){return new hl(t.firestore,t.Ff,e,t.d_)}))},e}(),hl=function(){function e(e,t,n,r){this.yf=e,this.$f=t,this.kf=n,this.d_=r,this.Mf=null,this.Of=null,this.metadata=new rl(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.kf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.kf.docs.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;L("QuerySnapshot.forEach",arguments,1,2),k("QuerySnapshot.forEach","function",1,e),this.kf.docs.forEach((function(r){e.call(t,n.Lf(r,n.metadata.fromCache,n.kf.Wt.has(r.key)))}))},Object.defineProperty(e.prototype,"query",{get:function(){return new ul(this.$f,this.yf,this.d_)},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(e){e&&(H("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),N("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges));var t=!(!e||!e.includeMetadataChanges);if(t&&this.kf.Kt)throw new h(u.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Mf&&this.Of===t||(this.Mf=function(e,t,n){if(e.Qt.m()){var r=0;return e.docChanges.map((function(t){var i=n(t.doc,e.fromCache,e.Wt.has(t.doc.key));return t.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}}))}var i=e.Qt;return e.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var r=n(t.doc,e.fromCache,e.Wt.has(t.doc.key)),o=-1,a=-1;return 0!==t.type&&(o=i.indexOf(t.doc.key),i=i.delete(t.doc.key)),1!==t.type&&(a=(i=i.add(t.doc)).indexOf(t.doc.key)),{type:vl(t.type),doc:r,oldIndex:o,newIndex:a}}))}(this.kf,t,this.Lf.bind(this)),this.Of=t),this.Mf},e.prototype.isEqual=function(t){if(!(t instanceof e))throw G("isEqual","QuerySnapshot",1,t);return this.yf===t.yf&&Yn(this.$f,t.$f)&&this.kf.isEqual(t.kf)&&this.d_===t.d_},e.prototype.Lf=function(e,t,n){return new ol(this.yf,e.key,e,t,n,this.d_)},e}(),dl=function(e){function t(t,n,r){var i=this;if((i=e.call(this,Fn(t),n,r)||this).Bf=t,t.length%2!=1)throw new h(u.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return i}return r.__extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.Ff.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this.Ff.path.h();return e.m()?null:new nl(new C(e),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.Ff.path.R()},enumerable:!1,configurable:!0}),t.prototype.doc=function(e){L("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=Y.k()),k("CollectionReference.doc","non-empty string",1,e);var t=A.g(e);return nl.Rf(this.Ff.path.child(t),this.firestore,this.d_)},t.prototype.add=function(e){R("CollectionReference.add",arguments,1);var t=this.d_?this.d_.toFirestore(e):e;k("CollectionReference.add","object",1,t);var n=this.doc();return new nl(n.f_,this.firestore,null).set(t).then((function(){return n}))},t.prototype.withConverter=function(e){return new t(this.Bf,this.firestore,e)},t}(ul);function fl(e,t){if(void 0===t)return{merge:!1};if(H(e,t,["merge","mergeFields"]),N(e,"boolean","merge",t.merge),function(e,t,n,r){void 0!==r&&function(e,t,n,r,i){if(!(r instanceof Array))throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires its "+t+" option to be an array, but it was: "+V(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new h(u.INVALID_ARGUMENT,"Function "+e+"() requires all "+t+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+V(r[o]))}(e,"mergeFields",0,r,(function(e){return"string"==typeof e||e instanceof gs}))}(e,0,0,t.mergeFields),void 0!==t.mergeFields&&void 0!==t.merge)throw new h(u.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function pl(e,t){return void 0===t?{}:(H(e,t,["serverTimestamps"]),U(e,0,"serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function ml(e,t){D(e,"object",1,t),t&&(H(e,t,["source"]),U(e,0,"source",t.source,["default","server","cache"]))}function gl(e,t,n){if(t instanceof Cs){if(t.firestore!==n)throw new h(u.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw G(e,"DocumentReference",1,t)}function vl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}function yl(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var bl=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.serverTimestamp=function(){I("FieldValue.serverTimestamp",arguments);var e=new ws("serverTimestamp");return e.e_="FieldValue.serverTimestamp",new t(e)},t.delete=function(){I("FieldValue.delete",arguments);var e=new bs("deleteField");return e.e_="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];P("FieldValue.arrayUnion",arguments,1);var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P("arrayUnion()",arguments,1),new xs("arrayUnion",e)}.apply(void 0,e);return r.e_="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];P("FieldValue.arrayRemove",arguments,1);var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return P("arrayRemove()",arguments,1),new Ss("arrayRemove",e)}.apply(void 0,e);return r.e_="FieldValue.arrayRemove",new t(r)},t.increment=function(e){k("FieldValue.increment","number",1,e),R("FieldValue.increment",arguments,1);var n=function(e){return new Es("increment",e)}(e);return n.e_="FieldValue.increment",new t(n)},t.prototype.isEqual=function(e){return this.l_.isEqual(e.l_)},t}(Ms),_l={Firestore:Js,GeoPoint:As,Timestamp:se,Blob:re,Transaction:el,WriteBatch:tl,DocumentReference:nl,DocumentSnapshot:il,Query:ul,QueryDocumentSnapshot:ol,QuerySnapshot:hl,CollectionReference:dl,FieldPath:gs,FieldValue:bl,setLogLevel:Js.setLogLevel,CACHE_SIZE_UNLIMITED:Zs};!function(e){!function(e){e.INTERNAL.registerComponent(new l.Component("firestore",(function(e){return function(e,t){var n=new fs,r=new ds(n);return new Js(e,t,r,n)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},_l)))}(e),e.registerVersion("@firebase/firestore","1.18.0")}(c.default)},2477:(e,t,n)=>{"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(t),n.d(t,{LogLevel:()=>o,Logger:()=>h,setLogLevel:()=>d,setUserLogHandler:()=>f});var o,a=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},l=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),u=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString(),a=c[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[a].apply(console,r(["["+o+"]  "+e.name+":"],n))}},h=function(){function e(e){this.name=e,this._logLevel=l,this._logHandler=u,this._userLogHandler=null,a.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?s[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],e)),this._logHandler.apply(this,r([this,o.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],e)),this._logHandler.apply(this,r([this,o.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],e)),this._logHandler.apply(this,r([this,o.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],e)),this._logHandler.apply(this,r([this,o.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],e)),this._logHandler.apply(this,r([this,o.ERROR],e))},e}();function d(e){a.forEach((function(t){t.setLogLevel(e)}))}function f(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=s[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:o[n].toLowerCase(),message:s,args:i,type:t.name})}},r=0,i=a;r<i.length;r++)n(i[r])}},6336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5215),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,u=o>>2,h=(3&o)<<4|s>>4,d=(15&s)<<2|c>>6,f=63&c;l||(f=64,a||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,l=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==l)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var u=a<<4&240|s>>2;if(r.push(u),64!==l){var h=s<<6&192|l;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},c=function(e){try{return l.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=u(e[n],t[n]));return e}var h=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function f(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}var p=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(t,e),t}(Error),m=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?function(e,t){return e.replace(g,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",l=new p(i,s),c=0,u=Object.keys(r);c<u.length;c++){var h=u[c];"_"!==h.slice(-1)&&(h in l&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),l[h]=r[h])}return l},e}(),g=/\{\$([^}]+)}/g;function v(e){return JSON.parse(e)}var y=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=v(c(o[0])||""),n=v(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},b=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],l=this.chain_[1],c=this.chain_[2],u=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=u^l&(c^u),a=1518500249):(o=l^c^u,a=1859775393):r<60?(o=l&c|u&(l|c),a=2400959708):(o=l^c^u,a=3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=u,u=c,c=4294967295&(l<<30|l>>>2),l=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+u&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}(),_=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e){if("object"!=typeof e||null===e)return!1;for(var t=0,n=["next","error","complete"];t<n.length;t++){var r=n[t];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function w(){}function x(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e+" failed: "+(r+" argument ")}var S=144e5;t.CONSTANTS=i,t.Deferred=h,t.ErrorFactory=m,t.FirebaseError=p,t.MAX_VALUE_MILLIS=S,t.RANDOM_FACTOR=.5,t.Sha1=b,t.areCookiesEnabled=function(){return!(!navigator||!navigator.cookieEnabled)},t.assert=o,t.assertionError=a,t.async=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){e.apply(void 0,n)})).catch((function(e){t&&t(e)}))}},t.base64=l,t.base64Decode=c,t.base64Encode=function(e){var t=s(e);return l.encodeByteArray(t,!0)},t.calculateBackoffMillis=function(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=2);var r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(S,r+i)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new _(e,t);return n.subscribe.bind(n)},t.decode=y,t.deepCopy=function(e){return u(void 0,e)},t.deepExtend=u,t.errorPrefix=x,t.getUA=d,t.isAdmin=function(e){var t=y(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isBrowserExtension=function(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},t.isElectron=function(){return d().indexOf("Electron/")>=0},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){var e=d();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){return"indexedDB"in self&&null!=indexedDB},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())},t.isNode=f,t.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!f()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return d().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){var t=y(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=y(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){var t=y(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=v,t.map=function(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.querystring=function(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(x(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(x(e,t,r)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))},t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(x(e,t,r)+"must be a valid firebase namespace.")}},7036:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ErrorCode:()=>nr,EventType:()=>rr,WebChannel:()=>ir,XhrIo:()=>or,createWebChannelTransport:()=>tr,default:()=>ar});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var o,a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},s=s||{},l=a||self;function c(){}function u(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function h(e){var t=u(e);return"array"==t||"object"==t&&"number"==typeof e.length}function d(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var f="closure_uid_"+(1e9*Math.random()>>>0),p=0;function m(e,t,n){return e.call.apply(e.bind,arguments)}function g(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function v(e,t,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function y(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var b=Date.now;function _(e,t){function n(){}n.prototype=t.prototype,e.S=t.prototype,e.prototype=new n,e.prototype.constructor=e}function w(){this.j=this.j,this.i=this.i}w.prototype.j=!1,w.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(e){Object.prototype.hasOwnProperty.call(e,f)&&e[f]||(e[f]=++p)}(this)},w.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},S=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function E(e){return Array.prototype.concat.apply([],arguments)}function A(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function M(e){return/^[\s\xa0]*$/.test(e)}var T,C=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function I(e,t){return-1!=e.indexOf(t)}function R(e,t){return e<t?-1:e>t?1:0}e:{var P=l.navigator;if(P){var L=P.userAgent;if(L){T=L;break e}}T=""}function k(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function D(e){var t={};for(var n in e)t[n]=e[n];return t}var O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<O.length;o++)n=O[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function U(e){return U[" "](e),e}U[" "]=c;var F,z,B=I(T,"Opera"),V=I(T,"Trident")||I(T,"MSIE"),j=I(T,"Edge"),H=j||V,G=I(T,"Gecko")&&!(I(T.toLowerCase(),"webkit")&&!I(T,"Edge"))&&!(I(T,"Trident")||I(T,"MSIE"))&&!I(T,"Edge"),W=I(T.toLowerCase(),"webkit")&&!I(T,"Edge");function q(){var e=l.document;return e?e.documentMode:void 0}e:{var X="",$=(z=T,G?/rv:([^\);]+)(\)|;)/.exec(z):j?/Edge\/([\d\.]+)/.exec(z):V?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(z):W?/WebKit\/(\S+)/.exec(z):B?/(?:Version)[ \/]?(\S+)/.exec(z):void 0);if($&&(X=$?$[1]:""),V){var Y=q();if(null!=Y&&Y>parseFloat(X)){F=String(Y);break e}}F=X}var K,Z={};function Q(e){return function(e,t){var n=Z;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t()}(e,(function(){for(var t=0,n=C(String(F)).split("."),r=C(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=R(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||R(0==a[2].length,0==s[2].length)||R(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}l.document&&V?K=q()||parseInt(F,10)||void 0:K=void 0;var J=K,ee=!V||9<=Number(J),te=V&&!Q("9"),ne=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{l.addEventListener("test",c,t),l.removeEventListener("test",c,t)}catch(e){}return e}();function re(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}function ie(e,t){if(re.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(G){e:{try{U(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:oe[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}re.prototype.b=function(){this.defaultPrevented=!0},_(ie,re);var oe={2:"touch",3:"pen",4:"mouse"};ie.prototype.b=function(){ie.S.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,te)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}};var ae="closure_listenable_"+(1e6*Math.random()|0),se=0;function le(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ca=i,this.key=++se,this.Y=this.Z=!1}function ce(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.ca=null}function ue(e){this.src=e,this.a={},this.b=0}function he(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=x(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ce(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Y&&o.listener==t&&o.capture==!!n&&o.ca==r)return i}return-1}ue.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=de(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new le(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var fe="closure_lm_"+(1e6*Math.random()|0),pe={};function me(e,t,n,r,i){if(r&&r.once)return ve(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)me(e,t[o],n,r,i);return null}return n=Ae(n),e&&e[ae]?e.va(t,n,d(r)?!!r.capture:!!r,i):ge(e,t,n,!1,r,i)}function ge(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i;if(a&&!ee)return null;var s=Se(e);if(s||(e[fe]=s=new ue(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=xe,t=ee?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ne||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(_e(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ve(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)ve(e,t[o],n,r,i);return null}return n=Ae(n),e&&e[ae]?e.wa(t,n,d(r)?!!r.capture:!!r,i):ge(e,t,n,!0,r,i)}function ye(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)ye(e,t[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=Ae(n),e&&e[ae]?(e=e.c,(t=String(t).toString())in e.a&&-1<(n=de(o=e.a[t],n,r,i))&&(ce(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):e&&(e=Se(e))&&(t=e.a[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&be(n))}function be(e){if("number"!=typeof e&&e&&!e.Y){var t=e.src;if(t&&t[ae])he(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(_e(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Se(t))?(he(n,e),0==n.b&&(n.src=null,t[fe]=null)):ce(e)}}}function _e(e){return e in pe?pe[e]:pe[e]="on"+e}function we(e,t){var n=e.listener,r=e.ca||e.src;return e.Z&&be(e),n.call(r,t)}function xe(e,t){if(e.Y)return!0;if(!ee){if(!t)e:{t=["window","event"];for(var n=l,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return we(e,t=new ie(t,this))}return we(e,new ie(t,this))}function Se(e){return(e=e[fe])instanceof ue?e:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ae(e){return"function"==u(e)?e:(e[Ee]||(e[Ee]=function(t){return e.handleEvent(t)}),e[Ee])}function Me(){w.call(this),this.c=new ue(this),this.J=this,this.C=null}function Te(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,l=a.ca||a.src;a.Z&&he(e.c,a),i=!1!==s.call(l,r)&&i}}return i&&!r.defaultPrevented}_(Me,w),Me.prototype[ae]=!0,(o=Me.prototype).addEventListener=function(e,t,n,r){me(this,e,t,n,r)},o.removeEventListener=function(e,t,n,r){ye(this,e,t,n,r)},o.dispatchEvent=function(e){var t,n=this.C;if(n)for(t=[];n;n=n.C)t.push(n);n=this.J;var r=e.type||e;if("string"==typeof e)e=new re(e,n);else if(e instanceof re)e.target=e.target||n;else{var i=e;N(e=new re(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.a=t[o];i=Te(a,r,!0,e)&&i}if(i=Te(a=e.a=n,r,!0,e)&&i,i=Te(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=Te(a=e.a=t[o],r,!1,e)&&i;return i},o.G=function(){if(Me.S.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)ce(n[r]);delete t.a[e],t.b--}}this.C=null},o.va=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},o.wa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Ce=l.JSON.stringify;function Ie(){this.b=this.a=null}var Re,Pe=new(function(){function e(e,t,n){this.f=n,this.c=e,this.g=t,this.b=0,this.a=null}return e.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e},e}())((function(){return new ke}),(function(e){e.reset()}),100);function Le(){var e=Ue,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function ke(){this.next=this.b=this.a=null}function De(e){l.setTimeout((function(){throw e}),0)}function Oe(e,t){Re||function(){var e=l.Promise.resolve(void 0);Re=function(){e.then(Fe)}}(),Ne||(Re(),Ne=!0),Ue.add(e,t)}Ie.prototype.add=function(e,t){var n=Pe.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},ke.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},ke.prototype.reset=function(){this.next=this.b=this.a=null};var Ne=!1,Ue=new Ie;function Fe(){for(var e;e=Le();){try{e.a.call(e.b)}catch(e){De(e)}var t=Pe;t.g(e),t.b<t.f&&(t.b++,e.next=t.a,t.a=e)}Ne=!1}function ze(e,t){Me.call(this),this.b=e||1,this.a=t||l,this.f=v(this.Ya,this),this.g=b()}function Be(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}function Ve(e,t,n){if("function"==u(e))n&&(e=v(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=v(e.handleEvent,e)}return 2147483647<Number(t)?-1:l.setTimeout(e,t||0)}function je(e){e.a=Ve((function(){e.a=null,e.c&&(e.c=!1,je(e))}),e.h);var t=e.b;e.b=null,e.g.apply(null,t)}_(ze,Me),(o=ze.prototype).aa=!1,o.M=null,o.Ya=function(){if(this.aa){var e=b()-this.g;0<e&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Be(this),this.start()))}},o.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=b())},o.G=function(){ze.S.G.call(this),Be(this),delete this.a};var He=function(e){function t(t,n,r){var i=e.call(this)||this;return i.g=null!=r?t.bind(r):t,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.f=function(e){this.b=arguments,this.a?this.c=!0:je(this)},t.prototype.G=function(){e.prototype.G.call(this),this.a&&(l.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},t}(w);function Ge(e){w.call(this),this.b=e,this.a={}}_(Ge,w);var We=[];function qe(e,t,n,r){Array.isArray(n)||(n&&(We[0]=n.toString()),n=We);for(var i=0;i<n.length;i++){var o=me(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function Xe(e){k(e.a,(function(e,t){this.a.hasOwnProperty(t)&&be(e)}),e),e.a={}}function $e(){this.a=!0}function Ye(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Ce(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Ge.prototype.G=function(){Ge.S.G.call(this),Xe(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$e.prototype.info=function(){};var Ke=null;function Ze(){return Ke=Ke||new Me}function Qe(e){re.call(this,"serverreachability",e)}function Je(e){var t=Ze();t.dispatchEvent(new Qe(t,e))}function et(e){re.call(this,"statevent",e)}function tt(e){var t=Ze();t.dispatchEvent(new et(t,e))}function nt(e){re.call(this,"timingevent",e)}function rt(e,t){if("function"!=u(e))throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){e()}),t)}_(Qe,re),_(et,re),_(nt,re);var it={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},ot={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function at(){}function st(e){var t;return(t=e.a)||(t=e.a={}),t}function lt(){}at.prototype.a=null;var ct,ut={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ht(){re.call(this,"d")}function dt(){re.call(this,"c")}function ft(){}function pt(e,t,n,r){this.g=e,this.c=t,this.f=n,this.T=r||1,this.J=new Ge(this),this.P=mt,e=H?125:void 0,this.R=new ze(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}_(ht,re),_(dt,re),_(ft,at),ct=new ft;var mt=45e3,gt={},vt={};function yt(e,t,n){e.H=1,e.i=Bt(Dt(t)),e.j=n,e.I=!0,bt(e,null)}function bt(e,t){e.u=b(),xt(e),e.l=Dt(e.i);var n=e.l,r=e.T;Array.isArray(r)||(r=[String(r)]),Jt(n.b,"t",r),e.D=0,e.a=$n(e.g,e.g.C?t:null),0<e.O&&(e.F=new He(v(e.Ca,e,e.a),e.O)),qe(e.J,e.a,"readystatechange",e.Wa),t=e.B?D(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),Je(1),function(e,t,n,r,i,o){e.info((function(){if(e.a)if(o)for(var a="",s=o.split("&"),l=0;l<s.length;l++){var c=s[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");a=2<=h.length&&"type"==h[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a}))}(e.c,e.m,e.l,e.f,e.T,e.j)}function _t(e,t,n){for(var r=!0;!e.A&&e.D<n.length;){var i=wt(e,n);if(i==vt){4==t&&(e.h=4,tt(14),r=!1),Ye(e.c,e.f,null,"[Incomplete Response]");break}if(i==gt){e.h=4,tt(15),Ye(e.c,e.f,n,"[Invalid Chunk]"),r=!1;break}Ye(e.c,e.f,i,null),Tt(e,i)}4==t&&0==n.length&&(e.h=1,tt(16),r=!1),e.b=e.b&&r,r?0<n.length&&!e.W&&(e.W=!0,(t=e.g).a==e&&t.V&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bn(t),t.F=!0)):(Ye(e.c,e.f,n,"[Invalid Chunked Response]"),Mt(e),At(e))}function wt(e,t){var n=e.D,r=t.indexOf("\n",n);return-1==r?vt:(n=Number(t.substring(n,r)),isNaN(n)?gt:(r+=1)+n>t.length?vt:(t=t.substr(r,n),e.D=r+n,t))}function xt(e){e.U=b()+e.P,St(e,e.P)}function St(e,t){if(null!=e.o)throw Error("WatchDog timer not null");e.o=rt(v(e.Ua,e),t)}function Et(e){e.o&&(l.clearTimeout(e.o),e.o=null)}function At(e){0==e.g.v||e.A||Hn(e.g,e)}function Mt(e){Et(e);var t=e.F;t&&"function"==typeof t.ja&&t.ja(),e.F=null,Be(e.R),Xe(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ja())}function Tt(e,t){try{var n=e.g;if(0!=n.v&&(n.a==e||sn(n.b,e)))if(n.I=e.N,!e.C&&sn(n.b,e)&&3==n.v){try{var r=n.ka.a.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.j){if(n.a){if(!(n.a.u+3e3<e.u))break e;jn(n),Pn(n)}zn(n),tt(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=rt(v(n.Ra,n),6e3));if(1>=an(n.b)&&n.ea){try{n.ea()}catch(e){}n.ea=void 0}}else Wn(n,11)}else if((e.C||n.a==e)&&jn(n),!M(t))for(t=r=n.ka.a.parse(t),r=0;r<t.length;r++)if(i=t[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var a=i[4];null!=a&&(n.pa=a,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var l=1.5*s;n.D=l,n.c.info("backChannelRequestTimeoutMs_="+l)}l=n;var c=e.a;if(c){var u=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(u){var h=l.b;!h.a&&(I(u,"spdy")||I(u,"quic")||I(u,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(ln(h,h.b),h.b=null))}if(l.A){var d=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;d&&(l.na=d,zt(l.B,l.A,d))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=b()-e.u,n.c.info("Handshake RTT: "+n.N+"ms"));var f=e;if((l=n).la=Xn(l,l.C?l.ga:null,l.fa),f.C){cn(l.b,f);var p=f,m=l.D;m&&p.setTimeout(m),p.o&&(Et(p),xt(p)),l.a=f}else Fn(l);0<n.g.length&&Dn(n)}else"stop"!=i[0]&&"close"!=i[0]||Wn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Wn(n,7):Rn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Je(4)}catch(e){}}function Ct(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(h(e)||"string"==typeof e)S(e,t,void 0);else{if(e.L&&"function"==typeof e.L)var n=e.L();else if(e.K&&"function"==typeof e.K)n=void 0;else if(h(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.K&&"function"==typeof e.K)return e.K();if("string"==typeof e)return e.split("");if(h(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function It(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof It)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Rt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Pt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Pt(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Pt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(o=pt.prototype).setTimeout=function(e){this.P=e},o.Wa=function(e){e=e.target;var t=this.F;t&&3==Mn(e)?t.f():this.Ca(e)},o.Ca=function(e){try{if(e==this.a)e:{var t=Mn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>t||3==t&&!H&&!this.a.$())){this.A||4!=t||7==n||Je(8==n||0>=r?3:2),Et(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(e,t,n,r,i,o,a){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.T,t,i),this.b){if(this.V&&!this.C){t:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(a)){var l=a;break t}}l=null}if(!l){this.b=!1,this.h=3,tt(12),Mt(this),At(this);break e}Ye(this.c,this.f,l,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Tt(this,l)}this.I?(_t(this,t,o),H&&this.b&&3==t&&(qe(this.J,this.R,"tick",this.Va),this.R.start())):(Ye(this.c,this.f,o,null),Tt(this,o)),4==t&&Mt(this),this.b&&!this.A&&(4==t?Hn(this.g,this):(this.b=!1,xt(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,tt(12)):(this.h=0,tt(13)),Mt(this),At(this)}}}catch(e){}},o.Va=function(){if(this.a){var e=Mn(this.a),t=this.a.$();this.D<t.length&&(Et(this),_t(this,e,t),this.b&&4!=e&&xt(this))}},o.cancel=function(){this.A=!0,Mt(this)},o.Ua=function(){this.o=null;var e=b();0<=e-this.U?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.c,this.l),2!=this.H&&(Je(3),tt(17)),Mt(this),this.h=2,At(this)):St(this,this.U-e)},(o=It.prototype).K=function(){Rt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},o.L=function(){return Rt(this),this.a.concat()},o.get=function(e,t){return Pt(this.b,e)?this.b[e]:t},o.set=function(e,t){Pt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},o.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Lt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function kt(e,t){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof kt){this.a=void 0!==t?t:e.a,Ot(this,e.f),this.j=e.j,Nt(this,e.c),Ut(this,e.h),this.g=e.g,t=e.b;var n=new Yt;n.c=t.c,t.a&&(n.a=new It(t.a),n.b=t.b),Ft(this,n),this.i=e.i}else e&&(n=String(e).match(Lt))?(this.a=!!t,Ot(this,n[1]||"",!0),this.j=Vt(n[2]||""),Nt(this,n[3]||"",!0),Ut(this,n[4]),this.g=Vt(n[5]||"",!0),Ft(this,n[6]||"",!0),this.i=Vt(n[7]||"")):(this.a=!!t,this.b=new Yt(null,this.a))}function Dt(e){return new kt(e)}function Ot(e,t,n){e.f=n?Vt(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Nt(e,t,n){e.c=n?Vt(t,!0):t}function Ut(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.h=t}else e.h=null}function Ft(e,t,n){t instanceof Yt?(e.b=t,function(e,t){t&&!e.f&&(Kt(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Zt(this,t),Jt(this,n,e))}),e)),e.f=t}(e.b,e.a)):(n||(t=jt(t,Xt)),e.b=new Yt(t,e.a))}function zt(e,t,n){e.b.set(t,n)}function Bt(e){return zt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^b()).toString(36)),e}function Vt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function jt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Ht),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ht(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}kt.prototype.toString=function(){var e=[],t=this.f;t&&e.push(jt(t,Gt,!0),":");var n=this.c;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(jt(t,Gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&e.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&e.push("/"),e.push(jt(n,"/"==n.charAt(0)?qt:Wt,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",jt(n,$t)),e.join("")};var Gt=/[#\/\?@]/g,Wt=/[#\?:]/g,qt=/[#\?]/g,Xt=/[#\?@]/g,$t=/#/g;function Yt(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Kt(e){e.a||(e.a=new It,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Zt(e,t){Kt(e),t=en(e,t),Pt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Pt((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Rt(e)))}function Qt(e,t){return Kt(e),t=en(e,t),Pt(e.a.b,t)}function Jt(e,t,n){Zt(e,t),0<n.length&&(e.c=null,e.a.set(en(e,t),A(n)),e.b+=n.length)}function en(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function tn(e,t){this.b=e,this.a=t}function nn(e){this.g=e||rn,e=l.PerformanceNavigationTiming?0<(e=l.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(l.ia&&l.ia.ya&&l.ia.ya()&&l.ia.ya().qb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(o=Yt.prototype).add=function(e,t){Kt(this),this.c=null,e=en(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},o.forEach=function(e,t){Kt(this),this.a.forEach((function(n,r){S(n,(function(n){e.call(t,n,r,this)}),this)}),this)},o.L=function(){Kt(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},o.K=function(e){Kt(this);var t=[];if("string"==typeof e)Qt(this,e)&&(t=E(t,this.a.get(en(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=E(t,e[n])}return t},o.set=function(e,t){return Kt(this),this.c=null,Qt(this,e=en(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},o.get=function(e,t){return e&&0<(e=this.K(e)).length?String(e[0]):t},o.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var rn=10;function on(e){return!!e.b||!!e.a&&e.a.size>=e.f}function an(e){return e.b?1:e.a?e.a.size:0}function sn(e,t){return e.b?e.b==t:!!e.a&&e.a.has(t)}function ln(e,t){e.a?e.a.add(t):e.b=t}function cn(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}function un(e){var t,n;if(null!=e.b)return e.c.concat(e.b.s);if(null!=e.a&&0!==e.a.size){var r=e.c;try{for(var o=i(e.a.values()),a=o.next();!a.done;a=o.next()){var s=a.value;r=r.concat(s.s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}return A(e.c)}function hn(){}function dn(){this.a=new hn}function fn(e,t,n){var r=n||"";try{Ct(e,(function(e,n){var i=e;d(e)&&(i=Ce(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function pn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}nn.prototype.cancel=function(){var e,t;if(this.c=un(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=i(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},hn.prototype.stringify=function(e){return l.JSON.stringify(e,void 0)},hn.prototype.parse=function(e){return l.JSON.parse(e,void 0)};var mn=l.JSON.parse;function gn(e){Me.call(this),this.headers=new It,this.H=e||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=vn,this.D=this.F=!1}_(gn,Me);var vn="",yn=/^https?$/i,bn=["POST","PUT"];function _n(e){return"content-type"==e.toLowerCase()}function wn(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,xn(e),En(e)}function xn(e){e.u||(e.u=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Sn(e){if(e.b&&void 0!==s&&(!e.s[1]||4!=Mn(e)||2!=e.X()))if(e.l&&4==Mn(e))Ve(e.za,0,e);else if(e.dispatchEvent("readystatechange"),4==Mn(e)){e.b=!1;try{var t,n=e.X();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.B).match(Lt)[1]||null;if(!o&&l.self&&l.self.location){var a=l.self.location.protocol;o=a.substr(0,a.length-1)}i=!yn.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{e.h=6;try{var c=2<Mn(e)?e.a.statusText:""}catch(e){c=""}e.f=c+" ["+e.X()+"]",xn(e)}}finally{En(e)}}}function En(e,t){if(e.a){An(e);var n=e.a,r=e.s[0]?c:null;e.a=null,e.s=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){}}}function An(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(l.clearTimeout(e.m),e.m=null)}function Mn(e){return e.a?e.a.readyState:0}function Tn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return k(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):zt(e,t,n))}function Cn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function In(e){this.pa=0,this.g=[],this.c=new $e,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Cn("failFast",!1,e),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Cn("baseRetryDelayMs",5e3,e),this.Ma=Cn("retryDelaySeedMs",1e4,e),this.Ja=Cn("forwardChannelMaxRetries",2,e),this.ma=Cn("forwardChannelRequestTimeoutMs",2e4,e),this.Ka=e&&e.g||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new nn(e&&e.concurrentRequestLimit),this.ka=new dn,this.da=e&&e.fastHandshake||!1,this.Ga=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&e&&e.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Rn(e){if(Ln(e),3==e.v){var t=e.R++,n=Dt(e.B);zt(n,"SID",e.J),zt(n,"RID",t),zt(n,"TYPE","terminate"),Nn(e,n),(t=new pt(e,e.c,t,void 0)).H=2,t.i=Bt(Dt(n)),n=!1,l.navigator&&l.navigator.sendBeacon&&(n=l.navigator.sendBeacon(t.i.toString(),"")),!n&&l.Image&&((new Image).src=t.i,n=!0),n||(t.a=$n(t.g,null),t.a.ba(t.i)),t.u=b(),xt(t)}qn(e)}function Pn(e){e.a&&(Bn(e),e.a.cancel(),e.a=null)}function Ln(e){Pn(e),e.j&&(l.clearTimeout(e.j),e.j=null),jn(e),e.b.cancel(),e.h&&("number"==typeof e.h&&l.clearTimeout(e.h),e.h=null)}function kn(e,t){e.g.push(new tn(e.La++,t)),3==e.v&&Dn(e)}function Dn(e){on(e.b)||e.h||(e.h=!0,Oe(e.Ba,e),e.u=0)}function On(e,t){var n;n=t?t.f:e.R++;var r=Dt(e.B);zt(r,"SID",e.J),zt(r,"RID",n),zt(r,"AID",e.P),Nn(e,r),e.i&&e.l&&Tn(r,e.i,e.l),n=new pt(e,e.c,n,e.u+1),null===e.i&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=Un(e,n,1e3),n.setTimeout(Math.round(.5*e.ma)+Math.round(.5*e.ma*Math.random())),ln(e.b,n),yt(n,r,t)}function Nn(e,t){e.f&&Ct({},(function(e,n){zt(t,n,e)}))}function Un(e,t,n){n=Math.min(e.g.length,n);var r=e.f?v(e.f.Ha,e.f,e):null;e:for(var i=e.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,l=0;l<n;l++){var c=i[l].b,u=i[l].a;if(0>(c-=o))o=Math.max(0,i[l].b-100),s=!1;else try{fn(u,a,"req"+c+"_")}catch(e){r&&r(u)}}if(s){r=a.join("&");break e}}return e=e.g.splice(0,n),t.s=e,r}function Fn(e){e.a||e.j||(e.U=1,Oe(e.Aa,e),e.o=0)}function zn(e){return!(e.a||e.j||3<=e.o||(e.U++,e.j=rt(v(e.Aa,e),Gn(e,e.o)),e.o++,0))}function Bn(e){null!=e.s&&(l.clearTimeout(e.s),e.s=null)}function Vn(e){e.a=new pt(e,e.c,"rpc",e.U),null===e.i&&(e.a.B=e.l),e.a.O=0;var t=Dt(e.la);zt(t,"RID","rpc"),zt(t,"SID",e.J),zt(t,"CI",e.H?"0":"1"),zt(t,"AID",e.P),Nn(e,t),zt(t,"TYPE","xmlhttp"),e.i&&e.l&&Tn(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ga,n.H=1,n.i=Bt(Dt(t)),n.j=null,n.I=!0,bt(n,e)}function jn(e){null!=e.m&&(l.clearTimeout(e.m),e.m=null)}function Hn(e,t){var n=null;if(e.a==t){jn(e),Bn(e),e.a=null;var r=2}else{if(!sn(e.b,t))return;n=t.s,cn(e.b,t),r=1}if(e.I=t.N,0!=e.v)if(t.b)if(1==r){n=t.j?t.j.length:0,t=b()-t.u;var i=e.u;(r=Ze()).dispatchEvent(new nt(r,n,t,i)),Dn(e)}else Fn(e);else if(3==(i=t.h)||0==i&&0<e.I||!(1==r&&function(e,t){return!(an(e.b)>=e.b.f-(e.h?1:0)||(e.h?(e.g=t.s.concat(e.g),0):1==e.v||2==e.v||e.u>=(e.Ia?0:e.Ja)||(e.h=rt(v(e.Ba,e,t),Gn(e,e.u)),e.u++,0)))}(e,t)||2==r&&zn(e)))switch(n&&0<n.length&&(t=e.b,t.c=t.c.concat(n)),i){case 1:Wn(e,5);break;case 4:Wn(e,10);break;case 3:Wn(e,6);break;default:Wn(e,2)}}function Gn(e,t){var n=e.Fa+Math.floor(Math.random()*e.Ma);return e.f||(n*=2),n*t}function Wn(e,t){if(e.c.info("Error code "+t),2==t){var n=null;e.f&&(n=null);var r=v(e.Xa,e);n||(n=new kt("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Ot(n,"https"),Bt(n)),function(e,t){var n=new $e;if(l.Image){var r=new Image;r.onload=y(pn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=y(pn,n,r,"TestLoadImage: error",!1,t),r.onabort=y(pn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=y(pn,n,r,"TestLoadImage: timeout",!1,t),l.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else tt(2);e.v=0,e.f&&e.f.ra(t),qn(e),Ln(e)}function qn(e){e.v=0,e.I=-1,e.f&&(0==un(e.b).length&&0==e.g.length||(e.b.c.length=0,A(e.g),e.g.length=0),e.f.qa())}function Xn(e,t,n){var r=function(e){return e instanceof kt?Dt(e):new kt(e,void 0)}(n);if(""!=r.c)t&&Nt(r,t+"."+r.c),Ut(r,r.h);else{var i=l.location;r=function(e,t,n,r){var i=new kt(null,void 0);return e&&Ot(i,e),t&&Nt(i,t),n&&Ut(i,n),r&&(i.g=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.W&&k(e.W,(function(e,t){zt(r,t,e)})),t=e.A,n=e.na,t&&n&&zt(r,t,n),zt(r,"VER",e.ha),Nn(e,r),r}function $n(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new gn(e.Ka)).F=e.C,t}function Yn(){}function Kn(){if(V&&!(10<=Number(J)))throw Error("Environmental error: no available transport.")}function Zn(e,t){Me.call(this),this.a=new In(t),this.l=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!M(e)&&(this.a.i=e),this.h=t&&t.supportsCrossDomainXhr||!1,this.g=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!M(t)&&(this.a.A=t,null!==(e=this.b)&&t in e&&t in(e=this.b)&&delete e[t]),this.f=new er(this)}function Qn(e){ht.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function Jn(){dt.call(this),this.status=1}function er(e){this.a=e}(o=gn.prototype).ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?st(this.H):st(ct),this.a.onreadystatechange=v(this.za,this);try{this.A=!0,this.a.open(t,String(e),!0),this.A=!1}catch(e){return void wn(this,e)}e=n||"";var i=new It(this.headers);r&&Ct(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=_n,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.L()),n=l.FormData&&e instanceof l.FormData,!(0<=x(bn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{An(this),0<this.o&&((this.D=function(e){return V&&Q(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=v(this.xa,this)):this.m=Ve(this.xa,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(e){wn(this,e)}},o.xa=function(){void 0!==s&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},o.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),En(this))},o.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),En(this,!0)),gn.S.G.call(this)},o.za=function(){this.j||(this.A||this.l||this.g?Sn(this):this.Ta())},o.Ta=function(){Sn(this)},o.X=function(){try{return 2<Mn(this)?this.a.status:-1}catch(e){return-1}},o.$=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},o.Na=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),mn(t)}},o.ua=function(){return this.h},o.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(o=In.prototype).ha=8,o.v=1,o.Ba=function(e){if(this.h)if(this.h=null,1==this.v){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t,n=new pt(this,this.c,e,void 0),r=this.l;if(this.O&&(r?N(r=D(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)e:{for(var i=t=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.g.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Un(this,n,t),zt(i=Dt(this.B),"RID",e),zt(i,"CVER",22),this.A&&zt(i,"X-HTTP-Session-Id",this.A),Nn(this,i),this.i&&r&&Tn(i,this.i,r),ln(this.b,n),this.Ga&&zt(i,"TYPE","init"),this.da?(zt(i,"$req",t),zt(i,"SID","null"),n.V=!0,yt(n,i,null)):yt(n,i,t),this.v=2}}else 3==this.v&&(e?On(this,e):0==this.g.length||on(this.b)||On(this))},o.Aa=function(){if(this.j=null,Vn(this),this.V&&!(this.F||null==this.a||0>=this.N)){var e=2*this.N;this.c.info("BP detection timer enabled: "+e),this.s=rt(v(this.Sa,this),e)}},o.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Pn(this),Vn(this))},o.Ra=function(){null!=this.m&&(this.m=null,Pn(this),zn(this),tt(19))},o.Xa=function(e){e?(this.c.info("Successfully pinged google.com"),tt(2)):(this.c.info("Failed to ping google.com"),tt(1))},(o=Yn.prototype).ta=function(){},o.sa=function(){},o.ra=function(){},o.qa=function(){},o.Ha=function(){},Kn.prototype.a=function(e,t){return new Zn(e,t)},_(Zn,Me),(o=Zn.prototype).addEventListener=function(e,t,n,r){Zn.S.addEventListener.call(this,e,t,n,r)},o.removeEventListener=function(e,t,n,r){Zn.S.removeEventListener.call(this,e,t,n,r)},o.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var e=this.a,t=this.l,n=this.b||void 0;tt(0),e.fa=t,e.W=n||{},e.H=e.T,e.B=Xn(e,null,e.fa),Dn(e)},o.close=function(){Rn(this.a)},o.Pa=function(e){if("string"==typeof e){var t={};t.__data__=e,kn(this.a,t)}else this.g?((t={}).__data__=Ce(e),kn(this.a,t)):kn(this.a,e)},o.G=function(){this.a.f=null,delete this.f,Rn(this.a),delete this.a,Zn.S.G.call(this)},_(Qn,ht),_(Jn,dt),_(er,Yn),er.prototype.ta=function(){this.a.dispatchEvent("a")},er.prototype.sa=function(e){this.a.dispatchEvent(new Qn(e))},er.prototype.ra=function(e){this.a.dispatchEvent(new Jn(e))},er.prototype.qa=function(){this.a.dispatchEvent("b")},Kn.prototype.createWebChannel=Kn.prototype.a,Zn.prototype.send=Zn.prototype.Pa,Zn.prototype.open=Zn.prototype.Oa,Zn.prototype.close=Zn.prototype.close,it.NO_ERROR=0,it.TIMEOUT=8,it.HTTP_ERROR=6,ot.COMPLETE="complete",lt.EventType=ut,ut.OPEN="a",ut.CLOSE="b",ut.ERROR="c",ut.MESSAGE="d",Me.prototype.listen=Me.prototype.va,gn.prototype.listenOnce=gn.prototype.wa,gn.prototype.getLastError=gn.prototype.Qa,gn.prototype.getLastErrorCode=gn.prototype.ua,gn.prototype.getStatus=gn.prototype.X,gn.prototype.getResponseJson=gn.prototype.Na,gn.prototype.getResponseText=gn.prototype.$,gn.prototype.send=gn.prototype.ba;var tr=function(){return new Kn},nr=it,rr=ot,ir=lt,or=gn;const ar={createWebChannelTransport:tr,ErrorCode:it,EventType:ot,WebChannel:lt,XhrIo:gn}},982:(e,t,n)=>{"use strict";function r(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,{g:()=>In});const a=()=>{};let s={},l={},c=null,u={mark:a,measure:a};try{"undefined"!=typeof window&&(s=window),"undefined"!=typeof document&&(l=document),"undefined"!=typeof MutationObserver&&(c=MutationObserver),"undefined"!=typeof performance&&(u=performance)}catch(e){}const{userAgent:h=""}=s.navigator||{},d=s,f=l,p=c,m=u,g=(d.document,!!f.documentElement&&!!f.head&&"function"==typeof f.addEventListener&&"function"==typeof f.createElement),v=~h.indexOf("MSIE")||~h.indexOf("Trident/");var y={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},b=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],_="classic",w="duotone",x=[_,w,"sharp","sharp-duotone"],S=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),E=["fak","fa-kit","fakd","fa-kit-duotone"],A=["fak","fakd"],M={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},T=["fak","fa-kit","fakd","fa-kit-duotone"],C={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},I=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt","fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone","fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],R=[1,2,3,4,5,6,7,8,9,10],P=R.concat([11,12,13,14,15,16,17,18,19,20]),L=[...Object.keys({classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]}),"solid","regular","light","thin","duotone","brands","2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",M.GROUP,M.SWAP_OPACITY,M.PRIMARY,M.SECONDARY].concat(R.map((e=>"".concat(e,"x")))).concat(P.map((e=>"w-".concat(e))));const k="___FONT_AWESOME___",D=16,O="svg-inline--fa",N="data-fa-i2svg",U="data-fa-pseudo-element",F="data-prefix",z="data-icon",B="fontawesome-i2svg",V=["HTML","HEAD","STYLE","SCRIPT"],j=(()=>{try{return!0}catch(e){return!1}})();function H(e){return new Proxy(e,{get:(e,t)=>t in e?e[t]:e[_]})}const G=o({},y);G[_]=o(o(o(o({},{"fa-duotone":"duotone"}),y[_]),{fak:"kit","fa-kit":"kit"}),{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"});const W=H(G),q=o({},{classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}});q[_]=o(o(o(o({},{duotone:"fad"}),q[_]),{kit:"fak"}),{"kit-duotone":"fakd"});const X=H(q),$=o({},C);$[_]=o(o({},$[_]),{fak:"fa-kit"});const Y=H($),K=o({},{classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}});K[_]=o(o({},K[_]),{"fa-kit":"fak"}),H(K);const Z=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,Q="fa-layers-text",J=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,ee=(H(o({},{classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}})),["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"]),te="duotone-group",ne="primary",re="secondary",ie=["kit",...L],oe=d.FontAwesomeConfig||{};f&&"function"==typeof f.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach((e=>{let[t,n]=e;const r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=f.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t));null!=r&&(oe[n]=r)}));const ae={styleDefault:"solid",familyDefault:_,cssPrefix:"fa",replacementClass:O,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};oe.familyPrefix&&(oe.cssPrefix=oe.familyPrefix);const se=o(o({},ae),oe);se.autoReplaceSvg||(se.observeMutations=!1);const le={};Object.keys(ae).forEach((e=>{Object.defineProperty(le,e,{enumerable:!0,set:function(t){se[e]=t,ce.forEach((e=>e(le)))},get:function(){return se[e]}})})),Object.defineProperty(le,"familyPrefix",{enumerable:!0,set:function(e){se.cssPrefix=e,ce.forEach((e=>e(le)))},get:function(){return se.cssPrefix}}),d.FontAwesomeConfig=le;const ce=[],ue=D,he={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function de(){let e=12,t="";for(;e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function fe(e){const t=[];for(let n=(e||[]).length>>>0;n--;)t[n]=e[n];return t}function pe(e){return e.classList?fe(e.classList):(e.getAttribute("class")||"").split(" ").filter((e=>e))}function me(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ge(e){return Object.keys(e||{}).reduce(((t,n)=>t+"".concat(n,": ").concat(e[n].trim(),";")),"")}function ve(e){return e.size!==he.size||e.x!==he.x||e.y!==he.y||e.rotate!==he.rotate||e.flipX||e.flipY}function ye(){const e="fa",t=O,n=le.cssPrefix,r=le.replacementClass;let i=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";\n  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";\n  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";\n  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  transform: scale(var(--fa-counter-scale, 0.25));\n  transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(-1 * var(--fa-li-width, 2em));\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  animation-name: fa-beat;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  animation-name: fa-bounce;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  animation-name: fa-fade;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  animation-name: fa-beat-fade;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  animation-name: fa-flip;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  animation-name: fa-shake;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  animation-name: fa-spin;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 2s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  animation-name: fa-spin;\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    animation-delay: -1ms;\n    animation-duration: 1ms;\n    animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    transform: scale(1);\n  }\n  45% {\n    transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-shake {\n  0% {\n    transform: rotate(-15deg);\n  }\n  4% {\n    transform: rotate(15deg);\n  }\n  8%, 24% {\n    transform: rotate(-18deg);\n  }\n  12%, 28% {\n    transform: rotate(18deg);\n  }\n  16% {\n    transform: rotate(-22deg);\n  }\n  20% {\n    transform: rotate(22deg);\n  }\n  32% {\n    transform: rotate(-12deg);\n  }\n  36% {\n    transform: rotate(12deg);\n  }\n  40%, 100% {\n    transform: rotate(0deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  transform: rotate(var(--fa-rotate-angle, 0));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}';if(n!==e||r!==t){const o=new RegExp("\\.".concat(e,"\\-"),"g"),a=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(o,".".concat(n,"-")).replace(a,"--".concat(n,"-")).replace(s,".".concat(r))}return i}let be=!1;function _e(){le.autoAddCss&&!be&&(function(e){if(!e||!g)return;const t=f.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;const n=f.head.childNodes;let r=null;for(let e=n.length-1;e>-1;e--){const t=n[e],i=(t.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(i)>-1&&(r=t)}f.head.insertBefore(t,r)}(ye()),be=!0)}var we={mixout:()=>({dom:{css:ye,insertCss:_e}}),hooks:()=>({beforeDOMElementCreation(){_e()},beforeI2svg(){_e()}})};const xe=d||{};xe[k]||(xe[k]={}),xe[k].styles||(xe[k].styles={}),xe[k].hooks||(xe[k].hooks={}),xe[k].shims||(xe[k].shims=[]);var Se=xe[k];const Ee=[],Ae=function(){f.removeEventListener("DOMContentLoaded",Ae),Me=1,Ee.map((e=>e()))};let Me=!1;function Te(e){const{tag:t,attributes:n={},children:r=[]}=e;return"string"==typeof e?me(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(((t,n)=>t+"".concat(n,'="').concat(me(e[n]),'" ')),"").trim()}(n),">").concat(r.map(Te).join(""),"</").concat(t,">")}function Ce(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}g&&(Me=(f.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(f.readyState),Me||f.addEventListener("DOMContentLoaded",Ae));var Ie=function(e,t,n,r){var i,o,a,s=Object.keys(e),l=s.length,c=void 0!==r?function(e,t){return function(n,r,i,o){return e.call(t,n,r,i,o)}}(t,r):t;for(void 0===n?(i=1,a=e[s[0]]):(i=0,a=n);i<l;i++)a=c(a,e[o=s[i]],o,e);return a};function Re(e){const t=function(e){const t=[];let n=0;const r=e.length;for(;n<r;){const i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){const r=e.charCodeAt(n++);56320==(64512&r)?t.push(((1023&i)<<10)+(1023&r)+65536):(t.push(i),n--)}else t.push(i)}return t}(e);return 1===t.length?t[0].toString(16):null}function Pe(e){return Object.keys(e).reduce(((t,n)=>{const r=e[n];return r.icon?t[r.iconName]=r.icon:t[n]=r,t}),{})}function Le(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipHooks:r=!1}=n,i=Pe(t);"function"!=typeof Se.hooks.addPack||r?Se.styles[e]=o(o({},Se.styles[e]||{}),i):Se.hooks.addPack(e,Pe(t)),"fas"===e&&Le("fa",t)}const{styles:ke,shims:De}=Se,Oe=Object.keys(Y),Ne=Oe.reduce(((e,t)=>(e[t]=Object.keys(Y[t]),e)),{});let Ue=null,Fe={},ze={},Be={},Ve={},je={};const He=()=>{const e=e=>Ie(ke,((t,n,r)=>(t[r]=Ie(n,e,{}),t)),{});Fe=e(((e,t,n)=>(t[3]&&(e[t[3]]=n),t[2]&&t[2].filter((e=>"number"==typeof e)).forEach((t=>{e[t.toString(16)]=n})),e))),ze=e(((e,t,n)=>(e[n]=n,t[2]&&t[2].filter((e=>"string"==typeof e)).forEach((t=>{e[t]=n})),e))),je=e(((e,t,n)=>{const r=t[2];return e[n]=n,r.forEach((t=>{e[t]=n})),e}));const t="far"in ke||le.autoFetchSvg,n=Ie(De,((e,n)=>{const r=n[0];let i=n[1];const o=n[2];return"far"!==i||t||(i="fas"),"string"==typeof r&&(e.names[r]={prefix:i,iconName:o}),"number"==typeof r&&(e.unicodes[r.toString(16)]={prefix:i,iconName:o}),e}),{names:{},unicodes:{}});Be=n.names,Ve=n.unicodes,Ue=Ye(le.styleDefault,{family:le.familyDefault})};var Ge;function We(e,t){return(Fe[e]||{})[t]}function qe(e,t){return(je[e]||{})[t]}function Xe(e){return Be[e]||{prefix:null,iconName:null}}function $e(){return Ue}function Ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{family:n=_}=t,r=W[n][e];if(n===w&&!e)return"fad";const i=X[n][e]||X[n][r],o=e in Se.styles?e:null;return i||o||null}function Ke(e){return e.sort().filter(((e,t,n)=>n.indexOf(e)===t))}function Ze(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{skipLookups:n=!1}=t;let r=null;const i=I.concat(T),a=Ke(e.filter((e=>i.includes(e)))),s=Ke(e.filter((e=>!I.includes(e)))),l=a.filter((e=>(r=e,!b.includes(e)))),[c=null]=l,u=function(e){let t=_;const n=Oe.reduce(((e,t)=>(e[t]="".concat(le.cssPrefix,"-").concat(t),e)),{});return x.forEach((r=>{(e.includes(n[r])||e.some((e=>Ne[r].includes(e))))&&(t=r)})),t}(a),h=o(o({},function(e){let t=[],n=null;return e.forEach((e=>{const r=function(e,t){const n=t.split("-"),r=n[0],i=n.slice(1).join("-");return r!==e||""===i||function(e){return~ie.indexOf(e)}(i)?null:i}(le.cssPrefix,e);r?n=r:e&&t.push(e)})),{iconName:n,rest:t}}(s)),{},{prefix:Ye(c,{family:u})});return o(o(o({},h),function(e){const{values:t,family:n,canonical:r,givenPrefix:i="",styles:o={},config:a={}}=e,s=n===w,l=t.includes("fa-duotone")||t.includes("fad"),c="duotone"===a.familyDefault,u="fad"===r.prefix||"fa-duotone"===r.prefix;if(!s&&(l||c||u)&&(r.prefix="fad"),(t.includes("fa-brands")||t.includes("fab"))&&(r.prefix="fab"),!r.prefix&&Qe.includes(n)&&(Object.keys(o).find((e=>Je.includes(e)))||a.autoFetchSvg)){const e=S.get(n).defaultShortPrefixId;r.prefix=e,r.iconName=qe(r.prefix,r.iconName)||r.iconName}return"fa"!==r.prefix&&"fa"!==i||(r.prefix=$e()||"fas"),r}({values:e,family:u,styles:ke,config:le,canonical:h,givenPrefix:r})),function(e,t,n){let{prefix:r,iconName:i}=n;if(e||!r||!i)return{prefix:r,iconName:i};const o="fa"===t?Xe(i):{},a=qe(r,i);return i=o.iconName||a||i,r=o.prefix||r,"far"!==r||ke.far||!ke.fas||le.autoFetchSvg||(r="fas"),{prefix:r,iconName:i}}(n,r,h))}Ge=e=>{Ue=Ye(e.styleDefault,{family:le.familyDefault})},ce.push(Ge),He();const Qe=x.filter((e=>e!==_||e!==w)),Je=Object.keys(C).filter((e=>e!==_)).map((e=>Object.keys(C[e]))).flat();let et=[],tt={};const nt={},rt=Object.keys(nt);function it(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return(tt[e]||[]).forEach((e=>{t=e.apply(null,[t,...r])})),t}function ot(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(tt[e]||[]).forEach((e=>{e.apply(null,n)}))}function at(){const e=arguments[0],t=Array.prototype.slice.call(arguments,1);return nt[e]?nt[e].apply(null,t):void 0}function st(e){"fa"===e.prefix&&(e.prefix="fas");let{iconName:t}=e;const n=e.prefix||$e();if(t)return t=qe(n,t)||t,Ce(lt.definitions,n,t)||Ce(Se.styles,n,t)}const lt=new class{constructor(){this.definitions={}}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(this._pullDefinitions,{});Object.keys(r).forEach((e=>{this.definitions[e]=o(o({},this.definitions[e]||{}),r[e]),Le(e,r[e]);const t=Y[_][e];t&&Le(t,r[e]),He()}))}reset(){this.definitions={}}_pullDefinitions(e,t){const n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map((t=>{const{prefix:r,iconName:i,icon:o}=n[t],a=o[2];e[r]||(e[r]={}),a.length>0&&a.forEach((t=>{"string"==typeof t&&(e[r][t]=o)})),e[r][i]=o})),e}},ct={i2svg:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return g?(ot("beforeI2svg",e),at("pseudoElements2svg",e),at("i2svg",e)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoReplaceSvgRoot:t}=e;var n;!1===le.autoReplaceSvg&&(le.autoReplaceSvg=!0),le.observeMutations=!0,n=()=>{dt({autoReplaceSvgRoot:t}),ot("watch",e)},g&&(Me?setTimeout(n,0):Ee.push(n))}},ut={icon:e=>{if(null===e)return null;if("object"==typeof e&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:qe(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){const t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Ye(e[0]);return{prefix:n,iconName:qe(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(le.cssPrefix,"-"))>-1||e.match(Z))){const t=Ze(e.split(" "),{skipLookups:!0});return{prefix:t.prefix||$e(),iconName:qe(t.prefix,t.iconName)||t.iconName}}if("string"==typeof e){const t=$e();return{prefix:t,iconName:qe(t,e)||e}}}},ht={noAuto:()=>{le.autoReplaceSvg=!1,le.observeMutations=!1,ot("noAuto")},config:le,dom:ct,parse:ut,library:lt,findIconDefinition:st,toHtml:Te},dt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoReplaceSvgRoot:t=f}=e;(Object.keys(Se.styles).length>0||le.autoFetchSvg)&&g&&le.autoReplaceSvg&&ht.dom.i2svg({node:t})};function ft(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map((e=>Te(e)))}}),Object.defineProperty(e,"node",{get:function(){if(!g)return;const t=f.createElement("div");return t.innerHTML=e.html,t.children}}),e}function pt(e){const{icons:{main:t,mask:n},prefix:r,iconName:i,transform:a,symbol:s,title:l,maskId:c,titleId:u,extra:h,watchable:d=!1}=e,{width:f,height:p}=n.found?n:t,m=A.includes(r),g=[le.replacementClass,i?"".concat(le.cssPrefix,"-").concat(i):""].filter((e=>-1===h.classes.indexOf(e))).filter((e=>""!==e||!!e)).concat(h.classes).join(" ");let v={children:[],attributes:o(o({},h.attributes),{},{"data-prefix":r,"data-icon":i,class:g,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(f," ").concat(p)})};const y=m&&!~h.classes.indexOf("fa-fw")?{width:"".concat(f/p*16*.0625,"em")}:{};d&&(v.attributes[N]=""),l&&(v.children.push({tag:"title",attributes:{id:v.attributes["aria-labelledby"]||"title-".concat(u||de())},children:[l]}),delete v.attributes.title);const b=o(o({},v),{},{prefix:r,iconName:i,main:t,mask:n,maskId:c,transform:a,symbol:s,styles:o(o({},y),h.styles)}),{children:_,attributes:w}=n.found&&t.found?at("generateAbstractMask",b)||{children:[],attributes:{}}:at("generateAbstractIcon",b)||{children:[],attributes:{}};return b.children=_,b.attributes=w,s?function(e){let{prefix:t,iconName:n,children:r,attributes:i,symbol:a}=e;const s=!0===a?"".concat(t,"-").concat(le.cssPrefix,"-").concat(n):a;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:o(o({},i),{},{id:s}),children:r}]}]}(b):function(e){let{children:t,main:n,mask:r,attributes:i,styles:a,transform:s}=e;if(ve(s)&&n.found&&!r.found){const{width:e,height:t}=n,r={x:e/t/2,y:.5};i.style=ge(o(o({},a),{},{"transform-origin":"".concat(r.x+s.x/16,"em ").concat(r.y+s.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(b)}function mt(e){const{content:t,width:n,height:r,transform:i,title:a,extra:s,watchable:l=!1}=e,c=o(o(o({},s.attributes),a?{title:a}:{}),{},{class:s.classes.join(" ")});l&&(c[N]="");const u=o({},s.styles);ve(i)&&(u.transform=function(e){let{transform:t,width:n=D,height:r=D,startCentered:i=!1}=e,o="";return o+=i&&v?"translate(".concat(t.x/ue-n/2,"em, ").concat(t.y/ue-r/2,"em) "):i?"translate(calc(-50% + ".concat(t.x/ue,"em), calc(-50% + ").concat(t.y/ue,"em)) "):"translate(".concat(t.x/ue,"em, ").concat(t.y/ue,"em) "),o+="scale(".concat(t.size/ue*(t.flipX?-1:1),", ").concat(t.size/ue*(t.flipY?-1:1),") "),o+="rotate(".concat(t.rotate,"deg) "),o}({transform:i,startCentered:!0,width:n,height:r}),u["-webkit-transform"]=u.transform);const h=ge(u);h.length>0&&(c.style=h);const d=[];return d.push({tag:"span",attributes:c,children:[t]}),a&&d.push({tag:"span",attributes:{class:"sr-only"},children:[a]}),d}const{styles:gt}=Se;function vt(e){const t=e[0],n=e[1],[r]=e.slice(4);let i=null;return i=Array.isArray(r)?{tag:"g",attributes:{class:"".concat(le.cssPrefix,"-").concat(te)},children:[{tag:"path",attributes:{class:"".concat(le.cssPrefix,"-").concat(re),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(le.cssPrefix,"-").concat(ne),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}},{found:!0,width:t,height:n,icon:i}}const yt={found:!1,width:512,height:512};function bt(e,t){let n=t;return"fa"===t&&null!==le.styleDefault&&(t=$e()),new Promise(((r,i)=>{if("fa"===n){const n=Xe(e)||{};e=n.iconName||e,t=n.prefix||t}if(e&&t&&gt[t]&&gt[t][e])return r(vt(gt[t][e]));!function(e,t){j||le.showMissingIcons||!e||console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))}(e,t),r(o(o({},yt),{},{icon:le.showMissingIcons&&e&&at("missingIconAbstract")||{}}))}))}const _t=()=>{},wt=le.measurePerformance&&m&&m.mark&&m.measure?m:{mark:_t,measure:_t},xt='FA "6.7.1"';var St=e=>(wt.mark("".concat(xt," ").concat(e," begins")),()=>(e=>{wt.mark("".concat(xt," ").concat(e," ends")),wt.measure("".concat(xt," ").concat(e),"".concat(xt," ").concat(e," begins"),"".concat(xt," ").concat(e," ends"))})(e));const Et=()=>{};function At(e){return"string"==typeof(e.getAttribute?e.getAttribute(N):null)}function Mt(e){return f.createElementNS("http://www.w3.org/2000/svg",e)}function Tt(e){return f.createElement(e)}function Ct(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{ceFn:n=("svg"===e.tag?Mt:Tt)}=t;if("string"==typeof e)return f.createTextNode(e);const r=n(e.tag);return Object.keys(e.attributes||[]).forEach((function(t){r.setAttribute(t,e.attributes[t])})),(e.children||[]).forEach((function(e){r.appendChild(Ct(e,{ceFn:n}))})),r}const It={replace:function(e){const t=e[0];if(t.parentNode)if(e[1].forEach((e=>{t.parentNode.insertBefore(Ct(e),t)})),null===t.getAttribute(N)&&le.keepOriginalSource){let e=f.createComment(function(e){let t=" ".concat(e.outerHTML," ");return t="".concat(t,"Font Awesome fontawesome.com "),t}(t));t.parentNode.replaceChild(e,t)}else t.remove()},nest:function(e){const t=e[0],n=e[1];if(~pe(t).indexOf(le.replacementClass))return It.replace(e);const r=new RegExp("".concat(le.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){const e=n[0].attributes.class.split(" ").reduce(((e,t)=>(t===le.replacementClass||t.match(r)?e.toSvg.push(t):e.toNode.push(t),e)),{toNode:[],toSvg:[]});n[0].attributes.class=e.toSvg.join(" "),0===e.toNode.length?t.removeAttribute("class"):t.setAttribute("class",e.toNode.join(" "))}const i=n.map((e=>Te(e))).join("\n");t.setAttribute(N,""),t.innerHTML=i}};function Rt(e){e()}function Pt(e,t){const n="function"==typeof t?t:Et;if(0===e.length)n();else{let t=Rt;"async"===le.mutateApproach&&(t=d.requestAnimationFrame||Rt),t((()=>{const t=!0===le.autoReplaceSvg?It.replace:It[le.autoReplaceSvg]||It.replace,r=St("mutate");e.map(t),r(),n()}))}}let Lt=!1;function kt(){Lt=!0}function Dt(){Lt=!1}let Ot=null;function Nt(e){if(!p)return;if(!le.observeMutations)return;const{treeCallback:t=Et,nodeCallback:n=Et,pseudoElementsCallback:r=Et,observeMutationsRoot:i=f}=e;Ot=new p((e=>{if(Lt)return;const i=$e();fe(e).forEach((e=>{if("childList"===e.type&&e.addedNodes.length>0&&!At(e.addedNodes[0])&&(le.searchPseudoElements&&r(e.target),t(e.target)),"attributes"===e.type&&e.target.parentNode&&le.searchPseudoElements&&r(e.target.parentNode),"attributes"===e.type&&At(e.target)&&~ee.indexOf(e.attributeName))if("class"===e.attributeName&&function(e){const t=e.getAttribute?e.getAttribute(F):null,n=e.getAttribute?e.getAttribute(z):null;return t&&n}(e.target)){const{prefix:t,iconName:n}=Ze(pe(e.target));e.target.setAttribute(F,t||i),n&&e.target.setAttribute(z,n)}else(o=e.target)&&o.classList&&o.classList.contains&&o.classList.contains(le.replacementClass)&&n(e.target);var o}))})),g&&Ot.observe(i,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function Ut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0};const{iconName:n,prefix:r,rest:i}=function(e){const t=e.getAttribute("data-prefix"),n=e.getAttribute("data-icon"),r=void 0!==e.innerText?e.innerText.trim():"";let i=Ze(pe(e));return i.prefix||(i.prefix=$e()),t&&n&&(i.prefix=t,i.iconName=n),i.iconName&&i.prefix||(i.prefix&&r.length>0&&(i.iconName=(o=i.prefix,a=e.innerText,(ze[o]||{})[a]||We(i.prefix,Re(e.innerText)))),!i.iconName&&le.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=e.firstChild.data)),i;var o,a}(e),a=function(e){const t=fe(e.attributes).reduce(((e,t)=>("class"!==e.name&&"style"!==e.name&&(e[t.name]=t.value),e)),{}),n=e.getAttribute("title"),r=e.getAttribute("data-fa-title-id");return le.autoA11y&&(n?t["aria-labelledby"]="".concat(le.replacementClass,"-title-").concat(r||de()):(t["aria-hidden"]="true",t.focusable="false")),t}(e),s=it("parseNodeAttributes",{},e);let l=t.styleParser?function(e){const t=e.getAttribute("style");let n=[];return t&&(n=t.split(";").reduce(((e,t)=>{const n=t.split(":"),r=n[0],i=n.slice(1);return r&&i.length>0&&(e[r]=i.join(":").trim()),e}),{})),n}(e):[];return o({iconName:n,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:r,transform:he,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:l,attributes:a}},s)}const{styles:Ft}=Se;function zt(e){const t="nest"===le.autoReplaceSvg?Ut(e,{styleParser:!1}):Ut(e);return~t.extra.classes.indexOf(Q)?at("generateLayersText",e,t):at("generateSvgReplacementMutation",e,t)}function Bt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!g)return Promise.resolve();const n=f.documentElement.classList,r=e=>n.add("".concat(B,"-").concat(e)),i=e=>n.remove("".concat(B,"-").concat(e)),o=le.autoFetchSvg?[...E,...I]:b.concat(Object.keys(Ft));o.includes("fa")||o.push("fa");const a=[".".concat(Q,":not([").concat(N,"])")].concat(o.map((e=>".".concat(e,":not([").concat(N,"])")))).join(", ");if(0===a.length)return Promise.resolve();let s=[];try{s=fe(e.querySelectorAll(a))}catch(e){}if(!(s.length>0))return Promise.resolve();r("pending"),i("complete");const l=St("onTree"),c=s.reduce(((e,t)=>{try{const n=zt(t);n&&e.push(n)}catch(e){j||"MissingIcon"===e.name&&console.error(e)}return e}),[]);return new Promise(((e,n)=>{Promise.all(c).then((n=>{Pt(n,(()=>{r("active"),r("complete"),i("pending"),"function"==typeof t&&t(),l(),e()}))})).catch((e=>{l(),n(e)}))}))}function Vt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;zt(e).then((e=>{e&&Pt([e],t)}))}const jt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:n=he,symbol:r=!1,mask:i=null,maskId:a=null,title:s=null,titleId:l=null,classes:c=[],attributes:u={},styles:h={}}=t;if(!e)return;const{prefix:d,iconName:f,icon:p}=e;return ft(o({type:"icon"},e),(()=>(ot("beforeDOMElementCreation",{iconDefinition:e,params:t}),le.autoA11y&&(s?u["aria-labelledby"]="".concat(le.replacementClass,"-title-").concat(l||de()):(u["aria-hidden"]="true",u.focusable="false")),pt({icons:{main:vt(p),mask:i?vt(i.icon):{found:!1,width:null,height:null,icon:{}}},prefix:d,iconName:f,transform:o(o({},he),n),symbol:r,title:s,maskId:a,titleId:l,extra:{attributes:u,styles:h,classes:c}}))))};var Ht={mixout(){return{icon:(e=jt,function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=(t||{}).icon?t:st(t||{});let{mask:i}=n;return i&&(i=(i||{}).icon?i:st(i||{})),e(r,o(o({},n),{},{mask:i}))})};var e},hooks:()=>({mutationObserverCallbacks:e=>(e.treeCallback=Bt,e.nodeCallback=Vt,e)}),provides(e){e.i2svg=function(e){const{node:t=f,callback:n=()=>{}}=e;return Bt(t,n)},e.generateSvgReplacementMutation=function(e,t){const{iconName:n,title:r,titleId:i,prefix:o,transform:a,symbol:s,mask:l,maskId:c,extra:u}=t;return new Promise(((t,h)=>{Promise.all([bt(n,o),l.iconName?bt(l.iconName,l.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then((l=>{let[h,d]=l;t([e,pt({icons:{main:h,mask:d},prefix:o,iconName:n,transform:a,symbol:s,maskId:c,title:r,titleId:i,extra:u,watchable:!0})])})).catch(h)}))},e.generateAbstractIcon=function(e){let{children:t,attributes:n,main:r,transform:i,styles:o}=e;const a=ge(o);let s;return a.length>0&&(n.style=a),ve(i)&&(s=at("generateAbstractTransformGrouping",{main:r,transform:i,containerWidth:r.width,iconWidth:r.width})),t.push(s||r.icon),{children:t,attributes:n}}}},Gt={mixout:()=>({layer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{classes:n=[]}=t;return ft({type:"layer"},(()=>{ot("beforeDOMElementCreation",{assembler:e,params:t});let r=[];return e((e=>{Array.isArray(e)?e.map((e=>{r=r.concat(e.abstract)})):r=r.concat(e.abstract)})),[{tag:"span",attributes:{class:["".concat(le.cssPrefix,"-layers"),...n].join(" ")},children:r}]}))}})},Wt={mixout:()=>({counter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{title:n=null,classes:r=[],attributes:i={},styles:a={}}=t;return ft({type:"counter",content:e},(()=>(ot("beforeDOMElementCreation",{content:e,params:t}),function(e){const{content:t,title:n,extra:r}=e,i=o(o(o({},r.attributes),n?{title:n}:{}),{},{class:r.classes.join(" ")}),a=ge(r.styles);a.length>0&&(i.style=a);const s=[];return s.push({tag:"span",attributes:i,children:[t]}),n&&s.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),s}({content:e.toString(),title:n,extra:{attributes:i,styles:a,classes:["".concat(le.cssPrefix,"-layers-counter"),...r]}}))))}})},qt={mixout:()=>({text(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:n=he,title:r=null,classes:i=[],attributes:a={},styles:s={}}=t;return ft({type:"text",content:e},(()=>(ot("beforeDOMElementCreation",{content:e,params:t}),mt({content:e,transform:o(o({},he),n),title:r,extra:{attributes:a,styles:s,classes:["".concat(le.cssPrefix,"-layers-text"),...i]}}))))}}),provides(e){e.generateLayersText=function(e,t){const{title:n,transform:r,extra:i}=t;let o=null,a=null;if(v){const t=parseInt(getComputedStyle(e).fontSize,10),n=e.getBoundingClientRect();o=n.width/t,a=n.height/t}return le.autoA11y&&!n&&(i.attributes["aria-hidden"]="true"),Promise.resolve([e,mt({content:e.innerHTML,width:o,height:a,transform:r,title:n,extra:i,watchable:!0})])}}};const Xt=new RegExp('"',"ug"),$t=[1105920,1112319],Yt=o(o(o(o({},{FontAwesome:{normal:"fas",400:"fas"}}),{"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}}),{"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}}),{"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}}),Kt=Object.keys(Yt).reduce(((e,t)=>(e[t.toLowerCase()]=Yt[t],e)),{}),Zt=Object.keys(Kt).reduce(((e,t)=>{const n=Kt[t];return e[t]=n[900]||[...Object.entries(n)][0][1],e}),{});function Qt(e,t){const n="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(((r,i)=>{if(null!==e.getAttribute(n))return r();const a=fe(e.children).filter((e=>e.getAttribute(U)===t))[0],s=d.getComputedStyle(e,t),l=s.getPropertyValue("font-family"),c=l.match(J),u=s.getPropertyValue("font-weight"),h=s.getPropertyValue("content");if(a&&!c)return e.removeChild(a),r();if(c&&"none"!==h&&""!==h){const h=s.getPropertyValue("content");let d=function(e,t){const n=e.replace(/^['"]|['"]$/g,"").toLowerCase(),r=parseInt(t),i=isNaN(r)?"normal":r;return(Kt[n]||{})[i]||Zt[n]}(l,u);const{value:p,isSecondary:m}=function(e){const t=e.replace(Xt,""),n=function(e){const t=e.length;let n,r=e.charCodeAt(0);return r>=55296&&r<=56319&&t>1&&(n=e.charCodeAt(1),n>=56320&&n<=57343)?1024*(r-55296)+n-56320+65536:r}(t),r=n>=$t[0]&&n<=$t[1],i=2===t.length&&t[0]===t[1];return{value:Re(i?t[0]:t),isSecondary:r||i}}(h),g=c[0].startsWith("FontAwesome");let v=We(d,p),y=v;if(g){const e=function(e){const t=Ve[e],n=We("fas",e);return t||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}(p);e.iconName&&e.prefix&&(v=e.iconName,d=e.prefix)}if(!v||m||a&&a.getAttribute(F)===d&&a.getAttribute(z)===y)r();else{e.setAttribute(n,y),a&&e.removeChild(a);const s={iconName:null,title:null,titleId:null,prefix:null,transform:he,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}},{extra:l}=s;l.attributes[U]=t,bt(v,d).then((i=>{const a=pt(o(o({},s),{},{icons:{main:i,mask:{prefix:null,iconName:null,rest:[]}},prefix:d,iconName:y,extra:l,watchable:!0})),c=f.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===t?e.insertBefore(c,e.firstChild):e.appendChild(c),c.outerHTML=a.map((e=>Te(e))).join("\n"),e.removeAttribute(n),r()})).catch(i)}}else r()}))}function Jt(e){return Promise.all([Qt(e,"::before"),Qt(e,"::after")])}function en(e){return!(e.parentNode===document.head||~V.indexOf(e.tagName.toUpperCase())||e.getAttribute(U)||e.parentNode&&"svg"===e.parentNode.tagName)}function tn(e){if(g)return new Promise(((t,n)=>{const r=fe(e.querySelectorAll("*")).filter(en).map(Jt),i=St("searchPseudoElements");kt(),Promise.all(r).then((()=>{i(),Dt(),t()})).catch((()=>{i(),Dt(),n()}))}))}var nn={hooks:()=>({mutationObserverCallbacks:e=>(e.pseudoElementsCallback=tn,e)}),provides(e){e.pseudoElements2svg=function(e){const{node:t=f}=e;le.searchPseudoElements&&tn(t)}}};let rn=!1;var on={mixout:()=>({dom:{unwatch(){kt(),rn=!0}}}),hooks:()=>({bootstrap(){Nt(it("mutationObserverCallbacks",{}))},noAuto(){Ot&&Ot.disconnect()},watch(e){const{observeMutationsRoot:t}=e;rn?Dt():Nt(it("mutationObserverCallbacks",{observeMutationsRoot:t}))}})};const an=e=>e.toLowerCase().split(" ").reduce(((e,t)=>{const n=t.toLowerCase().split("-"),r=n[0];let i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e}),{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0});var sn={mixout:()=>({parse:{transform:e=>an(e)}}),hooks:()=>({parseNodeAttributes(e,t){const n=t.getAttribute("data-fa-transform");return n&&(e.transform=an(n)),e}}),provides(e){e.generateAbstractTransformGrouping=function(e){let{main:t,transform:n,containerWidth:r,iconWidth:i}=e;const a={transform:"translate(".concat(r/2," 256)")},s="translate(".concat(32*n.x,", ").concat(32*n.y,") "),l="scale(".concat(n.size/16*(n.flipX?-1:1),", ").concat(n.size/16*(n.flipY?-1:1),") "),c="rotate(".concat(n.rotate," 0 0)"),u={outer:a,inner:{transform:"".concat(s," ").concat(l," ").concat(c)},path:{transform:"translate(".concat(i/2*-1," -256)")}};return{tag:"g",attributes:o({},u.outer),children:[{tag:"g",attributes:o({},u.inner),children:[{tag:t.icon.tag,children:t.icon.children,attributes:o(o({},t.icon.attributes),u.path)}]}]}}}};const ln={x:0,y:0,width:"100%",height:"100%"};function cn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}var un={hooks:()=>({parseNodeAttributes(e,t){const n=t.getAttribute("data-fa-mask"),r=n?Ze(n.split(" ").map((e=>e.trim()))):{prefix:null,iconName:null,rest:[]};return r.prefix||(r.prefix=$e()),e.mask=r,e.maskId=t.getAttribute("data-fa-mask-id"),e}}),provides(e){e.generateAbstractMask=function(e){let{children:t,attributes:n,main:r,mask:i,maskId:a,transform:s}=e;const{width:l,icon:c}=r,{width:u,icon:h}=i,d=function(e){let{transform:t,containerWidth:n,iconWidth:r}=e;const i={transform:"translate(".concat(n/2," 256)")},o="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),s="rotate(".concat(t.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(a," ").concat(s)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:s,containerWidth:u,iconWidth:l}),f={tag:"rect",attributes:o(o({},ln),{},{fill:"white"})},p=c.children?{children:c.children.map(cn)}:{},m={tag:"g",attributes:o({},d.inner),children:[cn(o({tag:c.tag,attributes:o(o({},c.attributes),d.path)},p))]},g={tag:"g",attributes:o({},d.outer),children:[m]},v="mask-".concat(a||de()),y="clip-".concat(a||de()),b={tag:"mask",attributes:o(o({},ln),{},{id:v,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[f,g]},_={tag:"defs",children:[{tag:"clipPath",attributes:{id:y},children:(w=h,"g"===w.tag?w.children:[w])},b]};var w;return t.push(_,{tag:"rect",attributes:o({fill:"currentColor","clip-path":"url(#".concat(y,")"),mask:"url(#".concat(v,")")},ln)}),{children:t,attributes:n}}}},hn={provides(e){let t=!1;d.matchMedia&&(t=d.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){const e=[],n={fill:"currentColor"},r={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};e.push({tag:"path",attributes:o(o({},n),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const i=o(o({},r),{},{attributeName:"opacity"}),a={tag:"circle",attributes:o(o({},n),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:o(o({},r),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:o(o({},i),{},{values:"1;0;1;1;0;1;"})}),e.push(a),e.push({tag:"path",attributes:o(o({},n),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:o(o({},i),{},{values:"1;0;0;0;0;1;"})}]}),t||e.push({tag:"path",attributes:o(o({},n),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:o(o({},i),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:e}}}};!function(e,t){let{mixoutsTo:n}=t;et=e,tt={},Object.keys(nt).forEach((e=>{-1===rt.indexOf(e)&&delete nt[e]})),et.forEach((e=>{const t=e.mixout?e.mixout():{};if(Object.keys(t).forEach((e=>{"function"==typeof t[e]&&(n[e]=t[e]),"object"==typeof t[e]&&Object.keys(t[e]).forEach((r=>{n[e]||(n[e]={}),n[e][r]=t[e][r]}))})),e.hooks){const t=e.hooks();Object.keys(t).forEach((e=>{tt[e]||(tt[e]=[]),tt[e].push(t[e])}))}e.provides&&e.provides(nt)}))}([we,Ht,Gt,Wt,qt,nn,on,sn,un,hn,{hooks:()=>({parseNodeAttributes(e,t){const n=t.getAttribute("data-fa-symbol"),r=null!==n&&(""===n||n);return e.symbol=r,e}})}],{mixoutsTo:ht});const dn=ht.parse,fn=ht.icon;var pn=n(5556),mn=n.n(pn),gn=n(6540);function vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(n),!0).forEach((function(t){_n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function _n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wn(e){return function(e){if(Array.isArray(e))return xn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return xn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xn(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sn(e){return t=e,(t-=0)==t?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1);var t}var En=["style"],An=!1;try{An=!0}catch(e){}function Mn(e){return e&&"object"===bn(e)&&e.prefix&&e.iconName&&e.icon?e:dn.icon?dn.icon(e):null===e?null:e&&"object"===bn(e)&&e.prefix&&e.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"==typeof e?{prefix:"fas",iconName:e}:void 0}function Tn(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?_n({},e,t):{}}var Cn={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},In=gn.forwardRef((function(e,t){var n=yn(yn({},Cn),e),r=n.icon,i=n.mask,o=n.symbol,a=n.className,s=n.title,l=n.titleId,c=n.maskId,u=Mn(r),h=Tn("classes",[].concat(wn(function(e){var t,n=e.beat,r=e.fade,i=e.beatFade,o=e.bounce,a=e.shake,s=e.flash,l=e.spin,c=e.spinPulse,u=e.spinReverse,h=e.pulse,d=e.fixedWidth,f=e.inverse,p=e.border,m=e.listItem,g=e.flip,v=e.size,y=e.rotation,b=e.pull,_=(_n(t={"fa-beat":n,"fa-fade":r,"fa-beat-fade":i,"fa-bounce":o,"fa-shake":a,"fa-flash":s,"fa-spin":l,"fa-spin-reverse":u,"fa-spin-pulse":c,"fa-pulse":h,"fa-fw":d,"fa-inverse":f,"fa-border":p,"fa-li":m,"fa-flip":!0===g,"fa-flip-horizontal":"horizontal"===g||"both"===g,"fa-flip-vertical":"vertical"===g||"both"===g},"fa-".concat(v),null!=v),_n(t,"fa-rotate-".concat(y),null!=y&&0!==y),_n(t,"fa-pull-".concat(b),null!=b),_n(t,"fa-swap-opacity",e.swapOpacity),t);return Object.keys(_).map((function(e){return _[e]?e:null})).filter((function(e){return e}))}(n)),wn((a||"").split(" ")))),d=Tn("transform","string"==typeof n.transform?dn.transform(n.transform):n.transform),f=Tn("mask",Mn(i)),p=fn(u,yn(yn(yn(yn({},h),d),f),{},{symbol:o,title:s,titleId:l,maskId:c}));if(!p)return function(){var e;!An&&console&&"function"==typeof console.error&&(e=console).error.apply(e,arguments)}("Could not find icon",u),null;var m=p.abstract,g={ref:t};return Object.keys(n).forEach((function(e){Cn.hasOwnProperty(e)||(g[e]=n[e])})),Rn(m[0],g)}));In.displayName="FontAwesomeIcon",In.propTypes={beat:mn().bool,border:mn().bool,beatFade:mn().bool,bounce:mn().bool,className:mn().string,fade:mn().bool,flash:mn().bool,mask:mn().oneOfType([mn().object,mn().array,mn().string]),maskId:mn().string,fixedWidth:mn().bool,inverse:mn().bool,flip:mn().oneOf([!0,!1,"horizontal","vertical","both"]),icon:mn().oneOfType([mn().object,mn().array,mn().string]),listItem:mn().bool,pull:mn().oneOf(["right","left"]),pulse:mn().bool,rotation:mn().oneOf([0,90,180,270]),shake:mn().bool,size:mn().oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:mn().bool,spinPulse:mn().bool,spinReverse:mn().bool,symbol:mn().oneOfType([mn().bool,mn().string]),title:mn().string,titleId:mn().string,transform:mn().oneOfType([mn().string,mn().object]),swapOpacity:mn().bool};var Rn=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof n)return n;var i=(n.children||[]).map((function(n){return e(t,n)})),o=Object.keys(n.attributes||{}).reduce((function(e,t){var r=n.attributes[t];switch(t){case"class":e.attrs.className=r,delete n.attributes.class;break;case"style":e.attrs.style=r.split(";").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var n,r=t.indexOf(":"),i=Sn(t.slice(0,r)),o=t.slice(r+1).trim();return i.startsWith("webkit")?e[(n=i,n.charAt(0).toUpperCase()+n.slice(1))]=o:e[i]=o,e}),{});break;default:0===t.indexOf("aria-")||0===t.indexOf("data-")?e.attrs[t.toLowerCase()]=r:e.attrs[Sn(t)]=r}return e}),{attrs:{}}),a=r.style,s=void 0===a?{}:a,l=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(r,En);return o.attrs.style=yn(yn({},o.attrs.style),s),t.apply(void 0,[n.tag,yn(yn({},o.attrs),l)].concat(wn(i)))}.bind(null,gn.createElement)},5588:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var i;n.d(t,{AO:()=>h,Gh:()=>O,HS:()=>N,Oi:()=>s,Rr:()=>d,VV:()=>V,aE:()=>te,pX:()=>j,pb:()=>P,rc:()=>i,tH:()=>B,ue:()=>g,yD:()=>D,zR:()=>a}),function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(i||(i={}));const o="popstate";function a(e){return void 0===e&&(e={}),function(e,t,n,a){void 0===a&&(a={});let{window:l=document.defaultView,v5Compat:d=!1}=a,f=l.history,p=i.Pop,m=null,g=v();function v(){return(f.state||{idx:null}).idx}function y(){p=i.Pop;let e=v(),t=null==e?null:e-g;g=e,m&&m({action:p,location:_.location,delta:t})}function b(e){let t="null"!==l.location.origin?l.location.origin:l.location.href,n="string"==typeof e?e:h(e);return n=n.replace(/ $/,"%20"),s(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,f.replaceState(r({},f.state,{idx:g}),""));let _={get action(){return p},get location(){return e(l,f)},listen(e){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener(o,y),m=e,()=>{l.removeEventListener(o,y),m=null}},createHref:e=>t(l,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){p=i.Push;let r=u(_.location,e,t);n&&n(r,e),g=v()+1;let o=c(r,g),a=_.createHref(r);try{f.pushState(o,"",a)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;l.location.assign(a)}d&&m&&m({action:p,location:_.location,delta:1})},replace:function(e,t){p=i.Replace;let r=u(_.location,e,t);n&&n(r,e),g=v();let o=c(r,g),a=_.createHref(r);f.replaceState(o,"",a),d&&m&&m({action:p,location:_.location,delta:0})},go:e=>f.go(e)};return _}((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return u("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:h(t)}),null,e)}function s(e,t){if(!1===e||null==e)throw new Error(t)}function l(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function c(e,t){return{usr:e.state,key:e.key,idx:t}}function u(e,t,n,i){return void 0===n&&(n=null),r({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?d(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function d(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}var f;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(f||(f={}));const p=new Set(["lazy","caseSensitive","path","id","index","children"]);function m(e,t,n,i){return void 0===n&&(n=[]),void 0===i&&(i={}),e.map(((e,o)=>{let a=[...n,String(o)],l="string"==typeof e.id?e.id:a.join("-");if(s(!0!==e.index||!e.children,"Cannot specify children on an index route"),s(!i[l],'Found a route id collision on id "'+l+"\".  Route id's must be globally unique within Data Router usages"),function(e){return!0===e.index}(e)){let n=r({},e,t(e),{id:l});return i[l]=n,n}{let n=r({},e,t(e),{id:l,children:void 0});return i[l]=n,e.children&&(n.children=m(e.children,t,a,i)),n}}))}function g(e,t,n){return void 0===n&&(n="/"),v(e,t,n,!1)}function v(e,t,n,r){let i=P(("string"==typeof t?d(t):t).pathname||"/",n);if(null==i)return null;let o=y(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(o);let a=null;for(let e=0;null==a&&e<o.length;++e){let t=R(i);a=C(o[e],t,r)}return a}function y(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,o)=>{let a={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(s(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));let l=N([r,a.relativePath]),c=n.concat(a);e.children&&e.children.length>0&&(s(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),y(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:T(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let n of b(e.path))i(e,t,n);else i(e,t)})),t}function b(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=b(r.join("/")),s=[];return s.push(...a.map((e=>""===e?o:[o,e].join("/")))),i&&s.push(...a),s.map((t=>e.startsWith("/")&&""===t?"/":t))}const _=/^:[\w-]+$/,w=3,x=2,S=1,E=10,A=-2,M=e=>"*"===e;function T(e,t){let n=e.split("/"),r=n.length;return n.some(M)&&(r+=A),t&&(r+=x),n.filter((e=>!M(e))).reduce(((e,t)=>e+(_.test(t)?w:""===t?S:E)),r)}function C(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},o="/",a=[];for(let e=0;e<r.length;++e){let s=r[e],l=e===r.length-1,c="/"===o?t:t.slice(o.length)||"/",u=I({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},c),h=s.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=I({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),a.push({params:i,pathname:N([o,u.pathname]),pathnameBase:U(N([o,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(o=N([o,u.pathnameBase]))}return a}function I(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),l("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:o,pathnameBase:a,pattern:e}}function R(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return l(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function L(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function k(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function D(e,t){let n=k(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function O(e,t,n,i){let o;void 0===i&&(i=!1),"string"==typeof e?o=d(e):(o=r({},e),s(!o.pathname||!o.pathname.includes("?"),L("?","pathname","search",o)),s(!o.pathname||!o.pathname.includes("#"),L("#","pathname","hash",o)),s(!o.search||!o.search.includes("#"),L("#","search","hash",o)));let a,l=""===e||""===o.pathname,c=l?"/":o.pathname;if(null==c)a=n;else{let e=t.length-1;if(!i&&c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"==typeof e?d(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:F(r),hash:z(i)}}(o,a),h=c&&"/"!==c&&c.endsWith("/"),f=(l||"."===c)&&n.endsWith("/");return u.pathname.endsWith("/")||!h&&!f||(u.pathname+="/"),u}const N=e=>e.join("/").replace(/\/\/+/g,"/"),U=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),F=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";class B extends Error{}class V{constructor(e,t,n,r){void 0===r&&(r=!1),this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function j(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],G=new Set(H),W=["get",...H],q=new Set(W),X=new Set([301,302,303,307,308]),$=new Set([307,308]),Y={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},K={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Z={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Q=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J=e=>({hasErrorBoundary:Boolean(e.hasErrorBoundary)}),ee="remix-router-transitions";function te(e){const t=e.window?e.window:"undefined"!=typeof window?window:void 0,n=void 0!==t&&void 0!==t.document&&void 0!==t.document.createElement,o=!n;let a;if(s(e.routes.length>0,"You must provide a non-empty routes array to createRouter"),e.mapRouteProperties)a=e.mapRouteProperties;else if(e.detectErrorBoundary){let t=e.detectErrorBoundary;a=e=>({hasErrorBoundary:t(e)})}else a=J;let c,h,d,y={},b=m(e.routes,a,void 0,y),_=e.basename||"/",w=e.dataStrategy||he,x=e.patchRoutesOnNavigation,S=r({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),E=null,A=new Set,M=null,T=null,C=null,I=null!=e.hydrationData,R=g(b,e.history.location,_),L=null;if(null==R&&!x){let t=Se(404,{pathname:e.history.location.pathname}),{matches:n,route:r}=xe(b);R=n,L={[r.id]:t}}if(R&&!e.hydrationData&&lt(R,b,e.history.location.pathname).active&&(R=null),R)if(R.some((e=>e.route.lazy)))h=!1;else if(R.some((e=>e.route.loader)))if(S.v7_partialHydration){let t=e.hydrationData?e.hydrationData.loaderData:null,n=e.hydrationData?e.hydrationData.errors:null;if(n){let e=R.findIndex((e=>void 0!==n[e.route.id]));h=R.slice(0,e+1).every((e=>!ae(e.route,t,n)))}else h=R.every((e=>!ae(e.route,t,n)))}else h=null!=e.hydrationData;else h=!0;else if(h=!1,R=[],S.v7_partialHydration){let t=lt(null,b,e.history.location.pathname);t.active&&t.matches&&(R=t.matches)}let k,D,O={historyAction:e.history.action,location:e.history.location,matches:R,initialized:h,navigation:Y,restoreScrollPosition:null==e.hydrationData&&null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||L,fetchers:new Map,blockers:new Map},N=i.Pop,U=!1,F=!1,z=new Map,B=null,V=!1,H=!1,G=[],W=new Set,q=new Map,X=0,te=-1,ie=new Map,se=new Set,le=new Map,ue=new Map,ge=new Set,ve=new Map,Ae=new Map;function Re(e,t){void 0===t&&(t={}),O=r({},O,e);let n=[],i=[];S.v7_fetcherPersist&&O.fetchers.forEach(((e,t)=>{"idle"===e.state&&(ge.has(t)?i.push(t):n.push(t))})),[...A].forEach((e=>e(O,{deletedFetchers:i,viewTransitionOpts:t.viewTransitionOpts,flushSync:!0===t.flushSync}))),S.v7_fetcherPersist&&(n.forEach((e=>O.fetchers.delete(e))),i.forEach((e=>Ke(e))))}function Pe(t,n,o){var a,s;let l,{flushSync:u}=void 0===o?{}:o,h=null!=O.actionData&&null!=O.navigation.formMethod&&Le(O.navigation.formMethod)&&"loading"===O.navigation.state&&!0!==(null==(a=t.state)?void 0:a._isRedirect);l=n.actionData?Object.keys(n.actionData).length>0?n.actionData:null:h?O.actionData:null;let d=n.loaderData?be(O.loaderData,n.loaderData,n.matches||[],n.errors):O.loaderData,f=O.blockers;f.size>0&&(f=new Map(f),f.forEach(((e,t)=>f.set(t,Z))));let p,m=!0===U||null!=O.navigation.formMethod&&Le(O.navigation.formMethod)&&!0!==(null==(s=t.state)?void 0:s._isRedirect);if(c&&(b=c,c=void 0),V||N===i.Pop||(N===i.Push?e.history.push(t,t.state):N===i.Replace&&e.history.replace(t,t.state)),N===i.Pop){let e=z.get(O.location.pathname);e&&e.has(t.pathname)?p={currentLocation:O.location,nextLocation:t}:z.has(t.pathname)&&(p={currentLocation:t,nextLocation:O.location})}else if(F){let e=z.get(O.location.pathname);e?e.add(t.pathname):(e=new Set([t.pathname]),z.set(O.location.pathname,e)),p={currentLocation:O.location,nextLocation:t}}Re(r({},n,{actionData:l,loaderData:d,historyAction:N,location:t,initialized:!0,navigation:Y,revalidation:"idle",restoreScrollPosition:st(t,n.matches||O.matches),preventScrollReset:m,blockers:f}),{viewTransitionOpts:p,flushSync:!0===u}),N=i.Pop,U=!1,F=!1,V=!1,H=!1,G=[]}async function Ne(t,n,o){k&&k.abort(),k=null,N=t,V=!0===(o&&o.startUninterruptedRevalidation),function(e,t){if(M&&C){let n=at(e,t);M[n]=C()}}(O.location,O.matches),U=!0===(o&&o.preventScrollReset),F=!0===(o&&o.enableViewTransition);let a=c||b,s=o&&o.overrideNavigation,l=g(a,n,_),u=!0===(o&&o.flushSync),h=lt(l,a,n.pathname);if(h.active&&h.matches&&(l=h.matches),!l){let{error:e,notFoundMatches:t,route:r}=it(n.pathname);return void Pe(n,{matches:t,loaderData:{},errors:{[r.id]:e}},{flushSync:u})}if(O.initialized&&!H&&(d=O.location,p=n,d.pathname===p.pathname&&d.search===p.search&&(""===d.hash?""!==p.hash:d.hash===p.hash||""!==p.hash))&&!(o&&o.submission&&Le(o.submission.formMethod)))return void Pe(n,{matches:l},{flushSync:u});var d,p;k=new AbortController;let m,v=me(e.history,n,k.signal,o&&o.submission);if(o&&o.pendingError)m=[we(l).route.id,{type:f.error,error:o.pendingError}];else if(o&&o.submission&&Le(o.submission.formMethod)){let t=await async function(e,t,n,r,o,a){void 0===a&&(a={}),qe();let s,l=function(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}(t,n);if(Re({navigation:l},{flushSync:!0===a.flushSync}),o){let n=await ct(r,t.pathname,e.signal);if("aborted"===n.type)return{shortCircuited:!0};if("error"===n.type){let e=we(n.partialMatches).route.id;return{matches:n.partialMatches,pendingActionResult:[e,{type:f.error,error:n.error}]}}if(!n.matches){let{notFoundMatches:e,error:n,route:r}=it(t.pathname);return{matches:e,pendingActionResult:[r.id,{type:f.error,error:n}]}}r=n.matches}let c=Ue(r,t);if(c.route.action||c.route.lazy){if(s=(await Ge("action",O,e,[c],r,null))[c.route.id],e.signal.aborted)return{shortCircuited:!0}}else s={type:f.error,error:Se(405,{method:e.method,pathname:t.pathname,routeId:c.route.id})};if(Ie(s)){let t;return t=a&&null!=a.replace?a.replace:pe(s.response.headers.get("Location"),new URL(e.url),_)===O.location.pathname+O.location.search,await He(e,s,!0,{submission:n,replace:t}),{shortCircuited:!0}}if(Te(s))throw Se(400,{type:"defer-action"});if(Ce(s)){let e=we(r,c.route.id);return!0!==(a&&a.replace)&&(N=i.Push),{matches:r,pendingActionResult:[e.route.id,s]}}return{matches:r,pendingActionResult:[c.route.id,s]}}(v,n,o.submission,l,h.active,{replace:o.replace,flushSync:u});if(t.shortCircuited)return;if(t.pendingActionResult){let[e,r]=t.pendingActionResult;if(Ce(r)&&j(r.error)&&404===r.error.status)return k=null,void Pe(n,{matches:t.matches,loaderData:{},errors:{[e]:r.error}})}l=t.matches||l,m=t.pendingActionResult,s=ze(n,o.submission),u=!1,h.active=!1,v=me(e.history,v.url,v.signal)}let{shortCircuited:y,matches:w,loaderData:x,errors:E}=await async function(t,n,i,o,a,s,l,u,h,d,f){let p=a||ze(n,s),m=s||l||Fe(p),g=!(V||S.v7_partialHydration&&h);if(o){if(g){let e=je(f);Re(r({navigation:p},void 0!==e?{actionData:e}:{}),{flushSync:d})}let e=await ct(i,n.pathname,t.signal);if("aborted"===e.type)return{shortCircuited:!0};if("error"===e.type){let t=we(e.partialMatches).route.id;return{matches:e.partialMatches,loaderData:{},errors:{[t]:e.error}}}if(!e.matches){let{error:e,notFoundMatches:t,route:r}=it(n.pathname);return{matches:t,loaderData:{},errors:{[r.id]:e}}}i=e.matches}let v=c||b,[y,w]=oe(e.history,O,i,m,n,S.v7_partialHydration&&!0===h,S.v7_skipActionErrorRevalidation,H,G,W,ge,le,se,v,_,f);if(ot((e=>!(i&&i.some((t=>t.route.id===e)))||y&&y.some((t=>t.route.id===e)))),te=++X,0===y.length&&0===w.length){let e=Je();return Pe(n,r({matches:i,loaderData:{},errors:f&&Ce(f[1])?{[f[0]]:f[1].error}:null},_e(f),e?{fetchers:new Map(O.fetchers)}:{}),{flushSync:d}),{shortCircuited:!0}}if(g){let e={};if(!o){e.navigation=p;let t=je(f);void 0!==t&&(e.actionData=t)}w.length>0&&(e.fetchers=function(e){return e.forEach((e=>{let t=O.fetchers.get(e.key),n=Be(void 0,t?t.data:void 0);O.fetchers.set(e.key,n)})),new Map(O.fetchers)}(w)),Re(e,{flushSync:d})}w.forEach((e=>{Ze(e.key),e.controller&&q.set(e.key,e.controller)}));let x=()=>w.forEach((e=>Ze(e.key)));k&&k.signal.addEventListener("abort",x);let{loaderResults:E,fetcherResults:A}=await We(O,i,y,w,t);if(t.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",x),w.forEach((e=>q.delete(e.key)));let M=Ee(E);if(M)return await He(t,M.result,!0,{replace:u}),{shortCircuited:!0};if(M=Ee(A),M)return se.add(M.key),await He(t,M.result,!0,{replace:u}),{shortCircuited:!0};let{loaderData:T,errors:C}=ye(O,i,E,f,w,A,ve);ve.forEach(((e,t)=>{e.subscribe((n=>{(n||e.done)&&ve.delete(t)}))})),S.v7_partialHydration&&h&&O.errors&&(C=r({},O.errors,C));let I=Je(),R=et(te),P=I||R||w.length>0;return r({matches:i,loaderData:T,errors:C},P?{fetchers:new Map(O.fetchers)}:{})}(v,n,l,h.active,s,o&&o.submission,o&&o.fetcherSubmission,o&&o.replace,o&&!0===o.initialHydration,u,m);y||(k=null,Pe(n,r({matches:w||l},_e(m),{loaderData:x,errors:E})))}function je(e){return e&&!Ce(e[1])?{[e[0]]:e[1].data}:O.actionData?0===Object.keys(O.actionData).length?null:O.actionData:void 0}async function He(o,a,l,c){let{submission:h,fetcherSubmission:d,preventScrollReset:f,replace:p}=void 0===c?{}:c;a.response.headers.has("X-Remix-Revalidate")&&(H=!0);let m=a.response.headers.get("Location");s(m,"Expected a Location header on the redirect Response"),m=pe(m,new URL(o.url),_);let g=u(O.location,m,{_isRedirect:!0});if(n){let n=!1;if(a.response.headers.has("X-Remix-Reload-Document"))n=!0;else if(Q.test(m)){const r=e.history.createURL(m);n=r.origin!==t.location.origin||null==P(r.pathname,_)}if(n)return void(p?t.location.replace(m):t.location.assign(m))}k=null;let v=!0===p||a.response.headers.has("X-Remix-Replace")?i.Replace:i.Push,{formMethod:y,formAction:b,formEncType:w}=O.navigation;!h&&!d&&y&&b&&w&&(h=Fe(O.navigation));let x=h||d;if($.has(a.response.status)&&x&&Le(x.formMethod))await Ne(v,g,{submission:r({},x,{formAction:m}),preventScrollReset:f||U,enableViewTransition:l?F:void 0});else{let e=ze(g,h);await Ne(v,g,{overrideNavigation:e,fetcherSubmission:d,preventScrollReset:f||U,enableViewTransition:l?F:void 0})}}async function Ge(e,t,n,i,o,c){let u,h={};try{u=await async function(e,t,n,i,o,a,c,u,h,d){let m=a.map((e=>e.route.lazy?async function(e,t,n){if(!e.lazy)return;let i=await e.lazy();if(!e.lazy)return;let o=n[e.id];s(o,"No route found in manifest");let a={};for(let e in i){let t=void 0!==o[e]&&"hasErrorBoundary"!==e;l(!t,'Route "'+o.id+'" has a static property "'+e+'" defined but its lazy function is also returning a value for this property. The lazy route property "'+e+'" will be ignored.'),t||p.has(e)||(a[e]=i[e])}Object.assign(o,a),Object.assign(o,r({},t(o),{lazy:void 0}))}(e.route,h,u):void 0)),g=a.map(((e,n)=>{let a=m[n],l=o.some((t=>t.route.id===e.route.id));return r({},e,{shouldLoad:l,resolve:async n=>(n&&"GET"===i.method&&(e.route.lazy||e.route.loader)&&(l=!0),l?async function(e,t,n,r,i,o){let a,l,c=r=>{let a,s=new Promise(((e,t)=>a=t));l=()=>a(),t.signal.addEventListener("abort",l);let c=i=>"function"!=typeof r?Promise.reject(new Error('You cannot call the handler for a route which defines a boolean "'+e+'" [routeId: '+n.route.id+"]")):r({request:t,params:n.params,context:o},...void 0!==i?[i]:[]),u=(async()=>{try{return{type:"data",result:await(i?i((e=>c(e))):c())}}catch(e){return{type:"error",result:e}}})();return Promise.race([u,s])};try{let i=n.route[e];if(r)if(i){let e,[t]=await Promise.all([c(i).catch((t=>{e=t})),r]);if(void 0!==e)throw e;a=t}else{if(await r,i=n.route[e],!i){if("action"===e){let e=new URL(t.url),r=e.pathname+e.search;throw Se(405,{method:t.method,pathname:r,routeId:n.route.id})}return{type:f.data,result:void 0}}a=await c(i)}else{if(!i){let e=new URL(t.url);throw Se(404,{pathname:e.pathname+e.search})}a=await c(i)}s(void 0!==a.result,"You defined "+("action"===e?"an action":"a loader")+' for route "'+n.route.id+"\" but didn't return anything from your `"+e+"` function. Please return a value or `null`.")}catch(e){return{type:f.error,result:e}}finally{l&&t.signal.removeEventListener("abort",l)}return a}(t,i,e,a,n,d):Promise.resolve({type:f.data,result:void 0}))})})),v=await e({matches:g,request:i,params:a[0].params,fetcherKey:c,context:d});try{await Promise.all(m)}catch(e){}return v}(w,e,0,n,i,o,c,y,a)}catch(e){return i.forEach((t=>{h[t.route.id]={type:f.error,error:e}})),h}for(let[e,t]of Object.entries(u))if(Me(t)){let r=t.result;h[e]={type:f.redirect,response:fe(r,n,e,o,_,S.v7_relativeSplatPath)}}else h[e]=await de(t);return h}async function We(t,n,r,i,o){let a=t.matches,s=Ge("loader",0,o,r,n,null),l=Promise.all(i.map((async t=>{if(t.matches&&t.match&&t.controller){let n=(await Ge("loader",0,me(e.history,t.path,t.controller.signal),[t.match],t.matches,t.key))[t.match.route.id];return{[t.key]:n}}return Promise.resolve({[t.key]:{type:f.error,error:Se(404,{pathname:t.path})}})}))),c=await s,u=(await l).reduce(((e,t)=>Object.assign(e,t)),{});return await Promise.all([ke(n,c,o.signal,a,t.loaderData),De(n,u,i)]),{loaderResults:c,fetcherResults:u}}function qe(){H=!0,G.push(...ot()),le.forEach(((e,t)=>{q.has(t)&&W.add(t),Ze(t)}))}function Xe(e,t,n){void 0===n&&(n={}),O.fetchers.set(e,t),Re({fetchers:new Map(O.fetchers)},{flushSync:!0===(n&&n.flushSync)})}function $e(e,t,n,r){void 0===r&&(r={});let i=we(O.matches,t);Ke(e),Re({errors:{[i.route.id]:n},fetchers:new Map(O.fetchers)},{flushSync:!0===(r&&r.flushSync)})}function Ye(e){return S.v7_fetcherPersist&&(ue.set(e,(ue.get(e)||0)+1),ge.has(e)&&ge.delete(e)),O.fetchers.get(e)||K}function Ke(e){let t=O.fetchers.get(e);!q.has(e)||t&&"loading"===t.state&&ie.has(e)||Ze(e),le.delete(e),ie.delete(e),se.delete(e),ge.delete(e),W.delete(e),O.fetchers.delete(e)}function Ze(e){let t=q.get(e);t&&(t.abort(),q.delete(e))}function Qe(e){for(let t of e){let e=Ve(Ye(t).data);O.fetchers.set(t,e)}}function Je(){let e=[],t=!1;for(let n of se){let r=O.fetchers.get(n);s(r,"Expected fetcher: "+n),"loading"===r.state&&(se.delete(n),e.push(n),t=!0)}return Qe(e),t}function et(e){let t=[];for(let[n,r]of ie)if(r<e){let e=O.fetchers.get(n);s(e,"Expected fetcher: "+n),"loading"===e.state&&(Ze(n),ie.delete(n),t.push(n))}return Qe(t),t.length>0}function tt(e){O.blockers.delete(e),Ae.delete(e)}function nt(e,t){let n=O.blockers.get(e)||Z;s("unblocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"blocked"===t.state||"blocked"===n.state&&"proceeding"===t.state||"blocked"===n.state&&"unblocked"===t.state||"proceeding"===n.state&&"unblocked"===t.state,"Invalid blocker state transition: "+n.state+" -> "+t.state);let r=new Map(O.blockers);r.set(e,t),Re({blockers:r})}function rt(e){let{currentLocation:t,nextLocation:n,historyAction:r}=e;if(0===Ae.size)return;Ae.size>1&&l(!1,"A router only supports one blocker at a time");let i=Array.from(Ae.entries()),[o,a]=i[i.length-1],s=O.blockers.get(o);return s&&"proceeding"===s.state?void 0:a({currentLocation:t,nextLocation:n,historyAction:r})?o:void 0}function it(e){let t=Se(404,{pathname:e}),n=c||b,{matches:r,route:i}=xe(n);return ot(),{notFoundMatches:r,route:i,error:t}}function ot(e){let t=[];return ve.forEach(((n,r)=>{e&&!e(r)||(n.cancel(),t.push(r),ve.delete(r))})),t}function at(e,t){return T&&T(e,t.map((e=>function(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}(e,O.loaderData))))||e.key}function st(e,t){if(M){let n=at(e,t),r=M[n];if("number"==typeof r)return r}return null}function lt(e,t,n){if(x){if(!e)return{active:!0,matches:v(t,n,_,!0)||[]};if(Object.keys(e[0].params).length>0)return{active:!0,matches:v(t,n,_,!0)}}return{active:!1,matches:null}}async function ct(e,t,n){if(!x)return{type:"success",matches:e};let r=e;for(;;){let e=null==c,i=c||b,o=y;try{await x({path:t,matches:r,patch:(e,t)=>{n.aborted||ce(e,t,i,o,a)}})}catch(e){return{type:"error",error:e,partialMatches:r}}finally{e&&!n.aborted&&(b=[...b])}if(n.aborted)return{type:"aborted"};let s=g(i,t,_);if(s)return{type:"success",matches:s};let l=v(i,t,_,!0);if(!l||r.length===l.length&&r.every(((e,t)=>e.route.id===l[t].route.id)))return{type:"success",matches:null};r=l}}return d={get basename(){return _},get future(){return S},get state(){return O},get routes(){return b},get window(){return t},initialize:function(){if(E=e.history.listen((t=>{let{action:n,location:r,delta:i}=t;if(D)return D(),void(D=void 0);l(0===Ae.size||null!=i,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let o=rt({currentLocation:O.location,nextLocation:r,historyAction:n});if(o&&null!=i){let t=new Promise((e=>{D=e}));return e.history.go(-1*i),void nt(o,{state:"blocked",location:r,proceed(){nt(o,{state:"proceeding",proceed:void 0,reset:void 0,location:r}),t.then((()=>e.history.go(i)))},reset(){let e=new Map(O.blockers);e.set(o,Z),Re({blockers:e})}})}return Ne(n,r)})),n){!function(e,t){try{let n=e.sessionStorage.getItem(ee);if(n){let e=JSON.parse(n);for(let[n,r]of Object.entries(e||{}))r&&Array.isArray(r)&&t.set(n,new Set(r||[]))}}catch(e){}}(t,z);let e=()=>function(e,t){if(t.size>0){let n={};for(let[e,r]of t)n[e]=[...r];try{e.sessionStorage.setItem(ee,JSON.stringify(n))}catch(e){l(!1,"Failed to save applied view transitions in sessionStorage ("+e+").")}}}(t,z);t.addEventListener("pagehide",e),B=()=>t.removeEventListener("pagehide",e)}return O.initialized||Ne(i.Pop,O.location,{initialHydration:!0}),d},subscribe:function(e){return A.add(e),()=>A.delete(e)},enableScrollRestoration:function(e,t,n){if(M=e,C=t,T=n||null,!I&&O.navigation===Y){I=!0;let e=st(O.location,O.matches);null!=e&&Re({restoreScrollPosition:e})}return()=>{M=null,C=null,T=null}},navigate:async function t(n,o){if("number"==typeof n)return void e.history.go(n);let a=ne(O.location,O.matches,_,S.v7_prependBasename,n,S.v7_relativeSplatPath,null==o?void 0:o.fromRouteId,null==o?void 0:o.relative),{path:s,submission:l,error:c}=re(S.v7_normalizeFormMethod,!1,a,o),h=O.location,d=u(O.location,s,o&&o.state);d=r({},d,e.history.encodeLocation(d));let f=o&&null!=o.replace?o.replace:void 0,p=i.Push;!0===f?p=i.Replace:!1===f||null!=l&&Le(l.formMethod)&&l.formAction===O.location.pathname+O.location.search&&(p=i.Replace);let m=o&&"preventScrollReset"in o?!0===o.preventScrollReset:void 0,g=!0===(o&&o.flushSync),v=rt({currentLocation:h,nextLocation:d,historyAction:p});if(!v)return await Ne(p,d,{submission:l,pendingError:c,preventScrollReset:m,replace:o&&o.replace,enableViewTransition:o&&o.viewTransition,flushSync:g});nt(v,{state:"blocked",location:d,proceed(){nt(v,{state:"proceeding",proceed:void 0,reset:void 0,location:d}),t(n,o)},reset(){let e=new Map(O.blockers);e.set(v,Z),Re({blockers:e})}})},fetch:function(t,n,r,i){if(o)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ze(t);let a=!0===(i&&i.flushSync),l=c||b,u=ne(O.location,O.matches,_,S.v7_prependBasename,r,S.v7_relativeSplatPath,n,null==i?void 0:i.relative),h=g(l,u,_),d=lt(h,l,u);if(d.active&&d.matches&&(h=d.matches),!h)return void $e(t,n,Se(404,{pathname:u}),{flushSync:a});let{path:f,submission:p,error:m}=re(S.v7_normalizeFormMethod,!0,u,i);if(m)return void $e(t,n,m,{flushSync:a});let v=Ue(h,f),y=!0===(i&&i.preventScrollReset);p&&Le(p.formMethod)?async function(t,n,r,i,o,a,l,u,h){function d(e){if(!e.route.action&&!e.route.lazy){let e=Se(405,{method:h.formMethod,pathname:r,routeId:n});return $e(t,n,e,{flushSync:l}),!0}return!1}if(qe(),le.delete(t),!a&&d(i))return;let f=O.fetchers.get(t);Xe(t,function(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}(h,f),{flushSync:l});let p=new AbortController,m=me(e.history,r,p.signal,h);if(a){let e=await ct(o,r,m.signal);if("aborted"===e.type)return;if("error"===e.type)return void $e(t,n,e.error,{flushSync:l});if(!e.matches)return void $e(t,n,Se(404,{pathname:r}),{flushSync:l});if(d(i=Ue(o=e.matches,r)))return}q.set(t,p);let v=X,y=(await Ge("action",0,m,[i],o,t))[i.route.id];if(m.signal.aborted)return void(q.get(t)===p&&q.delete(t));if(S.v7_fetcherPersist&&ge.has(t)){if(Ie(y)||Ce(y))return void Xe(t,Ve(void 0))}else{if(Ie(y))return q.delete(t),te>v?void Xe(t,Ve(void 0)):(se.add(t),Xe(t,Be(h)),He(m,y,!1,{fetcherSubmission:h,preventScrollReset:u}));if(Ce(y))return void $e(t,n,y.error)}if(Te(y))throw Se(400,{type:"defer-action"});let w=O.navigation.location||O.location,x=me(e.history,w,p.signal),E=c||b,A="idle"!==O.navigation.state?g(E,O.navigation.location,_):O.matches;s(A,"Didn't find any matches after fetcher action");let M=++X;ie.set(t,M);let T=Be(h,y.data);O.fetchers.set(t,T);let[C,I]=oe(e.history,O,A,h,w,!1,S.v7_skipActionErrorRevalidation,H,G,W,ge,le,se,E,_,[i.route.id,y]);I.filter((e=>e.key!==t)).forEach((e=>{let t=e.key,n=O.fetchers.get(t),r=Be(void 0,n?n.data:void 0);O.fetchers.set(t,r),Ze(t),e.controller&&q.set(t,e.controller)})),Re({fetchers:new Map(O.fetchers)});let R=()=>I.forEach((e=>Ze(e.key)));p.signal.addEventListener("abort",R);let{loaderResults:P,fetcherResults:L}=await We(O,A,C,I,x);if(p.signal.aborted)return;p.signal.removeEventListener("abort",R),ie.delete(t),q.delete(t),I.forEach((e=>q.delete(e.key)));let D=Ee(P);if(D)return He(x,D.result,!1,{preventScrollReset:u});if(D=Ee(L),D)return se.add(D.key),He(x,D.result,!1,{preventScrollReset:u});let{loaderData:U,errors:F}=ye(O,A,P,void 0,I,L,ve);if(O.fetchers.has(t)){let e=Ve(y.data);O.fetchers.set(t,e)}et(M),"loading"===O.navigation.state&&M>te?(s(N,"Expected pending action"),k&&k.abort(),Pe(O.navigation.location,{matches:A,loaderData:U,errors:F,fetchers:new Map(O.fetchers)})):(Re({errors:F,loaderData:be(O.loaderData,U,A,F),fetchers:new Map(O.fetchers)}),H=!1)}(t,n,f,v,h,d.active,a,y,p):(le.set(t,{routeId:n,path:f}),async function(t,n,r,i,o,a,l,c,u){let h=O.fetchers.get(t);Xe(t,Be(u,h?h.data:void 0),{flushSync:l});let d=new AbortController,f=me(e.history,r,d.signal);if(a){let e=await ct(o,r,f.signal);if("aborted"===e.type)return;if("error"===e.type)return void $e(t,n,e.error,{flushSync:l});if(!e.matches)return void $e(t,n,Se(404,{pathname:r}),{flushSync:l});i=Ue(o=e.matches,r)}q.set(t,d);let p=X,m=(await Ge("loader",0,f,[i],o,t))[i.route.id];if(Te(m)&&(m=await Oe(m,f.signal,!0)||m),q.get(t)===d&&q.delete(t),!f.signal.aborted){if(!ge.has(t))return Ie(m)?te>p?void Xe(t,Ve(void 0)):(se.add(t),void await He(f,m,!1,{preventScrollReset:c})):void(Ce(m)?$e(t,n,m.error):(s(!Te(m),"Unhandled fetcher deferred data"),Xe(t,Ve(m.data))));Xe(t,Ve(void 0))}}(t,n,f,v,h,d.active,a,y,p))},revalidate:function(){qe(),Re({revalidation:"loading"}),"submitting"!==O.navigation.state&&("idle"!==O.navigation.state?Ne(N||O.historyAction,O.navigation.location,{overrideNavigation:O.navigation,enableViewTransition:!0===F}):Ne(O.historyAction,O.location,{startUninterruptedRevalidation:!0}))},createHref:t=>e.history.createHref(t),encodeLocation:t=>e.history.encodeLocation(t),getFetcher:Ye,deleteFetcher:function(e){if(S.v7_fetcherPersist){let t=(ue.get(e)||0)-1;t<=0?(ue.delete(e),ge.add(e)):ue.set(e,t)}else Ke(e);Re({fetchers:new Map(O.fetchers)})},dispose:function(){E&&E(),B&&B(),A.clear(),k&&k.abort(),O.fetchers.forEach(((e,t)=>Ke(t))),O.blockers.forEach(((e,t)=>tt(t)))},getBlocker:function(e,t){let n=O.blockers.get(e)||Z;return Ae.get(e)!==t&&Ae.set(e,t),n},deleteBlocker:tt,patchRoutes:function(e,t){let n=null==c;ce(e,t,c||b,y,a),n&&(b=[...b],Re({}))},_internalFetchControllers:q,_internalActiveDeferreds:ve,_internalSetRoutes:function(e){y={},c=m(e,a,void 0,y)}},d}function ne(e,t,n,r,i,o,a,s){let l,c;if(a){l=[];for(let e of t)if(l.push(e),e.route.id===a){c=e;break}}else l=t,c=t[t.length-1];let u=O(i||".",D(l,o),P(e.pathname,n)||e.pathname,"path"===s);if(null==i&&(u.search=e.search,u.hash=e.hash),(null==i||""===i||"."===i)&&c){let e=Ne(u.search);if(c.route.index&&!e)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&e){let e=new URLSearchParams(u.search),t=e.getAll("index");e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();u.search=n?"?"+n:""}}return r&&"/"!==n&&(u.pathname="/"===u.pathname?n:N([n,u.pathname])),h(u)}function re(e,t,n,r){if(!r||!function(e){return null!=e&&("formData"in e&&null!=e.formData||"body"in e&&void 0!==e.body)}(r))return{path:n};if(r.formMethod&&(i=r.formMethod,!q.has(i.toLowerCase())))return{path:n,error:Se(405,{method:r.formMethod})};var i;let o,a,l=()=>({path:n,error:Se(400,{type:"invalid-body"})}),c=r.formMethod||"get",u=e?c.toUpperCase():c.toLowerCase(),f=Ae(n);if(void 0!==r.body){if("text/plain"===r.formEncType){if(!Le(u))return l();let e="string"==typeof r.body?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce(((e,t)=>{let[n,r]=t;return""+e+n+"="+r+"\n"}),""):String(r.body);return{path:n,submission:{formMethod:u,formAction:f,formEncType:r.formEncType,formData:void 0,json:void 0,text:e}}}if("application/json"===r.formEncType){if(!Le(u))return l();try{let e="string"==typeof r.body?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:u,formAction:f,formEncType:r.formEncType,formData:void 0,json:e,text:void 0}}}catch(e){return l()}}}if(s("function"==typeof FormData,"FormData is not available in this environment"),r.formData)o=ge(r.formData),a=r.formData;else if(r.body instanceof FormData)o=ge(r.body),a=r.body;else if(r.body instanceof URLSearchParams)o=r.body,a=ve(o);else if(null==r.body)o=new URLSearchParams,a=new FormData;else try{o=new URLSearchParams(r.body),a=ve(o)}catch(e){return l()}let p={formMethod:u,formAction:f,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:a,json:void 0,text:void 0};if(Le(p.formMethod))return{path:n,submission:p};let m=d(n);return t&&m.search&&Ne(m.search)&&o.append("index",""),m.search="?"+o,{path:h(m),submission:p}}function ie(e,t,n){void 0===n&&(n=!1);let r=e.findIndex((e=>e.route.id===t));return r>=0?e.slice(0,n?r+1:r):e}function oe(e,t,n,i,o,a,s,l,c,u,h,d,f,p,m,v){let y=v?Ce(v[1])?v[1].error:v[1].data:void 0,b=e.createURL(t.location),_=e.createURL(o),w=n;a&&t.errors?w=ie(n,Object.keys(t.errors)[0],!0):v&&Ce(v[1])&&(w=ie(n,v[0]));let x=v?v[1].statusCode:void 0,S=s&&x&&x>=400,E=w.filter(((e,n)=>{let{route:o}=e;if(o.lazy)return!0;if(null==o.loader)return!1;if(a)return ae(o,t.loaderData,t.errors);if(function(e,t,n){let r=!t||n.route.id!==t.route.id,i=void 0===e[n.route.id];return r||i}(t.loaderData,t.matches[n],e)||c.some((t=>t===e.route.id)))return!0;let s=t.matches[n],u=e;return le(e,r({currentUrl:b,currentParams:s.params,nextUrl:_,nextParams:u.params},i,{actionResult:y,actionStatus:x,defaultShouldRevalidate:!S&&(l||b.pathname+b.search===_.pathname+_.search||b.search!==_.search||se(s,u))}))})),A=[];return d.forEach(((e,o)=>{if(a||!n.some((t=>t.route.id===e.routeId))||h.has(o))return;let s=g(p,e.path,m);if(!s)return void A.push({key:o,routeId:e.routeId,path:e.path,matches:null,match:null,controller:null});let c=t.fetchers.get(o),d=Ue(s,e.path),v=!1;f.has(o)?v=!1:u.has(o)?(u.delete(o),v=!0):v=c&&"idle"!==c.state&&void 0===c.data?l:le(d,r({currentUrl:b,currentParams:t.matches[t.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},i,{actionResult:y,actionStatus:x,defaultShouldRevalidate:!S&&l})),v&&A.push({key:o,routeId:e.routeId,path:e.path,matches:s,match:d,controller:new AbortController})})),[E,A]}function ae(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=null!=t&&void 0!==t[e.id],i=null!=n&&void 0!==n[e.id];return!(!r&&i)&&("function"==typeof e.loader&&!0===e.loader.hydrate||!r&&!i)}function se(e,t){let n=e.route.path;return e.pathname!==t.pathname||null!=n&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function le(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if("boolean"==typeof n)return n}return t.defaultShouldRevalidate}function ce(e,t,n,r,i){var o;let a;if(e){let t=r[e];s(t,"No route found to patch children into: routeId = "+e),t.children||(t.children=[]),a=t.children}else a=n;let l=m(t.filter((e=>!a.some((t=>ue(e,t))))),i,[e||"_","patch",String((null==(o=a)?void 0:o.length)||"0")],r);a.push(...l)}function ue(e,t){return"id"in e&&"id"in t&&e.id===t.id||e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive&&(!(e.children&&0!==e.children.length||t.children&&0!==t.children.length)||e.children.every(((e,n)=>{var r;return null==(r=t.children)?void 0:r.some((t=>ue(e,t)))})))}async function he(e){let{matches:t}=e,n=t.filter((e=>e.shouldLoad));return(await Promise.all(n.map((e=>e.resolve())))).reduce(((e,t,r)=>Object.assign(e,{[n[r].route.id]:t})),{})}async function de(e){let{result:t,type:n}=e;if(Pe(t)){let e;try{let n=t.headers.get("Content-Type");e=n&&/\bapplication\/json\b/.test(n)?null==t.body?null:await t.json():await t.text()}catch(e){return{type:f.error,error:e}}return n===f.error?{type:f.error,error:new V(t.status,t.statusText,e),statusCode:t.status,headers:t.headers}:{type:f.data,data:e,statusCode:t.status,headers:t.headers}}if(n===f.error){if(Re(t)){var r,i;if(t.data instanceof Error)return{type:f.error,error:t.data,statusCode:null==(i=t.init)?void 0:i.status};t=new V((null==(r=t.init)?void 0:r.status)||500,void 0,t.data)}return{type:f.error,error:t,statusCode:j(t)?t.status:void 0}}var o,a,s,l;return function(e){let t=e;return t&&"object"==typeof t&&"object"==typeof t.data&&"function"==typeof t.subscribe&&"function"==typeof t.cancel&&"function"==typeof t.resolveData}(t)?{type:f.deferred,deferredData:t,statusCode:null==(o=t.init)?void 0:o.status,headers:(null==(a=t.init)?void 0:a.headers)&&new Headers(t.init.headers)}:Re(t)?{type:f.data,data:t.data,statusCode:null==(s=t.init)?void 0:s.status,headers:null!=(l=t.init)&&l.headers?new Headers(t.init.headers):void 0}:{type:f.data,data:t}}function fe(e,t,n,r,i,o){let a=e.headers.get("Location");if(s(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Q.test(a)){let s=r.slice(0,r.findIndex((e=>e.route.id===n))+1);a=ne(new URL(t.url),s,i,!0,a,o),e.headers.set("Location",a)}return e}function pe(e,t,n){if(Q.test(e)){let r=e,i=r.startsWith("//")?new URL(t.protocol+r):new URL(r),o=null!=P(i.pathname,n);if(i.origin===t.origin&&o)return i.pathname+i.search+i.hash}return e}function me(e,t,n,r){let i=e.createURL(Ae(t)).toString(),o={signal:n};if(r&&Le(r.formMethod)){let{formMethod:e,formEncType:t}=r;o.method=e.toUpperCase(),"application/json"===t?(o.headers=new Headers({"Content-Type":t}),o.body=JSON.stringify(r.json)):"text/plain"===t?o.body=r.text:"application/x-www-form-urlencoded"===t&&r.formData?o.body=ge(r.formData):o.body=r.formData}return new Request(i,o)}function ge(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,"string"==typeof r?r:r.name);return t}function ve(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function ye(e,t,n,i,o,a,l){let{loaderData:c,errors:u}=function(e,t,n,r,i){let o,a={},l=null,c=!1,u={},h=n&&Ce(n[1])?n[1].error:void 0;return e.forEach((n=>{if(!(n.route.id in t))return;let d=n.route.id,f=t[d];if(s(!Ie(f),"Cannot handle redirect results in processLoaderData"),Ce(f)){let t=f.error;if(void 0!==h&&(t=h,h=void 0),l=l||{},i)l[d]=t;else{let n=we(e,d);null==l[n.route.id]&&(l[n.route.id]=t)}a[d]=void 0,c||(c=!0,o=j(f.error)?f.error.status:500),f.headers&&(u[d]=f.headers)}else Te(f)?(r.set(d,f.deferredData),a[d]=f.deferredData.data,null==f.statusCode||200===f.statusCode||c||(o=f.statusCode),f.headers&&(u[d]=f.headers)):(a[d]=f.data,f.statusCode&&200!==f.statusCode&&!c&&(o=f.statusCode),f.headers&&(u[d]=f.headers))})),void 0!==h&&n&&(l={[n[0]]:h},a[n[0]]=void 0),{loaderData:a,errors:l,statusCode:o||200,loaderHeaders:u}}(t,n,i,l,!1);return o.forEach((t=>{let{key:n,match:i,controller:o}=t,l=a[n];if(s(l,"Did not find corresponding fetcher result"),!o||!o.signal.aborted)if(Ce(l)){let t=we(e.matches,null==i?void 0:i.route.id);u&&u[t.route.id]||(u=r({},u,{[t.route.id]:l.error})),e.fetchers.delete(n)}else if(Ie(l))s(!1,"Unhandled fetcher revalidation redirect");else if(Te(l))s(!1,"Unhandled fetcher deferred data");else{let t=Ve(l.data);e.fetchers.set(n,t)}})),{loaderData:c,errors:u}}function be(e,t,n,i){let o=r({},t);for(let r of n){let n=r.route.id;if(t.hasOwnProperty(n)?void 0!==t[n]&&(o[n]=t[n]):void 0!==e[n]&&r.route.loader&&(o[n]=e[n]),i&&i.hasOwnProperty(n))break}return o}function _e(e){return e?Ce(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function we(e,t){return(t?e.slice(0,e.findIndex((e=>e.route.id===t))+1):[...e]).reverse().find((e=>!0===e.route.hasErrorBoundary))||e[0]}function xe(e){let t=1===e.length?e[0]:e.find((e=>e.index||!e.path||"/"===e.path))||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Se(e,t){let{pathname:n,routeId:r,method:i,type:o,message:a}=void 0===t?{}:t,s="Unknown Server Error",l="Unknown @remix-run/router error";return 400===e?(s="Bad Request",i&&n&&r?l="You made a "+i+' request to "'+n+'" but did not provide a `loader` for route "'+r+'", so there is no way to handle the request.':"defer-action"===o?l="defer() is not supported in actions":"invalid-body"===o&&(l="Unable to encode submission body")):403===e?(s="Forbidden",l='Route "'+r+'" does not match URL "'+n+'"'):404===e?(s="Not Found",l='No route matches URL "'+n+'"'):405===e&&(s="Method Not Allowed",i&&n&&r?l="You made a "+i.toUpperCase()+' request to "'+n+'" but did not provide an `action` for route "'+r+'", so there is no way to handle the request.':i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new V(e||500,s,new Error(l),!0)}function Ee(e){let t=Object.entries(e);for(let e=t.length-1;e>=0;e--){let[n,r]=t[e];if(Ie(r))return{key:n,result:r}}}function Ae(e){return h(r({},"string"==typeof e?d(e):e,{hash:""}))}function Me(e){return Pe(e.result)&&X.has(e.result.status)}function Te(e){return e.type===f.deferred}function Ce(e){return e.type===f.error}function Ie(e){return(e&&e.type)===f.redirect}function Re(e){return"object"==typeof e&&null!=e&&"type"in e&&"data"in e&&"init"in e&&"DataWithResponseInit"===e.type}function Pe(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"object"==typeof e.headers&&void 0!==e.body}function Le(e){return G.has(e.toLowerCase())}async function ke(e,t,n,r,i){let o=Object.entries(t);for(let a=0;a<o.length;a++){let[s,l]=o[a],c=e.find((e=>(null==e?void 0:e.route.id)===s));if(!c)continue;let u=r.find((e=>e.route.id===c.route.id)),h=null!=u&&!se(u,c)&&void 0!==(i&&i[c.route.id]);Te(l)&&h&&await Oe(l,n,!1).then((e=>{e&&(t[s]=e)}))}}async function De(e,t,n){for(let r=0;r<n.length;r++){let{key:i,routeId:o,controller:a}=n[r],l=t[i];e.find((e=>(null==e?void 0:e.route.id)===o))&&Te(l)&&(s(a,"Expected an AbortController for revalidating fetcher deferred result"),await Oe(l,a.signal,!0).then((e=>{e&&(t[i]=e)})))}}async function Oe(e,t,n){if(void 0===n&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:f.data,data:e.deferredData.unwrappedData}}catch(e){return{type:f.error,error:e}}return{type:f.data,data:e.deferredData.data}}}function Ne(e){return new URLSearchParams(e).getAll("index").some((e=>""===e))}function Ue(e,t){let n="string"==typeof t?d(t).search:t.search;if(e[e.length-1].route.index&&Ne(n||""))return e[e.length-1];let r=k(e);return r[r.length-1]}function Fe(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:o,json:a}=e;if(t&&n&&r)return null!=i?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i}:null!=o?{formMethod:t,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0}:void 0!==a?{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:a,text:void 0}:void 0}function ze(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Be(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function Ve(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}Symbol("deferred")},682:(e,t,n)=>{"use strict";n.d(t,{Ob:()=>a,fx:()=>o,zv:()=>i});var r=n(6540);function i(e){return e&&r.isValidElement(e)&&e.type===r.Fragment}const o=(e,t,n)=>r.isValidElement(e)?r.cloneElement(e,"function"==typeof n?n(e.props||{}):n):t;function a(e,t){return o(e,e,t)}},8877:(e,t,n)=>{"use strict";n.d(t,{_n:()=>o,rJ:()=>a});var r=n(6540);function i(){}n(8210);const o=r.createContext({}),a=()=>{const e=()=>{};return e.deprecated=i,e}},57:(e,t,n)=>{"use strict";n.d(t,{A:()=>E});var r=n(6540),i=n(6942),o=n.n(i),a=n(2467),s=n(8719),l=n(2279),c=n(682),u=n(7358);const h=e=>{const{componentCls:t,colorPrimary:n}=e;return{[t]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${n})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${e.motionDurationSlow} ${e.motionEaseInOut}`,`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`].join(",")}}}}},d=(0,u.Or)("Wave",(e=>[h(e)]));var f=n(6956),p=n(5371),m=n(1320),g=n(4424),v=n(754),y=n(4832);function b(e){return e&&"#fff"!==e&&"#ffffff"!==e&&"rgb(255, 255, 255)"!==e&&"rgba(255, 255, 255, 1)"!==e&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&"transparent"!==e}function _(e){return Number.isNaN(e)?0:e}const w=e=>{const{className:t,target:n,component:i}=e,a=r.useRef(null),[l,c]=r.useState(null),[u,h]=r.useState([]),[d,f]=r.useState(0),[m,w]=r.useState(0),[x,S]=r.useState(0),[E,A]=r.useState(0),[M,T]=r.useState(!1),C={left:d,top:m,width:x,height:E,borderRadius:u.map((e=>`${e}px`)).join(" ")};function I(){const e=getComputedStyle(n);c(function(e){const{borderTopColor:t,borderColor:n,backgroundColor:r}=getComputedStyle(e);return b(t)?t:b(n)?n:b(r)?r:null}(n));const t="static"===e.position,{borderLeftWidth:r,borderTopWidth:i}=e;f(t?n.offsetLeft:_(-parseFloat(r))),w(t?n.offsetTop:_(-parseFloat(i))),S(n.offsetWidth),A(n.offsetHeight);const{borderTopLeftRadius:o,borderTopRightRadius:a,borderBottomLeftRadius:s,borderBottomRightRadius:l}=e;h([o,a,l,s].map((e=>_(parseFloat(e)))))}if(l&&(C["--wave-color"]=l),r.useEffect((()=>{if(n){const e=(0,p.A)((()=>{I(),T(!0)}));let t;return"undefined"!=typeof ResizeObserver&&(t=new ResizeObserver(I),t.observe(n)),()=>{p.A.cancel(e),null==t||t.disconnect()}}}),[]),!M)return null;const R=("Checkbox"===i||"Radio"===i)&&(null==n?void 0:n.classList.contains(g.D));return r.createElement(v.Ay,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(e,t)=>{var n;if(t.deadline||"opacity"===t.propertyName){const e=null===(n=a.current)||void 0===n?void 0:n.parentElement;(0,y.v)(e).then((()=>{null==e||e.remove()}))}return!1}},((e,n)=>{let{className:i}=e;return r.createElement("div",{ref:(0,s.K4)(a,n),className:o()(t,i,{"wave-quick":R}),style:C})}))},x=(e,t)=>{var n;const{component:i}=t;if("Checkbox"===i&&!(null===(n=e.querySelector("input"))||void 0===n?void 0:n.checked))return;const o=document.createElement("div");o.style.position="absolute",o.style.left="0px",o.style.top="0px",null==e||e.insertBefore(o,null==e?void 0:e.firstChild),(0,y.X)(r.createElement(w,Object.assign({},t,{target:e})),o)},S=(e,t,n)=>{const{wave:i}=r.useContext(l.QO),[,o,a]=(0,m.Ay)(),s=(0,f.A)((r=>{const s=e.current;if((null==i?void 0:i.disabled)||!s)return;const l=s.querySelector(`.${g.D}`)||s,{showEffect:c}=i||{};(c||x)(l,{className:t,token:o,component:n,event:r,hashId:a})})),c=r.useRef();return e=>{p.A.cancel(c.current),c.current=(0,p.A)((()=>{s(e)}))}},E=e=>{const{children:t,disabled:n,component:i}=e,{getPrefixCls:u}=(0,r.useContext)(l.QO),h=(0,r.useRef)(null),f=u("wave"),[,p]=d(f),m=S(h,o()(f,p),i);if(r.useEffect((()=>{const e=h.current;if(!e||1!==e.nodeType||n)return;const t=t=>{!(0,a.A)(t.target)||!e.getAttribute||e.getAttribute("disabled")||e.disabled||e.className.includes("disabled")||e.className.includes("-leave")||m(t)};return e.addEventListener("click",t,!0),()=>{e.removeEventListener("click",t,!0)}}),[n]),!r.isValidElement(t))return null!=t?t:null;const g=(0,s.f3)(t)?(0,s.K4)(t.ref,h):h;return(0,c.Ob)(t,{ref:g})}},4424:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});const r=`${n(2279).yH}-wave-target`},9449:(e,t,n)=>{"use strict";n.d(t,{Ap:()=>a,DU:()=>s,u1:()=>c,uR:()=>u});var r=n(6540),i=n(682);const o=/^[\u4E00-\u9FA5]{2}$/,a=o.test.bind(o);function s(e){return"danger"===e?{danger:!0}:{type:e}}function l(e){return"string"==typeof e}function c(e){return"text"===e||"link"===e}function u(e,t){let n=!1;const o=[];return r.Children.forEach(e,(e=>{const t=typeof e,r="string"===t||"number"===t;if(n&&r){const t=o.length-1,n=o[t];o[t]=`${n}${e}`}else o.push(e);n=r})),r.Children.map(o,(e=>function(e,t){if(null==e)return;const n=t?" ":"";return"string"!=typeof e&&"number"!=typeof e&&l(e.type)&&a(e.props.children)?(0,i.Ob)(e,{children:e.props.children.split("").join(n)}):l(e)?a(e)?r.createElement("span",null,e.split("").join(n)):r.createElement("span",null,e):(0,i.zv)(e)?r.createElement("span",null,e):e}(e,t)))}},1917:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>Re});var r=n(6540),i=n(6942),o=n.n(i),a=n(9853),s=n(8719),l=n(57),c=n(2279),u=n(8119),h=n(829),d=n(6327),f=n(1320);const p=r.createContext(void 0);var m=n(9449);const g=(0,r.forwardRef)(((e,t)=>{const{className:n,style:i,children:a,prefixCls:s}=e,l=o()(`${s}-icon`,n);return r.createElement("span",{ref:t,className:l,style:i},a)})),v=g;var y=n(3567),b=n(754);const _=(0,r.forwardRef)(((e,t)=>{const{prefixCls:n,className:i,style:a,iconClassName:s}=e,l=o()(`${n}-loading-icon`,i);return r.createElement(v,{prefixCls:n,className:l,style:a,ref:t},r.createElement(y.A,{className:s}))})),w=()=>({width:0,opacity:0,transform:"scale(0)"}),x=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),S=e=>{const{prefixCls:t,loading:n,existIcon:i,className:o,style:a}=e,s=!!n;return i?r.createElement(_,{prefixCls:t,className:o,style:a}):r.createElement(b.Ay,{visible:s,motionName:`${t}-loading-icon-motion`,motionLeave:s,removeOnLeave:!0,onAppearStart:w,onAppearActive:x,onEnterStart:w,onEnterActive:x,onLeaveStart:x,onLeaveActive:w},((e,n)=>{let{className:i,style:s}=e;return r.createElement(_,{prefixCls:t,className:o,style:Object.assign(Object.assign({},a),s),ref:n,iconClassName:i})}))};var E=n(2187),A=n(5905),M=n(4277),T=n(7358);const C=(e,t)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:t}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:t}}}}}),I=e=>{const{componentCls:t,fontSize:n,lineWidth:r,groupBorderColor:i,colorErrorHover:o}=e;return{[`${t}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${t}`]:{"&:not(:last-child)":{[`&, & > ${t}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:e.calc(r).mul(-1).equal(),[`&, & > ${t}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[t]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${t}-icon-only`]:{fontSize:n}},C(`${t}-primary`,i),C(`${t}-danger`,o)]}};var R=n(3029),P=n(2901),L=n(5501),k=n(9426),D=n(9379),O=n(3986),N=n(2284),U=n(4467);const F=Math.round;function z(e,t){const n=e.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],r=n.map((e=>parseFloat(e)));for(let e=0;e<3;e+=1)r[e]=t(r[e]||0,n[e]||"",e);return n[3]?r[3]=n[3].includes("%")?r[3]/100:r[3]:r[3]=1,r}const B=(e,t,n)=>0===n?e:e/100;function V(e,t){const n=t||255;return e>n?n:e<0?0:e}class j{constructor(e){function t(t){return t[0]in e&&t[1]in e&&t[2]in e}if((0,U.A)(this,"isValid",!0),(0,U.A)(this,"r",0),(0,U.A)(this,"g",0),(0,U.A)(this,"b",0),(0,U.A)(this,"a",1),(0,U.A)(this,"_h",void 0),(0,U.A)(this,"_s",void 0),(0,U.A)(this,"_l",void 0),(0,U.A)(this,"_v",void 0),(0,U.A)(this,"_max",void 0),(0,U.A)(this,"_min",void 0),(0,U.A)(this,"_brightness",void 0),e)if("string"==typeof e){const n=e.trim();function r(e){return n.startsWith(e)}/^#?[A-F\d]{3,8}$/i.test(n)?this.fromHexString(n):r("rgb")?this.fromRgbString(n):r("hsl")?this.fromHslString(n):(r("hsv")||r("hsb"))&&this.fromHsvString(n)}else if(e instanceof j)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(t("rgb"))this.r=V(e.r),this.g=V(e.g),this.b=V(e.b),this.a="number"==typeof e.a?V(e.a,1):1;else if(t("hsl"))this.fromHsl(e);else{if(!t("hsv"))throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e));this.fromHsv(e)}}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const t=this.toHsv();return t.h=e,this._c(t)}getLuminance(){function e(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}return.2126*e(this.r)+.7152*e(this.g)+.0722*e(this.b)}getHue(){if(void 0===this._h){const e=this.getMax()-this.getMin();this._h=0===e?0:F(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(void 0===this._s){const e=this.getMax()-this.getMin();this._s=0===e?0:e/this.getMax()}return this._s}getLightness(){return void 0===this._l&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return void 0===this._v&&(this._v=this.getMax()/255),this._v}getBrightness(){return void 0===this._brightness&&(this._brightness=(299*this.r+587*this.g+114*this.b)/1e3),this._brightness}darken(e=10){const t=this.getHue(),n=this.getSaturation();let r=this.getLightness()-e/100;return r<0&&(r=0),this._c({h:t,s:n,l:r,a:this.a})}lighten(e=10){const t=this.getHue(),n=this.getSaturation();let r=this.getLightness()+e/100;return r>1&&(r=1),this._c({h:t,s:n,l:r,a:this.a})}mix(e,t=50){const n=this._c(e),r=t/100,i=e=>(n[e]-this[e])*r+this[e],o={r:F(i("r")),g:F(i("g")),b:F(i("b")),a:F(100*i("a"))/100};return this._c(o)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const t=this._c(e),n=this.a+t.a*(1-this.a),r=e=>F((this[e]*this.a+t[e]*t.a*(1-this.a))/n);return this._c({r:r("r"),g:r("g"),b:r("b"),a:n})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const t=(this.r||0).toString(16);e+=2===t.length?t:"0"+t;const n=(this.g||0).toString(16);e+=2===n.length?n:"0"+n;const r=(this.b||0).toString(16);if(e+=2===r.length?r:"0"+r,"number"==typeof this.a&&this.a>=0&&this.a<1){const t=F(255*this.a).toString(16);e+=2===t.length?t:"0"+t}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),t=F(100*this.getSaturation()),n=F(100*this.getLightness());return 1!==this.a?`hsla(${e},${t}%,${n}%,${this.a})`:`hsl(${e},${t}%,${n}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return 1!==this.a?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,t,n){const r=this.clone();return r[e]=V(t,n),r}_c(e){return new this.constructor(e)}getMax(){return void 0===this._max&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return void 0===this._min&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const t=e.replace("#","");function n(e,n){return parseInt(t[e]+t[n||e],16)}t.length<6?(this.r=n(0),this.g=n(1),this.b=n(2),this.a=t[3]?n(3)/255:1):(this.r=n(0,1),this.g=n(2,3),this.b=n(4,5),this.a=t[6]?n(6,7)/255:1)}fromHsl({h:e,s:t,l:n,a:r}){if(this._h=e%360,this._s=t,this._l=n,this.a="number"==typeof r?r:1,t<=0){const e=F(255*n);this.r=e,this.g=e,this.b=e}let i=0,o=0,a=0;const s=e/60,l=(1-Math.abs(2*n-1))*t,c=l*(1-Math.abs(s%2-1));s>=0&&s<1?(i=l,o=c):s>=1&&s<2?(i=c,o=l):s>=2&&s<3?(o=l,a=c):s>=3&&s<4?(o=c,a=l):s>=4&&s<5?(i=c,a=l):s>=5&&s<6&&(i=l,a=c);const u=n-l/2;this.r=F(255*(i+u)),this.g=F(255*(o+u)),this.b=F(255*(a+u))}fromHsv({h:e,s:t,v:n,a:r}){this._h=e%360,this._s=t,this._v=n,this.a="number"==typeof r?r:1;const i=F(255*n);if(this.r=i,this.g=i,this.b=i,t<=0)return;const o=e/60,a=Math.floor(o),s=o-a,l=F(n*(1-t)*255),c=F(n*(1-t*s)*255),u=F(n*(1-t*(1-s))*255);switch(a){case 0:this.g=u,this.b=l;break;case 1:this.r=c,this.b=l;break;case 2:this.r=l,this.b=u;break;case 3:this.r=l,this.g=c;break;case 4:this.r=u,this.g=l;break;default:this.g=l,this.b=c}}fromHsvString(e){const t=z(e,B);this.fromHsv({h:t[0],s:t[1],v:t[2],a:t[3]})}fromHslString(e){const t=z(e,B);this.fromHsl({h:t[0],s:t[1],l:t[2],a:t[3]})}fromRgbString(e){const t=z(e,((e,t)=>t.includes("%")?F(e/100*255):e));this.r=t[0],this.g=t[1],this.b=t[2],this.a=t[3]}}var H,G=["b"],W=["v"],q=function(e){return Math.round(Number(e||0))},X=function(e){(0,L.A)(n,e);var t=(0,k.A)(n);function n(e){return(0,R.A)(this,n),t.call(this,function(e){if(e instanceof j)return e;if(e&&"object"===(0,N.A)(e)&&"h"in e&&"b"in e){var t=e,n=t.b,r=(0,O.A)(t,G);return(0,D.A)((0,D.A)({},r),{},{v:n})}return"string"==typeof e&&/hsb/.test(e)?e.replace(/hsb/,"hsv"):e}(e))}return(0,P.A)(n,[{key:"toHsbString",value:function(){var e=this.toHsb(),t=q(100*e.s),n=q(100*e.b),r=q(e.h),i=e.a,o="hsb(".concat(r,", ").concat(t,"%, ").concat(n,"%)"),a="hsba(".concat(r,", ").concat(t,"%, ").concat(n,"%, ").concat(i.toFixed(0===i?0:2),")");return 1===i?o:a}},{key:"toHsb",value:function(){var e=this.toHsv(),t=e.v,n=(0,O.A)(e,W);return(0,D.A)((0,D.A)({},n),{},{b:t,a:this.a})}}]),n}(j);(H="#1677ff")instanceof X||new X(H),n(1470);let $=function(){return(0,P.A)((function e(t){var n;if((0,R.A)(this,e),this.cleared=!1,t instanceof e)return this.metaColor=t.metaColor.clone(),this.colors=null===(n=t.colors)||void 0===n?void 0:n.map((t=>({color:new e(t.color),percent:t.percent}))),void(this.cleared=t.cleared);const r=Array.isArray(t);r&&t.length?(this.colors=t.map((t=>{let{color:n,percent:r}=t;return{color:new e(n),percent:r}})),this.metaColor=new X(this.colors[0].color.metaColor)):this.metaColor=new X(r?"":t),(!t||r&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}),[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return e=this.toHexString(),t=this.metaColor.a<1,e?((e,t)=>(null==e?void 0:e.replace(/[^\w/]/g,"").slice(0,t?8:6))||"")(e,t):"";var e,t}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:e}=this;return e?`linear-gradient(90deg, ${e.map((e=>`${e.color.toRgbString()} ${e.percent}%`)).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(e){return!(!e||this.isGradient()!==e.isGradient())&&(this.isGradient()?this.colors.length===e.colors.length&&this.colors.every(((t,n)=>{const r=e.colors[n];return t.percent===r.percent&&t.color.equals(r.color)})):this.toHexString()===e.toHexString())}}])}();n(2533);var Y=n(4925);const K=e=>{const{paddingInline:t,onlyIconSize:n,paddingBlock:r}=e;return(0,M.oX)(e,{buttonPaddingHorizontal:t,buttonPaddingVertical:r,buttonIconOnlyFontSize:n})},Z=e=>{var t,n,r,i,o,a;const s=null!==(t=e.contentFontSize)&&void 0!==t?t:e.fontSize,l=null!==(n=e.contentFontSizeSM)&&void 0!==n?n:e.fontSize,c=null!==(r=e.contentFontSizeLG)&&void 0!==r?r:e.fontSizeLG,u=null!==(i=e.contentLineHeight)&&void 0!==i?i:(0,Y.k)(s),h=null!==(o=e.contentLineHeightSM)&&void 0!==o?o:(0,Y.k)(l),d=null!==(a=e.contentLineHeightLG)&&void 0!==a?a:(0,Y.k)(c),f=((e,t)=>{const{r:n,g:r,b:i,a:o}=e.toRgb(),a=new X(e.toRgbString()).onBackground(t).toHsv();return o<=.5?a.v>.5:.299*n+.587*r+.114*i>192})(new $(e.colorBgSolid),"#fff")?"#000":"#fff";return{fontWeight:400,defaultShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`,primaryShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`,dangerShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`,primaryColor:e.colorTextLightSolid,dangerColor:e.colorTextLightSolid,borderColorDisabled:e.colorBorder,defaultGhostColor:e.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:e.colorBgContainer,paddingInline:e.paddingContentHorizontal-e.lineWidth,paddingInlineLG:e.paddingContentHorizontal-e.lineWidth,paddingInlineSM:8-e.lineWidth,onlyIconSize:e.fontSizeLG,onlyIconSizeSM:e.fontSizeLG-2,onlyIconSizeLG:e.fontSizeLG+2,groupBorderColor:e.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:e.colorText,textTextHoverColor:e.colorText,textTextActiveColor:e.colorText,textHoverBg:e.colorFillTertiary,defaultColor:e.colorText,defaultBg:e.colorBgContainer,defaultBorderColor:e.colorBorder,defaultBorderColorDisabled:e.colorBorder,defaultHoverBg:e.colorBgContainer,defaultHoverColor:e.colorPrimaryHover,defaultHoverBorderColor:e.colorPrimaryHover,defaultActiveBg:e.colorBgContainer,defaultActiveColor:e.colorPrimaryActive,defaultActiveBorderColor:e.colorPrimaryActive,solidTextColor:f,contentFontSize:s,contentFontSizeSM:l,contentFontSizeLG:c,contentLineHeight:u,contentLineHeightSM:h,contentLineHeightLG:d,paddingBlock:Math.max((e.controlHeight-s*u)/2-e.lineWidth,0),paddingBlockSM:Math.max((e.controlHeightSM-l*h)/2-e.lineWidth,0),paddingBlockLG:Math.max((e.controlHeightLG-c*d)/2-e.lineWidth,0)}},Q=e=>{const{componentCls:t,iconCls:n,fontWeight:r}=e;return{[t]:{outline:"none",position:"relative",display:"inline-flex",gap:e.marginXS,alignItems:"center",justifyContent:"center",fontWeight:r,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${(0,E.zA)(e.lineWidth)} ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:e.colorText,"&:disabled > *":{pointerEvents:"none"},[`> span, ${t}-icon`]:{display:"inline-flex"},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},(0,A.K8)(e)),[`&${t}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${t}-two-chinese-chars > *:not(${n})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},"&-icon-end":{flexDirection:"row-reverse"}}}},J=(e,t,n)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":t,"&:active":n}}),ee=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),te=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.calc(e.controlHeight).div(2).equal(),paddingInlineEnd:e.calc(e.controlHeight).div(2).equal()}),ne=e=>({cursor:"not-allowed",borderColor:e.borderColorDisabled,color:e.colorTextDisabled,background:e.colorBgContainerDisabled,boxShadow:"none"}),re=(e,t,n,r,i,o,a,s)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:n||void 0,background:t,borderColor:r||void 0,boxShadow:"none"},J(e,Object.assign({background:t},a),Object.assign({background:t},s))),{"&:disabled":{cursor:"not-allowed",color:i||void 0,borderColor:o||void 0}})}),ie=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},ne(e))}),oe=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),ae=(e,t,n,r)=>{const i=r&&["link","text"].includes(r)?oe:ie;return Object.assign(Object.assign({},i(e)),J(e.componentCls,t,n))},se=(e,t,n,r,i)=>({[`&${e.componentCls}-variant-solid`]:Object.assign({color:t,background:n},ae(e,r,i))}),le=(e,t,n,r,i)=>({[`&${e.componentCls}-variant-outlined, &${e.componentCls}-variant-dashed`]:Object.assign({borderColor:t,background:n},ae(e,r,i))}),ce=e=>({[`&${e.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),ue=(e,t,n,r)=>({[`&${e.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:t},ae(e,n,r))}),he=(e,t,n,r,i)=>({[`&${e.componentCls}-variant-${n}`]:Object.assign({color:t,boxShadow:"none"},ae(e,r,i,n))}),de=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.defaultColor,boxShadow:e.defaultShadow},se(e,e.solidTextColor,e.colorBgSolid,{background:e.colorBgSolidHover},{background:e.colorBgSolidActive})),ce(e)),ue(e,e.colorFillTertiary,{background:e.colorFillSecondary},{background:e.colorFill})),he(e,e.textTextColor,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),re(e.componentCls,e.ghostBg,e.defaultGhostColor,e.defaultGhostBorderColor,e.colorTextDisabled,e.colorBorder)),fe=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorPrimary,boxShadow:e.primaryShadow},le(e,e.colorPrimary,e.colorBgContainer,{color:e.colorPrimaryTextHover,borderColor:e.colorPrimaryHover,background:e.colorBgContainer},{color:e.colorPrimaryTextActive,borderColor:e.colorPrimaryActive,background:e.colorBgContainer})),ce(e)),ue(e,e.colorPrimaryBg,{background:e.colorPrimaryBgHover},{background:e.colorPrimaryBorder})),he(e,e.colorLink,"text",{color:e.colorPrimaryTextHover,background:e.colorPrimaryBg},{color:e.colorPrimaryTextActive,background:e.colorPrimaryBorder})),re(e.componentCls,e.ghostBg,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),pe=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorError,boxShadow:e.dangerShadow},se(e,e.dangerColor,e.colorError,{background:e.colorErrorHover},{background:e.colorErrorActive})),le(e,e.colorError,e.colorBgContainer,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),ce(e)),ue(e,e.colorErrorBg,{background:e.colorErrorBgFilledHover},{background:e.colorErrorBgActive})),he(e,e.colorError,"text",{color:e.colorErrorHover,background:e.colorErrorBg},{color:e.colorErrorHover,background:e.colorErrorBgActive})),he(e,e.colorError,"link",{color:e.colorErrorHover},{color:e.colorErrorActive})),re(e.componentCls,e.ghostBg,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),me=e=>{const{componentCls:t}=e;return{[`${t}-color-default`]:de(e),[`${t}-color-primary`]:fe(e),[`${t}-color-dangerous`]:pe(e)}},ge=e=>Object.assign(Object.assign(Object.assign(Object.assign({},le(e,e.defaultBorderColor,e.defaultBg,{color:e.defaultHoverColor,borderColor:e.defaultHoverBorderColor,background:e.defaultHoverBg},{color:e.defaultActiveColor,borderColor:e.defaultActiveBorderColor,background:e.defaultActiveBg})),he(e,e.textTextColor,"text",{color:e.textTextHoverColor,background:e.textHoverBg},{color:e.textTextActiveColor,background:e.colorBgTextActive})),se(e,e.primaryColor,e.colorPrimary,{background:e.colorPrimaryHover,color:e.primaryColor},{background:e.colorPrimaryActive,color:e.primaryColor})),he(e,e.colorLink,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),ve=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const{componentCls:n,controlHeight:r,fontSize:i,lineHeight:o,borderRadius:a,buttonPaddingHorizontal:s,iconCls:l,buttonPaddingVertical:c,motionDurationSlow:u,motionEaseInOut:h,buttonIconOnlyFontSize:d,opacityLoading:f}=e;return[{[t]:{fontSize:i,lineHeight:o,height:r,padding:`${(0,E.zA)(c)} ${(0,E.zA)(s)}`,borderRadius:a,[`&${n}-icon-only`]:{width:r,paddingInline:0,[`&${n}-compact-item`]:{flex:"none"},[`&${n}-round`]:{width:"auto"},[l]:{fontSize:d}},[`&${n}-loading`]:{opacity:f,cursor:"default"},[`${n}-loading-icon`]:{transition:`width ${u} ${h}, opacity ${u} ${h}`}}},{[`${n}${n}-circle${t}`]:ee(e)},{[`${n}${n}-round${t}`]:te(e)}]},ye=e=>{const t=(0,M.oX)(e,{fontSize:e.contentFontSize,lineHeight:e.contentLineHeight});return ve(t,e.componentCls)},be=e=>{const t=(0,M.oX)(e,{controlHeight:e.controlHeightSM,fontSize:e.contentFontSizeSM,lineHeight:e.contentLineHeightSM,padding:e.paddingXS,buttonPaddingHorizontal:e.paddingInlineSM,buttonPaddingVertical:e.paddingBlockSM,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.onlyIconSizeSM});return ve(t,`${e.componentCls}-sm`)},_e=e=>{const t=(0,M.oX)(e,{controlHeight:e.controlHeightLG,fontSize:e.contentFontSizeLG,lineHeight:e.contentLineHeightLG,buttonPaddingHorizontal:e.paddingInlineLG,buttonPaddingVertical:e.paddingBlockLG,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.onlyIconSizeLG});return ve(t,`${e.componentCls}-lg`)},we=e=>{const{componentCls:t}=e;return{[t]:{[`&${t}-block`]:{width:"100%"}}}},xe=(0,T.OF)("Button",(e=>{const t=K(e);return[Q(t),ye(t),be(t),_e(t),we(t),me(t),ge(t),I(t)]}),Z,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});var Se=n(5974);function Ee(e,t){return{[`&-item:not(${t}-last-item)`]:{marginBottom:e.calc(e.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function Ae(e){const t=`${e.componentCls}-compact-vertical`;return{[t]:Object.assign(Object.assign({},Ee(e,t)),(n=e.componentCls,r=t,{[`&-item:not(${r}-first-item):not(${r}-last-item)`]:{borderRadius:0},[`&-item${r}-first-item:not(${r}-last-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${r}-last-item:not(${r}-first-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}))};var n,r}const Me=e=>{const{componentCls:t,colorPrimaryHover:n,lineWidth:r,calc:i}=e,o=i(r).mul(-1).equal(),a=e=>({[`${t}-compact${e?"-vertical":""}-item${t}-primary:not([disabled])`]:{"& + &::before":{position:"absolute",top:e?o:0,insetInlineStart:e?0:o,backgroundColor:n,content:'""',width:e?"100%":r,height:e?r:"100%"}}});return Object.assign(Object.assign({},a()),a(!0))},Te=(0,T.bf)(["Button","compact"],(e=>{const t=K(e);return[(0,Se.G)(t),Ae(t),Me(t)]}),Z);const Ce={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["primary","link"],text:["default","text"]},Ie=r.forwardRef(((e,t)=>{var n,i,f,g;const{loading:y=!1,prefixCls:b,color:_,variant:w,type:x,danger:E=!1,shape:A="default",size:M,styles:T,disabled:C,className:I,rootClassName:R,children:P,icon:L,iconPosition:k="start",ghost:D=!1,block:O=!1,htmlType:N="button",classNames:U,style:F={},autoInsertSpace:z,autoFocus:B}=e,V=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace","autoFocus"]),j=x||"default",[H,G]=(0,r.useMemo)((()=>{if(_&&w)return[_,w];const e=Ce[j]||[];return E?["danger",e[1]]:e}),[x,_,w,E]),W="danger"===H?"dangerous":H,{getPrefixCls:q,direction:X,button:$}=(0,r.useContext)(c.QO),Y=null===(n=null!=z?z:null==$?void 0:$.autoInsertSpace)||void 0===n||n,K=q("btn",b),[Z,Q,J]=xe(K),ee=(0,r.useContext)(u.A),te=null!=C?C:ee,ne=(0,r.useContext)(p),re=(0,r.useMemo)((()=>function(e){if("object"==typeof e&&e){let t=null==e?void 0:e.delay;return t=Number.isNaN(t)||"number"!=typeof t?0:t,{loading:t<=0,delay:t}}return{loading:!!e,delay:0}}(y)),[y]),[ie,oe]=(0,r.useState)(re.loading),[ae,se]=(0,r.useState)(!1),le=(0,r.useRef)(),ce=(0,s.xK)(t,le),ue=1===r.Children.count(P)&&!L&&!(0,m.u1)(G);(0,r.useEffect)((()=>{let e=null;return re.delay>0?e=setTimeout((()=>{e=null,oe(!0)}),re.delay):oe(re.loading),function(){e&&(clearTimeout(e),e=null)}}),[re]),(0,r.useEffect)((()=>{if(!le.current||!Y)return;const e=le.current.textContent||"";ue&&(0,m.Ap)(e)?ae||se(!0):ae&&se(!1)})),(0,r.useEffect)((()=>{B&&le.current&&le.current.focus()}),[]);const he=r.useCallback((t=>{var n;ie||te?t.preventDefault():null===(n=e.onClick)||void 0===n||n.call(e,t)}),[e.onClick,ie,te]),{compactSize:de,compactItemClassnames:fe}=(0,d.RQ)(K,X),pe=(0,h.A)((e=>{var t,n;return null!==(n=null!==(t=null!=M?M:de)&&void 0!==t?t:ne)&&void 0!==n?n:e})),me=pe&&null!==(i={large:"lg",small:"sm",middle:void 0}[pe])&&void 0!==i?i:"",ge=ie?"loading":L,ve=(0,a.A)(V,["navigate"]),ye=o()(K,Q,J,{[`${K}-${A}`]:"default"!==A&&A,[`${K}-${j}`]:j,[`${K}-dangerous`]:E,[`${K}-color-${W}`]:W,[`${K}-variant-${G}`]:G,[`${K}-${me}`]:me,[`${K}-icon-only`]:!P&&0!==P&&!!ge,[`${K}-background-ghost`]:D&&!(0,m.u1)(G),[`${K}-loading`]:ie,[`${K}-two-chinese-chars`]:ae&&Y&&!ie,[`${K}-block`]:O,[`${K}-rtl`]:"rtl"===X,[`${K}-icon-end`]:"end"===k},fe,I,R,null==$?void 0:$.className),be=Object.assign(Object.assign({},null==$?void 0:$.style),F),_e=o()(null==U?void 0:U.icon,null===(f=null==$?void 0:$.classNames)||void 0===f?void 0:f.icon),we=Object.assign(Object.assign({},(null==T?void 0:T.icon)||{}),(null===(g=null==$?void 0:$.styles)||void 0===g?void 0:g.icon)||{}),Se=L&&!ie?r.createElement(v,{prefixCls:K,className:_e,style:we},L):r.createElement(S,{existIcon:!!L,prefixCls:K,loading:ie}),Ee=P||0===P?(0,m.uR)(P,ue&&Y):null;if(void 0!==ve.href)return Z(r.createElement("a",Object.assign({},ve,{className:o()(ye,{[`${K}-disabled`]:te}),href:te?void 0:ve.href,style:be,onClick:he,ref:ce,tabIndex:te?-1:0}),Se,Ee));let Ae=r.createElement("button",Object.assign({},V,{type:N,className:ye,style:be,onClick:he,disabled:te,ref:ce}),Se,Ee,fe&&r.createElement(Te,{prefixCls:K}));return(0,m.u1)(G)||(Ae=r.createElement(l.A,{component:"Button",disabled:ie},Ae)),Z(Ae)}));Ie.Group=e=>{const{getPrefixCls:t,direction:n}=r.useContext(c.QO),{prefixCls:i,size:a,className:s}=e,l=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["prefixCls","size","className"]),u=t("btn-group",i),[,,h]=(0,f.Ay)();let d="";switch(a){case"large":d="lg";break;case"small":d="sm"}const m=o()(u,{[`${u}-${d}`]:d,[`${u}-rtl`]:"rtl"===n},s,h);return r.createElement(p.Provider,{value:a},r.createElement("div",Object.assign({},l,{className:m})))},Ie.__ANT_BUTTON=!0;const Re=Ie},8119:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,X:()=>o});var r=n(6540);const i=r.createContext(!1),o=e=>{let{children:t,disabled:n}=e;const o=r.useContext(i);return r.createElement(i.Provider,{value:null!=n?n:o},t)},a=i},8224:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,c:()=>o});var r=n(6540);const i=r.createContext(void 0),o=e=>{let{children:t,size:n}=e;const o=r.useContext(i);return r.createElement(i.Provider,{value:n||o},t)},a=i},2279:(e,t,n)=>{"use strict";n.d(t,{QO:()=>s,lJ:()=>a,pM:()=>o,yH:()=>i});var r=n(6540);const i="ant",o="anticon",a=["outlined","borderless","filled"],s=r.createContext({getPrefixCls:(e,t)=>t||(e?`${i}-${e}`:i),iconPrefixCls:o}),{Consumer:l}=s},829:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(6540),i=n(8224);const o=e=>{const t=r.useContext(i.A);return r.useMemo((()=>e?"string"==typeof e?null!=e?e:t:e instanceof Function?e(t):t:t),[e,t])}},8407:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>G,cr:()=>V});var r=n(6540),i=n.t(r,2),o=n(2187),a=n(1053),s=n(8104),l=n(488),c=n(8877);const u=(0,r.createContext)(void 0);var h=n(1815),d=n(685);const f=e=>{const{locale:t={},children:n,_ANT_MARK__:i}=e;r.useEffect((()=>(0,h.L)(null==t?void 0:t.Modal)),[t]);const o=r.useMemo((()=>Object.assign(Object.assign({},t),{exist:!0})),[t]);return r.createElement(d.A.Provider,{value:o},n)};var p=n(8055),m=n(9806),g=n(723),v=n(2279),y=n(5748),b=n(4978),_=n(998),w=n(5089);const x=`-ant-${Date.now()}-${Math.random()}`;var S=n(8119),E=n(8224);var A=n(3210);const M=Object.assign({},i),{useId:T}=M,C=void 0===T?()=>"":T;var I=n(754),R=n(1320);function P(e){const{children:t}=e,[,n]=(0,R.Ay)(),{motion:i}=n,o=r.useRef(!1);return o.current=o.current||!1===i,o.current?r.createElement(I.Kq,{motion:i},t):t}const L=()=>null;var k=n(2366);const D=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let O,N,U,F;function z(){return O||v.yH}function B(){return N||v.pM}const V=()=>({getPrefixCls:(e,t)=>t||(e?`${z()}-${e}`:z()),getIconPrefixCls:B,getRootPrefixCls:()=>O||z(),getTheme:()=>U,holderRender:F}),j=e=>{const{children:t,csp:n,autoInsertSpaceInButton:i,alert:h,anchor:d,form:y,locale:b,componentSize:_,direction:w,space:x,splitter:M,virtual:T,dropdownMatchSelectWidth:I,popupMatchSelectWidth:R,popupOverflow:O,legacyLocale:N,parentContext:U,iconPrefixCls:F,theme:z,componentDisabled:B,segmented:V,statistic:j,spin:H,calendar:G,carousel:W,cascader:q,collapse:X,typography:$,checkbox:Y,descriptions:K,divider:Z,drawer:Q,skeleton:J,steps:ee,image:te,layout:ne,list:re,mentions:ie,modal:oe,progress:ae,result:se,slider:le,breadcrumb:ce,menu:ue,pagination:he,input:de,textArea:fe,empty:pe,badge:me,radio:ge,rate:ve,switch:ye,transfer:be,avatar:_e,message:we,tag:xe,table:Se,card:Ee,tabs:Ae,timeline:Me,timePicker:Te,upload:Ce,notification:Ie,tree:Re,colorPicker:Pe,datePicker:Le,rangePicker:ke,flex:De,wave:Oe,dropdown:Ne,warning:Ue,tour:Fe,floatButtonGroup:ze,variant:Be,inputNumber:Ve,treeSelect:je}=e,He=r.useCallback(((t,n)=>{const{prefixCls:r}=e;if(n)return n;const i=r||U.getPrefixCls("");return t?`${i}-${t}`:i}),[U.getPrefixCls,e.prefixCls]),Ge=F||U.iconPrefixCls||v.pM,We=n||U.csp;(0,k.A)(Ge,We);const qe=function(e,t,n){var r;(0,c.rJ)("ConfigProvider");const i=e||{},o=!1!==i.inherit&&t?t:Object.assign(Object.assign({},m.sb),{hashed:null!==(r=null==t?void 0:t.hashed)&&void 0!==r?r:m.sb.hashed,cssVar:null==t?void 0:t.cssVar}),a=C();return(0,s.A)((()=>{var r,s;if(!e)return t;const l=Object.assign({},o.components);Object.keys(e.components||{}).forEach((t=>{l[t]=Object.assign(Object.assign({},l[t]),e.components[t])}));const c=`css-var-${a.replace(/:/g,"")}`,u=(null!==(r=i.cssVar)&&void 0!==r?r:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:null==n?void 0:n.prefixCls},"object"==typeof o.cssVar?o.cssVar:{}),"object"==typeof i.cssVar?i.cssVar:{}),{key:"object"==typeof i.cssVar&&(null===(s=i.cssVar)||void 0===s?void 0:s.key)||c});return Object.assign(Object.assign(Object.assign({},o),i),{token:Object.assign(Object.assign({},o.token),i.token),components:l,cssVar:u})}),[i,o],((e,t)=>e.some(((e,n)=>{const r=t[n];return!(0,A.A)(e,r,!0)}))))}(z,U.theme,{prefixCls:He("")}),Xe={csp:We,autoInsertSpaceInButton:i,alert:h,anchor:d,locale:b||N,direction:w,space:x,splitter:M,virtual:T,popupMatchSelectWidth:null!=R?R:I,popupOverflow:O,getPrefixCls:He,iconPrefixCls:Ge,theme:qe,segmented:V,statistic:j,spin:H,calendar:G,carousel:W,cascader:q,collapse:X,typography:$,checkbox:Y,descriptions:K,divider:Z,drawer:Q,skeleton:J,steps:ee,image:te,input:de,textArea:fe,layout:ne,list:re,mentions:ie,modal:oe,progress:ae,result:se,slider:le,breadcrumb:ce,menu:ue,pagination:he,empty:pe,badge:me,radio:ge,rate:ve,switch:ye,transfer:be,avatar:_e,message:we,tag:xe,table:Se,card:Ee,tabs:Ae,timeline:Me,timePicker:Te,upload:Ce,notification:Ie,tree:Re,colorPicker:Pe,datePicker:Le,rangePicker:ke,flex:De,wave:Oe,dropdown:Ne,warning:Ue,tour:Fe,floatButtonGroup:ze,variant:Be,inputNumber:Ve,treeSelect:je},$e=Object.assign({},U);Object.keys(Xe).forEach((e=>{void 0!==Xe[e]&&($e[e]=Xe[e])})),D.forEach((t=>{const n=e[t];n&&($e[t]=n)})),void 0!==i&&($e.button=Object.assign({autoInsertSpace:i},$e.button));const Ye=(0,s.A)((()=>$e),$e,((e,t)=>{const n=Object.keys(e),r=Object.keys(t);return n.length!==r.length||n.some((n=>e[n]!==t[n]))})),Ke=r.useMemo((()=>({prefixCls:Ge,csp:We})),[Ge,We]);let Ze=r.createElement(r.Fragment,null,r.createElement(L,{dropdownMatchSelectWidth:I}),t);const Qe=r.useMemo((()=>{var e,t,n,r;return(0,l.h)((null===(e=p.A.Form)||void 0===e?void 0:e.defaultValidateMessages)||{},(null===(n=null===(t=Ye.locale)||void 0===t?void 0:t.Form)||void 0===n?void 0:n.defaultValidateMessages)||{},(null===(r=Ye.form)||void 0===r?void 0:r.validateMessages)||{},(null==y?void 0:y.validateMessages)||{})}),[Ye,null==y?void 0:y.validateMessages]);Object.keys(Qe).length>0&&(Ze=r.createElement(u.Provider,{value:Qe},Ze)),b&&(Ze=r.createElement(f,{locale:b,_ANT_MARK__:"internalMark"},Ze)),(Ge||We)&&(Ze=r.createElement(a.A.Provider,{value:Ke},Ze)),_&&(Ze=r.createElement(E.c,{size:_},Ze)),Ze=r.createElement(P,null,Ze);const Je=r.useMemo((()=>{const e=qe||{},{algorithm:t,token:n,components:r,cssVar:i}=e,a=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["algorithm","token","components","cssVar"]),s=t&&(!Array.isArray(t)||t.length>0)?(0,o.an)(t):m.zQ,l={};Object.entries(r||{}).forEach((e=>{let[t,n]=e;const r=Object.assign({},n);"algorithm"in r&&(!0===r.algorithm?r.theme=s:(Array.isArray(r.algorithm)||"function"==typeof r.algorithm)&&(r.theme=(0,o.an)(r.algorithm)),delete r.algorithm),l[t]=r}));const c=Object.assign(Object.assign({},g.A),n);return Object.assign(Object.assign({},a),{theme:s,token:c,components:l,override:Object.assign({override:c},l),cssVar:i})}),[qe]);return z&&(Ze=r.createElement(m.vG.Provider,{value:Je},Ze)),Ye.warning&&(Ze=r.createElement(c._n.Provider,{value:Ye.warning},Ze)),void 0!==B&&(Ze=r.createElement(S.X,{disabled:B},Ze)),r.createElement(v.QO.Provider,{value:Ye},Ze)},H=e=>{const t=r.useContext(v.QO),n=r.useContext(d.A);return r.createElement(j,Object.assign({parentContext:t,legacyLocale:n},e))};H.ConfigContext=v.QO,H.SizeContext=E.A,H.config=e=>{const{prefixCls:t,iconPrefixCls:n,theme:r,holderRender:i}=e;void 0!==t&&(O=t),void 0!==n&&(N=n),"holderRender"in e&&(F=i),r&&(function(e){return Object.keys(e).some((e=>e.endsWith("Color")))}(r)?function(e,t){const n=function(e,t){const n={},r=(e,t)=>{let n=e.clone();return n=(null==t?void 0:t(n))||n,n.toRgbString()},i=(e,t)=>{const i=new b.q(e),o=(0,y.cM)(i.toRgbString());n[`${t}-color`]=r(i),n[`${t}-color-disabled`]=o[1],n[`${t}-color-hover`]=o[4],n[`${t}-color-active`]=o[6],n[`${t}-color-outline`]=i.clone().setAlpha(.2).toRgbString(),n[`${t}-color-deprecated-bg`]=o[0],n[`${t}-color-deprecated-border`]=o[2]};if(t.primaryColor){i(t.primaryColor,"primary");const e=new b.q(t.primaryColor),o=(0,y.cM)(e.toRgbString());o.forEach(((e,t)=>{n[`primary-${t+1}`]=e})),n["primary-color-deprecated-l-35"]=r(e,(e=>e.lighten(35))),n["primary-color-deprecated-l-20"]=r(e,(e=>e.lighten(20))),n["primary-color-deprecated-t-20"]=r(e,(e=>e.tint(20))),n["primary-color-deprecated-t-50"]=r(e,(e=>e.tint(50))),n["primary-color-deprecated-f-12"]=r(e,(e=>e.setAlpha(.12*e.getAlpha())));const a=new b.q(o[0]);n["primary-color-active-deprecated-f-30"]=r(a,(e=>e.setAlpha(.3*e.getAlpha()))),n["primary-color-active-deprecated-d-02"]=r(a,(e=>e.darken(2)))}return t.successColor&&i(t.successColor,"success"),t.warningColor&&i(t.warningColor,"warning"),t.errorColor&&i(t.errorColor,"error"),t.infoColor&&i(t.infoColor,"info"),`\n  :root {\n    ${Object.keys(n).map((t=>`--${e}-${t}: ${n[t]};`)).join("\n")}\n  }\n  `.trim()}(e,t);(0,_.A)()&&(0,w.BD)(n,`${x}-dynamic-theme`)}(z(),r):U=r)},H.useConfig=function(){return{componentDisabled:(0,r.useContext)(S.A),componentSize:(0,r.useContext)(E.A)}},Object.defineProperty(H,"SizeContext",{get:()=>E.A});const G=H},685:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=(0,n(6540).createContext)(void 0)},8055:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(6069),i=n(9379);const o=(0,i.A)((0,i.A)({},{yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0}),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"}),a={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},s={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},o),timePickerLocale:Object.assign({},a)},l=s,c="${label} is not a valid ${type}",u={locale:"en",Pagination:r.A,DatePicker:s,TimePicker:a,Calendar:l,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:c,method:c,array:c,object:c,number:c,date:c,boolean:c,integer:c,float:c,regexp:c,email:c,url:c,hex:c},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}}},1815:(e,t,n)=>{"use strict";n.d(t,{L:()=>s,l:()=>l});var r=n(8055);let i=Object.assign({},r.A.Modal),o=[];const a=()=>o.reduce(((e,t)=>Object.assign(Object.assign({},e),t)),r.A.Modal);function s(e){if(e){const t=Object.assign({},e);return o.push(t),i=a(),()=>{o=o.filter((e=>e!==t)),i=a()}}i=Object.assign({},r.A.Modal)}function l(){return i}},6327:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>m,K6:()=>f,RQ:()=>d});var r=n(6540),i=n(6942),o=n.n(i),a=n(2546),s=n(2279),l=n(829),c=n(5447),u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const h=r.createContext(null),d=(e,t)=>{const n=r.useContext(h),i=r.useMemo((()=>{if(!n)return"";const{compactDirection:r,isFirstItem:i,isLastItem:a}=n,s="vertical"===r?"-vertical-":"-";return o()(`${e}-compact${s}item`,{[`${e}-compact${s}first-item`]:i,[`${e}-compact${s}last-item`]:a,[`${e}-compact${s}item-rtl`]:"rtl"===t})}),[e,t,n]);return{compactSize:null==n?void 0:n.compactSize,compactDirection:null==n?void 0:n.compactDirection,compactItemClassnames:i}},f=e=>{let{children:t}=e;return r.createElement(h.Provider,{value:null},t)},p=e=>{var{children:t}=e,n=u(e,["children"]);return r.createElement(h.Provider,{value:n},t)},m=e=>{const{getPrefixCls:t,direction:n}=r.useContext(s.QO),{size:i,direction:d,block:f,prefixCls:m,className:g,rootClassName:v,children:y}=e,b=u(e,["size","direction","block","prefixCls","className","rootClassName","children"]),_=(0,l.A)((e=>null!=i?i:e)),w=t("space-compact",m),[x,S]=(0,c.A)(w),E=o()(w,S,{[`${w}-rtl`]:"rtl"===n,[`${w}-block`]:f,[`${w}-vertical`]:"vertical"===d},g,v),A=r.useContext(h),M=(0,a.A)(y),T=r.useMemo((()=>M.map(((e,t)=>{const n=(null==e?void 0:e.key)||`${w}-item-${t}`;return r.createElement(p,{key:n,compactSize:_,compactDirection:d,isFirstItem:0===t&&(!A||(null==A?void 0:A.isFirstItem)),isLastItem:t===M.length-1&&(!A||(null==A?void 0:A.isLastItem))},e)}))),[i,M,A]);return 0===M.length?null:x(r.createElement("div",Object.assign({className:E},b),T))}},5447:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(7358),i=n(4277);const o=e=>{const{componentCls:t}=e;return{[t]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},a=e=>{const{componentCls:t,antCls:n}=e;return{[t]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${t}-item:empty`]:{display:"none"},[`${t}-item > ${n}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},s=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-row-small":{rowGap:e.spaceGapSmallSize},"&-gap-row-middle":{rowGap:e.spaceGapMiddleSize},"&-gap-row-large":{rowGap:e.spaceGapLargeSize},"&-gap-col-small":{columnGap:e.spaceGapSmallSize},"&-gap-col-middle":{columnGap:e.spaceGapMiddleSize},"&-gap-col-large":{columnGap:e.spaceGapLargeSize}}}},l=(0,r.OF)("Space",(e=>{const t=(0,i.oX)(e,{spaceGapSmallSize:e.paddingXS,spaceGapMiddleSize:e.padding,spaceGapLargeSize:e.paddingLG});return[a(t),s(t),o(t)]}),(()=>({})),{resetStyle:!1})},5974:(e,t,n)=>{"use strict";function r(e,t,n){const{focusElCls:r,focus:i,borderElCls:o}=n,a=o?"> *":"",s=["hover",i?"focus":null,"active"].filter(Boolean).map((e=>`&:${e} ${a}`)).join(",");return{[`&-item:not(${t}-last-item)`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[s]:{zIndex:2}},r?{[`&${r}`]:{zIndex:2}}:{}),{[`&[disabled] ${a}`]:{zIndex:0}})}}function i(e,t,n){const{borderElCls:r}=n,i=r?`> ${r}`:"";return{[`&-item:not(${t}-first-item):not(${t}-last-item) ${i}`]:{borderRadius:0},[`&-item:not(${t}-last-item)${t}-first-item`]:{[`& ${i}, &${e}-sm ${i}, &${e}-lg ${i}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${t}-first-item)${t}-last-item`]:{[`& ${i}, &${e}-sm ${i}, &${e}-lg ${i}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{focus:!0};const{componentCls:n}=e,o=`${n}-compact`;return{[o]:Object.assign(Object.assign({},r(e,o,t)),i(n,o,t))}}n.d(t,{G:()=>o})},5905:(e,t,n)=>{"use strict";n.d(t,{K8:()=>h,L9:()=>i,Nk:()=>a,av:()=>l,dF:()=>o,jk:()=>u,t6:()=>s,vj:()=>c});var r=n(2187);const i={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:t?"inherit":e.fontFamily}},a=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),s=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),l=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active, &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),c=(e,t,n,r)=>{const i=`[class^="${t}"], [class*=" ${t}"]`,o=n?`.${n}`:i,a={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let s={};return!1!==r&&(s={fontFamily:e.fontFamily,fontSize:e.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},s),a),{[i]:a})}},u=e=>({outline:`${(0,r.zA)(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),h=e=>({"&:focus-visible":Object.assign({},u(e))})},9806:(e,t,n)=>{"use strict";n.d(t,{sb:()=>l,vG:()=>c,zQ:()=>s});var r=n(6540),i=n(2187),o=n(4184),a=n(723);const s=(0,i.an)(o.A),l={token:a.A,override:{override:a.A},hashed:!0},c=r.createContext(l)},4184:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r=n(5748),i=n(723),o=n(7484);const a=e=>{let t=e,n=e,r=e,i=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?n=4:e<8&&e>=7?n=5:e<14&&e>=8?n=6:e<16&&e>=14?n=7:e>=16&&(n=8),e<6&&e>=2?r=1:e>=6&&(r=2),e>4&&e<8?i=4:e>=8&&(i=6),{borderRadius:e,borderRadiusXS:r,borderRadiusSM:n,borderRadiusLG:t,borderRadiusOuter:i}};var s=n(8690),l=n(1892),c=n(4978);const u=(e,t)=>new c.q(e).setAlpha(t).toRgbString(),h=(e,t)=>new c.q(e).darken(t).toHexString(),d=e=>{const t=(0,r.cM)(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}},f=(e,t)=>{const n=e||"#fff",r=t||"#000";return{colorBgBase:n,colorTextBase:r,colorText:u(r,.88),colorTextSecondary:u(r,.65),colorTextTertiary:u(r,.45),colorTextQuaternary:u(r,.25),colorFill:u(r,.15),colorFillSecondary:u(r,.06),colorFillTertiary:u(r,.04),colorFillQuaternary:u(r,.02),colorBgSolid:u(r,1),colorBgSolidHover:u(r,.75),colorBgSolidActive:u(r,.95),colorBgLayout:h(n,4),colorBgContainer:h(n,0),colorBgElevated:h(n,0),colorBgSpotlight:u(r,.85),colorBgBlur:"transparent",colorBorder:h(n,15),colorBorderSecondary:h(n,6)}};function p(e){r.uy.pink=r.uy.magenta,r.UA.pink=r.UA.magenta;const t=Object.keys(i.r).map((t=>{const n=e[t]===r.uy[t]?r.UA[t]:(0,r.cM)(e[t]);return new Array(10).fill(1).reduce(((e,r,i)=>(e[`${t}-${i+1}`]=n[i],e[`${t}${i+1}`]=n[i],e)),{})})).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),(0,o.A)(e,{generateColorPalettes:d,generateNeutralColorPalettes:f})),(0,l.A)(e.fontSize)),function(e){const{sizeUnit:t,sizeStep:n}=e;return{sizeXXL:t*(n+8),sizeXL:t*(n+4),sizeLG:t*(n+2),sizeMD:t*(n+1),sizeMS:t*n,size:t*n,sizeSM:t*(n-1),sizeXS:t*(n-2),sizeXXS:t*(n-3)}}(e)),(0,s.A)(e)),function(e){const{motionUnit:t,motionBase:n,borderRadius:r,lineWidth:i}=e;return Object.assign({motionDurationFast:`${(n+t).toFixed(1)}s`,motionDurationMid:`${(n+2*t).toFixed(1)}s`,motionDurationSlow:`${(n+3*t).toFixed(1)}s`,lineWidthBold:i+1},a(r))}(e))}},723:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,r:()=>r});const r={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},i=Object.assign(Object.assign({},r),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,\n'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',\n'Noto Color Emoji'",fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0})},7484:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(4978);function i(e,t){let{generateColorPalettes:n,generateNeutralColorPalettes:i}=t;const{colorSuccess:o,colorWarning:a,colorError:s,colorInfo:l,colorPrimary:c,colorBgBase:u,colorTextBase:h}=e,d=n(c),f=n(o),p=n(a),m=n(s),g=n(l),v=i(u,h),y=n(e.colorLink||e.colorInfo),b=new r.q(m[1]).mix(new r.q(m[3]),50).toHexString();return Object.assign(Object.assign({},v),{colorPrimaryBg:d[1],colorPrimaryBgHover:d[2],colorPrimaryBorder:d[3],colorPrimaryBorderHover:d[4],colorPrimaryHover:d[5],colorPrimary:d[6],colorPrimaryActive:d[7],colorPrimaryTextHover:d[8],colorPrimaryText:d[9],colorPrimaryTextActive:d[10],colorSuccessBg:f[1],colorSuccessBgHover:f[2],colorSuccessBorder:f[3],colorSuccessBorderHover:f[4],colorSuccessHover:f[4],colorSuccess:f[6],colorSuccessActive:f[7],colorSuccessTextHover:f[8],colorSuccessText:f[9],colorSuccessTextActive:f[10],colorErrorBg:m[1],colorErrorBgHover:m[2],colorErrorBgFilledHover:b,colorErrorBgActive:m[3],colorErrorBorder:m[3],colorErrorBorderHover:m[4],colorErrorHover:m[5],colorError:m[6],colorErrorActive:m[7],colorErrorTextHover:m[8],colorErrorText:m[9],colorErrorTextActive:m[10],colorWarningBg:p[1],colorWarningBgHover:p[2],colorWarningBorder:p[3],colorWarningBorderHover:p[4],colorWarningHover:p[4],colorWarning:p[6],colorWarningActive:p[7],colorWarningTextHover:p[8],colorWarningText:p[9],colorWarningTextActive:p[10],colorInfoBg:g[1],colorInfoBgHover:g[2],colorInfoBorder:g[3],colorInfoBorderHover:g[4],colorInfoHover:g[4],colorInfo:g[6],colorInfoActive:g[7],colorInfoTextHover:g[8],colorInfoText:g[9],colorInfoTextActive:g[10],colorLinkHover:y[4],colorLink:y[6],colorLinkActive:y[7],colorBgMask:new r.q("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},8690:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=e=>{const{controlHeight:t}=e;return{controlHeightSM:.75*t,controlHeightXS:.5*t,controlHeightLG:1.25*t}}},1892:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(4925);const i=e=>{const t=(0,r.A)(e),n=t.map((e=>e.size)),i=t.map((e=>e.lineHeight)),o=n[1],a=n[0],s=n[2],l=i[1],c=i[0],u=i[2];return{fontSizeSM:a,fontSize:o,fontSizeLG:s,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:l,lineHeightLG:u,lineHeightSM:c,fontHeight:Math.round(l*o),fontHeightLG:Math.round(u*s),fontHeightSM:Math.round(c*a),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}}},4925:(e,t,n)=>{"use strict";function r(e){return(e+8)/e}function i(e){const t=new Array(10).fill(null).map(((t,n)=>{const r=n-1,i=e*Math.pow(Math.E,r/5),o=n>1?Math.floor(i):Math.ceil(i);return 2*Math.floor(o/2)}));return t[1]=e,t.map((e=>({size:e,lineHeight:r(e)})))}n.d(t,{A:()=>i,k:()=>r})},1320:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>p,Is:()=>u});var r=n(6540),i=n(2187);const o="5.22.3";var a=n(9806),s=n(723),l=n(3894),c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const u={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},h={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},d={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},f=(e,t,n)=>{const r=n.getDerivativeToken(e),{override:i}=t,o=c(t,["override"]);let a=Object.assign(Object.assign({},r),{override:i});return a=(0,l.A)(a),o&&Object.entries(o).forEach((e=>{let[t,n]=e;const{theme:r}=n,i=c(n,["theme"]);let o=i;r&&(o=f(Object.assign(Object.assign({},a),i),{override:i},r)),a[t]=o})),a};function p(){const{token:e,hashed:t,theme:n,override:c,cssVar:p}=r.useContext(a.vG),m=`${o}-${t||""}`,g=n||a.zQ,[v,y,b]=(0,i.hV)(g,[s.A,e],{salt:m,override:c,getComputedToken:f,formatToken:l.A,cssVar:p&&{prefix:p.prefix,key:p.key,unitless:u,ignore:h,preserve:d}});return[g,b,t?y:"",v,p]}},3894:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(4978),i=n(723);function o(e){return e>=0&&e<=255}const a=function(e,t){const{r:n,g:i,b:a,a:s}=new r.q(e).toRgb();if(s<1)return e;const{r:l,g:c,b:u}=new r.q(t).toRgb();for(let e=.01;e<=1;e+=.01){const t=Math.round((n-l*(1-e))/e),s=Math.round((i-c*(1-e))/e),h=Math.round((a-u*(1-e))/e);if(o(t)&&o(s)&&o(h))return new r.q({r:t,g:s,b:h,a:Math.round(100*e)/100}).toRgbString()}return new r.q({r:n,g:i,b:a,a:1}).toRgbString()};var s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function l(e){const{override:t}=e,n=s(e,["override"]),o=Object.assign({},t);Object.keys(i.A).forEach((e=>{delete o[e]}));const l=Object.assign(Object.assign({},n),o);if(!1===l.motion){const e="0s";l.motionDurationFast=e,l.motionDurationMid=e,l.motionDurationSlow=e}return Object.assign(Object.assign(Object.assign({},l),{colorFillContent:l.colorFillSecondary,colorFillContentHover:l.colorFill,colorFillAlter:l.colorFillQuaternary,colorBgContainerDisabled:l.colorFillTertiary,colorBorderBg:l.colorBgContainer,colorSplit:a(l.colorBorderSecondary,l.colorBgContainer),colorTextPlaceholder:l.colorTextQuaternary,colorTextDisabled:l.colorTextQuaternary,colorTextHeading:l.colorText,colorTextLabel:l.colorTextSecondary,colorTextDescription:l.colorTextTertiary,colorTextLightSolid:l.colorWhite,colorHighlight:l.colorError,colorBgTextHover:l.colorFillSecondary,colorBgTextActive:l.colorFill,colorIcon:l.colorTextTertiary,colorIconHover:l.colorText,colorErrorOutline:a(l.colorErrorBg,l.colorBgContainer),colorWarningOutline:a(l.colorWarningBg,l.colorBgContainer),fontSizeIcon:l.fontSizeSM,lineWidthFocus:3*l.lineWidth,lineWidth:l.lineWidth,controlOutlineWidth:2*l.lineWidth,controlInteractiveSize:l.controlHeight/2,controlItemBgHover:l.colorFillTertiary,controlItemBgActive:l.colorPrimaryBg,controlItemBgActiveHover:l.colorPrimaryBgHover,controlItemBgActiveDisabled:l.colorFill,controlTmpOutline:l.colorFillQuaternary,controlOutline:a(l.colorPrimaryBg,l.colorBgContainer),lineType:l.lineType,borderRadius:l.borderRadius,borderRadiusXS:l.borderRadiusXS,borderRadiusSM:l.borderRadiusSM,borderRadiusLG:l.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:l.sizeXXS,paddingXS:l.sizeXS,paddingSM:l.sizeSM,padding:l.size,paddingMD:l.sizeMD,paddingLG:l.sizeLG,paddingXL:l.sizeXL,paddingContentHorizontalLG:l.sizeLG,paddingContentVerticalLG:l.sizeMS,paddingContentHorizontal:l.sizeMS,paddingContentVertical:l.sizeSM,paddingContentHorizontalSM:l.size,paddingContentVerticalSM:l.sizeXS,marginXXS:l.sizeXXS,marginXS:l.sizeXS,marginSM:l.sizeSM,margin:l.size,marginMD:l.sizeMD,marginLG:l.sizeLG,marginXL:l.sizeXL,marginXXL:l.sizeXXL,boxShadow:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowSecondary:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowTertiary:"\n      0 1px 2px 0 rgba(0, 0, 0, 0.03),\n      0 1px 6px -1px rgba(0, 0, 0, 0.02),\n      0 2px 4px 0 rgba(0, 0, 0, 0.02)\n    ",screenXS:480,screenXSMin:480,screenXSMax:575,screenSM:576,screenSMMin:576,screenSMMax:767,screenMD:768,screenMDMin:768,screenMDMax:991,screenLG:992,screenLGMin:992,screenLGMax:1199,screenXL:1200,screenXLMin:1200,screenXLMax:1599,screenXXL:1600,screenXXLMin:1600,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`\n      0 1px 2px -2px ${new r.q("rgba(0, 0, 0, 0.16)").toRgbString()},\n      0 3px 6px 0 ${new r.q("rgba(0, 0, 0, 0.12)").toRgbString()},\n      0 5px 12px 4px ${new r.q("rgba(0, 0, 0, 0.09)").toRgbString()}\n    `,boxShadowDrawerRight:"\n      -6px 0 16px 0 rgba(0, 0, 0, 0.08),\n      -3px 0 6px -4px rgba(0, 0, 0, 0.12),\n      -9px 0 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerLeft:"\n      6px 0 16px 0 rgba(0, 0, 0, 0.08),\n      3px 0 6px -4px rgba(0, 0, 0, 0.12),\n      9px 0 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerUp:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerDown:"\n      0 -6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 -3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 -9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),o)}},7358:(e,t,n)=>{"use strict";n.d(t,{OF:()=>c,Or:()=>u,bf:()=>h});var r=n(6540),i=n(4277),o=n(2279),a=n(5905),s=n(1320),l=n(2366);const{genStyleHooks:c,genComponentStyleHook:u,genSubStyleComponent:h}=(0,i.L_)({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=(0,r.useContext)(o.QO);return{rootPrefixCls:e(),iconPrefixCls:t}},useToken:()=>{const[e,t,n,r,i]=(0,s.Ay)();return{theme:e,realToken:t,hashId:n,token:r,cssVar:i}},useCSP:()=>{const{csp:e,iconPrefixCls:t}=(0,r.useContext)(o.QO);return(0,l.A)(t,e),null!=e?e:{}},getResetStyles:e=>[{"&":(0,a.av)(e)}],getCommonStyle:a.vj,getCompUnitless:()=>s.Is})},2366:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(2187),i=n(5905),o=n(1320);const a=(e,t)=>{const[n,a]=(0,o.Ay)();return(0,r.IV)({theme:n,token:a,hashId:"",path:["ant-design-icons",e],nonce:()=>null==t?void 0:t.nonce,layer:{name:"antd"}},(()=>[{[`.${e}`]:Object.assign(Object.assign({},(0,i.Nk)()),{[`.${e} .${e}-icon`]:{display:"block"}})}]))}},1130:(e,t,n)=>{"use strict";n.d(t,{A:()=>C});var r=n(2187),i=n(4184),o=n(723),a=n(3894);var s=n(1320),l=n(9806),c=n(8690),u=n(1892);var h=n(5748),d=n(7484),f=n(4978);const p=(e,t)=>new f.q(e).setAlpha(t).toRgbString(),m=(e,t)=>new f.q(e).lighten(t).toHexString(),g=e=>{const t=(0,h.cM)(e,{theme:"dark"});return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[6],6:t[5],7:t[4],8:t[6],9:t[5],10:t[4]}},v=(e,t)=>{const n=e||"#000",r=t||"#fff";return{colorBgBase:n,colorTextBase:r,colorText:p(r,.85),colorTextSecondary:p(r,.65),colorTextTertiary:p(r,.45),colorTextQuaternary:p(r,.25),colorFill:p(r,.18),colorFillSecondary:p(r,.12),colorFillTertiary:p(r,.08),colorFillQuaternary:p(r,.04),colorBgSolid:p(r,.95),colorBgSolidHover:p(r,1),colorBgSolidActive:p(r,.9),colorBgElevated:m(n,12),colorBgContainer:m(n,8),colorBgLayout:m(n,0),colorBgSpotlight:m(n,26),colorBgBlur:p(r,.04),colorBorder:m(n,26),colorBorderSecondary:m(n,19)}},y={defaultSeed:l.sb.token,useToken:function(){const[e,t,n]=(0,s.Ay)();return{theme:e,token:t,hashId:n}},defaultAlgorithm:i.A,darkAlgorithm:(e,t)=>{const n=Object.keys(o.r).map((t=>{const n=(0,h.cM)(e[t],{theme:"dark"});return new Array(10).fill(1).reduce(((e,r,i)=>(e[`${t}-${i+1}`]=n[i],e[`${t}${i+1}`]=n[i],e)),{})})).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{}),r=null!=t?t:(0,i.A)(e);return Object.assign(Object.assign(Object.assign({},r),n),(0,d.A)(e,{generateColorPalettes:g,generateNeutralColorPalettes:v}))},compactAlgorithm:(e,t)=>{const n=null!=t?t:(0,i.A)(e),r=n.fontSizeSM,o=n.controlHeight-4;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),function(e){const{sizeUnit:t,sizeStep:n}=e,r=n-2;return{sizeXXL:t*(r+10),sizeXL:t*(r+6),sizeLG:t*(r+2),sizeMD:t*(r+2),sizeMS:t*(r+1),size:t*r,sizeSM:t*r,sizeXS:t*(r-1),sizeXXS:t*(r-1)}}(null!=t?t:e)),(0,u.A)(r)),{controlHeight:o}),(0,c.A)(Object.assign(Object.assign({},n),{controlHeight:o})))},getDesignToken:e=>{const t=(null==e?void 0:e.algorithm)?(0,r.an)(e.algorithm):(0,r.an)(i.A),n=Object.assign(Object.assign({},o.A),null==e?void 0:e.token);return(0,r.lO)(n,{override:null==e?void 0:e.token},t,a.A)},defaultConfig:l.sb,_internalContext:l.vG};var b,_,w=n(8407),x=n(6540),S=n(1250);function E(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var A={black:"#000000",white:"#ffffff",ltGrey:"#bfbfbf",purpleGrey:"#aeacae",medLtGreyAlt:"#a0a0a0",medGrey:"#6e6e6e",medDarkGrey:"#4b4b4b",darkGrey:"#313131",veryDarkGrey:"#222222",ltPurple:"#aa88ed",medPurple:"#9e6aff",darkPurple:"#7e46d4",veryDarkPurple:"#5f369f",veryLtPurple:"#e7e4f2",brightRed:"#ff4d4d",brightGreen:"#61d900",brightBlue:"#0099ff"},M={colors:{theme:{primary:A.medPurple,primaryLt:A.ltPurple,primaryDk:A.darkPurple,success:A.brightGreen,error:A.brightRed,warning:A.brightRed,info:A.brightBlue},text:{link:A.brightBlue,header:A.ltGrey,section:A.white,body:A.ltGrey,error:A.brightRed,selectionBg:A.medPurple,selectionText:A.white},header:{bg:A.veryDarkGrey,border:A.medGrey,title:A.white,hoverTitle:A.white},button:{primary:{bg:A.medPurple,text:A.white,hoverBg:A.ltPurple,activeOutline:A.medPurple,disabledBg:A.medDarkGrey},link:{text:A.medPurple},secondary:{bg:"transparent",text:A.medPurple,outline:A.medPurple},tertiary:{bg:"transparent",text:A.ltGrey,outline:A.ltGrey,hoverOutline:A.ltPurple,hoverText:A.ltPurple,activeOutline:A.medPurple,activatedText:A.white,activatedBg:A.medDarkGrey,activatedOutline:A.purpleGrey,disabledText:A.medGrey}},checkbox:{bg:A.medGrey,hoverBg:A.medLtGreyAlt,text:A.white},controlPanel:{bg:A.darkGrey,border:A.medGrey,sectionText:A.white,text:A.ltGrey,sectionBg:A.medDarkGrey,drawerBg:A.veryDarkGrey,rampSlider:A.medPurple},toolbar:{buttonBg:"#000000cc"},landingPage:{bg:A.veryDarkGrey,bgAlt:A.darkGrey,text:A.ltGrey,bannerBg:"#020202DB"},statusFlag:{border:A.medGrey,text:A.ltGrey},layout:{dividers:A.medGrey,split:A.white},menu:{hoverText:A.white,hoverBg:A.ltPurple,selectedText:A.white,selectedBg:A.medGrey,textPlaceholder:A.ltPurple},tooltip:{bg:A.black},modal:{maskBg:"#000000cc",bg:A.veryDarkGrey,border:A.medDarkGrey}},fonts:{family:"'Open Sans', 'Open Sans Local', Arial, sans-serif, apple-system, BlinkMacSystemFont, 'Segoe UI','PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'"}},T=S.Ay.div(b||(b=E(["\n  width: 100%;\n  height: 100%;\n\n  ",'\n\n  h1, h2, h3, h4, p {\n    font-family: var(--font-family);\n  }\n\n  h1 {\n    color: var(--color-text-header);\n    font-size: 28px;\n    font-weight: 400;\n  }\n\n  h2 {\n    color: var(--color-text-section);\n    font-size: 19px;\n    font-weight: 400;\n  }\n\n  h3 {\n    color: var(--color-text-header);\n    font-size: 16px;\n    font-weight: 600;\n  }\n\n  h4 {\n    color: var(--color-text-header);\n    font-size: 14px;\n    font-weight: 400;\n  }\n\n  p {\n    color: var(--color-text-body);\n    font-size: 14px;\n    font-weight: 400;\n  }\n\n  a {\n    color: var(--color-text-link);\n  }\n\n  & *::selection {\n    background-color: var(--color-text-selection-bg);\n    color: var(--color-text-selection-text);\n  }\n\n  /** TODO: Go through these styles and see if we can use Ant ConfigProvider for them instead. */\n  .ant-btn-link,\n  .ant-btn-text,\n  .ant-btn-primary,\n  .ant-btn-icon-only {\n    box-shadow: none;\n\n    &:hover:not(:disabled),\n    &:focus-visible:not(:disabled) {\n      background-color: var(--color-button-primary-hover-bg);\n      border-color: var(--color-button-primary-hover-bg);\n      color: var(--color-button-primary-text);\n    }\n\n    &:active:not(:disabled) {\n      background-color: var(--color-button-primary-hover-bg);\n      border: 1px solid var(--color-button-primary-active-outline);\n      color: var(--color-button-primary-text);\n    }\n  }\n\n  /* Let us use buttons with type="text" as purely semantic containers - don\'t bring any styling! */\n  .ant-btn-text {\n    width: unset;\n    height: unset;\n    padding: unset;\n\n    &:hover:not(:disabled),\n    &:focus-visible:not(:disabled) {\n      background-color: unset;\n      border-color: transparent;\n    }\n  }\n\n  .ant-btn-icon-only:disabled {\n    color: var(--color-button-icon-disabled-text);\n  }\n\n  .ant-btn-link:not(:disabled) {\n    // Change from default blue link text\n    color: var(--color-button-link-text);\n  }\n\n  /**\n   * Tertiary style buttons. Grey outline by default, turns to light\n   * purple outline on hover.\n   */\n  .ant-btn-default:not(.ant-btn-icon-only) {\n    background-color: var(--color-button-tertiary-bg);\n    color: var(--color-button-tertiary-text);\n    border-color: var(--color-button-tertiary-outline);\n\n    &:hover:not(:disabled),\n    &:focus-visible:not(:disabled) {\n      background-color: transparent;\n      border-color: var(--color-button-tertiary-hover-bg);\n      color: var(--color-button-tertiary-hover-text);\n    }\n\n    &:active:not(:disabled) {\n      background-color: transparent;\n      border-color: var(--color-button-tertiary-active-outline);\n      color: var(--color-button-tertiary-active-text);\n    }\n  }\n\n  // Overrides for checkbox styling\n  & .ant-checkbox-input {\n    &:hover,\n    &:focus-visible {\n      border: 1px solid white;\n    }\n  }\n\n  & .ant-checkbox.ant-checkbox-checked {\n    background-color: var(--color-checkbox-bg);\n  }\n\n  .ant-checkbox-inner {\n    background-color: transparent !important;\n  }\n\n  // Add outlines to modals and dropdowns\n  & .ant-select-dropdown,\n  & .ant-dropdown-menu,\n  & .ant-modal-content {\n    border: 1px solid var(--color-modal-border);\n  }\n\n  // Force active/hovered text to be white instead of grey for better contrast\n  & .ant-dropdown-menu-item-active {\n    color: var(--color-menu-hover-text);\n  }\n\n  // Remove padding in dropdown menus and make items reactangular + flush with the edge\n  & .ant-dropdown-menu,\n  & .ant-select-dropdown {\n    padding: 0;\n    overflow: hidden;\n\n    & .ant-dropdown-menu-item,\n    & .ant-select-item {\n      border-radius: 0;\n    }\n  }\n'])),(function(e){var t=e.$theme;return(0,S.AH)(_||(_=E(["\n      /* Component and color variables. */\n      // TODO: Fix inconsistent use of border vs. outline\n      // TODO: Remove variables that aren't used in other CSS files. These should be set directly\n      // from the $theme object to reduce unnecessary variables.\n      --color-text-link: ",";\n      --color-text-header: ",";\n      --color-text-section: ",";\n      --color-text-body: ",";\n      --color-text-error: ",";\n\n      --color-text-selection-bg: ",";\n      --color-text-selection-text: ",";\n\n      --color-header-title: ",";\n      --color-header-hover-title: ",";\n      --color-header-bg: ",";\n      --color-header-border: ",";\n\n      --color-button-primary-bg: ",";\n      --color-button-primary-text: ",";\n      --color-button-primary-hover-bg: ",";\n      --color-button-primary-active-bg: ",";\n      --color-button-primary-active-outline: ",";\n      --color-button-primary-disabled-bg: ",";\n\n      --color-button-link-text: ",";\n\n      --color-button-secondary-bg: ",";\n      --color-button-secondary-text: ",";\n      --color-button-secondary-outline: ",";\n\n      --color-button-tertiary-bg: transparent;\n      --color-button-tertiary-text: ",";\n      --color-button-tertiary-outline: ",";\n      --color-button-tertiary-hover-outline: ",";\n      --color-button-tertiary-hover-text: ",";\n      --color-button-tertiary-active-outline: ",";\n      --color-button-tertiary-active-text: ",";\n\n      --color-button-icon-disabled-text: ",";\n      --color-button-icon-disabled-text: ",";\n      --color-button-icon-activated-text: ",";\n      --color-button-icon-activated-bg: ",";\n      --color-button-icon-activated-outline: ",";\n\n      --color-toolbar-button-bg: ",";\n\n      --color-controlpanel-bg: ",";\n      --color-controlpanel-border: ",";\n      --color-controlpanel-section-text: ",";\n      --color-controlpanel-text: ",";\n      --color-controlpanel-section-bg: ",";\n      --color-controlpanel-drawer-bg: ",";\n      --color-controlpanel-ramp-slider: ",";\n\n      --color-landingpage-bg: ",";\n      --color-landingpage-bg-alt: ",";\n      --color-landingpage-text: ",";\n      --color-landingpage-banner-highlight-bg: ",";\n\n      --color-statusflag-border: ",";\n      --color-statusflag-text: ",";\n\n      --color-layout-dividers: ",";\n\n      --color-modal-border: ",";\n\n      --color-menu-hover-text: ",";\n      --color-menu-selected-text: ",";\n\n      --color-checkbox-bg: ",";\n\n      --font-family: ",";\n    "])),t.colors.text.link,t.colors.text.header,t.colors.text.section,t.colors.text.body,t.colors.text.error,t.colors.text.selectionBg,t.colors.text.selectionText,t.colors.header.title,t.colors.header.hoverTitle,t.colors.header.bg,t.colors.header.border,t.colors.button.primary.bg,t.colors.button.primary.text,t.colors.button.primary.hoverBg,t.colors.button.primary.hoverBg,t.colors.button.primary.activeOutline,t.colors.button.primary.disabledBg,t.colors.button.link.text,t.colors.button.secondary.bg,t.colors.button.secondary.text,t.colors.button.secondary.outline,t.colors.button.tertiary.text,t.colors.button.tertiary.outline,t.colors.button.tertiary.hoverOutline,t.colors.button.tertiary.hoverText,t.colors.button.tertiary.activeOutline,t.colors.button.tertiary.hoverText,t.colors.button.tertiary.disabledText,t.colors.button.tertiary.disabledText,t.colors.button.tertiary.activatedText,t.colors.button.tertiary.activatedBg,t.colors.button.tertiary.activatedOutline,t.colors.toolbar.buttonBg,t.colors.controlPanel.bg,t.colors.controlPanel.border,t.colors.controlPanel.sectionText,t.colors.controlPanel.text,t.colors.controlPanel.sectionBg,t.colors.controlPanel.drawerBg,t.colors.controlPanel.rampSlider,t.colors.landingPage.bg,t.colors.landingPage.bgAlt,t.colors.landingPage.text,t.colors.landingPage.bannerBg,t.colors.statusFlag.border,t.colors.statusFlag.text,t.colors.layout.dividers,t.colors.modal.border,t.colors.menu.hoverText,t.colors.menu.selectedText,t.colors.checkbox.bg,t.fonts.family)}));function C(e){var t=y.darkAlgorithm;return x.createElement(w.Ay,{theme:{algorithm:t,token:{colorPrimary:M.colors.theme.primary,colorPrimaryHover:M.colors.theme.primaryLt,colorLink:M.colors.text.link,colorBgBase:M.colors.controlPanel.bg,colorBgContainer:"transparent",colorSplit:M.colors.layout.split,colorPrimaryTextHover:M.colors.text.selectionText,fontWeightStrong:400,colorBgElevated:A.darkGrey,controlItemBgHover:M.colors.menu.hoverBg,controlItemBgActiveHover:M.colors.menu.hoverBg,controlItemBgActive:M.colors.menu.selectedBg,borderRadius:4},components:{Button:{defaultShadow:"",primaryColor:M.colors.button.primary.text,defaultHoverBg:M.colors.button.secondary.bg,defaultActiveBg:M.colors.button.secondary.bg,defaultActiveBorderColor:M.colors.button.tertiary.activeOutline},Card:{borderRadiusLG:0,headerHeight:48},Collapse:{borderRadiusLG:0,colorTextHeading:M.colors.text.section},Divider:{colorSplit:M.colors.layout.dividers,marginLG:0},Layout:{siderBg:M.colors.controlPanel.bg},Checkbox:{borderRadiusSM:2,colorBgContainer:M.colors.checkbox.bg,colorPrimary:M.colors.checkbox.bg,colorPrimaryHover:M.colors.checkbox.hoverBg,colorText:M.colors.checkbox.text},Tooltip:{colorBgSpotlight:M.colors.tooltip.bg},Modal:{colorBgMask:M.colors.modal.maskBg,contentBg:M.colors.modal.bg,headerBg:M.colors.modal.bg,footerBg:M.colors.modal.bg,titleFontSize:19}}}},x.createElement(T,{$theme:M},e.children))}},4270:(e,t,n)=>{"use strict";n.d(t,{$m:()=>k,BO:()=>p,CB:()=>l,Ci:()=>x,D8:()=>C,D_:()=>E,EB:()=>L,L9:()=>M,Lr:()=>w,N1:()=>A,UB:()=>f,Wv:()=>S,YT:()=>_,g1:()=>N,iz:()=>O,jR:()=>y,kP:()=>P,lI:()=>d,lV:()=>s,n1:()=>b,uR:()=>c,xB:()=>m,yu:()=>g});var r=n(4421),i=n(4381);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t,n){return(t=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=970,l=200,c=235,u=[0,0,0],h=[255,255,255],d=[16,16],f=[120,12],p=.5,m=.983,g=255,v=[35,140,255],y="Other",b="Channels",_=[255,255,255],w=255,x=1e9,S=10,E=4,A={t:r.HA.T_PLUS,z:r.HA.Z_PLUS,y:r.HA.Y_PLUS,x:r.HA.X_PLUS},M={int8:{min:-Math.pow(2,7),max:Math.pow(2,7)-1},int16:{min:-Math.pow(2,15),max:Math.pow(2,15)-1},int32:{min:-Math.pow(2,31),max:Math.pow(2,31)-1},uint8:{min:0,max:Math.pow(2,8)-1},uint16:{min:0,max:Math.pow(2,16)-1},uint32:{min:0,max:Math.pow(2,32)-1},float32:{min:0,max:Math.pow(2,8)-1},float64:{min:0,max:Math.pow(2,8)-1}},T=[[226,205,179],[111,186,17],[141,163,192],[245,241,203],[224,227,209],[221,155,245],[227,244,245],[255,98,0],[247,219,120]],C=Object.freeze([{colors:T,name:"Default"},{colors:[[190,68,171],[189,211,75],[61,155,169],[128,128,128],[255,255,255],[239,27,45],[238,77,245],[96,255,255]],name:"Thumbnail colors"},{colors:[[128,0,0],[0,128,0],[0,0,128],[32,32,32],[255,255,0],[255,0,255],[0,255,0],[0,0,255]],name:"RGB colors"},{colors:[[128,0,128],[128,128,128],[0,128,128],[128,128,0],[255,255,255],[255,0,0],[255,0,255],[0,255,255]],name:"White structure"}]),I=a(a(a(a({},i.nE.threeD,[0,0,5]),i.nE.xy,[0,0,2]),i.nE.xz,[0,2,0]),i.nE.yz,[2,0,0]),R=a(a(a(a({},i.nE.threeD,[0,1,0]),i.nE.xy,[0,1,0]),i.nE.xz,[0,0,1]),i.nE.yz,[0,0,1]),P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.nE.threeD;return{position:I[e],target:[0,0,0],up:R[e],fov:20,orthoScale:.5}},L=function(){return{groups:[{name:"Channels",channels:[{match:[0,1,2],enabled:!0},{match:"(.+)",enabled:!1}]}]}},k=function(){return{viewMode:i.nE.threeD,renderMode:i.G9.volumetric,imageType:i.yj.segmentedCell,showAxes:!1,showBoundingBox:!1,backgroundColor:u,boundingBoxColor:h,autorotate:!1,maskAlpha:0,brightness:70,density:50,levels:v,interpolationEnabled:!0,region:{x:[0,1],y:[0,1],z:[0,1]},slice:{x:.5,y:.5,z:.5},time:0,scene:0,cameraState:void 0}},D=T;function O(e){return D[e%D.length]}var N=function(){return{name:"",displayName:"",volumeEnabled:!1,isosurfaceEnabled:!1,colorizeEnabled:!1,colorizeAlpha:1,isovalue:128,opacity:1,color:O(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0),useControlPoints:!1,ramp:[0,w],controlPoints:[{x:0,opacity:0,color:[255,255,255]},{x:255,opacity:1,color:[255,255,255]}],plotMin:0,plotMax:w}}},4381:(e,t,n)=>{"use strict";n.d(t,{G9:()=>i,nE:()=>r,yj:()=>o});var r=function(e){return e.threeD="3D",e.xy="XY",e.xz="XZ",e.yz="YZ",e}({}),i=function(e){return e.volumetric="volumetric",e.maxProject="maxproject",e.pathTrace="pathtrace",e}({}),o=function(e){return e.segmentedCell="cell",e.fullField="fov",e}({})},4368:(e,t,n)=>{"use strict";n.d(t,{k:()=>o,YD:()=>s,en:()=>c});var r=n(6540);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(null,arguments)}const o=function(e){return r.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 83.85 84.84",role:"img"},e),r.createElement("defs",null,r.createElement("style",null,".cls-2{fill:#fff}")),r.createElement("g",{"data-name":"Layer 1"},r.createElement("path",{d:"M27.87 17.74a42.6 42.6 0 0 0 0-15.28 41.6 41.6 0 0 0-13.08 7.64 41.9 41.9 0 0 0 13.08 7.64M22.91 31.31a43 43 0 0 0 4.41-11.06 44.6 44.6 0 0 1-14.41-8.43 42.5 42.5 0 0 0-11.7 20.46 44.8 44.8 0 0 1 14.4 8.41 42 42 0 0 0 7.3-9.38M56 17.74a41.9 41.9 0 0 0 13.07-7.64A41.8 41.8 0 0 0 56 2.47a42.8 42.8 0 0 0 0 15.27M.69 50a42.1 42.1 0 0 0 13-7.62 42.1 42.1 0 0 0-13-7.62A42.4 42.4 0 0 0 .69 50M56 67.1a43 43 0 0 0 0 15.27 41.9 41.9 0 0 0 13-7.63 41.9 41.9 0 0 0-13-7.64M82.64 52.55a44.6 44.6 0 0 1-14.39-8.41 42.2 42.2 0 0 0-7.31 9.38 42.8 42.8 0 0 0-4.39 11.07A44.6 44.6 0 0 1 71 73a42.53 42.53 0 0 0 11.64-20.45M12.91 73a44.4 44.4 0 0 1 14.4-8.43 42.6 42.6 0 0 0-4.4-11.06 42.3 42.3 0 0 0-7.3-9.39 44.6 44.6 0 0 1-14.4 8.42A42.56 42.56 0 0 0 12.91 73M68.25 40.69a44.8 44.8 0 0 1 14.39-8.41 42.5 42.5 0 0 0-11.7-20.46 44.3 44.3 0 0 1-14.39 8.42 42.8 42.8 0 0 0 4.39 11.07 41.8 41.8 0 0 0 7.31 9.38M83.16 34.8a42.2 42.2 0 0 0-13 7.62 42.4 42.4 0 0 0 13 7.62 42.4 42.4 0 0 0 0-15.24M30.25 66.32a45.4 45.4 0 0 1 0 16.83 41.24 41.24 0 0 0 23.37 0 45.6 45.6 0 0 1 0-16.83 41.17 41.17 0 0 0-23.35 0M27.83 82.37a43 43 0 0 0 0-15.27 41.7 41.7 0 0 0-13 7.64 41.7 41.7 0 0 0 13 7.63M53.6 18.52a45.8 45.8 0 0 1 0-16.84 41.4 41.4 0 0 0-23.35 0 45 45 0 0 1 0 16.85 41.6 41.6 0 0 0 11.68 1.67 41.3 41.3 0 0 0 11.67-1.68",className:"cls-2"}),r.createElement("path",{d:"M58.76 32.58A45.4 45.4 0 0 1 54.14 21a44 44 0 0 1-12.21 1.74A43.6 43.6 0 0 1 29.73 21a45.4 45.4 0 0 1-4.64 11.57 45 45 0 0 1-7.63 9.84 44.3 44.3 0 0 1 7.63 9.83 45 45 0 0 1 4.62 11.58 43.75 43.75 0 0 1 24.43 0 45.8 45.8 0 0 1 4.62-11.58 44.6 44.6 0 0 1 7.63-9.83 45 45 0 0 1-7.63-9.84",style:{fill:"#fff"}})))};function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(null,arguments)}const s=function(e){return r.createElement("svg",a({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 329.24 84.84",role:"img"},e),r.createElement("defs",null,r.createElement("style",null,".cls-1,.cls-2{fill:#fff}")),r.createElement("g",{id:"Layer_2","data-name":"Layer 2"},r.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},r.createElement("path",{d:"M264.93 32.04h-1.49V18.5h-4.93v-1.35h11.35v1.35h-4.93zM274.39 30.69h7.87v1.35h-9.37V17.15h9.12v1.35h-7.62v5.11h7.12v1.34h-7.12zM249.94 32.48a5.7 5.7 0 0 1-2.72-.58 5 5 0 0 1-1.69-1.46 5.5 5.5 0 0 1-.86-1.93 8.7 8.7 0 0 1-.24-2v-9.3h1.5v9.17a7.2 7.2 0 0 0 .21 1.75 4.3 4.3 0 0 0 .67 1.52 3.4 3.4 0 0 0 1.24 1.07 4.56 4.56 0 0 0 3.78 0 3.6 3.6 0 0 0 1.24-1.07 4.5 4.5 0 0 0 .67-1.52 7.2 7.2 0 0 0 .21-1.75v-9.17h1.5v9.34a8.7 8.7 0 0 1-.24 2 5.4 5.4 0 0 1-.87 1.93 5 5 0 0 1-1.69 1.46 5.7 5.7 0 0 1-2.71.58",className:"cls-1"}),r.createElement("path",{d:"M294.43 26h-1.6l-1 6.07h-1l1.03-6.07h-1.44l.16-.82H292l.32-1.87a5.3 5.3 0 0 1 .27-1 2.8 2.8 0 0 1 .51-.81 2.4 2.4 0 0 1 .75-.55 2.3 2.3 0 0 1 1-.21h.4a2 2 0 0 1 .4.08l-.23.86a2.4 2.4 0 0 0-.68-.09 1.3 1.3 0 0 0-.61.14 1.24 1.24 0 0 0-.42.37 2.2 2.2 0 0 0-.27.57 4 4 0 0 0-.17.69l-.27 1.79h1.63ZM301.52 28a2.5 2.5 0 0 0-.15-.88 2 2 0 0 0-.43-.7 1.8 1.8 0 0 0-.69-.46 2.2 2.2 0 0 0-.91-.17 2.5 2.5 0 0 0-1.17.27 2.9 2.9 0 0 0-.93.74 3.7 3.7 0 0 0-.62 1.07 3.7 3.7 0 0 0-.22 1.3 2.5 2.5 0 0 0 .14.87 2 2 0 0 0 1.11 1.17 2.4 2.4 0 0 0 .91.17 2.7 2.7 0 0 0 1.2-.27 3 3 0 0 0 .93-.74 3.4 3.4 0 0 0 .61-1.07 4 4 0 0 0 .22-1.3m-3 4.2a3.4 3.4 0 0 1-1.26-.22 3 3 0 0 1-1-.61 2.7 2.7 0 0 1-.65-.94 3.2 3.2 0 0 1-.23-1.22 4.8 4.8 0 0 1 .29-1.64 4.5 4.5 0 0 1 .84-1.35 4.1 4.1 0 0 1 1.28-.92 3.8 3.8 0 0 1 1.63-.34 3.7 3.7 0 0 1 1.28.21 3 3 0 0 1 1 .62 2.7 2.7 0 0 1 .64.94 2.9 2.9 0 0 1 .23 1.2 4.6 4.6 0 0 1-.29 1.67 4.05 4.05 0 0 1-.88 1.4 3.9 3.9 0 0 1-1.28.91 3.8 3.8 0 0 1-1.63.34M305.68 25.94c.05-.29.08-.56.1-.79h.93c0 .19 0 .39-.07.62s-.06.41-.09.56a3 3 0 0 1 1-1 2.36 2.36 0 0 1 1.31-.38h.33l.31.06-.23.94-.27-.06a3 3 0 0 0-.4 0 2 2 0 0 0-.77.15 1.85 1.85 0 0 0-.7.46 3.2 3.2 0 0 0-.55.81 4.4 4.4 0 0 0-.36 1.19l-.62 3.5h-1l.93-5.37c0-.19.08-.43.12-.73",className:"cls-2"}),r.createElement("path",{d:"M217.64 32.04h-1.49V18.5h-4.93v-1.35h11.35v1.35h-4.93zM225.6 17.15h1.5v14.89h-1.5zM236.55 32.04h-1.49V18.5h-4.93v-1.35h11.35v1.35h-4.93zM207.89 19.55a3.7 3.7 0 0 0-1.23-1.09 3.74 3.74 0 0 0-1.8-.41 4 4 0 0 0-1.11.17 3.1 3.1 0 0 0-1 .52 2.6 2.6 0 0 0-.74.87 2.55 2.55 0 0 0-.28 1.24A2.3 2.3 0 0 0 202 22a2.7 2.7 0 0 0 .71.79 4.5 4.5 0 0 0 1 .53l1.19.42c.51.17 1 .35 1.54.55a5.4 5.4 0 0 1 1.4.77 3.6 3.6 0 0 1 1 1.19 3.9 3.9 0 0 1 .39 1.84 4.1 4.1 0 0 1-.42 1.93 4 4 0 0 1-1.09 1.33 4.6 4.6 0 0 1-1.53.78 6.2 6.2 0 0 1-1.74.25 6.7 6.7 0 0 1-1.33-.13 6.3 6.3 0 0 1-1.27-.41 4.9 4.9 0 0 1-1.12-.7 5.2 5.2 0 0 1-.91-1l1.29-1a3.8 3.8 0 0 0 1.34 1.33 3.7 3.7 0 0 0 2 .54 3.9 3.9 0 0 0 1.15-.18 3.2 3.2 0 0 0 1-.54 3.1 3.1 0 0 0 .78-.91 2.84 2.84 0 0 0 0-2.54 2.8 2.8 0 0 0-.81-.87 4.7 4.7 0 0 0-1.14-.57c-.43-.16-.88-.31-1.35-.47a14 14 0 0 1-1.43-.52 4.8 4.8 0 0 1-1.27-.77 3.55 3.55 0 0 1-.91-1.17 3.9 3.9 0 0 1-.34-1.7 3.75 3.75 0 0 1 .43-1.85 3.8 3.8 0 0 1 1.11-1.28 4.7 4.7 0 0 1 1.52-.74 6.2 6.2 0 0 1 1.64-.23 5.55 5.55 0 0 1 2.55.54 4.3 4.3 0 0 1 1.6 1.27ZM105.75 26.74h6.49L109 18.83ZM103.59 32H102l6.36-14.89h1.45L116.08 32h-1.66l-1.62-3.91h-7.61ZM120.57 30.69h6.86v1.35h-8.36V17.15h1.5zM132 30.69h6.86v1.35h-8.36V17.15h1.5zM143.43 30.69h7.88v1.35h-9.37V17.15h9.12v1.35h-7.63v5.11h7.13v1.34h-7.13zM165.5 29.83h.04V17.15h1.5v14.89h-1.87l-8.56-12.81h-.05v12.81h-1.49V17.15h1.87zM177.81 17.15h1.5v14.89h-1.5zM194.47 29.83h.04V17.15h1.5v14.89h-1.87l-8.56-12.81h-.05v12.81h-1.49V17.15h1.87z",className:"cls-1"}),r.createElement("path",{d:"M120.75 61.51a10 10 0 0 1-1.4 1.66 9 9 0 0 1-1.9 1.38 10.4 10.4 0 0 1-2.39.94 11.1 11.1 0 0 1-2.85.35 12.3 12.3 0 0 1-4.77-.91 11.2 11.2 0 0 1-3.76-2.53 11.3 11.3 0 0 1-2.47-3.83 13.7 13.7 0 0 1 0-9.71 11.4 11.4 0 0 1 6.26-6.35 12.1 12.1 0 0 1 4.72-.91 11.3 11.3 0 0 1 2.47.26 12 12 0 0 1 2.27.75 9.5 9.5 0 0 1 1.93 1.15 6.7 6.7 0 0 1 1.45 1.52l-1.93 1.43a6.3 6.3 0 0 0-1-1.11 6.6 6.6 0 0 0-1.4-1 9 9 0 0 0-1.76-.69 7.8 7.8 0 0 0-2.05-.26 9.4 9.4 0 0 0-4 .81 8.9 8.9 0 0 0-3 2.2 9.5 9.5 0 0 0-1.87 3.2 11.4 11.4 0 0 0-.65 3.83 11.1 11.1 0 0 0 .66 3.83 9.7 9.7 0 0 0 1.89 3.2 8.9 8.9 0 0 0 3 2.19 9.14 9.14 0 0 0 3.94.82 8.75 8.75 0 0 0 3.74-.82 7 7 0 0 0 3-2.61ZM128.35 63.17h12.21v2.08h-14.53V42.18h14.14v2.09h-11.82v7.92h11.05v2.08h-11.05zM148.71 63.17h10.63v2.08h-12.95V42.18h2.32zM166.42 63.17h10.63v2.08H164.1V42.18h2.32zM201.44 45.9a5.6 5.6 0 0 0-1.9-1.68 5.8 5.8 0 0 0-2.81-.64 6 6 0 0 0-1.7.26 5 5 0 0 0-1.58.8 3.93 3.93 0 0 0-1.58 3.28 3.53 3.53 0 0 0 .42 1.82A3.8 3.8 0 0 0 193.4 51a6.7 6.7 0 0 0 1.57.83l1.84.65c.8.26 1.6.54 2.4.85a8.9 8.9 0 0 1 2.17 1.18 5.7 5.7 0 0 1 1.62 1.83 5.9 5.9 0 0 1 .61 2.85 6.5 6.5 0 0 1-.65 3 6.4 6.4 0 0 1-1.69 2.07 7 7 0 0 1-2.38 1.2 9.5 9.5 0 0 1-2.69.39 10.4 10.4 0 0 1-2.06-.21 8.7 8.7 0 0 1-2-.64 7.8 7.8 0 0 1-1.74-1.07 7.5 7.5 0 0 1-1.42-1.5l2-1.5A6 6 0 0 0 193 63a5.8 5.8 0 0 0 3.15.83 6.1 6.1 0 0 0 1.77-.27 5 5 0 0 0 1.62-.85 4.8 4.8 0 0 0 1.2-1.4 3.9 3.9 0 0 0 .46-1.94 4 4 0 0 0-.46-2 4.3 4.3 0 0 0-1.2-1.37 7.6 7.6 0 0 0-1.78-.9c-.66-.24-1.36-.48-2.09-.72s-1.49-.51-2.22-.81a7.7 7.7 0 0 1-2-1.19 5.6 5.6 0 0 1-1.4-1.81 6 6 0 0 1-.53-2.64 5.9 5.9 0 0 1 .66-2.87 6.1 6.1 0 0 1 1.72-2 7.3 7.3 0 0 1 2.39-1.06 9.3 9.3 0 0 1 2.54-.35 8.6 8.6 0 0 1 4 .83 6.75 6.75 0 0 1 2.48 2ZM229 61.51a9.4 9.4 0 0 1-1.4 1.66 9 9 0 0 1-1.9 1.38 10.5 10.5 0 0 1-2.38.94 11.2 11.2 0 0 1-2.85.35 12.25 12.25 0 0 1-4.77-.91 11.2 11.2 0 0 1-3.7-2.53 11.5 11.5 0 0 1-2.47-3.83 13.7 13.7 0 0 1 0-9.71A11.6 11.6 0 0 1 212 45a11.4 11.4 0 0 1 3.77-2.53 12 12 0 0 1 4.72-.91 11.3 11.3 0 0 1 2.46.26 11.6 11.6 0 0 1 2.27.75 9.5 9.5 0 0 1 1.93 1.15 6.5 6.5 0 0 1 1.45 1.52l-1.93 1.43a5.9 5.9 0 0 0-.95-1.11 6.6 6.6 0 0 0-1.4-1 9 9 0 0 0-1.76-.69 7.8 7.8 0 0 0-2-.26 9.4 9.4 0 0 0-4 .81 8.9 8.9 0 0 0-3 2.2 9.5 9.5 0 0 0-1.87 3.2 11.4 11.4 0 0 0-.64 3.83 11.1 11.1 0 0 0 .66 3.83 9.8 9.8 0 0 0 1.88 3.2 9 9 0 0 0 3 2.19 9.2 9.2 0 0 0 3.95.82 8.7 8.7 0 0 0 3.73-.82 7.1 7.1 0 0 0 3-2.61ZM234.22 42.18h2.32v23.07h-2.32zM246.21 63.17h12.2v2.08h-14.52V42.18h14.14v2.09h-11.82v7.92h11.05v2.08h-11.05zM280.42 61.84h.06V42.18h2.32v23.08h-2.9l-13.27-19.85h-.07v19.85h-2.31V42.18h2.9zM309.44 61.51a9.5 9.5 0 0 1-1.44 1.66 8.7 8.7 0 0 1-1.89 1.38 10.4 10.4 0 0 1-2.39.94 11.1 11.1 0 0 1-2.85.35 12.25 12.25 0 0 1-4.77-.91 11.2 11.2 0 0 1-3.76-2.53 11.3 11.3 0 0 1-2.47-3.83 13.7 13.7 0 0 1 0-9.71 11.4 11.4 0 0 1 6.26-6.35 12.1 12.1 0 0 1 4.72-.91 11.3 11.3 0 0 1 2.47.26 12 12 0 0 1 2.27.75 9.5 9.5 0 0 1 1.93 1.15 6.7 6.7 0 0 1 1.48 1.52l-1.93 1.43a6.3 6.3 0 0 0-.95-1.11 6.6 6.6 0 0 0-1.4-1 9 9 0 0 0-1.76-.69 7.8 7.8 0 0 0-2.05-.26 9.4 9.4 0 0 0-4 .81 8.8 8.8 0 0 0-3 2.2 9.5 9.5 0 0 0-1.87 3.2 11.4 11.4 0 0 0-.65 3.83 11.1 11.1 0 0 0 .66 3.83 9.7 9.7 0 0 0 1.89 3.2 8.9 8.9 0 0 0 3 2.19 9.14 9.14 0 0 0 3.94.82 8.75 8.75 0 0 0 3.74-.82 7 7 0 0 0 3-2.61ZM317.04 63.17h12.21v2.09h-14.53V42.18h14.14v2.09h-11.82v7.92h11.05v2.08h-11.05zM27.87 17.74a42.6 42.6 0 0 0 0-15.28 41.6 41.6 0 0 0-13.08 7.64 41.9 41.9 0 0 0 13.08 7.64M22.91 31.31a43 43 0 0 0 4.41-11.06 44.6 44.6 0 0 1-14.41-8.43 42.5 42.5 0 0 0-11.7 20.46 44.8 44.8 0 0 1 14.4 8.41 42 42 0 0 0 7.3-9.38M56 17.74a41.9 41.9 0 0 0 13.07-7.64A41.8 41.8 0 0 0 56 2.47a42.8 42.8 0 0 0 0 15.27M.69 50a42.1 42.1 0 0 0 13-7.62 42.1 42.1 0 0 0-13-7.62A42.4 42.4 0 0 0 .69 50M56 67.1a43 43 0 0 0 0 15.27 41.9 41.9 0 0 0 13-7.63 41.9 41.9 0 0 0-13-7.64M82.64 52.55a44.6 44.6 0 0 1-14.39-8.41 42.2 42.2 0 0 0-7.31 9.38 42.8 42.8 0 0 0-4.39 11.07A44.6 44.6 0 0 1 71 73a42.53 42.53 0 0 0 11.64-20.45M12.91 73a44.4 44.4 0 0 1 14.4-8.43 42.6 42.6 0 0 0-4.4-11.06 42.3 42.3 0 0 0-7.3-9.39 44.6 44.6 0 0 1-14.4 8.42A42.56 42.56 0 0 0 12.91 73M68.25 40.69a44.8 44.8 0 0 1 14.39-8.41 42.5 42.5 0 0 0-11.7-20.46 44.3 44.3 0 0 1-14.39 8.42 42.8 42.8 0 0 0 4.39 11.07 41.8 41.8 0 0 0 7.31 9.38M83.16 34.8a42.2 42.2 0 0 0-13 7.62 42.4 42.4 0 0 0 13 7.62 42.4 42.4 0 0 0 0-15.24M30.25 66.32a45.4 45.4 0 0 1 0 16.83 41.24 41.24 0 0 0 23.37 0 45.6 45.6 0 0 1 0-16.83 41.17 41.17 0 0 0-23.35 0M27.83 82.37a43 43 0 0 0 0-15.27 41.7 41.7 0 0 0-13 7.64 41.7 41.7 0 0 0 13 7.63M53.6 18.52a45.8 45.8 0 0 1 0-16.84 41.4 41.4 0 0 0-23.35 0 45 45 0 0 1 0 16.85 41.6 41.6 0 0 0 11.68 1.67 41.3 41.3 0 0 0 11.67-1.68",className:"cls-2"}),r.createElement("path",{d:"M58.76 32.58A45.4 45.4 0 0 1 54.14 21a44 44 0 0 1-12.21 1.74A43.6 43.6 0 0 1 29.73 21a45.4 45.4 0 0 1-4.64 11.57 45 45 0 0 1-7.63 9.84 44.3 44.3 0 0 1 7.63 9.83 45 45 0 0 1 4.62 11.58 43.75 43.75 0 0 1 24.43 0 45.8 45.8 0 0 1 4.62-11.58 44.6 44.6 0 0 1 7.63-9.83 45 45 0 0 1-7.63-9.84",className:"cls-1"}))))};function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(null,arguments)}const c=function(e){return r.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,viewBox:"0 0 12 12",role:"img"},e),r.createElement("path",{fill:"currentColor",d:"M1.117 3.12a.47.47 0 0 1 .662.035L6.006 7.85l4.227-4.695a.469.469 0 1 1 .697.627L6.372 8.845A.47.47 0 0 1 6.006 9a.47.47 0 0 1-.366-.155L1.082 3.782a.47.47 0 0 1 .035-.662"}))}},9084:(e,t,n)=>{"use strict";n.d(t,{A:()=>w,v:()=>p});var r,i,o,a,s,l=n(6540),c=n(4976),u=n(1250),h=n(4368),d=n(3301);function f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var p=61,m=(0,u.Ay)(c.N_)(r||(r=f(["\n  &&,\n  && h1 {\n    color: var(--color-header-title);\n    font-size: 20px;\n    margin: 0;\n\n    &:hover {\n      color: var(--color-header-hover-title);\n    }\n    /* Do not show underline on app title link */\n    text-decoration: none;\n  }\n"]))),g=u.Ay.a(i||(i=f(["\n  position: relative;\n  width: 140px;\n  height: 36px;\n\n  div > svg:last-child {\n    display: none;\n  }\n\n  // Toggle between the two logos based on the currently available screen real estate\n  // Width is determined here experimentally to prevent popping as the other buttons in the header wrap.\n  @media only screen and (max-width: ","px) {\n    & {\n      max-width: 36px;\n      max-height: 36px;\n    }\n\n    & > div > svg:first-child {\n      display: none;\n    }\n\n    & > div > svg:last-child {\n      display: block;\n      visibility: visible;\n    }\n  }\n"])),610),v=u.Ay.div(o||(o=f(["\n  height: 24px;\n  width: 1px;\n  background-color: var(--color-layout-dividers);\n  display: inline-block;\n  margin: 0 16px;\n\n  @media only screen and (max-width: ","px) {\n    margin: 0 10px;\n  }\n"])),610);function y(e){var t=e.noNavigate;return l.createElement(d.eJ,null,l.createElement(g,{href:"https://www.allencell.org/",rel:"noopener noreferrer",target:"_blank"},l.createElement("div",{title:"https://www.allencell.org"},l.createElement(h.YD,null),l.createElement(h.k,null))),l.createElement(v,null),l.createElement(m,{to:"/","aria-label":"Go to home page",rel:"noopener noreferrer",target:t?"_blank":void 0},l.createElement("h1",null,"Vol-E")))}var b=u.Ay.div(a||(a=f(["\n  position: sticky;\n  z-index: 2000;\n  top: 0;\n  left: 0;\n"]))),_=(0,u.Ay)(d.eJ)(s||(s=f(["\n  flex-wrap: wrap;\n  justify-content: space-between;\n  width: auto;\n  height: fit-content;\n  min-height: var(--header-content-height);\n  padding: 12px 20px;\n  border-bottom: 1px solid var(--color-header-border);\n  gap: 10px;\n  position: sticky;\n  background-color: var(--color-header-bg);\n"])));function w(e){return l.createElement(b,null,l.createElement(_,null,l.createElement(y,{noNavigate:e.noNavigate}),e.title&&l.createElement("h3",{style:{margin:0}},e.title),e.children),e.alertElement)}},3301:(e,t,n)=>{"use strict";n.d(t,{Gr:()=>w,I1:()=>g,Ye:()=>y,eJ:()=>b,s6:()=>_,yY:()=>v});var r,i,o,a,s,l,c,u=n(6188),h=n(982),d=n(6540),f=n(1250);function p(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var m=f.Ay.div(r||(r=p(["\n  display: flex;\n  ","\n"])),(function(e){if(e.$gap)return(0,f.AH)(i||(i=p(["\n        gap: ","px;\n      "])),e.$gap)})),g=(0,f.Ay)(m)(o||(o=p(["\n  flex-direction: column;\n"]))),v=(0,f.Ay)(g)(a||(a=p(["\n  align-items: center;\n"]))),y=(0,f.Ay)(m)(s||(s=p(["\n  flex-direction: row;\n"]))),b=(0,f.Ay)(y)(l||(l=p(["\n  align-items: center;\n"]))),_=f.Ay.span(c||(c=p(["\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n"])));function w(e){return d.createElement("a",{href:e.href,style:{whiteSpace:"nowrap"},rel:"noopener noreferrer",target:"_blank"},e.children,d.createElement(h.g,{icon:u.k02,size:"sm",style:{marginBottom:"0px",marginLeft:"3px"}}))}},2387:(e,t,n)=>{"use strict";n.d(t,{RM:()=>G,$7:()=>H,am:()=>Pe,AY:()=>je,bT:()=>ze,wu:()=>Ve});var r,i,o,a,s,l,c,u,h,d,f,p,m,g,v,y,b,_,w=n(2543),x=n(4270),S=n(4381);function E(e){var t={};for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}function A(e,t){var n={};for(var r in e)(0,w.isEqual)(e[r],t[r])||(n[r]=e[r]);return n}function M(e,t,n){return Math.min(Math.max(e,t),n)}function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function C(){C=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,a=Object.create(o.prototype),s=new L(r||[]);return i(a,"_invoke",{value:M(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",g={};function v(){}function y(){}function b(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(k([])));x&&x!==n&&r.call(x,a)&&(_=x);var S=b.prototype=v.prototype=Object.create(_);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(i,o,a,s){var l=h(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==T(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function M(t,n,r){var i=d;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=I(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?m:f,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=m,r.method="throw",r.arg=c.arg)}}}function I(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function k(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(T(t)+" is not iterable")}return y.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},E(A.prototype),c(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new A(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(S),c(S,l,"Generator"),c(S,a,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=k,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:k(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function L(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){P(o,r,i,a,s,"next",e)}function s(e){P(o,r,i,a,s,"throw",e)}a(void 0)}))}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||N(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=N(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function O(e){return function(e){if(Array.isArray(e))return U(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return U(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}function z(e,t,n){return t&&F(e.prototype,t),n&&F(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){var t=function(e){if("object"!=T(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==T(t)?t:t+""}var H=/%2C/g,G=/%3A/g,W=[255,255,255],q="1",X=/^c[0-9]+$/,$=/^-?[a-z0-9.]*:[ ]*-?[a-z0-9.]*$/,Y=/^-?[0-9.]*:-?[0-9.]*$/,K=/^[0-9.]*,[0-9.]*,[0-9.]*$/,Z=/^([0-9.]*:[0-9.]*)(,[0-9.]*:[0-9.]*){2}$/,Q=new RegExp("(([0-9a-fA-F]{6})|".concat(q,")")),J=/-?[0-9.]*/,ee=new RegExp("(".concat(J.source,":").concat(J.source,":").concat(Q.source,")")),te=new RegExp("^".concat(Q.source,"$")),ne=new RegExp("^".concat(ee.source,"(,").concat(ee.source,")*$")),re=new RegExp("^".concat(ee.source,"(:").concat(ee.source,")*$")),ie=function(e){return e.View="view",e.Mode="mode",e.Mask="mask",e.Image="image",e.Axes="axes",e.BoundingBox="bb",e.BoundingBoxColor="bbcol",e.BackgroundColor="bgcol",e.Autorotate="rot",e.Brightness="bright",e.Density="dens",e.Levels="lvl",e.Interpolation="interp",e.Region="reg",e.Slice="slice",e.Time="t",e.Scene="scene",e.CameraState="cam",e}({}),oe=function(e){return e.Position="pos",e.Target="tar",e.Up="up",e.OrthoScale="ort",e.Fov="fov",e}({}),ae=function(e){return e.Color="col",e.Colorize="clz",e.ColorizeAlpha="cza",e.IsosurfaceAlpha="isa",e.Lut="lut",e.Ramp="rmp",e.ControlPoints="cps",e.ControlPointsEnabled="cpe",e.VolumeEnabled="ven",e.SurfaceEnabled="sen",e.IsosurfaceValue="isv",e}({});ae.Color,ae.Colorize,ae.ColorizeAlpha,ae.IsosurfaceAlpha,ae.Lut,ae.ControlPoints,ae.ControlPointsEnabled,ae.Ramp,ae.VolumeEnabled,ae.SurfaceEnabled,ae.IsosurfaceValue,r=ie.View,i=ie.Mode,o=ie.Mask,a=ie.Image,s=ie.Axes,l=ie.BoundingBox,c=ie.BoundingBoxColor,u=ie.BackgroundColor,h=ie.Autorotate,d=ie.Brightness,f=ie.Density,p=ie.Levels,m=ie.Interpolation,g=ie.Region,v=ie.Slice,y=ie.Time,b=ie.Scene,_=ie.CameraState;var se=z((function e(){B(this,e),V(this,r,void 0),V(this,i,void 0),V(this,o,void 0),V(this,a,void 0),V(this,s,void 0),V(this,l,void 0),V(this,c,void 0),V(this,u,void 0),V(this,h,void 0),V(this,d,void 0),V(this,f,void 0),V(this,p,void 0),V(this,m,void 0),V(this,g,void 0),V(this,v,void 0),V(this,y,void 0),V(this,b,void 0),V(this,_,void 0)})),le=z((function e(){B(this,e),V(this,"url",void 0),V(this,"manifest",void 0),V(this,"dataset",void 0),V(this,"id",void 0)})),ce=z((function e(){B(this,e),V(this,"ch",void 0),V(this,"luts",void 0),V(this,"colors",void 0)})),ue=[].concat(O(Object.keys(new se)),O(Object.keys(new le)),O(Object.keys(new ce))),he=function(e){return-1!==ue.indexOf(e)},de=function(e){return X.test(e)};function fe(e){var t,n={},r=D(e.entries());try{for(r.s();!(t=r.n()).done;){var i=k(t.value,2),o=i[0],a=i[1];(he(o)||de(o))&&(n[o]=a)}}catch(e){r.e(e)}finally{r.f()}return n}var pe=function(e){var t=decodeURIComponent(e);return t.endsWith("/")?t.slice(0,-1):t},me=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if("string"==typeof t?e.includes(t):t.test(e)){var n,r=e.split(t).map((function(e){return pe(e)})),i=D(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;try{new URL(o)}catch(e){return}}}catch(e){i.e(e)}finally{i.f()}return r}};function ge(e){if(""===e)return{};var t,n={},r=D(e.split(","));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.indexOf(":"),a=i.slice(0,o),s=i.slice(o+1);n[decodeURIComponent(a).trim()]=decodeURIComponent(s).trim()}}catch(e){r.e(e)}finally{r.f()}return n}function ve(e){var t=[];for(var n in e){var r=e[n];if(void 0!==r){var i=encodeURIComponent(r.trim()).replace(G,":");t.push("".concat(encodeURIComponent(n.trim()),":").concat(i))}}return t.join(",")}function ye(e,t,n){if(void 0!==e){var r=Number.parseFloat(e);return Number.isNaN(r)?void 0:M(r,t,n)}}function be(e,t,n){if(void 0!==e){var r=Number.parseInt(e,10);if(!Number.isNaN(r))return M(r,t,n)}}function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return void 0!==e&&Object.values(t).includes(e)?e:n}function we(e){if(void 0!==e)return"1"===e}function xe(e){if(e&&te.test(e))return e===q?W:[Number.parseInt(e.slice(0,2),16),Number.parseInt(e.slice(2,4),16),Number.parseInt(e.slice(4,6),16)]}function Se(e){return e.map((function(e){return e.toString(16).padStart(2,"0")})).join("").toLowerCase()}function Ee(e){if(e&&K.test(e)){var t=k(e.split(",").map((function(e){return ye(e,0,1)})),3),n=t[0],r=t[1],i=t[2];if(void 0!==n&&void 0!==r&&void 0!==i)return{x:n,y:r,z:i}}}function Ae(e,t){var n,r,i;if(e){var o=null!==(n=null==t?void 0:t.min)&&void 0!==n?n:Number.NEGATIVE_INFINITY,a=null!==(r=null==t?void 0:t.max)&&void 0!==r?r:Number.POSITIVE_INFINITY,s=null!==(i=null==t?void 0:t.separator)&&void 0!==i?i:",",l=k(e.split(s).map((function(e){return ye(e,o,a)})),3),c=l[0],u=l[1],h=l[2];if(void 0!==c&&void 0!==u&&void 0!==h)return[c,u,h]}}function Me(e){if(e&&Z.test(e)){var t=e.split(",").map((function(e){var t=k(e.split(":").map((function(e){return ye(e,0,1)})),2),n=t[0],r=t[1];if(void 0!==n&&void 0!==r)return n<r?[n,r]:[r,n]})),n=k(t,3),r=n[0],i=n[1],o=n[2];if(void 0!==r&&void 0!==i&&void 0!==o)return{x:r,y:i,z:o}}}function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return Number.isInteger(e)?e.toString():Number(e.toPrecision(t)).toString()}function Ce(e){return[e.x,e.y,e.z]}function Ie(e){if(void 0!==e)return e?"1":"0"}function Re(e){if(e){var t=ge(e);return E({position:Ae(t[oe.Position],{separator:":"}),target:Ae(t[oe.Target],{separator:":"}),up:Ae(t[oe.Up],{separator:":"}),orthoScale:ye(t[oe.OrthoScale],0,1/0),fov:ye(t[oe.Fov],0,180)})}}function Pe(e){var t;return(null!==(t=e.scenes)&&void 0!==t?t:[e]).map((function(e){return encodeURIComponent(Array.isArray(e)?e.join(","):e)})).join("+")}function Le(e){var t={maskAlpha:be(e[ie.Mask],0,100),imageType:_e(e[ie.Image],S.yj),showAxes:we(e[ie.Axes]),showBoundingBox:we(e[ie.BoundingBox]),boundingBoxColor:xe(e[ie.BoundingBoxColor]),backgroundColor:xe(e[ie.BackgroundColor]),autorotate:we(e[ie.Autorotate]),brightness:ye(e[ie.Brightness],0,100),density:ye(e[ie.Density],0,100),levels:Ae(e[ie.Levels],{min:0,max:255}),interpolationEnabled:we(e[ie.Interpolation]),region:Me(e[ie.Region]),slice:Ee(e[ie.Slice]),time:be(e[ie.Time],0,Number.POSITIVE_INFINITY),scene:be(e[ie.Scene],0,Number.POSITIVE_INFINITY),renderMode:_e(e[ie.Mode],S.G9),cameraState:Re(e[ie.CameraState])};if(e.view){var n,r={"3D":S.nE.threeD,Z:S.nE.xy,Y:S.nE.xz,X:S.nE.yz};n=Object.keys(r).includes(e.view.toUpperCase())?e.view.toUpperCase():"3D",t.viewMode=r[n]}return E(t)}function ke(e){if(e.ch){for(var t={groups:[{name:"Channels",channels:[]}]},n=t.groups[0].channels,r=e.ch.split(",").map((function(e){return Number.parseInt(e,10)})),i=0;i<r.length;++i)n.push({match:r[i],enabled:!0});if(e.luts){var o=e.luts.split(",");if(o.length!==2*n.length)console.warn("ILL-FORMED QUERYSTRING: luts must have a min/max for each ch");else for(var a=0;a<n.length;++a)n[a].lut=[o[2*a],o[2*a+1]]}if(e.colors){var s=e.colors.split(",");if(s.length!==n.length)console.warn("ILL-FORMED QUERYSTRING: if colors specified, must have a color for each ch");else for(var l=0;l<n.length;++l)n[l].color=s[l]}return t}}function De(e){var t=new Map;if(Object.keys(e).forEach((function(n){if(de(n)){var r=Number.parseInt(n.slice(1),10);try{var i=function(e,t){var n={match:e,enabled:we(t[ae.VolumeEnabled]),surfaceEnabled:we(t[ae.SurfaceEnabled]),isovalue:ye(t[ae.IsosurfaceValue],0,255),surfaceOpacity:ye(t[ae.IsosurfaceAlpha],0,1),colorizeEnabled:we(t[ae.Colorize]),colorizeAlpha:ye(t[ae.ColorizeAlpha],0,1),controlPointsEnabled:we(t[ae.ControlPointsEnabled])};if(t[ae.Color]&&Q.test(t.col)&&(n.color=t[ae.Color]),t[ae.Lut]&&$.test(t.lut)){var r=k(t[ae.Lut].split(":"),2),i=r[0],o=r[1];n.lut=[i.trim(),o.trim()]}if(t[ae.Ramp]&&Y.test(t.rmp)){var a=k(t[ae.Ramp].split(":"),2),s=a[0],l=a[1];n.ramp=[Number.parseFloat(s),Number.parseFloat(l)]}return t[ae.ControlPoints]&&(n.controlPoints=function(e){if(e&&(re.test(e)||ne.test(e)))return(ne.test(e)?e.split(",").map((function(e){return e.split(":")})):e.split(":").reduce((function(e,t,n,r){return(n+1)%3==0&&e.push([r[n-2],r[n-1],r[n]]),e}),[])).map((function(e){var t,n,r,i=k(e,3),o=i[0],a=i[1],s=i[2];return{x:null!==(t=ye(o,-1/0,1/0))&&void 0!==t?t:0,opacity:null!==(n=ye(a,0,1))&&void 0!==n?n:1,color:null!==(r=xe(s))&&void 0!==r?r:W}})).sort((function(e,t){return e.x-t.x}))}(t[ae.ControlPoints])),n}(r,ge(e[n]));t.set(r,i)}catch(e){console.warn("url_utils.getArgsFromParams: Failed to parse channel settings for channel ".concat(r," from URL parameters."),e)}}})),t.size>0)return{groups:[{name:"Channels",channels:Array.from(t.values())}]}}function Oe(e,t,n){return Ne.apply(this,arguments)}function Ne(){return(Ne=L(C().mark((function e(t,n,r){var i,o,a,s,l,c,u,h,d,f,p,m;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},e.next=3,t.getAvailableDatasets();case 3:o=e.sent,a=void 0,s=D(o),e.prev=6,s.s();case 8:if((l=s.n()).done){e.next=18;break}if(c=l.value,u=c.datasets,h=Object.keys(u),!(d=h.find((function(e){return e===n})))){e.next=16;break}return a=u[d],e.abrupt("break",18);case 16:e.next=8;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),s.e(e.t0);case 23:return e.prev=23,s.f(),e.finish(23);case 26:if(void 0!==a){e.next=29;break}return console.error("No matching dataset: ".concat(n)),e.abrupt("return",{});case 29:return e.next=31,t.selectDataset(a.manifest);case 31:return f=e.sent,p=f.volumeViewerDataRoot+"/",i.imageDownloadHref=f.downloadRoot+"/"+r,e.next=36,t.getFileInfoByCellId(r);case 36:return m=e.sent,i.imageUrl=p+m.volumeviewerPath,i.parentImageUrl=p+m.fovVolumeviewerPath,e.abrupt("return",i);case 40:case"end":return e.stop()}}),e,null,[[6,20,23,26]])})))).apply(this,arguments)}function Ue(e){return Fe.apply(this,arguments)}function Fe(){return(Fe=L(C().mark((function e(t){var n,r,i,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:n=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),console.error(e.t0),new Error("JSON manifest could not be fetched from URL '".concat(t,"': ").concat(e.t0));case 10:if(n.ok){e.next=12;break}throw new Error("JSON manifest could not be fetched from URL '".concat(t,"': Received ").concat(n.status," ").concat(n.statusText));case 12:return e.prev=12,e.next=15,n.json();case 15:r=e.sent,e.next=21;break;case 18:throw e.prev=18,e.t1=e.catch(12),new Error("Could not parse JSON manifest from URL '".concat(t,"': ").concat(e.t1));case 21:if(void 0!==(i=r.scenes)){e.next=24;break}throw new Error("No 'scenes' property was found in JSON manifest from URL '".concat(t,"'"));case 24:if("string"==typeof i&&(i=[i]),Array.isArray(i)&&0!==i.length&&(a=i,Array.isArray(a)&&a.every((function(e){return"string"==typeof e||function(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e)})))){e.next=27;break}throw new Error("Invalid 'scenes' property found in JSON manifest from URL '".concat(t,"'. 'scenes' must be a non-empty array of strings or string arrays."));case 27:return o=void 0,void 0!==r.meta&&Array.isArray(r.meta)&&(o=r.meta),e.abrupt("return",{scenes:i,metadata:o});case 30:case"end":return e.stop()}var a}),e,null,[[0,6],[12,18]])})))).apply(this,arguments)}function ze(e,t){return Be.apply(this,arguments)}function Be(){return(Be=L(C().mark((function e(t,n){var r,i,o,a,s,l,c,u,h,d,f,p,m,g,v,y,b,_,w;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=fe(t),i={},o=Le(r),a=ke(r),s=De(r),i.viewerChannelSettings=null!=s?s:a,void 0===r.manifest&&void 0===r.url){e.next=33;break}if(!r.manifest){e.next=17;break}return e.next=10,Ue(r.manifest);case 10:c=e.sent,u=c.scenes,h=c.metadata,l=u,i.metadata=null!=h?h:void 0,e.next=22;break;case 17:p="storage"===r.url,m=p&&null!==(d=localStorage.getItem("url"))&&void 0!==d?d:r.url,g=null!==(f=me(m,/[+ ]/))&&void 0!==f?f:[m],l=g.map((function(e){var t;return null!==(t=me(e))&&void 0!==t?t:pe(e)})),p&&(v=localStorage.getItem("meta"),i.metadata=null!==v?JSON.parse(v):void 0);case 22:y=l[0],b=Array.isArray(y)?y[0]:y,_=l.length>1||y.length>1?{scenes:l}:y[0],i.cellId="1",i.imageUrl=_,i.imageDownloadHref=b,i.parentImageUrl="",i.parentImageDownloadHref="",b.endsWith("json")||i.viewerChannelSettings||(i.viewerChannelSettings={groups:[{name:"Channels",channels:[{match:[0,1,2],enabled:!0},{match:"(.+)",enabled:!1}]}]}),e.next=38;break;case 33:if(!(r.dataset&&r.id&&n)){e.next=38;break}return e.next=36,Oe(n,r.dataset,r.id);case 36:w=e.sent,i=R(R({},i),w);case 38:return e.abrupt("return",{args:E(i),viewerSettings:E(o)});case 39:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=function(e,t){var n,r,i,o,a,s,l;t&&(e=A(e,(0,x.$m)()));var c=(V(V(V(V(V(V(V(V(V(V(l={},ie.Mode,e.renderMode),ie.Mask,null===(n=e.maskAlpha)||void 0===n?void 0:n.toString()),ie.Image,e.imageType),ie.Axes,Ie(e.showAxes)),ie.BoundingBox,Ie(e.showBoundingBox)),ie.BoundingBoxColor,e.boundingBoxColor&&Se(e.boundingBoxColor)),ie.BackgroundColor,e.backgroundColor&&Se(e.backgroundColor)),ie.Autorotate,Ie(e.autorotate)),ie.Brightness,null===(r=e.brightness)||void 0===r?void 0:r.toString()),ie.Density,null===(i=e.density)||void 0===i?void 0:i.toString()),V(V(V(V(V(V(V(l,ie.Interpolation,Ie(e.interpolationEnabled)),ie.Region,e.region&&Ce(e.region).map((function(e){return e.map((function(e){return Te(e)})).join(":")})).join(",")),ie.Slice,e.slice&&Ce(e.slice).map((function(e){return Te(e)})).join(",")),ie.Levels,null===(o=e.levels)||void 0===o?void 0:o.join(",")),ie.Time,null===(a=e.time)||void 0===a?void 0:a.toString()),ie.Scene,null===(s=e.scene)||void 0===s?void 0:s.toString()),ie.CameraState,e.cameraState&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S.nE.threeD;if(!t||(e=A(e,(0,x.kP)(n)),0!==Object.keys(e).length)){var r=ve(V(V(V(V(V({},oe.Position,e.position&&e.position.map((function(e){return Te(e)})).join(":")),oe.Target,e.target&&e.target.map((function(e){return Te(e)})).join(":")),oe.Up,e.up&&e.up.map((function(e){return Te(e)})).join(":")),oe.OrthoScale,void 0===e.orthoScale?void 0:Te(e.orthoScale)),oe.Fov,void 0===e.fov?void 0:Te(e.fov)));return""===r?void 0:r}}(e.cameraState,t,e.viewMode))),u=V(V(V(V({},S.nE.threeD,"3D"),S.nE.xy,"Z"),S.nE.xz,"Y"),S.nE.yz,"X");return c[ie.View]=e.viewMode&&u[e.viewMode],E(c)}(e,n),i=null===(t=e.channelSettings)||void 0===t?void 0:t.reduce((function(e,t,r){return e["c".concat(r)]=ve(function(e,t){var n,r,i,o;return t&&(e=A(e,(0,x.g1)())),E(V(V(V(V(V(V(V(V(V(V({},ae.VolumeEnabled,Ie(e.volumeEnabled)),ae.SurfaceEnabled,Ie(e.isosurfaceEnabled)),ae.IsosurfaceValue,null===(n=e.isovalue)||void 0===n?void 0:n.toString()),ae.IsosurfaceAlpha,null===(r=e.opacity)||void 0===r?void 0:r.toString()),ae.Colorize,Ie(e.colorizeEnabled)),ae.ColorizeAlpha,null===(i=e.colorizeAlpha)||void 0===i?void 0:i.toString()),ae.Color,e.color&&Se(e.color)),ae.ControlPoints,e.controlPoints&&e.controlPoints.map((function(e){var t=Te(e.x),n=Te(e.opacity),r=(0,w.isEqual)(e.color,W)?q:Se(e.color);return"".concat(t,":").concat(n,":").concat(r)})).join(":")),ae.ControlPointsEnabled,Ie(e.useControlPoints)),ae.Ramp,null===(o=e.ramp)||void 0===o?void 0:o.map((function(e){return Te(e)})).join(":")))}(t,n)),e}),{});return R(R({},r),i)}function je(e){return e.startsWith("http")}},5577:(e,t,n)=>{"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=r(n(6199));i.default.registerVersion("firebase","7.24.0","app"),e.exports=i.default},1588:function(e,t){!function(e){"use strict";function t(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function n(e,n,r){var i,o=new Promise((function(o,a){t(i=e[n].apply(e,r)).then(o,a)}));return o.request=i,o}function r(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function i(e,t,r,i){i.forEach((function(i){i in r.prototype&&(e.prototype[i]=function(){return n(this[t],i,arguments)})}))}function o(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function a(e,t,r,i){i.forEach((function(i){i in r.prototype&&(e.prototype[i]=function(){return e=this[t],(r=n(e,i,arguments)).then((function(e){if(e)return new l(e,r.request)}));var e,r})}))}function s(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function c(e){this._store=e}function u(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function h(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new u(n)}function d(e){this._db=e}r(s,"_index",["name","keyPath","multiEntry","unique"]),i(s,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(s,"_index",IDBIndex,["openCursor","openKeyCursor"]),r(l,"_cursor",["direction","key","primaryKey","value"]),i(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var n=this,r=arguments;return Promise.resolve().then((function(){return n._cursor[e].apply(n._cursor,r),t(n._request).then((function(e){if(e)return new l(e,n._request)}))}))})})),c.prototype.createIndex=function(){return new s(this._store.createIndex.apply(this._store,arguments))},c.prototype.index=function(){return new s(this._store.index.apply(this._store,arguments))},r(c,"_store",["name","keyPath","indexNames","autoIncrement"]),i(c,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(c,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(c,"_store",IDBObjectStore,["deleteIndex"]),u.prototype.objectStore=function(){return new c(this._tx.objectStore.apply(this._tx,arguments))},r(u,"_tx",["objectStoreNames","mode"]),o(u,"_tx",IDBTransaction,["abort"]),h.prototype.createObjectStore=function(){return new c(this._db.createObjectStore.apply(this._db,arguments))},r(h,"_db",["name","version","objectStoreNames"]),o(h,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new u(this._db.transaction.apply(this._db,arguments))},r(d,"_db",["name","version","objectStoreNames"]),o(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[c,s].forEach((function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],i=this._store||this._index,o=i[e].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[s,c].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})})),e.openDb=function(e,t,r){var i=n(indexedDB,"open",[e,t]),o=i.request;return o&&(o.onupgradeneeded=function(e){r&&r(new h(o.result,e.oldVersion,o.transaction))}),i.then((function(e){return new d(e)}))},e.deleteDb=function(e){return n(indexedDB,"deleteDatabase",[e])},Object.defineProperty(e,"__esModule",{value:!0})}(t)},2543:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",l=32,c=128,u=1/0,h=9007199254740991,d=NaN,f=4294967295,p=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",l],["partialRight",64],["rearg",256]],m="[object Arguments]",g="[object Array]",v="[object Boolean]",y="[object Date]",b="[object Error]",_="[object Function]",w="[object GeneratorFunction]",x="[object Map]",S="[object Number]",E="[object Object]",A="[object Promise]",M="[object RegExp]",T="[object Set]",C="[object String]",I="[object Symbol]",R="[object WeakMap]",P="[object ArrayBuffer]",L="[object DataView]",k="[object Float32Array]",D="[object Float64Array]",O="[object Int8Array]",N="[object Int16Array]",U="[object Int32Array]",F="[object Uint8Array]",z="[object Uint8ClampedArray]",B="[object Uint16Array]",V="[object Uint32Array]",j=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,G=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,X=RegExp(W.source),$=RegExp(q.source),Y=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ae=/\{\n\/\* \[wrapped with (.+)\] \*/,se=/,? & /,le=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,de=/\w*$/,fe=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,me=/^\[object .+?Constructor\]$/,ge=/^0o[0-7]+$/i,ve=/^(?:0|[1-9]\d*)$/,ye=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,be=/($^)/,_e=/['\n\r\u2028\u2029\\]/g,we="\\ud800-\\udfff",xe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="\\u2700-\\u27bf",Ee="a-z\\xdf-\\xf6\\xf8-\\xff",Ae="A-Z\\xc0-\\xd6\\xd8-\\xde",Me="\\ufe0e\\ufe0f",Te="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ce="["+we+"]",Ie="["+Te+"]",Re="["+xe+"]",Pe="\\d+",Le="["+Se+"]",ke="["+Ee+"]",De="[^"+we+Te+Pe+Se+Ee+Ae+"]",Oe="\\ud83c[\\udffb-\\udfff]",Ne="[^"+we+"]",Ue="(?:\\ud83c[\\udde6-\\uddff]){2}",Fe="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+Ae+"]",Be="\\u200d",Ve="(?:"+ke+"|"+De+")",je="(?:"+ze+"|"+De+")",He="(?:['](?:d|ll|m|re|s|t|ve))?",Ge="(?:['](?:D|LL|M|RE|S|T|VE))?",We="(?:"+Re+"|"+Oe+")?",qe="["+Me+"]?",Xe=qe+We+"(?:"+Be+"(?:"+[Ne,Ue,Fe].join("|")+")"+qe+We+")*",$e="(?:"+[Le,Ue,Fe].join("|")+")"+Xe,Ye="(?:"+[Ne+Re+"?",Re,Ue,Fe,Ce].join("|")+")",Ke=RegExp("[']","g"),Ze=RegExp(Re,"g"),Qe=RegExp(Oe+"(?="+Oe+")|"+Ye+Xe,"g"),Je=RegExp([ze+"?"+ke+"+"+He+"(?="+[Ie,ze,"$"].join("|")+")",je+"+"+Ge+"(?="+[Ie,ze+Ve,"$"].join("|")+")",ze+"?"+Ve+"+"+He,ze+"+"+Ge,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pe,$e].join("|"),"g"),et=RegExp("["+Be+we+xe+Me+"]"),tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,it={};it[k]=it[D]=it[O]=it[N]=it[U]=it[F]=it[z]=it[B]=it[V]=!0,it[m]=it[g]=it[P]=it[v]=it[L]=it[y]=it[b]=it[_]=it[x]=it[S]=it[E]=it[M]=it[T]=it[C]=it[R]=!1;var ot={};ot[m]=ot[g]=ot[P]=ot[L]=ot[v]=ot[y]=ot[k]=ot[D]=ot[O]=ot[N]=ot[U]=ot[x]=ot[S]=ot[E]=ot[M]=ot[T]=ot[C]=ot[I]=ot[F]=ot[z]=ot[B]=ot[V]=!0,ot[b]=ot[_]=ot[R]=!1;var at={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},st=parseFloat,lt=parseInt,ct="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ut="object"==typeof self&&self&&self.Object===Object&&self,ht=ct||ut||Function("return this")(),dt=t&&!t.nodeType&&t,ft=dt&&e&&!e.nodeType&&e,pt=ft&&ft.exports===dt,mt=pt&&ct.process,gt=function(){try{return ft&&ft.require&&ft.require("util").types||mt&&mt.binding&&mt.binding("util")}catch(e){}}(),vt=gt&&gt.isArrayBuffer,yt=gt&&gt.isDate,bt=gt&&gt.isMap,_t=gt&&gt.isRegExp,wt=gt&&gt.isSet,xt=gt&&gt.isTypedArray;function St(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Et(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function At(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Mt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function Ct(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function It(e,t){return!(null==e||!e.length)&&zt(e,t,0)>-1}function Rt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Pt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Lt(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function kt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Dt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Ot(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Nt=Ht("length");function Ut(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function Ft(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function zt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):Ft(e,Vt,n)}function Bt(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function Vt(e){return e!=e}function jt(e,t){var n=null==e?0:e.length;return n?qt(e,t)/n:d}function Ht(e){return function(t){return null==t?i:t[e]}}function Gt(e){return function(t){return null==e?i:e[t]}}function Wt(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function qt(e,t){for(var n,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==i&&(n=n===i?a:n+a)}return n}function Xt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function $t(e){return e?e.slice(0,dn(e)+1).replace(re,""):e}function Yt(e){return function(t){return e(t)}}function Kt(e,t){return Pt(t,(function(t){return e[t]}))}function Zt(e,t){return e.has(t)}function Qt(e,t){for(var n=-1,r=e.length;++n<r&&zt(t,e[n],0)>-1;);return n}function Jt(e,t){for(var n=e.length;n--&&zt(t,e[n],0)>-1;);return n}var en=Gt({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),tn=Gt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(e){return"\\"+at[e]}function rn(e){return et.test(e)}function on(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function an(e,t){return function(n){return e(t(n))}}function sn(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function ln(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function un(e){return rn(e)?function(e){for(var t=Qe.lastIndex=0;Qe.test(e);)++t;return t}(e):Nt(e)}function hn(e){return rn(e)?function(e){return e.match(Qe)||[]}(e):function(e){return e.split("")}(e)}function dn(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var fn=Gt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),pn=function e(t){var n,r=(t=null==t?ht:pn.defaults(ht.Object(),t,pn.pick(ht,nt))).Array,ie=t.Date,we=t.Error,xe=t.Function,Se=t.Math,Ee=t.Object,Ae=t.RegExp,Me=t.String,Te=t.TypeError,Ce=r.prototype,Ie=xe.prototype,Re=Ee.prototype,Pe=t["__core-js_shared__"],Le=Ie.toString,ke=Re.hasOwnProperty,De=0,Oe=(n=/[^.]+$/.exec(Pe&&Pe.keys&&Pe.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Ne=Re.toString,Ue=Le.call(Ee),Fe=ht._,ze=Ae("^"+Le.call(ke).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Be=pt?t.Buffer:i,Ve=t.Symbol,je=t.Uint8Array,He=Be?Be.allocUnsafe:i,Ge=an(Ee.getPrototypeOf,Ee),We=Ee.create,qe=Re.propertyIsEnumerable,Xe=Ce.splice,$e=Ve?Ve.isConcatSpreadable:i,Ye=Ve?Ve.iterator:i,Qe=Ve?Ve.toStringTag:i,et=function(){try{var e=lo(Ee,"defineProperty");return e({},"",{}),e}catch(e){}}(),at=t.clearTimeout!==ht.clearTimeout&&t.clearTimeout,ct=ie&&ie.now!==ht.Date.now&&ie.now,ut=t.setTimeout!==ht.setTimeout&&t.setTimeout,dt=Se.ceil,ft=Se.floor,mt=Ee.getOwnPropertySymbols,gt=Be?Be.isBuffer:i,Nt=t.isFinite,Gt=Ce.join,mn=an(Ee.keys,Ee),gn=Se.max,vn=Se.min,yn=ie.now,bn=t.parseInt,_n=Se.random,wn=Ce.reverse,xn=lo(t,"DataView"),Sn=lo(t,"Map"),En=lo(t,"Promise"),An=lo(t,"Set"),Mn=lo(t,"WeakMap"),Tn=lo(Ee,"create"),Cn=Mn&&new Mn,In={},Rn=Uo(xn),Pn=Uo(Sn),Ln=Uo(En),kn=Uo(An),Dn=Uo(Mn),On=Ve?Ve.prototype:i,Nn=On?On.valueOf:i,Un=On?On.toString:i;function Fn(e){if(es(e)&&!Ha(e)&&!(e instanceof jn)){if(e instanceof Vn)return e;if(ke.call(e,"__wrapped__"))return Fo(e)}return new Vn(e)}var zn=function(){function e(){}return function(t){if(!Ja(t))return{};if(We)return We(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function Bn(){}function Vn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function jn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=f,this.__views__=[]}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Gn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function qn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Wn;++t<n;)this.add(e[t])}function Xn(e){var t=this.__data__=new Gn(e);this.size=t.size}function $n(e,t){var n=Ha(e),r=!n&&ja(e),i=!n&&!r&&Xa(e),o=!n&&!r&&!i&&ls(e),a=n||r||i||o,s=a?Xt(e.length,Me):[],l=s.length;for(var c in e)!t&&!ke.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||go(c,l))||s.push(c);return s}function Yn(e){var t=e.length;return t?e[Wr(0,t-1)]:i}function Kn(e,t){return Lo(Mi(e),or(t,0,e.length))}function Zn(e){return Lo(Mi(e))}function Qn(e,t,n){(n!==i&&!za(e[t],n)||n===i&&!(t in e))&&rr(e,t,n)}function Jn(e,t,n){var r=e[t];ke.call(e,t)&&za(r,n)&&(n!==i||t in e)||rr(e,t,n)}function er(e,t){for(var n=e.length;n--;)if(za(e[n][0],t))return n;return-1}function tr(e,t,n,r){return ur(e,(function(e,i,o){t(r,e,n(e),o)})),r}function nr(e,t){return e&&Ti(t,Rs(t),e)}function rr(e,t,n){"__proto__"==t&&et?et(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t){for(var n=-1,o=t.length,a=r(o),s=null==e;++n<o;)a[n]=s?i:As(e,t[n]);return a}function or(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function ar(e,t,n,r,o,a){var s,l=1&t,c=2&t,u=4&t;if(n&&(s=o?n(e,r,o,a):n(e)),s!==i)return s;if(!Ja(e))return e;var h=Ha(e);if(h){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ke.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return Mi(e,s)}else{var d=ho(e),f=d==_||d==w;if(Xa(e))return _i(e,l);if(d==E||d==m||f&&!o){if(s=c||f?{}:po(e),!l)return c?function(e,t){return Ti(e,uo(e),t)}(e,function(e,t){return e&&Ti(t,Ps(t),e)}(s,e)):function(e,t){return Ti(e,co(e),t)}(e,nr(s,e))}else{if(!ot[d])return o?e:{};s=function(e,t,n){var r,i=e.constructor;switch(t){case P:return wi(e);case v:case y:return new i(+e);case L:return function(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case k:case D:case O:case N:case U:case F:case z:case B:case V:return xi(e,n);case x:return new i;case S:case C:return new i(e);case M:return function(e){var t=new e.constructor(e.source,de.exec(e));return t.lastIndex=e.lastIndex,t}(e);case T:return new i;case I:return r=e,Nn?Ee(Nn.call(r)):{}}}(e,d,l)}}a||(a=new Xn);var p=a.get(e);if(p)return p;a.set(e,s),os(e)?e.forEach((function(r){s.add(ar(r,t,n,r,e,a))})):ts(e)&&e.forEach((function(r,i){s.set(i,ar(r,t,n,i,e,a))}));var g=h?i:(u?c?to:eo:c?Ps:Rs)(e);return At(g||e,(function(r,i){g&&(r=e[i=r]),Jn(s,i,ar(r,t,n,i,e,a))})),s}function sr(e,t,n){var r=n.length;if(null==e)return!r;for(e=Ee(e);r--;){var o=n[r],a=t[o],s=e[o];if(s===i&&!(o in e)||!a(s))return!1}return!0}function lr(e,t,n){if("function"!=typeof e)throw new Te(o);return Co((function(){e.apply(i,n)}),t)}function cr(e,t,n,r){var i=-1,o=It,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=Pt(t,Yt(n))),r?(o=Rt,a=!1):t.length>=200&&(o=Zt,a=!1,t=new qn(t));e:for(;++i<s;){var u=e[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,a&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,r)||l.push(u)}return l}Fn.templateSettings={escape:Y,evaluate:K,interpolate:Z,variable:"",imports:{_:Fn}},Fn.prototype=Bn.prototype,Fn.prototype.constructor=Fn,Vn.prototype=zn(Bn.prototype),Vn.prototype.constructor=Vn,jn.prototype=zn(Bn.prototype),jn.prototype.constructor=jn,Hn.prototype.clear=function(){this.__data__=Tn?Tn(null):{},this.size=0},Hn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Hn.prototype.get=function(e){var t=this.__data__;if(Tn){var n=t[e];return n===a?i:n}return ke.call(t,e)?t[e]:i},Hn.prototype.has=function(e){var t=this.__data__;return Tn?t[e]!==i:ke.call(t,e)},Hn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Tn&&t===i?a:t,this},Gn.prototype.clear=function(){this.__data__=[],this.size=0},Gn.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return!(n<0||(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,0))},Gn.prototype.get=function(e){var t=this.__data__,n=er(t,e);return n<0?i:t[n][1]},Gn.prototype.has=function(e){return er(this.__data__,e)>-1},Gn.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Wn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(Sn||Gn),string:new Hn}},Wn.prototype.delete=function(e){var t=ao(this,e).delete(e);return this.size-=t?1:0,t},Wn.prototype.get=function(e){return ao(this,e).get(e)},Wn.prototype.has=function(e){return ao(this,e).has(e)},Wn.prototype.set=function(e,t){var n=ao(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},qn.prototype.add=qn.prototype.push=function(e){return this.__data__.set(e,a),this},qn.prototype.has=function(e){return this.__data__.has(e)},Xn.prototype.clear=function(){this.__data__=new Gn,this.size=0},Xn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Xn.prototype.get=function(e){return this.__data__.get(e)},Xn.prototype.has=function(e){return this.__data__.has(e)},Xn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Gn){var r=n.__data__;if(!Sn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Wn(r)}return n.set(e,t),this.size=n.size,this};var ur=Ri(yr),hr=Ri(br,!0);function dr(e,t){var n=!0;return ur(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function fr(e,t,n){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(l===i?s==s&&!ss(s):n(s,l)))var l=s,c=a}return c}function pr(e,t){var n=[];return ur(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function mr(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=mo),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?mr(s,t-1,n,r,i):Lt(i,s):r||(i[i.length]=s)}return i}var gr=Pi(),vr=Pi(!0);function yr(e,t){return e&&gr(e,t,Rs)}function br(e,t){return e&&vr(e,t,Rs)}function _r(e,t){return Ct(t,(function(t){return Ka(e[t])}))}function wr(e,t){for(var n=0,r=(t=gi(t,e)).length;null!=e&&n<r;)e=e[No(t[n++])];return n&&n==r?e:i}function xr(e,t,n){var r=t(e);return Ha(e)?r:Lt(r,n(e))}function Sr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Qe&&Qe in Ee(e)?function(e){var t=ke.call(e,Qe),n=e[Qe];try{e[Qe]=i;var r=!0}catch(e){}var o=Ne.call(e);return r&&(t?e[Qe]=n:delete e[Qe]),o}(e):function(e){return Ne.call(e)}(e)}function Er(e,t){return e>t}function Ar(e,t){return null!=e&&ke.call(e,t)}function Mr(e,t){return null!=e&&t in Ee(e)}function Tr(e,t,n){for(var o=n?Rt:It,a=e[0].length,s=e.length,l=s,c=r(s),u=1/0,h=[];l--;){var d=e[l];l&&t&&(d=Pt(d,Yt(t))),u=vn(d.length,u),c[l]=!n&&(t||a>=120&&d.length>=120)?new qn(l&&d):i}d=e[0];var f=-1,p=c[0];e:for(;++f<a&&h.length<u;){var m=d[f],g=t?t(m):m;if(m=n||0!==m?m:0,!(p?Zt(p,g):o(h,g,n))){for(l=s;--l;){var v=c[l];if(!(v?Zt(v,g):o(e[l],g,n)))continue e}p&&p.push(g),h.push(m)}}return h}function Cr(e,t,n){var r=null==(e=Ao(e,t=gi(t,e)))?e:e[No(Yo(t))];return null==r?i:St(r,e,n)}function Ir(e){return es(e)&&Sr(e)==m}function Rr(e,t,n,r,o){return e===t||(null==e||null==t||!es(e)&&!es(t)?e!=e&&t!=t:function(e,t,n,r,o,a){var s=Ha(e),l=Ha(t),c=s?g:ho(e),u=l?g:ho(t),h=(c=c==m?E:c)==E,d=(u=u==m?E:u)==E,f=c==u;if(f&&Xa(e)){if(!Xa(t))return!1;s=!0,h=!1}if(f&&!h)return a||(a=new Xn),s||ls(e)?Qi(e,t,n,r,o,a):function(e,t,n,r,i,o,a){switch(n){case L:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case P:return!(e.byteLength!=t.byteLength||!o(new je(e),new je(t)));case v:case y:case S:return za(+e,+t);case b:return e.name==t.name&&e.message==t.message;case M:case C:return e==t+"";case x:var s=on;case T:var l=1&r;if(s||(s=ln),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;r|=2,a.set(e,t);var u=Qi(s(e),s(t),r,i,o,a);return a.delete(e),u;case I:if(Nn)return Nn.call(e)==Nn.call(t)}return!1}(e,t,c,n,r,o,a);if(!(1&n)){var p=h&&ke.call(e,"__wrapped__"),_=d&&ke.call(t,"__wrapped__");if(p||_){var w=p?e.value():e,A=_?t.value():t;return a||(a=new Xn),o(w,A,n,r,a)}}return!!f&&(a||(a=new Xn),function(e,t,n,r,o,a){var s=1&n,l=eo(e),c=l.length;if(c!=eo(t).length&&!s)return!1;for(var u=c;u--;){var h=l[u];if(!(s?h in t:ke.call(t,h)))return!1}var d=a.get(e),f=a.get(t);if(d&&f)return d==t&&f==e;var p=!0;a.set(e,t),a.set(t,e);for(var m=s;++u<c;){var g=e[h=l[u]],v=t[h];if(r)var y=s?r(v,g,h,t,e,a):r(g,v,h,e,t,a);if(!(y===i?g===v||o(g,v,n,r,a):y)){p=!1;break}m||(m="constructor"==h)}if(p&&!m){var b=e.constructor,_=t.constructor;b==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(p=!1)}return a.delete(e),a.delete(t),p}(e,t,n,r,o,a))}(e,t,n,r,Rr,o))}function Pr(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=Ee(e);o--;){var l=n[o];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<a;){var c=(l=n[o])[0],u=e[c],h=l[1];if(s&&l[2]){if(u===i&&!(c in e))return!1}else{var d=new Xn;if(r)var f=r(u,h,c,e,t,d);if(!(f===i?Rr(h,u,3,r,d):f))return!1}}return!0}function Lr(e){return!(!Ja(e)||(t=e,Oe&&Oe in t))&&(Ka(e)?ze:me).test(Uo(e));var t}function kr(e){return"function"==typeof e?e:null==e?nl:"object"==typeof e?Ha(e)?Fr(e[0],e[1]):Ur(e):hl(e)}function Dr(e){if(!wo(e))return mn(e);var t=[];for(var n in Ee(e))ke.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Or(e,t){return e<t}function Nr(e,t){var n=-1,i=Wa(e)?r(e.length):[];return ur(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Ur(e){var t=so(e);return 1==t.length&&t[0][2]?So(t[0][0],t[0][1]):function(n){return n===e||Pr(n,e,t)}}function Fr(e,t){return yo(e)&&xo(t)?So(No(e),t):function(n){var r=As(n,e);return r===i&&r===t?Ms(n,e):Rr(t,r,3)}}function zr(e,t,n,r,o){e!==t&&gr(t,(function(a,s){if(o||(o=new Xn),Ja(a))!function(e,t,n,r,o,a,s){var l=Mo(e,n),c=Mo(t,n),u=s.get(c);if(u)Qn(e,n,u);else{var h=a?a(l,c,n+"",e,t,s):i,d=h===i;if(d){var f=Ha(c),p=!f&&Xa(c),m=!f&&!p&&ls(c);h=c,f||p||m?Ha(l)?h=l:qa(l)?h=Mi(l):p?(d=!1,h=_i(c,!0)):m?(d=!1,h=xi(c,!0)):h=[]:rs(c)||ja(c)?(h=l,ja(l)?h=gs(l):Ja(l)&&!Ka(l)||(h=po(c))):d=!1}d&&(s.set(c,h),o(h,c,r,a,s),s.delete(c)),Qn(e,n,h)}}(e,t,s,n,zr,r,o);else{var l=r?r(Mo(e,s),a,s+"",e,t,o):i;l===i&&(l=a),Qn(e,s,l)}}),Ps)}function Br(e,t){var n=e.length;if(n)return go(t+=t<0?n:0,n)?e[t]:i}function Vr(e,t,n){t=t.length?Pt(t,(function(e){return Ha(e)?function(t){return wr(t,1===e.length?e[0]:e)}:e})):[nl];var r=-1;t=Pt(t,Yt(oo()));var i=Nr(e,(function(e,n,i){var o=Pt(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e){var t=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var l=Si(i[r],o[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));t--;)e[t]=e[t].value;return e}(i)}function jr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=wr(e,a);n(s,a)&&Kr(o,gi(a,e),s)}return o}function Hr(e,t,n,r){var i=r?Bt:zt,o=-1,a=t.length,s=e;for(e===t&&(t=Mi(t)),n&&(s=Pt(e,Yt(n)));++o<a;)for(var l=0,c=t[o],u=n?n(c):c;(l=i(s,u,l,r))>-1;)s!==e&&Xe.call(s,l,1),Xe.call(e,l,1);return e}function Gr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;go(i)?Xe.call(e,i,1):li(e,i)}}return e}function Wr(e,t){return e+ft(_n()*(t-e+1))}function qr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=ft(t/2))&&(e+=e)}while(t);return n}function Xr(e,t){return Io(Eo(e,t,nl),e+"")}function $r(e){return Yn(zs(e))}function Yr(e,t){var n=zs(e);return Lo(n,or(t,0,n.length))}function Kr(e,t,n,r){if(!Ja(e))return e;for(var o=-1,a=(t=gi(t,e)).length,s=a-1,l=e;null!=l&&++o<a;){var c=No(t[o]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=s){var h=l[c];(u=r?r(h,c,l):i)===i&&(u=Ja(h)?h:go(t[o+1])?[]:{})}Jn(l,c,u),l=l[c]}return e}var Zr=Cn?function(e,t){return Cn.set(e,t),e}:nl,Qr=et?function(e,t){return et(e,"toString",{configurable:!0,enumerable:!1,value:Js(t),writable:!0})}:nl;function Jr(e){return Lo(zs(e))}function ei(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function ti(e,t){var n;return ur(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ni(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!ss(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return ri(e,t,nl,n)}function ri(e,t,n,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!=t,l=null===t,c=ss(t),u=t===i;o<a;){var h=ft((o+a)/2),d=n(e[h]),f=d!==i,p=null===d,m=d==d,g=ss(d);if(s)var v=r||m;else v=u?m&&(r||f):l?m&&f&&(r||!p):c?m&&f&&!p&&(r||!g):!p&&!g&&(r?d<=t:d<t);v?o=h+1:a=h}return vn(a,4294967294)}function ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!za(s,l)){var l=s;o[i++]=0===a?0:a}}return o}function oi(e){return"number"==typeof e?e:ss(e)?d:+e}function ai(e){if("string"==typeof e)return e;if(Ha(e))return Pt(e,ai)+"";if(ss(e))return Un?Un.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function si(e,t,n){var r=-1,i=It,o=e.length,a=!0,s=[],l=s;if(n)a=!1,i=Rt;else if(o>=200){var c=t?null:qi(e);if(c)return ln(c);a=!1,i=Zt,l=new qn}else l=t?[]:s;e:for(;++r<o;){var u=e[r],h=t?t(u):u;if(u=n||0!==u?u:0,a&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),s.push(u)}else i(l,h,n)||(l!==s&&l.push(h),s.push(u))}return s}function li(e,t){return null==(e=Ao(e,t=gi(t,e)))||delete e[No(Yo(t))]}function ci(e,t,n,r){return Kr(e,t,n(wr(e,t)),r)}function ui(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ei(e,r?0:o,r?o+1:i):ei(e,r?o+1:0,r?i:o)}function hi(e,t){var n=e;return n instanceof jn&&(n=n.value()),kt(t,(function(e,t){return t.func.apply(t.thisArg,Lt([e],t.args))}),n)}function di(e,t,n){var i=e.length;if(i<2)return i?si(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],l=-1;++l<i;)l!=o&&(a[o]=cr(a[o]||s,e[l],t,n));return si(mr(a,1),t,n)}function fi(e,t,n){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var l=r<a?t[r]:i;n(s,e[r],l)}return s}function pi(e){return qa(e)?e:[]}function mi(e){return"function"==typeof e?e:nl}function gi(e,t){return Ha(e)?e:yo(e,t)?[e]:Oo(vs(e))}var vi=Xr;function yi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ei(e,t,n)}var bi=at||function(e){return ht.clearTimeout(e)};function _i(e,t){if(t)return e.slice();var n=e.length,r=He?He(n):new e.constructor(n);return e.copy(r),r}function wi(e){var t=new e.constructor(e.byteLength);return new je(t).set(new je(e)),t}function xi(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Si(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,a=ss(e),s=t!==i,l=null===t,c=t==t,u=ss(t);if(!l&&!u&&!a&&e>t||a&&s&&c&&!l&&!u||r&&s&&c||!n&&c||!o)return 1;if(!r&&!a&&!u&&e<t||u&&n&&o&&!r&&!a||l&&n&&o||!s&&o||!c)return-1}return 0}function Ei(e,t,n,i){for(var o=-1,a=e.length,s=n.length,l=-1,c=t.length,u=gn(a-s,0),h=r(c+u),d=!i;++l<c;)h[l]=t[l];for(;++o<s;)(d||o<a)&&(h[n[o]]=e[o]);for(;u--;)h[l++]=e[o++];return h}function Ai(e,t,n,i){for(var o=-1,a=e.length,s=-1,l=n.length,c=-1,u=t.length,h=gn(a-l,0),d=r(h+u),f=!i;++o<h;)d[o]=e[o];for(var p=o;++c<u;)d[p+c]=t[c];for(;++s<l;)(f||o<a)&&(d[p+n[s]]=e[o++]);return d}function Mi(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ti(e,t,n,r){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var l=t[a],c=r?r(n[l],e[l],l,n,e):i;c===i&&(c=e[l]),o?rr(n,l,c):Jn(n,l,c)}return n}function Ci(e,t){return function(n,r){var i=Ha(n)?Et:tr,o=t?t():{};return i(n,e,oo(r,2),o)}}function Ii(e){return Xr((function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=e.length>3&&"function"==typeof a?(o--,a):i,s&&vo(n[0],n[1],s)&&(a=o<3?i:a,o=1),t=Ee(t);++r<o;){var l=n[r];l&&e(t,l,r,a)}return t}))}function Ri(e,t){return function(n,r){if(null==n)return n;if(!Wa(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Ee(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function Pi(e){return function(t,n,r){for(var i=-1,o=Ee(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}function Li(e){return function(t){var n=rn(t=vs(t))?hn(t):i,r=n?n[0]:t.charAt(0),o=n?yi(n,1).join(""):t.slice(1);return r[e]()+o}}function ki(e){return function(t){return kt(Ks(js(t).replace(Ke,"")),e,"")}}function Di(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=zn(e.prototype),r=e.apply(n,t);return Ja(r)?r:n}}function Oi(e){return function(t,n,r){var o=Ee(t);if(!Wa(t)){var a=oo(n,3);t=Rs(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[a?t[s]:s]:i}}function Ni(e){return Ji((function(t){var n=t.length,r=n,a=Vn.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new Te(o);if(a&&!l&&"wrapper"==ro(s))var l=new Vn([],!0)}for(r=l?r:n;++r<n;){var c=ro(s=t[r]),u="wrapper"==c?no(s):i;l=u&&bo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[ro(u[0])].apply(l,u[3]):1==s.length&&bo(s)?l[c]():l.thru(s)}return function(){var e=arguments,r=e[0];if(l&&1==e.length&&Ha(r))return l.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Ui(e,t,n,o,a,s,l,u,h,d){var f=t&c,p=1&t,m=2&t,g=24&t,v=512&t,y=m?i:Di(e);return function c(){for(var b=arguments.length,_=r(b),w=b;w--;)_[w]=arguments[w];if(g)var x=io(c),S=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(_,x);if(o&&(_=Ei(_,o,a,g)),s&&(_=Ai(_,s,l,g)),b-=S,g&&b<d){var E=sn(_,x);return Gi(e,t,Ui,c.placeholder,n,_,E,u,h,d-b)}var A=p?n:this,M=m?A[e]:e;return b=_.length,u?_=function(e,t){for(var n=e.length,r=vn(t.length,n),o=Mi(e);r--;){var a=t[r];e[r]=go(a,n)?o[a]:i}return e}(_,u):v&&b>1&&_.reverse(),f&&h<b&&(_.length=h),this&&this!==ht&&this instanceof c&&(M=y||Di(M)),M.apply(A,_)}}function Fi(e,t){return function(n,r){return function(e,t,n,r){return yr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function zi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=ai(n),r=ai(r)):(n=oi(n),r=oi(r)),o=e(n,r)}return o}}function Bi(e){return Ji((function(t){return t=Pt(t,Yt(oo())),Xr((function(n){var r=this;return e(t,(function(e){return St(e,r,n)}))}))}))}function Vi(e,t){var n=(t=t===i?" ":ai(t)).length;if(n<2)return n?qr(t,e):t;var r=qr(t,dt(e/un(t)));return rn(t)?yi(hn(r),0,e).join(""):r.slice(0,e)}function ji(e){return function(t,n,o){return o&&"number"!=typeof o&&vo(t,n,o)&&(n=o=i),t=ds(t),n===i?(n=t,t=0):n=ds(n),function(e,t,n,i){for(var o=-1,a=gn(dt((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,o=o===i?t<n?1:-1:ds(o),e)}}function Hi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ms(t),n=ms(n)),e(t,n)}}function Gi(e,t,n,r,o,a,s,c,u,h){var d=8&t;t|=d?l:64,4&(t&=~(d?64:l))||(t&=-4);var f=[e,t,o,d?a:i,d?s:i,d?i:a,d?i:s,c,u,h],p=n.apply(i,f);return bo(e)&&To(p,f),p.placeholder=r,Ro(p,e,t)}function Wi(e){var t=Se[e];return function(e,n){if(e=ms(e),(n=null==n?0:vn(fs(n),292))&&Nt(e)){var r=(vs(e)+"e").split("e");return+((r=(vs(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var qi=An&&1/ln(new An([,-0]))[1]==u?function(e){return new An(e)}:sl;function Xi(e){return function(t){var n=ho(t);return n==x?on(t):n==T?cn(t):function(e,t){return Pt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function $i(e,t,n,a,u,h,d,f){var p=2&t;if(!p&&"function"!=typeof e)throw new Te(o);var m=a?a.length:0;if(m||(t&=-97,a=u=i),d=d===i?d:gn(fs(d),0),f=f===i?f:fs(f),m-=u?u.length:0,64&t){var g=a,v=u;a=u=i}var y=p?i:no(e),b=[e,t,n,a,u,g,v,h,d,f];if(y&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=r==c&&8==n||r==c&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?Ei(u,l,t[4]):l,e[4]=u?sn(e[3],s):t[4]}(l=t[5])&&(u=e[5],e[5]=u?Ai(u,l,t[6]):l,e[6]=u?sn(e[5],s):t[6]),(l=t[7])&&(e[7]=l),r&c&&(e[8]=null==e[8]?t[8]:vn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(b,y),e=b[0],t=b[1],n=b[2],a=b[3],u=b[4],!(f=b[9]=b[9]===i?p?0:e.length:gn(b[9]-m,0))&&24&t&&(t&=-25),t&&1!=t)_=8==t||16==t?function(e,t,n){var o=Di(e);return function a(){for(var s=arguments.length,l=r(s),c=s,u=io(a);c--;)l[c]=arguments[c];var h=s<3&&l[0]!==u&&l[s-1]!==u?[]:sn(l,u);return(s-=h.length)<n?Gi(e,t,Ui,a.placeholder,i,l,h,i,i,n-s):St(this&&this!==ht&&this instanceof a?o:e,this,l)}}(e,t,f):t!=l&&33!=t||u.length?Ui.apply(i,b):function(e,t,n,i){var o=1&t,a=Di(e);return function t(){for(var s=-1,l=arguments.length,c=-1,u=i.length,h=r(u+l),d=this&&this!==ht&&this instanceof t?a:e;++c<u;)h[c]=i[c];for(;l--;)h[c++]=arguments[++s];return St(d,o?n:this,h)}}(e,t,n,a);else var _=function(e,t,n){var r=1&t,i=Di(e);return function t(){return(this&&this!==ht&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Ro((y?Zr:To)(_,b),e,t)}function Yi(e,t,n,r){return e===i||za(e,Re[n])&&!ke.call(r,n)?t:e}function Ki(e,t,n,r,o,a){return Ja(e)&&Ja(t)&&(a.set(t,e),zr(e,t,i,Ki,a),a.delete(t)),e}function Zi(e){return rs(e)?i:e}function Qi(e,t,n,r,o,a){var s=1&n,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var u=a.get(e),h=a.get(t);if(u&&h)return u==t&&h==e;var d=-1,f=!0,p=2&n?new qn:i;for(a.set(e,t),a.set(t,e);++d<l;){var m=e[d],g=t[d];if(r)var v=s?r(g,m,d,t,e,a):r(m,g,d,e,t,a);if(v!==i){if(v)continue;f=!1;break}if(p){if(!Ot(t,(function(e,t){if(!Zt(p,t)&&(m===e||o(m,e,n,r,a)))return p.push(t)}))){f=!1;break}}else if(m!==g&&!o(m,g,n,r,a)){f=!1;break}}return a.delete(e),a.delete(t),f}function Ji(e){return Io(Eo(e,i,Go),e+"")}function eo(e){return xr(e,Rs,co)}function to(e){return xr(e,Ps,uo)}var no=Cn?function(e){return Cn.get(e)}:sl;function ro(e){for(var t=e.name+"",n=In[t],r=ke.call(In,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function io(e){return(ke.call(Fn,"placeholder")?Fn:e).placeholder}function oo(){var e=Fn.iteratee||rl;return e=e===rl?kr:e,arguments.length?e(arguments[0],arguments[1]):e}function ao(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function so(e){for(var t=Rs(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,xo(i)]}return t}function lo(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Lr(n)?n:i}var co=mt?function(e){return null==e?[]:(e=Ee(e),Ct(mt(e),(function(t){return qe.call(e,t)})))}:pl,uo=mt?function(e){for(var t=[];e;)Lt(t,co(e)),e=Ge(e);return t}:pl,ho=Sr;function fo(e,t,n){for(var r=-1,i=(t=gi(t,e)).length,o=!1;++r<i;){var a=No(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Qa(i)&&go(a,i)&&(Ha(e)||ja(e))}function po(e){return"function"!=typeof e.constructor||wo(e)?{}:zn(Ge(e))}function mo(e){return Ha(e)||ja(e)||!!($e&&e&&e[$e])}function go(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&ve.test(e))&&e>-1&&e%1==0&&e<t}function vo(e,t,n){if(!Ja(n))return!1;var r=typeof t;return!!("number"==r?Wa(n)&&go(t,n.length):"string"==r&&t in n)&&za(n[t],e)}function yo(e,t){if(Ha(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ss(e))||J.test(e)||!Q.test(e)||null!=t&&e in Ee(t)}function bo(e){var t=ro(e),n=Fn[t];if("function"!=typeof n||!(t in jn.prototype))return!1;if(e===n)return!0;var r=no(n);return!!r&&e===r[0]}(xn&&ho(new xn(new ArrayBuffer(1)))!=L||Sn&&ho(new Sn)!=x||En&&ho(En.resolve())!=A||An&&ho(new An)!=T||Mn&&ho(new Mn)!=R)&&(ho=function(e){var t=Sr(e),n=t==E?e.constructor:i,r=n?Uo(n):"";if(r)switch(r){case Rn:return L;case Pn:return x;case Ln:return A;case kn:return T;case Dn:return R}return t});var _o=Pe?Ka:ml;function wo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Re)}function xo(e){return e==e&&!Ja(e)}function So(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in Ee(n))}}function Eo(e,t,n){return t=gn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=gn(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var l=r(t+1);++o<t;)l[o]=i[o];return l[t]=n(s),St(e,this,l)}}function Ao(e,t){return t.length<2?e:wr(e,ei(t,0,-1))}function Mo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var To=Po(Zr),Co=ut||function(e,t){return ht.setTimeout(e,t)},Io=Po(Qr);function Ro(e,t,n){var r=t+"";return Io(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return At(p,(function(n){var r="_."+n[0];t&n[1]&&!It(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(ae);return t?t[1].split(se):[]}(r),n)))}function Po(e){var t=0,n=0;return function(){var r=yn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Lo(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var a=Wr(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var ko,Do,Oo=(ko=ka((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,n,r,i){t.push(r?i.replace(ue,"$1"):n||e)})),t}),(function(e){return 500===Do.size&&Do.clear(),e})),Do=ko.cache,ko);function No(e){if("string"==typeof e||ss(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Uo(e){if(null!=e){try{return Le.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Fo(e){if(e instanceof jn)return e.clone();var t=new Vn(e.__wrapped__,e.__chain__);return t.__actions__=Mi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var zo=Xr((function(e,t){return qa(e)?cr(e,mr(t,1,qa,!0)):[]})),Bo=Xr((function(e,t){var n=Yo(t);return qa(n)&&(n=i),qa(e)?cr(e,mr(t,1,qa,!0),oo(n,2)):[]})),Vo=Xr((function(e,t){var n=Yo(t);return qa(n)&&(n=i),qa(e)?cr(e,mr(t,1,qa,!0),i,n):[]}));function jo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:fs(n);return i<0&&(i=gn(r+i,0)),Ft(e,oo(t,3),i)}function Ho(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=fs(n),o=n<0?gn(r+o,0):vn(o,r-1)),Ft(e,oo(t,3),o,!0)}function Go(e){return null!=e&&e.length?mr(e,1):[]}function Wo(e){return e&&e.length?e[0]:i}var qo=Xr((function(e){var t=Pt(e,pi);return t.length&&t[0]===e[0]?Tr(t):[]})),Xo=Xr((function(e){var t=Yo(e),n=Pt(e,pi);return t===Yo(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Tr(n,oo(t,2)):[]})),$o=Xr((function(e){var t=Yo(e),n=Pt(e,pi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Tr(n,i,t):[]}));function Yo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Ko=Xr(Zo);function Zo(e,t){return e&&e.length&&t&&t.length?Hr(e,t):e}var Qo=Ji((function(e,t){var n=null==e?0:e.length,r=ir(e,t);return Gr(e,Pt(t,(function(e){return go(e,n)?+e:e})).sort(Si)),r}));function Jo(e){return null==e?e:wn.call(e)}var ea=Xr((function(e){return si(mr(e,1,qa,!0))})),ta=Xr((function(e){var t=Yo(e);return qa(t)&&(t=i),si(mr(e,1,qa,!0),oo(t,2))})),na=Xr((function(e){var t=Yo(e);return t="function"==typeof t?t:i,si(mr(e,1,qa,!0),i,t)}));function ra(e){if(!e||!e.length)return[];var t=0;return e=Ct(e,(function(e){if(qa(e))return t=gn(e.length,t),!0})),Xt(t,(function(t){return Pt(e,Ht(t))}))}function ia(e,t){if(!e||!e.length)return[];var n=ra(e);return null==t?n:Pt(n,(function(e){return St(t,i,e)}))}var oa=Xr((function(e,t){return qa(e)?cr(e,t):[]})),aa=Xr((function(e){return di(Ct(e,qa))})),sa=Xr((function(e){var t=Yo(e);return qa(t)&&(t=i),di(Ct(e,qa),oo(t,2))})),la=Xr((function(e){var t=Yo(e);return t="function"==typeof t?t:i,di(Ct(e,qa),i,t)})),ca=Xr(ra),ua=Xr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,ia(e,n)}));function ha(e){var t=Fn(e);return t.__chain__=!0,t}function da(e,t){return t(e)}var fa=Ji((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof jn&&go(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:da,args:[o],thisArg:i}),new Vn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),pa=Ci((function(e,t,n){ke.call(e,n)?++e[n]:rr(e,n,1)})),ma=Oi(jo),ga=Oi(Ho);function va(e,t){return(Ha(e)?At:ur)(e,oo(t,3))}function ya(e,t){return(Ha(e)?Mt:hr)(e,oo(t,3))}var ba=Ci((function(e,t,n){ke.call(e,n)?e[n].push(t):rr(e,n,[t])})),_a=Xr((function(e,t,n){var i=-1,o="function"==typeof t,a=Wa(e)?r(e.length):[];return ur(e,(function(e){a[++i]=o?St(t,e,n):Cr(e,t,n)})),a})),wa=Ci((function(e,t,n){rr(e,n,t)}));function xa(e,t){return(Ha(e)?Pt:Nr)(e,oo(t,3))}var Sa=Ci((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),Ea=Xr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&vo(e,t[0],t[1])?t=[]:n>2&&vo(t[0],t[1],t[2])&&(t=[t[0]]),Vr(e,mr(t,1),[])})),Aa=ct||function(){return ht.Date.now()};function Ma(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,$i(e,c,i,i,i,i,t)}function Ta(e,t){var n;if("function"!=typeof t)throw new Te(o);return e=fs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Ca=Xr((function(e,t,n){var r=1;if(n.length){var i=sn(n,io(Ca));r|=l}return $i(e,r,t,n,i)})),Ia=Xr((function(e,t,n){var r=3;if(n.length){var i=sn(n,io(Ia));r|=l}return $i(t,r,e,n,i)}));function Ra(e,t,n){var r,a,s,l,c,u,h=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new Te(o);function m(t){var n=r,o=a;return r=a=i,h=t,l=e.apply(o,n)}function g(e){var n=e-u;return u===i||n>=t||n<0||f&&e-h>=s}function v(){var e=Aa();if(g(e))return y(e);c=Co(v,function(e){var n=t-(e-u);return f?vn(n,s-(e-h)):n}(e))}function y(e){return c=i,p&&r?m(e):(r=a=i,l)}function b(){var e=Aa(),n=g(e);if(r=arguments,a=this,u=e,n){if(c===i)return function(e){return h=e,c=Co(v,t),d?m(e):l}(u);if(f)return bi(c),c=Co(v,t),m(u)}return c===i&&(c=Co(v,t)),l}return t=ms(t)||0,Ja(n)&&(d=!!n.leading,s=(f="maxWait"in n)?gn(ms(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),b.cancel=function(){c!==i&&bi(c),h=0,r=u=a=c=i},b.flush=function(){return c===i?l:y(Aa())},b}var Pa=Xr((function(e,t){return lr(e,1,t)})),La=Xr((function(e,t,n){return lr(e,ms(t)||0,n)}));function ka(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Te(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(ka.Cache||Wn),n}function Da(e){if("function"!=typeof e)throw new Te(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}ka.Cache=Wn;var Oa=vi((function(e,t){var n=(t=1==t.length&&Ha(t[0])?Pt(t[0],Yt(oo())):Pt(mr(t,1),Yt(oo()))).length;return Xr((function(r){for(var i=-1,o=vn(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return St(e,this,r)}))})),Na=Xr((function(e,t){var n=sn(t,io(Na));return $i(e,l,i,t,n)})),Ua=Xr((function(e,t){var n=sn(t,io(Ua));return $i(e,64,i,t,n)})),Fa=Ji((function(e,t){return $i(e,256,i,i,i,t)}));function za(e,t){return e===t||e!=e&&t!=t}var Ba=Hi(Er),Va=Hi((function(e,t){return e>=t})),ja=Ir(function(){return arguments}())?Ir:function(e){return es(e)&&ke.call(e,"callee")&&!qe.call(e,"callee")},Ha=r.isArray,Ga=vt?Yt(vt):function(e){return es(e)&&Sr(e)==P};function Wa(e){return null!=e&&Qa(e.length)&&!Ka(e)}function qa(e){return es(e)&&Wa(e)}var Xa=gt||ml,$a=yt?Yt(yt):function(e){return es(e)&&Sr(e)==y};function Ya(e){if(!es(e))return!1;var t=Sr(e);return t==b||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!rs(e)}function Ka(e){if(!Ja(e))return!1;var t=Sr(e);return t==_||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Za(e){return"number"==typeof e&&e==fs(e)}function Qa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function Ja(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function es(e){return null!=e&&"object"==typeof e}var ts=bt?Yt(bt):function(e){return es(e)&&ho(e)==x};function ns(e){return"number"==typeof e||es(e)&&Sr(e)==S}function rs(e){if(!es(e)||Sr(e)!=E)return!1;var t=Ge(e);if(null===t)return!0;var n=ke.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Le.call(n)==Ue}var is=_t?Yt(_t):function(e){return es(e)&&Sr(e)==M},os=wt?Yt(wt):function(e){return es(e)&&ho(e)==T};function as(e){return"string"==typeof e||!Ha(e)&&es(e)&&Sr(e)==C}function ss(e){return"symbol"==typeof e||es(e)&&Sr(e)==I}var ls=xt?Yt(xt):function(e){return es(e)&&Qa(e.length)&&!!it[Sr(e)]},cs=Hi(Or),us=Hi((function(e,t){return e<=t}));function hs(e){if(!e)return[];if(Wa(e))return as(e)?hn(e):Mi(e);if(Ye&&e[Ye])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ye]());var t=ho(e);return(t==x?on:t==T?ln:zs)(e)}function ds(e){return e?(e=ms(e))===u||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function fs(e){var t=ds(e),n=t%1;return t==t?n?t-n:t:0}function ps(e){return e?or(fs(e),0,f):0}function ms(e){if("number"==typeof e)return e;if(ss(e))return d;if(Ja(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ja(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=$t(e);var n=pe.test(e);return n||ge.test(e)?lt(e.slice(2),n?2:8):fe.test(e)?d:+e}function gs(e){return Ti(e,Ps(e))}function vs(e){return null==e?"":ai(e)}var ys=Ii((function(e,t){if(wo(t)||Wa(t))Ti(t,Rs(t),e);else for(var n in t)ke.call(t,n)&&Jn(e,n,t[n])})),bs=Ii((function(e,t){Ti(t,Ps(t),e)})),_s=Ii((function(e,t,n,r){Ti(t,Ps(t),e,r)})),ws=Ii((function(e,t,n,r){Ti(t,Rs(t),e,r)})),xs=Ji(ir),Ss=Xr((function(e,t){e=Ee(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&vo(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],s=Ps(a),l=-1,c=s.length;++l<c;){var u=s[l],h=e[u];(h===i||za(h,Re[u])&&!ke.call(e,u))&&(e[u]=a[u])}return e})),Es=Xr((function(e){return e.push(i,Ki),St(ks,i,e)}));function As(e,t,n){var r=null==e?i:wr(e,t);return r===i?n:r}function Ms(e,t){return null!=e&&fo(e,t,Mr)}var Ts=Fi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ne.call(t)),e[t]=n}),Js(nl)),Cs=Fi((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ne.call(t)),ke.call(e,t)?e[t].push(n):e[t]=[n]}),oo),Is=Xr(Cr);function Rs(e){return Wa(e)?$n(e):Dr(e)}function Ps(e){return Wa(e)?$n(e,!0):function(e){if(!Ja(e))return function(e){var t=[];if(null!=e)for(var n in Ee(e))t.push(n);return t}(e);var t=wo(e),n=[];for(var r in e)("constructor"!=r||!t&&ke.call(e,r))&&n.push(r);return n}(e)}var Ls=Ii((function(e,t,n){zr(e,t,n)})),ks=Ii((function(e,t,n,r){zr(e,t,n,r)})),Ds=Ji((function(e,t){var n={};if(null==e)return n;var r=!1;t=Pt(t,(function(t){return t=gi(t,e),r||(r=t.length>1),t})),Ti(e,to(e),n),r&&(n=ar(n,7,Zi));for(var i=t.length;i--;)li(n,t[i]);return n})),Os=Ji((function(e,t){return null==e?{}:function(e,t){return jr(e,t,(function(t,n){return Ms(e,n)}))}(e,t)}));function Ns(e,t){if(null==e)return{};var n=Pt(to(e),(function(e){return[e]}));return t=oo(t),jr(e,n,(function(e,n){return t(e,n[0])}))}var Us=Xi(Rs),Fs=Xi(Ps);function zs(e){return null==e?[]:Kt(e,Rs(e))}var Bs=ki((function(e,t,n){return t=t.toLowerCase(),e+(n?Vs(t):t)}));function Vs(e){return Ys(vs(e).toLowerCase())}function js(e){return(e=vs(e))&&e.replace(ye,en).replace(Ze,"")}var Hs=ki((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Gs=ki((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ws=Li("toLowerCase"),qs=ki((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Xs=ki((function(e,t,n){return e+(n?" ":"")+Ys(t)})),$s=ki((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ys=Li("toUpperCase");function Ks(e,t,n){return e=vs(e),(t=n?i:t)===i?function(e){return tt.test(e)}(e)?function(e){return e.match(Je)||[]}(e):function(e){return e.match(le)||[]}(e):e.match(t)||[]}var Zs=Xr((function(e,t){try{return St(e,i,t)}catch(e){return Ya(e)?e:new we(e)}})),Qs=Ji((function(e,t){return At(t,(function(t){t=No(t),rr(e,t,Ca(e[t],e))})),e}));function Js(e){return function(){return e}}var el=Ni(),tl=Ni(!0);function nl(e){return e}function rl(e){return kr("function"==typeof e?e:ar(e,1))}var il=Xr((function(e,t){return function(n){return Cr(n,e,t)}})),ol=Xr((function(e,t){return function(n){return Cr(e,n,t)}}));function al(e,t,n){var r=Rs(t),i=_r(t,r);null!=n||Ja(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=_r(t,Rs(t)));var o=!(Ja(n)&&"chain"in n&&!n.chain),a=Ka(e);return At(i,(function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Mi(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Lt([this.value()],arguments))})})),e}function sl(){}var ll=Bi(Pt),cl=Bi(Tt),ul=Bi(Ot);function hl(e){return yo(e)?Ht(No(e)):function(e){return function(t){return wr(t,e)}}(e)}var dl=ji(),fl=ji(!0);function pl(){return[]}function ml(){return!1}var gl,vl=zi((function(e,t){return e+t}),0),yl=Wi("ceil"),bl=zi((function(e,t){return e/t}),1),_l=Wi("floor"),wl=zi((function(e,t){return e*t}),1),xl=Wi("round"),Sl=zi((function(e,t){return e-t}),0);return Fn.after=function(e,t){if("function"!=typeof t)throw new Te(o);return e=fs(e),function(){if(--e<1)return t.apply(this,arguments)}},Fn.ary=Ma,Fn.assign=ys,Fn.assignIn=bs,Fn.assignInWith=_s,Fn.assignWith=ws,Fn.at=xs,Fn.before=Ta,Fn.bind=Ca,Fn.bindAll=Qs,Fn.bindKey=Ia,Fn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Ha(e)?e:[e]},Fn.chain=ha,Fn.chunk=function(e,t,n){t=(n?vo(e,t,n):t===i)?1:gn(fs(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,l=r(dt(o/t));a<o;)l[s++]=ei(e,a,a+=t);return l},Fn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},Fn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Lt(Ha(n)?Mi(n):[n],mr(t,1))},Fn.cond=function(e){var t=null==e?0:e.length,n=oo();return e=t?Pt(e,(function(e){if("function"!=typeof e[1])throw new Te(o);return[n(e[0]),e[1]]})):[],Xr((function(n){for(var r=-1;++r<t;){var i=e[r];if(St(i[0],this,n))return St(i[1],this,n)}}))},Fn.conforms=function(e){return function(e){var t=Rs(e);return function(n){return sr(n,e,t)}}(ar(e,1))},Fn.constant=Js,Fn.countBy=pa,Fn.create=function(e,t){var n=zn(e);return null==t?n:nr(n,t)},Fn.curry=function e(t,n,r){var o=$i(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Fn.curryRight=function e(t,n,r){var o=$i(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},Fn.debounce=Ra,Fn.defaults=Ss,Fn.defaultsDeep=Es,Fn.defer=Pa,Fn.delay=La,Fn.difference=zo,Fn.differenceBy=Bo,Fn.differenceWith=Vo,Fn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=n||t===i?1:fs(t))<0?0:t,r):[]},Fn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,0,(t=r-(t=n||t===i?1:fs(t)))<0?0:t):[]},Fn.dropRightWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!0,!0):[]},Fn.dropWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!0):[]},Fn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&vo(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=fs(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:fs(r))<0&&(r+=o),r=n>r?0:ps(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},Fn.filter=function(e,t){return(Ha(e)?Ct:pr)(e,oo(t,3))},Fn.flatMap=function(e,t){return mr(xa(e,t),1)},Fn.flatMapDeep=function(e,t){return mr(xa(e,t),u)},Fn.flatMapDepth=function(e,t,n){return n=n===i?1:fs(n),mr(xa(e,t),n)},Fn.flatten=Go,Fn.flattenDeep=function(e){return null!=e&&e.length?mr(e,u):[]},Fn.flattenDepth=function(e,t){return null!=e&&e.length?mr(e,t=t===i?1:fs(t)):[]},Fn.flip=function(e){return $i(e,512)},Fn.flow=el,Fn.flowRight=tl,Fn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},Fn.functions=function(e){return null==e?[]:_r(e,Rs(e))},Fn.functionsIn=function(e){return null==e?[]:_r(e,Ps(e))},Fn.groupBy=ba,Fn.initial=function(e){return null!=e&&e.length?ei(e,0,-1):[]},Fn.intersection=qo,Fn.intersectionBy=Xo,Fn.intersectionWith=$o,Fn.invert=Ts,Fn.invertBy=Cs,Fn.invokeMap=_a,Fn.iteratee=rl,Fn.keyBy=wa,Fn.keys=Rs,Fn.keysIn=Ps,Fn.map=xa,Fn.mapKeys=function(e,t){var n={};return t=oo(t,3),yr(e,(function(e,r,i){rr(n,t(e,r,i),e)})),n},Fn.mapValues=function(e,t){var n={};return t=oo(t,3),yr(e,(function(e,r,i){rr(n,r,t(e,r,i))})),n},Fn.matches=function(e){return Ur(ar(e,1))},Fn.matchesProperty=function(e,t){return Fr(e,ar(t,1))},Fn.memoize=ka,Fn.merge=Ls,Fn.mergeWith=ks,Fn.method=il,Fn.methodOf=ol,Fn.mixin=al,Fn.negate=Da,Fn.nthArg=function(e){return e=fs(e),Xr((function(t){return Br(t,e)}))},Fn.omit=Ds,Fn.omitBy=function(e,t){return Ns(e,Da(oo(t)))},Fn.once=function(e){return Ta(2,e)},Fn.orderBy=function(e,t,n,r){return null==e?[]:(Ha(t)||(t=null==t?[]:[t]),Ha(n=r?i:n)||(n=null==n?[]:[n]),Vr(e,t,n))},Fn.over=ll,Fn.overArgs=Oa,Fn.overEvery=cl,Fn.overSome=ul,Fn.partial=Na,Fn.partialRight=Ua,Fn.partition=Sa,Fn.pick=Os,Fn.pickBy=Ns,Fn.property=hl,Fn.propertyOf=function(e){return function(t){return null==e?i:wr(e,t)}},Fn.pull=Ko,Fn.pullAll=Zo,Fn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Hr(e,t,oo(n,2)):e},Fn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Hr(e,t,i,n):e},Fn.pullAt=Qo,Fn.range=dl,Fn.rangeRight=fl,Fn.rearg=Fa,Fn.reject=function(e,t){return(Ha(e)?Ct:pr)(e,Da(oo(t,3)))},Fn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=oo(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return Gr(e,i),n},Fn.rest=function(e,t){if("function"!=typeof e)throw new Te(o);return Xr(e,t=t===i?t:fs(t))},Fn.reverse=Jo,Fn.sampleSize=function(e,t,n){return t=(n?vo(e,t,n):t===i)?1:fs(t),(Ha(e)?Kn:Yr)(e,t)},Fn.set=function(e,t,n){return null==e?e:Kr(e,t,n)},Fn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:Kr(e,t,n,r)},Fn.shuffle=function(e){return(Ha(e)?Zn:Jr)(e)},Fn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&vo(e,t,n)?(t=0,n=r):(t=null==t?0:fs(t),n=n===i?r:fs(n)),ei(e,t,n)):[]},Fn.sortBy=Ea,Fn.sortedUniq=function(e){return e&&e.length?ii(e):[]},Fn.sortedUniqBy=function(e,t){return e&&e.length?ii(e,oo(t,2)):[]},Fn.split=function(e,t,n){return n&&"number"!=typeof n&&vo(e,t,n)&&(t=n=i),(n=n===i?f:n>>>0)?(e=vs(e))&&("string"==typeof t||null!=t&&!is(t))&&!(t=ai(t))&&rn(e)?yi(hn(e),0,n):e.split(t,n):[]},Fn.spread=function(e,t){if("function"!=typeof e)throw new Te(o);return t=null==t?0:gn(fs(t),0),Xr((function(n){var r=n[t],i=yi(n,0,t);return r&&Lt(i,r),St(e,this,i)}))},Fn.tail=function(e){var t=null==e?0:e.length;return t?ei(e,1,t):[]},Fn.take=function(e,t,n){return e&&e.length?ei(e,0,(t=n||t===i?1:fs(t))<0?0:t):[]},Fn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=r-(t=n||t===i?1:fs(t)))<0?0:t,r):[]},Fn.takeRightWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!1,!0):[]},Fn.takeWhile=function(e,t){return e&&e.length?ui(e,oo(t,3)):[]},Fn.tap=function(e,t){return t(e),e},Fn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Te(o);return Ja(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ra(e,t,{leading:r,maxWait:t,trailing:i})},Fn.thru=da,Fn.toArray=hs,Fn.toPairs=Us,Fn.toPairsIn=Fs,Fn.toPath=function(e){return Ha(e)?Pt(e,No):ss(e)?[e]:Mi(Oo(vs(e)))},Fn.toPlainObject=gs,Fn.transform=function(e,t,n){var r=Ha(e),i=r||Xa(e)||ls(e);if(t=oo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Ja(e)&&Ka(o)?zn(Ge(e)):{}}return(i?At:yr)(e,(function(e,r,i){return t(n,e,r,i)})),n},Fn.unary=function(e){return Ma(e,1)},Fn.union=ea,Fn.unionBy=ta,Fn.unionWith=na,Fn.uniq=function(e){return e&&e.length?si(e):[]},Fn.uniqBy=function(e,t){return e&&e.length?si(e,oo(t,2)):[]},Fn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?si(e,i,t):[]},Fn.unset=function(e,t){return null==e||li(e,t)},Fn.unzip=ra,Fn.unzipWith=ia,Fn.update=function(e,t,n){return null==e?e:ci(e,t,mi(n))},Fn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ci(e,t,mi(n),r)},Fn.values=zs,Fn.valuesIn=function(e){return null==e?[]:Kt(e,Ps(e))},Fn.without=oa,Fn.words=Ks,Fn.wrap=function(e,t){return Na(mi(t),e)},Fn.xor=aa,Fn.xorBy=sa,Fn.xorWith=la,Fn.zip=ca,Fn.zipObject=function(e,t){return fi(e||[],t||[],Jn)},Fn.zipObjectDeep=function(e,t){return fi(e||[],t||[],Kr)},Fn.zipWith=ua,Fn.entries=Us,Fn.entriesIn=Fs,Fn.extend=bs,Fn.extendWith=_s,al(Fn,Fn),Fn.add=vl,Fn.attempt=Zs,Fn.camelCase=Bs,Fn.capitalize=Vs,Fn.ceil=yl,Fn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ms(n))==n?n:0),t!==i&&(t=(t=ms(t))==t?t:0),or(ms(e),t,n)},Fn.clone=function(e){return ar(e,4)},Fn.cloneDeep=function(e){return ar(e,5)},Fn.cloneDeepWith=function(e,t){return ar(e,5,t="function"==typeof t?t:i)},Fn.cloneWith=function(e,t){return ar(e,4,t="function"==typeof t?t:i)},Fn.conformsTo=function(e,t){return null==t||sr(e,t,Rs(t))},Fn.deburr=js,Fn.defaultTo=function(e,t){return null==e||e!=e?t:e},Fn.divide=bl,Fn.endsWith=function(e,t,n){e=vs(e),t=ai(t);var r=e.length,o=n=n===i?r:or(fs(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},Fn.eq=za,Fn.escape=function(e){return(e=vs(e))&&$.test(e)?e.replace(q,tn):e},Fn.escapeRegExp=function(e){return(e=vs(e))&&ne.test(e)?e.replace(te,"\\$&"):e},Fn.every=function(e,t,n){var r=Ha(e)?Tt:dr;return n&&vo(e,t,n)&&(t=i),r(e,oo(t,3))},Fn.find=ma,Fn.findIndex=jo,Fn.findKey=function(e,t){return Ut(e,oo(t,3),yr)},Fn.findLast=ga,Fn.findLastIndex=Ho,Fn.findLastKey=function(e,t){return Ut(e,oo(t,3),br)},Fn.floor=_l,Fn.forEach=va,Fn.forEachRight=ya,Fn.forIn=function(e,t){return null==e?e:gr(e,oo(t,3),Ps)},Fn.forInRight=function(e,t){return null==e?e:vr(e,oo(t,3),Ps)},Fn.forOwn=function(e,t){return e&&yr(e,oo(t,3))},Fn.forOwnRight=function(e,t){return e&&br(e,oo(t,3))},Fn.get=As,Fn.gt=Ba,Fn.gte=Va,Fn.has=function(e,t){return null!=e&&fo(e,t,Ar)},Fn.hasIn=Ms,Fn.head=Wo,Fn.identity=nl,Fn.includes=function(e,t,n,r){e=Wa(e)?e:zs(e),n=n&&!r?fs(n):0;var i=e.length;return n<0&&(n=gn(i+n,0)),as(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&zt(e,t,n)>-1},Fn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:fs(n);return i<0&&(i=gn(r+i,0)),zt(e,t,i)},Fn.inRange=function(e,t,n){return t=ds(t),n===i?(n=t,t=0):n=ds(n),function(e,t,n){return e>=vn(t,n)&&e<gn(t,n)}(e=ms(e),t,n)},Fn.invoke=Is,Fn.isArguments=ja,Fn.isArray=Ha,Fn.isArrayBuffer=Ga,Fn.isArrayLike=Wa,Fn.isArrayLikeObject=qa,Fn.isBoolean=function(e){return!0===e||!1===e||es(e)&&Sr(e)==v},Fn.isBuffer=Xa,Fn.isDate=$a,Fn.isElement=function(e){return es(e)&&1===e.nodeType&&!rs(e)},Fn.isEmpty=function(e){if(null==e)return!0;if(Wa(e)&&(Ha(e)||"string"==typeof e||"function"==typeof e.splice||Xa(e)||ls(e)||ja(e)))return!e.length;var t=ho(e);if(t==x||t==T)return!e.size;if(wo(e))return!Dr(e).length;for(var n in e)if(ke.call(e,n))return!1;return!0},Fn.isEqual=function(e,t){return Rr(e,t)},Fn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Rr(e,t,i,n):!!r},Fn.isError=Ya,Fn.isFinite=function(e){return"number"==typeof e&&Nt(e)},Fn.isFunction=Ka,Fn.isInteger=Za,Fn.isLength=Qa,Fn.isMap=ts,Fn.isMatch=function(e,t){return e===t||Pr(e,t,so(t))},Fn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Pr(e,t,so(t),n)},Fn.isNaN=function(e){return ns(e)&&e!=+e},Fn.isNative=function(e){if(_o(e))throw new we("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Lr(e)},Fn.isNil=function(e){return null==e},Fn.isNull=function(e){return null===e},Fn.isNumber=ns,Fn.isObject=Ja,Fn.isObjectLike=es,Fn.isPlainObject=rs,Fn.isRegExp=is,Fn.isSafeInteger=function(e){return Za(e)&&e>=-9007199254740991&&e<=h},Fn.isSet=os,Fn.isString=as,Fn.isSymbol=ss,Fn.isTypedArray=ls,Fn.isUndefined=function(e){return e===i},Fn.isWeakMap=function(e){return es(e)&&ho(e)==R},Fn.isWeakSet=function(e){return es(e)&&"[object WeakSet]"==Sr(e)},Fn.join=function(e,t){return null==e?"":Gt.call(e,t)},Fn.kebabCase=Hs,Fn.last=Yo,Fn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=fs(n))<0?gn(r+o,0):vn(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):Ft(e,Vt,o,!0)},Fn.lowerCase=Gs,Fn.lowerFirst=Ws,Fn.lt=cs,Fn.lte=us,Fn.max=function(e){return e&&e.length?fr(e,nl,Er):i},Fn.maxBy=function(e,t){return e&&e.length?fr(e,oo(t,2),Er):i},Fn.mean=function(e){return jt(e,nl)},Fn.meanBy=function(e,t){return jt(e,oo(t,2))},Fn.min=function(e){return e&&e.length?fr(e,nl,Or):i},Fn.minBy=function(e,t){return e&&e.length?fr(e,oo(t,2),Or):i},Fn.stubArray=pl,Fn.stubFalse=ml,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=wl,Fn.nth=function(e,t){return e&&e.length?Br(e,fs(t)):i},Fn.noConflict=function(){return ht._===this&&(ht._=Fe),this},Fn.noop=sl,Fn.now=Aa,Fn.pad=function(e,t,n){e=vs(e);var r=(t=fs(t))?un(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return Vi(ft(i),n)+e+Vi(dt(i),n)},Fn.padEnd=function(e,t,n){e=vs(e);var r=(t=fs(t))?un(e):0;return t&&r<t?e+Vi(t-r,n):e},Fn.padStart=function(e,t,n){e=vs(e);var r=(t=fs(t))?un(e):0;return t&&r<t?Vi(t-r,n)+e:e},Fn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),bn(vs(e).replace(re,""),t||0)},Fn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&vo(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ds(e),t===i?(t=e,e=0):t=ds(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=_n();return vn(e+o*(t-e+st("1e-"+((o+"").length-1))),t)}return Wr(e,t)},Fn.reduce=function(e,t,n){var r=Ha(e)?kt:Wt,i=arguments.length<3;return r(e,oo(t,4),n,i,ur)},Fn.reduceRight=function(e,t,n){var r=Ha(e)?Dt:Wt,i=arguments.length<3;return r(e,oo(t,4),n,i,hr)},Fn.repeat=function(e,t,n){return t=(n?vo(e,t,n):t===i)?1:fs(t),qr(vs(e),t)},Fn.replace=function(){var e=arguments,t=vs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Fn.result=function(e,t,n){var r=-1,o=(t=gi(t,e)).length;for(o||(o=1,e=i);++r<o;){var a=null==e?i:e[No(t[r])];a===i&&(r=o,a=n),e=Ka(a)?a.call(e):a}return e},Fn.round=xl,Fn.runInContext=e,Fn.sample=function(e){return(Ha(e)?Yn:$r)(e)},Fn.size=function(e){if(null==e)return 0;if(Wa(e))return as(e)?un(e):e.length;var t=ho(e);return t==x||t==T?e.size:Dr(e).length},Fn.snakeCase=qs,Fn.some=function(e,t,n){var r=Ha(e)?Ot:ti;return n&&vo(e,t,n)&&(t=i),r(e,oo(t,3))},Fn.sortedIndex=function(e,t){return ni(e,t)},Fn.sortedIndexBy=function(e,t,n){return ri(e,t,oo(n,2))},Fn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ni(e,t);if(r<n&&za(e[r],t))return r}return-1},Fn.sortedLastIndex=function(e,t){return ni(e,t,!0)},Fn.sortedLastIndexBy=function(e,t,n){return ri(e,t,oo(n,2),!0)},Fn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ni(e,t,!0)-1;if(za(e[n],t))return n}return-1},Fn.startCase=Xs,Fn.startsWith=function(e,t,n){return e=vs(e),n=null==n?0:or(fs(n),0,e.length),t=ai(t),e.slice(n,n+t.length)==t},Fn.subtract=Sl,Fn.sum=function(e){return e&&e.length?qt(e,nl):0},Fn.sumBy=function(e,t){return e&&e.length?qt(e,oo(t,2)):0},Fn.template=function(e,t,n){var r=Fn.templateSettings;n&&vo(e,t,n)&&(t=i),e=vs(e),t=_s({},t,r,Yi);var o,a,s=_s({},t.imports,r.imports,Yi),l=Rs(s),c=Kt(s,l),u=0,h=t.interpolate||be,d="__p += '",f=Ae((t.escape||be).source+"|"+h.source+"|"+(h===Z?he:be).source+"|"+(t.evaluate||be).source+"|$","g"),p="//# sourceURL="+(ke.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(f,(function(t,n,r,i,s,l){return r||(r=i),d+=e.slice(u,l).replace(_e,nn),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var m=ke.call(t,"variable")&&t.variable;if(m){if(ce.test(m))throw new we("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(a?d.replace(j,""):d).replace(H,"$1").replace(G,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Zs((function(){return xe(l,p+"return "+d).apply(i,c)}));if(g.source=d,Ya(g))throw g;return g},Fn.times=function(e,t){if((e=fs(e))<1||e>h)return[];var n=f,r=vn(e,f);t=oo(t),e-=f;for(var i=Xt(r,t);++n<e;)t(n);return i},Fn.toFinite=ds,Fn.toInteger=fs,Fn.toLength=ps,Fn.toLower=function(e){return vs(e).toLowerCase()},Fn.toNumber=ms,Fn.toSafeInteger=function(e){return e?or(fs(e),-9007199254740991,h):0===e?e:0},Fn.toString=vs,Fn.toUpper=function(e){return vs(e).toUpperCase()},Fn.trim=function(e,t,n){if((e=vs(e))&&(n||t===i))return $t(e);if(!e||!(t=ai(t)))return e;var r=hn(e),o=hn(t);return yi(r,Qt(r,o),Jt(r,o)+1).join("")},Fn.trimEnd=function(e,t,n){if((e=vs(e))&&(n||t===i))return e.slice(0,dn(e)+1);if(!e||!(t=ai(t)))return e;var r=hn(e);return yi(r,0,Jt(r,hn(t))+1).join("")},Fn.trimStart=function(e,t,n){if((e=vs(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=ai(t)))return e;var r=hn(e);return yi(r,Qt(r,hn(t))).join("")},Fn.truncate=function(e,t){var n=30,r="...";if(Ja(t)){var o="separator"in t?t.separator:o;n="length"in t?fs(t.length):n,r="omission"in t?ai(t.omission):r}var a=(e=vs(e)).length;if(rn(e)){var s=hn(e);a=s.length}if(n>=a)return e;var l=n-un(r);if(l<1)return r;var c=s?yi(s,0,l).join(""):e.slice(0,l);if(o===i)return c+r;if(s&&(l+=c.length-l),is(o)){if(e.slice(l).search(o)){var u,h=c;for(o.global||(o=Ae(o.source,vs(de.exec(o))+"g")),o.lastIndex=0;u=o.exec(h);)var d=u.index;c=c.slice(0,d===i?l:d)}}else if(e.indexOf(ai(o),l)!=l){var f=c.lastIndexOf(o);f>-1&&(c=c.slice(0,f))}return c+r},Fn.unescape=function(e){return(e=vs(e))&&X.test(e)?e.replace(W,fn):e},Fn.uniqueId=function(e){var t=++De;return vs(e)+t},Fn.upperCase=$s,Fn.upperFirst=Ys,Fn.each=va,Fn.eachRight=ya,Fn.first=Wo,al(Fn,(gl={},yr(Fn,(function(e,t){ke.call(Fn.prototype,t)||(gl[t]=e)})),gl),{chain:!1}),Fn.VERSION="4.17.21",At(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Fn[e].placeholder=Fn})),At(["drop","take"],(function(e,t){jn.prototype[e]=function(n){n=n===i?1:gn(fs(n),0);var r=this.__filtered__&&!t?new jn(this):this.clone();return r.__filtered__?r.__takeCount__=vn(n,r.__takeCount__):r.__views__.push({size:vn(n,f),type:e+(r.__dir__<0?"Right":"")}),r},jn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),At(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;jn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:oo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),At(["head","last"],(function(e,t){var n="take"+(t?"Right":"");jn.prototype[e]=function(){return this[n](1).value()[0]}})),At(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");jn.prototype[e]=function(){return this.__filtered__?new jn(this):this[n](1)}})),jn.prototype.compact=function(){return this.filter(nl)},jn.prototype.find=function(e){return this.filter(e).head()},jn.prototype.findLast=function(e){return this.reverse().find(e)},jn.prototype.invokeMap=Xr((function(e,t){return"function"==typeof e?new jn(this):this.map((function(n){return Cr(n,e,t)}))})),jn.prototype.reject=function(e){return this.filter(Da(oo(e)))},jn.prototype.slice=function(e,t){e=fs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new jn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=fs(t))<0?n.dropRight(-t):n.take(t-e)),n)},jn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},jn.prototype.toArray=function(){return this.take(f)},yr(jn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=Fn[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);o&&(Fn.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof jn,c=s[0],u=l||Ha(t),h=function(e){var t=o.apply(Fn,Lt([e],s));return r&&d?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,f=!!this.__actions__.length,p=a&&!d,m=l&&!f;if(!a&&u){t=m?t:new jn(this);var g=e.apply(t,s);return g.__actions__.push({func:da,args:[h],thisArg:i}),new Vn(g,d)}return p&&m?e.apply(this,s):(g=this.thru(h),p?r?g.value()[0]:g.value():g)})})),At(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ce[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);Fn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Ha(i)?i:[],e)}return this[n]((function(n){return t.apply(Ha(n)?n:[],e)}))}})),yr(jn.prototype,(function(e,t){var n=Fn[t];if(n){var r=n.name+"";ke.call(In,r)||(In[r]=[]),In[r].push({name:t,func:n})}})),In[Ui(i,2).name]=[{name:"wrapper",func:i}],jn.prototype.clone=function(){var e=new jn(this.__wrapped__);return e.__actions__=Mi(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Mi(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Mi(this.__views__),e},jn.prototype.reverse=function(){if(this.__filtered__){var e=new jn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},jn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Ha(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=vn(t,e+a);break;case"takeRight":e=gn(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,l=s-a,c=r?s:a-1,u=this.__iteratees__,h=u.length,d=0,f=vn(l,this.__takeCount__);if(!n||!r&&i==l&&f==l)return hi(e,this.__actions__);var p=[];e:for(;l--&&d<f;){for(var m=-1,g=e[c+=t];++m<h;){var v=u[m],y=v.iteratee,b=v.type,_=y(g);if(2==b)g=_;else if(!_){if(1==b)continue e;break e}}p[d++]=g}return p},Fn.prototype.at=fa,Fn.prototype.chain=function(){return ha(this)},Fn.prototype.commit=function(){return new Vn(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===i&&(this.__values__=hs(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Fn.prototype.plant=function(e){for(var t,n=this;n instanceof Bn;){var r=Fo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},Fn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof jn){var t=e;return this.__actions__.length&&(t=new jn(this)),(t=t.reverse()).__actions__.push({func:da,args:[Jo],thisArg:i}),new Vn(t,this.__chain__)}return this.thru(Jo)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return hi(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,Ye&&(Fn.prototype[Ye]=function(){return this}),Fn}();ht._=pn,(r=function(){return pn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},2694:(e,t,n)=>{"use strict";var r=n(6925);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},5556:(e,t,n)=>{e.exports=n(2694)()},6925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},754:(e,t,n)=>{"use strict";n.d(t,{aF:()=>me,Kq:()=>m,Ay:()=>ge});var r=n(4467),i=n(9379),o=n(5544),a=n(2284),s=n(6942),l=n.n(s),c=n(6588),u=n(8719),h=n(6540),d=n(3986),f=["children"],p=h.createContext({});function m(e){var t=e.children,n=(0,d.A)(e,f);return h.createElement(p.Provider,{value:n},t)}var g=n(3029),v=n(2901),y=n(5501),b=n(9426);const _=function(e){(0,y.A)(n,e);var t=(0,b.A)(n);function n(){return(0,g.A)(this,n),t.apply(this,arguments)}return(0,v.A)(n,[{key:"render",value:function(){return this.props.children}}]),n}(h.Component);var w=n(1470),x=n(1233),S=n(6956),E="none",A="appear",M="enter",T="leave",C="none",I="prepare",R="start",P="active",L="end",k="prepared",D=n(998);function O(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit".concat(e)]="webkit".concat(t),n["Moz".concat(e)]="moz".concat(t),n["ms".concat(e)]="MS".concat(t),n["O".concat(e)]="o".concat(t.toLowerCase()),n}var N,U,F,z=(N=(0,D.A)(),U="undefined"!=typeof window?window:{},F={animationend:O("Animation","AnimationEnd"),transitionend:O("Transition","TransitionEnd")},N&&("AnimationEvent"in U||delete F.animationend.animation,"TransitionEvent"in U||delete F.transitionend.transition),F),B={};if((0,D.A)()){var V=document.createElement("div");B=V.style}var j={};function H(e){if(j[e])return j[e];var t=z[e];if(t)for(var n=Object.keys(t),r=n.length,i=0;i<r;i+=1){var o=n[i];if(Object.prototype.hasOwnProperty.call(t,o)&&o in B)return j[e]=t[o],j[e]}return""}var G=H("animationend"),W=H("transitionend"),q=!(!G||!W),X=G||"animationend",$=W||"transitionend";function Y(e,t){return e?"object"===(0,a.A)(e)?e[t.replace(/-\w/g,(function(e){return e[1].toUpperCase()}))]:"".concat(e,"-").concat(t):null}const K=(0,D.A)()?h.useLayoutEffect:h.useEffect;var Z=n(5371),Q=[I,R,P,L],J=[I,k],ee=!1;function te(e){return e===P||e===L}function ne(e,t,n,a){var s,l,c,u,d=a.motionEnter,f=void 0===d||d,p=a.motionAppear,m=void 0===p||p,g=a.motionLeave,v=void 0===g||g,y=a.motionDeadline,b=a.motionLeaveImmediately,_=a.onAppearPrepare,D=a.onEnterPrepare,O=a.onLeavePrepare,N=a.onAppearStart,U=a.onEnterStart,F=a.onLeaveStart,z=a.onAppearActive,B=a.onEnterActive,V=a.onLeaveActive,j=a.onAppearEnd,H=a.onEnterEnd,G=a.onLeaveEnd,W=a.onVisibleChanged,q=(0,x.A)(),Y=(0,o.A)(q,2),ne=Y[0],re=Y[1],ie=(s=E,l=h.useReducer((function(e){return e+1}),0),c=(0,o.A)(l,2)[1],u=h.useRef(s),[(0,S.A)((function(){return u.current})),(0,S.A)((function(e){u.current="function"==typeof e?e(u.current):e,c()}))]),oe=(0,o.A)(ie,2),ae=oe[0],se=oe[1],le=(0,x.A)(null),ce=(0,o.A)(le,2),ue=ce[0],he=ce[1],de=ae(),fe=(0,h.useRef)(!1),pe=(0,h.useRef)(null);function me(){return n()}var ge=(0,h.useRef)(!1);function ve(){se(E),he(null,!0)}var ye=(0,w._q)((function(e){var t=ae();if(t!==E){var n=me();if(!e||e.deadline||e.target===n){var r,i=ge.current;t===A&&i?r=null==j?void 0:j(n,e):t===M&&i?r=null==H?void 0:H(n,e):t===T&&i&&(r=null==G?void 0:G(n,e)),i&&!1!==r&&ve()}}})),be=function(e){var t=(0,h.useRef)();function n(t){t&&(t.removeEventListener($,e),t.removeEventListener(X,e))}return h.useEffect((function(){return function(){n(t.current)}}),[]),[function(r){t.current&&t.current!==r&&n(t.current),r&&r!==t.current&&(r.addEventListener($,e),r.addEventListener(X,e),t.current=r)},n]}(ye),_e=(0,o.A)(be,1)[0],we=function(e){switch(e){case A:return(0,r.A)((0,r.A)((0,r.A)({},I,_),R,N),P,z);case M:return(0,r.A)((0,r.A)((0,r.A)({},I,D),R,U),P,B);case T:return(0,r.A)((0,r.A)((0,r.A)({},I,O),R,F),P,V);default:return{}}},xe=h.useMemo((function(){return we(de)}),[de]),Se=function(e,t,n){var r=(0,x.A)(C),i=(0,o.A)(r,2),a=i[0],s=i[1],l=function(){var e=h.useRef(null);function t(){Z.A.cancel(e.current)}return h.useEffect((function(){return function(){t()}}),[]),[function n(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;t();var o=(0,Z.A)((function(){i<=1?r({isCanceled:function(){return o!==e.current}}):n(r,i-1)}));e.current=o},t]}(),c=(0,o.A)(l,2),u=c[0],d=c[1],f=t?J:Q;return K((function(){if(a!==C&&a!==L){var e=f.indexOf(a),t=f[e+1],r=n(a);r===ee?s(t,!0):t&&u((function(e){function n(){e.isCanceled()||s(t,!0)}!0===r?n():Promise.resolve(r).then(n)}))}}),[e,a]),h.useEffect((function(){return function(){d()}}),[]),[function(){s(I,!0)},a]}(de,!e,(function(e){if(e===I){var t=xe[I];return t?t(me()):ee}var n;return Me in xe&&he((null===(n=xe[Me])||void 0===n?void 0:n.call(xe,me(),null))||null),Me===P&&de!==E&&(_e(me()),y>0&&(clearTimeout(pe.current),pe.current=setTimeout((function(){ye({deadline:!0})}),y))),Me===k&&ve(),!0})),Ee=(0,o.A)(Se,2),Ae=Ee[0],Me=Ee[1],Te=te(Me);ge.current=Te,K((function(){re(t);var n,r=fe.current;fe.current=!0,!r&&t&&m&&(n=A),r&&t&&f&&(n=M),(r&&!t&&v||!r&&b&&!t&&v)&&(n=T);var i=we(n);n&&(e||i[I])?(se(n),Ae()):se(E)}),[t]),(0,h.useEffect)((function(){(de===A&&!m||de===M&&!f||de===T&&!v)&&se(E)}),[m,f,v]),(0,h.useEffect)((function(){return function(){fe.current=!1,clearTimeout(pe.current)}}),[]);var Ce=h.useRef(!1);(0,h.useEffect)((function(){ne&&(Ce.current=!0),void 0!==ne&&de===E&&((Ce.current||ne)&&(null==W||W(ne)),Ce.current=!0)}),[ne,de]);var Ie=ue;return xe[I]&&Me===R&&(Ie=(0,i.A)({transition:"none"},Ie)),[de,Me,Ie,null!=ne?ne:t]}const re=function(e){var t=e;"object"===(0,a.A)(e)&&(t=e.transitionSupport);var n=h.forwardRef((function(e,n){var a=e.visible,s=void 0===a||a,d=e.removeOnLeave,f=void 0===d||d,m=e.forceRender,g=e.children,v=e.motionName,y=e.leavedClassName,b=e.eventProps,w=function(e,n){return!(!e.motionName||!t||!1===n)}(e,h.useContext(p).motion),x=(0,h.useRef)(),S=(0,h.useRef)(),A=ne(w,s,(function(){try{return x.current instanceof HTMLElement?x.current:(0,c.Ay)(S.current)}catch(e){return null}}),e),M=(0,o.A)(A,4),T=M[0],C=M[1],P=M[2],L=M[3],k=h.useRef(L);L&&(k.current=!0);var D,O=h.useCallback((function(e){x.current=e,(0,u.Xf)(n,e)}),[n]),N=(0,i.A)((0,i.A)({},b),{},{visible:s});if(g)if(T===E)D=L?g((0,i.A)({},N),O):!f&&k.current&&y?g((0,i.A)((0,i.A)({},N),{},{className:y}),O):m||!f&&!y?g((0,i.A)((0,i.A)({},N),{},{style:{display:"none"}}),O):null;else{var U;C===I?U="prepare":te(C)?U="active":C===R&&(U="start");var F=Y(v,"".concat(T,"-").concat(U));D=g((0,i.A)((0,i.A)({},N),{},{className:l()(Y(v,T),(0,r.A)((0,r.A)({},F,F&&U),v,"string"==typeof v)),style:P}),O)}else D=null;return h.isValidElement(D)&&(0,u.f3)(D)&&(D.ref||(D=h.cloneElement(D,{ref:O}))),h.createElement(_,{ref:S},D)}));return n.displayName="CSSMotion",n}(q);var ie=n(8168),oe=n(9417),ae="add",se="keep",le="remove",ce="removed";function ue(e){var t;return t=e&&"object"===(0,a.A)(e)&&"key"in e?e:{key:e},(0,i.A)((0,i.A)({},t),{},{key:String(t.key)})}function he(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(ue)}var de=["component","children","onVisibleChanged","onAllRemoved"],fe=["status"],pe=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];const me=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re,t=function(t){(0,y.A)(o,t);var n=(0,b.A)(o);function o(){var e;(0,g.A)(this,o);for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e=n.call.apply(n,[this].concat(a)),(0,r.A)((0,oe.A)(e),"state",{keyEntities:[]}),(0,r.A)((0,oe.A)(e),"removeKey",(function(t){e.setState((function(e){return{keyEntities:e.keyEntities.map((function(e){return e.key!==t?e:(0,i.A)((0,i.A)({},e),{},{status:ce})}))}}),(function(){0===e.state.keyEntities.filter((function(e){return e.status!==ce})).length&&e.props.onAllRemoved&&e.props.onAllRemoved()}))})),e}return(0,v.A)(o,[{key:"render",value:function(){var t=this,n=this.state.keyEntities,r=this.props,o=r.component,a=r.children,s=r.onVisibleChanged,l=(r.onAllRemoved,(0,d.A)(r,de)),c=o||h.Fragment,u={};return pe.forEach((function(e){u[e]=l[e],delete l[e]})),delete l.keys,h.createElement(c,l,n.map((function(n,r){var o=n.status,l=(0,d.A)(n,fe),c=o===ae||o===se;return h.createElement(e,(0,ie.A)({},u,{key:l.key,visible:c,eventProps:l,onVisibleChanged:function(e){null==s||s(e,{key:l.key}),e||t.removeKey(l.key)}}),(function(e,t){return a((0,i.A)((0,i.A)({},e),{},{index:r}),t)}))})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.keys,r=t.keyEntities,o=he(n),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=0,o=t.length,a=he(e),s=he(t);a.forEach((function(e){for(var t=!1,a=r;a<o;a+=1){var l=s[a];if(l.key===e.key){r<a&&(n=n.concat(s.slice(r,a).map((function(e){return(0,i.A)((0,i.A)({},e),{},{status:ae})}))),r=a),n.push((0,i.A)((0,i.A)({},l),{},{status:se})),r+=1,t=!0;break}}t||n.push((0,i.A)((0,i.A)({},e),{},{status:le}))})),r<o&&(n=n.concat(s.slice(r).map((function(e){return(0,i.A)((0,i.A)({},e),{},{status:ae})}))));var l={};return n.forEach((function(e){var t=e.key;l[t]=(l[t]||0)+1})),Object.keys(l).filter((function(e){return l[e]>1})).forEach((function(e){(n=n.filter((function(t){var n=t.key,r=t.status;return n!==e||r!==le}))).forEach((function(t){t.key===e&&(t.status=se)}))})),n}(r,o);return{keyEntities:a.filter((function(e){var t=r.find((function(t){var n=t.key;return e.key===n}));return!t||t.status!==ce||e.status!==le}))}}}]),o}(h.Component);return(0,r.A)(t,"defaultProps",{component:"div"}),t}(q),ge=re},6069:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"}},2546:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(6540),i=n(6351);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return r.Children.forEach(e,(function(e){(null!=e||t.keepEmpty)&&(Array.isArray(e)?n=n.concat(o(e)):(0,i.isFragment)(e)&&e.props?n=n.concat(o(e.props.children,t)):n.push(e))})),n}},998:(e,t,n)=>{"use strict";function r(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}n.d(t,{A:()=>r})},4808:(e,t,n)=>{"use strict";function r(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}n.d(t,{A:()=>r})},5089:(e,t,n)=>{"use strict";n.d(t,{BD:()=>g,m6:()=>m});var r=n(9379),i=n(998),o=n(4808),a="data-rc-order",s="data-rc-priority",l="rc-util-key",c=new Map;function u(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):l}function h(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function d(e){return Array.from((c.get(e)||e).children).filter((function(e){return"STYLE"===e.tagName}))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.A)())return null;var n=t.csp,r=t.prepend,o=t.priority,l=void 0===o?0:o,c=function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(r),u="prependQueue"===c,f=document.createElement("style");f.setAttribute(a,c),u&&l&&f.setAttribute(s,"".concat(l)),null!=n&&n.nonce&&(f.nonce=null==n?void 0:n.nonce),f.innerHTML=e;var p=h(t),m=p.firstChild;if(r){if(u){var g=(t.styles||d(p)).filter((function(e){if(!["prepend","prependQueue"].includes(e.getAttribute(a)))return!1;var t=Number(e.getAttribute(s)||0);return l>=t}));if(g.length)return p.insertBefore(f,g[g.length-1].nextSibling),f}p.insertBefore(f,m)}else p.appendChild(f);return f}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=h(t);return(t.styles||d(n)).find((function(n){return n.getAttribute(u(t))===e}))}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=p(e,t);n&&h(t).removeChild(n)}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=h(n),a=d(i),s=(0,r.A)((0,r.A)({},n),{},{styles:a});!function(e,t){var n=c.get(e);if(!n||!(0,o.A)(document,n)){var r=f("",t),i=r.parentNode;c.set(e,i),e.removeChild(r)}}(i,s);var l,m,g,v=p(t,s);if(v)return null!==(l=s.csp)&&void 0!==l&&l.nonce&&v.nonce!==(null===(m=s.csp)||void 0===m?void 0:m.nonce)&&(v.nonce=null===(g=s.csp)||void 0===g?void 0:g.nonce),v.innerHTML!==e&&(v.innerHTML=e),v;var y=f(e,s);return y.setAttribute(u(s),t),y}},6588:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>s,fk:()=>a});var r=n(2284),i=n(6540),o=n(961);function a(e){return e instanceof HTMLElement||e instanceof SVGElement}function s(e){var t,n=function(e){return e&&"object"===(0,r.A)(e)&&a(e.nativeElement)?e.nativeElement:a(e)?e:null}(e);return n||(e instanceof i.Component?null===(t=o.findDOMNode)||void 0===t?void 0:t.call(o,e):null)}},2467:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var t=e.getBBox(),n=t.width,r=t.height;if(n||r)return!0}if(e.getBoundingClientRect){var i=e.getBoundingClientRect(),o=i.width,a=i.height;if(o||a)return!0}}return!1}},2633:(e,t,n)=>{"use strict";function r(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}function i(e){return function(e){return r(e)instanceof ShadowRoot}(e)?r(e):null}n.d(t,{j:()=>i})},4832:(e,t,n)=>{"use strict";var r;n.d(t,{X:()=>g,v:()=>_});var i,o=n(675),a=n(467),s=n(2284),l=n(9379),c=n(961),u=(0,l.A)({},r||(r=n.t(c,2))),h=u.version,d=u.render,f=u.unmountComponentAtNode;try{Number((h||"").split(".")[0])>=18&&(i=u.createRoot)}catch(e){}function p(e){var t=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t&&"object"===(0,s.A)(t)&&(t.usingClientEntryPoint=e)}var m="__rc_react_root__";function g(e,t){i?function(e,t){p(!0);var n=t[m]||i(t);p(!1),n.render(e),t[m]=n}(e,t):function(e,t){d(e,t)}(e,t)}function v(e){return y.apply(this,arguments)}function y(){return(y=(0,a.A)((0,o.A)().mark((function e(t){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve().then((function(){var e;null===(e=t[m])||void 0===e||e.unmount(),delete t[m]})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){f(e)}function _(e){return w.apply(this,arguments)}function w(){return(w=(0,a.A)((0,o.A)().mark((function e(t){return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i){e.next=2;break}return e.abrupt("return",v(t));case 2:b(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},6956:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(6540);function i(e){var t=r.useRef();t.current=e;var n=r.useCallback((function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(r))}),[]);return n}},981:(e,t,n)=>{"use strict";n.d(t,{A:()=>s,o:()=>a});var r=n(6540),i=(0,n(998).A)()?r.useLayoutEffect:r.useEffect,o=function(e,t){var n=r.useRef(!0);i((function(){return e(n.current)}),t),i((function(){return n.current=!1,function(){n.current=!0}}),[])},a=function(e,t){o((function(t){if(!t)return e()}),t)};const s=o},8104:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(6540);function i(e,t,n){var i=r.useRef({});return"value"in i.current&&!n(i.current.condition,t)||(i.current.value=e(),i.current.condition=t),i.current.value}},2533:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var r=n(5544),i=n(6956),o=n(981),a=n(1233);function s(e){return void 0!==e}function l(e,t){var n=t||{},l=n.defaultValue,c=n.value,u=n.onChange,h=n.postState,d=(0,a.A)((function(){return s(c)?c:s(l)?"function"==typeof l?l():l:"function"==typeof e?e():e})),f=(0,r.A)(d,2),p=f[0],m=f[1],g=void 0!==c?c:p,v=h?h(g):g,y=(0,i.A)(u),b=(0,a.A)([g]),_=(0,r.A)(b,2),w=_[0],x=_[1];return(0,o.o)((function(){var e=w[0];p!==e&&y(p,e)}),[w]),(0,o.o)((function(){s(c)||m(c)}),[c]),[v,(0,i.A)((function(e,t){m(e,t),x([g],t)}))]}},1233:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(5544),i=n(6540);function o(e){var t=i.useRef(!1),n=i.useState(e),o=(0,r.A)(n,2),a=o[0],s=o[1];return i.useEffect((function(){return t.current=!1,function(){t.current=!0}}),[]),[a,function(e,n){n&&t.current||s(e)}]}},1470:(e,t,n)=>{"use strict";n.d(t,{_q:()=>r.A});var r=n(6956);n(2533),n(8719),n(488),n(8210)},3210:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(2284),i=n(8210);const o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new Set;return function e(t,a){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=o.has(t);if((0,i.Ay)(!l,"Warning: There may be circular references"),l)return!1;if(t===a)return!0;if(n&&s>1)return!1;o.add(t);var c=s+1;if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],a[u],c))return!1;return!0}if(t&&a&&"object"===(0,r.A)(t)&&"object"===(0,r.A)(a)){var h=Object.keys(t);return h.length===Object.keys(a).length&&h.every((function(n){return e(t[n],a[n],c)}))}return!1}(e,t)}},9853:(e,t,n)=>{"use strict";function r(e,t){var n=Object.assign({},e);return Array.isArray(t)&&t.forEach((function(e){delete n[e]})),n}n.d(t,{A:()=>r})},5371:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=function(e){return+setTimeout(e,16)},i=function(e){return clearTimeout(e)};"undefined"!=typeof window&&"requestAnimationFrame"in window&&(r=function(e){return window.requestAnimationFrame(e)},i=function(e){return window.cancelAnimationFrame(e)});var o=0,a=new Map;function s(e){a.delete(e)}var l=function(e){var t=o+=1;return function n(i){if(0===i)s(t),e();else{var o=r((function(){n(i-1)}));a.set(t,o)}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),t};l.cancel=function(e){var t=a.get(e);return s(e),i(t)};const c=l},8719:(e,t,n)=>{"use strict";n.d(t,{H3:()=>h,K4:()=>l,Xf:()=>s,f3:()=>u,xK:()=>c});var r=n(2284),i=n(6540),o=n(6351),a=n(8104),s=function(e,t){"function"==typeof e?e(t):"object"===(0,r.A)(e)&&e&&"current"in e&&(e.current=t)},l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter(Boolean);return r.length<=1?r[0]:function(e){t.forEach((function(t){s(t,e)}))}},c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.A)((function(){return l.apply(void 0,t)}),t,(function(e,t){return e.length!==t.length||e.every((function(e,n){return e!==t[n]}))}))},u=function(e){var t,n,r=(0,o.isMemo)(e)?e.type.type:e.type;return!!("function"!=typeof r||null!==(t=r.prototype)&&void 0!==t&&t.render||r.$$typeof===o.ForwardRef)&&!!("function"!=typeof e||null!==(n=e.prototype)&&void 0!==n&&n.render||e.$$typeof===o.ForwardRef)};var h=function(e){return function(e){return(0,i.isValidElement)(e)&&!(0,o.isFragment)(e)}(e)&&u(e)};Number(i.version.split(".")[0])},6300:(e,t,n)=>{"use strict";function r(e,t){for(var n=e,r=0;r<t.length;r+=1){if(null==n)return;n=n[t[r]]}return n}n.d(t,{A:()=>r})},488:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,h:()=>d});var r=n(2284),i=n(9379),o=n(436),a=n(7695),s=n(6300);function l(e,t,n,r){if(!t.length)return n;var s,c=(0,a.A)(t),u=c[0],h=c.slice(1);return s=e||"number"!=typeof u?Array.isArray(e)?(0,o.A)(e):(0,i.A)({},e):[],r&&void 0===n&&1===h.length?delete s[u][h[0]]:s[u]=l(s[u],h,n,r),s}function c(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.length&&r&&void 0===n&&!(0,s.A)(e,t.slice(0,-1))?e:l(e,t,n,r)}function u(e){return Array.isArray(e)?[]:{}}var h="undefined"==typeof Reflect?Object.keys:Reflect.ownKeys;function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=u(t[0]);return t.forEach((function(e){!function t(n,a){var l,d=new Set(a),f=(0,s.A)(e,n),p=Array.isArray(f);if(p||(l=f,"object"===(0,r.A)(l)&&null!==l&&Object.getPrototypeOf(l)===Object.prototype)){if(!d.has(f)){d.add(f);var m=(0,s.A)(i,n);p?i=c(i,n,[]):m&&"object"===(0,r.A)(m)||(i=c(i,n,u(f))),h(f).forEach((function(e){t([].concat((0,o.A)(n),[e]),d)}))}}else i=c(i,n,f)}([])})),i}},8210:(e,t,n)=>{"use strict";n.d(t,{$e:()=>o,Ay:()=>c});var r={},i=[];function o(e,t){}function a(e,t){}function s(e,t,n){t||r[n]||(e(!1,n),r[n]=!0)}function l(e,t){s(o,e,t)}l.preMessage=function(e){i.push(e)},l.resetWarned=function(){r={}},l.noteOnce=function(e,t){s(a,e,t)};const c=l},7787:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy");Symbol.for("react.offscreen");function m(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case a:case o:case h:case d:return e;default:switch(e=e&&e.$$typeof){case c:case l:case u:case p:case f:case s:return e;default:return t}}case r:return t}}}Symbol.for("react.module.reference"),t.ForwardRef=u,t.isFragment=function(e){return m(e)===i},t.isMemo=function(e){return m(e)===f}},6351:(e,t,n)=>{"use strict";e.exports=n(7787)},2551:(e,t,n)=>{"use strict";var r=n(6540),i=n(9982);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),T=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var k=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function O(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=D&&e[D]||e["@@iterator"])?e:null}var N,U=Object.assign;function F(e){if(void 0===N)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return B(e.type,!1);case 11:return B(e.type.render,!1);case 1:return B(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case S:return"Fragment";case x:return"Portal";case A:return"Profiler";case E:return"StrictMode";case I:return"Suspense";case R:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return j(e(t))}catch(e){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function $(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Z(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){Z(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function oe(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Se=null,Ee=null;function Ae(e){if(e=bi(e)){if("function"!=typeof xe)throw Error(o(280));var t=e.stateNode;t&&(t=wi(t),xe(e.stateNode,e.type,t))}}function Me(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function Te(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function Ce(e,t){return e(t)}function Ie(){}var Re=!1;function Pe(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ce(e,t,n)}finally{Re=!1,(null!==Se||null!==Ee)&&(Ie(),Te())}}function Le(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(o(231,t,typeof n));return n}var ke=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){ke=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){ke=!1}function Oe(e,t,n,r,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Ne=!1,Ue=null,Fe=!1,ze=null,Be={onError:function(e){Ne=!0,Ue=e}};function Ve(e,t,n,r,i,o,a,s,l){Ne=!1,Ue=null,Oe.apply(Be,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Ge(e){if(je(e)!==e)throw Error(o(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Ge(i),e;if(a===r)return Ge(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,$e=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Ze=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null,at=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2,ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=ht(s):0!=(o&=a)&&(r=ht(o))}else 0!=(a=n&~i)?r=ht(a):0!==o&&(r=ht(o));if(0===r)return 0;if(0!==t&&t!==r&&!(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&4194240&o))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function _t(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var wt,xt,St,Et,At,Mt=!1,Tt=[],Ct=null,It=null,Rt=null,Pt=new Map,Lt=new Map,kt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lt.delete(t.pointerId)}}function Nt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&null!==(t=bi(t))&&xt(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ut(e){var t=yi(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void At(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function zt(e,t,n){Ft(e)&&n.delete(t)}function Bt(){Mt=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==It&&Ft(It)&&(It=null),null!==Rt&&Ft(Rt)&&(Rt=null),Pt.forEach(zt),Lt.forEach(zt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Mt||(Mt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function jt(e){function t(t){return Vt(t,e)}if(0<Tt.length){Vt(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Vt(Ct,e),null!==It&&Vt(It,e),null!==Rt&&Vt(Rt,e),Pt.forEach(t),Lt.forEach(t),n=0;n<kt.length;n++)(r=kt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<kt.length&&null===(n=kt[0]).blockedOn;)Ut(n),null===n.blockedOn&&kt.shift()}var Ht=_.ReactCurrentBatchConfig,Gt=!0;function Wt(e,t,n,r){var i=bt,o=Ht.transition;Ht.transition=null;try{bt=1,Xt(e,t,n,r)}finally{bt=i,Ht.transition=o}}function qt(e,t,n,r){var i=bt,o=Ht.transition;Ht.transition=null;try{bt=4,Xt(e,t,n,r)}finally{bt=i,Ht.transition=o}}function Xt(e,t,n,r){if(Gt){var i=Yt(e,t,n,r);if(null===i)Gr(e,t,r,$t,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=Nt(Ct,e,t,n,r,i),!0;case"dragenter":return It=Nt(It,e,t,n,r,i),!0;case"mouseover":return Rt=Nt(Rt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Pt.set(o,Nt(Pt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Lt.set(o,Nt(Lt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&wt(o),null===(o=Yt(e,t,n,r))&&Gr(e,t,r,$t,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var $t=null;function Yt(e,t,n,r){if($t=null,null!==(e=yi(e=we(r))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $t=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Zt=null,Qt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Qt,r=n.length,i="value"in Zt?Zt.value:Zt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=on(cn),hn=U({},cn,{view:0,detail:0}),dn=on(hn),fn=U({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=on(fn),mn=on(U({},fn,{dataTransfer:0})),gn=on(U({},hn,{relatedTarget:0})),vn=on(U({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=U({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(yn),_n=on(U({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function An(){return En}var Mn=U({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=on(Mn),Cn=on(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=on(U({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Rn=on(U({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=on(Pn),kn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Nn=u&&"TextEvent"in window&&!On,Un=u&&(!Dn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),zn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==kn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1,Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,r){Me(r),0<(t=qr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Xn=null;function $n(e){Fr(e,0)}function Yn(e){if(X(_i(e)))return e}function Kn(e,t){if("change"===e)return t}var Zn=!1;if(u){var Qn;if(u){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"==typeof er.oninput}Qn=Jn}else Qn=!1;Zn=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Xn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Xn)){var t=[];Wn(t,Xn,e,we(e)),Pe($n,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Xn)}function or(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(sr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=ur(n,o);var a=ur(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==$(r)||(r="selectionStart"in(r=gr)&&fr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=qr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Er={};function Ar(e){if(Sr[e])return Sr[e];if(!xr[e])return e;var t,n=xr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Sr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var Mr=Ar("animationend"),Tr=Ar("animationiteration"),Cr=Ar("animationstart"),Ir=Ar("transitionend"),Rr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(e,t){Rr.set(e,t),l(t,[e])}for(var kr=0;kr<Pr.length;kr++){var Dr=Pr[kr];Lr(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Lr(Mr,"onAnimationEnd"),Lr(Tr,"onAnimationIteration"),Lr(Cr,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,l,c){if(Ve.apply(this,arguments),Ne){if(!Ne)throw Error(o(198));var u=Ue;Ne=!1,Ue=null,Fe||(Fe=!0,ze=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;Ur(i,s,c),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;Ur(i,s,c),o=l}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function jr(e){if(!e[Vr]){e[Vr]=!0,a.forEach((function(t){"selectionchange"!==t&&(Nr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Br("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Kt(t)){case 1:var i=Wt;break;case 4:i=qt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!ke||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,i){var o=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=yi(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue e}s=s.parentNode}}r=r.return}Pe((function(){var r=o,i=we(n),a=[];e:{var s=Rr.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Tn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Mr:case Tr:case Cr:l=vn;break;case Ir:l=Rn;break;case"scroll":l=dn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=!!(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&null!=(m=Le(p,d))&&u.push(Wr(p,m,f))),h)break;p=p.return}0<u.length&&(s=new l(s,c,null,n,i),a.push({event:s,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(h=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?s:_i(l),f=null==c?s:_i(c),(s=new u(m,p+"leave",l,n,i)).target=h,s.relatedTarget=f,m=null,yi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Xr(f))p++;for(f=0,m=d;m;m=Xr(m))f++;for(;0<p-f;)u=Xr(u),p--;for(;0<f-p;)d=Xr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Xr(u),d=Xr(d)}u=null}else u=null;null!==l&&$r(a,s,l,u,!1),null!==c&&null!==h&&$r(a,h,c,u,!0)}if("select"===(l=(s=r?_i(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Kn;else if(Gn(s))if(Zn)g=ar;else{g=ir;var v=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Wn(a,g,n,i):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?_i(r):window,e){case"focusin":(Gn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,_r(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":_r(a,n,i)}var y;if(Dn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else jn?Bn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(jn||"onCompositionStart"!==b?"onCompositionEnd"===b&&jn&&(y=en()):(Qt="value"in(Zt=i)?Zt.value:Zt.textContent,jn=!0)),0<(v=qr(r,b)).length&&(b=new _n(b,e,null,n,i),a.push({event:b,listeners:v}),(y||null!==(y=Vn(n)))&&(b.data=y))),(y=Nn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(zn=!0,Fn);case"textInput":return(e=t.data)===Fn&&zn?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!Dn&&Bn(e,t)?(e=en(),Jt=Qt=Zt=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(r=qr(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y)}Fr(a,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Le(e,n))&&r.unshift(Wr(e,o,i)),null!=(o=Le(e,t))&&r.push(Wr(e,o,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function $r(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Le(n,o))&&a.unshift(Wr(n,l,s)):i||null!=(l=Le(n,o))&&a.push(Wr(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Zr(e){return("string"==typeof e?e:""+e).replace(Yr,"\n").replace(Kr,"")}function Qr(e,t,n){if(t=Zr(t),Zr(e)!==t&&n)throw Error(o(425))}function Jr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"==typeof setTimeout?setTimeout:void 0,ii="function"==typeof clearTimeout?clearTimeout:void 0,oi="function"==typeof Promise?Promise:void 0,ai="function"==typeof queueMicrotask?queueMicrotask:void 0!==oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void jt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);jt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function yi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wi(e){return e[fi]||null}var xi=[],Si=-1;function Ei(e){return{current:e}}function Ai(e){0>Si||(e.current=xi[Si],xi[Si]=null,Si--)}function Mi(e,t){Si++,xi[Si]=e.current,e.current=t}var Ti={},Ci=Ei(Ti),Ii=Ei(!1),Ri=Ti;function Pi(e,t){var n=e.type.contextTypes;if(!n)return Ti;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Li(e){return null!=e.childContextTypes}function ki(){Ai(Ii),Ai(Ci)}function Di(e,t,n){if(Ci.current!==Ti)throw Error(o(168));Mi(Ci,t),Mi(Ii,n)}function Oi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,H(e)||"Unknown",i));return U({},n,r)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ti,Ri=Ci.current,Mi(Ci,e),Mi(Ii,Ii.current),!0}function Ui(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Oi(e,t,Ri),r.__reactInternalMemoizedMergedChildContext=e,Ai(Ii),Ai(Ci),Mi(Ci,e)):Ai(Ii),Mi(Ii,n)}var Fi=null,zi=!1,Bi=!1;function Vi(e){null===Fi?Fi=[e]:Fi.push(e)}function ji(){if(!Bi&&null!==Fi){Bi=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,zi=!1}catch(t){throw null!==Fi&&(Fi=Fi.slice(e+1)),Xe(Je,ji),t}finally{bt=t,Bi=!1}}return null}var Hi=[],Gi=0,Wi=null,qi=0,Xi=[],$i=0,Yi=null,Ki=1,Zi="";function Qi(e,t){Hi[Gi++]=qi,Hi[Gi++]=Wi,Wi=e,qi=t}function Ji(e,t,n){Xi[$i++]=Ki,Xi[$i++]=Zi,Xi[$i++]=Yi,Yi=e;var r=Ki;e=Zi;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ki=1<<32-at(t)+i|n<<i|r,Zi=o+e}else Ki=1<<o|n<<i|r,Zi=e}function eo(e){null!==e.return&&(Qi(e,1),Ji(e,1,0))}function to(e){for(;e===Wi;)Wi=Hi[--Gi],Hi[Gi]=null,qi=Hi[--Gi],Hi[Gi]=null;for(;e===Yi;)Yi=Xi[--$i],Xi[$i]=null,Zi=Xi[--$i],Xi[$i]=null,Ki=Xi[--$i],Xi[$i]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Pc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Ki,overflow:Zi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Pc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return!(!(1&e.mode)||128&e.flags)}function co(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ci(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw fo(),Error(o(418));for(;t;)ao(e,t),t=ci(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ci(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=ro;e;)e=ci(e.nextSibling)}function po(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=_.ReactCurrentBatchConfig;function vo(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!=typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function yo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function _o(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=kc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===L&&bo(o)===t.type)?((r=i(t,n.props)).ref=vo(e,t,n),r.return=e,r):((r=Dc(n.type,n.key,n.props,null,e.mode,r)).ref=vo(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,o){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Dc(t.type,t.key,t.props,null,e.mode,n)).ref=vo(e,null,t),n.return=e,n;case x:return(t=Fc(t,e.mode,n)).return=e,t;case L:return d(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;yo(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case x:return n.key===i?u(e,t,n,r):null;case L:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||O(n))return null!==i?null:h(e,t,n,r,null);yo(e,n)}return null}function p(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case L:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||O(r))return h(t,e=e.get(n)||null,r,i,null);yo(t,r)}return null}function m(i,o,s,l){for(var c=null,u=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,s[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),o=a(v,o,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===s.length)return n(i,h),io&&Qi(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(o=a(h,o,m),null===u?c=h:u.sibling=h,u=h);return io&&Qi(i,m),c}for(h=r(i,h);m<s.length;m++)null!==(g=p(h,i,m,s[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),io&&Qi(i,m),c}function g(i,s,l,c){var u=O(l);if("function"!=typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,m=s,g=s=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),s=a(b,s,g),null===h?u=b:h.sibling=b,h=b,m=v}if(y.done)return n(i,m),io&&Qi(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,c))&&(s=a(y,s,g),null===h?u=y:h.sibling=y,h=y);return io&&Qi(i,g),u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(i,e)})),io&&Qi(i,g),u}return function e(r,o,a,l){if("object"==typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"==typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(o=i(u,a.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===L&&bo(c)===u.type){n(r,u.sibling),(o=i(u,a.props)).ref=vo(r,u,a),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===S?((o=Oc(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Dc(a.type,a.key,a.props,null,r.mode,l)).ref=vo(r,o,a),l.return=r,r=l)}return s(r);case x:e:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Fc(a,r.mode,l)).return=r,r=o}return s(r);case L:return e(r,o,(u=a._init)(a._payload),l)}if(te(a))return m(r,o,a,l);if(O(a))return g(r,o,a,l);yo(r,a)}return"string"==typeof a&&""!==a||"number"==typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Uc(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var wo=_o(!0),xo=_o(!1),So=Ei(null),Eo=null,Ao=null,Mo=null;function To(){Mo=Ao=Eo=null}function Co(e){var t=So.current;Ai(So),e._currentValue=t}function Io(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ro(e,t){Eo=e,Mo=Ao=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Po(e){var t=e._currentValue;if(Mo!==e)if(e={context:e,memoizedValue:t,next:null},null===Ao){if(null===Eo)throw Error(o(308));Ao=e,Eo.dependencies={lanes:0,firstContext:e}}else Ao=Ao.next=e;return t}var Lo=null;function ko(e){null===Lo?Lo=[e]:Lo.push(e)}function Do(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,ko(t)):(n.next=i.next,i.next=n),t.interleaved=n,Oo(e,r)}function Oo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var No=!1;function Uo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Cl){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Oo(e,n)}return null===(i=r.interleaved)?(t.next=t,ko(r)):(t.next=i.next,i.next=t),r.interleaved=t,Oo(e,n)}function Vo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function jo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ho(e,t,n,r){var i=e.updateQueue;No=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=e.alternate;null!==u&&(s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l)}if(null!==o){var h=i.baseState;for(a=0,u=c=l=null,s=o;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(d=t,f=n,m.tag){case 1:if("function"==typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(d="function"==typeof(p=m.payload)?p.call(f,h,d):p))break e;h=U({},h,d);break e;case 2:No=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Nl|=a,e.lanes=a,e.memoizedState=h}}function Go(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(o(191,i));i.call(r)}}}var Wo={},qo=Ei(Wo),Xo=Ei(Wo),$o=Ei(Wo);function Yo(e){if(e===Wo)throw Error(o(174));return e}function Ko(e,t){switch(Mi($o,t),Mi(Xo,e),Mi(qo,Wo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ai(qo),Mi(qo,t)}function Zo(){Ai(qo),Ai(Xo),Ai($o)}function Qo(e){Yo($o.current);var t=Yo(qo.current),n=le(t,e.type);t!==n&&(Mi(Xo,e),Mi(qo,n))}function Jo(e){Xo.current===e&&(Ai(qo),Ai(Xo))}var ea=Ei(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ia=_.ReactCurrentDispatcher,oa=_.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,ua=!1,ha=!1,da=0,fa=0;function pa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Ja:es,e=n(r,i),ha){a=0;do{if(ha=!1,da=0,25<=a)throw Error(o(301));a+=1,ca=la=null,t.updateQueue=null,ia.current=ts,e=n(r,i)}while(ha)}if(ia.current=Qa,t=null!==la&&null!==la.next,aa=0,ca=la=sa=null,ua=!1,t)throw Error(o(300));return e}function va(){var e=0!==da;return da=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=e:ca=ca.next=e,ca}function ba(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?sa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(o(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=e:ca=ca.next=e}return ca}function _a(e,t){return"function"==typeof t?t(e):t}function wa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=la,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,c=null,u=a;do{var h=u.lane;if((aa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=r):c=c.next=d,sa.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==a);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Nl|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Sa(){}function Ea(e,t){var n=sa,r=ba(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,bs=!0),r=r.queue,Na(Ta.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(n.flags|=2048,Pa(9,Ma.bind(null,n,r,i,t),void 0,null),null===Il)throw Error(o(349));30&aa||Aa(n,t,i)}return i}function Aa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ma(e,t,n,r){t.value=n,t.getSnapshot=r,Ca(t)&&Ia(e)}function Ta(e,t,n){return n((function(){Ca(t)&&Ia(e)}))}function Ca(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(e){return!0}}function Ia(e){var t=Oo(e,1);null!==t&&nc(t,e,1,-1)}function Ra(e){var t=ya();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:e},t.queue=e,e=e.dispatch=$a.bind(null,sa,e),[t.memoizedState,e]}function Pa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function La(){return ba().memoizedState}function ka(e,t,n,r){var i=ya();sa.flags|=e,i.memoizedState=Pa(1|t,n,void 0,void 0===r?null:r)}function Da(e,t,n,r){var i=ba();r=void 0===r?null:r;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Pa(t,n,o,r))}sa.flags|=e,i.memoizedState=Pa(1|t,n,o,r)}function Oa(e,t){return ka(8390656,8,e,t)}function Na(e,t){return Da(2048,8,e,t)}function Ua(e,t){return Da(4,2,e,t)}function Fa(e,t){return Da(4,4,e,t)}function za(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!=n?n.concat([e]):null,Da(4,4,za.bind(null,t,e),n)}function Va(){}function ja(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ha(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ga(e,t,n){return 21&aa?(sr(n,t)||(n=mt(),sa.lanes|=n,Nl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n)}function Wa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=oa.transition;oa.transition={};try{e(!1),t()}finally{bt=n,oa.transition=r}}function qa(){return ba().memoizedState}function Xa(e,t,n){var r=tc(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e)?Ka(t,n):null!==(n=Do(e,t,n,r))&&(nc(n,e,r,ec()),Za(n,t,r))}function $a(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Ka(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=t.interleaved;return null===l?(i.next=i,ko(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(e){}null!==(n=Do(e,t,i,r))&&(nc(n,e,r,i=ec()),Za(n,t,r))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Ka(e,t){ha=ua=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Za(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Qa={readContext:Po,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Ja={readContext:Po,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:Po,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,ka(4194308,4,za.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ka(4194308,4,e,t)},useInsertionEffect:function(e,t){return ka(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xa.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ra,useDebugValue:Va,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ra(!1),t=e[0];return e=Wa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,i=ya();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Il)throw Error(o(349));30&aa||Aa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Oa(Ta.bind(null,r,a,e),[e]),r.flags|=2048,Pa(9,Ma.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Il.identifierPrefix;if(io){var n=Zi;t=":"+t+"R"+(n=(Ki&~(1<<32-at(Ki)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Po,useCallback:ja,useContext:Po,useEffect:Na,useImperativeHandle:Ba,useInsertionEffect:Ua,useLayoutEffect:Fa,useMemo:Ha,useReducer:wa,useRef:La,useState:function(){return wa(_a)},useDebugValue:Va,useDeferredValue:function(e){return Ga(ba(),la.memoizedState,e)},useTransition:function(){return[wa(_a)[0],ba().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ea,useId:qa,unstable_isNewReconciler:!1},ts={readContext:Po,useCallback:ja,useContext:Po,useEffect:Na,useImperativeHandle:Ba,useInsertionEffect:Ua,useLayoutEffect:Fa,useMemo:Ha,useReducer:xa,useRef:La,useState:function(){return xa(_a)},useDebugValue:Va,useDeferredValue:function(e){var t=ba();return null===la?t.memoizedState=e:Ga(t,la.memoizedState,e)},useTransition:function(){return[xa(_a)[0],ba().memoizedState]},useMutableSource:Sa,useSyncExternalStore:Ea,useId:qa,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),o=zo(r,i);o.payload=t,null!=n&&(o.callback=n),null!==(t=Bo(e,o,i))&&(nc(t,e,i,r),Vo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),o=zo(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=Bo(e,o,i))&&(nc(t,e,i,r),Vo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=zo(n,r);i.tag=2,null!=t&&(i.callback=t),null!==(t=Bo(e,i,r))&&(nc(t,e,r,n),Vo(t,e,r))}};function os(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!(t.prototype&&t.prototype.isPureReactComponent&&lr(n,r)&&lr(i,o))}function as(e,t,n){var r=!1,i=Ti,o=t.contextType;return"object"==typeof o&&null!==o?o=Po(o):(i=Li(t)?Ri:Ci.current,o=(r=null!=(r=t.contextTypes))?Pi(e,i):Ti),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Uo(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=Po(o):(o=Li(t)?Ri:Ci.current,i.context=Pi(e,o)),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(rs(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Ho(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ds="function"==typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=zo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gl||(Gl=!0,Wl=r),hs(0,t)},n}function ps(e,t,n){(n=zo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!=typeof r&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ac.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,i){return 1&e.mode?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zo(-1,1)).tag=2,Bo(n,t,1))),n.lanes|=1),e)}var ys=_.ReactCurrentOwner,bs=!1;function _s(e,t,n,r){t.child=null===e?xo(t,null,n,r):wo(t,e.child,n,r)}function ws(e,t,n,r,i){n=n.render;var o=t.ref;return Ro(t,i),r=ga(e,t,n,r,o,i),n=va(),null===e||bs?(io&&n&&eo(t),t.flags|=1,_s(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gs(e,t,i))}function xs(e,t,n,r,i){if(null===e){var o=n.type;return"function"!=typeof o||Lc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Dc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ss(e,t,o,r,i))}if(o=e.child,!(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Gs(e,t,i)}return t.flags|=1,(e=kc(o,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=o,!(e.lanes&i))return t.lanes=e.lanes,Gs(e,t,i);131072&e.flags&&(bs=!0)}}return Ms(e,t,n,r,i)}function Es(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mi(kl,Ll),Ll|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Mi(kl,Ll),Ll|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi(kl,Ll),Ll|=n;else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Mi(kl,Ll),Ll|=r;return _s(e,t,i,n),t.child}function As(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ms(e,t,n,r,i){var o=Li(n)?Ri:Ci.current;return o=Pi(t,o),Ro(t,i),n=ga(e,t,n,r,o,i),r=va(),null===e||bs?(io&&r&&eo(t),t.flags|=1,_s(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gs(e,t,i))}function Ts(e,t,n,r,i){if(Li(n)){var o=!0;Ni(t)}else o=!1;if(Ro(t,i),null===t.stateNode)Hs(e,t),as(t,n,r),ls(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;c="object"==typeof c&&null!==c?Po(c):Pi(t,c=Li(n)?Ri:Ci.current);var u=n.getDerivedStateFromProps,h="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;h||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,a,r,c),No=!1;var d=t.memoizedState;a.state=d,Ho(t,r,a,i),l=t.memoizedState,s!==r||d!==l||Ii.current||No?("function"==typeof u&&(rs(t,n,u,r),l=t.memoizedState),(s=No||os(t,n,s,r,d,l,c))?(h||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4194308)):("function"==typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Fo(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),a.props=c,h=t.pendingProps,d=a.context,l="object"==typeof(l=n.contextType)&&null!==l?Po(l):Pi(t,l=Li(n)?Ri:Ci.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,a,r,l),No=!1,d=t.memoizedState,a.state=d,Ho(t,r,a,i);var p=t.memoizedState;s!==h||d!==p||Ii.current||No?("function"==typeof f&&(rs(t,n,f,r),p=t.memoizedState),(c=No||os(t,n,c,r,d,p,l)||!1)?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Cs(e,t,n,r,o,i)}function Cs(e,t,n,r,i,o){As(e,t);var a=!!(128&t.flags);if(!r&&!a)return i&&Ui(t,n,!1),Gs(e,t,o);r=t.stateNode,ys.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,s,o)):_s(e,t,s,o),t.memoizedState=r.state,i&&Ui(t,n,!0),t.child}function Is(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),Ko(e,t.containerInfo)}function Rs(e,t,n,r,i){return po(),mo(i),t.flags|=256,_s(e,t,n,r),t.child}var Ps,Ls,ks,Ds,Os={dehydrated:null,treeContext:null,retryLane:0};function Ns(e){return{baseLanes:e,cachePool:null,transitions:null}}function Us(e,t,n){var r,i=t.pendingProps,a=ea.current,s=!1,l=!!(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&!!(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Mi(ea,1&a),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},1&i||null===s?s=Nc(l,i,0,null):(s.childLanes=0,s.pendingProps=l),e=Oc(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ns(n),t.memoizedState=Os,e):Fs(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,zs(e,t,s,r=us(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Nc({mode:"visible",children:r.children},i,0,null),(a=Oc(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,1&t.mode&&wo(t,e.child,null,s),t.child.memoizedState=Ns(s),t.memoizedState=Os,a);if(!(1&t.mode))return zs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,zs(e,t,s,r=us(a=Error(o(419)),r,void 0))}if(l=!!(s&e.childLanes),bs||l){if(null!==(r=Il)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=i&(r.suspendedLanes|s)?0:i)&&i!==a.retryLane&&(a.retryLane=i,Oo(e,i),nc(r,e,i,-1))}return mc(),zs(e,t,s,r=us(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=ci(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Xi[$i++]=Ki,Xi[$i++]=Zi,Xi[$i++]=Yi,Ki=e.id,Zi=e.overflow,Yi=t),(t=Fs(t,r.children)).flags|=4096,t)}(e,t,l,i,r,a,n);if(s){s=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 1&l||t.child===a?(i=kc(a,c)).subtreeFlags=14680064&a.subtreeFlags:((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null),null!==r?s=kc(r,s):(s=Oc(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ns(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Os,i}return e=(s=e.child).sibling,i=kc(s,{mode:"visible",children:i.children}),!(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Fs(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zs(e,t,n,r){return null!==r&&mo(r),wo(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Io(e.return,t,n)}function Vs(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function js(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(_s(e,t,r.children,n),2&(r=ea.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Mi(ea,r),1&t.mode)switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vs(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vs(t,!0,n,null,o);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Hs(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=kc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=kc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ws(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Li(t.type)&&ki(),qs(t),null;case 3:return r=t.stateNode,Zo(),Ai(Ii),Ai(Ci),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==oo&&(ac(oo),oo=null))),Ls(e,t),qs(t),null;case 5:Jo(t);var i=Yo($o.current);if(n=t.type,null!==e&&null!=t.stateNode)ks(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return qs(t),null}if(e=Yo(qo.current),ho(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[di]=t,r[fi]=a,e=!!(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(i=0;i<Or.length;i++)zr(Or[i],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":K(r,a),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},zr("invalid",r);break;case"textarea":ie(r,a),zr("invalid",r)}for(var l in ye(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,e),i=["children",c]):"number"==typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Qr(r.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zr("scroll",r)}switch(n){case"input":q(r),J(r,a,!0);break;case"textarea":q(r),ae(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=Jr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Ps(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":zr("cancel",e),zr("close",e),i=r;break;case"iframe":case"object":case"embed":zr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Or.length;i++)zr(Or[i],e);i=r;break;case"source":zr("error",e),i=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),i=r;break;case"details":zr("toggle",e),i=r;break;case"input":K(e,r),i=Y(e,r),zr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=U({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),zr("invalid",e)}for(a in ye(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===a?"string"==typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"==typeof u&&de(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&zr("scroll",e):null!=u&&b(e,a,u,l))}switch(n){case"input":q(e),J(e,r,!1);break;case"textarea":q(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof i.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ds(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(o(166));if(n=Yo($o.current),Yo(qo.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:Qr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,!!(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return qs(t),null;case 13:if(Ai(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&1&t.mode&&!(128&t.flags))fo(),po(),t.flags|=98560,a=!1;else if(a=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=t}else po(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),a=!1}else null!==oo&&(ac(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!=(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ea.current?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return Zo(),Ls(e,t),null===e&&jr(t.stateNode.containerInfo),qs(t),null;case 10:return Co(t.type._context),qs(t),null;case 19:if(Ai(ea),null===(a=t.memoizedState))return qs(t),null;if(r=!!(128&t.flags),null===(l=a.rendering))if(r)Ws(a,!1);else{if(0!==Dl||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Ws(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mi(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Ze()>jl&&(t.flags|=128,r=!0,Ws(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ws(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return qs(t),null}else 2*Ze()-a.renderingStartTime>jl&&1073741824!==n&&(t.flags|=128,r=!0,Ws(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ze(),t.sibling=null,n=ea.current,Mi(ea,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Ll)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function $s(e,t){switch(to(t),t.tag){case 1:return Li(t.type)&&ki(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Zo(),Ai(Ii),Ai(Ci),ra(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Jo(t),null;case 13:if(Ai(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ai(ea),null;case 4:return Zo(),null;case 10:return Co(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ps=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ls=function(){},ks=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yo(qo.current);var o,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=U({},i,{value:void 0}),r=U({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Jr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zr("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ds=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ys=!1,Ks=!1,Zs="function"==typeof WeakSet?WeakSet:Set,Qs=null;function Js(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Ec(e,t,n)}else n.current=null}function el(e,t,n){try{n()}catch(n){Ec(e,t,n)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(t,n,o)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[vi]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(ot&&"function"==typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(e){}switch(n.tag){case 5:Ks||Js(n,t);case 6:var r=ul,i=hl;ul=null,dl(e,t,n),hl=i,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),jt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Ks&&null!==(r=n.updateQueue)&&null!==(r=r.lastEffect)){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(2&o||4&o)&&el(n,t,a),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Ks&&(Js(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Ec(n,t,e)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ks=(r=Ks)||null!==n.memoizedState,dl(e,t,n),Ks=r):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zs),t.forEach((function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));fl(a,s,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(e){Ec(i,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(t){Ec(e,e.return,t)}try{nl(5,e,e.return)}catch(t){Ec(e,e.return,t)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&Js(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&Js(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(t){Ec(e,e.return,t)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&Z(i,a),be(l,s);var u=be(l,a);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,u)}switch(l){case"input":Q(i,a);break;case"textarea":oe(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(t){Ec(e,e.return,t)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(t){Ec(e,e.return,t)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(t){Ec(e,e.return,t)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=Ze())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ks=(u=Ks)||h,ml(t,e),Ks=u):ml(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&1&e.mode)for(Qs=e,h=e.child;null!==h;){for(d=Qs=h;null!==Qs;){switch(p=(f=Qs).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Js(f,f.return);var m=f.stateNode;if("function"==typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(e){Ec(r,n,e)}}break;case 5:Js(f,f.return);break;case 22:if(null!==f.memoizedState){wl(d);continue}}null!==p?(p.return=f,Qs=p):wl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"==typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=null!=(c=d.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(t){Ec(e,e.return,t)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(t){Ec(e,e.return,t)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),vl(e),4&r&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),cl(e,sl(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,sl(e),a);break;default:throw Error(o(161))}}catch(t){Ec(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Qs=e,bl(e,t,n)}function bl(e,t,n){for(var r=!!(1&e.mode);null!==Qs;){var i=Qs,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Ys;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Ks;s=Ys;var c=Ks;if(Ys=a,(Ks=l)&&!c)for(Qs=i;null!==Qs;)l=(a=Qs).child,22===a.tag&&null!==a.memoizedState?xl(i):null!==l?(l.return=a,Qs=l):xl(i);for(;null!==o;)Qs=o,bl(o,t,n),o=o.sibling;Qs=i,Ys=s,Ks=c}_l(e)}else 8772&i.subtreeFlags&&null!==o?(o.return=i,Qs=o):_l(e)}}function _l(e){for(;null!==Qs;){var t=Qs;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Ks||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ks)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Go(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Go(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&jt(d)}}}break;default:throw Error(o(163))}Ks||512&t.flags&&il(t)}catch(e){Ec(t,t.return,e)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function wl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function xl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(e){Ec(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(e){Ec(t,i,e)}}var o=t.return;try{il(t)}catch(e){Ec(t,o,e)}break;case 5:var a=t.return;try{il(t)}catch(e){Ec(t,a,e)}}}catch(e){Ec(t,t.return,e)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var Sl,El=Math.ceil,Al=_.ReactCurrentDispatcher,Ml=_.ReactCurrentOwner,Tl=_.ReactCurrentBatchConfig,Cl=0,Il=null,Rl=null,Pl=0,Ll=0,kl=Ei(0),Dl=0,Ol=null,Nl=0,Ul=0,Fl=0,zl=null,Bl=null,Vl=0,jl=1/0,Hl=null,Gl=!1,Wl=null,ql=null,Xl=!1,$l=null,Yl=0,Kl=0,Zl=null,Ql=-1,Jl=0;function ec(){return 6&Cl?Ze():-1!==Ql?Ql:Ql=Ze()}function tc(e){return 1&e.mode?2&Cl&&0!==Pl?Pl&-Pl:null!==go.transition?(0===Jl&&(Jl=mt()),Jl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type):1}function nc(e,t,n,r){if(50<Kl)throw Kl=0,Zl=null,Error(o(185));vt(e,n,r),2&Cl&&e===Il||(e===Il&&(!(2&Cl)&&(Ul|=n),4===Dl&&sc(e,Pl)),rc(e,r),1===n&&0===Cl&&!(1&t.mode)&&(jl=Ze()+500,zi&&ji()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?s&n&&!(s&r)||(i[a]=ft(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=dt(e,e===Il?Pl:0);if(0===r)null!==n&&$e(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&$e(n),1===t)0===e.tag?function(e){zi=!0,Vi(e)}(lc.bind(null,e)):Vi(lc.bind(null,e)),ai((function(){!(6&Cl)&&ji()})),n=null;else{switch(_t(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ic(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Ql=-1,Jl=0,6&Cl)throw Error(o(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=dt(e,e===Il?Pl:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=gc(e,r);else{t=r;var i=Cl;Cl|=2;var a=pc();for(Il===e&&Pl===t||(Hl=null,jl=Ze()+500,dc(e,t));;)try{yc();break}catch(t){fc(e,t)}To(),Al.current=a,Cl=i,null!==Rl?t=0:(Il=null,Pl=0,t=Dl)}if(0!==t){if(2===t&&0!==(i=pt(e))&&(r=i,t=oc(e,i)),1===t)throw n=Ol,dc(e,0),sc(e,r),rc(e,Ze()),n;if(6===t)sc(e,r);else{if(i=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)||(t=gc(e,r),2===t&&(a=pt(e),0!==a&&(r=a,t=oc(e,a))),1!==t)))throw n=Ol,dc(e,0),sc(e,r),rc(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:wc(e,Bl,Hl);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Vl+500-Ze())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(wc.bind(null,e,Bl,Hl),t);break}wc(e,Bl,Hl);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Ze()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ri(wc.bind(null,e,Bl,Hl),r);break}wc(e,Bl,Hl);break;default:throw Error(o(329))}}}return rc(e,Ze()),e.callbackNode===n?ic.bind(null,e):null}function oc(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bl,Bl=n,null!==t&&ac(t)),e}function ac(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function sc(e,t){for(t&=~Fl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(6&Cl)throw Error(o(327));xc();var t=dt(e,0);if(!(1&t))return rc(e,Ze()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ol,dc(e,0),sc(e,t),rc(e,Ze()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Bl,Hl),rc(e,Ze()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(jl=Ze()+500,zi&&ji())}}function uc(e){null!==$l&&0===$l.tag&&!(6&Cl)&&xc();var t=Cl;Cl|=1;var n=Tl.transition,r=bt;try{if(Tl.transition=null,bt=1,e)return e()}finally{bt=r,Tl.transition=n,!(6&(Cl=t))&&ji()}}function hc(){Ll=kl.current,Ai(kl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&ki();break;case 3:Zo(),Ai(Ii),Ai(Ci),ra();break;case 5:Jo(r);break;case 4:Zo();break;case 13:case 19:Ai(ea);break;case 10:Co(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Il=e,Rl=e=kc(e.current,null),Pl=Ll=t,Dl=0,Ol=null,Fl=Ul=Nl=0,Bl=zl=null,null!==Lo){for(t=0;t<Lo.length;t++)if(null!==(r=(n=Lo[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Lo=null}return e}function fc(e,t){for(;;){var n=Rl;try{if(To(),ia.current=Qa,ua){for(var r=sa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ua=!1}if(aa=0,ca=la=sa=null,ha=!1,da=0,Ml.current=null,null===n||null===n.return){Dl=1,Ol=t,Rl=null;break}e:{var a=e,s=n.return,l=n,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,h=l,d=h.tag;if(!(1&h.mode||0!==d&&11!==d&&15!==d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,vs(p,s,l,0,t),1&p.mode&&ms(a,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(!(1&t)){ms(a,u,t),mc();break e}c=Error(o(426))}else if(io&&1&l.mode){var v=gs(s);if(null!==v){!(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,t),mo(cs(c,l));break e}}a=c=cs(c,l),4!==Dl&&(Dl=2),null===zl?zl=[a]:zl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,jo(a,fs(0,c,t));break e;case 1:l=c;var y=a.type,b=a.stateNode;if(!(128&a.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==ql&&ql.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,jo(a,ps(a,l,t));break e}}a=a.return}while(null!==a)}_c(n)}catch(e){t=e,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function pc(){var e=Al.current;return Al.current=Qa,null===e?Qa:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===Il||!(268435455&Nl)&&!(268435455&Ul)||sc(Il,Pl)}function gc(e,t){var n=Cl;Cl|=2;var r=pc();for(Il===e&&Pl===t||(Hl=null,dc(e,t));;)try{vc();break}catch(t){fc(e,t)}if(To(),Cl=n,Al.current=r,null!==Rl)throw Error(o(261));return Il=null,Pl=0,Dl}function vc(){for(;null!==Rl;)bc(Rl)}function yc(){for(;null!==Rl&&!Ye();)bc(Rl)}function bc(e){var t=Sl(e.alternate,e,Ll);e.memoizedProps=e.pendingProps,null===t?_c(e):Rl=t,Ml.current=null}function _c(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=$s(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Dl=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Xs(n,t,Ll)))return void(Rl=n);if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Dl&&(Dl=5)}function wc(e,t,n){var r=bt,i=Tl.transition;try{Tl.transition=null,bt=1,function(e,t,n,r){do{xc()}while(null!==$l);if(6&Cl)throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Il&&(Rl=Il=null,Pl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Xl||(Xl=!0,Ic(tt,(function(){return xc(),null}))),a=!!(15990&n.flags),15990&n.subtreeFlags||a){a=Tl.transition,Tl.transition=null;var s=bt;bt=1;var l=Cl;Cl|=4,Ml.current=null,function(e,t){if(ei=Gt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(e){n=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==r&&3!==d.nodeType||(c=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=s),f===a&&++h===r&&(c=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Gt=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,1028&t.subtreeFlags&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(o(163))}}catch(e){Ec(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),Gt=!!ei,ti=ei=null,e.current=n,yl(n,e,i),Ke(),Cl=l,bt=s,Tl.transition=a}else e.current=n;if(Xl&&(Xl=!1,$l=e,Yl=i),0===(a=e.pendingLanes)&&(ql=null),function(e){if(ot&&"function"==typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),rc(e,Ze()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((i=t[n]).value,{componentStack:i.stack,digest:i.digest});if(Gl)throw Gl=!1,e=Wl,Wl=null,e;!!(1&Yl)&&0!==e.tag&&xc(),1&(a=e.pendingLanes)?e===Zl?Kl++:(Kl=0,Zl=e):Kl=0,ji()}(e,t,n,r)}finally{Tl.transition=i,bt=r}return null}function xc(){if(null!==$l){var e=_t(Yl),t=Tl.transition,n=bt;try{if(Tl.transition=null,bt=16>e?16:e,null===$l)var r=!1;else{if(e=$l,$l=null,Yl=0,6&Cl)throw Error(o(331));var i=Cl;for(Cl|=4,Qs=e.current;null!==Qs;){var a=Qs,s=a.child;if(16&Qs.flags){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var h=Qs;switch(h.tag){case 0:case 11:case 15:nl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Qs=d;else for(;null!==Qs;){var f=(h=Qs).sibling,p=h.return;if(ol(h),h===u){Qs=null;break}if(null!==f){f.return=p,Qs=f;break}Qs=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Qs=a}}if(2064&a.subtreeFlags&&null!==s)s.return=a,Qs=s;else e:for(;null!==Qs;){if(2048&(a=Qs).flags)switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,Qs=y;break e}Qs=a.return}}var b=e.current;for(Qs=b;null!==Qs;){var _=(s=Qs).child;if(2064&s.subtreeFlags&&null!==_)_.return=s,Qs=_;else e:for(s=b;null!==Qs;){if(2048&(l=Qs).flags)try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(e){Ec(l,l.return,e)}if(l===s){Qs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qs=w;break e}Qs=l.return}}if(Cl=i,ji(),ot&&"function"==typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(e){}r=!0}return r}finally{bt=n,Tl.transition=t}}return!1}function Sc(e,t,n){e=Bo(e,t=fs(0,t=cs(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function Ec(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ql||!ql.has(r))){t=Bo(t,e=ps(t,e=cs(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Ac(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Il===e&&(Pl&n)===n&&(4===Dl||3===Dl&&(130023424&Pl)===Pl&&500>Ze()-Vl?dc(e,0):Fl|=n),rc(e,t)}function Mc(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=ec();null!==(e=Oo(e,t))&&(vt(e,t,n),rc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Mc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Mc(e,n)}function Ic(e,t){return Xe(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,n,r){return new Rc(e,t,n,r)}function Lc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function kc(e,t){var n=e.alternate;return null===n?((n=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Dc(e,t,n,r,i,a){var s=2;if(r=e,"function"==typeof e)Lc(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case S:return Oc(n.children,i,a,t);case E:s=8,i|=8;break;case A:return(e=Pc(12,n,t,2|i)).elementType=A,e.lanes=a,e;case I:return(e=Pc(13,n,t,i)).elementType=I,e.lanes=a,e;case R:return(e=Pc(19,n,t,i)).elementType=R,e.lanes=a,e;case k:return Nc(n,i,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case M:s=10;break e;case T:s=9;break e;case C:s=11;break e;case P:s=14;break e;case L:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Pc(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Oc(e,t,n,r){return(e=Pc(7,e,r,t)).lanes=n,e}function Nc(e,t,n,r){return(e=Pc(22,e,r,t)).elementType=k,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Pc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,i,o,a,s,l){return e=new zc(e,t,n,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Pc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uo(o),e}function Vc(e){if(!e)return Ti;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Li(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Li(n))return Oi(e,n,t)}return t}function jc(e,t,n,r,i,o,a,s,l){return(e=Bc(n,r,!0,e,0,o,0,s,l)).context=Vc(null),n=e.current,(o=zo(r=ec(),i=tc(n))).callback=null!=t?t:null,Bo(n,o,i),e.current.lanes=i,vt(e,i,r),rc(e,r),e}function Hc(e,t,n,r){var i=t.current,o=ec(),a=tc(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=zo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bo(i,t,a))&&(nc(e,i,a,o),Vo(e,i,a)),a}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ii.current)bs=!0;else{if(!(e.lanes&n||128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Is(t),po();break;case 5:Qo(t);break;case 1:Li(t.type)&&Ni(t);break;case 4:Ko(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Mi(So,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Mi(ea,1&ea.current),t.flags|=128,null):n&t.child.childLanes?Us(e,t,n):(Mi(ea,1&ea.current),null!==(e=Gs(e,t,n))?e.sibling:null);Mi(ea,1&ea.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return js(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Mi(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return Gs(e,t,n)}(e,t,n);bs=!!(131072&e.flags)}else bs=!1,io&&1048576&t.flags&&Ji(t,qi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Hs(e,t),e=t.pendingProps;var i=Pi(t,Ci.current);Ro(t,n),i=ga(null,t,r,e,i,n);var a=va();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Li(r)?(a=!0,Ni(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Uo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,r,e,n),t=Cs(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),_s(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Hs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"==typeof e)return Lc(e)?1:0;if(null!=e){if((e=e.$$typeof)===C)return 11;if(e===P)return 14}return 2}(r),e=ns(r,e),i){case 0:t=Ms(null,t,r,e,n);break e;case 1:t=Ts(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=xs(null,t,r,ns(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ms(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ts(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(Is(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Fo(e,t),Ho(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Rs(e,t,r,n,i=cs(Error(o(423)),t));break e}if(r!==i){t=Rs(e,t,r,n,i=cs(Error(o(424)),t));break e}for(ro=ci(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=xo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),r===i){t=Gs(e,t,n);break e}_s(e,t,r,n)}t=t.child}return t;case 5:return Qo(t),null===e&&co(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),As(e,t),_s(e,t,s,n),t.child;case 6:return null===e&&co(t),null;case 13:return Us(e,t,n);case 4:return Ko(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wo(t,null,r,n):_s(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ws(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return _s(e,t,t.pendingProps,n),t.child;case 8:case 12:return _s(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Mi(So,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!Ii.current){t=Gs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=zo(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Io(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Io(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}_s(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ro(t,n),r=r(i=Po(i)),t.flags|=1,_s(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),xs(e,t,r,i=ns(r.type,i),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),Hs(e,t),t.tag=1,Li(r)?(e=!0,Ni(t)):e=!1,Ro(t,n),as(t,r,i),ls(t,r,i,n),Cs(null,t,r,!0,e,n);case 19:return js(e,t,n);case 22:return Es(e,t,n)}throw Error(o(156,t.tag))};var Xc="function"==typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Jc(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"==typeof i){var s=i;i=function(){var e=Gc(a);s.call(e)}}Hc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"==typeof r){var o=r;r=function(){var e=Gc(a);o.call(e)}}var a=jc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[pi]=a.current,jr(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof r){var s=r;r=function(){var e=Gc(l);s.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[pi]=l.current,jr(8===e.nodeType?e.parentNode:e),uc((function(){Hc(t,l,n,r)})),l}(n,t,e,i,r);return Gc(a)}Yc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Hc(e,t,null,null)},Yc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Hc(null,e,null,null)})),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<kt.length&&0!==t&&t<kt[n].priority;n++);kt.splice(n,0,e),0===n&&Ut(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ze()),!(6&Cl)&&(jl=Ze()+500,ji()))}break;case 13:uc((function(){var t=Oo(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),qc(e,1)}},xt=function(e){if(13===e.tag){var t=Oo(e,134217728);null!==t&&nc(t,e,134217728,ec()),qc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Oo(e,t);null!==n&&nc(n,e,t,ec()),qc(e,t)}},Et=function(){return bt},At=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},xe=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(o(90));X(r),Q(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Ie=uc;var eu={usingClientEntryPoint:!1,Events:[bi,_i,wi,Me,Te,cc]},tu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),ot=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Kc(e))throw Error(o(299));var n=!1,r="",i=Xc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,jr(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(o(200));return Jc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Xc;if(null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jc(t,null,e,1,null!=n?n:null,i,0,a,s),e[pi]=t.current,jr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(o(200));return Jc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){Jc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Jc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},5338:(e,t,n)=>{"use strict";var r=n(961);t.H=r.createRoot,r.hydrateRoot},961:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(2551)},4976:(e,t,n)=>{"use strict";var r,i;n.d(t,{N_:()=>M,Ys:()=>d,ok:()=>I,pg:()=>w});var o=n(6540),a=n(961),s=n(7767),l=n(5588);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function u(e){return void 0===e&&(e=""),new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map((e=>[n,e])):[[n,r]])}),[]))}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const h=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(e){}function d(e,t){return(0,l.aE)({basename:null==t?void 0:t.basename,future:c({},null==t?void 0:t.future,{v7_prependBasename:!0}),history:(0,l.zR)({window:null==t?void 0:t.window}),hydrationData:(null==t?void 0:t.hydrationData)||f(),routes:e,mapRouteProperties:s.wE,dataStrategy:null==t?void 0:t.dataStrategy,patchRoutesOnNavigation:null==t?void 0:t.patchRoutesOnNavigation,window:null==t?void 0:t.window}).initialize()}function f(){var e;let t=null==(e=window)?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=c({},t,{errors:p(t.errors)})),t}function p(e){if(!e)return null;let t=Object.entries(e),n={};for(let[e,r]of t)if(r&&"RouteErrorResponse"===r.__type)n[e]=new l.VV(r.status,r.statusText,r.data,!0===r.internal);else if(r&&"Error"===r.__type){if(r.__subType){let t=window[r.__subType];if("function"==typeof t)try{let i=new t(r.message);i.stack="",n[e]=i}catch(e){}}if(null==n[e]){let t=new Error(r.message);t.stack="",n[e]=t}}else n[e]=r;return n}const m=o.createContext({isTransitioning:!1}),g=o.createContext(new Map),v=(r||(r=n.t(o,2))).startTransition,y=(i||(i=n.t(a,2))).flushSync;function b(e){y?y(e):e()}(r||(r=n.t(o,2))).useId;class _{constructor(){this.status="pending",this.promise=new Promise(((e,t)=>{this.resolve=t=>{"pending"===this.status&&(this.status="resolved",e(t))},this.reject=e=>{"pending"===this.status&&(this.status="rejected",t(e))}}))}}function w(e){let{fallbackElement:t,router:n,future:r}=e,[i,a]=o.useState(n.state),[l,c]=o.useState(),[u,h]=o.useState({isTransitioning:!1}),[d,f]=o.useState(),[p,y]=o.useState(),[w,S]=o.useState(),E=o.useRef(new Map),{v7_startTransition:A}=r||{},M=o.useCallback((e=>{A?function(e){v?v(e):e()}(e):e()}),[A]),T=o.useCallback(((e,t)=>{let{deletedFetchers:r,flushSync:i,viewTransitionOpts:o}=t;r.forEach((e=>E.current.delete(e))),e.fetchers.forEach(((e,t)=>{void 0!==e.data&&E.current.set(t,e.data)}));let s=null==n.window||null==n.window.document||"function"!=typeof n.window.document.startViewTransition;if(o&&!s){if(i){b((()=>{p&&(d&&d.resolve(),p.skipTransition()),h({isTransitioning:!0,flushSync:!0,currentLocation:o.currentLocation,nextLocation:o.nextLocation})}));let t=n.window.document.startViewTransition((()=>{b((()=>a(e)))}));return t.finished.finally((()=>{b((()=>{f(void 0),y(void 0),c(void 0),h({isTransitioning:!1})}))})),void b((()=>y(t)))}p?(d&&d.resolve(),p.skipTransition(),S({state:e,currentLocation:o.currentLocation,nextLocation:o.nextLocation})):(c(e),h({isTransitioning:!0,flushSync:!1,currentLocation:o.currentLocation,nextLocation:o.nextLocation}))}else i?b((()=>a(e))):M((()=>a(e)))}),[n.window,p,d,E,M]);o.useLayoutEffect((()=>n.subscribe(T)),[n,T]),o.useEffect((()=>{u.isTransitioning&&!u.flushSync&&f(new _)}),[u]),o.useEffect((()=>{if(d&&l&&n.window){let e=l,t=d.promise,r=n.window.document.startViewTransition((async()=>{M((()=>a(e))),await t}));r.finished.finally((()=>{f(void 0),y(void 0),c(void 0),h({isTransitioning:!1})})),y(r)}}),[M,l,d,n.window]),o.useEffect((()=>{d&&l&&i.location.key===l.location.key&&d.resolve()}),[d,p,i.location,l]),o.useEffect((()=>{!u.isTransitioning&&w&&(c(w.state),h({isTransitioning:!0,flushSync:!1,currentLocation:w.currentLocation,nextLocation:w.nextLocation}),S(void 0))}),[u.isTransitioning,w]),o.useEffect((()=>{}),[]);let C=o.useMemo((()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:e=>n.navigate(e),push:(e,t,r)=>n.navigate(e,{state:t,preventScrollReset:null==r?void 0:r.preventScrollReset}),replace:(e,t,r)=>n.navigate(e,{replace:!0,state:t,preventScrollReset:null==r?void 0:r.preventScrollReset})})),[n]),I=n.basename||"/",R=o.useMemo((()=>({router:n,navigator:C,static:!1,basename:I})),[n,C,I]),P=o.useMemo((()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath})),[n.future.v7_relativeSplatPath]);return o.useEffect((()=>(0,s.V8)(r,n.future)),[r,n.future]),o.createElement(o.Fragment,null,o.createElement(s.sp.Provider,{value:R},o.createElement(s.Rq.Provider,{value:i},o.createElement(g.Provider,{value:E.current},o.createElement(m.Provider,{value:u},o.createElement(s.Ix,{basename:I,location:i.location,navigationType:i.historyAction,navigator:C,future:P},i.initialized||n.future.v7_partialHydration?o.createElement(x,{routes:n.routes,future:n.future,state:i}):t))))),null)}const x=o.memo(S);function S(e){let{routes:t,future:n,state:r}=e;return(0,s.ph)(t,void 0,r,n)}const E="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,A=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,M=o.forwardRef((function(e,t){let n,{onClick:r,relative:i,reloadDocument:a,replace:u,state:d,target:f,to:p,preventScrollReset:m,viewTransition:g}=e,v=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,h),{basename:y}=o.useContext(s.jb),b=!1;if("string"==typeof p&&A.test(p)&&(n=p,E))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),n=(0,l.pb)(t.pathname,y);t.origin===e.origin&&null!=n?p=n+t.search+t.hash:b=!0}catch(e){}let _=(0,s.$P)(p,{relative:i}),w=function(e,t){let{target:n,replace:r,state:i,preventScrollReset:a,relative:c,viewTransition:u}=void 0===t?{}:t,h=(0,s.Zp)(),d=(0,s.zy)(),f=(0,s.x$)(e,{relative:c});return o.useCallback((t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,n)){t.preventDefault();let n=void 0!==r?r:(0,l.AO)(d)===(0,l.AO)(f);h(e,{replace:n,state:i,preventScrollReset:a,relative:c,viewTransition:u})}}),[d,h,f,r,i,n,e,a,c,u])}(p,{replace:u,state:d,target:f,preventScrollReset:m,relative:i,viewTransition:g});return o.createElement("a",c({},v,{href:n||_,onClick:b||a?r:function(e){r&&r(e),e.defaultPrevented||w(e)},ref:t,target:f}))}));var T,C;function I(e){let t=o.useRef(u(e)),n=o.useRef(!1),r=(0,s.zy)(),i=o.useMemo((()=>function(e,t){let n=u(e);return t&&t.forEach(((e,r)=>{n.has(r)||t.getAll(r).forEach((e=>{n.append(r,e)}))})),n}(r.search,n.current?null:t.current)),[r.search]),a=(0,s.Zp)(),l=o.useCallback(((e,t)=>{const r=u("function"==typeof e?e(i):e);n.current=!0,a("?"+r,t)}),[a,i]);return[i,l]}(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(T||(T={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(C||(C={}))},7767:(e,t,n)=>{"use strict";var r;n.d(t,{$P:()=>f,Ix:()=>L,Rq:()=>l,V8:()=>P,Zp:()=>v,jb:()=>c,ph:()=>b,r5:()=>T,sp:()=>s,wE:()=>k,x$:()=>y,zy:()=>m});var i=n(6540),o=n(5588);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const s=i.createContext(null),l=i.createContext(null),c=i.createContext(null),u=i.createContext(null),h=i.createContext({outlet:null,matches:[],isDataRoute:!1}),d=i.createContext(null);function f(e,t){let{relative:n}=void 0===t?{}:t;p()||(0,o.Oi)(!1);let{basename:r,navigator:a}=i.useContext(c),{hash:s,pathname:l,search:u}=y(e,{relative:n}),h=l;return"/"!==r&&(h="/"===l?r:(0,o.HS)([r,l])),a.createHref({pathname:h,search:u,hash:s})}function p(){return null!=i.useContext(u)}function m(){return p()||(0,o.Oi)(!1),i.useContext(u).location}function g(e){i.useContext(c).static||i.useLayoutEffect(e)}function v(){let{isDataRoute:e}=i.useContext(h);return e?function(){let{router:e}=function(){let e=i.useContext(s);return e||(0,o.Oi)(!1),e}(E.UseNavigateStable),t=M(A.UseNavigateStable),n=i.useRef(!1);return g((()=>{n.current=!0})),i.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"==typeof r?e.navigate(r):e.navigate(r,a({fromRouteId:t},i)))}),[e,t])}():function(){p()||(0,o.Oi)(!1);let e=i.useContext(s),{basename:t,future:n,navigator:r}=i.useContext(c),{matches:a}=i.useContext(h),{pathname:l}=m(),u=JSON.stringify((0,o.yD)(a,n.v7_relativeSplatPath)),d=i.useRef(!1);return g((()=>{d.current=!0})),i.useCallback((function(n,i){if(void 0===i&&(i={}),!d.current)return;if("number"==typeof n)return void r.go(n);let a=(0,o.Gh)(n,JSON.parse(u),l,"path"===i.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:(0,o.HS)([t,a.pathname])),(i.replace?r.replace:r.push)(a,i.state,i)}),[t,r,u,l,e])}()}function y(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(c),{matches:a}=i.useContext(h),{pathname:s}=m(),l=JSON.stringify((0,o.yD)(a,r.v7_relativeSplatPath));return i.useMemo((()=>(0,o.Gh)(e,JSON.parse(l),s,"path"===n)),[e,l,s,n])}function b(e,t,n,r){p()||(0,o.Oi)(!1);let{navigator:s}=i.useContext(c),{matches:l}=i.useContext(h),d=l[l.length-1],f=d?d.params:{},g=(d&&d.pathname,d?d.pathnameBase:"/");d&&d.route;let v,y=m();if(t){var b;let e="string"==typeof t?(0,o.Rr)(t):t;"/"===g||(null==(b=e.pathname)?void 0:b.startsWith(g))||(0,o.Oi)(!1),v=e}else v=y;let _=v.pathname||"/",E=_;if("/"!==g){let e=g.replace(/^\//,"").split("/");E="/"+_.replace(/^\//,"").split("/").slice(e.length).join("/")}let A=(0,o.ue)(e,{pathname:E}),M=function(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=r)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let l=e,c=null==(a=n)?void 0:a.errors;if(null!=c){let e=l.findIndex((e=>e.route.id&&void 0!==(null==c?void 0:c[e.route.id])));e>=0||(0,o.Oi)(!1),l=l.slice(0,Math.min(l.length,e+1))}let u=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let e=0;e<l.length;e++){let t=l[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(h=e),t.route.id){let{loaderData:e,errors:r}=n,i=t.route.loader&&void 0===e[t.route.id]&&(!r||void 0===r[t.route.id]);if(t.route.lazy||i){u=!0,l=h>=0?l.slice(0,h+1):[l[0]];break}}}return l.reduceRight(((e,r,o)=>{let a,s=!1,d=null,f=null;var p;n&&(a=c&&r.route.id?c[r.route.id]:void 0,d=r.route.errorElement||w,u&&(h<0&&0===o?(C[p="route-fallback"]||(C[p]=!0),s=!0,f=null):h===o&&(s=!0,f=r.route.hydrateFallbackElement||null)));let m=t.concat(l.slice(0,o+1)),g=()=>{let t;return t=a?d:s?f:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(S,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===o)?i.createElement(x,{location:n.location,revalidation:n.revalidation,component:d,error:a,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}(A&&A.map((e=>Object.assign({},e,{params:Object.assign({},f,e.params),pathname:(0,o.HS)([g,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?g:(0,o.HS)([g,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,r);return t&&M?i.createElement(u.Provider,{value:{location:a({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:o.rc.Pop}},M):M}function _(){let e=T(),t=(0,o.pX)(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:r},n):null,null)}const w=i.createElement(_,null);class x extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(h.Provider,{value:this.props.routeContext},i.createElement(d.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function S(e){let{routeContext:t,match:n,children:r}=e,o=i.useContext(s);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(h.Provider,{value:t},r)}var E=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(E||{}),A=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(A||{});function M(e){let t=function(){let e=i.useContext(h);return e||(0,o.Oi)(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||(0,o.Oi)(!1),n.route.id}function T(){var e;let t=i.useContext(d),n=function(){let e=i.useContext(l);return e||(0,o.Oi)(!1),e}(A.UseRouteError),r=M(A.UseRouteError);return void 0!==t?t:null==(e=n.errors)?void 0:e[r]}const C={},I={},R=(e,t,n)=>{var r;I[r=" React Router Future Flag Warning: "+t+". You can use the `"+e+"` future flag to opt-in early. For more information, see "+n+"."]||(I[r]=!0,console.warn(r))};function P(e,t){null!=e&&e.v7_startTransition||R("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),null!=e&&e.v7_relativeSplatPath||t&&t.v7_relativeSplatPath||R("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),t&&(t.v7_fetcherPersist||R("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),t.v7_normalizeFormMethod||R("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),t.v7_partialHydration||R("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),t.v7_skipActionErrorRevalidation||R("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}function L(e){let{basename:t="/",children:n=null,location:r,navigationType:s=o.rc.Pop,navigator:l,static:h=!1,future:d}=e;p()&&(0,o.Oi)(!1);let f=t.replace(/^\/*/,"/"),m=i.useMemo((()=>({basename:f,navigator:l,static:h,future:a({v7_relativeSplatPath:!1},d)})),[f,d,l,h]);"string"==typeof r&&(r=(0,o.Rr)(r));let{pathname:g="/",search:v="",hash:y="",state:b=null,key:_="default"}=r,w=i.useMemo((()=>{let e=(0,o.pb)(g,f);return null==e?null:{location:{pathname:e,search:v,hash:y,state:b,key:_},navigationType:s}}),[f,g,v,y,b,_,s]);return null==w?null:i.createElement(c.Provider,{value:m},i.createElement(u.Provider,{children:n,value:w}))}function k(e){let t={hasErrorBoundary:null!=e.ErrorBoundary||null!=e.errorElement};return e.Component&&Object.assign(t,{element:i.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:i.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:i.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}(r||(r=n.t(i,2))).startTransition,new Promise((()=>{})),i.Component},5287:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator,p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var _=b.prototype=new y;_.constructor=b,m(_,v.prototype),_.isPureReactComponent=!0;var w=Array.isArray,x=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,i)&&!E.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:S.current}}function M(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function C(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===o?"."+C(l,0):o,w(a)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),I(a,t,i,"",(function(e){return e}))):null!=a&&(M(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(T,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",w(e))for(var c=0;c<e.length;c++){var u=o+C(s=e[c],c);l+=I(s,t,i,u,a)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=I(s=s.value,t,i,u=o+C(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function R(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},k={transition:null},D={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:k,ReactCurrentOwner:S};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=O,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=S.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=k.transition;k.transition={};try{e()}finally{k.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,n){return L.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,n){return L.current.useReducer(e,t,n)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return L.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return L.current.useTransition()},t.version="18.3.1"},6540:(e,t,n)=>{"use strict";e.exports=n(5287)},7463:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function _(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,_(e),!m)if(null!==r(c))m=!0,k(x);else{var t=r(u);null!==t&&D(w,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,y(M),M=-1),p=!0;var o=f;try{for(_(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!I());){var a=d.callback;if("function"==typeof a){d.callback=null,f=d.priorityLevel;var s=a(d.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?d.callback=s:d===r(c)&&i(c),_(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&D(w,h.startTime-n),l=!1}return l}finally{d=null,f=o,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,A=null,M=-1,T=5,C=-1;function I(){return!(t.unstable_now()-C<T)}function R(){if(null!==A){var e=t.unstable_now();C=e;var n=!0;try{n=A(!0,e)}finally{n?S():(E=!1,A=null)}}else E=!1}if("function"==typeof b)S=function(){b(R)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,L=P.port2;P.port1.onmessage=R,S=function(){L.postMessage(null)}}else S=function(){v(R,0)};function k(e){A=e,E||(E=!0,S())}function D(e,n){M=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,k(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?a+o:a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(g?(y(M),M=-1):g=!0,D(w,o-a))):(e.sortIndex=s,n(c,e),m||p||(m=!0,k(x))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},9982:(e,t,n)=>{"use strict";e.exports=n(7463)},2833:e=>{e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var c=o[l];if(!s(c))return!1;var u=e[c],h=t[c];if(!1===(i=n?n.call(r,u,h,c):void 0)||void 0===i&&u!==h)return!1}return!0}},1250:(e,t,n)=>{"use strict";n.d(t,{AH:()=>Ut,Ay:()=>Bt});var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function i(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var o=n(6540),a=n(2833),s=n.n(a),l="-ms-",c="-moz-",u="-webkit-",h="comm",d="rule",f="decl",p="@keyframes",m=Math.abs,g=String.fromCharCode,v=Object.assign;function y(e){return e.trim()}function b(e,t){return(e=t.exec(e))?e[0]:e}function _(e,t,n){return e.replace(t,n)}function w(e,t,n){return e.indexOf(t,n)}function x(e,t){return 0|e.charCodeAt(t)}function S(e,t,n){return e.slice(t,n)}function E(e){return e.length}function A(e){return e.length}function M(e,t){return t.push(e),e}function T(e,t){return e.filter((function(e){return!b(e,t)}))}var C=1,I=1,R=0,P=0,L=0,k="";function D(e,t,n,r,i,o,a,s){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:C,column:I,length:a,return:"",siblings:s}}function O(e,t){return v(D("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function N(e){for(;e.root;)e=O(e.root,{children:[e]});M(e,e.siblings)}function U(){return L=P>0?x(k,--P):0,I--,10===L&&(I=1,C--),L}function F(){return L=P<R?x(k,P++):0,I++,10===L&&(I=1,C++),L}function z(){return x(k,P)}function B(){return P}function V(e,t){return S(k,e,t)}function j(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function H(e){return y(V(P-1,q(91===e?e+2:40===e?e+1:e)))}function G(e){for(;(L=z())&&L<33;)F();return j(e)>2||j(L)>3?"":" "}function W(e,t){for(;--t&&F()&&!(L<48||L>102||L>57&&L<65||L>70&&L<97););return V(e,B()+(t<6&&32==z()&&32==F()))}function q(e){for(;F();)switch(L){case e:return P;case 34:case 39:34!==e&&39!==e&&q(L);break;case 40:41===e&&q(e);break;case 92:F()}return P}function X(e,t){for(;F()&&e+L!==57&&(e+L!==84||47!==z()););return"/*"+V(t,P-1)+"*"+g(47===e?e:F())}function $(e){for(;!j(z());)F();return V(e,P)}function Y(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function K(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case f:return e.return=e.return||e.value;case h:return"";case p:return e.return=e.value+"{"+Y(e.children,r)+"}";case d:if(!E(e.value=e.props.join(",")))return""}return E(n=Y(e.children,r))?e.return=e.value+"{"+n+"}":""}function Z(e,t,n){switch(function(e,t){return 45^x(e,0)?(((t<<2^x(e,0))<<2^x(e,1))<<2^x(e,2))<<2^x(e,3):0}(e,t)){case 5103:return u+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return u+e+e;case 4789:return c+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return u+e+c+e+l+e+e;case 5936:switch(x(e,t+11)){case 114:return u+e+l+_(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return u+e+l+_(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return u+e+l+_(e,/[svh]\w+-[tblr]{2}/,"lr")+e}case 6828:case 4268:case 2903:return u+e+l+e+e;case 6165:return u+e+l+"flex-"+e+e;case 5187:return u+e+_(e,/(\w+).+(:[^]+)/,u+"box-$1$2"+l+"flex-$1$2")+e;case 5443:return u+e+l+"flex-item-"+_(e,/flex-|-self/g,"")+(b(e,/flex-|baseline/)?"":l+"grid-row-"+_(e,/flex-|-self/g,""))+e;case 4675:return u+e+l+"flex-line-pack"+_(e,/align-content|flex-|-self/g,"")+e;case 5548:return u+e+l+_(e,"shrink","negative")+e;case 5292:return u+e+l+_(e,"basis","preferred-size")+e;case 6060:return u+"box-"+_(e,"-grow","")+u+e+l+_(e,"grow","positive")+e;case 4554:return u+_(e,/([^-])(transform)/g,"$1"+u+"$2")+e;case 6187:return _(_(_(e,/(zoom-|grab)/,u+"$1"),/(image-set)/,u+"$1"),e,"")+e;case 5495:case 3959:return _(e,/(image-set\([^]*)/,u+"$1$`$1");case 4968:return _(_(e,/(.+:)(flex-)?(.*)/,u+"box-pack:$3"+l+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+u+e+e;case 4200:if(!b(e,/flex-|baseline/))return l+"grid-column-align"+S(e,t)+e;break;case 2592:case 3360:return l+_(e,"template-","")+e;case 4384:case 3616:return n&&n.some((function(e,n){return t=n,b(e.props,/grid-\w+-end/)}))?~w(e+(n=n[t].value),"span",0)?e:l+_(e,"-start","")+e+l+"grid-row-span:"+(~w(n,"span",0)?b(n,/\d+/):+b(n,/\d+/)-+b(e,/\d+/))+";":l+_(e,"-start","")+e;case 4896:case 4128:return n&&n.some((function(e){return b(e.props,/grid-\w+-start/)}))?e:l+_(_(e,"-end","-span"),"span ","")+e;case 4095:case 3583:case 4068:case 2532:return _(e,/(.+)-inline(.+)/,u+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(E(e)-1-t>6)switch(x(e,t+1)){case 109:if(45!==x(e,t+4))break;case 102:return _(e,/(.+:)(.+)-([^]+)/,"$1"+u+"$2-$3$1"+c+(108==x(e,t+3)?"$3":"$2-$3"))+e;case 115:return~w(e,"stretch",0)?Z(_(e,"stretch","fill-available"),t,n)+e:e}break;case 5152:case 5920:return _(e,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,(function(t,n,r,i,o,a,s){return l+n+":"+r+s+(i?l+n+"-span:"+(o?a:+a-+r)+s:"")+e}));case 4949:if(121===x(e,t+6))return _(e,":",":"+u)+e;break;case 6444:switch(x(e,45===x(e,14)?18:11)){case 120:return _(e,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+u+(45===x(e,14)?"inline-":"")+"box$3$1"+u+"$2$3$1"+l+"$2box$3")+e;case 100:return _(e,":",":"+l)+e}break;case 5719:case 2647:case 2135:case 3927:case 2391:return _(e,"scroll-","scroll-snap-")+e}return e}function Q(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case f:return void(e.return=Z(e.value,e.length,n));case p:return Y([O(e,{value:_(e.value,"@","@"+u)})],r);case d:if(e.length)return function(e,t){return e.map(t).join("")}(n=e.props,(function(t){switch(b(t,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":N(O(e,{props:[_(t,/:(read-\w+)/,":-moz-$1")]})),N(O(e,{props:[t]})),v(e,{props:T(n,r)});break;case"::placeholder":N(O(e,{props:[_(t,/:(plac\w+)/,":"+u+"input-$1")]})),N(O(e,{props:[_(t,/:(plac\w+)/,":-moz-$1")]})),N(O(e,{props:[_(t,/:(plac\w+)/,l+"input-$1")]})),N(O(e,{props:[t]})),v(e,{props:T(n,r)})}return""}))}}function J(e){return function(e){return k="",e}(ee("",null,null,null,[""],e=function(e){return C=I=1,R=E(k=e),P=0,[]}(e),0,[0],e))}function ee(e,t,n,r,i,o,a,s,l){for(var c=0,u=0,h=a,d=0,f=0,p=0,v=1,y=1,b=1,S=0,A="",T=i,C=o,I=r,R=A;y;)switch(p=S,S=F()){case 40:if(108!=p&&58==x(R,h-1)){-1!=w(R+=_(H(S),"&","&\f"),"&\f",m(c?s[c-1]:0))&&(b=-1);break}case 34:case 39:case 91:R+=H(S);break;case 9:case 10:case 13:case 32:R+=G(p);break;case 92:R+=W(B()-1,7);continue;case 47:switch(z()){case 42:case 47:M(ne(X(F(),B()),t,n,l),l);break;default:R+="/"}break;case 123*v:s[c++]=E(R)*b;case 125*v:case 59:case 0:switch(S){case 0:case 125:y=0;case 59+u:-1==b&&(R=_(R,/\f/g,"")),f>0&&E(R)-h&&M(f>32?re(R+";",r,n,h-1,l):re(_(R," ","")+";",r,n,h-2,l),l);break;case 59:R+=";";default:if(M(I=te(R,t,n,c,u,i,s,A,T=[],C=[],h,o),o),123===S)if(0===u)ee(R,t,I,I,T,o,h,s,C);else switch(99===d&&110===x(R,3)?100:d){case 100:case 108:case 109:case 115:ee(e,I,I,r&&M(te(e,I,I,0,0,i,s,A,i,T=[],h,C),C),i,C,h,s,r?T:C);break;default:ee(R,I,I,I,[""],C,0,s,C)}}c=u=f=0,v=b=1,A=R="",h=a;break;case 58:h=1+E(R),f=p;default:if(v<1)if(123==S)--v;else if(125==S&&0==v++&&125==U())continue;switch(R+=g(S),S*v){case 38:b=u>0?1:(R+="\f",-1);break;case 44:s[c++]=(E(R)-1)*b,b=1;break;case 64:45===z()&&(R+=H(F())),d=z(),u=h=E(A=R+=$(B())),S++;break;case 45:45===p&&2==E(R)&&(v=0)}}return o}function te(e,t,n,r,i,o,a,s,l,c,u,h){for(var f=i-1,p=0===i?o:[""],g=A(p),v=0,b=0,w=0;v<r;++v)for(var x=0,E=S(e,f+1,f=m(b=a[v])),M=e;x<g;++x)(M=y(b>0?p[x]+" "+E:_(E,/&\f/g,p[x])))&&(l[w++]=M);return D(e,t,n,0===i?d:s,l,c,u,h)}function ne(e,t,n,r){return D(e,t,n,h,g(L),S(e,2,-2),0,r)}function re(e,t,n,r,i){return D(e,t,n,f,S(e,0,r),S(e,r+1,-1),r,i)}var ie={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},oe="undefined"!=typeof process&&void 0!==process.env&&(process.env.REACT_APP_SC_ATTR||process.env.SC_ATTR)||"data-styled",ae="active",se="data-styled-version",le="6.1.13",ce="/*!sc*/\n",ue="undefined"!=typeof window&&"HTMLElement"in window,he=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==process.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==process.env.REACT_APP_SC_DISABLE_SPEEDY&&process.env.REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.SC_DISABLE_SPEEDY&&""!==process.env.SC_DISABLE_SPEEDY&&"false"!==process.env.SC_DISABLE_SPEEDY&&process.env.SC_DISABLE_SPEEDY),de=(new Set,Object.freeze([])),fe=Object.freeze({});var pe=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),me=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,ge=/(^-|-$)/g;function ve(e){return e.replace(me,"-").replace(ge,"")}var ye=/(a)(d)/gi,be=function(e){return String.fromCharCode(e+(e>25?39:97))};function _e(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=be(t%52)+n;return(be(t%52)+n).replace(ye,"$1-$2")}var we,xe=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},Se=function(e){return xe(5381,e)};function Ee(e){return"string"==typeof e&&!0}var Ae="function"==typeof Symbol&&Symbol.for,Me=Ae?Symbol.for("react.memo"):60115,Te=Ae?Symbol.for("react.forward_ref"):60112,Ce={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Ie={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Re={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Pe=((we={})[Te]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},we[Me]=Re,we);function Le(e){return("type"in(t=e)&&t.type.$$typeof)===Me?Re:"$$typeof"in e?Pe[e.$$typeof]:Ce;var t}var ke=Object.defineProperty,De=Object.getOwnPropertyNames,Oe=Object.getOwnPropertySymbols,Ne=Object.getOwnPropertyDescriptor,Ue=Object.getPrototypeOf,Fe=Object.prototype;function ze(e,t,n){if("string"!=typeof t){if(Fe){var r=Ue(t);r&&r!==Fe&&ze(e,r,n)}var i=De(t);Oe&&(i=i.concat(Oe(t)));for(var o=Le(e),a=Le(t),s=0;s<i.length;++s){var l=i[s];if(!(l in Ie||n&&n[l]||a&&l in a||o&&l in o)){var c=Ne(t,l);try{ke(e,l,c)}catch(e){}}}}return e}function Be(e){return"function"==typeof e}function Ve(e){return"object"==typeof e&&"styledComponentId"in e}function je(e,t){return e&&t?"".concat(e," ").concat(t):e||t||""}function He(e,t){if(0===e.length)return"";for(var n=e[0],r=1;r<e.length;r++)n+=t?t+e[r]:e[r];return n}function Ge(e){return null!==e&&"object"==typeof e&&e.constructor.name===Object.name&&!("props"in e&&e.$$typeof)}function We(e,t,n){if(void 0===n&&(n=!1),!n&&!Ge(e)&&!Array.isArray(e))return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)e[r]=We(e[r],t[r]);else if(Ge(t))for(var r in t)e[r]=We(e[r],t[r]);return e}function qe(e,t){Object.defineProperty(e,"toString",{value:t})}function Xe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(e," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var $e=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return e.prototype.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},e.prototype.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,i=r;e>=i;)if((i<<=1)<0)throw Xe(16,"".concat(e));this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var o=r;o<i;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),s=(o=0,t.length);o<s;o++)this.tag.insertRule(a,t[o])&&(this.groupSizes[e]++,a++)},e.prototype.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var i=n;i<r;i++)this.tag.deleteRule(n)}},e.prototype.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),i=r+n,o=r;o<i;o++)t+="".concat(this.tag.getRule(o)).concat(ce);return t},e}(),Ye=new Map,Ke=new Map,Ze=1,Qe=function(e){if(Ye.has(e))return Ye.get(e);for(;Ke.has(Ze);)Ze++;var t=Ze++;return Ye.set(e,t),Ke.set(t,e),t},Je=function(e,t){Ze=t+1,Ye.set(e,t),Ke.set(t,e)},et="style[".concat(oe,"][").concat(se,'="').concat(le,'"]'),tt=new RegExp("^".concat(oe,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),nt=function(e,t,n){for(var r,i=n.split(","),o=0,a=i.length;o<a;o++)(r=i[o])&&e.registerName(t,r)},rt=function(e,t){for(var n,r=(null!==(n=t.textContent)&&void 0!==n?n:"").split(ce),i=[],o=0,a=r.length;o<a;o++){var s=r[o].trim();if(s){var l=s.match(tt);if(l){var c=0|parseInt(l[1],10),u=l[2];0!==c&&(Je(u,c),nt(e,u,l[3]),e.getTag().insertRules(c,i)),i.length=0}else i.push(s)}}},it=function(e){for(var t=document.querySelectorAll(et),n=0,r=t.length;n<r;n++){var i=t[n];i&&i.getAttribute(oe)!==ae&&(rt(e,i),i.parentNode&&i.parentNode.removeChild(i))}};function ot(){return n.nc}var at=function(e){var t=document.head,n=e||t,r=document.createElement("style"),i=function(e){var t=Array.from(e.querySelectorAll("style[".concat(oe,"]")));return t[t.length-1]}(n),o=void 0!==i?i.nextSibling:null;r.setAttribute(oe,ae),r.setAttribute(se,le);var a=ot();return a&&r.setAttribute("nonce",a),n.insertBefore(r,o),r},st=function(){function e(e){this.element=at(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var i=t[n];if(i.ownerNode===e)return i}throw Xe(17)}(this.element),this.length=0}return e.prototype.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},e.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},e.prototype.getRule=function(e){var t=this.sheet.cssRules[e];return t&&t.cssText?t.cssText:""},e}(),lt=function(){function e(e){this.element=at(e),this.nodes=this.element.childNodes,this.length=0}return e.prototype.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t);return this.element.insertBefore(n,this.nodes[e]||null),this.length++,!0}return!1},e.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},e.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),ct=function(){function e(e){this.rules=[],this.length=0}return e.prototype.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},e.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},e.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),ut=ue,ht={isServer:!ue,useCSSOMInjection:!he},dt=function(){function e(e,t,n){void 0===e&&(e=fe),void 0===t&&(t={});var i=this;this.options=r(r({},ht),e),this.gs=t,this.names=new Map(n),this.server=!!e.isServer,!this.server&&ue&&ut&&(ut=!1,it(this)),qe(this,(function(){return function(e){for(var t=e.getTag(),n=t.length,r="",i=function(n){var i=function(e){return Ke.get(e)}(n);if(void 0===i)return"continue";var o=e.names.get(i),a=t.getGroup(n);if(void 0===o||!o.size||0===a.length)return"continue";var s="".concat(oe,".g").concat(n,'[id="').concat(i,'"]'),l="";void 0!==o&&o.forEach((function(e){e.length>0&&(l+="".concat(e,","))})),r+="".concat(a).concat(s,'{content:"').concat(l,'"}').concat(ce)},o=0;o<n;o++)i(o);return r}(i)}))}return e.registerId=function(e){return Qe(e)},e.prototype.rehydrate=function(){!this.server&&ue&&it(this)},e.prototype.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(r(r({},this.options),t),this.gs,n&&this.names||void 0)},e.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},e.prototype.getTag=function(){return this.tag||(this.tag=(e=function(e){var t=e.useCSSOMInjection,n=e.target;return e.isServer?new ct(n):t?new st(n):new lt(n)}(this.options),new $e(e)));var e},e.prototype.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},e.prototype.registerName=function(e,t){if(Qe(e),this.names.has(e))this.names.get(e).add(t);else{var n=new Set;n.add(t),this.names.set(e,n)}},e.prototype.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(Qe(e),n)},e.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},e.prototype.clearRules=function(e){this.getTag().clearGroup(Qe(e)),this.clearNames(e)},e.prototype.clearTag=function(){this.tag=void 0},e}(),ft=/&/g,pt=/^\s*\/\/.*$/gm;function mt(e,t){return e.map((function(e){return"rule"===e.type&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map((function(e){return"".concat(t," ").concat(e)}))),Array.isArray(e.children)&&"@keyframes"!==e.type&&(e.children=mt(e.children,t)),e}))}function gt(e){var t,n,r,i=void 0===e?fe:e,o=i.options,a=void 0===o?fe:o,s=i.plugins,l=void 0===s?de:s,c=function(e,r,i){return i.startsWith(n)&&i.endsWith(n)&&i.replaceAll(n,"").length>0?".".concat(t):e},u=l.slice();u.push((function(e){e.type===d&&e.value.includes("&")&&(e.props[0]=e.props[0].replace(ft,n).replace(r,c))})),a.prefix&&u.push(Q),u.push(K);var h=function(e,i,o,s){void 0===i&&(i=""),void 0===o&&(o=""),void 0===s&&(s="&"),t=s,n=i,r=new RegExp("\\".concat(n,"\\b"),"g");var l=e.replace(pt,""),c=J(o||i?"".concat(o," ").concat(i," { ").concat(l," }"):l);a.namespace&&(c=mt(c,a.namespace));var h,d,f,p=[];return Y(c,(h=u.concat((f=function(e){return p.push(e)},function(e){e.root||(e=e.return)&&f(e)})),d=A(h),function(e,t,n,r){for(var i="",o=0;o<d;o++)i+=h[o](e,t,n,r)||"";return i})),p};return h.hash=l.length?l.reduce((function(e,t){return t.name||Xe(15),xe(e,t.name)}),5381).toString():"",h}var vt=new dt,yt=gt(),bt=o.createContext({shouldForwardProp:void 0,styleSheet:vt,stylis:yt}),_t=(bt.Consumer,o.createContext(void 0));function wt(){return(0,o.useContext)(bt)}function xt(e){var t=(0,o.useState)(e.stylisPlugins),n=t[0],r=t[1],i=wt().styleSheet,a=(0,o.useMemo)((function(){var t=i;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target,i]),l=(0,o.useMemo)((function(){return gt({options:{namespace:e.namespace,prefix:e.enableVendorPrefixes},plugins:n})}),[e.enableVendorPrefixes,e.namespace,n]);(0,o.useEffect)((function(){s()(n,e.stylisPlugins)||r(e.stylisPlugins)}),[e.stylisPlugins]);var c=(0,o.useMemo)((function(){return{shouldForwardProp:e.shouldForwardProp,styleSheet:a,stylis:l}}),[e.shouldForwardProp,a,l]);return o.createElement(bt.Provider,{value:c},o.createElement(_t.Provider,{value:l},e.children))}var St=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=yt);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=t,qe(this,(function(){throw Xe(12,String(n.name))}))}return e.prototype.getName=function(e){return void 0===e&&(e=yt),this.name+e.hash},e}(),Et=function(e){return e>="A"&&e<="Z"};function At(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(1===n&&"-"===r&&"-"===e[0])return e;Et(r)?t+="-"+r.toLowerCase():t+=r}return t.startsWith("ms-")?"-"+t:t}var Mt=function(e){return null==e||!1===e||""===e},Tt=function(e){var t,n,r=[];for(var o in e){var a=e[o];e.hasOwnProperty(o)&&!Mt(a)&&(Array.isArray(a)&&a.isCss||Be(a)?r.push("".concat(At(o),":"),a,";"):Ge(a)?r.push.apply(r,i(i(["".concat(o," {")],Tt(a),!1),["}"],!1)):r.push("".concat(At(o),": ").concat((t=o,null==(n=a)||"boolean"==typeof n||""===n?"":"number"!=typeof n||0===n||t in ie||t.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function Ct(e,t,n,r){return Mt(e)?[]:Ve(e)?[".".concat(e.styledComponentId)]:Be(e)?!Be(i=e)||i.prototype&&i.prototype.isReactComponent||!t?[e]:Ct(e(t),t,n,r):e instanceof St?n?(e.inject(n,r),[e.getName(r)]):[e]:Ge(e)?Tt(e):Array.isArray(e)?Array.prototype.concat.apply(de,e.map((function(e){return Ct(e,t,n,r)}))):[e.toString()];var i}function It(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(Be(n)&&!Ve(n))return!1}return!0}var Rt=Se(le),Pt=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&It(e),this.componentId=t,this.baseHash=xe(Rt,t),this.baseStyle=n,dt.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,t,n):"";if(this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))r=je(r,this.staticRulesId);else{var i=He(Ct(this.rules,e,t,n)),o=_e(xe(this.baseHash,i)>>>0);if(!t.hasNameForId(this.componentId,o)){var a=n(i,".".concat(o),void 0,this.componentId);t.insertRules(this.componentId,o,a)}r=je(r,o),this.staticRulesId=o}else{for(var s=xe(this.baseHash,n.hash),l="",c=0;c<this.rules.length;c++){var u=this.rules[c];if("string"==typeof u)l+=u;else if(u){var h=He(Ct(u,e,t,n));s=xe(s,h+c),l+=h}}if(l){var d=_e(s>>>0);t.hasNameForId(this.componentId,d)||t.insertRules(this.componentId,d,n(l,".".concat(d),void 0,this.componentId)),r=je(r,d)}}return r},e}(),Lt=o.createContext(void 0);Lt.Consumer;var kt={};function Dt(e,t,n){var i=Ve(e),a=e,s=!Ee(e),l=t.attrs,c=void 0===l?de:l,u=t.componentId,h=void 0===u?function(e,t){var n="string"!=typeof e?"sc":ve(e);kt[n]=(kt[n]||0)+1;var r="".concat(n,"-").concat(function(e){return _e(Se(e)>>>0)}(le+n+kt[n]));return t?"".concat(t,"-").concat(r):r}(t.displayName,t.parentComponentId):u,d=t.displayName,f=void 0===d?function(e){return Ee(e)?"styled.".concat(e):"Styled(".concat(function(e){return e.displayName||e.name||"Component"}(e),")")}(e):d,p=t.displayName&&t.componentId?"".concat(ve(t.displayName),"-").concat(t.componentId):t.componentId||h,m=i&&a.attrs?a.attrs.concat(c).filter(Boolean):c,g=t.shouldForwardProp;if(i&&a.shouldForwardProp){var v=a.shouldForwardProp;if(t.shouldForwardProp){var y=t.shouldForwardProp;g=function(e,t){return v(e,t)&&y(e,t)}}else g=v}var b=new Pt(n,p,i?a.componentStyle:void 0);function _(e,t){return function(e,t,n){var i=e.attrs,a=e.componentStyle,s=e.defaultProps,l=e.foldedComponentIds,c=e.styledComponentId,u=e.target,h=o.useContext(Lt),d=wt(),f=e.shouldForwardProp||d.shouldForwardProp,p=function(e,t,n){return void 0===n&&(n=fe),e.theme!==n.theme&&e.theme||t||n.theme}(t,h,s)||fe,m=function(e,t,n){for(var i,o=r(r({},t),{className:void 0,theme:n}),a=0;a<e.length;a+=1){var s=Be(i=e[a])?i(o):i;for(var l in s)o[l]="className"===l?je(o[l],s[l]):"style"===l?r(r({},o[l]),s[l]):s[l]}return t.className&&(o.className=je(o.className,t.className)),o}(i,t,p),g=m.as||u,v={};for(var y in m)void 0===m[y]||"$"===y[0]||"as"===y||"theme"===y&&m.theme===p||("forwardedAs"===y?v.as=m.forwardedAs:f&&!f(y,g)||(v[y]=m[y]));var b=function(e,t){var n=wt();return e.generateAndInjectStyles(t,n.styleSheet,n.stylis)}(a,m),_=je(l,c);return b&&(_+=" "+b),m.className&&(_+=" "+m.className),v[Ee(g)&&!pe.has(g)?"class":"className"]=_,v.ref=n,(0,o.createElement)(g,v)}(w,e,t)}_.displayName=f;var w=o.forwardRef(_);return w.attrs=m,w.componentStyle=b,w.displayName=f,w.shouldForwardProp=g,w.foldedComponentIds=i?je(a.foldedComponentIds,a.styledComponentId):"",w.styledComponentId=p,w.target=i?a.target:e,Object.defineProperty(w,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=i?function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++)We(e,i[r],!0);return e}({},a.defaultProps,e):e}}),qe(w,(function(){return".".concat(w.styledComponentId)})),s&&ze(w,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),w}function Ot(e,t){for(var n=[e[0]],r=0,i=t.length;r<i;r+=1)n.push(t[r],e[r+1]);return n}new Set;var Nt=function(e){return Object.assign(e,{isCss:!0})};function Ut(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Be(e)||Ge(e))return Nt(Ct(Ot(de,i([e],t,!0))));var r=e;return 0===t.length&&1===r.length&&"string"==typeof r[0]?Ct(r):Nt(Ct(Ot(r,t)))}function Ft(e,t,n){if(void 0===n&&(n=fe),!t)throw Xe(1,t);var o=function(r){for(var o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];return e(t,n,Ut.apply(void 0,i([r],o,!1)))};return o.attrs=function(i){return Ft(e,t,r(r({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},o.withConfig=function(i){return Ft(e,t,r(r({},n),i))},o}var zt=function(e){return Ft(Dt,e)},Bt=zt;pe.forEach((function(e){Bt[e]=zt(e)})),function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=It(e),dt.registerId(this.componentId+1)}e.prototype.createStyles=function(e,t,n,r){var i=r(He(Ct(this.rules,t,n,r)),""),o=this.componentId+e;n.insertRules(o,o,i)},e.prototype.removeStyles=function(e,t){t.clearRules(this.componentId+e)},e.prototype.renderStyles=function(e,t,n,r){e>2&&dt.registerId(this.componentId+e),this.removeStyles(e,n),this.createStyles(e,t,n,r)}}(),function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var n=ot(),r=He([n&&'nonce="'.concat(n,'"'),"".concat(oe,'="true"'),"".concat(se,'="').concat(le,'"')].filter(Boolean)," ");return"<style ".concat(r,">").concat(t,"</style>")},this.getStyleTags=function(){if(e.sealed)throw Xe(2);return e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)throw Xe(2);var n=e.instance.toString();if(!n)return[];var i=((t={})[oe]="",t[se]=le,t.dangerouslySetInnerHTML={__html:n},t),a=ot();return a&&(i.nonce=a),[o.createElement("style",r({},i,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new dt({isServer:!0}),this.sealed=!1}e.prototype.collectStyles=function(e){if(this.sealed)throw Xe(2);return o.createElement(xt,{sheet:this.instance},e)},e.prototype.interleaveWithNodeStream=function(e){throw Xe(3)}}(),"__sc-".concat(oe,"__")},9739:(e,t)=>{"use strict";function n(e,t,n){void 0===n&&(n=!1),n&&(t/=e,e=1);var r,i=[],o=0,a=0,s=function(){var n=o+t,l=Date.now();if(l<n)return void 0!==r&&clearTimeout(r),void(r=setTimeout(s,n-l));o=l,a=0;for(var c=0,u=i.splice(0,e);c<u.length;c++){var h=u[c];a++,h()}r=i.length?setTimeout(s,t):void 0};return function(n){return new Promise((function(l,c){var u=function(){return Promise.resolve().then(n).then(l).catch(c)},h=Date.now();void 0===r&&h-o>t&&(o=h,a=0),a++<e?u():(i.push(u),void 0===r&&(r=setTimeout(s,o+t-h)))}))}}Object.defineProperty(t,"__esModule",{value:!0}),e.exports=n,t.default=n},5215:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__assign:()=>o,__asyncDelegator:()=>_,__asyncGenerator:()=>b,__asyncValues:()=>w,__await:()=>y,__awaiter:()=>u,__classPrivateFieldGet:()=>A,__classPrivateFieldSet:()=>M,__createBinding:()=>d,__decorate:()=>s,__exportStar:()=>f,__extends:()=>i,__generator:()=>h,__importDefault:()=>E,__importStar:()=>S,__makeTemplateObject:()=>x,__metadata:()=>c,__param:()=>l,__read:()=>m,__rest:()=>a,__spread:()=>g,__spreadArrays:()=>v,__values:()=>p});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function h(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function d(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}function f(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function v(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function b(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(l,c):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=p(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function E(e){return e&&e.__esModule?e:{default:e}}function A(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function M(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},4100:function(e,t){!function(e){"use strict";class t{constructor(e){this.controller_=e}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class n{constructor(e){this.target=e}}class r extends n{constructor(e,t,n,r){super(e),this.value=t,this.presetKey=n,this.last=null==r||r}}class i extends n{constructor(e,t,n){super(e),this.value=t,this.presetKey=n}}class o extends n{constructor(e,t){super(e),this.expanded=t}}class a extends n{constructor(e,t){super(e),this.index=t}}function s(e){return null==e}function l(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function c(e,t){let n=e;do{const e=Object.getOwnPropertyDescriptor(n,t);if(e&&(void 0!==e.set||!0===e.writable))return!0;n=Object.getPrototypeOf(n)}while(null!==n);return!1}const u={alreadydisposed:()=>"View has been already disposed",invalidparams:e=>`Invalid parameters for '${e.name}'`,nomatchingcontroller:e=>`No matching controller for '${e.key}'`,nomatchingview:e=>`No matching view for '${JSON.stringify(e.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:e=>`Property '${e.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class h{static alreadyDisposed(){return new h({type:"alreadydisposed"})}static notBindable(){return new h({type:"notbindable"})}static propertyNotFound(e){return new h({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new h({type:"shouldneverhappen"})}constructor(e){var t;this.message=null!==(t=u[e.type](e.context))&&void 0!==t?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}}class d{constructor(e,t,n){this.obj_=e,this.key_=t,this.presetKey_=null!=n?n:t}static isBindable(e){return null!==e&&("object"==typeof e||"function"==typeof e)}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(e){this.obj_[this.key_]=e}writeProperty(e,t){const n=this.read();if(!d.isBindable(n))throw h.notBindable();if(!(e in n))throw h.propertyNotFound(e);n[e]=t}}class f extends t{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get title(){var e;return null!==(e=this.controller_.valueController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.valueController.props.set("title",e)}on(e,t){const r=t.bind(this);return this.controller_.valueController.emitter.on(e,(()=>{r(new n(this))})),this}}class p{constructor(){this.observers_={}}on(e,t){let n=this.observers_[e];return n||(n=this.observers_[e]=[]),n.push({handler:t}),this}off(e,t){const n=this.observers_[e];return n&&(this.observers_[e]=n.filter((e=>e.handler!==t))),this}emit(e,t){const n=this.observers_[e];n&&n.forEach((e=>{e.handler(t)}))}}const m="tp";function g(e){return(t,n)=>[m,"-",e,"v",t?`_${t}`:"",n?`-${n}`:""].join("")}function v(e){return e.rawValue}function y(e,t){var n,r;e.emitter.on("change",(n=v,r=t,e=>r(n(e)))),t(e.rawValue)}function b(e,t,n){y(e.value(t),n)}function _(e,t){return n=>{!function(e,t,n){n?e.classList.add(t):e.classList.remove(t)}(e,t,n)}}function w(e,t){y(e,(e=>{t.textContent=null!=e?e:""}))}const x=g("btn");class S{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(x()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("button");n.classList.add(x("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=e.createElement("div");r.classList.add(x("t")),w(t.props.value("title"),r),this.buttonElement.appendChild(r)}}class E{constructor(e,t){this.emitter=new p,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new S(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class A{constructor(e,t){var n;this.constraint_=null==t?void 0:t.constraint,this.equals_=null!==(n=null==t?void 0:t.equals)&&void 0!==n?n:(e,t)=>e===t,this.emitter=new p,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(e):e,i=this.rawValue_;(!this.equals_(i,r)||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:n,previousRawValue:i,rawValue:r,sender:this}))}}class M{constructor(e){this.emitter=new p,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const n=null!=t?t:{forceEmit:!1,last:!0},r=this.value_;(r!==e||n.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:n,previousRawValue:r,rawValue:this.value_,sender:this}))}}function T(e,t){const n=null==t?void 0:t.constraint,r=null==t?void 0:t.equals;return n||r?new A(e,t):new M(e)}class C{constructor(e){this.emitter=new p,this.valMap_=e;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",(()=>{this.emitter.emit("change",{key:e,sender:this})}))}static createCore(e){return Object.keys(e).reduce(((t,n)=>Object.assign(t,{[n]:T(e[n])})),{})}static fromObject(e){const t=this.createCore(e);return new C(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}function I(e){return t=>n=>{if(!t&&void 0===n)return{succeeded:!1,value:void 0};if(t&&void 0===n)return{succeeded:!0,value:void 0};const r=e(n);return void 0!==r?{succeeded:!0,value:r}:{succeeded:!1,value:void 0}}}function R(e){return{custom:t=>I(t)(e),boolean:I((e=>"boolean"==typeof e?e:void 0))(e),number:I((e=>"number"==typeof e?e:void 0))(e),string:I((e=>"string"==typeof e?e:void 0))(e),function:I((e=>"function"==typeof e?e:void 0))(e),constant:t=>I((e=>e===t?t:void 0))(e),raw:I((e=>e))(e),object:t=>I((e=>{if(null!==(n=e)&&"object"==typeof n)return function(e,t){return Object.keys(t).reduce(((n,r)=>{if(void 0===n)return;const i=(0,t[r])(e[r]);return i.succeeded?Object.assign(Object.assign({},n),{[r]:i.value}):void 0}),{})}(e,t);var n}))(e),array:t=>I((e=>{if(Array.isArray(e))return n=t,e.reduce(((e,t)=>{if(void 0===e)return;const r=n(t);return r.succeeded&&void 0!==r.value?[...e,r.value]:void 0}),[]);var n}))(e)}}const P={optional:R(!0),required:R(!1)};function L(e,t){const n=P.required.object(t)(e);return n.succeeded?n.value:void 0}function k(e){console.warn([`Missing '${e.key}' of ${e.target} in ${e.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}class D{constructor(e){this.value_=e}static create(e){return[new D(e),(t,n)=>{e.setRawValue(t,n)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const O=g("");function N(e,t){return _(e,O(void 0,t))}class U extends C{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=D.create(T(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,n,r;const i=null!=e?e:{};return new U(C.createCore({disabled:null!==(t=i.disabled)&&void 0!==t&&t,disposed:!1,hidden:null!==(n=i.hidden)&&void 0!==n&&n,parent:null!==(r=i.parent)&&void 0!==r?r:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){y(this.globalDisabled_,N(e,"disabled")),b(this,"hidden",N(e,"hidden"))}bindDisabled(e){y(this.globalDisabled_,(t=>{e.disabled=t}))}bindTabIndex(e){y(this.globalDisabled_,(t=>{e.tabIndex=t?-1:0}))}handleDispose(e){this.value("disposed").emitter.on("change",(t=>{t&&e()}))}getGlobalDisabled_(){const e=this.get("parent");return!!e&&e.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const n=e.previousRawValue;null==n||n.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(t=this.get("parent"))||void 0===t||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const F=g(""),z={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class B{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",(()=>{["veryfirst","first","last","verylast"].forEach((e=>{t.classList.remove(F(void 0,z[e]))})),this.blade.get("positions").forEach((e=>{t.classList.add(F(void 0,z[e]))}))})),this.viewProps.handleDispose((()=>{!function(e){e&&e.parentElement&&e.parentElement.removeChild(e)}(t)}))}get parent(){return this.parent_}set parent(e){this.parent_=e,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):k({key:"parent",target:U.name,place:"BladeController.parent"})}}const V="http://www.w3.org/2000/svg";function j(e){e.offsetHeight}function H(e){return void 0!==e.ontouchstart}function G(){return globalThis.document}const W={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function q(e,t){const n=e.createElementNS(V,"svg");return n.innerHTML=W[t],n}function X(e,t,n){e.insertBefore(t,e.children[n])}function $(e){e.parentElement&&e.parentElement.removeChild(e)}function Y(e){for(;e.children.length>0;)e.removeChild(e.children[0])}function K(e){return e.relatedTarget?e.relatedTarget:"explicitOriginalTarget"in e?e.explicitOriginalTarget:null}const Z=g("lbl");class Q{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Z()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Z("l")),b(t.props,"label",(t=>{s(t)?this.element.classList.add(Z(void 0,"nol")):(this.element.classList.remove(Z(void 0,"nol")),function(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}(n),n.appendChild(function(e,t){const n=e.createDocumentFragment();return t.split("\n").map((t=>e.createTextNode(t))).forEach(((t,r)=>{r>0&&n.appendChild(e.createElement("br")),n.appendChild(t)})),n}(e,t)))})),this.element.appendChild(n),this.labelElement=n;const r=e.createElement("div");r.classList.add(Z("v")),this.element.appendChild(r),this.valueElement=r}}class J extends B{constructor(e,t){const n=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{view:new Q(e,{props:t.props,viewProps:n}),viewProps:n})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const ee={id:"button",type:"blade",accept(e){const t=P,n=L(e,{title:t.required.string,view:t.required.constant("button"),label:t.optional.string});return n?{params:n}:null},controller:e=>new J(e.document,{blade:e.blade,props:C.fromObject({label:e.params.label}),valueController:new E(e.document,{props:C.fromObject({title:e.params.title}),viewProps:e.viewProps})}),api:e=>e.controller instanceof J&&e.controller.valueController instanceof E?new f(e.controller):null};class te extends B{constructor(e){super(e),this.value=e.value}}function ne(){return new C({positions:T([],{equals:l})})}class re extends C{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},n=C.createCore(t);return new re(n)}get styleExpanded(){var e;return null!==(e=this.get("temporaryExpanded"))&&void 0!==e?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const n=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};b(this,"expanded",n),b(this,"temporaryExpanded",n)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function ie(e,t){t.style.height=e.styleHeight}function oe(e,t){e.value("expanded").emitter.on("beforechange",(()=>{if(e.set("completed",!1),s(e.get("expandedHeight"))){const n=function(e,t){let n=0;return function(e,t){const n=e.style.transition;e.style.transition="none",t(),e.style.transition=n}(t,(()=>{e.set("expandedHeight",null),e.set("temporaryExpanded",!0),j(t),n=t.clientHeight,e.set("temporaryExpanded",null),j(t)})),n}(e,t);n>0&&e.set("expandedHeight",n)}e.set("shouldFixHeight",!0),j(t)})),e.emitter.on("change",(()=>{ie(e,t)})),ie(e,t),t.addEventListener("transitionend",(t=>{"height"===t.propertyName&&e.cleanUpTransition()}))}class ae extends t{constructor(e,t){super(e),this.rackApi_=t}}class se{constructor(e){this.emitter=new p,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw h.shouldNeverHappen();const n=void 0!==t?t:this.items_.length;this.items_.splice(n,0,e),this.cache_.add(e);const r=this.extract_(e);r&&(r.emitter.on("add",this.onSubListAdd_),r.emitter.on("remove",this.onSubListRemove_),r.allItems().forEach((e=>{this.cache_.add(e)}))),this.emitter.emit("add",{index:n,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const n=this.extract_(e);n&&(n.emitter.off("add",this.onSubListAdd_),n.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}class le extends t{constructor(e){super(e),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new p,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}refresh(){this.controller_.binding.read()}onBindingChange_(e){const t=e.sender.target.read();this.emitter_.emit("change",{event:new r(this,t,this.controller_.binding.target.presetKey,e.options.last)})}}class ce extends J{constructor(e,t){super(e,t),this.binding=t.binding}}class ue extends t{constructor(e){super(e),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new p,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(e){const t=e.sender.target.read();this.emitter_.emit("update",{event:new i(this,t,this.controller_.binding.target.presetKey)})}}class he extends J{constructor(e,t){super(e,t),this.binding=t.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose((()=>{this.binding.dispose()}))}}function de(e){return e instanceof me?e.apiSet_:e instanceof ae?e.rackApi_.apiSet_:null}function fe(e,t){const n=e.find((e=>e.controller_===t));if(!n)throw h.shouldNeverHappen();return n}function pe(e,t,n){if(!d.isBindable(e))throw h.notBindable();return new d(e,t,n)}class me extends t{constructor(e,t){super(e),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new p,this.apiSet_=new se(de),this.pool_=t;const n=this.controller_.rack;n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),n.emitter.on("inputchange",this.onRackInputChange_),n.emitter.on("monitorupdate",this.onRackMonitorUpdate_),n.children.forEach((e=>{this.setUpApi_(e)}))}get children(){return this.controller_.rack.children.map((e=>fe(this.apiSet_,e)))}addInput(e,t,n){const r=null!=n?n:{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(i,pe(e,t,r.presetKey),r),a=new le(o);return this.add(a,r.index)}addMonitor(e,t,n){const r=null!=n?n:{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(i,pe(e,t),r),a=new ue(o);return this.add(a,r.index)}addFolder(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}(this,e)}addButton(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}(this,e)}addSeparator(e){return function(e,t){const n=null!=t?t:{};return e.addBlade(Object.assign(Object.assign({},n),{view:"separator"}))}(this,e)}addTab(e){return function(e,t){return e.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}(this,e)}add(e,t){this.controller_.rack.add(e.controller_,t);const n=this.apiSet_.find((t=>t.controller_===e.controller_));return n&&this.apiSet_.remove(n),this.apiSet_.add(e),e}remove(e){this.controller_.rack.remove(e.controller_)}addBlade(e){const t=this.controller_.view.element.ownerDocument,n=this.pool_.createBlade(t,e),r=this.pool_.createBladeApi(n);return this.add(r,e.index)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}setUpApi_(e){this.apiSet_.find((t=>t.controller_===e))||this.apiSet_.add(this.pool_.createBladeApi(e))}onRackAdd_(e){this.setUpApi_(e.bladeController)}onRackRemove_(e){if(e.isRoot){const t=fe(this.apiSet_,e.bladeController);this.apiSet_.remove(t)}}onRackInputChange_(e){const t=e.bladeController;if(t instanceof ce){const n=fe(this.apiSet_,t),i=t.binding;this.emitter_.emit("change",{event:new r(n,i.target.read(),i.target.presetKey,e.options.last)})}else if(t instanceof te){const n=fe(this.apiSet_,t);this.emitter_.emit("change",{event:new r(n,t.value.rawValue,void 0,e.options.last)})}}onRackMonitorUpdate_(e){if(!(e.bladeController instanceof he))throw h.shouldNeverHappen();const t=fe(this.apiSet_,e.bladeController),n=e.bladeController.binding;this.emitter_.emit("update",{event:new i(t,n.target.read(),n.target.presetKey)})}}class ge extends ae{constructor(e,t){super(e,new me(e.rackController,t)),this.emitter_=new p,this.controller_.foldable.value("expanded").emitter.on("change",(e=>{this.emitter_.emit("fold",{event:new o(this,e.sender.rawValue)})})),this.rackApi_.on("change",(e=>{this.emitter_.emit("change",{event:e})})),this.rackApi_.on("update",(e=>{this.emitter_.emit("update",{event:e})}))}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(e){this.controller_.foldable.set("expanded",e)}get title(){return this.controller_.props.get("title")}set title(e){this.controller_.props.set("title",e)}get children(){return this.rackApi_.children}addInput(e,t,n){return this.rackApi_.addInput(e,t,n)}addMonitor(e,t,n){return this.rackApi_.addMonitor(e,t,n)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}}class ve extends B{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}}class ye{constructor(e,t){const n=g(t.viewName);this.element=e.createElement("div"),this.element.classList.add(n()),t.viewProps.bindClassModifiers(this.element)}}function be(e){return e instanceof xe?e.rack:e instanceof ve?e.rackController.rack:null}function _e(e){const t=be(e);return t?t.bcSet_:null}class we{constructor(e){var t,n;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new p,this.blade_=null!==(t=e.blade)&&void 0!==t?t:null,null===(n=this.blade_)||void 0===n||n.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new se(_e),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var n;null===(n=e.parent)||void 0===n||n.remove(e),c(e,"parent")?e.parent=this:(e.parent_=this,k({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(e,t)}remove(e){c(e,"parent")?e.parent=null:(e.parent_=null,k({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter((t=>t instanceof e))}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,isRoot:t,sender:this}),!t)return;const n=e.item;if(n.viewProps.emitter.on("change",this.onChildViewPropsChange_),n.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),n.viewProps.handleDispose(this.onChildDispose_),n instanceof ce)n.binding.emitter.on("change",this.onChildInputChange_);else if(n instanceof he)n.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(n instanceof te)n.value.emitter.on("change",this.onChildValueChange_);else{const e=be(n);if(e){const t=e.emitter;t.on("layout",this.onDescendantLayout_),t.on("inputchange",this.onDescendantInputChange_),t.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,isRoot:t,sender:this}),!t)return;const n=e.item;if(n instanceof ce)n.binding.emitter.off("change",this.onChildInputChange_);else if(n instanceof he)n.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(n instanceof te)n.value.emitter.off("change",this.onChildValueChange_);else{const e=be(n);if(e){const t=e.emitter;t.off("layout",this.onDescendantLayout_),t.off("inputchange",this.onDescendantInputChange_),t.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const e=this.bcSet_.items.filter((e=>!e.viewProps.get("hidden"))),t=e[0],n=e[e.length-1];this.bcSet_.items.forEach((e=>{const r=[];e===t&&(r.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||r.push("veryfirst")),e===n&&(r.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||r.push("verylast")),e.blade.set("positions",r)}))}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter((e=>e.viewProps.get("disposed"))).forEach((e=>{this.bcSet_.remove(e)}))}onChildInputChange_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r instanceof ce&&r.binding===t)return r}return null}(this.find(ce),e.sender);if(!t)throw h.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:t,options:e.options,sender:this})}onChildMonitorUpdate_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r instanceof he&&r.binding===t)return r}return null}(this.find(he),e.sender);if(!t)throw h.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:t,sender:this})}onChildValueChange_(e){const t=function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r instanceof te&&r.value===t)return r}return null}(this.find(te),e.sender);if(!t)throw h.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:t,options:e.options,sender:this})}onDescendantLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(e){this.emitter.emit("inputchange",{bladeController:e.bladeController,options:e.options,sender:this})}onDescendantMonitorUpdate_(e){this.emitter.emit("monitorupdate",{bladeController:e.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class xe extends B{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new ye(e,{viewName:"brk",viewProps:t.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const n=new we({blade:t.root?void 0:t.blade,viewProps:t.viewProps});n.emitter.on("add",this.onRackAdd_),n.emitter.on("remove",this.onRackRemove_),this.rack=n,this.viewProps.handleDispose((()=>{for(let e=this.rack.children.length-1;e>=0;e--)this.rack.children[e].viewProps.set("disposed",!0)}))}onRackAdd_(e){e.isRoot&&X(this.view.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.isRoot&&$(e.bladeController.view.element)}}const Se=g("cnt");class Ee{constructor(e,t){var n;this.className_=g(null!==(n=t.viewName)&&void 0!==n?n:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Se()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),b(this.foldable_,"completed",_(this.element,this.className_(void 0,"cpl")));const r=e.createElement("button");r.classList.add(this.className_("b")),b(t.props,"title",(e=>{s(e)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))})),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const i=e.createElement("div");i.classList.add(this.className_("i")),this.element.appendChild(i);const o=e.createElement("div");o.classList.add(this.className_("t")),w(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const a=e.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);const l=t.containerElement;l.classList.add(this.className_("c")),this.element.appendChild(l),this.containerElement=l}}class Ae extends ve{constructor(e,t){var n;const r=re.create(null===(n=t.expanded)||void 0===n||n),i=new xe(e,{blade:t.blade,root:t.root,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:i,view:new Ee(e,{containerElement:i.view.element,foldable:r,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=r,oe(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",(()=>{this.foldable.cleanUpTransition()})),this.rackController.rack.emitter.on("remove",(()=>{this.foldable.cleanUpTransition()})),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Me={id:"folder",type:"blade",accept(e){const t=P,n=L(e,{title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean});return n?{params:n}:null},controller:e=>new Ae(e.document,{blade:e.blade,expanded:e.params.expanded,props:C.fromObject({title:e.params.title}),viewProps:e.viewProps}),api:e=>e.controller instanceof Ae?new ge(e.controller,e.pool):null};class Te extends te{constructor(e,t){const n=t.valueController.viewProps;super(Object.assign(Object.assign({},t),{value:t.valueController.value,view:new Q(e,{props:t.props,viewProps:n}),viewProps:n})),this.props=t.props,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Ce extends t{}const Ie=g("spr");class Re{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ie()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("hr");n.classList.add(Ie("r")),this.element.appendChild(n)}}class Pe extends B{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new Re(e,{viewProps:t.viewProps})}))}}const Le={id:"separator",type:"blade",accept(e){const t=L(e,{view:P.required.constant("separator")});return t?{params:t}:null},controller:e=>new Pe(e.document,{blade:e.blade,viewProps:e.viewProps}),api:e=>e.controller instanceof Pe?new Ce(e.controller):null},ke=g("tbi");class De{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ke()),t.viewProps.bindClassModifiers(this.element),b(t.props,"selected",(e=>{e?this.element.classList.add(ke(void 0,"sel")):this.element.classList.remove(ke(void 0,"sel"))}));const n=e.createElement("button");n.classList.add(ke("b")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const r=e.createElement("div");r.classList.add(ke("t")),w(t.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r}}class Oe{constructor(e,t){this.emitter=new p,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new De(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Ne{constructor(e,t){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Oe(e,{props:t.itemProps,viewProps:U.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new xe(e,{blade:ne(),viewProps:U.create()}),this.props=t.props,b(this.props,"selected",(e=>{this.itemController.props.set("selected",e),this.contentController.viewProps.set("hidden",!e)}))}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Ue{constructor(e,t){this.controller_=e,this.rackApi_=t}get title(){var e;return null!==(e=this.controller_.itemController.props.get("title"))&&void 0!==e?e:""}set title(e){this.controller_.itemController.props.set("title",e)}get selected(){return this.controller_.props.get("selected")}set selected(e){this.controller_.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addInput(e,t,n){return this.rackApi_.addInput(e,t,n)}addMonitor(e,t,n){return this.rackApi_.addMonitor(e,t,n)}addBlade(e){return this.rackApi_.addBlade(e)}}class Fe extends ae{constructor(e,t){super(e,new me(e.rackController,t)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new p,this.pageApiMap_=new Map,this.rackApi_.on("change",(e=>{this.emitter_.emit("change",{event:e})})),this.rackApi_.on("update",(e=>{this.emitter_.emit("update",{event:e})})),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach((e=>{this.setUpPageApi_(e)}))}get pages(){return this.controller_.pageSet.items.map((e=>{const t=this.pageApiMap_.get(e);if(!t)throw h.shouldNeverHappen();return t}))}addPage(e){const t=this.controller_.view.element.ownerDocument,n=new Ne(t,{itemProps:C.fromObject({selected:!1,title:e.title}),props:C.fromObject({selected:!1})});this.controller_.add(n,e.index);const r=this.pageApiMap_.get(n);if(!r)throw h.shouldNeverHappen();return r}removePage(e){this.controller_.remove(e)}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}setUpPageApi_(e){const t=this.rackApi_.apiSet_.find((t=>t.controller_===e.contentController));if(!t)throw h.shouldNeverHappen();const n=new Ue(e,t);this.pageApiMap_.set(e,n)}onPageAdd_(e){this.setUpPageApi_(e.item)}onPageRemove_(e){if(!this.pageApiMap_.get(e.item))throw h.shouldNeverHappen();this.pageApiMap_.delete(e.item)}onSelect_(e){this.emitter_.emit("select",{event:new a(this,e.rawValue)})}}class ze{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=T(!0),this.selectedIndex=T(-1),this.items_=[]}add(e,t){const n=null!=t?t:this.items_.length;this.items_.splice(n,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const e=this.items_.findIndex((e=>e.rawValue));e<0?(this.items_.forEach(((e,t)=>{e.rawValue=0===t})),this.selectedIndex.rawValue=0):(this.items_.forEach(((t,n)=>{t.rawValue=n===e})),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex((t=>t===e.sender));this.items_.forEach(((e,n)=>{e.rawValue=n===t})),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const Be=g("tab");class Ve{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Be(),Se()),t.viewProps.bindClassModifiers(this.element),y(t.empty,_(this.element,Be(void 0,"nop")));const n=e.createElement("div");n.classList.add(Be("t")),this.element.appendChild(n),this.itemsElement=n;const r=e.createElement("div");r.classList.add(Be("i")),this.element.appendChild(r);const i=t.contentsElement;i.classList.add(Be("c")),this.element.appendChild(i),this.contentsElement=i}}class je extends ve{constructor(e,t){const n=new xe(e,{blade:t.blade,viewProps:t.viewProps}),r=new ze;super({blade:t.blade,rackController:n,view:new Ve(e,{contentsElement:n.view.element,empty:r.empty,viewProps:t.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new se((()=>null)),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=r}get pageSet(){return this.pageSet_}add(e,t){this.pageSet_.add(e,t)}remove(e){this.pageSet_.remove(this.pageSet_.items[e])}onPageAdd_(e){const t=e.item;X(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(t.contentController,e.index),this.tab.add(t.props.value("selected"))}onPageRemove_(e){const t=e.item;$(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.rackController.rack.remove(t.contentController),this.tab.remove(t.props.value("selected"))}}const He={id:"tab",type:"blade",accept(e){const t=P,n=L(e,{pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")});return n&&0!==n.pages.length?{params:n}:null},controller(e){const t=new je(e.document,{blade:e.blade,viewProps:e.viewProps});return e.params.pages.forEach((n=>{const r=new Ne(e.document,{itemProps:C.fromObject({selected:!1,title:n.title}),props:C.fromObject({selected:!1})});t.add(r)})),t},api:e=>e.controller instanceof je?new Fe(e.controller,e.pool):null};class Ge{constructor(){this.disabled=!1,this.emitter=new p}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class We{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new p,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class qe{constructor(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new p,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}read(){const e=this.target.read();void 0!==e&&(this.value.rawValue=this.reader(e))}write_(e){this.writer(this.target,e)}onValueChange_(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})}}function Xe(e,t){for(;e.length<t;)e.push(void 0)}function $e(e){const t=[];return Xe(t,e),T(t)}function Ye(e){const t=e.indexOf(void 0);return t<0?e:e.slice(0,t)}class Ke{constructor(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new p,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const e=this.target.read();if(void 0===e)return;const t=this.value.rawValue,n=this.reader_(e);this.value.rawValue=function(e,t){const n=[...Ye(e),t];return n.length>e.length?n.splice(0,n.length-e.length):Xe(n,e.length),n}(t,n),this.emitter.emit("update",{rawValue:n,sender:this})}onTick_(e){this.read()}}class Ze{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce(((e,t)=>t.constrain(e)),e)}}function Qe(e,t){if(e instanceof t)return e;if(e instanceof Ze){const n=e.constraints.reduce(((e,n)=>e||(n instanceof t?n:null)),null);if(n)return n}return null}class Je{constructor(e){this.values=C.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),n=this.values.get("min");return Math.min(Math.max(e,n),t)}}class et{constructor(e){this.values=C.fromObject({options:e})}get options(){return this.values.get("options")}constrain(e){const t=this.values.get("options");return 0===t.length||t.filter((t=>t.value===e)).length>0?e:t[0].value}}class tt{constructor(e){this.values=C.fromObject({max:e.max,min:e.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(e){const t=this.values.get("max"),n=this.values.get("min");let r=e;return s(n)||(r=Math.max(r,n)),s(t)||(r=Math.min(r,t)),r}}class nt{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step;return t+Math.round((e-t)/this.step)*this.step}}const rt=g("lst");class it{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(rt()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("select");n.classList.add(rt("s")),t.viewProps.bindDisabled(n),this.element.appendChild(n),this.selectElement=n;const r=e.createElement("div");r.classList.add(rt("m")),r.appendChild(q(e,"dropdown")),this.element.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,b(this.props_,"options",(t=>{Y(this.selectElement),t.forEach((t=>{const n=e.createElement("option");n.textContent=t.text,this.selectElement.appendChild(n)})),this.update_()}))}update_(){const e=this.props_.get("options").map((e=>e.value));this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class ot{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new it(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}}const at=g("pop");class st{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(at()),t.viewProps.bindClassModifiers(this.element),y(t.shows,_(this.element,at(void 0,"v")))}}class lt{constructor(e,t){this.shows=T(!1),this.viewProps=t.viewProps,this.view=new st(e,{shows:this.shows,viewProps:this.viewProps})}}const ct=g("txt");class ut{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ct()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const n=e.createElement("input");n.classList.add(ct("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class ht{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new ut(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);s(n)||(this.value.rawValue=n),this.view.refresh()}}function dt(e){return"false"!==e&&!!e}function ft(e){return function(e){return String(e)}(e)}class pt{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const mt={"**":(e,t)=>Math.pow(e,t),"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t,"&":(e,t)=>e&t,"^":(e,t)=>e^t,"|":(e,t)=>e|t};class gt{constructor(e,t,n){this.left=t,this.operator=e,this.right=n}evaluate(){const e=mt[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const vt={"+":e=>e,"-":e=>-e,"~":e=>~e};class yt{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=vt[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function bt(e){return(t,n)=>{for(let r=0;r<e.length;r++){const i=e[r](t,n);if(""!==i)return i}return""}}function _t(e,t){var n;const r=e.substr(t).match(/^\s+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function wt(e,t){var n;const r=e.substr(t).match(/^[0-9]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}function xt(e,t){const n=e.substr(t,1);if(t+=1,"e"!==n.toLowerCase())return"";const r=function(e,t){const n=wt(e,t);if(""!==n)return n;const r=e.substr(t,1);if("-"!==r&&"+"!==r)return"";const i=wt(e,t+=1);return""===i?"":r+i}(e,t);return""===r?"":n+r}function St(e,t){const n=e.substr(t,1);if("0"===n)return n;const r=function(e,t){const n=e.substr(t,1);return n.match(/^[1-9]$/)?n:""}(e,t);return t+=r.length,""===r?"":r+wt(e,t)}const Et=bt([function(e,t){const n=St(e,t);if(t+=n.length,""===n)return"";const r=e.substr(t,1);if(t+=r.length,"."!==r)return"";const i=wt(e,t);return n+r+i+xt(e,t+=i.length)},function(e,t){const n=e.substr(t,1);if(t+=n.length,"."!==n)return"";const r=wt(e,t);return t+=r.length,""===r?"":n+r+xt(e,t)},function(e,t){const n=St(e,t);return t+=n.length,""===n?"":n+xt(e,t)}]);const At=bt([function(e,t){const n=e.substr(t,2);if(t+=n.length,"0b"!==n.toLowerCase())return"";const r=function(e,t){var n;const r=e.substr(t).match(/^[01]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}(e,t);return""===r?"":n+r},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0o"!==n.toLowerCase())return"";const r=function(e,t){var n;const r=e.substr(t).match(/^[0-7]+/);return null!==(n=r&&r[0])&&void 0!==n?n:""}(e,t);return""===r?"":n+r},function(e,t){const n=e.substr(t,2);if(t+=n.length,"0x"!==n.toLowerCase())return"";const r=function(e,t){var n;const r=e.substr(t).match(/^[0-9a-f]+/i);return null!==(n=r&&r[0])&&void 0!==n?n:""}(e,t);return""===r?"":n+r}]),Mt=bt([At,Et]);function Tt(e,t){var n;return null!==(n=function(e,t){const n=Mt(e,t);return t+=n.length,""===n?null:{evaluable:new pt(n),cursor:t}}(e,t))&&void 0!==n?n:function(e,t){const n=e.substr(t,1);if(t+=n.length,"("!==n)return null;const r=Rt(e,t);if(!r)return null;t=r.cursor,t+=_t(e,t).length;const i=e.substr(t,1);return t+=i.length,")"!==i?null:{evaluable:r.evaluable,cursor:t}}(e,t)}function Ct(e,t,n){n+=_t(t,n).length;const r=e.filter((e=>t.startsWith(e,n)))[0];return r?(n+=r.length,{cursor:n+=_t(t,n).length,operator:r}):null}const It=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce(((e,t)=>function(e,t){return(n,r)=>{const i=e(n,r);if(!i)return null;r=i.cursor;let o=i.evaluable;for(;;){const i=Ct(t,n,r);if(!i)break;r=i.cursor;const a=e(n,r);if(!a)return null;r=a.cursor,o=new gt(i.operator,o,a.evaluable)}return o?{cursor:r,evaluable:o}:null}}(e,t)),(function e(t,n){const r=Tt(t,n);if(r)return r;const i=t.substr(n,1);if(n+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const o=e(t,n);return o?{cursor:n=o.cursor,evaluable:new yt(i,o.evaluable)}:null}));function Rt(e,t){return t+=_t(e,t).length,It(e,t)}function Pt(e){var t;const n=function(e){const t=Rt(e,0);return t?t.cursor+_t(e,t.cursor).length!==e.length?null:t.evaluable:null}(e);return null!==(t=null==n?void 0:n.evaluate())&&void 0!==t?t:null}function Lt(e){if("number"==typeof e)return e;if("string"==typeof e){const t=Pt(e);if(!s(t))return t}return 0}function kt(e){return String(e)}function Dt(e){return t=>t.toFixed(Math.max(Math.min(e,20),0))}const Ot=Dt(0);function Nt(e){return Ot(e)+"%"}function Ut(e){return String(e)}function Ft(e){return e}function zt({primary:e,secondary:t,forward:n,backward:r}){let i=!1;function o(e){i||(i=!0,e(),i=!1)}e.emitter.on("change",(r=>{o((()=>{t.setRawValue(n(e,t),r.options)}))})),t.emitter.on("change",(i=>{o((()=>{e.setRawValue(r(e,t),i.options)})),o((()=>{t.setRawValue(n(e,t),i.options)}))})),o((()=>{t.setRawValue(n(e,t),{forceEmit:!1,last:!0})}))}function Bt(e,t){const n=e*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+n:t.downKey?-n:0}function Vt(e){return{altKey:e.altKey,downKey:"ArrowDown"===e.key,shiftKey:e.shiftKey,upKey:"ArrowUp"===e.key}}function jt(e){return{altKey:e.altKey,downKey:"ArrowLeft"===e.key,shiftKey:e.shiftKey,upKey:"ArrowRight"===e.key}}function Ht(e){return function(e){return"ArrowUp"===e||"ArrowDown"===e}(e)||"ArrowLeft"===e||"ArrowRight"===e}function Gt(e,t){var n,r;const i=t.ownerDocument.defaultView,o=t.getBoundingClientRect();return{x:e.pageX-((null!==(n=i&&i.scrollX)&&void 0!==n?n:0)+o.left),y:e.pageY-((null!==(r=i&&i.scrollY)&&void 0!==r?r:0)+o.top)}}class Wt{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new p,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),null===(t=e.currentTarget)||void 0===t||t.focus();const n=this.elem_.ownerDocument;n.addEventListener("mousemove",this.onDocumentMouseMove_),n.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Gt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Gt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Gt(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),n=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-n.left,y:t.clientY-n.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const n=null!==(t=e.targetTouches.item(0))&&void 0!==t?t:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(n?{x:n.clientX-r.left,y:n.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function qt(e,t,n,r,i){return r+(e-t)/(n-t)*(i-r)}function Xt(e){return String(e.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function $t(e,t,n){return Math.min(Math.max(e,t),n)}function Yt(e,t){return(e%t+t)%t}const Kt=g("txt");class Zt{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Kt(),Kt(void 0,"num")),t.arrayPosition&&this.element.classList.add(Kt(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(Kt("i")),n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Kt()),this.inputElement.classList.add(Kt("i"));const r=e.createElement("div");r.classList.add(Kt("k")),this.element.appendChild(r),this.knobElement=r;const i=e.createElementNS(V,"svg");i.classList.add(Kt("g")),this.knobElement.appendChild(i);const o=e.createElementNS(V,"path");o.classList.add(Kt("gb")),i.appendChild(o),this.guideBodyElem_=o;const a=e.createElementNS(V,"path");a.classList.add(Kt("gh")),i.appendChild(a),this.guideHeadElem_=a;const s=e.createElement("div");s.classList.add(g("tt")()),this.knobElement.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(null===e.rawValue)return void this.element.classList.remove(Kt(void 0,"drg"));this.element.classList.add(Kt(void 0,"drg"));const t=e.rawValue/this.props_.get("draggingScale"),n=t+(t>0?-1:t<0?1:0),r=$t(-n,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${n+r},0 L${n},4 L${n+r},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const i=this.props_.get("formatter");this.tooltipElem_.textContent=i(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Qt{constructor(e,t){var n;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.parser_=t.parser,this.props=t.props,this.sliderProps_=null!==(n=t.sliderProps)&&void 0!==n?n:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=T(null),this.view=new Zt(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const r=new Wt(this.view.knobElement);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,n;const r=null===(t=this.sliderProps_)||void 0===t?void 0:t.get("minValue"),i=null===(n=this.sliderProps_)||void 0===n?void 0:n.get("maxValue");let o=e;return void 0!==r&&(o=Math.max(o,r)),void 0!==i&&(o=Math.min(o,i)),o}onInputChange_(e){const t=e.currentTarget.value,n=this.parser_(t);s(n)||(this.value.rawValue=this.constrainValue_(n)),this.view.refresh()}onInputKeyDown_(e){const t=Bt(this.baseStep_,Vt(e));0!==t&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){0!==Bt(this.baseStep_,Vt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("draggingScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);null!==t&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Jt=g("sld");class en{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Jt()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Jt("t")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.trackElement=n;const r=e.createElement("div");r.classList.add(Jt("k")),this.trackElement.appendChild(r),this.knobElement=r,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=$t(qt(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class tn{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=t.baseStep,this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new en(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(qt($t(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Bt(this.baseStep_,jt(e));0!==t&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Bt(this.baseStep_,jt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const nn=g("sldtxt");class rn{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nn());const n=e.createElement("div");n.classList.add(nn("s")),this.sliderView_=t.sliderView,n.appendChild(this.sliderView_.element),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(nn("t")),this.textView_=t.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}}class on{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new tn(e,{baseStep:t.baseStep,props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Qt(e,{baseStep:t.baseStep,parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new rn(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function an(e,t){e.write(t)}function sn(e){const t=P;return Array.isArray(e)?t.required.array(t.required.object({text:t.required.string,value:t.required.raw}))(e).value:"object"==typeof e?t.required.raw(e).value:void 0}function ln(e){if("inline"===e||"popup"===e)return e}function cn(e){const t=P;return t.required.object({max:t.optional.number,min:t.optional.number,step:t.optional.number})(e).value}function un(e){if(Array.isArray(e))return e;const t=[];return Object.keys(e).forEach((n=>{t.push({text:n,value:e[n]})})),t}function hn(e){return s(e)?null:new et(un(e))}function dn(e,t){const n=e&&Qe(e,nt);return n?Xt(n.step):Math.max(Xt(t),2)}function fn(e){const t=function(e){const t=e?Qe(e,nt):null;return t?t.step:null}(e);return null!=t?t:1}function pn(e,t){var n;const r=e&&Qe(e,nt),i=Math.abs(null!==(n=null==r?void 0:r.step)&&void 0!==n?n:t);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}const mn=g("ckb");class gn{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(mn()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("label");n.classList.add(mn("l")),this.element.appendChild(n);const r=e.createElement("input");r.classList.add(mn("i")),r.type="checkbox",n.appendChild(r),this.inputElement=r,t.viewProps.bindDisabled(this.inputElement);const i=e.createElement("div");i.classList.add(mn("w")),n.appendChild(i);const o=q(e,"check");i.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class vn{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new gn(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}}const yn={id:"input-bool",type:"input",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=L(t,{options:P.optional.custom(sn)});return n?{initialValue:e,params:n}:null},binding:{reader:e=>dt,constraint:e=>function(e){const t=[],n=hn(e.options);return n&&t.push(n),new Ze(t)}(e.params),writer:e=>an},controller:e=>{const t=e.document,n=e.value,r=e.constraint,i=r&&Qe(r,et);return i?new ot(t,{props:new C({options:i.values.value("options")}),value:n,viewProps:e.viewProps}):new vn(t,{value:n,viewProps:e.viewProps})}},bn=g("col");class _n{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(bn()),t.foldable.bindExpandedClass(this.element,bn(void 0,"expanded")),b(t.foldable,"completed",_(this.element,bn(void 0,"cpl")));const n=e.createElement("div");n.classList.add(bn("h")),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(bn("s")),n.appendChild(r),this.swatchElement=r;const i=e.createElement("div");if(i.classList.add(bn("t")),n.appendChild(i),this.textElement=i,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(bn("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}function wn(e,t,n){const r=Yt(e,360),i=$t(t/100,0,1),o=$t(n/100,0,1),a=o*i,s=a*(1-Math.abs(r/60%2-1)),l=o-a;let c,u,h;return[c,u,h]=r>=0&&r<60?[a,s,0]:r>=60&&r<120?[s,a,0]:r>=120&&r<180?[0,a,s]:r>=180&&r<240?[0,s,a]:r>=240&&r<300?[s,0,a]:[a,0,s],[255*(c+l),255*(u+l),255*(h+l)]}function xn(e){return[e[0],e[1],e[2]]}function Sn(e,t){return[e[0],e[1],e[2],t]}const En={hsl:{hsl:(e,t,n)=>[e,t,n],hsv:function(e,t,n){const r=n+t*(100-Math.abs(2*n-100))/200;return[e,0!==r?t*(100-Math.abs(2*n-100))/r:0,n+t*(100-Math.abs(2*n-100))/200]},rgb:function(e,t,n){const r=(e%360+360)%360,i=$t(t/100,0,1),o=$t(n/100,0,1),a=(1-Math.abs(2*o-1))*i,s=a*(1-Math.abs(r/60%2-1)),l=o-a/2;let c,u,h;return[c,u,h]=r>=0&&r<60?[a,s,0]:r>=60&&r<120?[s,a,0]:r>=120&&r<180?[0,a,s]:r>=180&&r<240?[0,s,a]:r>=240&&r<300?[s,0,a]:[a,0,s],[255*(c+l),255*(u+l),255*(h+l)]}},hsv:{hsl:function(e,t,n){const r=100-Math.abs(n*(200-t)/100-100);return[e,0!==r?t*n/r:0,n*(200-t)/200]},hsv:(e,t,n)=>[e,t,n],rgb:wn},rgb:{hsl:function(e,t,n){const r=$t(e/255,0,1),i=$t(t/255,0,1),o=$t(n/255,0,1),a=Math.max(r,i,o),s=Math.min(r,i,o),l=a-s;let c=0,u=0;const h=(s+a)/2;return 0!==l&&(u=l/(1-Math.abs(a+s-1)),c=r===a?(i-o)/l:i===a?2+(o-r)/l:4+(r-i)/l,c=c/6+(c<0?1:0)),[360*c,100*u,100*h]},hsv:function(e,t,n){const r=$t(e/255,0,1),i=$t(t/255,0,1),o=$t(n/255,0,1),a=Math.max(r,i,o),s=a-Math.min(r,i,o);let l;return l=0===s?0:a===r?((i-o)/s%6+6)%6*60:a===i?60*((o-r)/s+2):60*((r-i)/s+4),[l,100*(0===a?0:s/a),100*a]},rgb:(e,t,n)=>[e,t,n]}};function An(e,t){return["float"===t?1:"rgb"===e?255:360,"float"===t?1:"rgb"===e?255:100,"float"===t?1:"rgb"===e?255:100]}function Mn(e,t,n,r){const i=An(t,n),o=An(t,r);return e.map(((e,t)=>e/i[t]*o[t]))}function Tn(e,t){return"object"==typeof e&&!s(e)&&t in e&&"number"==typeof e[t]}class Cn{static black(e="int"){return new Cn([0,0,0],"rgb",e)}static fromObject(e,t="int"){const n="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new Cn(n,"rgb",t)}static toRgbaObject(e,t="int"){return e.toRgbaObject(t)}static isRgbColorObject(e){return Tn(e,"r")&&Tn(e,"g")&&Tn(e,"b")}static isRgbaColorObject(e){return this.isRgbColorObject(e)&&Tn(e,"a")}static isColorObject(e){return this.isRgbColorObject(e)}static equals(e,t){if(e.mode!==t.mode)return!1;const n=e.comps_,r=t.comps_;for(let e=0;e<n.length;e++)if(n[e]!==r[e])return!1;return!0}constructor(e,t,n="int"){this.mode=t,this.type=n,this.comps_=function(e,t,n){var r;const i=An(t,n);return["rgb"===t?$t(e[0],0,i[0]):(o=e[0],a=i[0],o===a?a:Yt(o,a)),$t(e[1],0,i[1]),$t(e[2],0,i[2]),$t(null!==(r=e[3])&&void 0!==r?r:1,0,1)];var o,a}(e,t,n)}getComponents(e,t="int"){return Sn(function(e,t,n){const r=Mn(e,t.mode,t.type,"int");return Mn(En[t.mode][n.mode](...r),n.mode,"int",n.type)}(xn(this.comps_),{mode:this.mode,type:this.type},{mode:null!=e?e:this.mode,type:t}),this.comps_[3])}toRgbaObject(e="int"){const t=this.getComponents("rgb",e);return{r:t[0],g:t[1],b:t[2],a:t[3]}}}const In=g("colp");class Rn{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(In()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(In("hsv"));const r=e.createElement("div");r.classList.add(In("sv")),this.svPaletteView_=t.svPaletteView,r.appendChild(this.svPaletteView_.element),n.appendChild(r);const i=e.createElement("div");i.classList.add(In("h")),this.hPaletteView_=t.hPaletteView,i.appendChild(this.hPaletteView_.element),n.appendChild(i),this.element.appendChild(n);const o=e.createElement("div");if(o.classList.add(In("rgb")),this.textView_=t.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const n=e.createElement("div");n.classList.add(In("a"));const r=e.createElement("div");r.classList.add(In("ap")),r.appendChild(this.alphaViews_.palette.element),n.appendChild(r);const i=e.createElement("div");i.classList.add(In("at")),i.appendChild(this.alphaViews_.text.element),n.appendChild(i),this.element.appendChild(n)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map((e=>e.inputElement))];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function Pn(e){return"int"===e?"int":"float"===e?"float":void 0}function Ln(e){const t=P;return L(e,{alpha:t.optional.boolean,color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(Pn)}),expanded:t.optional.boolean,picker:t.optional.custom(ln)})}function kn(e){return e?.1:1}function Dn(e){var t;return null===(t=e.color)||void 0===t?void 0:t.type}function On(e,t){const n=e.match(/^(.+)%$/);return n?Math.min(.01*parseFloat(n[1])*t,t):Math.min(parseFloat(e),t)}const Nn={deg:e=>e,grad:e=>360*e/400,rad:e=>360*e/(2*Math.PI),turn:e=>360*e};function Un(e){const t=e.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(e);const n=parseFloat(t[1]),r=t[2];return Nn[r](n)}function Fn(e){const t=e.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[On(t[1],255),On(t[2],255),On(t[3],255)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function zn(e){return t=>{const n=Fn(t);return n?new Cn(n,"rgb",e):null}}function Bn(e){const t=e.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[On(t[1],255),On(t[2],255),On(t[3],255),On(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Vn(e){return t=>{const n=Bn(t);return n?new Cn(n,"rgb",e):null}}function jn(e){const t=e.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Un(t[1]),On(t[2],100),On(t[3],100)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Hn(e){return t=>{const n=jn(t);return n?new Cn(n,"hsl",e):null}}function Gn(e){const t=e.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const n=[Un(t[1]),On(t[2],100),On(t[3],100),On(t[4],1)];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Wn(e){return t=>{const n=Gn(t);return n?new Cn(n,"hsl",e):null}}function qn(e){const t=e.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const n=e.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null}function Xn(e){const t=e.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),qt(parseInt(t[4]+t[4],16),0,255,0,1)];const n=e.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16),qt(parseInt(n[4],16),0,255,0,1)]:null}function $n(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function Yn(e){return t=>{const n=$n(t);return n?new Cn(n,"rgb",e):null}}function Kn(e){const t=e.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const n=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(n[3])?null:n}function Zn(e){return t=>{const n=Kn(t);return n?new Cn(n,"rgb",e):null}}const Qn=[{parser:qn,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Xn,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Fn,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Bn,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:jn,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Gn,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:$n,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Kn,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Jn(e,t="int"){const n=function(e){return Qn.reduce(((t,{parser:n,result:r})=>t||(n(e)?r:null)),null)}(e);return n?"hex"===n.notation&&"float"!==t?Object.assign(Object.assign({},n),{type:"int"}):"func"===n.notation?Object.assign(Object.assign({},n),{type:t}):null:null}const er={int:[function(e){const t=qn(e);return t?new Cn(t,"rgb","int"):null},function(e){const t=Xn(e);return t?new Cn(t,"rgb","int"):null},zn("int"),Vn("int"),Hn("int"),Wn("int"),Yn("int"),Zn("int")],float:[zn("float"),Vn("float"),Hn("float"),Wn("float"),Yn("float"),Zn("float")]};function tr(e){const t=er[e];return e=>t.reduce(((t,n)=>t||n(e)),null)}function nr(e){const t=$t(Math.floor(e),0,255).toString(16);return 1===t.length?`0${t}`:t}function rr(e,t="#"){return`${t}${xn(e.getComponents("rgb")).map(nr).join("")}`}function ir(e,t="#"){const n=e.getComponents("rgb");return`${t}${[n[0],n[1],n[2],255*n[3]].map(nr).join("")}`}function or(e,t){const n=Dt("float"===t?2:0);return`rgb(${xn(e.getComponents("rgb",t)).map((e=>n(e))).join(", ")})`}function ar(e){return t=>or(t,e)}function sr(e,t){const n=Dt(2),r=Dt("float"===t?2:0);return`rgba(${e.getComponents("rgb",t).map(((e,t)=>(3===t?n:r)(e))).join(", ")})`}function lr(e){return t=>sr(t,e)}function cr(e,t){const n=Dt("float"===t?2:0),r=["r","g","b"];return`{${xn(e.getComponents("rgb",t)).map(((e,t)=>`${r[t]}: ${n(e)}`)).join(", ")}}`}function ur(e){return t=>cr(t,e)}function hr(e,t){const n=Dt(2),r=Dt("float"===t?2:0),i=["r","g","b","a"];return`{${e.getComponents("rgb",t).map(((e,t)=>`${i[t]}: ${(3===t?n:r)(e)}`)).join(", ")}}`}function dr(e){return t=>hr(t,e)}const fr=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:rr},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:ir},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[Dt(0),Nt,Nt];return`hsl(${xn(e.getComponents("hsl")).map(((e,n)=>t[n](e))).join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(e){const t=[Dt(0),Nt,Nt,Dt(2)];return`hsla(${e.getComponents("hsl").map(((e,n)=>t[n](e))).join(", ")})`}},...["int","float"].reduce(((e,t)=>[...e,{format:{alpha:!1,mode:"rgb",notation:"func",type:t},stringifier:ar(t)},{format:{alpha:!0,mode:"rgb",notation:"func",type:t},stringifier:lr(t)},{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:ur(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:dr(t)}]),[])];function pr(e){return fr.reduce(((t,n)=>{return t||(r=n.format,i=e,r.alpha===i.alpha&&r.mode===i.mode&&r.notation===i.notation&&r.type===i.type?n.stringifier:null);var r,i}),null)}const mr=g("apl");class gr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(mr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(mr("b")),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(mr("c")),n.appendChild(r),this.colorElem_=r;const i=e.createElement("div");i.classList.add(mr("m")),this.element.appendChild(i),this.markerElem_=i;const o=e.createElement("div");o.classList.add(mr("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),n=new Cn([t[0],t[1],t[2],0],"rgb"),r=new Cn([t[0],t[1],t[2],255],"rgb"),i=["to right",sr(n),sr(r)];this.colorElem_.style.background=`linear-gradient(${i.join(",")})`,this.previewElem_.style.backgroundColor=sr(e);const o=qt(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class vr{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new gr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=e.point.x/e.bounds.width,r=this.value.rawValue,[i,o,a]=r.getComponents("hsv");this.value.setRawValue(new Cn([i,o,a,n],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Bt(kn(!0),jt(e));if(0===t)return;const n=this.value.rawValue,[r,i,o,a]=n.getComponents("hsv");this.value.setRawValue(new Cn([r,i,o,a+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Bt(kn(!0),jt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const yr=g("coltxt");class br{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yr()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(yr("m")),this.modeElem_=function(e){const t=e.createElement("select");return t.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce(((t,n)=>{const r=e.createElement("option");return r.textContent=n.text,r.value=n.value,t.appendChild(r),t}),e.createDocumentFragment())),t}(e),this.modeElem_.classList.add(yr("ms")),n.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const r=e.createElement("div");r.classList.add(yr("mm")),r.appendChild(q(e,"dropdown")),n.appendChild(r),this.element.appendChild(n);const i=e.createElement("div");i.classList.add(yr("w")),this.element.appendChild(i),this.textsElem_=i,this.textViews_=t.textViews,this.applyTextViews_(),y(t.colorMode,(e=>{this.modeElem_.value=e}))}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(e){this.textViews_=e,this.applyTextViews_()}applyTextViews_(){Y(this.textsElem_);const e=this.element.ownerDocument;this.textViews_.forEach((t=>{const n=e.createElement("div");n.classList.add(yr("c")),n.appendChild(t.element),this.textsElem_.appendChild(n)}))}}function _r(e,t,n){const r=An(e,t)[n];return new Je({min:0,max:r})}function wr(e,t,n){return new Qt(e,{arrayPosition:0===n?"fst":2===n?"lst":"mid",baseStep:kn(!1),parser:t.parser,props:C.fromObject({draggingScale:"float"===t.colorType?.01:1,formatter:(r=t.colorType,Dt("float"===r?2:0))}),value:T(0,{constraint:_r(t.colorMode,t.colorType,n)}),viewProps:t.viewProps});var r}class xr{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.parser_=t.parser,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=T(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new br(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},n=[wr(e,t,0),wr(e,t,1),wr(e,t,2)];return n.forEach(((e,t)=>{zt({primary:this.value,secondary:e.value,forward:e=>e.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[t],backward:(e,n)=>{const r=this.colorMode.rawValue,i=e.rawValue.getComponents(r,this.colorType_);return i[t]=n.rawValue,new Cn(Sn(xn(i),i[3]),r,this.colorType_)}})})),n}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Sr=g("hpl");class Er{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Sr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("div");n.classList.add(Sr("c")),this.element.appendChild(n);const r=e.createElement("div");r.classList.add(Sr("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=or(new Cn([t,100,100],"hsv"));const n=qt(t,0,360,0,100);this.markerElem_.style.left=`${n}%`}onValueChange_(){this.update_()}}class Ar{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Er(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=qt($t(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),r=this.value.rawValue,[,i,o,a]=r.getComponents("hsv");this.value.setRawValue(new Cn([n,i,o,a],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Bt(kn(!1),jt(e));if(0===t)return;const n=this.value.rawValue,[r,i,o,a]=n.getComponents("hsv");this.value.setRawValue(new Cn([r+t,i,o,a],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){0!==Bt(kn(!1),jt(e))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Mr=g("svp");class Tr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Mr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const n=e.createElement("canvas");n.height=64,n.width=64,n.classList.add(Mr("c")),this.element.appendChild(n),this.canvasElement=n;const r=e.createElement("div");r.classList.add(Mr("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}update_(){const e=function(e){const t=e.ownerDocument.defaultView;return t&&"document"in t?e.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!e)return;const t=this.value.rawValue.getComponents("hsv"),n=this.canvasElement.width,r=this.canvasElement.height,i=e.getImageData(0,0,n,r),o=i.data;for(let e=0;e<r;e++)for(let i=0;i<n;i++){const a=qt(i,0,n,0,100),s=qt(e,0,r,100,0),l=wn(t[0],a,s),c=4*(e*n+i);o[c]=l[0],o[c+1]=l[1],o[c+2]=l[2],o[c+3]=255}e.putImageData(i,0,0);const a=qt(t[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const s=qt(t[2],0,100,100,0);this.markerElem_.style.top=`${s}%`}onValueChange_(){this.update_()}}class Cr{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Tr(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=qt(e.point.x,0,e.bounds.width,0,100),r=qt(e.point.y,0,e.bounds.height,100,0),[i,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Cn([i,n,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Ht(e.key)&&e.preventDefault();const[t,n,r,i]=this.value.rawValue.getComponents("hsv"),o=kn(!1),a=Bt(o,jt(e)),s=Bt(o,Vt(e));0===a&&0===s||this.value.setRawValue(new Cn([t,n+a,r+s,i],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=kn(!1),n=Bt(t,jt(e)),r=Bt(t,Vt(e));0===n&&0===r||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ir{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Ar(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Cr(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new vr(e,{value:this.value,viewProps:this.viewProps}),text:new Qt(e,{parser:Pt,baseStep:.1,props:C.fromObject({draggingScale:.01,formatter:Dt(2)}),value:T(0,{constraint:new Je({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&zt({primary:this.value,secondary:this.alphaIcs_.text.value,forward:e=>e.rawValue.getComponents()[3],backward:(e,t)=>{const n=e.rawValue.getComponents();return n[3]=t.rawValue,new Cn(n,e.rawValue.mode)}}),this.textC_=new xr(e,{colorType:t.colorType,parser:Pt,value:this.value,viewProps:this.viewProps}),this.view=new Rn(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const Rr=g("colsw");class Pr{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Rr()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(Rr("sw")),this.element.appendChild(n),this.swatchElem_=n;const r=e.createElement("button");r.classList.add(Rr("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=ir(e)}onValueChange_(){this.update_()}}class Lr{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Pr(e,{value:this.value,viewProps:this.viewProps})}}class kr{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=re.create(t.expanded),this.swatchC_=new Lr(e,{value:this.value,viewProps:this.viewProps});const n=this.swatchC_.view.buttonElement;n.addEventListener("blur",this.onButtonBlur_),n.addEventListener("click",this.onButtonClick_),this.textC_=new ht(e,{parser:t.parser,props:C.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new _n(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===t.pickerLayout?new lt(e,{viewProps:this.viewProps}):null;const r=new Ir(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=r,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(r.view.element),zt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e.rawValue,backward:(e,t)=>t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),oe(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=K(e);n&&t.contains(n)||n&&n===this.swatchC_.view.buttonElement&&!H(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.swatchC_.view.buttonElement.focus()}}function Dr(e){return xn(e.getComponents("rgb")).reduce(((e,t)=>e<<8|255&Math.floor(t)),0)}function Or(e){return e.getComponents("rgb").reduce(((e,t,n)=>e<<8|255&Math.floor(3===n?255*t:t)),0)>>>0}function Nr(e){return"number"!=typeof e?Cn.black():new Cn([(t=e)>>16&255,t>>8&255,255&t],"rgb");var t}function Ur(e){return"number"!=typeof e?Cn.black():new Cn([(t=e)>>24&255,t>>16&255,t>>8&255,qt(255&t,0,255,0,1)],"rgb");var t}function Fr(e){var t;return!(!(null==e?void 0:e.alpha)&&!(null===(t=null==e?void 0:e.color)||void 0===t?void 0:t.alpha))}function zr(e){return e?e=>ir(e,"0x"):e=>rr(e,"0x")}const Br={id:"input-color-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;if(!function(e){return"color"in e||"view"in e&&"color"===e.view}(t))return null;const n=Ln(t);return n?{initialValue:e,params:n}:null},binding:{reader:e=>Fr(e.params)?Ur:Nr,equals:Cn.equals,writer:e=>function(e){const t=e?Or:Dr;return(e,n)=>{an(e,t(n))}}(Fr(e.params))},controller:e=>{const t=Fr(e.params),n="expanded"in e.params?e.params.expanded:void 0,r="picker"in e.params?e.params.picker:void 0;return new kr(e.document,{colorType:"int",expanded:null!=n&&n,formatter:zr(t),parser:tr("int"),pickerLayout:null!=r?r:"popup",supportsAlpha:t,value:e.value,viewProps:e.viewProps})}};function Vr(e){return t=>function(e,t){return Cn.isColorObject(e)?Cn.fromObject(e,t):Cn.black(t)}(t,e)}function jr(e,t){return n=>e?hr(n,t):cr(n,t)}const Hr={id:"input-color-object",type:"input",accept:(e,t)=>{if(!Cn.isColorObject(e))return null;const n=Ln(t);return n?{initialValue:e,params:n}:null},binding:{reader:e=>Vr(Dn(e.params)),equals:Cn.equals,writer:e=>{return r=e.initialValue,t=Cn.isRgbaColorObject(r),n=Dn(e.params),(e,r)=>{t?function(e,t,n){const r=t.toRgbaObject(n);e.writeProperty("r",r.r),e.writeProperty("g",r.g),e.writeProperty("b",r.b),e.writeProperty("a",r.a)}(e,r,n):function(e,t,n){const r=t.toRgbaObject(n);e.writeProperty("r",r.r),e.writeProperty("g",r.g),e.writeProperty("b",r.b)}(e,r,n)};var t,n,r}},controller:e=>{var t;const n=Cn.isRgbaColorObject(e.initialValue),r="expanded"in e.params?e.params.expanded:void 0,i="picker"in e.params?e.params.picker:void 0,o=null!==(t=Dn(e.params))&&void 0!==t?t:"int";return new kr(e.document,{colorType:o,expanded:null!=r&&r,formatter:jr(n,o),parser:tr(o),pickerLayout:null!=i?i:"popup",supportsAlpha:n,value:e.value,viewProps:e.viewProps})}},Gr={id:"input-color-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;if("view"in t&&"text"===t.view)return null;const n=Jn(e,Dn(t));if(!n)return null;if(!pr(n))return null;const r=Ln(t);return r?{initialValue:e,params:r}:null},binding:{reader:e=>{var t;return function(e){const t=er[e];return n=>{if("string"!=typeof n)return Cn.black(e);const r=t.reduce(((e,t)=>e||t(n)),null);return null!=r?r:Cn.black(e)}}(null!==(t=Dn(e.params))&&void 0!==t?t:"int")},equals:Cn.equals,writer:e=>{const t=Jn(e.initialValue,Dn(e.params));if(!t)throw h.shouldNeverHappen();const n=function(e){const t=pr(e);return t?(e,n)=>{an(e,t(n))}:null}(t);if(!n)throw h.notBindable();return n}},controller:e=>{const t=Jn(e.initialValue,Dn(e.params));if(!t)throw h.shouldNeverHappen();const n=pr(t);if(!n)throw h.shouldNeverHappen();const r="expanded"in e.params?e.params.expanded:void 0,i="picker"in e.params?e.params.picker:void 0;return new kr(e.document,{colorType:t.type,expanded:null!=r&&r,formatter:n,parser:tr(t.type),pickerLayout:null!=i?i:"popup",supportsAlpha:t.alpha,value:e.value,viewProps:e.viewProps})}};class Wr{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map(((e,t)=>{var n,r;return null!==(r=null===(n=this.components[t])||void 0===n?void 0:n.constrain(e))&&void 0!==r?r:e}));return this.asm_.fromComponents(t)}}const qr=g("pndtxt");class Xr{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(qr()),this.textViews.forEach((t=>{const n=e.createElement("div");n.classList.add(qr("a")),n.appendChild(t.element),this.element.appendChild(n)}))}}class $r{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map(((n,r)=>function(e,t,n){return new Qt(e,{arrayPosition:0===n?"fst":n===t.axes.length-1?"lst":"mid",baseStep:t.axes[n].baseStep,parser:t.parser,props:t.axes[n].textProps,value:T(0,{constraint:t.axes[n].constraint}),viewProps:t.viewProps})}(e,t,r))),this.acs_.forEach(((e,n)=>{zt({primary:this.value,secondary:e.value,forward:e=>t.assembly.toComponents(e.rawValue)[n],backward:(e,r)=>{const i=t.assembly.toComponents(e.rawValue);return i[n]=r.rawValue,t.assembly.fromComponents(i)}})})),this.view=new Xr(e,{textViews:this.acs_.map((e=>e.view))})}}function Yr(e,t){return"step"in e&&!s(e.step)?new nt(e.step,t):null}function Kr(e){return s(e.max)||s(e.min)?s(e.max)&&s(e.min)?null:new tt({max:e.max,min:e.min}):new Je({max:e.max,min:e.min})}const Zr={id:"input-number",type:"input",accept:(e,t)=>{if("number"!=typeof e)return null;const n=P,r=L(t,{format:n.optional.function,max:n.optional.number,min:n.optional.number,options:n.optional.custom(sn),step:n.optional.number});return r?{initialValue:e,params:r}:null},binding:{reader:e=>Lt,constraint:e=>function(e,t){const n=[],r=Yr(e,t);r&&n.push(r);const i=Kr(e);i&&n.push(i);const o=hn(e.options);return o&&n.push(o),new Ze(n)}(e.params,e.initialValue),writer:e=>an},controller:e=>{var t;const n=e.value,r=e.constraint,i=r&&Qe(r,et);if(i)return new ot(e.document,{props:new C({options:i.values.value("options")}),value:n,viewProps:e.viewProps});const o=null!==(t="format"in e.params?e.params.format:void 0)&&void 0!==t?t:Dt(dn(r,n.rawValue)),a=r&&Qe(r,Je);return a?new on(e.document,{baseStep:fn(r),parser:Pt,sliderProps:new C({maxValue:a.values.value("max"),minValue:a.values.value("min")}),textProps:C.fromObject({draggingScale:pn(r,n.rawValue),formatter:o}),value:n,viewProps:e.viewProps}):new Qt(e.document,{baseStep:fn(r),parser:Pt,props:C.fromObject({draggingScale:pn(r,n.rawValue),formatter:o}),value:n,viewProps:e.viewProps})}};class Qr{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(s(e))return!1;const t=e.x,n=e.y;return"number"==typeof t&&"number"==typeof n}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const Jr={toComponents:e=>e.getComponents(),fromComponents:e=>new Qr(...e)},ei=g("p2d");class ti{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ei()),t.viewProps.bindClassModifiers(this.element),y(t.expanded,_(this.element,ei(void 0,"expanded")));const n=e.createElement("div");n.classList.add(ei("h")),this.element.appendChild(n);const r=e.createElement("button");r.classList.add(ei("b")),r.appendChild(q(e,"p2dpad")),t.viewProps.bindDisabled(r),n.appendChild(r),this.buttonElement=r;const i=e.createElement("div");if(i.classList.add(ei("t")),n.appendChild(i),this.textElement=i,"inline"===t.pickerLayout){const t=e.createElement("div");t.classList.add(ei("p")),this.element.appendChild(t),this.pickerElement=t}else this.pickerElement=null}}const ni=g("p2dp");class ri{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=t.invertsY,this.maxValue_=t.maxValue,this.element=e.createElement("div"),this.element.classList.add(ni()),"popup"===t.layout&&this.element.classList.add(ni(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("div");n.classList.add(ni("p")),t.viewProps.bindTabIndex(n),this.element.appendChild(n),this.padElement=n;const r=e.createElementNS(V,"svg");r.classList.add(ni("g")),this.padElement.appendChild(r),this.svgElem_=r;const i=e.createElementNS(V,"line");i.classList.add(ni("ax")),i.setAttributeNS(null,"x1","0"),i.setAttributeNS(null,"y1","50%"),i.setAttributeNS(null,"x2","100%"),i.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(i);const o=e.createElementNS(V,"line");o.classList.add(ni("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const a=e.createElementNS(V,"line");a.classList.add(ni("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;const s=e.createElement("div");s.classList.add(ni("m")),this.padElement.appendChild(s),this.markerElem_=s,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),n=this.maxValue_,r=qt(e,-n,+n,0,100),i=qt(t,-n,+n,0,100),o=this.invertsY_?100-i:i;this.lineElem_.setAttributeNS(null,"x2",`${r}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${r}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ii(e,t,n){return[Bt(t[0],jt(e)),Bt(t[1],Vt(e))*(n?1:-1)]}class oi{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.baseSteps_=t.baseSteps,this.maxValue_=t.maxValue,this.invertsY_=t.invertsY,this.view=new ri(e,{invertsY:this.invertsY_,layout:t.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const n=this.maxValue_,r=qt(e.point.x,0,e.bounds.width,-n,+n),i=qt(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-n,+n);this.value.setRawValue(new Qr(r,i),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Ht(e.key)&&e.preventDefault();const[t,n]=ii(e,this.baseSteps_,this.invertsY_);0===t&&0===n||this.value.setRawValue(new Qr(this.value.rawValue.x+t,this.value.rawValue.y+n),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,n]=ii(e,this.baseSteps_,this.invertsY_);0===t&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class ai{constructor(e,t){var n,r;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=re.create(t.expanded),this.popC_="popup"===t.pickerLayout?new lt(e,{viewProps:this.viewProps}):null;const i=new oi(e,{baseSteps:[t.axes[0].baseStep,t.axes[1].baseStep],invertsY:t.invertsY,layout:t.pickerLayout,maxValue:t.maxValue,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach((e=>{e.addEventListener("blur",this.onPopupChildBlur_),e.addEventListener("keydown",this.onPopupChildKeydown_)})),this.pickerC_=i,this.textC_=new $r(e,{assembly:Jr,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new ti(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("blur",this.onPadButtonBlur_),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),zt({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:e=>e.rawValue,backward:(e,t)=>t.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),oe(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,n=e.relatedTarget;n&&t.contains(n)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,n=K(e);n&&t.contains(n)||n&&n===this.view.buttonElement&&!H(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?"Escape"===e.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===e.key&&this.view.buttonElement.focus()}}class si{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(s(e))return!1;const t=e.x,n=e.y,r=e.z;return"number"==typeof t&&"number"==typeof n&&"number"==typeof r}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const li={toComponents:e=>e.getComponents(),fromComponents:e=>new si(...e)};function ci(e){return si.isObject(e)?new si(e.x,e.y,e.z):new si}function ui(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}function hi(e,t){return{baseStep:fn(t),constraint:t,textProps:C.fromObject({draggingScale:pn(t,e),formatter:Dt(dn(t,e))})}}const di={id:"input-point3d",type:"input",accept:(e,t)=>{if(!si.isObject(e))return null;const n=P,r=L(t,{x:n.optional.custom(cn),y:n.optional.custom(cn),z:n.optional.custom(cn)});return r?{initialValue:e,params:r}:null},binding:{reader:e=>ci,constraint:e=>{return t=e.params,n=e.initialValue,new Wr({assembly:li,components:[Fi("x"in t?t.x:void 0,n.x),Fi("y"in t?t.y:void 0,n.y),Fi("z"in t?t.z:void 0,n.z)]});var t,n},equals:si.equals,writer:e=>ui},controller:e=>{const t=e.value,n=e.constraint;if(!(n instanceof Wr))throw h.shouldNeverHappen();return new $r(e.document,{assembly:li,axes:[hi(t.rawValue.x,n.components[0]),hi(t.rawValue.y,n.components[1]),hi(t.rawValue.z,n.components[2])],parser:Pt,value:t,viewProps:e.viewProps})}};class fi{constructor(e=0,t=0,n=0,r=0){this.x=e,this.y=t,this.z=n,this.w=r}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(s(e))return!1;const t=e.x,n=e.y,r=e.z,i=e.w;return"number"==typeof t&&"number"==typeof n&&"number"==typeof r&&"number"==typeof i}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const pi={toComponents:e=>e.getComponents(),fromComponents:e=>new fi(...e)};function mi(e){return fi.isObject(e)?new fi(e.x,e.y,e.z,e.w):new fi}function gi(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}const vi={id:"input-point4d",type:"input",accept:(e,t)=>{if(!fi.isObject(e))return null;const n=P,r=L(t,{x:n.optional.custom(cn),y:n.optional.custom(cn),z:n.optional.custom(cn),w:n.optional.custom(cn)});return r?{initialValue:e,params:r}:null},binding:{reader:e=>mi,constraint:e=>{return t=e.params,n=e.initialValue,new Wr({assembly:pi,components:[Fi("x"in t?t.x:void 0,n.x),Fi("y"in t?t.y:void 0,n.y),Fi("z"in t?t.z:void 0,n.z),Fi("w"in t?t.w:void 0,n.w)]});var t,n},equals:fi.equals,writer:e=>gi},controller:e=>{const t=e.value,n=e.constraint;if(!(n instanceof Wr))throw h.shouldNeverHappen();return new $r(e.document,{assembly:pi,axes:t.rawValue.getComponents().map(((e,t)=>{return r=e,{baseStep:fn(i=n.components[t]),constraint:i,textProps:C.fromObject({draggingScale:pn(i,r),formatter:Dt(dn(i,r))})};var r,i})),parser:Pt,value:t,viewProps:e.viewProps})}};const yi={id:"input-string",type:"input",accept:(e,t)=>{if("string"!=typeof e)return null;const n=L(t,{options:P.optional.custom(sn)});return n?{initialValue:e,params:n}:null},binding:{reader:e=>Ut,constraint:e=>function(e){const t=[],n=hn(e.options);return n&&t.push(n),new Ze(t)}(e.params),writer:e=>an},controller:e=>{const t=e.document,n=e.value,r=e.constraint,i=r&&Qe(r,et);return i?new ot(t,{props:new C({options:i.values.value("options")}),value:n,viewProps:e.viewProps}):new ht(t,{parser:e=>e,props:C.fromObject({formatter:Ft}),value:n,viewProps:e.viewProps})}},bi={defaultInterval:200,defaultLineCount:3},_i=g("mll");class wi{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(_i()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("textarea");n.classList.add(_i("i")),n.style.height=`calc(var(--bld-us) * ${t.lineCount})`,n.readOnly=!0,t.viewProps.bindDisabled(n),this.element.appendChild(n),this.textareaElem_=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,n=[];this.value.rawValue.forEach((e=>{void 0!==e&&n.push(this.formatter_(e))})),e.textContent=n.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class xi{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new wi(e,{formatter:t.formatter,lineCount:t.lineCount,value:this.value,viewProps:this.viewProps})}}const Si=g("sgl");class Ei{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Si()),t.viewProps.bindClassModifiers(this.element);const n=e.createElement("input");n.classList.add(Si("i")),n.readOnly=!0,n.type="text",t.viewProps.bindDisabled(n),this.element.appendChild(n),this.inputElement=n,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=void 0!==t?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class Ai{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Ei(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}const Mi={id:"monitor-bool",type:"monitor",accept:(e,t)=>{if("boolean"!=typeof e)return null;const n=L(t,{lineCount:P.optional.number});return n?{initialValue:e,params:n}:null},binding:{reader:e=>dt},controller:e=>{var t;return 1===e.value.rawValue.length?new Ai(e.document,{formatter:ft,value:e.value,viewProps:e.viewProps}):new xi(e.document,{formatter:ft,lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:bi.defaultLineCount,value:e.value,viewProps:e.viewProps})}},Ti=g("grl");class Ci{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ti()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const n=e.createElementNS(V,"svg");n.classList.add(Ti("g")),n.style.height=`calc(var(--bld-us) * ${t.lineCount})`,this.element.appendChild(n),this.svgElem_=n;const r=e.createElementNS(V,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;const i=e.createElement("div");i.classList.add(Ti("t"),g("tt")()),this.element.appendChild(i),this.tooltipElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,n=this.props_.get("minValue"),r=this.props_.get("maxValue"),i=[];this.value.rawValue.forEach(((o,a)=>{if(void 0===o)return;const s=qt(a,0,t,0,e.width),l=qt(o,n,r,e.height,0);i.push([s,l].join(","))})),this.lineElem_.setAttributeNS(null,"points",i.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove(Ti("t","a"));const s=qt(this.cursor_.rawValue,0,t,0,e.width),l=qt(a,n,r,e.height,0);o.style.left=`${s}px`,o.style.top=`${l}px`,o.textContent=`${this.formatter_(a)}`,o.classList.contains(Ti("t","a"))||(o.classList.add(Ti("t","a"),Ti("t","in")),j(o),o.classList.remove(Ti("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Ii{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=T(-1),this.view=new Ci(e,{cursor:this.cursor_,formatter:t.formatter,lineCount:t.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),H(e)){const e=new Wt(this.view.element);e.emitter.on("down",this.onGraphPointerDown_),e.emitter.on("move",this.onGraphPointerMove_),e.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(qt(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){e.data.point?this.cursor_.rawValue=Math.floor(qt(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Ri(e){return"format"in e&&!s(e.format)?e.format:Dt(2)}function Pi(e){return"view"in e&&"graph"===e.view}const Li={id:"monitor-number",type:"monitor",accept:(e,t)=>{if("number"!=typeof e)return null;const n=P,r=L(t,{format:n.optional.function,lineCount:n.optional.number,max:n.optional.number,min:n.optional.number,view:n.optional.string});return r?{initialValue:e,params:r}:null},binding:{defaultBufferSize:e=>Pi(e)?64:1,reader:e=>Lt},controller:e=>Pi(e.params)?function(e){var t,n,r;return new Ii(e.document,{formatter:Ri(e.params),lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:bi.defaultLineCount,props:C.fromObject({maxValue:null!==(n="max"in e.params?e.params.max:null)&&void 0!==n?n:100,minValue:null!==(r="min"in e.params?e.params.min:null)&&void 0!==r?r:0}),value:e.value,viewProps:e.viewProps})}(e):function(e){var t;return 1===e.value.rawValue.length?new Ai(e.document,{formatter:Ri(e.params),value:e.value,viewProps:e.viewProps}):new xi(e.document,{formatter:Ri(e.params),lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:bi.defaultLineCount,value:e.value,viewProps:e.viewProps})}(e)},ki={id:"monitor-string",type:"monitor",accept:(e,t)=>{if("string"!=typeof e)return null;const n=P,r=L(t,{lineCount:n.optional.number,multiline:n.optional.boolean});return r?{initialValue:e,params:r}:null},binding:{reader:e=>Ut},controller:e=>{var t;const n=e.value;return n.rawValue.length>1||"multiline"in e.params&&e.params.multiline?new xi(e.document,{formatter:Ft,lineCount:null!==(t=e.params.lineCount)&&void 0!==t?t:bi.defaultLineCount,value:n,viewProps:e.viewProps}):new Ai(e.document,{formatter:Ft,value:n,viewProps:e.viewProps})}};function Di(e,t){return 0===t?new Ge:new We(e,null!=t?t:bi.defaultInterval)}class Oi{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e){"blade"===e.type?this.pluginsMap_.blades.unshift(e):"input"===e.type?this.pluginsMap_.inputs.unshift(e):"monitor"===e.type&&this.pluginsMap_.monitors.unshift(e)}createInput(e,t,n){if(s(t.read()))throw new h({context:{key:t.key},type:"nomatchingcontroller"});const r=this.pluginsMap_.inputs.reduce(((r,i)=>null!=r?r:function(e,t){var n;const r=e.accept(t.target.read(),t.params);if(s(r))return null;const i=P,o={target:t.target,initialValue:r.initialValue,params:r.params},a=e.binding.reader(o),l=e.binding.constraint?e.binding.constraint(o):void 0,c=T(a(r.initialValue),{constraint:l,equals:e.binding.equals}),u=new qe({reader:a,target:t.target,value:c,writer:e.binding.writer(o)}),h=i.optional.boolean(t.params.disabled).value,d=i.optional.boolean(t.params.hidden).value,f=e.controller({constraint:l,document:t.document,initialValue:r.initialValue,params:r.params,value:u.value,viewProps:U.create({disabled:h,hidden:d})});return new ce(t.document,{binding:u,blade:ne(),props:C.fromObject({label:"label"in t.params?null!==(n=i.optional.string(t.params.label).value)&&void 0!==n?n:null:t.target.key}),valueController:f})}(i,{document:e,target:t,params:n})),null);if(r)return r;throw new h({context:{key:t.key},type:"nomatchingcontroller"})}createMonitor(e,t,n){const r=this.pluginsMap_.monitors.reduce(((r,i)=>null!=r?r:function(e,t){var n,r,i;const o=P,a=e.accept(t.target.read(),t.params);if(s(a))return null;const l={target:t.target,initialValue:a.initialValue,params:a.params},c=e.binding.reader(l),u=null!==(r=null!==(n=o.optional.number(t.params.bufferSize).value)&&void 0!==n?n:e.binding.defaultBufferSize&&e.binding.defaultBufferSize(a.params))&&void 0!==r?r:1,h=o.optional.number(t.params.interval).value,d=new Ke({reader:c,target:t.target,ticker:Di(t.document,h),value:$e(u)}),f=o.optional.boolean(t.params.disabled).value,p=o.optional.boolean(t.params.hidden).value,m=e.controller({document:t.document,params:a.params,value:d.value,viewProps:U.create({disabled:f,hidden:p})});return new he(t.document,{binding:d,blade:ne(),props:C.fromObject({label:"label"in t.params?null!==(i=o.optional.string(t.params.label).value)&&void 0!==i?i:null:t.target.key}),valueController:m})}(i,{document:e,params:n,target:t})),null);if(r)return r;throw new h({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const n=this.pluginsMap_.blades.reduce(((n,r)=>null!=n?n:function(e,t){const n=e.accept(t.params);if(!n)return null;const r=P.optional.boolean(t.params.disabled).value,i=P.optional.boolean(t.params.hidden).value;return e.controller({blade:ne(),document:t.document,params:Object.assign(Object.assign({},n.params),{disabled:r,hidden:i}),viewProps:U.create({disabled:r,hidden:i})})}(r,{document:e,params:t})),null);if(!n)throw new h({type:"nomatchingview",context:{params:t}});return n}createBladeApi(e){if(e instanceof ce)return new le(e);if(e instanceof he)return new ue(e);if(e instanceof xe)return new me(e,this);const t=this.pluginsMap_.blades.reduce(((t,n)=>null!=t?t:n.api({controller:e,pool:this})),null);if(!t)throw h.shouldNeverHappen();return t}}function Ni(e){return Qr.isObject(e)?new Qr(e.x,e.y):new Qr}function Ui(e,t){e.writeProperty("x",t.x),e.writeProperty("y",t.y)}function Fi(e,t){if(!e)return;const n=[],r=Yr(e,t);r&&n.push(r);const i=Kr(e);return i&&n.push(i),new Ze(n)}function zi(e,t){const[n,r]=e?function(e){const t=Qe(e,Je);if(t)return[t.values.get("min"),t.values.get("max")];const n=Qe(e,tt);return n?[n.minValue,n.maxValue]:[void 0,void 0]}(e):[];if(!s(n)||!s(r))return Math.max(Math.abs(null!=n?n:0),Math.abs(null!=r?r:0));const i=fn(e);return Math.max(10*Math.abs(i),10*Math.abs(t))}function Bi(e,t){const n=t instanceof Wr?t.components[0]:void 0,r=t instanceof Wr?t.components[1]:void 0,i=zi(n,e.x),o=zi(r,e.y);return Math.max(i,o)}function Vi(e,t){return{baseStep:fn(t),constraint:t,textProps:C.fromObject({draggingScale:pn(t,e),formatter:Dt(dn(t,e))})}}function ji(e){if(!("y"in e))return!1;const t=e.y;return!!t&&"inverted"in t&&!!t.inverted}const Hi={id:"input-point2d",type:"input",accept:(e,t)=>{if(!Qr.isObject(e))return null;const n=P,r=L(t,{expanded:n.optional.boolean,picker:n.optional.custom(ln),x:n.optional.custom(cn),y:n.optional.object({inverted:n.optional.boolean,max:n.optional.number,min:n.optional.number,step:n.optional.number})});return r?{initialValue:e,params:r}:null},binding:{reader:e=>Ni,constraint:e=>{return t=e.params,n=e.initialValue,new Wr({assembly:Jr,components:[Fi("x"in t?t.x:void 0,n.x),Fi("y"in t?t.y:void 0,n.y)]});var t,n},equals:Qr.equals,writer:e=>Ui},controller:e=>{const t=e.document,n=e.value,r=e.constraint;if(!(r instanceof Wr))throw h.shouldNeverHappen();const i="expanded"in e.params?e.params.expanded:void 0,o="picker"in e.params?e.params.picker:void 0;return new ai(t,{axes:[Vi(n.rawValue.x,r.components[0]),Vi(n.rawValue.y,r.components[1])],expanded:null!=i&&i,invertsY:ji(e.params),maxValue:Bi(n.rawValue,r),parser:Pt,pickerLayout:null!=o?o:"popup",value:n,viewProps:e.viewProps})}};class Gi extends t{constructor(e){super(e),this.emitter_=new p,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new r(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get options(){return this.controller_.valueController.props.get("options")}set options(e){this.controller_.valueController.props.set("options",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}}class Wi extends t{constructor(e){super(e),this.emitter_=new p,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new r(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(e){this.controller_.valueController.sliderController.props.set("maxValue",e)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(e){this.controller_.valueController.sliderController.props.set("minValue",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}}class qi extends t{constructor(e){super(e),this.emitter_=new p,this.controller_.valueController.value.emitter.on("change",(e=>{this.emitter_.emit("change",{event:new r(this,e.rawValue)})}))}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(e){this.controller_.valueController.props.set("formatter",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,t){const n=t.bind(this);return this.emitter_.on(e,(e=>{n(e.event)})),this}}const Xi={id:"list",type:"blade",accept(e){const t=P,n=L(e,{options:t.required.custom(sn),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string});return n?{params:n}:null},controller(e){const t=new et(un(e.params.options)),n=T(e.params.value,{constraint:t}),r=new ot(e.document,{props:new C({options:t.values.value("options")}),value:n,viewProps:e.viewProps});return new Te(e.document,{blade:e.blade,props:C.fromObject({label:e.params.label}),valueController:r})},api:e=>e.controller instanceof Te&&e.controller.valueController instanceof ot?new Gi(e.controller):null};class $i extends ge{constructor(e,t){super(e,t)}get element(){return this.controller_.view.element}importPreset(e){(function(e,t){e.forEach((e=>{const n=t[e.target.presetKey];void 0!==n&&e.writer(e.target,e.reader(n))}))})(this.controller_.rackController.rack.find(ce).map((e=>e.binding)),e),this.refresh()}exportPreset(){return this.controller_.rackController.rack.find(ce).map((e=>e.binding.target)).reduce(((e,t)=>Object.assign(e,{[t.presetKey]:t.read()})),{})}refresh(){this.controller_.rackController.rack.find(ce).forEach((e=>{e.binding.read()})),this.controller_.rackController.rack.find(he).forEach((e=>{e.binding.read()}))}}class Yi extends Ae{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const Ki={id:"slider",type:"blade",accept(e){const t=P,n=L(e,{max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number});return n?{params:n}:null},controller(e){var t,n;const r=null!==(t=e.params.value)&&void 0!==t?t:0,i=new Je({max:e.params.max,min:e.params.min}),o=new on(e.document,{baseStep:1,parser:Pt,sliderProps:new C({maxValue:i.values.value("max"),minValue:i.values.value("min")}),textProps:C.fromObject({draggingScale:pn(void 0,r),formatter:null!==(n=e.params.format)&&void 0!==n?n:kt}),value:T(r,{constraint:i}),viewProps:e.viewProps});return new Te(e.document,{blade:e.blade,props:C.fromObject({label:e.params.label}),valueController:o})},api:e=>e.controller instanceof Te&&e.controller.valueController instanceof on?new Wi(e.controller):null},Zi={id:"text",type:"blade",accept(e){const t=P,n=L(e,{parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string});return n?{params:n}:null},controller(e){var t;const n=new ht(e.document,{parser:e.params.parse,props:C.fromObject({formatter:null!==(t=e.params.format)&&void 0!==t?t:e=>String(e)}),value:T(e.params.value),viewProps:e.viewProps});return new Te(e.document,{blade:e.blade,props:C.fromObject({label:e.params.label}),valueController:n})},api:e=>e.controller instanceof Te&&e.controller.valueController instanceof ht?new qi(e.controller):null};function Qi(e,t,n){if(e.querySelector(`style[data-tp-style=${t}]`))return;const r=e.createElement("style");r.dataset.tpStyle=t,r.textContent=n,e.head.appendChild(r)}const Ji=new class{constructor(e){const[t,n]=e.split("-"),r=t.split(".");this.major=parseInt(r[0],10),this.minor=parseInt(r[1],10),this.patch=parseInt(r[2],10),this.prerelease=null!=n?n:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[e,this.prerelease].join("-"):e}}("3.1.10");e.BladeApi=t,e.ButtonApi=f,e.FolderApi=ge,e.InputBindingApi=le,e.ListApi=Gi,e.MonitorBindingApi=ue,e.Pane=class extends $i{constructor(e){var t,n;const r=null!=e?e:{},i=null!==(t=r.document)&&void 0!==t?t:G(),o=function(){const e=new Oi;return[Hi,di,vi,yi,Zr,Gr,Hr,Br,yn,Mi,ki,Li,ee,Me,Le,He].forEach((t=>{e.register(t)})),e}();super(new Yi(i,{expanded:r.expanded,blade:ne(),props:C.fromObject({title:r.title}),viewProps:U.create()}),o),this.pool_=o,this.containerElem_=null!==(n=r.container)&&void 0!==n?n:function(e){const t=e.createElement("div");return t.classList.add(g("dfw")()),e.body&&e.body.appendChild(t),t}(i),this.containerElem_.appendChild(this.element),this.doc_=i,this.usesDefaultWrapper_=!r.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw h.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw h.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach((e=>{this.pool_.register(e),this.embedPluginStyle_(e)}))}embedPluginStyle_(e){e.css&&Qi(this.document,`plugin-${e.id}`,e.css)}setUpDefaultPlugins_(){Qi(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach((e=>{this.embedPluginStyle_(e)})),this.registerPlugin({plugins:[Ki,Xi,He,Zi]})}},e.SeparatorApi=Ce,e.SliderApi=Wi,e.TabApi=Fe,e.TabPageApi=Ue,e.TextApi=qi,e.TpChangeEvent=r,e.VERSION=Ji,Object.defineProperty(e,"__esModule",{value:!0})}(t)},6675:e=>{function t(e,t){const n=new RegExp(t,"g"),r=e.match(n);return r?r.length:0}e.exports=t,e.exports.default=t},8556:(e,t,n)=>{const r=n(3614),i=n(8694),o=n(6675);function a(e,t,n){const a=n&&n.debug||!1,s=!(n&&!1===typeof n.nested),l=n&&n.startIndex||0;a&&console.log("[xml-utils] starting findTagByName with",t," and ",n);const c=r(e,`<${t}[ \n>/]`,l);if(a&&console.log("[xml-utils] start:",c),-1===c)return;const u=e.slice(c+t.length);let h=i(u,"^[^<]*[ /]>",0);const d=-1!==h&&"/"===u[h-1];if(a&&console.log("[xml-utils] selfClosing:",d),!1===d)if(s){let e=0,n=1,r=0;for(;-1!==(h=i(u,"[ /]"+t+">",e));){const i=u.substring(e,h+1);if(n+=o(i,"<"+t+"[ \n\t>]"),r+=o(i,"</"+t+">"),r>=n)break;e=h}}else h=i(u,"[ /]"+t+">",0);const f=c+t.length+h+1;if(a&&console.log("[xml-utils] end:",f),-1===f)return;const p=e.slice(c,f);let m;return m=d?null:p.slice(p.indexOf(">")+1,p.lastIndexOf("<")),{inner:m,outer:p,start:c,end:f}}e.exports=a,e.exports.default=a},563:(e,t,n)=>{const r=n(8556);function i(e,t,n){const i=[],o=n&&n.debug||!1,a=!n||"boolean"!=typeof n.nested||n.nested;let s,l=n&&n.startIndex||0;for(;s=r(e,t,{debug:o,startIndex:l});)l=a?s.start+1+t.length:s.end,i.push(s);return o&&console.log("findTagsByName found",i.length,"tags"),i}e.exports=i,e.exports.default=i},7379:e=>{function t(e,t,n){const r=n&&n.debug||!1;r&&console.log("[xml-utils] getting "+t+" in "+e);const i="object"==typeof e?e.outer:e,o=i.slice(0,i.indexOf(">")+1),a=['"',"'"];for(let e=0;e<a.length;e++){const n=a[e],i=t+"\\="+n+"([^"+n+"]*)"+n;r&&console.log("[xml-utils] pattern:",i);const s=new RegExp(i).exec(o);if(r&&console.log("[xml-utils] match:",s),s)return s[1]}}e.exports=t,e.exports.default=t},8694:e=>{function t(e,t,n){const r=new RegExp(t).exec(e.slice(n));return r?n+r.index+r[0].length-1:-1}e.exports=t,e.exports.default=t},3614:e=>{function t(e,t,n){const r=new RegExp(t).exec(e.slice(n));return r?n+r.index:-1}e.exports=t,e.exports.default=t},8625:()=>{},6504:()=>{},6580:()=>{},6942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=a(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=a(t,n));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()},4421:(e,t,n)=>{"use strict";n.d(t,{wK:()=>Br,Sd:()=>wr,HA:()=>Qa,Nc:()=>Rr,CS:()=>Ir,Pg:()=>Lr,Ai:()=>Ja,f8:()=>Di,nO:()=>ls,_Q:()=>xr});var r={};n.r(r),n.d(r,{di:()=>Hr});var i=n(4922),o=n(4100);function a(){let e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function s(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,o=r.byteLength,a=e.createBuffer();let s;if(e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)s=e.FLOAT;else if(r instanceof Uint16Array)s=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)s=e.SHORT;else if(r instanceof Uint32Array)s=e.UNSIGNED_INT;else if(r instanceof Int32Array)s=e.INT;else if(r instanceof Int8Array)s=e.BYTE;else if(r instanceof Uint8Array)s=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);s=e.UNSIGNED_BYTE}return{buffer:a,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:o}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,o=n.updateRanges;if(e.bindBuffer(r,t),0===o.length)e.bufferSubData(r,0,i);else{o.sort(((e,t)=>e.start-t.start));let t=0;for(let e=1;e<o.length;e++){const n=o[t],r=o[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,o[t]=r)}o.length=t+1;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.bufferSubData(r,n.start*i.BYTES_PER_ELEMENT,i,n.start,n.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}const l={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},c={common:{diffuse:{value:new i.Q1f(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new i.dwI},alphaMap:{value:null},alphaMapTransform:{value:new i.dwI},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new i.dwI}},envmap:{envMap:{value:null},envMapRotation:{value:new i.dwI},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new i.dwI}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new i.dwI}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new i.dwI},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new i.dwI},normalScale:{value:new i.I9Y(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new i.dwI},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new i.dwI}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new i.dwI}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new i.dwI}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new i.Q1f(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new i.Q1f(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new i.dwI},alphaTest:{value:0},uvTransform:{value:new i.dwI}},sprite:{diffuse:{value:new i.Q1f(16777215)},opacity:{value:1},center:{value:new i.I9Y(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new i.dwI},alphaMap:{value:null},alphaMapTransform:{value:new i.dwI},alphaTest:{value:0}}},u={basic:{uniforms:(0,i.Iit)([c.common,c.specularmap,c.envmap,c.aomap,c.lightmap,c.fog]),vertexShader:l.meshbasic_vert,fragmentShader:l.meshbasic_frag},lambert:{uniforms:(0,i.Iit)([c.common,c.specularmap,c.envmap,c.aomap,c.lightmap,c.emissivemap,c.bumpmap,c.normalmap,c.displacementmap,c.fog,c.lights,{emissive:{value:new i.Q1f(0)}}]),vertexShader:l.meshlambert_vert,fragmentShader:l.meshlambert_frag},phong:{uniforms:(0,i.Iit)([c.common,c.specularmap,c.envmap,c.aomap,c.lightmap,c.emissivemap,c.bumpmap,c.normalmap,c.displacementmap,c.fog,c.lights,{emissive:{value:new i.Q1f(0)},specular:{value:new i.Q1f(1118481)},shininess:{value:30}}]),vertexShader:l.meshphong_vert,fragmentShader:l.meshphong_frag},standard:{uniforms:(0,i.Iit)([c.common,c.envmap,c.aomap,c.lightmap,c.emissivemap,c.bumpmap,c.normalmap,c.displacementmap,c.roughnessmap,c.metalnessmap,c.fog,c.lights,{emissive:{value:new i.Q1f(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:l.meshphysical_vert,fragmentShader:l.meshphysical_frag},toon:{uniforms:(0,i.Iit)([c.common,c.aomap,c.lightmap,c.emissivemap,c.bumpmap,c.normalmap,c.displacementmap,c.gradientmap,c.fog,c.lights,{emissive:{value:new i.Q1f(0)}}]),vertexShader:l.meshtoon_vert,fragmentShader:l.meshtoon_frag},matcap:{uniforms:(0,i.Iit)([c.common,c.bumpmap,c.normalmap,c.displacementmap,c.fog,{matcap:{value:null}}]),vertexShader:l.meshmatcap_vert,fragmentShader:l.meshmatcap_frag},points:{uniforms:(0,i.Iit)([c.points,c.fog]),vertexShader:l.points_vert,fragmentShader:l.points_frag},dashed:{uniforms:(0,i.Iit)([c.common,c.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:l.linedashed_vert,fragmentShader:l.linedashed_frag},depth:{uniforms:(0,i.Iit)([c.common,c.displacementmap]),vertexShader:l.depth_vert,fragmentShader:l.depth_frag},normal:{uniforms:(0,i.Iit)([c.common,c.bumpmap,c.normalmap,c.displacementmap,{opacity:{value:1}}]),vertexShader:l.meshnormal_vert,fragmentShader:l.meshnormal_frag},sprite:{uniforms:(0,i.Iit)([c.sprite,c.fog]),vertexShader:l.sprite_vert,fragmentShader:l.sprite_frag},background:{uniforms:{uvTransform:{value:new i.dwI},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:l.background_vert,fragmentShader:l.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new i.dwI}},vertexShader:l.backgroundCube_vert,fragmentShader:l.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:l.cube_vert,fragmentShader:l.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:l.equirect_vert,fragmentShader:l.equirect_frag},distanceRGBA:{uniforms:(0,i.Iit)([c.common,c.displacementmap,{referencePosition:{value:new i.Pq0},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:l.distanceRGBA_vert,fragmentShader:l.distanceRGBA_frag},shadow:{uniforms:(0,i.Iit)([c.lights,c.fog,{color:{value:new i.Q1f(0)},opacity:{value:1}}]),vertexShader:l.shadow_vert,fragmentShader:l.shadow_frag}};u.physical={uniforms:(0,i.Iit)([u.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new i.dwI},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new i.dwI},clearcoatNormalScale:{value:new i.I9Y(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new i.dwI},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new i.dwI},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new i.dwI},sheen:{value:0},sheenColor:{value:new i.Q1f(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new i.dwI},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new i.dwI},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new i.dwI},transmissionSamplerSize:{value:new i.I9Y},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new i.dwI},attenuationDistance:{value:0},attenuationColor:{value:new i.Q1f(0)},specularColor:{value:new i.Q1f(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new i.dwI},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new i.dwI},anisotropyVector:{value:new i.I9Y},anisotropyMap:{value:null},anisotropyMapTransform:{value:new i.dwI}}]),vertexShader:l.meshphysical_vert,fragmentShader:l.meshphysical_frag};const h={r:0,b:0,g:0},d=new i.O9p,f=new i.kn4;function p(e,t,n,r,o,a,s){const l=new i.Q1f(0);let c,p,m=!0===a?0:1,g=null,v=0,y=null;function b(e){let r=!0===e.isScene?e.background:null;return r&&r.isTexture&&(r=(e.backgroundBlurriness>0?n:t).get(r)),r}function _(t,n){t.getRGB(h,(0,i._Ut)(e)),r.buffers.color.setClear(h.r,h.g,h.b,n,s)}return{getClearColor:function(){return l},setClearColor:function(e,t=1){l.set(e),m=t,_(l,m)},getClearAlpha:function(){return m},setClearAlpha:function(e){m=e,_(l,m)},render:function(t){let n=!1;const i=b(t);null===i?_(l,m):i&&i.isColor&&(_(i,1),n=!0);const o=e.xr.getEnvironmentBlendMode();"additive"===o?r.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===o&&r.buffers.color.setClear(0,0,0,0,s),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=b(n);r&&(r.isCubeTexture||r.mapping===i.Om)?(void 0===p&&(p=new i.eaF(new i.iNn(1,1,1),new i.BKk({name:"BackgroundCubeMaterial",uniforms:(0,i.lxW)(u.backgroundCube.uniforms),vertexShader:u.backgroundCube.vertexShader,fragmentShader:u.backgroundCube.fragmentShader,side:i.hsX,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(p)),d.copy(n.backgroundRotation),d.x*=-1,d.y*=-1,d.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(d.y*=-1,d.z*=-1),p.material.uniforms.envMap.value=r,p.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,p.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(f.makeRotationFromEuler(d)),p.material.toneMapped=i.ppV.getTransfer(r.colorSpace)!==i.KLL,g===r&&v===r.version&&y===e.toneMapping||(p.material.needsUpdate=!0,g=r,v=r.version,y=e.toneMapping),p.layers.enableAll(),t.unshift(p,p.geometry,p.material,0,0,null)):r&&r.isTexture&&(void 0===c&&(c=new i.eaF(new i.bdM(2,2),new i.BKk({name:"BackgroundMaterial",uniforms:(0,i.lxW)(u.background.uniforms),vertexShader:u.background.vertexShader,fragmentShader:u.background.fragmentShader,side:i.hB5,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(c)),c.material.uniforms.t2D.value=r,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.toneMapped=i.ppV.getTransfer(r.colorSpace)!==i.KLL,!0===r.matrixAutoUpdate&&r.updateMatrix(),c.material.uniforms.uvTransform.value.copy(r.matrix),g===r&&v===r.version&&y===e.toneMapping||(c.material.needsUpdate=!0,g=r,v=r.version,y=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null))},dispose:function(){void 0!==p&&(p.geometry.dispose(),p.material.dispose()),void 0!==c&&(c.geometry.dispose(),c.material.dispose())}}}function m(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},o=u(null);let a=o,s=!1;function l(t){return e.bindVertexArray(t)}function c(t){return e.deleteVertexArray(t)}function u(e){const t=[],r=[],i=[];for(let e=0;e<n;e++)t[e]=0,r[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function h(){const e=a.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function d(e){f(e,0)}function f(t,n){const r=a.newAttributes,i=a.enabledAttributes,o=a.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),o[t]!==n&&(e.vertexAttribDivisor(t,n),o[t]=n)}function p(){const t=a.newAttributes,n=a.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function m(t,n,r,i,o,a,s){!0===s?e.vertexAttribIPointer(t,n,r,o,a):e.vertexAttribPointer(t,n,r,i,o,a)}function g(){v(),s=!0,a!==o&&(a=o,l(a.object))}function v(){o.geometry=null,o.program=null,o.wireframe=!1}return{setup:function(n,o,c,g,v){let y=!1;const b=function(t,n,i){const o=!0===i.wireframe;let a=r[t.id];void 0===a&&(a={},r[t.id]=a);let s=a[n.id];void 0===s&&(s={},a[n.id]=s);let l=s[o];return void 0===l&&(l=u(e.createVertexArray()),s[o]=l),l}(g,c,o);a!==b&&(a=b,l(a.object)),y=function(e,t,n,r){const i=a.attributes,o=t.attributes;let s=0;const l=n.getAttributes();for(const t in l)if(l[t].location>=0){const n=i[t];let r=o[t];if(void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor)),void 0===n)return!0;if(n.attribute!==r)return!0;if(r&&n.data!==r.data)return!0;s++}return a.attributesNum!==s||a.index!==r}(n,g,c,v),y&&function(e,t,n,r){const i={},o=t.attributes;let s=0;const l=n.getAttributes();for(const t in l)if(l[t].location>=0){let n=o[t];void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor));const r={};r.attribute=n,n&&n.data&&(r.data=n.data),i[t]=r,s++}a.attributes=i,a.attributesNum=s,a.index=r}(n,g,c,v),null!==v&&t.update(v,e.ELEMENT_ARRAY_BUFFER),(y||s)&&(s=!1,function(n,r,o,a){h();const s=a.attributes,l=o.getAttributes(),c=r.defaultAttributeValues;for(const r in l){const o=l[r];if(o.location>=0){let l=s[r];if(void 0===l&&("instanceMatrix"===r&&n.instanceMatrix&&(l=n.instanceMatrix),"instanceColor"===r&&n.instanceColor&&(l=n.instanceColor)),void 0!==l){const r=l.normalized,s=l.itemSize,c=t.get(l);if(void 0===c)continue;const u=c.buffer,h=c.type,p=c.bytesPerElement,g=h===e.INT||h===e.UNSIGNED_INT||l.gpuType===i.Yuy;if(l.isInterleavedBufferAttribute){const t=l.data,i=t.stride,c=l.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<o.locationSize;e++)f(o.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<o.locationSize;e++)d(o.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<o.locationSize;e++)m(o.location+e,s/o.locationSize,h,r,i*p,(c+s/o.locationSize*e)*p,g)}else{if(l.isInstancedBufferAttribute){for(let e=0;e<o.locationSize;e++)f(o.location+e,l.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=l.meshPerAttribute*l.count)}else for(let e=0;e<o.locationSize;e++)d(o.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<o.locationSize;e++)m(o.location+e,s/o.locationSize,h,r,s*p,s/o.locationSize*e*p,g)}}else if(void 0!==c){const t=c[r];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(o.location,t);break;case 3:e.vertexAttrib3fv(o.location,t);break;case 4:e.vertexAttrib4fv(o.location,t);break;default:e.vertexAttrib1fv(o.location,t)}}}}p()}(n,o,c,g),null!==v&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(v).buffer))},reset:g,resetDefaultState:v,dispose:function(){g();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)c(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const e in t){const n=t[e];for(const e in n)c(n[e].object),delete n[e];delete t[e]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)c(i[e].object),delete i[e];delete n[e.id]}},initAttributes:h,enableAttribute:d,disableUnusedAttributes:p}}function g(e,t,n){let r;function i(t,i,o){0!==o&&(e.drawArraysInstanced(r,t,i,o),n.update(i,r,o))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,o);let a=0;for(let e=0;e<o;e++)a+=i[e];n.update(a,r,1)},this.renderMultiDrawInstances=function(e,o,a,s){if(0===a)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],o[t],s[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,o,0,s,0,a);let t=0;for(let e=0;e<a;e++)t+=o[e]*s[e];n.update(t,r,1)}}}function v(e,t,n,r){let o;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==n.precision?n.precision:"highp";const l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);const c=!0===n.logarithmicDepthBuffer,u=!0===n.reverseDepthBuffer&&t.has("EXT_clip_control"),h=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==o)return o;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");o=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o},getMaxPrecision:a,textureFormatReadable:function(t){return t===i.GWd||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const o=n===i.ix0&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==i.OUM&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==i.RQf&&!o)},precision:s,logarithmicDepthBuffer:c,reverseDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:d>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function y(e){const t=this;let n=null,r=0,o=!1,a=!1;const s=new i.Zcv,l=new i.dwI,c={value:null,needsUpdate:!1};function u(e,n,r,i){const o=null!==e?e.length:0;let a=null;if(0!==o){if(a=c.value,!0!==i||null===a){const t=r+4*o,i=n.matrixWorldInverse;l.getNormalMatrix(i),(null===a||a.length<t)&&(a=new Float32Array(t));for(let t=0,n=r;t!==o;++t,n+=4)s.copy(e[t]).applyMatrix4(i,l),s.normal.toArray(a,n),a[n+3]=s.constant}c.value=a,c.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,a}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||o;return o=t,r=e.length,n},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=u(e,t,0)},this.setState=function(i,s,l){const h=i.clippingPlanes,d=i.clipIntersection,f=i.clipShadows,p=e.get(i);if(!o||null===h||0===h.length||a&&!f)a?u(null):(c.value!==n&&(c.value=n,c.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0);else{const e=a?0:r,t=4*e;let i=p.clippingState||null;c.value=i,i=u(h,s,t,l);for(let e=0;e!==t;++e)i[e]=n[e];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function b(e){let t=new WeakMap;function n(e,t){return t===i.wfO?e.mapping=i.hy7:t===i.uV5&&(e.mapping=i.xFO),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(o){if(o&&o.isTexture){const a=o.mapping;if(a===i.wfO||a===i.uV5){if(t.has(o))return n(t.get(o).texture,o.mapping);{const a=o.image;if(a&&a.height>0){const s=new i.o6l(a.height);return s.fromEquirectangularTexture(e,o),t.set(o,s),o.addEventListener("dispose",r),n(s.texture,o.mapping)}return null}}}return o},dispose:function(){t=new WeakMap}}}const _=[.125,.215,.35,.446,.526,.582],w=new i.qUd,x=new i.Q1f;let S=null,E=0,A=0,M=!1;const T=(1+Math.sqrt(5))/2,C=1/T,I=[new i.Pq0(-T,C,0),new i.Pq0(T,C,0),new i.Pq0(-C,0,T),new i.Pq0(C,0,T),new i.Pq0(0,T,-C),new i.Pq0(0,T,C),new i.Pq0(-1,1,-1),new i.Pq0(1,1,-1),new i.Pq0(-1,1,1),new i.Pq0(1,1,1)];class R{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){S=this._renderer.getRenderTarget(),E=this._renderer.getActiveCubeFace(),A=this._renderer.getActiveMipmapLevel(),M=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=D(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=k(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(S,E,A),this._renderer.xr.enabled=M,e.scissorTest=!1,L(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===i.hy7||e.mapping===i.xFO?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),S=this._renderer.getRenderTarget(),E=this._renderer.getActiveCubeFace(),A=this._renderer.getActiveMipmapLevel(),M=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:i.k6q,minFilter:i.k6q,generateMipmaps:!1,type:i.ix0,format:i.GWd,colorSpace:i.Zr2,depthBuffer:!1},r=P(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=P(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let o=e;const a=e-4+1+_.length;for(let s=0;s<a;s++){const a=Math.pow(2,o);n.push(a);let l=1/a;s>e-4?l=_[s-e+4-1]:0===s&&(l=0),r.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,v=1,y=new Float32Array(m*p*f),b=new Float32Array(g*p*f),w=new Float32Array(v*p*f);for(let e=0;e<f;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];y.set(r,m*p*e),b.set(d,g*p*e);const i=[e,e,e,e,e,e];w.set(i,v*p*e)}const x=new i.LoY;x.setAttribute("position",new i.THS(y,m)),x.setAttribute("uv",new i.THS(b,g)),x.setAttribute("faceIndex",new i.THS(w,v)),t.push(x),o>4&&o--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(20),o=new i.Pq0(0,1,0);return new i.BKk({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:i.XIg,depthTest:!1,depthWrite:!1})}(r,e,t)}return r}_compileMaterial(e){const t=new i.eaF(this._lodPlanes[0],e);this._renderer.compile(t,w)}_sceneToCubeUV(e,t,n,r){const o=new i.ubm(90,1,t,n),a=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(x),l.toneMapping=i.y_p,l.autoClear=!1;const h=new i.V9B({name:"PMREM.Background",side:i.hsX,depthWrite:!1,depthTest:!1}),d=new i.eaF(new i.iNn,h);let f=!1;const p=e.background;p?p.isColor&&(h.color.copy(p),e.background=null,f=!0):(h.color.copy(x),f=!0);for(let t=0;t<6;t++){const n=t%3;0===n?(o.up.set(0,a[t],0),o.lookAt(s[t],0,0)):1===n?(o.up.set(0,0,a[t]),o.lookAt(0,s[t],0)):(o.up.set(0,a[t],0),o.lookAt(0,0,s[t]));const i=this._cubeSize;L(r,n*i,t>2?i:0,i,i),l.setRenderTarget(r),f&&l.render(d,o),l.render(e,o)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=u,l.autoClear=c,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===i.hy7||e.mapping===i.xFO;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=D()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=k());const o=r?this._cubemapMaterial:this._equirectMaterial,a=new i.eaF(this._lodPlanes[0],o);o.uniforms.envMap.value=e;const s=this._cubeSize;L(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,w)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let t=1;t<r;t++){const n=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=I[(r-t-1)%I.length];this._blur(e,t-1,t,n,i)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,o,a,s){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new i.eaF(this._lodPlanes[r],c),h=c.uniforms,d=this._sizeLods[n]-1,f=isFinite(o)?Math.PI/(2*d):2*Math.PI/39,p=o/f,m=isFinite(o)?1+Math.floor(3*p):20;m>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const g=[];let v=0;for(let e=0;e<20;++e){const t=e/p,n=Math.exp(-t*t/2);g.push(n),0===e?v+=n:e<m&&(v+=2*n)}for(let e=0;e<g.length;e++)g[e]=g[e]/v;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value="latitudinal"===a,s&&(h.poleAxis.value=s);const{_lodMax:y}=this;h.dTheta.value=f,h.mipInt.value=y-n;const b=this._sizeLods[r];L(t,3*b*(r>y-4?r-y+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(u,w)}}function P(e,t,n){const r=new i.nWS(e,t,n);return r.texture.mapping=i.Om,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function L(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function k(){return new i.BKk({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:i.XIg,depthTest:!1,depthWrite:!1})}function D(){return new i.BKk({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:i.XIg,depthTest:!1,depthWrite:!1})}function O(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(o){if(o&&o.isTexture){const a=o.mapping,s=a===i.wfO||a===i.uV5,l=a===i.hy7||a===i.xFO;if(s||l){let i=t.get(o);const a=void 0!==i?i.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==a)return null===n&&(n=new R(e)),i=s?n.fromEquirectangular(o,i):n.fromCubemap(o,i),i.texture.pmremVersion=o.pmremVersion,t.set(o,i),i.texture;if(void 0!==i)return i.texture;{const a=o.image;return s&&a&&a.height>0||l&&a&&function(e){let t=0;for(let n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(a)?(null===n&&(n=new R(e)),i=s?n.fromEquirectangular(o):n.fromCubemap(o),i.texture.pmremVersion=o.pmremVersion,t.set(o,i),o.addEventListener("dispose",r),i.texture):null}}}return o},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function N(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&(0,i.mcG)("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function U(e,t,n,r){const o={},a=new WeakMap;function s(e){const i=e.target;null!==i.index&&t.remove(i.index);for(const e in i.attributes)t.remove(i.attributes[e]);i.removeEventListener("dispose",s),delete o[i.id];const l=a.get(i);l&&(t.remove(l),a.delete(i)),r.releaseStatesOfGeometry(i),!0===i.isInstancedBufferGeometry&&delete i._maxInstanceCount,n.memory.geometries--}function l(e){const n=[],r=e.index,o=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],o=e[t+2];n.push(r,i,i,o,o,r)}}else{if(void 0===o)return;{const e=o.array;s=o.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const l=new((0,i.AQS)(n)?i.MW4:i.A$4)(n,1);l.version=s;const c=a.get(e);c&&t.remove(c),a.set(e,l)}return{get:function(e,t){return!0===o[t.id]||(t.addEventListener("dispose",s),o[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const n in r)t.update(r[n],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&l(e)}else l(e);return a.get(e)}}}function F(e,t,n){let r,i,o;function a(t,a,s){0!==s&&(e.drawElementsInstanced(r,a,i,t*o,s),n.update(a,r,s))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,o=e.bytesPerElement},this.render=function(t,a){e.drawElements(r,a,i,t*o),n.update(a,r,1)},this.renderInstances=a,this.renderMultiDraw=function(e,o,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,o,0,i,e,0,a);let s=0;for(let e=0;e<a;e++)s+=o[e];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,s,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)a(e[t]/o,s[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(r,s,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=s[e]*c[e];n.update(t,r,1)}}}function z(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function B(e,t,n){const r=new WeakMap,o=new i.IUQ;return{update:function(a,s,l){const c=a.morphTargetInfluences,u=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,h=void 0!==u?u.length:0;let d=r.get(s);if(void 0===d||d.count!==h){void 0!==d&&d.texture.dispose();const f=void 0!==s.morphAttributes.position,p=void 0!==s.morphAttributes.normal,m=void 0!==s.morphAttributes.color,g=s.morphAttributes.position||[],v=s.morphAttributes.normal||[],y=s.morphAttributes.color||[];let b=0;!0===f&&(b=1),!0===p&&(b=2),!0===m&&(b=3);let _=s.attributes.position.count*b,w=1;_>t.maxTextureSize&&(w=Math.ceil(_/t.maxTextureSize),_=t.maxTextureSize);const x=new Float32Array(_*w*4*h),S=new i.rFo(x,_,w,h);S.type=i.RQf,S.needsUpdate=!0;const E=4*b;for(let M=0;M<h;M++){const T=g[M],C=v[M],I=y[M],R=_*w*4*M;for(let P=0;P<T.count;P++){const L=P*E;!0===f&&(o.fromBufferAttribute(T,P),x[R+L+0]=o.x,x[R+L+1]=o.y,x[R+L+2]=o.z,x[R+L+3]=0),!0===p&&(o.fromBufferAttribute(C,P),x[R+L+4]=o.x,x[R+L+5]=o.y,x[R+L+6]=o.z,x[R+L+7]=0),!0===m&&(o.fromBufferAttribute(I,P),x[R+L+8]=o.x,x[R+L+9]=o.y,x[R+L+10]=o.z,x[R+L+11]=4===I.itemSize?o.w:1)}}function A(){S.dispose(),r.delete(s),s.removeEventListener("dispose",A)}d={count:h,texture:S,size:new i.I9Y(_,w)},r.set(s,d),s.addEventListener("dispose",A)}if(!0===a.isInstancedMesh&&null!==a.morphTexture)l.getUniforms().setValue(e,"morphTexture",a.morphTexture,n);else{let k=0;for(let O=0;O<c.length;O++)k+=c[O];const D=s.morphTargetsRelative?1:1-k;l.getUniforms().setValue(e,"morphTargetBaseInfluence",D),l.getUniforms().setValue(e,"morphTargetInfluences",c)}l.getUniforms().setValue(e,"morphTargetsTexture",d.texture,n),l.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function V(e,t,n,r){let i=new WeakMap;function o(e){const t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(a){const s=r.render.frame,l=a.geometry,c=t.get(a,l);if(i.get(c)!==s&&(t.update(c),i.set(c,s)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",o)&&a.addEventListener("dispose",o),i.get(a)!==s&&(n.update(a.instanceMatrix,e.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,e.ARRAY_BUFFER),i.set(a,s))),a.isSkinnedMesh){const e=a.skeleton;i.get(e)!==s&&(e.update(),i.set(e,s))}return c},dispose:function(){i=new WeakMap}}}const j=new i.gPd,H=new i.VCu(1,1),G=new i.rFo,W=new i.dYF,q=new i.b4q,X=[],$=[],Y=new Float32Array(16),K=new Float32Array(9),Z=new Float32Array(4);function Q(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let o=X[i];if(void 0===o&&(o=new Float32Array(i),X[i]=o),0!==t){r.toArray(o,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(o,i)}return o}function J(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ee(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function te(e,t){let n=$[t];void 0===n&&(n=new Int32Array(t),$[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ne(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function re(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(J(n,t))return;e.uniform2fv(this.addr,t),ee(n,t)}}function ie(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(J(n,t))return;e.uniform3fv(this.addr,t),ee(n,t)}}function oe(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(J(n,t))return;e.uniform4fv(this.addr,t),ee(n,t)}}function ae(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(J(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ee(n,t)}else{if(J(n,r))return;Z.set(r),e.uniformMatrix2fv(this.addr,!1,Z),ee(n,r)}}function se(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(J(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ee(n,t)}else{if(J(n,r))return;K.set(r),e.uniformMatrix3fv(this.addr,!1,K),ee(n,r)}}function le(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(J(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ee(n,t)}else{if(J(n,r))return;Y.set(r),e.uniformMatrix4fv(this.addr,!1,Y),ee(n,r)}}function ce(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ue(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(J(n,t))return;e.uniform2iv(this.addr,t),ee(n,t)}}function he(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(J(n,t))return;e.uniform3iv(this.addr,t),ee(n,t)}}function de(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(J(n,t))return;e.uniform4iv(this.addr,t),ee(n,t)}}function fe(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function pe(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(J(n,t))return;e.uniform2uiv(this.addr,t),ee(n,t)}}function me(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(J(n,t))return;e.uniform3uiv(this.addr,t),ee(n,t)}}function ge(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(J(n,t))return;e.uniform4uiv(this.addr,t),ee(n,t)}}function ve(e,t,n){const r=this.cache,o=n.allocateTextureUnit();let a;r[0]!==o&&(e.uniform1i(this.addr,o),r[0]=o),this.type===e.SAMPLER_2D_SHADOW?(H.compareFunction=i.TiK,a=H):a=j,n.setTexture2D(t||a,o)}function ye(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||W,i)}function be(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||q,i)}function _e(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||G,i)}function we(e,t){e.uniform1fv(this.addr,t)}function xe(e,t){const n=Q(t,this.size,2);e.uniform2fv(this.addr,n)}function Se(e,t){const n=Q(t,this.size,3);e.uniform3fv(this.addr,n)}function Ee(e,t){const n=Q(t,this.size,4);e.uniform4fv(this.addr,n)}function Ae(e,t){const n=Q(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Me(e,t){const n=Q(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Te(e,t){const n=Q(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Ce(e,t){e.uniform1iv(this.addr,t)}function Ie(e,t){e.uniform2iv(this.addr,t)}function Re(e,t){e.uniform3iv(this.addr,t)}function Pe(e,t){e.uniform4iv(this.addr,t)}function Le(e,t){e.uniform1uiv(this.addr,t)}function ke(e,t){e.uniform2uiv(this.addr,t)}function De(e,t){e.uniform3uiv(this.addr,t)}function Oe(e,t){e.uniform4uiv(this.addr,t)}function Ne(e,t,n){const r=this.cache,i=t.length,o=te(n,i);J(r,o)||(e.uniform1iv(this.addr,o),ee(r,o));for(let e=0;e!==i;++e)n.setTexture2D(t[e]||j,o[e])}function Ue(e,t,n){const r=this.cache,i=t.length,o=te(n,i);J(r,o)||(e.uniform1iv(this.addr,o),ee(r,o));for(let e=0;e!==i;++e)n.setTexture3D(t[e]||W,o[e])}function Fe(e,t,n){const r=this.cache,i=t.length,o=te(n,i);J(r,o)||(e.uniform1iv(this.addr,o),ee(r,o));for(let e=0;e!==i;++e)n.setTextureCube(t[e]||q,o[e])}function ze(e,t,n){const r=this.cache,i=t.length,o=te(n,i);J(r,o)||(e.uniform1iv(this.addr,o),ee(r,o));for(let e=0;e!==i;++e)n.setTexture2DArray(t[e]||G,o[e])}class Be{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return ne;case 35664:return re;case 35665:return ie;case 35666:return oe;case 35674:return ae;case 35675:return se;case 35676:return le;case 5124:case 35670:return ce;case 35667:case 35671:return ue;case 35668:case 35672:return he;case 35669:case 35673:return de;case 5125:return fe;case 36294:return pe;case 36295:return me;case 36296:return ge;case 35678:case 36198:case 36298:case 36306:case 35682:return ve;case 35679:case 36299:case 36307:return ye;case 35680:case 36300:case 36308:case 36293:return be;case 36289:case 36303:case 36311:case 36292:return _e}}(t.type)}}class Ve{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return we;case 35664:return xe;case 35665:return Se;case 35666:return Ee;case 35674:return Ae;case 35675:return Me;case 35676:return Te;case 5124:case 35670:return Ce;case 35667:case 35671:return Ie;case 35668:case 35672:return Re;case 35669:case 35673:return Pe;case 5125:return Le;case 36294:return ke;case 36295:return De;case 36296:return Oe;case 35678:case 36198:case 36298:case 36306:case 35682:return Ne;case 35679:case 36299:case 36307:return Ue;case 35680:case 36300:case 36308:case 36293:return Fe;case 36289:case 36303:case 36311:case 36292:return ze}}(t.type)}}class je{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(e,t[o.id],n)}}}const He=/(\w+)(\])?(\[|\.)?/g;function Ge(e,t){e.seq.push(t),e.map[t.id]=t}function We(e,t,n){const r=e.name,i=r.length;for(He.lastIndex=0;;){const o=He.exec(r),a=He.lastIndex;let s=o[1];const l="]"===o[2],c=o[3];if(l&&(s|=0),void 0===c||"["===c&&a+2===i){Ge(n,void 0===c?new Be(s,e,t):new Ve(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new je(s),Ge(n,e)),n=e}}}class qe{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);We(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,o=t.length;i!==o;++i){const o=t[i],a=n[o.id];!1!==a.needsUpdate&&o.setValue(e,a.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Xe(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let $e=0;const Ye=new i.dwI;function Ke(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const r=parseInt(o[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),o=Math.min(t+6,n.length);for(let e=i;e<o;e++){const i=e+1;r.push(`${i===t?">":" "} ${i}: ${n[e]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function Ze(e,t){const n=function(e){i.ppV._getMatrix(Ye,i.ppV.workingColorSpace,e);const t=`mat3( ${Ye.elements.map((e=>e.toFixed(4)))} )`;switch(i.ppV.getTransfer(e)){case i.VxR:return[t,"LinearTransferOETF"];case i.KLL:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function Qe(e,t){let n;switch(t){case i.kyO:n="Linear";break;case i.Mjd:n="Reinhard";break;case i.nNL:n="Cineon";break;case i.FV:n="ACESFilmic";break;case i.LAk:n="AgX";break;case i.aJ8:n="Neutral";break;case i.g7M:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Je=new i.Pq0;function et(e){return""!==e}function tt(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function nt(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const rt=/^[ \t]*#include +<([\w\d./]+)>/gm;function it(e){return e.replace(rt,at)}const ot=new Map;function at(e,t){let n=l[t];if(void 0===n){const e=ot.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=l[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return it(n)}const st=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lt(e){return e.replace(st,ct)}function ct(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function ut(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function ht(e,t,n,r){const o=e.getContext(),a=n.defines;let s=n.vertexShader,c=n.fragmentShader;const u=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===i.QP0?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===i.Wk7?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===i.RyA&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case i.hy7:case i.xFO:t="ENVMAP_TYPE_CUBE";break;case i.Om:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";return e.envMap&&e.envMapMode===i.xFO&&(t="ENVMAP_MODE_REFRACTION"),t}(n),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case i.caT:t="ENVMAP_BLENDING_MULTIPLY";break;case i.KRh:t="ENVMAP_BLENDING_MIX";break;case i.XrR:t="ENVMAP_BLENDING_ADD"}return t}(n),p=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),m=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(et).join("\n")}(n),g=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),v=o.createProgram();let y,b,_=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(et).join("\n"),y.length>0&&(y+="\n"),b=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(et).join("\n"),b.length>0&&(b+="\n")):(y=[ut(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(et).join("\n"),b=[ut(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+d:"",n.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==i.y_p?"#define TONE_MAPPING":"",n.toneMapping!==i.y_p?l.tonemapping_pars_fragment:"",n.toneMapping!==i.y_p?Qe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",l.colorspace_pars_fragment,Ze("linearToOutputTexel",n.outputColorSpace),(i.ppV.getLuminanceCoefficients(Je),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${Je.x.toFixed(4)}, ${Je.y.toFixed(4)}, ${Je.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(et).join("\n")),s=it(s),s=tt(s,n),s=nt(s,n),c=it(c),c=tt(c,n),c=nt(c,n),s=lt(s),c=lt(c),!0!==n.isRawShaderMaterial&&(_="#version 300 es\n",y=[m,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+y,b=["#define varying in",n.glslVersion===i.Wdf?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===i.Wdf?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+b);const w=_+y+s,x=_+b+c,S=Xe(o,o.VERTEX_SHADER,w),E=Xe(o,o.FRAGMENT_SHADER,x);function A(t){if(e.debug.checkShaderErrors){const n=o.getProgramInfoLog(v).trim(),r=o.getShaderInfoLog(S).trim(),i=o.getShaderInfoLog(E).trim();let a=!0,s=!0;if(!1===o.getProgramParameter(v,o.LINK_STATUS))if(a=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(o,v,S,E);else{const e=Ke(o,S,"vertex"),r=Ke(o,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(v,o.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+r)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==i||(s=!1);s&&(t.diagnostics={runnable:a,programLog:n,vertexShader:{log:r,prefix:y},fragmentShader:{log:i,prefix:b}})}o.deleteShader(S),o.deleteShader(E),M=new qe(o,v),T=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),o=r.name;let a=1;r.type===e.FLOAT_MAT2&&(a=2),r.type===e.FLOAT_MAT3&&(a=3),r.type===e.FLOAT_MAT4&&(a=4),n[o]={type:r.type,location:e.getAttribLocation(t,o),locationSize:a}}return n}(o,v)}let M,T;o.attachShader(v,S),o.attachShader(v,E),void 0!==n.index0AttributeName?o.bindAttribLocation(v,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(v,0,"position"),o.linkProgram(v),this.getUniforms=function(){return void 0===M&&A(this),M},this.getAttributes=function(){return void 0===T&&A(this),T};let C=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===C&&(C=o.getProgramParameter(v,37297)),C},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(v),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=$e++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=E,this}let dt=0;class ft{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new pt(e),t.set(e,n)),n}}class pt{constructor(e){this.id=dt++,this.code=e,this.usedTimes=0}}function mt(e,t,n,r,o,a,s){const l=new i.zgK,c=new ft,h=new Set,d=[],f=o.logarithmicDepthBuffer,p=o.vertexTextures;let m=o.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(e){return h.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(a,l,d,y,b){const _=y.fog,w=b.geometry,x=a.isMeshStandardMaterial?y.environment:null,S=(a.isMeshStandardMaterial?n:t).get(a.envMap||x),E=S&&S.mapping===i.Om?S.image.height:null,A=g[a.type];null!==a.precision&&(m=o.getMaxPrecision(a.precision),m!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",m,"instead."));const M=w.morphAttributes.position||w.morphAttributes.normal||w.morphAttributes.color,T=void 0!==M?M.length:0;let C,I,R,P,L=0;if(void 0!==w.morphAttributes.position&&(L=1),void 0!==w.morphAttributes.normal&&(L=2),void 0!==w.morphAttributes.color&&(L=3),A){const e=u[A];C=e.vertexShader,I=e.fragmentShader}else C=a.vertexShader,I=a.fragmentShader,c.update(a),R=c.getVertexShaderID(a),P=c.getFragmentShaderID(a);const k=e.getRenderTarget(),D=e.state.buffers.depth.getReversed(),O=!0===b.isInstancedMesh,N=!0===b.isBatchedMesh,U=!!a.map,F=!!a.matcap,z=!!S,B=!!a.aoMap,V=!!a.lightMap,j=!!a.bumpMap,H=!!a.normalMap,G=!!a.displacementMap,W=!!a.emissiveMap,q=!!a.metalnessMap,X=!!a.roughnessMap,$=a.anisotropy>0,Y=a.clearcoat>0,K=a.dispersion>0,Z=a.iridescence>0,Q=a.sheen>0,J=a.transmission>0,ee=$&&!!a.anisotropyMap,te=Y&&!!a.clearcoatMap,ne=Y&&!!a.clearcoatNormalMap,re=Y&&!!a.clearcoatRoughnessMap,ie=Z&&!!a.iridescenceMap,oe=Z&&!!a.iridescenceThicknessMap,ae=Q&&!!a.sheenColorMap,se=Q&&!!a.sheenRoughnessMap,le=!!a.specularMap,ce=!!a.specularColorMap,ue=!!a.specularIntensityMap,he=J&&!!a.transmissionMap,de=J&&!!a.thicknessMap,fe=!!a.gradientMap,pe=!!a.alphaMap,me=a.alphaTest>0,ge=!!a.alphaHash,ve=!!a.extensions;let ye=i.y_p;a.toneMapped&&(null!==k&&!0!==k.isXRRenderTarget||(ye=e.toneMapping));const be={shaderID:A,shaderType:a.type,shaderName:a.name,vertexShader:C,fragmentShader:I,defines:a.defines,customVertexShaderID:R,customFragmentShaderID:P,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:m,batching:N,batchingColor:N&&null!==b._colorsTexture,instancing:O,instancingColor:O&&null!==b.instanceColor,instancingMorph:O&&null!==b.morphTexture,supportsVertexTextures:p,outputColorSpace:null===k?e.outputColorSpace:!0===k.isXRRenderTarget?k.texture.colorSpace:i.Zr2,alphaToCoverage:!!a.alphaToCoverage,map:U,matcap:F,envMap:z,envMapMode:z&&S.mapping,envMapCubeUVHeight:E,aoMap:B,lightMap:V,bumpMap:j,normalMap:H,displacementMap:p&&G,emissiveMap:W,normalMapObjectSpace:H&&a.normalMapType===i.vyJ,normalMapTangentSpace:H&&a.normalMapType===i.bI3,metalnessMap:q,roughnessMap:X,anisotropy:$,anisotropyMap:ee,clearcoat:Y,clearcoatMap:te,clearcoatNormalMap:ne,clearcoatRoughnessMap:re,dispersion:K,iridescence:Z,iridescenceMap:ie,iridescenceThicknessMap:oe,sheen:Q,sheenColorMap:ae,sheenRoughnessMap:se,specularMap:le,specularColorMap:ce,specularIntensityMap:ue,transmission:J,transmissionMap:he,thicknessMap:de,gradientMap:fe,opaque:!1===a.transparent&&a.blending===i.NTi&&!1===a.alphaToCoverage,alphaMap:pe,alphaTest:me,alphaHash:ge,combine:a.combine,mapUv:U&&v(a.map.channel),aoMapUv:B&&v(a.aoMap.channel),lightMapUv:V&&v(a.lightMap.channel),bumpMapUv:j&&v(a.bumpMap.channel),normalMapUv:H&&v(a.normalMap.channel),displacementMapUv:G&&v(a.displacementMap.channel),emissiveMapUv:W&&v(a.emissiveMap.channel),metalnessMapUv:q&&v(a.metalnessMap.channel),roughnessMapUv:X&&v(a.roughnessMap.channel),anisotropyMapUv:ee&&v(a.anisotropyMap.channel),clearcoatMapUv:te&&v(a.clearcoatMap.channel),clearcoatNormalMapUv:ne&&v(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:re&&v(a.clearcoatRoughnessMap.channel),iridescenceMapUv:ie&&v(a.iridescenceMap.channel),iridescenceThicknessMapUv:oe&&v(a.iridescenceThicknessMap.channel),sheenColorMapUv:ae&&v(a.sheenColorMap.channel),sheenRoughnessMapUv:se&&v(a.sheenRoughnessMap.channel),specularMapUv:le&&v(a.specularMap.channel),specularColorMapUv:ce&&v(a.specularColorMap.channel),specularIntensityMapUv:ue&&v(a.specularIntensityMap.channel),transmissionMapUv:he&&v(a.transmissionMap.channel),thicknessMapUv:de&&v(a.thicknessMap.channel),alphaMapUv:pe&&v(a.alphaMap.channel),vertexTangents:!!w.attributes.tangent&&(H||$),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!w.attributes.color&&4===w.attributes.color.itemSize,pointsUvs:!0===b.isPoints&&!!w.attributes.uv&&(U||pe),fog:!!_,useFog:!0===a.fog,fogExp2:!!_&&_.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:f,reverseDepthBuffer:D,skinning:!0===b.isSkinnedMesh,morphTargets:void 0!==w.morphAttributes.position,morphNormals:void 0!==w.morphAttributes.normal,morphColors:void 0!==w.morphAttributes.color,morphTargetsCount:T,morphTextureStride:L,numDirLights:l.directional.length,numPointLights:l.point.length,numSpotLights:l.spot.length,numSpotLightMaps:l.spotLightMap.length,numRectAreaLights:l.rectArea.length,numHemiLights:l.hemi.length,numDirLightShadows:l.directionalShadowMap.length,numPointLightShadows:l.pointShadowMap.length,numSpotLightShadows:l.spotShadowMap.length,numSpotLightShadowsWithMaps:l.numSpotLightShadowsWithMaps,numLightProbes:l.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:ye,decodeVideoTexture:U&&!0===a.map.isVideoTexture&&i.ppV.getTransfer(a.map.colorSpace)===i.KLL,decodeVideoTextureEmissive:W&&!0===a.emissiveMap.isVideoTexture&&i.ppV.getTransfer(a.emissiveMap.colorSpace)===i.KLL,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===i.$EB,flipSided:a.side===i.hsX,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:ve&&!0===a.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ve&&!0===a.extensions.multiDraw||N)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return be.vertexUv1s=h.has(1),be.vertexUv2s=h.has(2),be.vertexUv3s=h.has(3),h.clear(),be},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){l.disableAll(),t.supportsVertexTextures&&l.enable(0),t.instancing&&l.enable(1),t.instancingColor&&l.enable(2),t.instancingMorph&&l.enable(3),t.matcap&&l.enable(4),t.envMap&&l.enable(5),t.normalMapObjectSpace&&l.enable(6),t.normalMapTangentSpace&&l.enable(7),t.clearcoat&&l.enable(8),t.iridescence&&l.enable(9),t.alphaTest&&l.enable(10),t.vertexColors&&l.enable(11),t.vertexAlphas&&l.enable(12),t.vertexUv1s&&l.enable(13),t.vertexUv2s&&l.enable(14),t.vertexUv3s&&l.enable(15),t.vertexTangents&&l.enable(16),t.anisotropy&&l.enable(17),t.alphaHash&&l.enable(18),t.batching&&l.enable(19),t.dispersion&&l.enable(20),t.batchingColor&&l.enable(21),e.push(l.mask),l.disableAll(),t.fog&&l.enable(0),t.useFog&&l.enable(1),t.flatShading&&l.enable(2),t.logarithmicDepthBuffer&&l.enable(3),t.reverseDepthBuffer&&l.enable(4),t.skinning&&l.enable(5),t.morphTargets&&l.enable(6),t.morphNormals&&l.enable(7),t.morphColors&&l.enable(8),t.premultipliedAlpha&&l.enable(9),t.shadowMapEnabled&&l.enable(10),t.doubleSided&&l.enable(11),t.flipSided&&l.enable(12),t.useDepthPacking&&l.enable(13),t.dithering&&l.enable(14),t.transmission&&l.enable(15),t.sheen&&l.enable(16),t.opaque&&l.enable(17),t.pointsUvs&&l.enable(18),t.decodeVideoTexture&&l.enable(19),t.decodeVideoTextureEmissive&&l.enable(20),t.alphaToCoverage&&l.enable(21),e.push(l.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=u[t];n=i.LlO.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,t=d.length;e<t;e++){const t=d[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new ht(e,n,t,a),d.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){const t=d.indexOf(e);d[t]=d[d.length-1],d.pop(),e.destroy()}},releaseShaderCache:function(e){c.remove(e)},programs:d,dispose:function(){c.dispose()}}}function gt(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function vt(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function yt(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function bt(){const e=[];let t=0;const n=[],r=[],i=[];function o(n,r,i,o,a,s){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:a,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=a,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,a,s,l,c){const u=o(e,t,a,s,l,c);a.transmission>0?r.push(u):!0===a.transparent?i.push(u):n.push(u)},unshift:function(e,t,a,s,l,c){const u=o(e,t,a,s,l,c);a.transmission>0?r.unshift(u):!0===a.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||vt),r.length>1&&r.sort(t||yt),i.length>1&&i.sort(t||yt)}}}function _t(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new bt,e.set(t,[i])):n>=r.length?(i=new bt,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function wt(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new i.Pq0,color:new i.Q1f};break;case"SpotLight":n={position:new i.Pq0,direction:new i.Pq0,color:new i.Q1f,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new i.Pq0,color:new i.Q1f,distance:0,decay:0};break;case"HemisphereLight":n={direction:new i.Pq0,skyColor:new i.Q1f,groundColor:new i.Q1f};break;case"RectAreaLight":n={color:new i.Q1f,position:new i.Pq0,halfWidth:new i.Pq0,halfHeight:new i.Pq0}}return e[t.id]=n,n}}}let xt=0;function St(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Et(e){const t=new wt,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new i.I9Y};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new i.I9Y,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)r.probe.push(new i.Pq0);const o=new i.Pq0,a=new i.kn4,s=new i.kn4;return{setup:function(i){let o=0,a=0,s=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let l=0,u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,b=0;i.sort(St);for(let e=0,c=i.length;e<c;e++){const c=i[e],_=c.color,w=c.intensity,x=c.distance,S=c.shadow&&c.shadow.map?c.shadow.map.texture:null;if(c.isAmbientLight)o+=_.r*w,a+=_.g*w,s+=_.b*w;else if(c.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(c.sh.coefficients[e],w);b++}else if(c.isDirectionalLight){const e=t.get(c);if(e.color.copy(c.color).multiplyScalar(c.intensity),c.castShadow){const e=c.shadow,t=n.get(c);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[l]=t,r.directionalShadowMap[l]=S,r.directionalShadowMatrix[l]=c.shadow.matrix,p++}r.directional[l]=e,l++}else if(c.isSpotLight){const e=t.get(c);e.position.setFromMatrixPosition(c.matrixWorld),e.color.copy(_).multiplyScalar(w),e.distance=x,e.coneCos=Math.cos(c.angle),e.penumbraCos=Math.cos(c.angle*(1-c.penumbra)),e.decay=c.decay,r.spot[h]=e;const i=c.shadow;if(c.map&&(r.spotLightMap[v]=c.map,v++,i.updateMatrices(c),c.castShadow&&y++),r.spotLightMatrix[h]=i.matrix,c.castShadow){const e=n.get(c);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,r.spotShadow[h]=e,r.spotShadowMap[h]=S,g++}h++}else if(c.isRectAreaLight){const e=t.get(c);e.color.copy(_).multiplyScalar(w),e.halfWidth.set(.5*c.width,0,0),e.halfHeight.set(0,.5*c.height,0),r.rectArea[d]=e,d++}else if(c.isPointLight){const e=t.get(c);if(e.color.copy(c.color).multiplyScalar(c.intensity),e.distance=c.distance,e.decay=c.decay,c.castShadow){const e=c.shadow,t=n.get(c);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[u]=t,r.pointShadowMap[u]=S,r.pointShadowMatrix[u]=c.shadow.matrix,m++}r.point[u]=e,u++}else if(c.isHemisphereLight){const e=t.get(c);e.skyColor.copy(c.color).multiplyScalar(w),e.groundColor.copy(c.groundColor).multiplyScalar(w),r.hemi[f]=e,f++}}d>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=c.LTC_FLOAT_1,r.rectAreaLTC2=c.LTC_FLOAT_2):(r.rectAreaLTC1=c.LTC_HALF_1,r.rectAreaLTC2=c.LTC_HALF_2)),r.ambient[0]=o,r.ambient[1]=a,r.ambient[2]=s;const _=r.hash;_.directionalLength===l&&_.pointLength===u&&_.spotLength===h&&_.rectAreaLength===d&&_.hemiLength===f&&_.numDirectionalShadows===p&&_.numPointShadows===m&&_.numSpotShadows===g&&_.numSpotMaps===v&&_.numLightProbes===b||(r.directional.length=l,r.spot.length=h,r.rectArea.length=d,r.point.length=u,r.hemi.length=f,r.directionalShadow.length=p,r.directionalShadowMap.length=p,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=p,r.pointShadowMatrix.length=m,r.spotLightMatrix.length=g+v-y,r.spotLightMap.length=v,r.numSpotLightShadowsWithMaps=y,r.numLightProbes=b,_.directionalLength=l,_.pointLength=u,_.spotLength=h,_.rectAreaLength=d,_.hemiLength=f,_.numDirectionalShadows=p,_.numPointShadows=m,_.numSpotShadows=g,_.numSpotMaps=v,_.numLightProbes=b,r.version=xt++)},setupView:function(e,t){let n=0,i=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),n++}else if(d.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),o.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(o),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),s.identity(),a.copy(d.matrixWorld),a.premultiply(h),s.extractRotation(a),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(d.isPointLight){const e=r.point[i];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),i++}else if(d.isHemisphereLight){const e=r.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),u++}}},state:r}}function At(e){const t=new Et(e),n=[],r=[],i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function Mt(e){let t=new WeakMap;return{get:function(n,r=0){const i=t.get(n);let o;return void 0===i?(o=new At(e),t.set(n,[o])):r>=i.length?(o=new At(e),i.push(o)):o=i[r],o},dispose:function(){t=new WeakMap}}}function Tt(e,t,n){let r=new i.PPD;const o=new i.I9Y,a=new i.I9Y,s=new i.IUQ,l=new i.CSG({depthPacking:i.N5j}),c=new i.aVO,u={},h=n.maxTextureSize,d={[i.hB5]:i.hsX,[i.hsX]:i.hB5,[i.$EB]:i.$EB},f=new i.BKk({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new i.I9Y},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=f.clone();p.defines.HORIZONTAL_PASS=1;const m=new i.LoY;m.setAttribute("position",new i.THS(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new i.eaF(m,f),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=i.QP0;let y=this.type;function b(n,r){const a=t.update(g);f.defines.VSM_SAMPLES!==n.blurSamples&&(f.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new i.nWS(o.x,o.y)),f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,f,g,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,p,g,null)}function _(t,n,r,o){let a=null;const s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)a=s;else if(a=!0===r.isPointLight?c:l,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=a.uuid,t=n.uuid;let r=u[e];void 0===r&&(r={},u[e]=r);let i=r[t];void 0===i&&(i=a.clone(),r[t]=i,n.addEventListener("dispose",x)),a=i}return a.visible=n.visible,a.wireframe=n.wireframe,o===i.RyA?a.side=null!==n.shadowSide?n.shadowSide:n.side:a.side=null!==n.shadowSide?n.shadowSide:d[n.side],a.alphaMap=n.alphaMap,a.alphaTest=n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial&&(e.properties.get(a).light=r),a}function w(n,o,a,s,l){if(!1===n.visible)return;if(n.layers.test(o.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&l===i.RyA)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],h=i[u.materialIndex];if(h&&h.visible){const t=_(n,h,s,l);n.onBeforeShadow(e,n,o,a,r,t,u),e.renderBufferDirect(a,null,r,t,n,u),n.onAfterShadow(e,n,o,a,r,t,u)}}}else if(i.visible){const t=_(n,i,s,l);n.onBeforeShadow(e,n,o,a,r,t,null),e.renderBufferDirect(a,null,r,t,n,null),n.onAfterShadow(e,n,o,a,r,t,null)}}const c=n.children;for(let e=0,t=c.length;e<t;e++)w(c[e],o,a,s,l)}function x(e){e.target.removeEventListener("dispose",x);for(const t in u){const n=u[t],r=e.target.uuid;r in n&&(n[r].dispose(),delete n[r])}}this.render=function(t,n,l){if(!1===v.enabled)return;if(!1===v.autoUpdate&&!1===v.needsUpdate)return;if(0===t.length)return;const c=e.getRenderTarget(),u=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.state;f.setBlending(i.XIg),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);const p=y!==i.RyA&&this.type===i.RyA,m=y===i.RyA&&this.type!==i.RyA;for(let c=0,u=t.length;c<u;c++){const u=t[c],d=u.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",u,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;o.copy(d.mapSize);const g=d.getFrameExtents();if(o.multiply(g),a.copy(d.mapSize),(o.x>h||o.y>h)&&(o.x>h&&(a.x=Math.floor(h/g.x),o.x=a.x*g.x,d.mapSize.x=a.x),o.y>h&&(a.y=Math.floor(h/g.y),o.y=a.y*g.y,d.mapSize.y=a.y)),null===d.map||!0===p||!0===m){const e=this.type!==i.RyA?{minFilter:i.hxR,magFilter:i.hxR}:{};null!==d.map&&d.map.dispose(),d.map=new i.nWS(o.x,o.y,e),d.map.texture.name=u.name+".shadowMap",d.camera.updateProjectionMatrix()}e.setRenderTarget(d.map),e.clear();const v=d.getViewportCount();for(let e=0;e<v;e++){const t=d.getViewport(e);s.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),f.viewport(s),d.updateMatrices(u,e),r=d.getFrustum(),w(n,l,d.camera,u,this.type)}!0!==d.isPointLightShadow&&this.type===i.RyA&&b(d,l),d.needsUpdate=!1}y=this.type,v.needsUpdate=!1,e.setRenderTarget(c,u,d)}}const Ct={[i.eHc]:i.lGu,[i.brA]:i.K52,[i.U3G]:i.bw0,[i.xSv]:i.Gwm,[i.lGu]:i.eHc,[i.K52]:i.brA,[i.bw0]:i.U3G,[i.Gwm]:i.xSv};function It(e,t){const n=new function(){let t=!1;const n=new i.IUQ;let r=null;const o=new i.IUQ(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,i,a,s){!0===s&&(t*=a,r*=a,i*=a),n.set(t,r,i,a),!1===o.equals(n)&&(e.clearColor(t,r,i,a),o.copy(n))},reset:function(){t=!1,r=null,o.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,o=null,a=null,s=null;return{setReversed:function(e){if(r!==e){const e=t.get("EXT_clip_control");r?e.clipControlEXT(e.LOWER_LEFT_EXT,e.ZERO_TO_ONE_EXT):e.clipControlEXT(e.LOWER_LEFT_EXT,e.NEGATIVE_ONE_TO_ONE_EXT);const n=s;s=null,this.setClear(n)}r=e},getReversed:function(){return r},setTest:function(t){t?V(e.DEPTH_TEST):j(e.DEPTH_TEST)},setMask:function(t){o===t||n||(e.depthMask(t),o=t)},setFunc:function(t){if(r&&(t=Ct[t]),a!==t){switch(t){case i.eHc:e.depthFunc(e.NEVER);break;case i.lGu:e.depthFunc(e.ALWAYS);break;case i.brA:e.depthFunc(e.LESS);break;case i.xSv:e.depthFunc(e.LEQUAL);break;case i.U3G:e.depthFunc(e.EQUAL);break;case i.Gwm:e.depthFunc(e.GEQUAL);break;case i.K52:e.depthFunc(e.GREATER);break;case i.bw0:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}a=t}},setLocked:function(e){n=e},setClear:function(t){s!==t&&(r&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){n=!1,o=null,a=null,s=null,r=!1}}},o=new function(){let t=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,c=null;return{setTest:function(n){t||(n?V(e.STENCIL_TEST):j(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&l===r||(e.stencilOp(t,n,r),a=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,l=null,c=null}}},a=new WeakMap,s=new WeakMap;let l={},c={},u=new WeakMap,h=[],d=null,f=!1,p=null,m=null,g=null,v=null,y=null,b=null,_=null,w=new i.Q1f(0,0,0),x=0,S=!1,E=null,A=null,M=null,T=null,C=null;const I=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let R=!1,P=0;const L=e.getParameter(e.VERSION);-1!==L.indexOf("WebGL")?(P=parseFloat(/^WebGL (\d)/.exec(L)[1]),R=P>=1):-1!==L.indexOf("OpenGL ES")&&(P=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),R=P>=2);let k=null,D={};const O=e.getParameter(e.SCISSOR_BOX),N=e.getParameter(e.VIEWPORT),U=(new i.IUQ).fromArray(O),F=(new i.IUQ).fromArray(N);function z(t,n,r,i){const o=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let a=0;a<r;a++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage2D(n+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o);return a}const B={};function V(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function j(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}B[e.TEXTURE_2D]=z(e.TEXTURE_2D,e.TEXTURE_2D,1),B[e.TEXTURE_CUBE_MAP]=z(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),B[e.TEXTURE_2D_ARRAY]=z(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),B[e.TEXTURE_3D]=z(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),o.setClear(0),V(e.DEPTH_TEST),r.setFunc(i.xSv),q(!1),X(i.Vb5),V(e.CULL_FACE),W(i.XIg);const H={[i.gO9]:e.FUNC_ADD,[i.FXf]:e.FUNC_SUBTRACT,[i.nST]:e.FUNC_REVERSE_SUBTRACT};H[i.znC]=e.MIN,H[i.$ei]=e.MAX;const G={[i.ojh]:e.ZERO,[i.qad]:e.ONE,[i.f4X]:e.SRC_COLOR,[i.ie2]:e.SRC_ALPHA,[i.hgQ]:e.SRC_ALPHA_SATURATE,[i.wn6]:e.DST_COLOR,[i.hdd]:e.DST_ALPHA,[i.LiQ]:e.ONE_MINUS_SRC_COLOR,[i.OuU]:e.ONE_MINUS_SRC_ALPHA,[i.aEY]:e.ONE_MINUS_DST_COLOR,[i.Nt7]:e.ONE_MINUS_DST_ALPHA,[i.RrE]:e.CONSTANT_COLOR,[i.$Yl]:e.ONE_MINUS_CONSTANT_COLOR,[i.e0p]:e.CONSTANT_ALPHA,[i.ov9]:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,n,r,o,a,s,l,c,u,h){if(t!==i.XIg){if(!1===f&&(V(e.BLEND),f=!0),t===i.bCz)a=a||n,s=s||r,l=l||o,n===m&&a===y||(e.blendEquationSeparate(H[n],H[a]),m=n,y=a),r===g&&o===v&&s===b&&l===_||(e.blendFuncSeparate(G[r],G[o],G[s],G[l]),g=r,v=o,b=s,_=l),!1!==c.equals(w)&&u===x||(e.blendColor(c.r,c.g,c.b,u),w.copy(c),x=u),p=t,S=!1;else if(t!==p||h!==S){if(m===i.gO9&&y===i.gO9||(e.blendEquation(e.FUNC_ADD),m=i.gO9,y=i.gO9),h)switch(t){case i.NTi:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case i.EZo:e.blendFunc(e.ONE,e.ONE);break;case i.Kwu:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case i.EdD:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case i.NTi:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case i.EZo:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case i.Kwu:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case i.EdD:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,v=null,b=null,_=null,w.set(0,0,0),x=0,p=t,S=h}}else!0===f&&(j(e.BLEND),f=!1)}function q(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function X(t){t!==i.WNZ?(V(e.CULL_FACE),t!==A&&(t===i.Vb5?e.cullFace(e.BACK):t===i.Jnc?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):j(e.CULL_FACE),A=t}function $(t,n,r){t?(V(e.POLYGON_OFFSET_FILL),T===n&&C===r||(e.polygonOffset(n,r),T=n,C=r)):j(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:o},enable:V,disable:j,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=h,i=!1;if(t){r=u.get(n),void 0===r&&(r=[],u.set(n,r));const o=t.textures;if(r.length!==o.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=o.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=o.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,a){t.side===i.$EB?j(e.CULL_FACE):V(e.CULL_FACE);let s=t.side===i.hsX;a&&(s=!s),q(s),t.blending===i.NTi&&!1===t.transparent?W(i.XIg):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite);const l=t.stencilWrite;o.setTest(l),l&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),$(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?V(e.SAMPLE_ALPHA_TO_COVERAGE):j(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:X,setLineWidth:function(t){t!==M&&(R&&e.lineWidth(t),M=t)},setPolygonOffset:$,setScissorTest:function(t){t?V(e.SCISSOR_TEST):j(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+I-1),k!==t&&(e.activeTexture(t),k=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===k?e.TEXTURE0+I-1:k);let i=D[r];void 0===i&&(i={type:void 0,texture:void 0},D[r]=i),i.type===t&&i.texture===n||(k!==r&&(e.activeTexture(r),k=r),e.bindTexture(t,n||B[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=D[k];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);a.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),a.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===U.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),r.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},k=null,D={},c={},u=new WeakMap,h=[],d=null,f=!1,p=null,m=null,g=null,v=null,y=null,b=null,_=null,w=new i.Q1f(0,0,0),x=0,S=!1,E=null,A=null,M=null,T=null,C=null,U.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),n.reset(),r.reset(),o.reset()}}}function Rt(e,t,n,r,o,a,s){const l=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),u=new i.I9Y,h=new WeakMap;let d;const f=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return p?new OffscreenCanvas(e,t):(0,i.qq$)("canvas")}function g(e,t,n){let r=1;const i=j(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),o=Math.floor(r*i.height);void 0===d&&(d=m(n,o));const a=t?m(n,o):d;return a.width=n,a.height=o,a.getContext("2d").drawImage(e,0,0,n,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+o+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function v(e){return e.generateMipmaps}function y(t){e.generateMipmap(t)}function b(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function _(n,r,o,a,s=!1){if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;if(r===e.RED&&(o===e.FLOAT&&(l=e.R32F),o===e.HALF_FLOAT&&(l=e.R16F),o===e.UNSIGNED_BYTE&&(l=e.R8)),r===e.RED_INTEGER&&(o===e.UNSIGNED_BYTE&&(l=e.R8UI),o===e.UNSIGNED_SHORT&&(l=e.R16UI),o===e.UNSIGNED_INT&&(l=e.R32UI),o===e.BYTE&&(l=e.R8I),o===e.SHORT&&(l=e.R16I),o===e.INT&&(l=e.R32I)),r===e.RG&&(o===e.FLOAT&&(l=e.RG32F),o===e.HALF_FLOAT&&(l=e.RG16F),o===e.UNSIGNED_BYTE&&(l=e.RG8)),r===e.RG_INTEGER&&(o===e.UNSIGNED_BYTE&&(l=e.RG8UI),o===e.UNSIGNED_SHORT&&(l=e.RG16UI),o===e.UNSIGNED_INT&&(l=e.RG32UI),o===e.BYTE&&(l=e.RG8I),o===e.SHORT&&(l=e.RG16I),o===e.INT&&(l=e.RG32I)),r===e.RGB_INTEGER&&(o===e.UNSIGNED_BYTE&&(l=e.RGB8UI),o===e.UNSIGNED_SHORT&&(l=e.RGB16UI),o===e.UNSIGNED_INT&&(l=e.RGB32UI),o===e.BYTE&&(l=e.RGB8I),o===e.SHORT&&(l=e.RGB16I),o===e.INT&&(l=e.RGB32I)),r===e.RGBA_INTEGER&&(o===e.UNSIGNED_BYTE&&(l=e.RGBA8UI),o===e.UNSIGNED_SHORT&&(l=e.RGBA16UI),o===e.UNSIGNED_INT&&(l=e.RGBA32UI),o===e.BYTE&&(l=e.RGBA8I),o===e.SHORT&&(l=e.RGBA16I),o===e.INT&&(l=e.RGBA32I)),r===e.RGB&&o===e.UNSIGNED_INT_5_9_9_9_REV&&(l=e.RGB9_E5),r===e.RGBA){const t=s?i.VxR:i.ppV.getTransfer(a);o===e.FLOAT&&(l=e.RGBA32F),o===e.HALF_FLOAT&&(l=e.RGBA16F),o===e.UNSIGNED_BYTE&&(l=t===i.KLL?e.SRGB8_ALPHA8:e.RGBA8),o===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),o===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)}return l!==e.R16F&&l!==e.R32F&&l!==e.RG16F&&l!==e.RG32F&&l!==e.RGBA16F&&l!==e.RGBA32F||t.get("EXT_color_buffer_float"),l}function w(t,n){let r;return t?null===n||n===i.bkx||n===i.V3x?r=e.DEPTH24_STENCIL8:n===i.RQf?r=e.DEPTH32F_STENCIL8:n===i.cHt&&(r=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===i.bkx||n===i.V3x?r=e.DEPTH_COMPONENT24:n===i.RQf?r=e.DEPTH_COMPONENT32F:n===i.cHt&&(r=e.DEPTH_COMPONENT16),r}function x(e,t){return!0===v(e)||e.isFramebufferTexture&&e.minFilter!==i.hxR&&e.minFilter!==i.k6q?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){const t=e.target;t.removeEventListener("dispose",S),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=f.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&A(e),0===Object.keys(i).length&&f.delete(n)}r.remove(e)}(t),t.isVideoTexture&&h.delete(t)}function E(t){const n=t.target;n.removeEventListener("dispose",E),function(t){const n=r.get(t);if(t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture)),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(n.__webglFramebuffer[t]))for(let r=0;r<n.__webglFramebuffer[t].length;r++)e.deleteFramebuffer(n.__webglFramebuffer[t][r]);else e.deleteFramebuffer(n.__webglFramebuffer[t]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=t.textures;for(let t=0,n=i.length;t<n;t++){const n=r.get(i[t]);n.__webglTexture&&(e.deleteTexture(n.__webglTexture),s.memory.textures--),r.remove(i[t])}r.remove(t)}(n)}function A(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete f.get(i)[n.__cacheKey],s.memory.textures--}let M=0;function T(t,i){const o=r.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;h.get(e)!==t&&(h.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&o.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void k(o,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,o.__webglTexture,e.TEXTURE0+i)}const C={[i.GJx]:e.REPEAT,[i.ghU]:e.CLAMP_TO_EDGE,[i.kTW]:e.MIRRORED_REPEAT},I={[i.hxR]:e.NEAREST,[i.pHI]:e.NEAREST_MIPMAP_NEAREST,[i.Cfg]:e.NEAREST_MIPMAP_LINEAR,[i.k6q]:e.LINEAR,[i.kRr]:e.LINEAR_MIPMAP_NEAREST,[i.$_I]:e.LINEAR_MIPMAP_LINEAR},R={[i.amv]:e.NEVER,[i.FFZ]:e.ALWAYS,[i.vim]:e.LESS,[i.TiK]:e.LEQUAL,[i.kO0]:e.EQUAL,[i.gWB]:e.GEQUAL,[i.eoi]:e.GREATER,[i.jzd]:e.NOTEQUAL};function P(n,a){if(a.type!==i.RQf||!1!==t.has("OES_texture_float_linear")||a.magFilter!==i.k6q&&a.magFilter!==i.kRr&&a.magFilter!==i.Cfg&&a.magFilter!==i.$_I&&a.minFilter!==i.k6q&&a.minFilter!==i.kRr&&a.minFilter!==i.Cfg&&a.minFilter!==i.$_I||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,C[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,C[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,C[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,I[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,I[a.minFilter]),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,R[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(a.magFilter===i.hxR)return;if(a.minFilter!==i.Cfg&&a.minFilter!==i.$_I)return;if(a.type===i.RQf&&!1===t.has("OES_texture_float_linear"))return;if(a.anisotropy>1||r.get(a).__currentAnisotropy){const i=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,o.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy}}}function L(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S));const i=n.source;let o=f.get(i);void 0===o&&(o={},f.set(i,o));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(a!==t.__cacheKey){void 0===o[a]&&(o[a]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),o[a].usedTimes++;const i=o[t.__cacheKey];void 0!==i&&(o[t.__cacheKey].usedTimes--,0===i.usedTimes&&A(n)),t.__cacheKey=a,t.__webglTexture=o[a].texture}return r}function k(t,s,l){let c=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(c=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(c=e.TEXTURE_3D);const u=L(t,s),h=s.source;n.bindTexture(c,t.__webglTexture,e.TEXTURE0+l);const d=r.get(h);if(h.version!==d.__version||!0===u){n.activeTexture(e.TEXTURE0+l);const t=i.ppV.getPrimaries(i.ppV.workingColorSpace),r=s.colorSpace===i.jf0?null:i.ppV.getPrimaries(s.colorSpace),f=s.colorSpace===i.jf0||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,f);let p=g(s.image,!1,o.maxTextureSize);p=V(s,p);const m=a.convert(s.format,s.colorSpace),b=a.convert(s.type);let S,E=_(s.internalFormat,m,b,s.colorSpace,s.isVideoTexture);P(c,s);const A=s.mipmaps,M=!0!==s.isVideoTexture,T=void 0===d.__version||!0===u,C=h.dataReady,I=x(s,p);if(s.isDepthTexture)E=w(s.format===i.dcC,s.type),T&&(M?n.texStorage2D(e.TEXTURE_2D,1,E,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,E,p.width,p.height,0,m,b,null));else if(s.isDataTexture)if(A.length>0){M&&T&&n.texStorage2D(e.TEXTURE_2D,I,E,A[0].width,A[0].height);for(let t=0,r=A.length;t<r;t++)S=A[t],M?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,m,b,S.data):n.texImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,m,b,S.data);s.generateMipmaps=!1}else M?(T&&n.texStorage2D(e.TEXTURE_2D,I,E,p.width,p.height),C&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p.width,p.height,m,b,p.data)):n.texImage2D(e.TEXTURE_2D,0,E,p.width,p.height,0,m,b,p.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){M&&T&&n.texStorage3D(e.TEXTURE_2D_ARRAY,I,E,A[0].width,A[0].height,p.depth);for(let t=0,r=A.length;t<r;t++)if(S=A[t],s.format!==i.GWd)if(null!==m)if(M){if(C)if(s.layerUpdates.size>0){const r=(0,i.Nex)(S.width,S.height,s.format,s.type);for(const i of s.layerUpdates){const o=S.data.subarray(i*r/S.data.BYTES_PER_ELEMENT,(i+1)*r/S.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,i,S.width,S.height,1,m,o)}s.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,p.depth,m,S.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,E,S.width,S.height,p.depth,0,S.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else M?C&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,p.depth,m,b,S.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,E,S.width,S.height,p.depth,0,m,b,S.data)}else{M&&T&&n.texStorage2D(e.TEXTURE_2D,I,E,A[0].width,A[0].height);for(let t=0,r=A.length;t<r;t++)S=A[t],s.format!==i.GWd?null!==m?M?C&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,m,S.data):n.compressedTexImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):M?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,m,b,S.data):n.texImage2D(e.TEXTURE_2D,t,E,S.width,S.height,0,m,b,S.data)}else if(s.isDataArrayTexture)if(M){if(T&&n.texStorage3D(e.TEXTURE_2D_ARRAY,I,E,p.width,p.height,p.depth),C)if(s.layerUpdates.size>0){const t=(0,i.Nex)(p.width,p.height,s.format,s.type);for(const r of s.layerUpdates){const i=p.data.subarray(r*t/p.data.BYTES_PER_ELEMENT,(r+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,p.width,p.height,1,m,b,i)}s.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,m,b,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,E,p.width,p.height,p.depth,0,m,b,p.data);else if(s.isData3DTexture)M?(T&&n.texStorage3D(e.TEXTURE_3D,I,E,p.width,p.height,p.depth),C&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,m,b,p.data)):n.texImage3D(e.TEXTURE_3D,0,E,p.width,p.height,p.depth,0,m,b,p.data);else if(s.isFramebufferTexture){if(T)if(M)n.texStorage2D(e.TEXTURE_2D,I,E,p.width,p.height);else{let t=p.width,r=p.height;for(let i=0;i<I;i++)n.texImage2D(e.TEXTURE_2D,i,E,t,r,0,m,b,null),t>>=1,r>>=1}}else if(A.length>0){if(M&&T){const t=j(A[0]);n.texStorage2D(e.TEXTURE_2D,I,E,t.width,t.height)}for(let t=0,r=A.length;t<r;t++)S=A[t],M?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,m,b,S):n.texImage2D(e.TEXTURE_2D,t,E,m,b,S);s.generateMipmaps=!1}else if(M){if(T){const t=j(p);n.texStorage2D(e.TEXTURE_2D,I,E,t.width,t.height)}C&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,m,b,p)}else n.texImage2D(e.TEXTURE_2D,0,E,m,b,p);v(s)&&y(c),d.__version=h.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function D(t,i,o,s,c,u){const h=a.convert(o.format,o.colorSpace),d=a.convert(o.type),f=_(o.internalFormat,h,d,o.colorSpace),p=r.get(i),m=r.get(o);if(m.__renderTarget=i,!p.__hasExternalTextures){const t=Math.max(1,i.width>>u),r=Math.max(1,i.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,t,r,i.depth,0,h,d,null):n.texImage2D(c,u,f,t,r,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),B(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,c,m.__webglTexture,0,z(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function O(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,o=i&&i.isDepthTexture?i.type:null,a=w(n.stencilBuffer,o),s=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=z(n);B(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,a,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,a,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,a,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,s,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const o=t[i],s=a.convert(o.format,o.colorSpace),c=a.convert(o.type),u=_(o.internalFormat,s,c,o.colorSpace),h=z(n);r&&!1===B(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,u,n.width,n.height):B(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function N(t){const o=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(o.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(o.__depthDisposeCallback&&o.__depthDisposeCallback(),e){const t=()=>{delete o.__boundDepthTexture,delete o.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),o.__depthDisposeCallback=t}o.__boundDepthTexture=e}if(t.depthTexture&&!o.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,o){if(o&&o.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!o.depthTexture||!o.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const a=r.get(o.depthTexture);a.__renderTarget=o,a.__webglTexture&&o.depthTexture.image.width===o.width&&o.depthTexture.image.height===o.height||(o.depthTexture.image.width=o.width,o.depthTexture.image.height=o.height,o.depthTexture.needsUpdate=!0),T(o.depthTexture,0);const s=a.__webglTexture,c=z(o);if(o.depthTexture.format===i.zdS)B(o)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,c):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(o.depthTexture.format!==i.dcC)throw new Error("Unknown depthTexture format");B(o)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,c):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(o.__webglFramebuffer,t)}else if(a){o.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer[r]),void 0===o.__webglDepthbuffer[r])o.__webglDepthbuffer[r]=e.createRenderbuffer(),O(o.__webglDepthbuffer[r],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=o.__webglDepthbuffer[r];e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}}else if(n.bindFramebuffer(e.FRAMEBUFFER,o.__webglFramebuffer),void 0===o.__webglDepthbuffer)o.__webglDepthbuffer=e.createRenderbuffer(),O(o.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,r=o.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,r)}n.bindFramebuffer(e.FRAMEBUFFER,null)}const U=[],F=[];function z(e){return Math.min(o.maxSamples,e.samples)}function B(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function V(e,t){const n=e.colorSpace,r=e.format,o=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==i.Zr2&&n!==i.jf0&&(i.ppV.getTransfer(n)===i.KLL?r===i.GWd&&o===i.OUM||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function j(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(u.width=e.naturalWidth||e.width,u.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(u.width=e.displayWidth,u.height=e.displayHeight):(u.width=e.width,u.height=e.height),u}this.allocateTextureUnit=function(){const e=M;return e>=o.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+o.maxTextures),M+=1,e},this.resetTextureUnits=function(){M=0},this.setTexture2D=T,this.setTexture2DArray=function(t,i){const o=r.get(t);t.version>0&&o.__version!==t.version?k(o,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,o.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){const o=r.get(t);t.version>0&&o.__version!==t.version?k(o,t,i):n.bindTexture(e.TEXTURE_3D,o.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,s){const l=r.get(t);t.version>0&&l.__version!==t.version?function(t,s,l){if(6!==s.image.length)return;const c=L(t,s),u=s.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+l);const h=r.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+l);const t=i.ppV.getPrimaries(i.ppV.workingColorSpace),r=s.colorSpace===i.jf0?null:i.ppV.getPrimaries(s.colorSpace),d=s.colorSpace===i.jf0||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const f=s.isCompressedTexture||s.image[0].isCompressedTexture,p=s.image[0]&&s.image[0].isDataTexture,m=[];for(let e=0;e<6;e++)m[e]=f||p?p?s.image[e].image:s.image[e]:g(s.image[e],!0,o.maxCubemapSize),m[e]=V(s,m[e]);const b=m[0],w=a.convert(s.format,s.colorSpace),S=a.convert(s.type),E=_(s.internalFormat,w,S,s.colorSpace),A=!0!==s.isVideoTexture,M=void 0===h.__version||!0===c,T=u.dataReady;let C,I=x(s,b);if(P(e.TEXTURE_CUBE_MAP,s),f){A&&M&&n.texStorage2D(e.TEXTURE_CUBE_MAP,I,E,b.width,b.height);for(let t=0;t<6;t++){C=m[t].mipmaps;for(let r=0;r<C.length;r++){const o=C[r];s.format!==i.GWd?null!==w?A?T&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,o.width,o.height,w,o.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,E,o.width,o.height,0,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):A?T&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,o.width,o.height,w,S,o.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,E,o.width,o.height,0,w,S,o.data)}}}else{if(C=s.mipmaps,A&&M){C.length>0&&I++;const t=j(m[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,I,E,t.width,t.height)}for(let t=0;t<6;t++)if(p){A?T&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,m[t].width,m[t].height,w,S,m[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,m[t].width,m[t].height,0,w,S,m[t].data);for(let r=0;r<C.length;r++){const i=C[r].image[t].image;A?T&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,w,S,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,E,i.width,i.height,0,w,S,i.data)}}else{A?T&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,w,S,m[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,E,w,S,m[t]);for(let r=0;r<C.length;r++){const i=C[r];A?T&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,w,S,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,E,w,S,i.image[t])}}}v(s)&&y(e.TEXTURE_CUBE_MAP),h.__version=u.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(l,t,s):n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,n,i){const o=r.get(t);void 0!==n&&D(o.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&N(t)},this.setupRenderTarget=function(t){const i=t.texture,o=r.get(t),l=r.get(i);t.addEventListener("dispose",E);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,s.memory.textures++),u){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<i.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===B(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const i=a.convert(r.format,r.colorSpace),s=a.convert(r.type),l=_(r.internalFormat,i,s,r.colorSpace,!0===t.isXRRenderTarget),u=z(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),O(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),P(e.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)D(o.__webglFramebuffer[n][r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else D(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);v(i)&&y(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let i=0,a=c.length;i<a;i++){const a=c[i],s=r.get(a);n.bindTexture(e.TEXTURE_2D,s.__webglTexture),P(e.TEXTURE_2D,a),D(o.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,0),v(a)&&y(e.TEXTURE_2D)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),P(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)D(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,r,n);else D(o.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,r,0);v(i)&&y(r),n.unbindTexture()}t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let i=0,o=t.length;i<o;i++){const o=t[i];if(v(o)){const t=b(e),i=r.get(o).__webglTexture;n.bindTexture(t,i),y(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===B(t)){const i=t.textures,o=t.width,a=t.height;let s=e.COLOR_BUFFER_BIT;const l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=r.get(t),h=i.length>1;if(h)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<i.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,o,a,0,0,o,a,s,e.NEAREST),!0===c&&(U.length=0,F.length=0,U.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(U.push(l),F.push(l),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,F)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,U))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const o=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,o,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&c){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=N,this.setupFrameBufferTexture=D,this.useMultisampledRTT=B}function Pt(e,t){return{convert:function(n,r=i.jf0){let o;const a=i.ppV.getTransfer(r);if(n===i.OUM)return e.UNSIGNED_BYTE;if(n===i.Wew)return e.UNSIGNED_SHORT_4_4_4_4;if(n===i.gJ2)return e.UNSIGNED_SHORT_5_5_5_1;if(n===i.Dmk)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===i.tJf)return e.BYTE;if(n===i.fBL)return e.SHORT;if(n===i.cHt)return e.UNSIGNED_SHORT;if(n===i.Yuy)return e.INT;if(n===i.bkx)return e.UNSIGNED_INT;if(n===i.RQf)return e.FLOAT;if(n===i.ix0)return e.HALF_FLOAT;if(n===i.wrO)return e.ALPHA;if(n===i.HIg)return e.RGB;if(n===i.GWd)return e.RGBA;if(n===i.Kzv)return e.LUMINANCE;if(n===i.CMB)return e.LUMINANCE_ALPHA;if(n===i.zdS)return e.DEPTH_COMPONENT;if(n===i.dcC)return e.DEPTH_STENCIL;if(n===i.VT0)return e.RED;if(n===i.ZQM)return e.RED_INTEGER;if(n===i.paN)return e.RG;if(n===i.TkQ)return e.RG_INTEGER;if(n===i.c90)return e.RGBA_INTEGER;if(n===i.IE4||n===i.Nz6||n===i.jR7||n===i.BXX)if(a===i.KLL){if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(n===i.IE4)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===i.Nz6)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===i.jR7)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===i.BXX)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=t.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(n===i.IE4)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===i.Nz6)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===i.jR7)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===i.BXX)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===i.k6Q||n===i.kTp||n===i.HXV||n===i.pBf){if(o=t.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(n===i.k6Q)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===i.kTp)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===i.HXV)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===i.pBf)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===i.CVz||n===i.Riy||n===i.KDk){if(o=t.get("WEBGL_compressed_texture_etc"),null===o)return null;if(n===i.CVz||n===i.Riy)return a===i.KLL?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===i.KDk)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(n===i.qa3||n===i.B_h||n===i.czI||n===i.rSH||n===i.Qrf||n===i.psI||n===i.a5J||n===i._QJ||n===i.uB5||n===i.lyL||n===i.bC7||n===i.y3Z||n===i.ojs||n===i.S$4){if(o=t.get("WEBGL_compressed_texture_astc"),null===o)return null;if(n===i.qa3)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===i.B_h)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===i.czI)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===i.rSH)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===i.Qrf)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===i.psI)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===i.a5J)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===i._QJ)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===i.uB5)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===i.lyL)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===i.bC7)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===i.y3Z)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===i.ojs)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===i.S$4)return a===i.KLL?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===i.Fn||n===i.H23||n===i.W9U){if(o=t.get("EXT_texture_compression_bptc"),null===o)return null;if(n===i.Fn)return a===i.KLL?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===i.H23)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===i.W9U)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===i.Kef||n===i.XG_||n===i.HO_||n===i.CWW){if(o=t.get("EXT_texture_compression_rgtc"),null===o)return null;if(n===i.Fn)return o.COMPRESSED_RED_RGTC1_EXT;if(n===i.XG_)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===i.HO_)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===i.CWW)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===i.V3x?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}const Lt={type:"move"};class kt{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new i.YJl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new i.YJl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new i.Pq0,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new i.Pq0),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new i.YJl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new i.Pq0,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new i.Pq0),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,o=null;const a=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){o=!0;for(const r of e.hand.values()){const e=t.getJointPose(r,n),i=this._getHandJoint(l,r);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],a=r.position.distanceTo(i.position),s=.02,c=.005;l.inputState.pinching&&a>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&a<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Lt)))}return null!==a&&(a.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new i.YJl;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Dt{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(null===this.texture){const r=new i.gPd;e.properties.get(r).__webglTexture=t.texture,t.depthNear==n.depthNear&&t.depthFar==n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new i.BKk({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new i.eaF(new i.bdM(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Ot extends i.Qev{constructor(e,t){super();const n=this;let r=null,o=1,s=null,l="local-floor",c=1,u=null,h=null,d=null,f=null,p=null,m=null;const g=new Dt,v=t.getContextAttributes();let y=null,b=null;const _=[],w=[],x=new i.I9Y;let S=null;const E=new i.ubm;E.viewport=new i.IUQ;const A=new i.ubm;A.viewport=new i.IUQ;const M=[E,A],T=new i.nZQ;let C=null,I=null;function R(e){const t=w.indexOf(e.inputSource);if(-1===t)return;const n=_[t];void 0!==n&&(n.update(e.inputSource,e.frame,u||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function P(){r.removeEventListener("select",R),r.removeEventListener("selectstart",R),r.removeEventListener("selectend",R),r.removeEventListener("squeeze",R),r.removeEventListener("squeezestart",R),r.removeEventListener("squeezeend",R),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",L);for(let e=0;e<_.length;e++){const t=w[e];null!==t&&(w[e]=null,_[e].disconnect(t))}C=null,I=null,g.reset(),e.setRenderTarget(y),p=null,f=null,d=null,r=null,b=null,U.stop(),n.isPresenting=!1,e.setPixelRatio(S),e.setSize(x.width,x.height,!1),n.dispatchEvent({type:"sessionend"})}function L(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=w.indexOf(n);r>=0&&(w[r]=null,_[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=w.indexOf(n);if(-1===r){for(let e=0;e<_.length;e++){if(e>=w.length){w.push(n),r=e;break}if(null===w[e]){w[e]=n,r=e;break}}if(-1===r)break}const i=_[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=_[e];return void 0===t&&(t=new kt,_[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=_[e];return void 0===t&&(t=new kt,_[e]=t),t.getGripSpace()},this.getHand=function(e){let t=_[e];return void 0===t&&(t=new kt,_[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){l=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||s},this.setReferenceSpace=function(e){u=e},this.getBaseLayer=function(){return null!==f?f:p},this.getBinding=function(){return d},this.getFrame=function(){return m},this.getSession=function(){return r},this.setSession=async function(a){if(r=a,null!==r){if(y=e.getRenderTarget(),r.addEventListener("select",R),r.addEventListener("selectstart",R),r.addEventListener("selectend",R),r.addEventListener("squeeze",R),r.addEventListener("squeezestart",R),r.addEventListener("squeezeend",R),r.addEventListener("end",P),r.addEventListener("inputsourceschange",L),!0!==v.xrCompatible&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(x),void 0===r.renderState.layers){const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),b=new i.nWS(p.framebufferWidth,p.framebufferHeight,{format:i.GWd,type:i.OUM,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let n=null,a=null,s=null;v.depth&&(s=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=v.stencil?i.dcC:i.zdS,a=v.stencil?i.V3x:i.bkx);const l={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:o};d=new XRWebGLBinding(r,t),f=d.createProjectionLayer(l),r.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),b=new i.nWS(f.textureWidth,f.textureHeight,{format:i.GWd,type:i.OUM,depthTexture:new i.VCu(f.textureWidth,f.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===f.ignoreDepthValues})}b.isXRRenderTarget=!0,this.setFoveation(c),u=null,s=await r.requestReferenceSpace(l),U.setContext(r),U.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};const k=new i.Pq0,D=new i.Pq0;function O(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;let t=e.near,n=e.far;null!==g.texture&&(g.depthNear>0&&(t=g.depthNear),g.depthFar>0&&(n=g.depthFar)),T.near=A.near=E.near=t,T.far=A.far=E.far=n,C===T.near&&I===T.far||(r.updateRenderState({depthNear:T.near,depthFar:T.far}),C=T.near,I=T.far),E.layers.mask=2|e.layers.mask,A.layers.mask=4|e.layers.mask,T.layers.mask=E.layers.mask|A.layers.mask;const o=e.parent,a=T.cameras;O(T,o);for(let e=0;e<a.length;e++)O(a[e],o);2===a.length?function(e,t,n){k.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);const r=k.distanceTo(D),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(o[8]+1)/o[0],d=a*u,f=a*h,p=r/(-u+h),m=p*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=a+p,n=s+p,i=d-m,o=f+(r-m),u=l*s/n*t,h=c*s/n*t;e.projectionMatrix.makePerspective(i,o,u,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(T,E,A):T.projectionMatrix.copy(E.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*i.a55*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,T,o)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==f||null!==p)return c},this.setFoveation=function(e){c=e,null!==f&&(f.fixedFoveation=e),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==g.texture},this.getDepthSensingMesh=function(){return g.getMesh(T)};let N=null;const U=new a;U.setAnimationLoop((function(t,o){if(h=o.getViewerPose(u||s),m=o,null!==h){const t=h.views;null!==p&&(e.setRenderTargetFramebuffer(b,p.framebuffer),e.setRenderTarget(b));let n=!1;t.length!==T.cameras.length&&(T.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const o=t[r];let a=null;if(null!==p)a=p.getViewport(o);else{const t=d.getViewSubImage(f,o);a=t.viewport,0===r&&(e.setRenderTargetTextures(b,t.colorTexture,f.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(b))}let s=M[r];void 0===s&&(s=new i.ubm,s.layers.enable(r),s.viewport=new i.IUQ,M[r]=s),s.matrix.fromArray(o.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(o.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(a.x,a.y,a.width,a.height),0===r&&(T.matrix.copy(s.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===n&&T.cameras.push(s)}const o=r.enabledFeatures;if(o&&o.includes("depth-sensing")){const n=d.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&g.init(e,n,r.renderState)}}for(let e=0;e<_.length;e++){const t=w[e],n=_[e];null!==t&&void 0!==n&&n.update(t,o,u||s)}N&&N(t,o),o.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:o}),m=null})),this.setAnimationLoop=function(e){N=e},this.dispose=function(){}}}const Nt=new i.O9p,Ut=new i.kn4;function Ft(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,r.side===i.hsX&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),r.side===i.hsX&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const o=t.get(r),a=o.envMap,s=o.envMapRotation;a&&(e.envMap.value=a,Nt.copy(s),Nt.x*=-1,Nt.y*=-1,Nt.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(Nt.y*=-1,Nt.z*=-1),e.envMapRotation.value.setFromMatrix4(Ut.makeRotationFromEuler(Nt)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,(0,i._Ut)(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,o,a,s,l){o.isMeshBasicMaterial||o.isMeshLambertMaterial?r(e,o):o.isMeshToonMaterial?(r(e,o),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,o)):o.isMeshPhongMaterial?(r(e,o),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,o)):o.isMeshStandardMaterial?(r(e,o),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform)),e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform)),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,o),o.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===i.hsX&&e.clearcoatNormalScale.value.negate())),t.dispersion>0&&(e.dispersion.value=t.dispersion),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,o,l)):o.isMeshMatcapMaterial?(r(e,o),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,o)):o.isMeshDepthMaterial?r(e,o):o.isMeshDistanceMaterial?(r(e,o),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,o)):o.isMeshNormalMaterial?r(e,o):o.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,o),o.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,o)):o.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,o,a,s):o.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,o):o.isShadowMaterial?(e.color.value.copy(o.color),e.opacity.value=o.opacity):o.isShaderMaterial&&(o.uniformsNeedUpdate=!1)}}}function zt(e,t,n,r){let i={},o={},a=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,o=t+"_"+n;if(void 0===r[o])return r[o]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;{const e=r[o];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return r[o]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=a.indexOf(n.__bindingPointIndex);a.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete o[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(function(e){const t=e.uniforms;let n=0;for(let e=0,r=t.length;e<r;e++){const r=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=r.length;e<t;e++){const t=r[e],i=Array.isArray(t.value)?t.value:[t.value];for(let e=0,r=i.length;e<r;e++){const r=c(i[e]),o=n%16,a=o%r.boundary,s=o+a;n+=a,0!==s&&16-s<r.storage&&(n+=16-s),t.__data=new Float32Array(r.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=n,n+=r.storage}}}const r=n%16;r>0&&(n+=16-r),e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<s;e++)if(-1===a.indexOf(e))return a.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,o=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,o),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const f=h.program;r.updateUBOMapping(n,f);const p=t.render.frame;o[n.id]!==p&&(function(t){const n=i[t.id],r=t.uniforms,o=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let t=0,n=r.length;t<n;t++){const n=Array.isArray(r[t])?r[t]:[r[t]];for(let r=0,i=n.length;r<i;r++){const i=n[r];if(!0===l(i,t,r,o)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let o=0;o<n.length;o++){const a=n[o],s=c(a);"number"==typeof a||"boolean"==typeof a?(i.__data[0]=a,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=0,i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=0,i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=0):(a.toArray(i.__data,r),r+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),o[n.id]=p)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);a=[],i={},o={}}}}class Bt{constructor(e={}){const{canvas:t=(0,i.lPF)(),context:n=null,depth:r=!0,stencil:o=!1,alpha:l=!1,antialias:c=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:_=!1}=e;let w;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");w=n.getContextAttributes().alpha}else w=l;const x=new Uint32Array(4),S=new Int32Array(4);let E=null,A=null;const M=[],T=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=i.er$,this.toneMapping=i.y_p,this.toneMappingExposure=1;const C=this;let I=!1,R=0,P=0,L=null,k=-1,D=null;const j=new i.IUQ,H=new i.IUQ;let G=null;const W=new i.Q1f(0);let q=0,X=t.width,$=t.height,Y=1,K=null,Z=null;const Q=new i.IUQ(0,0,X,$),J=new i.IUQ(0,0,X,$);let ee=!1;const te=new i.PPD;let ne=!1,re=!1;const ie=new i.kn4,oe=new i.kn4,ae=new i.Pq0,se=new i.IUQ,le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ce=!1;function ue(){return null===L?Y:1}let he,de,fe,pe,me,ge,ve,ye,be,_e,we,xe,Se,Ee,Ae,Me,Te,Ce,Ie,Re,Pe,Le,ke,De,Oe=n;function Ne(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:r,stencil:o,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${i.sPf}`),t.addEventListener("webglcontextlost",ze,!1),t.addEventListener("webglcontextrestored",Be,!1),t.addEventListener("webglcontextcreationerror",Ve,!1),null===Oe){const t="webgl2";if(Oe=Ne(t,e),null===Oe)throw Ne(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function Ue(){he=new N(Oe),he.init(),Le=new Pt(Oe,he),de=new v(Oe,he,e,Le),fe=new It(Oe,he),de.reverseDepthBuffer&&_&&fe.buffers.depth.setReversed(!0),pe=new z(Oe),me=new gt,ge=new Rt(Oe,he,fe,me,de,Le,pe),ve=new b(C),ye=new O(C),be=new s(Oe),ke=new m(Oe,be),_e=new U(Oe,be,pe,ke),we=new V(Oe,_e,be,pe),Ie=new B(Oe,de,ge),Me=new y(me),xe=new mt(C,ve,ye,he,de,ke,Me),Se=new Ft(C,me),Ee=new _t,Ae=new Mt(he),Ce=new p(C,ve,ye,fe,we,w,u),Te=new Tt(C,we,de),De=new zt(Oe,pe,de,fe),Re=new g(Oe,he,pe),Pe=new F(Oe,he,pe),pe.programs=xe.programs,C.capabilities=de,C.extensions=he,C.properties=me,C.renderLists=Ee,C.shadowMap=Te,C.state=fe,C.info=pe}Ue();const Fe=new Ot(C,Oe);function ze(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function Be(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;const e=pe.autoReset,t=Te.enabled,n=Te.autoUpdate,r=Te.needsUpdate,i=Te.type;Ue(),pe.autoReset=e,Te.enabled=t,Te.autoUpdate=n,Te.needsUpdate=r,Te.type=i}function Ve(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function je(e){const t=e.target;t.removeEventListener("dispose",je),function(e){(function(e){const t=me.get(e).programs;void 0!==t&&(t.forEach((function(e){xe.releaseProgram(e)})),e.isShaderMaterial&&xe.releaseShaderCache(e))})(e),me.remove(e)}(t)}function He(e,t,n){!0===e.transparent&&e.side===i.$EB&&!1===e.forceSinglePass?(e.side=i.hsX,e.needsUpdate=!0,et(e,t,n),e.side=i.hB5,e.needsUpdate=!0,et(e,t,n),e.side=i.$EB):et(e,t,n)}this.xr=Fe,this.getContext=function(){return Oe},this.getContextAttributes=function(){return Oe.getContextAttributes()},this.forceContextLoss=function(){const e=he.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=he.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(e){void 0!==e&&(Y=e,this.setSize(X,$,!1))},this.getSize=function(e){return e.set(X,$)},this.setSize=function(e,n,r=!0){Fe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(X=e,$=n,t.width=Math.floor(e*Y),t.height=Math.floor(n*Y),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(X*Y,$*Y).floor()},this.setDrawingBufferSize=function(e,n,r){X=e,$=n,Y=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(j)},this.getViewport=function(e){return e.copy(Q)},this.setViewport=function(e,t,n,r){e.isVector4?Q.set(e.x,e.y,e.z,e.w):Q.set(e,t,n,r),fe.viewport(j.copy(Q).multiplyScalar(Y).round())},this.getScissor=function(e){return e.copy(J)},this.setScissor=function(e,t,n,r){e.isVector4?J.set(e.x,e.y,e.z,e.w):J.set(e,t,n,r),fe.scissor(H.copy(J).multiplyScalar(Y).round())},this.getScissorTest=function(){return ee},this.setScissorTest=function(e){fe.setScissorTest(ee=e)},this.setOpaqueSort=function(e){K=e},this.setTransparentSort=function(e){Z=e},this.getClearColor=function(e){return e.copy(Ce.getClearColor())},this.setClearColor=function(){Ce.setClearColor.apply(Ce,arguments)},this.getClearAlpha=function(){return Ce.getClearAlpha()},this.setClearAlpha=function(){Ce.setClearAlpha.apply(Ce,arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==L){const t=L.texture.format;e=t===i.c90||t===i.TkQ||t===i.ZQM}if(e){const e=L.texture.type,t=e===i.OUM||e===i.bkx||e===i.cHt||e===i.V3x||e===i.Wew||e===i.gJ2,n=Ce.getClearColor(),r=Ce.getClearAlpha(),o=n.r,a=n.g,s=n.b;t?(x[0]=o,x[1]=a,x[2]=s,x[3]=r,Oe.clearBufferuiv(Oe.COLOR,0,x)):(S[0]=o,S[1]=a,S[2]=s,S[3]=r,Oe.clearBufferiv(Oe.COLOR,0,S))}else r|=Oe.COLOR_BUFFER_BIT}t&&(r|=Oe.DEPTH_BUFFER_BIT),n&&(r|=Oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Oe.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ze,!1),t.removeEventListener("webglcontextrestored",Be,!1),t.removeEventListener("webglcontextcreationerror",Ve,!1),Ce.dispose(),Ee.dispose(),Ae.dispose(),me.dispose(),ve.dispose(),ye.dispose(),we.dispose(),ke.dispose(),De.dispose(),xe.dispose(),Fe.dispose(),Fe.removeEventListener("sessionstart",We),Fe.removeEventListener("sessionend",Xe),$e.stop()},this.renderBufferDirect=function(e,t,n,r,o,a){null===t&&(t=le);const s=o.isMesh&&o.matrixWorld.determinant()<0,l=function(e,t,n,r,o){!0!==t.isScene&&(t=le),ge.resetTextureUnits();const a=t.fog,s=r.isMeshStandardMaterial?t.environment:null,l=null===L?C.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:i.Zr2,c=(r.isMeshStandardMaterial?ye:ve).get(r.envMap||s),u=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,h=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),d=!!n.morphAttributes.position,f=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let m=i.y_p;r.toneMapped&&(null!==L&&!0!==L.isXRRenderTarget||(m=C.toneMapping));const g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,y=me.get(r),b=A.state.lights;if(!0===ne&&(!0===re||e!==D)){const t=e===D&&r.id===k;Me.setState(r,e,t)}let _=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==l||o.isBatchedMesh&&!1===y.batching?_=!0:o.isBatchedMesh||!0!==y.batching?o.isBatchedMesh&&!0===y.batchingColor&&null===o.colorTexture||o.isBatchedMesh&&!1===y.batchingColor&&null!==o.colorTexture||o.isInstancedMesh&&!1===y.instancing?_=!0:o.isInstancedMesh||!0!==y.instancing?o.isSkinnedMesh&&!1===y.skinning?_=!0:o.isSkinnedMesh||!0!==y.skinning?o.isInstancedMesh&&!0===y.instancingColor&&null===o.instanceColor||o.isInstancedMesh&&!1===y.instancingColor&&null!==o.instanceColor||o.isInstancedMesh&&!0===y.instancingMorph&&null===o.morphTexture||o.isInstancedMesh&&!1===y.instancingMorph&&null!==o.morphTexture||y.envMap!==c||!0===r.fog&&y.fog!==a?_=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===Me.numPlanes&&y.numIntersection===Me.numIntersection?(y.vertexAlphas!==u||y.vertexTangents!==h||y.morphTargets!==d||y.morphNormals!==f||y.morphColors!==p||y.toneMapping!==m||y.morphTargetsCount!==v)&&(_=!0):_=!0:_=!0:_=!0:_=!0:(_=!0,y.__version=r.version);let w=y.currentProgram;!0===_&&(w=et(r,t,o));let x=!1,S=!1,E=!1;const M=w.getUniforms(),T=y.uniforms;if(fe.useProgram(w.program)&&(x=!0,S=!0,E=!0),r.id!==k&&(k=r.id,S=!0),x||D!==e){fe.buffers.depth.getReversed()?(ie.copy(e.projectionMatrix),(0,i.xiE)(ie),(0,i.Mmk)(ie),M.setValue(Oe,"projectionMatrix",ie)):M.setValue(Oe,"projectionMatrix",e.projectionMatrix),M.setValue(Oe,"viewMatrix",e.matrixWorldInverse);const t=M.map.cameraPosition;void 0!==t&&t.setValue(Oe,ae.setFromMatrixPosition(e.matrixWorld)),de.logarithmicDepthBuffer&&M.setValue(Oe,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&M.setValue(Oe,"isOrthographic",!0===e.isOrthographicCamera),D!==e&&(D=e,S=!0,E=!0)}if(o.isSkinnedMesh){M.setOptional(Oe,o,"bindMatrix"),M.setOptional(Oe,o,"bindMatrixInverse");const e=o.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),M.setValue(Oe,"boneTexture",e.boneTexture,ge))}o.isBatchedMesh&&(M.setOptional(Oe,o,"batchingTexture"),M.setValue(Oe,"batchingTexture",o._matricesTexture,ge),M.setOptional(Oe,o,"batchingIdTexture"),M.setValue(Oe,"batchingIdTexture",o._indirectTexture,ge),M.setOptional(Oe,o,"batchingColorTexture"),null!==o._colorsTexture&&M.setValue(Oe,"batchingColorTexture",o._colorsTexture,ge));const I=n.morphAttributes;var R,P;if(void 0===I.position&&void 0===I.normal&&void 0===I.color||Ie.update(o,n,w),(S||y.receiveShadow!==o.receiveShadow)&&(y.receiveShadow=o.receiveShadow,M.setValue(Oe,"receiveShadow",o.receiveShadow)),r.isMeshGouraudMaterial&&null!==r.envMap&&(T.envMap.value=c,T.flipEnvMap.value=c.isCubeTexture&&!1===c.isRenderTargetTexture?-1:1),r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(T.envMapIntensity.value=t.environmentIntensity),S&&(M.setValue(Oe,"toneMappingExposure",C.toneMappingExposure),y.needsLights&&(P=E,(R=T).ambientLightColor.needsUpdate=P,R.lightProbe.needsUpdate=P,R.directionalLights.needsUpdate=P,R.directionalLightShadows.needsUpdate=P,R.pointLights.needsUpdate=P,R.pointLightShadows.needsUpdate=P,R.spotLights.needsUpdate=P,R.spotLightShadows.needsUpdate=P,R.rectAreaLights.needsUpdate=P,R.hemisphereLights.needsUpdate=P),a&&!0===r.fog&&Se.refreshFogUniforms(T,a),Se.refreshMaterialUniforms(T,r,Y,$,A.state.transmissionRenderTarget[e.id]),qe.upload(Oe,tt(y),T,ge)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(qe.upload(Oe,tt(y),T,ge),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&M.setValue(Oe,"center",o.center),M.setValue(Oe,"modelViewMatrix",o.modelViewMatrix),M.setValue(Oe,"normalMatrix",o.normalMatrix),M.setValue(Oe,"modelMatrix",o.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];De.update(n,w),De.bind(n,w)}}return w}(e,t,n,r,o);fe.setMaterial(r,s);let c=n.index,u=1;if(!0===r.wireframe){if(c=_e.getWireframeAttribute(n),void 0===c)return;u=2}const h=n.drawRange,d=n.attributes.position;let f=h.start*u,p=(h.start+h.count)*u;null!==a&&(f=Math.max(f,a.start*u),p=Math.min(p,(a.start+a.count)*u)),null!==c?(f=Math.max(f,0),p=Math.min(p,c.count)):null!=d&&(f=Math.max(f,0),p=Math.min(p,d.count));const m=p-f;if(m<0||m===1/0)return;let g;ke.setup(o,r,l,n,c);let v=Re;if(null!==c&&(g=be.get(c),v=Pe,v.setIndex(g)),o.isMesh)!0===r.wireframe?(fe.setLineWidth(r.wireframeLinewidth*ue()),v.setMode(Oe.LINES)):v.setMode(Oe.TRIANGLES);else if(o.isLine){let e=r.linewidth;void 0===e&&(e=1),fe.setLineWidth(e*ue()),o.isLineSegments?v.setMode(Oe.LINES):o.isLineLoop?v.setMode(Oe.LINE_LOOP):v.setMode(Oe.LINE_STRIP)}else o.isPoints?v.setMode(Oe.POINTS):o.isSprite&&v.setMode(Oe.TRIANGLES);if(o.isBatchedMesh)if(null!==o._multiDrawInstances)v.renderMultiDrawInstances(o._multiDrawStarts,o._multiDrawCounts,o._multiDrawCount,o._multiDrawInstances);else if(he.get("WEBGL_multi_draw"))v.renderMultiDraw(o._multiDrawStarts,o._multiDrawCounts,o._multiDrawCount);else{const e=o._multiDrawStarts,t=o._multiDrawCounts,n=o._multiDrawCount,i=c?be.get(c).bytesPerElement:1,a=me.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)a.setValue(Oe,"_gl_DrawID",r),v.render(e[r]/i,t[r])}else if(o.isInstancedMesh)v.renderInstances(f,m,o.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);v.renderInstances(f,m,t)}else v.render(f,m)},this.compile=function(e,t,n=null){null===n&&(n=e),A=Ae.get(n),A.init(t),T.push(A),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(A.pushLight(e),e.castShadow&&A.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(A.pushLight(e),e.castShadow&&A.pushShadow(e))})),A.setupLights();const r=new Set;return e.traverse((function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const o=t[i];He(o,n,e),r.add(o)}else He(t,n,e),r.add(t)})),T.pop(),A=null,r},this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise((t=>{function n(){r.forEach((function(e){me.get(e).currentProgram.isReady()&&r.delete(e)})),0!==r.size?setTimeout(n,10):t(e)}null!==he.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Ge=null;function We(){$e.stop()}function Xe(){$e.start()}const $e=new a;function Ye(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)A.pushLight(e),e.castShadow&&A.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||te.intersectsSprite(e)){r&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(oe);const t=we.update(e),i=e.material;i.visible&&E.push(e,t,i,n,se.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||te.intersectsObject(e))){const t=we.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),se.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),se.copy(t.boundingSphere.center)),se.applyMatrix4(e.matrixWorld).applyMatrix4(oe)),Array.isArray(i)){const r=t.groups;for(let o=0,a=r.length;o<a;o++){const a=r[o],s=i[a.materialIndex];s&&s.visible&&E.push(e,t,s,n,se.z,a)}}else i.visible&&E.push(e,t,i,n,se.z,null)}const i=e.children;for(let e=0,o=i.length;e<o;e++)Ye(i[e],t,n,r)}function Ke(e,t,n,r){const i=e.opaque,o=e.transmissive,a=e.transparent;A.setupLightsView(n),!0===ne&&Me.setGlobalState(C.clippingPlanes,n),r&&fe.viewport(j.copy(r)),i.length>0&&Qe(i,t,n),o.length>0&&Qe(o,t,n),a.length>0&&Qe(a,t,n),fe.buffers.depth.setTest(!0),fe.buffers.depth.setMask(!0),fe.buffers.color.setMask(!0),fe.setPolygonOffset(!1)}function Ze(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===A.state.transmissionRenderTarget[r.id]&&(A.state.transmissionRenderTarget[r.id]=new i.nWS(1,1,{generateMipmaps:!0,type:he.has("EXT_color_buffer_half_float")||he.has("EXT_color_buffer_float")?i.ix0:i.OUM,minFilter:i.$_I,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:i.ppV.workingColorSpace}));const a=A.state.transmissionRenderTarget[r.id],s=r.viewport||j;a.setSize(s.z,s.w);const l=C.getRenderTarget();C.setRenderTarget(a),C.getClearColor(W),q=C.getClearAlpha(),q<1&&C.setClearColor(16777215,.5),C.clear(),ce&&Ce.render(n);const c=C.toneMapping;C.toneMapping=i.y_p;const u=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),A.setupLightsView(r),!0===ne&&Me.setGlobalState(C.clippingPlanes,r),Qe(e,n,r),ge.updateMultisampleRenderTarget(a),ge.updateRenderTargetMipmap(a),!1===he.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let o=0,a=t.length;o<a;o++){const a=t[o],s=a.object,l=a.geometry,c=a.material,u=a.group;if(c.side===i.$EB&&s.layers.test(r.layers)){const t=c.side;c.side=i.hsX,c.needsUpdate=!0,Je(s,n,r,l,c,u),c.side=t,c.needsUpdate=!0,e=!0}}!0===e&&(ge.updateMultisampleRenderTarget(a),ge.updateRenderTargetMipmap(a))}C.setRenderTarget(l),C.setClearColor(W,q),void 0!==u&&(r.viewport=u),C.toneMapping=c}function Qe(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,o=e.length;i<o;i++){const o=e[i],a=o.object,s=o.geometry,l=null===r?o.material:r,c=o.group;a.layers.test(n.layers)&&Je(a,t,n,s,l,c)}}function Je(e,t,n,r,o,a){e.onBeforeRender(C,t,n,r,o,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),o.onBeforeRender(C,t,n,r,e,a),!0===o.transparent&&o.side===i.$EB&&!1===o.forceSinglePass?(o.side=i.hsX,o.needsUpdate=!0,C.renderBufferDirect(n,t,r,o,e,a),o.side=i.hB5,o.needsUpdate=!0,C.renderBufferDirect(n,t,r,o,e,a),o.side=i.$EB):C.renderBufferDirect(n,t,r,o,e,a),e.onAfterRender(C,t,n,r,o,a)}function et(e,t,n){!0!==t.isScene&&(t=le);const r=me.get(e),i=A.state.lights,o=A.state.shadowsArray,a=i.state.version,s=xe.getParameters(e,i.state,o,t,n),l=xe.getProgramCacheKey(s);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ye:ve).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",je),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===a)return nt(e,s),u}else s.uniforms=xe.getUniforms(e),e.onBeforeCompile(s,C),u=xe.acquireProgram(s,l),c.set(l,u),r.uniforms=s.uniforms;const h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=Me.uniform),nt(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=a,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function tt(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=qe.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function nt(e,t){const n=me.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}$e.setAnimationLoop((function(e){Ge&&Ge(e)})),"undefined"!=typeof self&&$e.setContext(self),this.setAnimationLoop=function(e){Ge=e,Fe.setAnimationLoop(e),null===e?$e.stop():$e.start()},Fe.addEventListener("sessionstart",We),Fe.addEventListener("sessionend",Xe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===I)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Fe.enabled&&!0===Fe.isPresenting&&(!0===Fe.cameraAutoUpdate&&Fe.updateCamera(t),t=Fe.getCamera()),!0===e.isScene&&e.onBeforeRender(C,e,t,L),A=Ae.get(e,T.length),A.init(t),T.push(A),oe.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),te.setFromProjectionMatrix(oe),re=this.localClippingEnabled,ne=Me.init(this.clippingPlanes,re),E=Ee.get(e,M.length),E.init(),M.push(E),!0===Fe.enabled&&!0===Fe.isPresenting){const e=C.xr.getDepthSensingMesh();null!==e&&Ye(e,t,-1/0,C.sortObjects)}Ye(e,t,0,C.sortObjects),E.finish(),!0===C.sortObjects&&E.sort(K,Z),ce=!1===Fe.enabled||!1===Fe.isPresenting||!1===Fe.hasDepthSensing(),ce&&Ce.addToRenderList(E,e),this.info.render.frame++,!0===ne&&Me.beginShadows();const n=A.state.shadowsArray;Te.render(n,e,t),!0===ne&&Me.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=E.opaque,i=E.transmissive;if(A.setupLights(),t.isArrayCamera){const n=t.cameras;if(i.length>0)for(let t=0,o=n.length;t<o;t++)Ze(r,i,e,n[t]);ce&&Ce.render(e);for(let t=0,r=n.length;t<r;t++){const r=n[t];Ke(E,e,r,r.viewport)}}else i.length>0&&Ze(r,i,e,t),ce&&Ce.render(e),Ke(E,e,t);null!==L&&(ge.updateMultisampleRenderTarget(L),ge.updateRenderTargetMipmap(L)),!0===e.isScene&&e.onAfterRender(C,e,t),ke.resetDefaultState(),k=-1,D=null,T.pop(),T.length>0?(A=T[T.length-1],!0===ne&&Me.setGlobalState(C.clippingPlanes,A.state.camera)):A=null,M.pop(),E=M.length>0?M[M.length-1]:null},this.getActiveCubeFace=function(){return R},this.getActiveMipmapLevel=function(){return P},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(e,t,n){me.get(e.texture).__webglTexture=t,me.get(e.depthTexture).__webglTexture=n;const r=me.get(e);r.__hasExternalTextures=!0,r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===he.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(e,t){const n=me.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){L=e,R=t,P=n;let r=!0,i=null,o=!1,a=!1;if(e){const s=me.get(e);if(void 0!==s.__useDefaultFramebuffer)fe.bindFramebuffer(Oe.FRAMEBUFFER,null),r=!1;else if(void 0===s.__webglFramebuffer)ge.setupRenderTarget(e);else if(s.__hasExternalTextures)ge.rebindTextures(e,me.get(e.texture).__webglTexture,me.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(s.__boundDepthTexture!==t){if(null!==t&&me.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ge.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const c=me.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],o=!0):i=e.samples>0&&!1===ge.useMultisampledRTT(e)?me.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,j.copy(e.viewport),H.copy(e.scissor),G=e.scissorTest}else j.copy(Q).multiplyScalar(Y).floor(),H.copy(J).multiplyScalar(Y).floor(),G=ee;if(fe.bindFramebuffer(Oe.FRAMEBUFFER,i)&&r&&fe.drawBuffers(e,i),fe.viewport(j),fe.scissor(H),fe.setScissorTest(G),o){const r=me.get(e.texture);Oe.framebufferTexture2D(Oe.FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,Oe.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(a){const r=me.get(e.texture),i=t||0;Oe.framebufferTextureLayer(Oe.FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,r.__webglTexture,n||0,i)}k=-1},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=me.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){fe.bindFramebuffer(Oe.FRAMEBUFFER,s);try{const a=e.texture,s=a.format,l=a.type;if(!de.textureFormatReadable(s))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!de.textureTypeReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&Oe.readPixels(t,n,r,i,Le.convert(s),Le.convert(l),o)}finally{const e=null!==L?me.get(L).__webglFramebuffer:null;fe.bindFramebuffer(Oe.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,r,o,a,s){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=me.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){const s=e.texture,c=s.format,u=s.type;if(!de.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!de.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-o){fe.bindFramebuffer(Oe.FRAMEBUFFER,l);const e=Oe.createBuffer();Oe.bindBuffer(Oe.PIXEL_PACK_BUFFER,e),Oe.bufferData(Oe.PIXEL_PACK_BUFFER,a.byteLength,Oe.STREAM_READ),Oe.readPixels(t,n,r,o,Le.convert(c),Le.convert(u),0);const s=null!==L?me.get(L).__webglFramebuffer:null;fe.bindFramebuffer(Oe.FRAMEBUFFER,s);const h=Oe.fenceSync(Oe.SYNC_GPU_COMMANDS_COMPLETE,0);return Oe.flush(),await(0,i.jej)(Oe,h,4),Oe.bindBuffer(Oe.PIXEL_PACK_BUFFER,e),Oe.getBufferSubData(Oe.PIXEL_PACK_BUFFER,0,a),Oe.deleteBuffer(e),Oe.deleteSync(h),a}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,n=0){!0!==e.isTexture&&((0,i.mcG)("WebGLRenderer: copyFramebufferToTexture function signature has changed."),t=arguments[0]||null,e=arguments[1]);const r=Math.pow(2,-n),o=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),s=null!==t?t.x:0,l=null!==t?t.y:0;ge.setTexture2D(e,0),Oe.copyTexSubImage2D(Oe.TEXTURE_2D,n,0,0,s,l,o,a),fe.unbindTexture()};const rt=Oe.createFramebuffer(),it=Oe.createFramebuffer();this.copyTextureToTexture=function(e,t,n=null,r=null,o=0,a=null){let s,l,c,u,h,d,f,p,m;!0!==e.isTexture&&((0,i.mcG)("WebGLRenderer: copyTextureToTexture function signature has changed."),r=arguments[0]||null,e=arguments[1],t=arguments[2],a=arguments[3]||0,n=null),null===a&&(0!==o?((0,i.mcG)("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),a=o,o=0):a=0);const g=e.isCompressedTexture?e.mipmaps[a]:e.image;if(null!==n)s=n.max.x-n.min.x,l=n.max.y-n.min.y,c=n.isBox3?n.max.z-n.min.z:1,u=n.min.x,h=n.min.y,d=n.isBox3?n.min.z:0;else{const t=Math.pow(2,-o);s=Math.floor(g.width*t),l=Math.floor(g.height*t),c=e.isDataArrayTexture?g.depth:e.isData3DTexture?Math.floor(g.depth*t):1,u=0,h=0,d=0}null!==r?(f=r.x,p=r.y,m=r.z):(f=0,p=0,m=0);const v=Le.convert(t.format),y=Le.convert(t.type);let b;t.isData3DTexture?(ge.setTexture3D(t,0),b=Oe.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(ge.setTexture2DArray(t,0),b=Oe.TEXTURE_2D_ARRAY):(ge.setTexture2D(t,0),b=Oe.TEXTURE_2D),Oe.pixelStorei(Oe.UNPACK_FLIP_Y_WEBGL,t.flipY),Oe.pixelStorei(Oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Oe.pixelStorei(Oe.UNPACK_ALIGNMENT,t.unpackAlignment);const _=Oe.getParameter(Oe.UNPACK_ROW_LENGTH),w=Oe.getParameter(Oe.UNPACK_IMAGE_HEIGHT),x=Oe.getParameter(Oe.UNPACK_SKIP_PIXELS),S=Oe.getParameter(Oe.UNPACK_SKIP_ROWS),E=Oe.getParameter(Oe.UNPACK_SKIP_IMAGES);Oe.pixelStorei(Oe.UNPACK_ROW_LENGTH,g.width),Oe.pixelStorei(Oe.UNPACK_IMAGE_HEIGHT,g.height),Oe.pixelStorei(Oe.UNPACK_SKIP_PIXELS,u),Oe.pixelStorei(Oe.UNPACK_SKIP_ROWS,h),Oe.pixelStorei(Oe.UNPACK_SKIP_IMAGES,d);const A=e.isDataArrayTexture||e.isData3DTexture,M=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const n=me.get(e),r=me.get(t),i=me.get(n.__renderTarget),g=me.get(r.__renderTarget);fe.bindFramebuffer(Oe.READ_FRAMEBUFFER,i.__webglFramebuffer),fe.bindFramebuffer(Oe.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let n=0;n<c;n++)A&&(Oe.framebufferTextureLayer(Oe.READ_FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,me.get(e).__webglTexture,o,d+n),Oe.framebufferTextureLayer(Oe.DRAW_FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,me.get(t).__webglTexture,a,m+n)),Oe.blitFramebuffer(u,h,s,l,f,p,s,l,Oe.DEPTH_BUFFER_BIT,Oe.NEAREST);fe.bindFramebuffer(Oe.READ_FRAMEBUFFER,null),fe.bindFramebuffer(Oe.DRAW_FRAMEBUFFER,null)}else if(0!==o||e.isRenderTargetTexture||me.has(e)){const n=me.get(e),r=me.get(t);fe.bindFramebuffer(Oe.READ_FRAMEBUFFER,rt),fe.bindFramebuffer(Oe.DRAW_FRAMEBUFFER,it);for(let e=0;e<c;e++)A?Oe.framebufferTextureLayer(Oe.READ_FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,n.__webglTexture,o,d+e):Oe.framebufferTexture2D(Oe.READ_FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,Oe.TEXTURE_2D,n.__webglTexture,o),M?Oe.framebufferTextureLayer(Oe.DRAW_FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,r.__webglTexture,a,m+e):Oe.framebufferTexture2D(Oe.DRAW_FRAMEBUFFER,Oe.COLOR_ATTACHMENT0,Oe.TEXTURE_2D,r.__webglTexture,a),0!==o?Oe.blitFramebuffer(u,h,s,l,f,p,s,l,Oe.COLOR_BUFFER_BIT,Oe.NEAREST):M?Oe.copyTexSubImage3D(b,a,f,p,m+e,u,h,s,l):Oe.copyTexSubImage2D(b,a,f,p,u,h,s,l);fe.bindFramebuffer(Oe.READ_FRAMEBUFFER,null),fe.bindFramebuffer(Oe.DRAW_FRAMEBUFFER,null)}else M?e.isDataTexture||e.isData3DTexture?Oe.texSubImage3D(b,a,f,p,m,s,l,c,v,y,g.data):t.isCompressedArrayTexture?Oe.compressedTexSubImage3D(b,a,f,p,m,s,l,c,v,g.data):Oe.texSubImage3D(b,a,f,p,m,s,l,c,v,y,g):e.isDataTexture?Oe.texSubImage2D(Oe.TEXTURE_2D,a,f,p,s,l,v,y,g.data):e.isCompressedTexture?Oe.compressedTexSubImage2D(Oe.TEXTURE_2D,a,f,p,g.width,g.height,v,g.data):Oe.texSubImage2D(Oe.TEXTURE_2D,a,f,p,s,l,v,y,g);Oe.pixelStorei(Oe.UNPACK_ROW_LENGTH,_),Oe.pixelStorei(Oe.UNPACK_IMAGE_HEIGHT,w),Oe.pixelStorei(Oe.UNPACK_SKIP_PIXELS,x),Oe.pixelStorei(Oe.UNPACK_SKIP_ROWS,S),Oe.pixelStorei(Oe.UNPACK_SKIP_IMAGES,E),0===a&&t.generateMipmaps&&Oe.generateMipmap(b),fe.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n=null,r=null,o=0){return!0!==e.isTexture&&((0,i.mcG)("WebGLRenderer: copyTextureToTexture3D function signature has changed."),n=arguments[0]||null,r=arguments[1]||null,e=arguments[2],t=arguments[3],o=arguments[4]||0),(0,i.mcG)('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,n,r,o)},this.initRenderTarget=function(e){void 0===me.get(e).__webglFramebuffer&&ge.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?ge.setTextureCube(e,0):e.isData3DTexture?ge.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ge.setTexture2DArray(e,0):ge.setTexture2D(e,0),fe.unbindTexture()},this.resetState=function(){R=0,P=0,L=null,fe.reset(),ke.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return i.TdN}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=i.ppV._getDrawingBufferColorSpace(e),t.unpackColorSpace=i.ppV._getUnpackColorSpace()}}class Vt extends i.Qev{constructor(e,t){super();const n=this,r=-1;this.object=e,this.domElement=t,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.length=10,this.scale=.5,this.scale0=.5,this.aspect=1,this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:i.kBv.ROTATE,MIDDLE:i.kBv.DOLLY,RIGHT:i.kBv.PAN},this.autoRotate=!1,this.autoRotateSpeed=2,this.target=new i.Pq0;const o=1e-6,a=new i.Pq0;let s=1,l=r,c=r,u=0,h=0,d=0;const f=new i.Pq0,p=new i.I9Y,m=new i.I9Y,g=new i.Pq0,v=new i.I9Y,y=new i.I9Y,b=new i.I9Y,_=new i.I9Y,w=[],x={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;const S={type:"change"},E={type:"start"},A={type:"end"};this.handleResize=function(){const e=n.domElement.getBoundingClientRect(),t=n.domElement.ownerDocument.documentElement;n.screen.left=e.left+window.pageXOffset-t.clientLeft,n.screen.top=e.top+window.pageYOffset-t.clientTop,n.screen.width=e.width,n.screen.height=e.height};const M=function(){const e=new i.I9Y;return function(t,r){return e.set((t-n.screen.left)/n.screen.width,(r-n.screen.top)/n.screen.height),e}}(),T=function(){const e=new i.I9Y;return function(t,r){return e.set((t-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-r))/n.screen.width),e}}();function C(e){!1!==n.enabled&&(0===w.length&&(n.domElement.setPointerCapture(e.pointerId),n.domElement.addEventListener("pointermove",I),n.domElement.addEventListener("pointerup",R)),function(e){w.push(e)}(e),"touch"===e.pointerType?function(e){let t,r,i,o;1===(U(e),w.length)?(l=3,m.copy(T(w[0].pageX,w[0].pageY)),p.copy(m)):(l=4,t=w[0].pageX-w[1].pageX,r=w[0].pageY-w[1].pageY,h=u=Math.sqrt(t*t+r*r),i=(w[0].pageX+w[1].pageX)/2,o=(w[0].pageY+w[1].pageY)/2,b.copy(M(i,o)),_.copy(b)),n.dispatchEvent(E)}(e):function(e){if(l===r)switch(e.button){case n.mouseButtons.LEFT:l=0;break;case n.mouseButtons.MIDDLE:l=1;break;case n.mouseButtons.RIGHT:l=2}const t=c!==r?c:l;0!==t||n.noRotate?1!==t||n.noZoom?2!==t||n.noPan||(b.copy(M(e.pageX,e.pageY)),_.copy(b)):(v.copy(M(e.pageX,e.pageY)),y.copy(v)):(m.copy(T(e.pageX,e.pageY)),p.copy(m)),n.dispatchEvent(E)}(e))}function I(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){let t,n,r,i,o;1===(U(e),w.length)?(p.copy(m),m.copy(T(e.pageX,e.pageY))):(t=function(e){const t=e.pointerId===w[0].pointerId?w[1]:w[0];return x[t.pointerId]}(e),n=e.pageX-t.x,r=e.pageY-t.y,h=Math.sqrt(n*n+r*r),i=(e.pageX+t.x)/2,o=(e.pageY+t.y)/2,_.copy(M(i,o)))}(e):function(e){const t=c!==r?c:l;0!==t||n.noRotate?1!==t||n.noZoom?2!==t||n.noPan||_.copy(M(e.pageX,e.pageY)):y.copy(M(e.pageX,e.pageY)):(p.copy(m),m.copy(T(e.pageX,e.pageY)))}(e))}function R(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(w.length){case 0:l=r;break;case 1:l=3,m.copy(T(e.pageX,e.pageY)),p.copy(m);break;case 2:l=4,m.copy(T(e.pageX-p.x,e.pageY-p.y)),p.copy(m)}n.dispatchEvent(A)}(e):(l=r,n.dispatchEvent(A)),N(e),0===w.length&&(n.domElement.releasePointerCapture(e.pointerId),n.domElement.removeEventListener("pointermove",I),n.domElement.removeEventListener("pointerup",R)))}function P(e){N(e)}function L(e){!1!==n.enabled&&(window.removeEventListener("keydown",L),c===r&&(e.code!==n.keys[0]||n.noRotate?e.code!==n.keys[1]||n.noZoom?e.code!==n.keys[2]||n.noPan||(c=2):c=1:c=0))}function k(e){!1!==n.enabled&&(c=r,window.addEventListener("keydown",L))}function D(e){if(!1!==n.enabled&&!0!==n.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:v.y-=.025*e.deltaY;break;case 1:v.y-=.01*e.deltaY;break;default:v.y-=25e-5*e.deltaY}n.dispatchEvent(E),n.dispatchEvent(A)}}function O(e){!1!==n.enabled&&e.preventDefault()}function N(e){delete x[e.pointerId];for(let t=0;t<w.length;t++)if(w[t].pointerId==e.pointerId)return void w.splice(t,1)}function U(e){let t=x[e.pointerId];void 0===t&&(t=new i.I9Y,x[e.pointerId]=t),t.set(e.pageX,e.pageY)}this.rotateCamera=function(){const e=new i.Pq0,t=new i.PTz,o=new i.Pq0,a=new i.Pq0,s=new i.Pq0,c=new i.Pq0;let u,h,v;return function(i){h=m.x-p.x,v=m.y-p.y,c.set(h,v,0),u=c.length(),u*=n.rotateSpeed,n.autoRotate&&l===r&&(u=function(e){return 2*Math.PI/60/60*n.autoRotateSpeed*(60*e)}(i),h=u,v=0,c.set(u,0,0)),u?(f.copy(n.object.position).sub(n.target),o.copy(f).normalize(),a.copy(n.object.up).normalize(),s.crossVectors(a,o).normalize(),a.setLength(v),s.setLength(h),c.copy(a.add(s)),e.crossVectors(c,f).normalize(),t.setFromAxisAngle(e,u),f.applyQuaternion(t),n.object.up.applyQuaternion(t),g.copy(e),d=u):!n.staticMoving&&d&&(d*=Math.sqrt(1-n.dynamicDampingFactor),f.copy(n.object.position).sub(n.target),t.setFromAxisAngle(g,d),f.applyQuaternion(t),n.object.up.applyQuaternion(t)),p.copy(m)}}(),this.zoomCamera=function(){let e;4===l?(e=u/h,u=h,n.object.isPerspectiveCamera?f.multiplyScalar(e):n.object.isOrthographicCamera?(n.scale=n.scale*e,n.object.zoom/=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(y.y-v.y)*n.zoomSpeed,1!==e&&e>0&&(n.object.isPerspectiveCamera?f.multiplyScalar(e):n.object.isOrthographicCamera?(n.scale=n.scale*e,n.object.zoom/=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?v.copy(y):v.y+=(y.y-v.y)*this.dynamicDampingFactor)},this.panCamera=function(){const e=new i.I9Y,t=new i.Pq0,r=new i.Pq0;return function(){if(e.copy(_).sub(b),e.lengthSq()){if(n.object.isOrthographicCamera){const t=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,r=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;e.x*=t,e.y*=r}e.multiplyScalar(f.length()*n.panSpeed),r.copy(f).cross(n.object.up).setLength(e.x),r.add(t.copy(n.object.up).setLength(e.y)),n.object.position.add(r),n.target.add(r),n.staticMoving?b.copy(_):b.add(e.subVectors(_,b).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(f.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,f.setLength(n.maxDistance)),v.copy(y)),f.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,f.setLength(n.minDistance)),v.copy(y)))},this.update=function(e){!1!==n.enabled&&(e=e||0,f.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(e),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,f),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),a.distanceToSquared(n.object.position)>o&&(n.dispatchEvent(S),a.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(a.distanceToSquared(n.object.position)>o||s!==n.object.zoom)&&(n.dispatchEvent(S),a.copy(n.object.position),s=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type"))},this.reset=function(){l=r,c=r,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.scale=n.scale0,n.object.updateProjectionMatrix(),f.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(S),a.copy(n.object.position),s=n.object.zoom},this.dispose=function(){n.domElement.removeEventListener("contextmenu",O),n.domElement.removeEventListener("pointerdown",C),n.domElement.removeEventListener("pointercancel",P),n.domElement.removeEventListener("wheel",D),n.domElement.removeEventListener("pointermove",I),n.domElement.removeEventListener("pointerup",R),window.removeEventListener("keydown",L),window.removeEventListener("keyup",k)},this.domElement.addEventListener("contextmenu",O),this.domElement.addEventListener("pointerdown",C),this.domElement.addEventListener("pointercancel",P),this.domElement.addEventListener("wheel",D,{passive:!1}),window.addEventListener("keydown",L),window.addEventListener("keyup",k),this.handleResize(),this.update()}}const jt=Vt;class Ht{constructor(){this.beginTime=(performance||Date).now(),this.prevTime=this.beginTime,this.frames=0,this.lastFrameMs=0,this.lastFPS=0}begin(){this.beginTime=(performance||Date).now()}end(){this.frames++;const e=(performance||Date).now();return this.lastFrameMs=e-this.beginTime,e>=this.prevTime+1e3&&(this.lastFPS=1e3*this.frames/(e-this.prevTime),this.prevTime=e,this.frames=0),e}update(){this.beginTime=this.end()}}const Gt={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float32:Float32Array,float64:Float64Array};let Wt=function(e){return e[e.RAYMARCH=0]="RAYMARCH",e[e.PATHTRACE=1]="PATHTRACE",e[e.SLICE=2]="SLICE",e}({});const qt=e=>e&&e.isOrthographicCamera;let Xt=function(e){return e.TOP_LEFT="top_left",e.TOP_RIGHT="top_right",e.BOTTOM_LEFT="bottom_left",e.BOTTOM_RIGHT="bottom_right",e}({});const $t=e=>e===Xt.TOP_LEFT||e===Xt.TOP_RIGHT,Yt=e=>e===Xt.TOP_RIGHT||e===Xt.BOTTOM_RIGHT;let Kt=function(e){return e[e.MILLISECOND=0]="MILLISECOND",e[e.SECOND=1]="SECOND",e[e.MINUTE=2]="MINUTE",e[e.HOUR=3]="HOUR",e[e.DAY=4]="DAY",e}({});const Zt={[Kt.MILLISECOND]:new Set(["ms","millisecond","milliseconds"]),[Kt.SECOND]:new Set(["s","sec","second","seconds"]),[Kt.MINUTE]:new Set(["m","min","minute","minutes"]),[Kt.HOUR]:new Set(["h","hr","hour","hours"]),[Kt.DAY]:new Set(["d","day","days"])};let Qt=function(e){return e[e.TRANSFORM=1]="TRANSFORM",e[e.CAMERA=2]="CAMERA",e[e.BOUNDING_BOX=4]="BOUNDING_BOX",e[e.ROI=8]="ROI",e[e.MASK_ALPHA=16]="MASK_ALPHA",e[e.MATERIAL=32]="MATERIAL",e[e.SAMPLING=64]="SAMPLING",e[e.VIEW=128]="VIEW",e[e.MASK_DATA=256]="MASK_DATA",e[e.ALL=1023]="ALL",e}({}),Jt=function(e){return e.X="x",e.Y="y",e.Z="z",e.XYZ="",e.NONE="",e}({});class en{constructor(e){this.translation=new i.Pq0(0,0,0),this.rotation=new i.O9p,this.scale=new i.Pq0(1,1,1),this.isOrtho=!1,this.viewAxis=Jt.NONE,this.orthoScale=1,this.flipAxes=new i.Pq0(1,1,1),this.maskChannelIndex=-1,this.maskAlpha=1,this.gammaMin=0,this.gammaLevel=1,this.gammaMax=1,this.density=0,this.brightness=0,this.showBoundingBox=!1,this.bounds={bmin:new i.Pq0(-.5,-.5,-.5),bmax:new i.Pq0(.5,.5,.5)},this.boundingBoxColor=[1,1,0],this.primaryRayStepSize=1,this.secondaryRayStepSize=1,this.useInterpolation=!0,this.visible=!0,this.maxProjectMode=!1,e?(this.zSlice=Math.floor(e.imageInfo.subregionSize.z/2),this.diffuse=new Array(e.imageInfo.numChannels).fill([255,255,255]),this.specular=new Array(e.imageInfo.numChannels).fill([0,0,0]),this.emissive=new Array(e.imageInfo.numChannels).fill([0,0,0]),this.glossiness=new Array(e.imageInfo.numChannels).fill(0)):(this.zSlice=0,this.diffuse=[[255,255,255]],this.specular=[[0,0,0]],this.emissive=[[0,0,0]],this.glossiness=[0]),this.pixelSamplingRate=.75,this.resolution=new i.I9Y(1,1)}resizeWithVolume(e){this.zSlice=Math.floor(e.imageInfo.subregionSize.z/2),this.diffuse=new Array(e.imageInfo.numChannels).fill([255,255,255]),this.specular=new Array(e.imageInfo.numChannels).fill([0,0,0]),this.emissive=new Array(e.imageInfo.numChannels).fill([0,0,0]),this.glossiness=new Array(e.imageInfo.numChannels).fill(0)}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++){const r=e[n],i=t[n];if(r instanceof Array&&i instanceof Array){if(!this.compareArray(r,i))return!1}else if(r!==i)return!1}return!0}isEqual(e){for(const t of Object.keys(this)){const n=this[t],r=e[t];if(n instanceof Array){if(!en.compareArray(n,r))return!1}else if(n&&void 0!==n.bmin){const e=n,t=r;if(!e.bmin.equals(t.bmin)||!e.bmax.equals(t.bmax))return!1}else if(n instanceof i.Pq0||n instanceof i.I9Y||n instanceof i.O9p){if(!n.equals(r))return!1}else if(n!==r)return!1}return!0}static deepCopyArray(e){const t=new Array(e.length);for(let n=0;n<e.length;n++){const r=e[n];t[n]=r instanceof Array?this.deepCopyArray(r):r}return t}clone(){const e=new en;for(const t of Object.keys(this)){const n=this[t];n instanceof Array?e[t]=en.deepCopyArray(n):"bounds"===t?(e.bounds.bmax=this.bounds.bmax.clone(),e.bounds.bmin=this.bounds.bmin.clone()):n instanceof i.Pq0||n instanceof i.I9Y||n instanceof i.O9p?e[t]=n.clone():e[t]=n instanceof String?""+n:n}return e}}const tn=1e3,nn=6e4,rn=36e5,on=864e5;function an(e,t=5){const n=e.toExponential(t-1),[r,i]=n.split("e");return`${r}10${"-"===i[0]?"":""}${i.slice(1).split("").map((e=>{return t=Number(e),String.fromCharCode([8304,185,178,179,8308,8309,8310,8311,8312,8313][t]);var t})).join("")}`}function sn(e,t=5,n=t-2){const r=Math.abs(e);if(Number.isInteger(e))return r>=1e4?an(e,n):e.toString();{const r=function(e,t){const n=Math.floor(Math.log10(Math.abs(e)));return e.toFixed(Math.max(t-n-1,0))}(e,t),i=Math.abs(Number(r));if(i>=1e4||i<.01)return an(e,n);const o=function(e){let t=e.length-1;for(;"0"===e[t];)t--;return e.slice(0,t+1)}(r);return o.endsWith(".")?o.slice(0,-1):o}}const ln={[Kt.MILLISECOND]:1,[Kt.SECOND]:tn,[Kt.MINUTE]:nn,[Kt.HOUR]:rn,[Kt.DAY]:on};function cn(e,t){const n=ln[t];if(void 0===n)throw new Error("Unrecognized time unit");return e*n}function un(e,t,n){return n?e.toString().padStart(t,"0"):e.toString()}function hn(e,t){const{useMs:n,useSec:r,useMin:i,useHours:o,useDays:a}=t,s=[],l=[];if(a){const t=Math.floor(e/on);s.push(t.toString()),l.push("d")}if(o){const t=Math.floor(e%on/rn);s.push(un(t,2,a)),l.push("h")}if(i){const t=Math.floor(e%rn/nn);s.push(un(t,2,o)),l.push("m")}if(r){let t=un(Math.floor(e%nn/tn),2,i);l.push("s"),n&&(t+="."+Math.floor(e%tn).toString().padStart(3,"0")),s.push(t)}else if(n){const t=Math.floor(e%tn);s.push(t.toString()),l.push("ms")}return{timestamp:s.join(":"),units:l.join(":")}}function dn(e){let t=e[0],n=e[0];for(let r=1;r<e.length;r++)t=Math.min(t,e[r]),n=Math.max(n,e[r]);return[t,n]}const fn="\nprecision highp float;\nprecision highp int;\nout vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = vec4(position, 1.0);\n}\n",pn="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nin vec2 vUv;\nuniform sampler2D image;\n\nvoid main() {\n  gl_FragColor = texture2D(image, vUv);\n}\n";let mn=function(e){return e[e.OPAQUE=0]="OPAQUE",e[e.TRANSPARENT=1]="TRANSPARENT",e}({});class gn{constructor(e,t,n=mn.OPAQUE){this.scene=new i.Z58,this.geometry=new i.bdM(2,2),this.material=new i.BKk({vertexShader:fn,fragmentShader:e,uniforms:t,transparent:n===mn.TRANSPARENT}),this.material.depthWrite=!1,this.material.depthTest=!1,this.mesh=new i.eaF(this.geometry,this.material),this.scene.add(this.mesh),this.camera=new i.qUd(-1,1,1,-1,0,1)}render(e,t){e.setRenderTarget(t??null),e.render(this.scene,this.camera),e.setRenderTarget(null)}}class vn{constructor(e,t){this.containerdiv=document.createElement("div"),this.containerdiv.style.position="relative",this.canvas=document.createElement("canvas"),this.containerdiv.appendChild(this.canvas),this.canvas.style.backgroundColor="black",e&&(this.canvas.height=e.offsetHeight,this.canvas.width=e.offsetWidth,e.appendChild(this.containerdiv)),this.scene=new i.Z58,this.meshRenderTarget=new i.nWS(this.canvas.width,this.canvas.height,{minFilter:i.hxR,magFilter:i.hxR,format:i.GWd,type:i.OUM,depthBuffer:!0}),this.meshRenderToBuffer=new gn(pn,{image:{value:this.meshRenderTarget.texture}}),this.meshRenderTarget.depthTexture=new i.VCu(this.canvas.width,this.canvas.height),this.scaleBarContainerElement=document.createElement("div"),this.orthoScaleBarElement=document.createElement("div"),this.showOrthoScaleBar=!0,this.perspectiveScaleBarElement=document.createElement("div"),this.showPerspectiveScaleBar=!1,this.timestepIndicatorElement=document.createElement("div"),this.showTimestepIndicator=!1,this.animateFuncs=[],this.postMeshRenderFuncs=[],this.overlayRenderFuncs=[],this.inRenderLoop=!1,this.requestedRender=0,this.hasWebGL2=!1;const n=this.canvas.getContext("webgl2");n?(this.hasWebGL2=!0,this.renderer=new Bt({context:n,canvas:this.canvas,preserveDrawingBuffer:!0,alpha:!0,premultipliedAlpha:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.state.setBlending(i.NTi),this.renderer.getContext().getExtension("EXT_color_buffer_float")):(console.warn("WebGL 2.0 not available. Some functionality may be limited. Please use a browser that supports WebGL 2.0."),this.renderer=new Bt({canvas:this.canvas,preserveDrawingBuffer:!0,alpha:!0,premultipliedAlpha:!1}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.state.setBlending(i.NTi)),this.renderer.localClippingEnabled=!0,e&&(this.renderer.setSize(e.offsetWidth,e.offsetHeight),this.meshRenderTarget.setSize(e.offsetWidth,e.offsetHeight)),this.timer=new Ht;const r=.5,o=this.getWidth()/this.getHeight();this.fov=20,this.perspectiveCamera=new i.ubm(this.fov,o,.1,20),this.resetPerspectiveCamera(),this.perspectiveControls=new jt(this.perspectiveCamera,this.canvas),this.perspectiveControls.rotateSpeed=4/window.devicePixelRatio,this.perspectiveControls.autoRotate=!1,this.perspectiveControls.staticMoving=!0,this.perspectiveControls.length=10,this.perspectiveControls.enabled=!0,this.orthographicCameraX=new i.qUd(-.5*o,r*o,r,-.5,.001,20),this.resetOrthographicCameraX(),this.orthoControlsX=new jt(this.orthographicCameraX,this.canvas),this.orthoControlsX.noRotate=!0,this.orthoControlsX.scale=r,this.orthoControlsX.scale0=r,this.orthoControlsX.aspect=o,this.orthoControlsX.staticMoving=!0,this.orthoControlsX.enabled=!1,this.orthoControlsX.panSpeed=.5*this.canvas.clientWidth,this.orthographicCameraY=new i.qUd(-.5*o,r*o,r,-.5,.001,20),this.resetOrthographicCameraY(),this.orthoControlsY=new jt(this.orthographicCameraY,this.canvas),this.orthoControlsY.noRotate=!0,this.orthoControlsY.scale=r,this.orthoControlsY.scale0=r,this.orthoControlsY.aspect=o,this.orthoControlsY.staticMoving=!0,this.orthoControlsY.enabled=!1,this.orthoControlsY.panSpeed=.5*this.canvas.clientWidth,this.orthographicCameraZ=new i.qUd(-.5*o,r*o,r,-.5,.001,20),this.resetOrthographicCameraZ(),this.orthoControlsZ=new jt(this.orthographicCameraZ,this.canvas),this.orthoControlsZ.noRotate=!0,this.orthoControlsZ.scale=r,this.orthoControlsZ.scale0=r,this.orthoControlsZ.aspect=o,this.orthoControlsZ.staticMoving=!0,this.orthoControlsZ.enabled=!1,this.orthoControlsZ.panSpeed=.5*this.canvas.clientWidth,this.camera=this.perspectiveCamera,this.controls=this.perspectiveControls,this.viewMode=Jt.NONE,this.axisCamera=new i.qUd,this.axisHelperScene=new i.Z58,this.axisHelperObject=new i.B69,this.axisHelperObject.name="axisHelperParentObject",this.showAxis=!1,this.axisScale=50,this.axisOffset=[66,66],this.setupAxisHelper(),this.setupIndicatorElements()}updateCameraFocus(e,t,n){this.perspectiveCamera.fov=e,this.fov=e,this.perspectiveCamera.updateProjectionMatrix()}resetPerspectiveCamera(){this.perspectiveCamera.position.x=0,this.perspectiveCamera.position.y=0,this.perspectiveCamera.position.z=5,this.perspectiveCamera.up.x=0,this.perspectiveCamera.up.y=1,this.perspectiveCamera.up.z=0}resetOrthographicCameraX(){this.orthographicCameraX.position.x=2,this.orthographicCameraX.position.y=0,this.orthographicCameraX.position.z=0,this.orthographicCameraX.up.x=0,this.orthographicCameraX.up.y=0,this.orthographicCameraX.up.z=1,this.orthographicCameraX.lookAt(new i.Pq0(0,0,0))}resetOrthographicCameraY(){this.orthographicCameraY.position.x=0,this.orthographicCameraY.position.y=2,this.orthographicCameraY.position.z=0,this.orthographicCameraY.up.x=0,this.orthographicCameraY.up.y=0,this.orthographicCameraY.up.z=1,this.orthographicCameraY.lookAt(new i.Pq0(0,0,0))}resetOrthographicCameraZ(){this.orthographicCameraZ.position.x=0,this.orthographicCameraZ.position.y=0,this.orthographicCameraZ.position.z=2,this.orthographicCameraZ.up.x=0,this.orthographicCameraZ.up.y=1,this.orthographicCameraZ.up.z=0,this.orthographicCameraZ.lookAt(new i.Pq0(0,0,0))}requestCapture(e){this.dataurlcallback=e,this.redraw()}isVR(){return this.renderer.xr.enabled}resetToPerspectiveCamera(){const e=this.getWidth()/this.getHeight();this.perspectiveCamera=new i.ubm(this.fov,e,.1,20),this.resetPerspectiveCamera(),this.switchViewMode("3D"),this.controls.object=this.perspectiveCamera,this.controls.enabled=!0,this.controls.reset()}resetCamera(){this.camera===this.perspectiveCamera?this.resetPerspectiveCamera():this.camera===this.orthographicCameraX?this.resetOrthographicCameraX():this.camera===this.orthographicCameraY?this.resetOrthographicCameraY():this.camera===this.orthographicCameraZ&&this.resetOrthographicCameraZ(),this.controls.reset()}setupAxisHelper(){const e=new i.V9B({color:11447469}),t=new i.iNn(this.axisScale/5,this.axisScale/5,this.axisScale/5),n=new i.eaF(t,e);this.axisHelperObject.add(n);const r=new i.IzY(this.axisScale);this.axisHelperObject.add(r),this.axisHelperScene.add(this.axisHelperObject),this.axisCamera=new i.qUd(0,this.getWidth(),this.getHeight(),0,.001,4*this.axisScale),this.axisCamera.position.z=1,this.axisCamera.up.x=0,this.axisCamera.up.y=1,this.axisCamera.up.z=0,this.axisCamera.lookAt(new i.Pq0(0,0,0)),this.axisCamera.position.set(-this.axisOffset[0],-this.axisOffset[1],2*this.axisScale)}setAxisPosition(e,t,n){this.axisOffset=[e+50,t+50],$t(n)&&(this.axisOffset[1]=this.getHeight()-this.axisOffset[1]),Yt(n)&&(this.axisOffset[0]=this.getWidth()-this.axisOffset[0]),this.axisCamera.position.set(-this.axisOffset[0],-this.axisOffset[1],2*this.axisScale)}orthoScreenPixelsToPhysicalUnits(e,t){const n=1/(this.camera.zoom*this.getHeight());return e*window.devicePixelRatio*n*t}setupIndicatorElements(){Object.assign(this.scaleBarContainerElement.style,{fontFamily:"-apple-system, 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif",position:"absolute",right:"169px",bottom:"20px"}),this.containerdiv.appendChild(this.scaleBarContainerElement),Object.assign(this.orthoScaleBarElement.style,{border:"1px solid white",borderTop:"none",height:"10px",display:"none",color:"white",mixBlendMode:"difference",fontSize:"14px",textAlign:"right",lineHeight:"0",boxSizing:"border-box",paddingRight:"10px",marginRight:"40px"}),this.scaleBarContainerElement.appendChild(this.orthoScaleBarElement),Object.assign(this.perspectiveScaleBarElement.style,{width:"75px",textAlign:"center",display:"none",color:"white"}),this.scaleBarContainerElement.appendChild(this.perspectiveScaleBarElement);const e=document.createElement("div"),t=document.createElement("div");t.style.color="rgb(255, 255, 0)",t.innerHTML='\n<svg enable-background="new 0 0 150 75.3" viewBox="0 0 150 75.3" xmlns="http://www.w3.org/2000/svg"\n  xmlns:xlink="http://www.w3.org/1999/xlink">\n  <linearGradient id="a" gradientTransform="matrix(1 0 0 -1 0 76)" gradientUnits="userSpaceOnUse" x1=".3035"\n    x2="149.6965" y1="19.59" y2="19.59">\n    <stop offset="0" stop-color="currentColor" stop-opacity="0" />\n    <stop offset=".16" stop-color="currentColor" />\n    <stop offset=".84" stop-color="currentColor" />\n    <stop offset="1" stop-color="currentColor" stop-opacity="0" />\n  </linearGradient>\n  <g fill="none">\n    <path d="m.5 39.1 149 34.6" stroke="url(#a)" stroke-miterlimit="10" stroke-width="4" />\n    <path d="m101.5 73.6 11-8.5" stroke="currentColor" stroke-miterlimit="10" stroke-width="4" />\n    <path d="m25.1 55.7 11-8.5" stroke="currentColor" stroke-miterlimit="10" stroke-width="4" />\n    <path\n      d="m36.2 40c0-12 5.3-12.4 10.5-14.2 5-1.7 17.3 1.9 22.6 1.7s8-5 8.4-11.8c-.4 6.9 3.4 13.8 10 16.3 8 3 17.9 2.7 23.2 7.3 7 6 3.3 12.2 1.6 19.1"\n      stroke="white" stroke-dasharray="2 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" />\n  </g>\n</svg>\n',this.perspectiveScaleBarElement.appendChild(e),this.perspectiveScaleBarElement.appendChild(t),Object.assign(this.timestepIndicatorElement.style,{fontFamily:"-apple-system, 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif",position:"absolute",right:"20px",bottom:"20px",color:"white",mixBlendMode:"difference",display:"none",lineHeight:"0.75"}),this.containerdiv.appendChild(this.timestepIndicatorElement)}updateOrthoScaleBar(e,t){const n=this.orthoScreenPixelsToPhysicalUnits(150,e),r=10**Math.floor(Math.log10(n)),i=Math.floor(n/r)*r,o=sn(i);this.orthoScaleBarElement.innerHTML=`${o}${t||""}`,this.orthoScaleBarElement.style.width=i/n*150+"px"}updatePerspectiveScaleBar(e,t){this.perspectiveScaleBarElement.firstChild.innerHTML=`${sn(e)}${t||""}`}updateTimestepIndicator(e,t,n){this.timestepIndicatorElement.innerHTML=function(e,t,n){const r=function(e){for(const[t,n]of Object.entries(Zt))if(n.has(e))return t}(n);if(void 0===r)return`${sn(e)} / ${sn(t)} ${n}`;const i=cn(e,r),o=cn(t,r),a={useMs:r==Kt.MILLISECOND,useSec:r==Kt.SECOND||r<=Kt.SECOND&&o>=tn,useMin:r==Kt.MINUTE||r<=Kt.MINUTE&&o>=nn,useHours:r==Kt.HOUR||r<=Kt.HOUR&&o>=rn,useDays:r==Kt.DAY||r<=Kt.DAY&&o>=on},{timestamp:s,units:l}=hn(i,a),{timestamp:c}=hn(o,a);return`${s} / ${c} ${l}`}(e,t,n)}setPerspectiveScaleBarColor(e){this.perspectiveScaleBarElement.lastChild.style.color=`rgb(${255*e[0]}, ${255*e[1]}, ${255*e[2]})`}updateScaleBarVisibility(){const e=qt(this.camera),t=e&&this.showOrthoScaleBar,n=!e&&this.showPerspectiveScaleBar;this.orthoScaleBarElement.style.display=t?"":"none",this.perspectiveScaleBarElement.style.display=n?"":"none"}setShowOrthoScaleBar(e){this.showOrthoScaleBar=e,this.updateScaleBarVisibility()}setShowPerspectiveScaleBar(e){this.showPerspectiveScaleBar=e,this.updateScaleBarVisibility()}setShowTimestepIndicator(e){this.showTimestepIndicator=e,this.timestepIndicatorElement.style.display=e?"":"none"}setIndicatorPosition(e,t,n,r){const{style:i}=e?this.timestepIndicatorElement:this.scaleBarContainerElement;i.removeProperty("top"),i.removeProperty("bottom"),i.removeProperty("left"),i.removeProperty("right");const o=Yt(r)?"right":"left",a=$t(r)?"top":"bottom";Object.assign(i,{[o]:t+"px",[a]:n+"px"})}setAutoRotate(e){this.controls.autoRotate=e}getAutoRotate(){return this.controls.autoRotate}replaceCamera(e){this.camera=e}replaceControls(e){this.controls!==e&&(this.controls.enabled=!1,this.removeControlHandlers(),this.controls=e,this.controls.enabled=!0,this.controlStartHandler&&this.controls.addEventListener("start",this.controlStartHandler),this.controlChangeHandler&&this.controls.addEventListener("change",this.controlChangeHandler),this.controlEndHandler&&this.controls.addEventListener("end",this.controlEndHandler),this.controls.update())}switchViewMode(e){switch(e=e.toUpperCase()){case"YZ":case"X":this.replaceCamera(this.orthographicCameraX),this.replaceControls(this.orthoControlsX),this.axisHelperObject.rotation.set(0,.5*Math.PI,0),this.viewMode=Jt.X;break;case"XZ":case"Y":this.replaceCamera(this.orthographicCameraY),this.replaceControls(this.orthoControlsY),this.axisHelperObject.rotation.set(.5*Math.PI,0,0),this.viewMode=Jt.Y;break;case"XY":case"Z":this.replaceCamera(this.orthographicCameraZ),this.replaceControls(this.orthoControlsZ),this.axisHelperObject.rotation.set(0,0,0),this.viewMode=Jt.Z;break;default:this.replaceCamera(this.perspectiveCamera),this.replaceControls(this.perspectiveControls),this.axisHelperObject.rotation.setFromRotationMatrix(this.camera.matrixWorldInverse),this.viewMode=Jt.NONE}this.updateScaleBarVisibility()}getMeshDepthTexture(){return this.meshRenderTarget.depthTexture}resize(e,t,n,r,i,o){t=t||this.containerdiv.parentElement?.offsetWidth||this.containerdiv.offsetWidth,n=n||this.containerdiv.parentElement?.offsetHeight||this.containerdiv.offsetHeight,this.containerdiv.style.width=t+"px",this.containerdiv.style.height=n+"px";const a=t/n;this.perspectiveControls.aspect=a,this.orthoControlsZ.aspect=a,this.orthoControlsZ.panSpeed=.5*t,this.orthoControlsY.aspect=a,this.orthoControlsY.panSpeed=.5*t,this.orthoControlsX.aspect=a,this.orthoControlsX.panSpeed=.5*t,qt(this.camera)?(this.camera.left=-.5*a,this.camera.right=.5*a,this.camera.updateProjectionMatrix()):(this.camera.aspect=a,this.camera.updateProjectionMatrix()),this.axisCamera.left=0,this.axisCamera.right=t,this.axisCamera.top=n,this.axisCamera.bottom=0,this.axisCamera.updateProjectionMatrix(),this.renderer.getPixelRatio()!==window.devicePixelRatio&&this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(t,n),this.meshRenderTarget.setSize(t,n),this.perspectiveControls.handleResize(),this.orthoControlsZ.handleResize(),this.orthoControlsY.handleResize(),this.orthoControlsX.handleResize()}setClearColor(e,t){this.renderer.setClearColor(e,t)}getWidth(){return this.renderer.getContext().canvas.width}getHeight(){return this.renderer.getContext().canvas.height}getCameraState(){return{position:this.camera.position.toArray(),up:this.camera.up.toArray(),target:this.controls.target.toArray(),orthoScale:qt(this.camera)?this.controls.scale:void 0,fov:(e=this.camera,e&&e.isPerspectiveCamera?this.camera.fov:void 0)};var e}setCameraState(e){const t={...this.getCameraState(),...e};this.camera.up.fromArray(t.up).normalize(),this.controls.target.fromArray(t.target);const n=function(e,t,n){switch(n){case Jt.X:return[e[0],t[1],t[2]];case Jt.Y:return[t[0],e[1],t[2]];case Jt.Z:return[t[0],t[1],e[2]];default:return[...e]}}(t.position,t.target,this.viewMode);if(this.camera.position.fromArray(n),qt(this.camera)){const e=t.orthoScale||.5;this.controls.scale=e,this.camera.zoom=.5/e}else this.camera.fov=t.fov||this.fov;this.controls.update(),this.camera.updateProjectionMatrix()}render(){qt(this.camera)||this.axisHelperObject.rotation.setFromRotationMatrix(this.camera.matrixWorldInverse);for(let e=0;e<this.animateFuncs.length;e++)this.animateFuncs[e]&&this.animateFuncs[e](this.renderer,this.camera,this.meshRenderTarget.depthTexture);this.camera.layers.set(1),this.renderer.setRenderTarget(this.meshRenderTarget),this.renderer.render(this.scene,this.camera),this.postMeshRenderFuncs.forEach((e=>{e(this.renderer,this.camera,this.meshRenderTarget.depthTexture)})),this.renderer.autoClear=!1,this.camera.layers.set(2),this.renderer.setRenderTarget(this.meshRenderTarget),this.renderer.render(this.scene,this.camera),this.meshRenderToBuffer.material.uniforms.image.value=this.meshRenderTarget.texture,this.meshRenderToBuffer.render(this.renderer),this.camera.layers.set(0),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera),this.camera.layers.set(3),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera),this.overlayRenderFuncs.forEach((e=>{e(this.renderer,this.camera,this.meshRenderTarget.depthTexture)})),this.renderer.autoClear=!0,this.showAxis&&(this.renderer.autoClear=!1,this.renderer.render(this.axisHelperScene,this.axisCamera),this.renderer.autoClear=!0),this.dataurlcallback&&(this.dataurlcallback(this.canvas.toDataURL()),this.dataurlcallback=void 0)}redraw(){this.inRenderLoop||(this.requestedRender&&cancelAnimationFrame(this.requestedRender),this.timer.begin(),this.requestedRender=requestAnimationFrame(this.onAnimationLoop.bind(this)))}onAnimationLoop(){this.timer.update();const e=this.timer.lastFrameMs/1e3;this.controls.update(e),this.render(),this.onRenderCallback?.()}startRenderLoop(){this.inRenderLoop=!0,this.timer.begin(),this.renderer.setAnimationLoop(this.onAnimationLoop.bind(this))}stopRenderLoop(){this.renderer.setAnimationLoop(null),this.inRenderLoop=!1,this.requestedRender&&(cancelAnimationFrame(this.requestedRender),this.requestedRender=0),this.timer.end()}setOnRenderCallback(e){this.onRenderCallback=e??void 0}removeControlHandlers(){this.controlStartHandler&&this.controls.removeEventListener("start",this.controlStartHandler),this.controlChangeHandler&&this.controls.removeEventListener("change",this.controlChangeHandler),this.controlEndHandler&&this.controls.removeEventListener("end",this.controlEndHandler)}setControlHandlers(e,t,n){this.removeControlHandlers(),e&&(this.controlStartHandler=e,this.controls.addEventListener("start",this.controlStartHandler)),t&&(this.controlChangeHandler=t,this.controls.addEventListener("change",this.controlChangeHandler)),n&&(this.controlEndHandler=n,this.controls.addEventListener("end",this.controlEndHandler))}hitTest(e,t,n){if(!n)return-1;const r=new i.I9Y;this.renderer.getSize(r);const o=e,a=r.y-t,s=Math.floor(o/r.x*n.width),l=Math.floor(a/r.y*n.height),c=new Float32Array(4).fill(-1);return this.renderer.readRenderTargetPixels(n,s,l,1,1,c),-1===c[3]||0===c[3]?-1:Math.round(c[1])}}const yn={spotlightSettings:Object.freeze({angle:36*i.cj9.DEG2RAD,castShadow:!1,color:16777215,intensity:.4,position:{x:-4,y:3.5,z:7}}),ambientLightSettings:Object.freeze({color:16777215,intensity:.6}),reflectedLightSettings:Object.freeze({castShadow:!1,color:16746666,intensity:.2,position:{x:1,y:-5,z:0}}),fillLightSettings:Object.freeze({castShadow:!1,color:15258025,intensity:.15,position:{x:2.5,y:.2,z:1.5}})};class bn{parse(e,t={}){const n=(t=Object.assign({binary:!1},t)).binary,r=[];let o,a=0;e.traverse((function(e){if(e.isMesh){const t=e.geometry,n=t.index,i=t.getAttribute("position");a+=null!==n?n.count/3:i.count/3,r.push({object3d:e,geometry:t})}}));let s=80;if(!0===n){const e=new ArrayBuffer(2*a+3*a*4*4+80+4);o=new DataView(e),o.setUint32(s,a,!0),s+=4}else o="",o+="solid exported\n";const l=new i.Pq0,c=new i.Pq0,u=new i.Pq0,h=new i.Pq0,d=new i.Pq0,f=new i.Pq0;for(let e=0,t=r.length;e<t;e++){const t=r[e].object3d,n=r[e].geometry,i=n.index,o=n.getAttribute("position");if(null!==i)for(let e=0;e<i.count;e+=3)p(i.getX(e+0),i.getX(e+1),i.getX(e+2),o,t);else for(let e=0;e<o.count;e+=3)p(e+0,e+1,e+2,o,t)}return!1===n&&(o+="endsolid exported\n"),o;function p(e,t,r,i,a){l.fromBufferAttribute(i,e),c.fromBufferAttribute(i,t),u.fromBufferAttribute(i,r),!0===a.isSkinnedMesh&&(a.applyBoneTransform(e,l),a.applyBoneTransform(t,c),a.applyBoneTransform(r,u)),l.applyMatrix4(a.matrixWorld),c.applyMatrix4(a.matrixWorld),u.applyMatrix4(a.matrixWorld),function(e,t,r){h.subVectors(r,t),d.subVectors(e,t),h.cross(d).normalize(),f.copy(h).normalize(),!0===n?(o.setFloat32(s,f.x,!0),s+=4,o.setFloat32(s,f.y,!0),s+=4,o.setFloat32(s,f.z,!0),s+=4):(o+="\tfacet normal "+f.x+" "+f.y+" "+f.z+"\n",o+="\t\touter loop\n")}(l,c,u),m(l),m(c),m(u),!0===n?(o.setUint16(s,0,!0),s+=2):(o+="\t\tendloop\n",o+="\tendfacet\n")}function m(e){!0===n?(o.setFloat32(s,e.x,!0),s+=4,o.setFloat32(s,e.y,!0),s+=4,o.setFloat32(s,e.z,!0),s+=4):o+="\t\t\tvertex "+e.x+" "+e.y+" "+e.z+"\n"}}}const _n={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class wn{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register((function(e){return new Un(e)})),this.register((function(e){return new Fn(e)})),this.register((function(e){return new jn(e)})),this.register((function(e){return new Hn(e)})),this.register((function(e){return new Gn(e)})),this.register((function(e){return new Wn(e)})),this.register((function(e){return new zn(e)})),this.register((function(e){return new Bn(e)})),this.register((function(e){return new Vn(e)})),this.register((function(e){return new qn(e)})),this.register((function(e){return new Xn(e)})),this.register((function(e){return new $n(e)})),this.register((function(e){return new Yn(e)})),this.register((function(e){return new Kn(e)}))}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}setTextureUtils(e){return this.textureUtils=e,this}parse(e,t,n,r){const i=new Nn,o=[];for(let e=0,t=this.pluginCallbacks.length;e<t;e++)o.push(this.pluginCallbacks[e](i));i.setPlugins(o),i.setTextureUtils(this.textureUtils),i.writeAsync(e,t,r).catch(n)}parseAsync(e,t){const n=this;return new Promise((function(r,i){n.parse(e,r,i,t)}))}}const xn=5120,Sn=5121,En=5122,An=5123,Mn=34962,Tn="KHR_mesh_quantization",Cn={};Cn[i.hxR]=9728,Cn[i.pHI]=9984,Cn[i.Cfg]=9986,Cn[i.k6q]=9729,Cn[i.kRr]=9985,Cn[i.$_I]=9987,Cn[i.ghU]=33071,Cn[i.GJx]=10497,Cn[i.kTW]=33648;const In={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Rn=new i.Q1f;function Pn(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))}function Ln(e){return 4*Math.ceil(e/4)}function kn(e,t=0){const n=Ln(e.byteLength);if(n!==e.byteLength){const r=new Uint8Array(n);if(r.set(new Uint8Array(e)),0!==t)for(let i=e.byteLength;i<n;i++)r[i]=t;return r.buffer}return e}function Dn(){return"undefined"==typeof document&&"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}function On(e,t){if(void 0!==e.toBlob)return new Promise((n=>e.toBlob(n,t)));let n;return"image/jpeg"===t?n=.92:"image/webp"===t&&(n=.8),e.convertToBlob({type:t,quality:n})}class Nn{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+i.sPf}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(e){this.plugins=e}setTextureUtils(e){this.textureUtils=e}async writeAsync(e,t,n={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(e),await Promise.all(this.pending);const r=this,i=r.buffers,o=r.json;n=r.options;const a=r.extensionsUsed,s=r.extensionsRequired,l=new Blob(i,{type:"application/octet-stream"}),c=Object.keys(a),u=Object.keys(s);if(c.length>0&&(o.extensionsUsed=c),u.length>0&&(o.extensionsRequired=u),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=l.size),!0===n.binary){const e=new FileReader;e.readAsArrayBuffer(l),e.onloadend=function(){const n=kn(e.result),r=new DataView(new ArrayBuffer(8));r.setUint32(0,n.byteLength,!0),r.setUint32(4,5130562,!0);const i=kn((a=JSON.stringify(o),(new TextEncoder).encode(a).buffer),32);var a;const s=new DataView(new ArrayBuffer(8));s.setUint32(0,i.byteLength,!0),s.setUint32(4,1313821514,!0);const l=new ArrayBuffer(12),c=new DataView(l);c.setUint32(0,1179937895,!0),c.setUint32(4,2,!0);const u=12+s.byteLength+i.byteLength+r.byteLength+n.byteLength;c.setUint32(8,u,!0);const h=new Blob([l,s,i,r,n],{type:"application/octet-stream"}),d=new FileReader;d.readAsArrayBuffer(h),d.onloadend=function(){t(d.result)}}}else if(o.buffers&&o.buffers.length>0){const e=new FileReader;e.readAsDataURL(l),e.onloadend=function(){const n=e.result;o.buffers[0].uri=n,t(o)}}else t(o)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const n=this.options,r=this.extensionsUsed;try{const i=JSON.parse(JSON.stringify(e.userData));if(n.includeCustomExtensions&&i.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in i.gltfExtensions)t.extensions[e]=i.gltfExtensions[e],r[e]=!0;delete i.gltfExtensions}Object.keys(i).length>0&&(t.extras=i)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new i.Pq0;for(let n=0,r=e.count;n<r;n++)if(Math.abs(t.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const n=e.clone(),r=new i.Pq0;for(let e=0,t=n.count;e<t;e++)r.fromBufferAttribute(n,e),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),n.setXYZ(e,r.x,r.y,r.z);return t.attributesNormalized.set(e,n),n}applyTextureTransform(e,t){let n=!1;const r={};0===t.offset.x&&0===t.offset.y||(r.offset=t.offset.toArray(),n=!0),0!==t.rotation&&(r.rotation=t.rotation,n=!0),1===t.repeat.x&&1===t.repeat.y||(r.scale=t.repeat.toArray(),n=!0),n&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=r,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(e,t){if(e===t)return e;function n(e){return e.colorSpace===i.er$?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}e instanceof i.FvD&&(e=await this.decompressTextureAsync(e)),t instanceof i.FvD&&(t=await this.decompressTextureAsync(t));const r=e?e.image:null,o=t?t.image:null,a=Math.max(r?r.width:0,o?o.width:0),s=Math.max(r?r.height:0,o?o.height:0),l=Dn();l.width=a,l.height=s;const c=l.getContext("2d",{willReadFrequently:!0});c.fillStyle="#00ffff",c.fillRect(0,0,a,s);const u=c.getImageData(0,0,a,s);if(r){c.drawImage(r,0,0,a,s);const t=n(e),i=c.getImageData(0,0,a,s).data;for(let e=2;e<i.length;e+=4)u.data[e]=256*t(i[e]/256)}if(o){c.drawImage(o,0,0,a,s);const e=n(t),r=c.getImageData(0,0,a,s).data;for(let t=1;t<r.length;t+=4)u.data[t]=256*e(r[t]/256)}c.putImageData(u,0,0);const h=(e||t).clone();return h.source=new i.kLi(l),h.colorSpace=i.jf0,h.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),h}async decompressTextureAsync(e,t=1/0){if(null===this.textureUtils)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(e,t)}processBuffer(e){const t=this.json,n=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),n.push(e),0}processBufferView(e,t,n,r,o){const a=this.json;let s;switch(a.bufferViews||(a.bufferViews=[]),t){case xn:case Sn:s=1;break;case En:case An:s=2;break;default:s=4}let l=e.itemSize*s;o===Mn&&(l=4*Math.ceil(l/4));const c=Ln(r*l),u=new DataView(new ArrayBuffer(c));let h=0;for(let o=n;o<n+r;o++){for(let n=0;n<e.itemSize;n++){let r;e.itemSize>4?r=e.array[o*e.itemSize+n]:(0===n?r=e.getX(o):1===n?r=e.getY(o):2===n?r=e.getZ(o):3===n&&(r=e.getW(o)),!0===e.normalized&&(r=i.cj9.normalize(r,e.array))),5126===t?u.setFloat32(h,r,!0):5124===t?u.setInt32(h,r,!0):5125===t?u.setUint32(h,r,!0):t===En?u.setInt16(h,r,!0):t===An?u.setUint16(h,r,!0):t===xn?u.setInt8(h,r):t===Sn&&u.setUint8(h,r),h+=s}h%l!=0&&(h+=l-h%l)}const d={buffer:this.processBuffer(u.buffer),byteOffset:this.byteOffset,byteLength:c};return void 0!==o&&(d.target=o),o===Mn&&(d.byteStride=l),this.byteOffset+=c,a.bufferViews.push(d),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,n=t.json;return n.bufferViews||(n.bufferViews=[]),new Promise((function(r){const i=new FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){const e=kn(i.result),o={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,r(n.bufferViews.push(o)-1)}}))}processAccessor(e,t,n,r){const o=this.json;let a;if(e.array.constructor===Float32Array)a=5126;else if(e.array.constructor===Int32Array)a=5124;else if(e.array.constructor===Uint32Array)a=5125;else if(e.array.constructor===Int16Array)a=En;else if(e.array.constructor===Uint16Array)a=An;else if(e.array.constructor===Int8Array)a=xn;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);a=Sn}if(void 0===n&&(n=0),void 0!==r&&r!==1/0||(r=e.count),0===r)return null;const s=function(e,t,n){const r={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let o=t;o<t+n;o++)for(let t=0;t<e.itemSize;t++){let n;e.itemSize>4?n=e.array[o*e.itemSize+t]:(0===t?n=e.getX(o):1===t?n=e.getY(o):2===t?n=e.getZ(o):3===t&&(n=e.getW(o)),!0===e.normalized&&(n=i.cj9.normalize(n,e.array))),r.min[t]=Math.min(r.min[t],n),r.max[t]=Math.max(r.max[t],n)}return r}(e,n,r);let l;void 0!==t&&(l=e===t.index?34963:Mn);const c=this.processBufferView(e,a,n,r,l),u={bufferView:c.id,byteOffset:c.byteOffset,componentType:a,count:r,max:s.max,min:s.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(u.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(u)-1}processImage(e,t,n,r="image/png"){if(null!==e){const o=this,a=o.cache,s=o.json,l=o.options,c=o.pending;a.images.has(e)||a.images.set(e,{});const u=a.images.get(e),h=r+":flipY/"+n.toString();if(void 0!==u[h])return u[h];s.images||(s.images=[]);const d={mimeType:r},f=Dn();f.width=Math.min(e.width,l.maxTextureSize),f.height=Math.min(e.height,l.maxTextureSize);const p=f.getContext("2d",{willReadFrequently:!0});if(!0===n&&(p.translate(0,f.height),p.scale(1,-1)),void 0!==e.data){t!==i.GWd&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>l.maxTextureSize||e.height>l.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const n=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<n.length;t+=4)n[t+0]=e.data[t+0],n[t+1]=e.data[t+1],n[t+2]=e.data[t+2],n[t+3]=e.data[t+3];p.putImageData(new ImageData(n,e.width,e.height),0,0)}else{if(!("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas))throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");p.drawImage(e,0,0,f.width,f.height)}!0===l.binary?c.push(On(f,r).then((e=>o.processBufferViewImage(e))).then((e=>{d.bufferView=e}))):void 0!==f.toDataURL?d.uri=f.toDataURL(r):c.push(On(f,r).then((e=>(new FileReader).readAsDataURL(e))).then((e=>{d.uri=e})));const m=s.images.push(d)-1;return u[h]=m,m}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const n={magFilter:Cn[e.magFilter],minFilter:Cn[e.minFilter],wrapS:Cn[e.wrapS],wrapT:Cn[e.wrapT]};return t.samplers.push(n)-1}async processTextureAsync(e){const t=this.options,n=this.cache,r=this.json;if(n.textures.has(e))return n.textures.get(e);r.textures||(r.textures=[]),e instanceof i.FvD&&(e=await this.decompressTextureAsync(e,t.maxTextureSize));let o=e.userData.mimeType;"image/webp"===o&&(o="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,o)};e.name&&(a.name=e.name),await this._invokeAllAsync((async function(t){t.writeTexture&&await t.writeTexture(e,a)}));const s=r.textures.push(a)-1;return n.textures.set(e,s),s}async processMaterialAsync(e){const t=this.cache,n=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;n.materials||(n.materials=[]);const r={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(Pn(o,[1,1,1,1])||(r.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(r.pbrMetallicRoughness.metallicFactor=e.metalness,r.pbrMetallicRoughness.roughnessFactor=e.roughness):(r.pbrMetallicRoughness.metallicFactor=0,r.pbrMetallicRoughness.roughnessFactor=1),e.metalnessMap||e.roughnessMap){const t=await this.buildMetalRoughTextureAsync(e.metalnessMap,e.roughnessMap),n={index:await this.processTextureAsync(t),texCoord:t.channel};this.applyTextureTransform(n,t),r.pbrMetallicRoughness.metallicRoughnessTexture=n}if(e.map){const t={index:await this.processTextureAsync(e.map),texCoord:e.map.channel};this.applyTextureTransform(t,e.map),r.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive;if(Math.max(t.r,t.g,t.b)>0&&(r.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:await this.processTextureAsync(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(t,e.emissiveMap),r.emissiveTexture=t}}if(e.normalMap){const t={index:await this.processTextureAsync(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),r.normalTexture=t}if(e.aoMap){const t={index:await this.processTextureAsync(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),r.occlusionTexture=t}e.transparent?r.alphaMode="BLEND":e.alphaTest>0&&(r.alphaMode="MASK",r.alphaCutoff=e.alphaTest),e.side===i.$EB&&(r.doubleSided=!0),""!==e.name&&(r.name=e.name),this.serializeUserData(e,r),await this._invokeAllAsync((async function(t){t.writeMaterialAsync&&await t.writeMaterialAsync(e,r)}));const a=n.materials.push(r)-1;return t.materials.set(e,a),a}async processMeshAsync(e){const t=this.cache,n=this.json,r=[e.geometry.uuid];if(Array.isArray(e.material))for(let t=0,n=e.material.length;t<n;t++)r.push(e.material[t].uuid);else r.push(e.material.uuid);const o=r.join(":");if(t.meshes.has(o))return t.meshes.get(o);const a=e.geometry;let s;s=e.isLineSegments?1:e.isLineLoop?2:e.isLine?3:e.isPoints?0:e.material.wireframe?1:4;const l={},c={},u=[],h=[],d={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},f=a.getAttribute("normal");void 0===f||this.isNormalizedNormalAttribute(f)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(f)));let p=null;for(let e in a.attributes){if("morph"===e.slice(0,5))continue;const n=a.attributes[e];if(e=d[e]||e.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(e)||(e="_"+e),t.attributes.has(this.getUID(n))){c[e]=t.attributes.get(this.getUID(n));continue}p=null;const r=n.array;"JOINTS_0"!==e||r instanceof Uint16Array||r instanceof Uint8Array?(r instanceof Uint32Array||r instanceof Int32Array)&&!e.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${e}" converted to type FLOAT.`),p=wn.Utils.toFloat32BufferAttribute(n)):(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),p=new i.THS(new Uint16Array(r),n.itemSize,n.normalized));const o=this.processAccessor(p||n,a);null!==o&&(e.startsWith("_")||this.detectMeshQuantization(e,n),c[e]=o,t.attributes.set(this.getUID(n),o))}if(void 0!==f&&a.setAttribute("normal",f),0===Object.keys(c).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const n=[],r=[],i={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)i[e.morphTargetDictionary[t]]=t;for(let o=0;o<e.morphTargetInfluences.length;++o){const s={};let l=!1;for(const e in a.morphAttributes){if("position"!==e&&"normal"!==e){l||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),l=!0);continue}const n=a.morphAttributes[e][o],r=e.toUpperCase(),i=a.attributes[e];if(t.attributes.has(this.getUID(n,!0))){s[r]=t.attributes.get(this.getUID(n,!0));continue}const c=n.clone();if(!a.morphTargetsRelative)for(let e=0,t=n.count;e<t;e++)for(let t=0;t<n.itemSize;t++)0===t&&c.setX(e,n.getX(e)-i.getX(e)),1===t&&c.setY(e,n.getY(e)-i.getY(e)),2===t&&c.setZ(e,n.getZ(e)-i.getZ(e)),3===t&&c.setW(e,n.getW(e)-i.getW(e));s[r]=this.processAccessor(c,a),t.attributes.set(this.getUID(i,!0),s[r])}h.push(s),n.push(e.morphTargetInfluences[o]),void 0!==e.morphTargetDictionary&&r.push(i[o])}l.weights=n,r.length>0&&(l.extras={},l.extras.targetNames=r)}const m=Array.isArray(e.material);if(m&&0===a.groups.length)return null;let g=!1;if(m&&null===a.index){const e=[];for(let t=0,n=a.attributes.position.count;t<n;t++)e[t]=t;a.setIndex(e),g=!0}const v=m?e.material:[e.material],y=m?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let e=0,n=y.length;e<n;e++){const n={mode:s,attributes:c};if(this.serializeUserData(a,n),h.length>0&&(n.targets=h),null!==a.index){let r=this.getUID(a.index);void 0===y[e].start&&void 0===y[e].count||(r+=":"+y[e].start+":"+y[e].count),t.attributes.has(r)?n.indices=t.attributes.get(r):(n.indices=this.processAccessor(a.index,a,y[e].start,y[e].count),t.attributes.set(r,n.indices)),null===n.indices&&delete n.indices}const r=await this.processMaterialAsync(v[y[e].materialIndex]);null!==r&&(n.material=r),u.push(n)}!0===g&&a.setIndex(null),l.primitives=u,n.meshes||(n.meshes=[]),await this._invokeAllAsync((function(t){t.writeMesh&&t.writeMesh(e,l)}));const b=n.meshes.push(l)-1;return t.meshes.set(o,b),b}detectMeshQuantization(e,t){if(this.extensionsUsed[Tn])return;let n;switch(t.array.constructor){case Int8Array:n="byte";break;case Uint8Array:n="unsigned byte";break;case Int16Array:n="short";break;case Uint16Array:n="unsigned short";break;default:return}t.normalized&&(n+=" normalized");const r=e.split("_",1)[0];_n[r]&&_n[r].includes(n)&&(this.extensionsUsed[Tn]=!0,this.extensionsRequired[Tn]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const n=e.isOrthographicCamera,r={type:n?"orthographic":"perspective"};return n?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:i.cj9.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),t.cameras.push(r)-1}processAnimation(e,t){const n=this.json,r=this.nodeMap;n.animations||(n.animations=[]);const o=(e=wn.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,a=[],s=[];for(let e=0;e<o.length;++e){const n=o[e],l=i.Nwf.parseTrackName(n.name);let c=i.Nwf.findNode(t,l.nodeName);const u=In[l.propertyName];if("bones"===l.objectName&&(c=!0===c.isSkinnedMesh?c.skeleton.getBoneByName(l.objectIndex):void 0),!c||!u){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',n.name);continue}const h=1;let d,f=n.values.length/n.times.length;u===In.morphTargetInfluences&&(f/=c.morphTargetInfluences.length),!0===n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(d="CUBICSPLINE",f/=3):d=n.getInterpolation()===i.ljd?"STEP":"LINEAR",s.push({input:this.processAccessor(new i.THS(n.times,h)),output:this.processAccessor(new i.THS(n.values,f)),interpolation:d}),a.push({sampler:s.length-1,target:{node:r.get(c),path:u}})}return n.animations.push({name:e.name||"clip_"+n.animations.length,samplers:s,channels:a}),n.animations.length-1}processSkin(e){const t=this.json,n=this.nodeMap,r=t.nodes[n.get(e)],o=e.skeleton;if(void 0===o)return null;const a=e.skeleton.bones[0];if(void 0===a)return null;const s=[],l=new Float32Array(16*o.bones.length),c=new i.kn4;for(let t=0;t<o.bones.length;++t)s.push(n.get(o.bones[t])),c.copy(o.boneInverses[t]),c.multiply(e.bindMatrix).toArray(l,16*t);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new i.THS(l,16)),joints:s,skeleton:n.get(a)}),r.skin=t.skins.length-1}async processNodeAsync(e){const t=this.json,n=this.options,r=this.nodeMap;t.nodes||(t.nodes=[]);const i={};if(n.trs){const t=e.quaternion.toArray(),n=e.position.toArray(),r=e.scale.toArray();Pn(t,[0,0,0,1])||(i.rotation=t),Pn(n,[0,0,0])||(i.translation=n),Pn(r,[1,1,1])||(i.scale=r)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===Pn(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(i.matrix=e.matrix.elements);if(""!==e.name&&(i.name=String(e.name)),this.serializeUserData(e,i),e.isMesh||e.isLine||e.isPoints){const t=await this.processMeshAsync(e);null!==t&&(i.mesh=t)}else e.isCamera&&(i.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const t=[];for(let r=0,i=e.children.length;r<i;r++){const i=e.children[r];if(i.visible||!1===n.onlyVisible){const e=await this.processNodeAsync(i);null!==e&&t.push(e)}}t.length>0&&(i.children=t)}await this._invokeAllAsync((function(t){t.writeNode&&t.writeNode(e,i)}));const o=t.nodes.push(i)-1;return r.set(e,o),o}async processSceneAsync(e){const t=this.json,n=this.options;t.scenes||(t.scenes=[],t.scene=0);const r={};""!==e.name&&(r.name=e.name),t.scenes.push(r);const i=[];for(let t=0,r=e.children.length;t<r;t++){const r=e.children[t];if(r.visible||!1===n.onlyVisible){const e=await this.processNodeAsync(r);null!==e&&i.push(e)}}i.length>0&&(r.nodes=i),this.serializeUserData(e,r)}async processObjectsAsync(e){const t=new i.Z58;t.name="AuxScene";for(let n=0;n<e.length;n++)t.children.push(e[n]);await this.processSceneAsync(t)}async processInputAsync(e){const t=this.options;e=e instanceof Array?e:[e],await this._invokeAllAsync((function(t){t.beforeParse&&t.beforeParse(e)}));const n=[];for(let t=0;t<e.length;t++)e[t]instanceof i.Z58?await this.processSceneAsync(e[t]):n.push(e[t]);n.length>0&&await this.processObjectsAsync(n);for(let e=0;e<this.skins.length;++e)this.processSkin(this.skins[e]);for(let n=0;n<t.animations.length;++n)this.processAnimation(t.animations[n],e[0]);await this._invokeAllAsync((function(t){t.afterParse&&t.afterParse(e)}))}async _invokeAllAsync(e){for(let t=0,n=this.plugins.length;t<n;t++)await e(this.plugins[t])}}class Un{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const n=this.writer,r=n.json,i=n.extensionsUsed,o={};e.name&&(o.name=e.name),o.color=e.color.toArray(),o.intensity=e.intensity,e.isDirectionalLight?o.type="directional":e.isPointLight?(o.type="point",e.distance>0&&(o.range=e.distance)):e.isSpotLight&&(o.type="spot",e.distance>0&&(o.range=e.distance),o.spot={},o.spot.innerConeAngle=(1-e.penumbra)*e.angle,o.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),i[this.name]||(r.extensions=r.extensions||{},r.extensions[this.name]={lights:[]},i[this.name]=!0);const a=r.extensions[this.name].lights;a.push(o),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}}class Fn{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}async writeMaterialAsync(e,t){if(!e.isMeshBasicMaterial)return;const n=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class zn{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const n=this.writer,r=n.extensionsUsed,i={};if(i.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:await n.processTextureAsync(e.clearcoatMap),texCoord:e.clearcoatMap.channel};n.applyTextureTransform(t,e.clearcoatMap),i.clearcoatTexture=t}if(i.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:await n.processTextureAsync(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};n.applyTextureTransform(t,e.clearcoatRoughnessMap),i.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:await n.processTextureAsync(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};1!==e.clearcoatNormalScale.x&&(t.scale=e.clearcoatNormalScale.x),n.applyTextureTransform(t,e.clearcoatNormalMap),i.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class Bn{constructor(e){this.writer=e,this.name="KHR_materials_dispersion"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.dispersion)return;const n=this.writer.extensionsUsed,r={};r.dispersion=e.dispersion,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}}class Vn{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const n=this.writer,r=n.extensionsUsed,i={};if(i.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:await n.processTextureAsync(e.iridescenceMap),texCoord:e.iridescenceMap.channel};n.applyTextureTransform(t,e.iridescenceMap),i.iridescenceTexture=t}if(i.iridescenceIor=e.iridescenceIOR,i.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],i.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:await n.processTextureAsync(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};n.applyTextureTransform(t,e.iridescenceThicknessMap),i.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class jn{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const n=this.writer,r=n.extensionsUsed,i={};if(i.transmissionFactor=e.transmission,e.transmissionMap){const t={index:await n.processTextureAsync(e.transmissionMap),texCoord:e.transmissionMap.channel};n.applyTextureTransform(t,e.transmissionMap),i.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class Hn{constructor(e){this.writer=e,this.name="KHR_materials_volume"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const n=this.writer,r=n.extensionsUsed,i={};if(i.thicknessFactor=e.thickness,e.thicknessMap){const t={index:await n.processTextureAsync(e.thicknessMap),texCoord:e.thicknessMap.channel};n.applyTextureTransform(t,e.thicknessMap),i.thicknessTexture=t}e.attenuationDistance!==1/0&&(i.attenuationDistance=e.attenuationDistance),i.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class Gn{constructor(e){this.writer=e,this.name="KHR_materials_ior"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const n=this.writer.extensionsUsed,r={};r.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}}class Wn{constructor(e){this.writer=e,this.name="KHR_materials_specular"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(Rn)&&!e.specularIntensityMap&&!e.specularColorMap)return;const n=this.writer,r=n.extensionsUsed,i={};if(e.specularIntensityMap){const t={index:await n.processTextureAsync(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};n.applyTextureTransform(t,e.specularIntensityMap),i.specularTexture=t}if(e.specularColorMap){const t={index:await n.processTextureAsync(e.specularColorMap),texCoord:e.specularColorMap.channel};n.applyTextureTransform(t,e.specularColorMap),i.specularColorTexture=t}i.specularFactor=e.specularIntensity,i.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class qn{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const n=this.writer,r=n.extensionsUsed,i={};if(e.sheenRoughnessMap){const t={index:await n.processTextureAsync(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};n.applyTextureTransform(t,e.sheenRoughnessMap),i.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:await n.processTextureAsync(e.sheenColorMap),texCoord:e.sheenColorMap.channel};n.applyTextureTransform(t,e.sheenColorMap),i.sheenColorTexture=t}i.sheenRoughnessFactor=e.sheenRoughness,i.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class Xn{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(e,t){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const n=this.writer,r=n.extensionsUsed,i={};if(e.anisotropyMap){const t={index:await n.processTextureAsync(e.anisotropyMap)};n.applyTextureTransform(t,e.anisotropyMap),i.anisotropyTexture=t}i.anisotropyStrength=e.anisotropy,i.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class $n{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const n=this.writer.extensionsUsed,r={};r.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=r,n[this.name]=!0}}class Yn{constructor(e){this.writer=e,this.name="EXT_materials_bump"}async writeMaterialAsync(e,t){if(!e.isMeshStandardMaterial||1===e.bumpScale&&!e.bumpMap)return;const n=this.writer,r=n.extensionsUsed,i={};if(e.bumpMap){const t={index:await n.processTextureAsync(e.bumpMap),texCoord:e.bumpMap.channel};n.applyTextureTransform(t,e.bumpMap),i.bumpTexture=t}i.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=i,r[this.name]=!0}}class Kn{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const n=this.writer,r=e,o=new Float32Array(3*r.count),a=new Float32Array(4*r.count),s=new Float32Array(3*r.count),l=new i.kn4,c=new i.Pq0,u=new i.PTz,h=new i.Pq0;for(let e=0;e<r.count;e++)r.getMatrixAt(e,l),l.decompose(c,u,h),c.toArray(o,3*e),u.toArray(a,4*e),h.toArray(s,3*e);const d={TRANSLATION:n.processAccessor(new i.THS(o,3)),ROTATION:n.processAccessor(new i.THS(a,4)),SCALE:n.processAccessor(new i.THS(s,3))};r.instanceColor&&(d._COLOR_0=n.processAccessor(r.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:d},n.extensionsUsed[this.name]=!0,n.extensionsRequired[this.name]=!0}}wn.Utils={insertKeyframe:function(e,t){const n=.001,r=e.getValueSize(),i=new e.TimeBufferType(e.times.length+1),o=new e.ValueBufferType(e.values.length+r),a=e.createInterpolant(new e.ValueBufferType(r));let s;if(0===e.times.length){i[0]=t;for(let e=0;e<r;e++)o[e]=0;s=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<n)return 0;i[0]=t,i.set(e.times,1),o.set(a.evaluate(t),0),o.set(e.values,r),s=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<n)return e.times.length-1;i[i.length-1]=t,i.set(e.times,0),o.set(e.values,0),o.set(a.evaluate(t),e.values.length),s=i.length-1}else for(let l=0;l<e.times.length;l++){if(Math.abs(e.times[l]-t)<n)return l;if(e.times[l]<t&&e.times[l+1]>t){i.set(e.times.slice(0,l+1),0),i[l+1]=t,i.set(e.times.slice(l+1),l+2),o.set(e.values.slice(0,(l+1)*r),0),o.set(a.evaluate(t),(l+1)*r),o.set(e.values.slice((l+1)*r),(l+2)*r),s=l+1;break}}return e.times=i,e.values=o,s},mergeMorphTargetTracks:function(e,t){const n=[],r={},o=e.tracks;for(let e=0;e<o.length;++e){let a=o[e];const s=i.Nwf.parseTrackName(a.name),l=i.Nwf.findNode(t,s.nodeName);if("morphTargetInfluences"!==s.propertyName||void 0===s.propertyIndex){n.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(i.PJ3)}const c=l.morphTargetInfluences.length,u=l.morphTargetDictionary[s.propertyIndex];if(void 0===u)throw new Error("THREE.GLTFExporter: Morph target name not found: "+s.propertyIndex);let h;if(void 0===r[l.uuid]){h=a.clone();const e=new h.ValueBufferType(c*h.times.length);for(let t=0;t<h.times.length;t++)e[t*c+u]=h.values[t];h.name=(s.nodeName||"")+".morphTargetInfluences",h.values=e,r[l.uuid]=h,n.push(h);continue}const d=a.createInterpolant(new a.ValueBufferType(1));h=r[l.uuid];for(let e=0;e<h.times.length;e++)h.values[e*c+u]=d.evaluate(h.times[e]);for(let e=0;e<a.times.length;e++){const t=this.insertKeyframe(h,a.times[e]);h.values[t*c+u]=a.values[e]}}return e.tracks=n,e},toFloat32BufferAttribute:function(e){const t=new i.THS(new Float32Array(e.count*e.itemSize),e.itemSize,!1);if(!e.normalized&&!e.isInterleavedBufferAttribute)return t.array.set(e.array),t;for(let n=0,r=e.count;n<r;n++)for(let r=0;r<e.itemSize;r++)t.setComponent(n,r,e.getComponent(n,r));return t}};new i.Q1f(16777215);class Zn{static save(e,t){const n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}static saveString(e,t){const n=new Blob([e],{type:"text/plain;charset=utf-8"});Zn.save(n,t)}static saveBinary(e,t){const n=new Blob([new Uint8Array(e)],{type:"application/octet-stream"});Zn.save(n,t)}static saveArrayBuffer(e,t){const n=new Blob([e],{type:"application/octet-stream"});Zn.save(n,t)}}!function(){var e=new Int32Array(24),t=new Int32Array(256);!function(){for(var n=0,r=0;r<8;++r)for(var i=1;i<=4;i<<=1){var o=r^i;r<=o&&(e[n++]=r,e[n++]=o)}for(r=0;r<256;++r){var a=0;for(i=0;i<24;i+=2)a|=!!(r&1<<e[i])!=!!(r&1<<e[i+1])?1<<(i>>1):0;t[r]=a}}();new Int32Array(4096)}();class Qn extends i.eaF{constructor(e,t,n,r,o,a){super(new i.LoY,t),this.maxCount=16384,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1;const s=this;this.isovalue=0;const l=new Float32Array(36),c=new Float32Array(36);function u(e,t,n){return e+(t-e)*n}function h(e,t,n,r,i,o,a,h){const d=(n-a)/(h-a),f=s.normal_cache;l[t+0]=r+d*s.deltaX*s.stepSizeX,l[t+1]=i,l[t+2]=o,c[t+0]=u(f[e+0],f[e+3],d),c[t+1]=u(f[e+1],f[e+4],d),c[t+2]=u(f[e+2],f[e+5],d)}function d(e,t,n,r,i,o,a,h){const d=(n-a)/(h-a),f=s.normal_cache;l[t+0]=r,l[t+1]=i+d*s.deltaY*s.stepSizeY,l[t+2]=o;const p=e+3*s.yd;c[t+0]=u(f[e+0],f[p+0],d),c[t+1]=u(f[e+1],f[p+1],d),c[t+2]=u(f[e+2],f[p+2],d)}function f(e,t,n,r,i,o,a,h){const d=(n-a)/(h-a),f=s.normal_cache;l[t+0]=r,l[t+1]=i,l[t+2]=o+d*s.deltaZ*s.stepSizeZ;const p=e+3*s.zd;c[t+0]=u(f[e+0],f[p+0],d),c[t+1]=u(f[e+1],f[p+1],d),c[t+2]=u(f[e+2],f[p+2],d)}function p(e){const t=3*e;0===s.normal_cache[t]&&(s.normal_cache[t+0]=s.field[e-1*s.stepSizeX]-s.field[e+1*s.stepSizeX],s.normal_cache[t+1]=s.field[e-s.yd*s.stepSizeY]-s.field[e+s.yd*s.stepSizeY],s.normal_cache[t+2]=s.field[e-s.zd*s.stepSizeZ]-s.field[e+s.zd*s.stepSizeZ])}function m(e,t,n,r,i,o){const a=r+1*s.stepSizeX,u=r+s.yd*s.stepSizeY,m=r+s.zd*s.stepSizeZ,v=a+s.yd*s.stepSizeY,y=a+s.zd*s.stepSizeZ,b=r+s.yd*s.stepSizeY+s.zd*s.stepSizeZ,_=a+s.yd*s.stepSizeY+s.zd*s.stepSizeZ;let w=0;const x=s.field[r],S=s.field[a],E=s.field[u],A=s.field[v],M=s.field[m],T=s.field[y],C=s.field[b],I=s.field[_];x<i&&(w|=1),S<i&&(w|=2),E<i&&(w|=8),A<i&&(w|=4),M<i&&(w|=16),T<i&&(w|=32),C<i&&(w|=128),I<i&&(w|=64);const R=Jn[w];if(0===R)return 0;const P=e+s.deltaX*s.stepSizeX,L=t+s.deltaY*s.stepSizeY,k=n+s.deltaZ*s.stepSizeZ;1&R&&(p(r),p(a),h(3*r,0,i,e,t,n,x,S)),2&R&&(p(a),p(v),d(3*a,3,i,P,t,n,S,A)),4&R&&(p(u),p(v),h(3*u,6,i,e,L,n,E,A)),8&R&&(p(r),p(u),d(3*r,9,i,e,t,n,x,E)),16&R&&(p(m),p(y),h(3*m,12,i,e,t,k,M,T)),32&R&&(p(y),p(_),d(3*y,15,i,P,t,k,T,I)),64&R&&(p(b),p(_),h(3*b,18,i,e,L,k,C,I)),128&R&&(p(m),p(b),d(3*m,21,i,e,t,k,M,C)),256&R&&(p(r),p(m),f(3*r,24,i,e,t,n,x,M)),512&R&&(p(a),p(y),f(3*a,27,i,P,t,n,S,T)),1024&R&&(p(v),p(_),f(3*v,30,i,P,L,n,A,I)),2048&R&&(p(u),p(b),f(3*u,33,i,e,L,n,E,C)),w<<=4;let D,O,N,U=0,F=0;for(;-1!=er[w+F];)D=w+F,O=D+1,N=D+2,g(l,c,3*er[D],3*er[O],3*er[N],o),F+=3,U++;return U}function g(e,t,n,r,i,o){const a=3*s.count;if(s.positionArray[a+0]=e[n],s.positionArray[a+1]=e[n+1],s.positionArray[a+2]=e[n+2],s.positionArray[a+3]=e[r],s.positionArray[a+4]=e[r+1],s.positionArray[a+5]=e[r+2],s.positionArray[a+6]=e[i],s.positionArray[a+7]=e[i+1],s.positionArray[a+8]=e[i+2],s.enableNormals&&(s.normalArray[a+0]=t[n],s.normalArray[a+1]=t[n+1],s.normalArray[a+2]=t[n+2],s.normalArray[a+3]=t[r],s.normalArray[a+4]=t[r+1],s.normalArray[a+5]=t[r+2],s.normalArray[a+6]=t[i],s.normalArray[a+7]=t[i+1],s.normalArray[a+8]=t[i+2]),s.enableUvs){const t=2*s.count;s.uvArray[t+0]=e[n],s.uvArray[t+1]=e[n+2],s.uvArray[t+2]=e[r],s.uvArray[t+3]=e[r+2],s.uvArray[t+4]=e[i],s.uvArray[t+5]=e[i+2]}s.enableColors&&(s.colorArray[a+0]=e[n],s.colorArray[a+1]=e[n+1],s.colorArray[a+2]=e[n+2],s.colorArray[a+3]=e[r],s.colorArray[a+4]=e[r+1],s.colorArray[a+5]=e[r+2],s.colorArray[a+6]=e[i],s.colorArray[a+7]=e[i+1],s.colorArray[a+8]=e[i+2]),s.count+=3,s.count>=s.maxCount-3&&(s.hasPositions=!0,s.enableNormals&&(s.hasNormals=!0),s.enableUvs&&(s.hasUvs=!0),s.enableColors&&(s.hasColors=!0),o(s))}this.enableUvs=!!n,this.enableColors=!!r,this.enableNormals=!!o,this.dirty=!0,this.resolution=[0,0,0],this.stepSizeX=0,this.stepSizeY=0,this.stepSizeZ=0,this.sizeX=0,this.sizeY=0,this.sizeZ=0,this.sizeXY=0,this.sizeXYZ=0,this.size3=0,this.halfsizeX=0,this.halfsizeY=0,this.halfsizeZ=0,this.deltaX=0,this.deltaY=0,this.deltaZ=0,this.yd=0,this.zd=0,this.field=new Uint8Array,this.normal_cache=new Float32Array,this.positionArray=new Float32Array,this.normalArray=new Float32Array,this.uvArray=new Float32Array,this.colorArray=new Float32Array,this.init=function(e,t){this.dirty=!0,this.resolution=e,this.isovalue=.05,this.stepSizeX=1,this.stepSizeY=1,this.stepSizeZ=1,this.sizeX=e[0],this.sizeY=e[1],this.sizeZ=e[2],this.sizeXY=this.sizeX*this.sizeY,this.sizeXYZ=this.sizeXY*this.sizeZ,this.size3=this.sizeXYZ,this.halfsizeX=this.sizeX/2,this.halfsizeY=this.sizeY/2,this.halfsizeZ=this.sizeZ/2,this.deltaX=2/this.sizeX,this.deltaY=2/this.sizeY,this.deltaZ=2/this.sizeZ,this.yd=this.sizeX,this.zd=this.sizeXY,this.field=t||new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.maxCount=16384,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=new Float32Array(3*this.maxCount),this.enableNormals&&(this.normalArray=new Float32Array(3*this.maxCount)),this.enableUvs&&(this.uvArray=new Float32Array(2*this.maxCount)),this.enableColors&&(this.colorArray=new Float32Array(3*this.maxCount))},this.begin=function(){this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasUvs=!1,this.hasColors=!1},this.end=function(e){if(0!==this.count){for(let e=3*this.count;e<this.positionArray.length;e++)this.positionArray[e]=0;this.hasPositions=!0,this.enableNormals&&(this.hasNormals=!0),this.enableUvs&&(this.hasUvs=!0),this.enableColors&&(this.hasColors=!0),e(this)}},this.reset=function(){var e;for(e=0;e<this.size3;e++)this.normal_cache[3*e]=0,this.field[e]=0},this.render=function(e){if(!this.dirty)return void this.end(e);this.begin();const t=this.sizeX-2,n=this.sizeY-2,r=this.sizeZ-2;for(let i=1;i<r;i+=this.stepSizeZ){const r=this.sizeXY*i,o=(i-this.halfsizeZ)/this.halfsizeZ;for(let i=1;i<n;i+=this.stepSizeY){const n=r+this.sizeX*i,a=(i-this.halfsizeY)/this.halfsizeY;for(let r=1;r<t;r+=this.stepSizeX)m((r-this.halfsizeX)/this.halfsizeX,a,o,n+r,this.isovalue,e)}}this.end(e)},this.generateGeometry=function(){if(!this.dirty)return;let e=0;const t=[];return this.render((function(n){const r=new i.LoY;r.setAttribute("position",new i.THS(n.positionArray.slice(),3)),n.enableNormals&&r.setAttribute("normal",new i.THS(n.normalArray.slice(),3));const o=new Uint16Array(n.count),a=n.count/3;for(let e=0;e<a;e++){const t=3*e,n=t+1,r=t+2;o[3*e+0]=t,o[3*e+1]=n,o[3*e+2]=r}r.setIndex(new i.THS(o,1)),t.push(r),e+=a,n.count=0})),this.dirty=!1,t},this.init(e,a)}}const Jn=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),er=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),tr=Qn,nr=.95;class rr{constructor(e){this.volume=e,this.meshRoot=new i.B69,this.meshRoot.name="Mesh Surface Group",this.meshPivot=new i.YJl,this.meshPivot.name="MeshContainerNode",this.meshPivot.add(this.meshRoot),this.meshrep=[],this.channelColors=[],this.channelOpacities=[],this.scale=new i.Pq0(1,1,1),this.bounds={bmin:new i.Pq0(-.5,-.5,-.5),bmax:new i.Pq0(.5,.5,.5)}}cleanup(){for(let e=0;e<this.volume.imageInfo.numChannels;++e)this.destroyIsosurface(e)}setVisible(e){this.meshRoot.visible=e}doRender(){}get3dObject(){return this.meshPivot}setScale(e,t=new i.Pq0(0,0,0)){this.scale=e,this.meshRoot.scale.copy(e).multiplyScalar(.5),this.meshRoot.position.copy(t)}setFlipAxes(e,t,n){this.meshRoot.scale.copy(new i.Pq0(.5*this.scale.x*e,.5*this.scale.y*t,.5*this.scale.z*n))}setTranslation(e){this.meshPivot.position.copy(e)}setRotation(e){this.meshPivot.rotation.copy(e),this.updateClipFromBounds()}setResolution(e,t){}setOrthoThickness(e){}setAxisClip(e,t,n,r){this.bounds.bmax[e]=n,this.bounds.bmin[e]=t,this.updateClipFromBounds()}updateMeshColors(e){this.channelColors=e;for(let t=0;t<this.volume.imageInfo.numChannels;++t){const n=this.meshrep[t];if(n){const r=e[t],o=r[0]<<16|r[1]<<8|r[2];n.traverse((function(e){e instanceof i.eaF&&(e.material.color=new i.Q1f(o))}))}}}createMaterialForChannel(e,t,n){const r=e[0]<<16|e[1]<<8|e[2];return new i.tXL({color:new i.Q1f(r),shininess:1e3,specular:new i.Q1f(65793),opacity:t,transparent:t<nr,side:i.$EB})}createMeshForChannel(e,t,n,r,o){const a=this.generateIsosurfaceGeometry(e,n),s=this.createMaterialForChannel(t,r,o),l=new i.YJl;l.name="Channel"+e,l.userData={isovalue:n};for(let e=0;e<a.length;++e){const t=new i.eaF(a[e],s);t.layers.set(1),l.add(t)}return l}updateIsovalue(e,t){const n=this.meshrep[e];if(!n)return;if(n.userData.isovalue===t)return;const r=this.channelOpacities[e],i=this.channelColors[e];this.destroyIsosurface(e);const o=this.createMeshForChannel(e,i,t,r,!1);this.meshrep[e]=o,this.meshRoot.add(o)}getIsovalue(e){const t=this.meshrep[e];return t?.userData.isovalue}getOpacity(e){const t=this.meshrep[e];let n;return t?.traverse((e=>{e instanceof i.eaF&&(n=e.material.opacity)})),n}updateClipRegion(e,t,n,r,o,a){this.bounds={bmin:new i.Pq0(e-.5,n-.5,o-.5),bmax:new i.Pq0(t-.5,r-.5,a-.5)},this.updateClipFromBounds()}updateClipFromBounds(){const e=this.bounds.bmin.x,t=this.bounds.bmin.y,n=this.bounds.bmin.z,r=this.bounds.bmax.x,o=this.bounds.bmax.y,a=this.bounds.bmax.z,s=this.meshPivot.rotation;for(let l=0;l<this.meshrep.length;++l){const c=this.meshrep[l];if(!c)continue;const u=[];e>-.5&&u.push(new i.Zcv(new i.Pq0(1,0,0).applyEuler(s),this.meshRoot.position.x+-e*this.scale.x)),t>-.5&&u.push(new i.Zcv(new i.Pq0(0,1,0).applyEuler(s),this.meshRoot.position.y+-t*this.scale.y)),n>-.5&&u.push(new i.Zcv(new i.Pq0(0,0,1).applyEuler(s),this.meshRoot.position.z+-n*this.scale.z)),r<.5&&u.push(new i.Zcv(new i.Pq0(-1,0,0).applyEuler(s),this.meshRoot.position.x+r*this.scale.x)),o<.5&&u.push(new i.Zcv(new i.Pq0(0,-1,0).applyEuler(s),this.meshRoot.position.y+o*this.scale.y)),a<.5&&u.push(new i.Zcv(new i.Pq0(0,0,-1).applyEuler(s),this.meshRoot.position.z+a*this.scale.z)),c.traverse((function(e){e instanceof i.eaF&&(e.material.clippingPlanes=u)}))}}updateOpacity(e,t){this.channelOpacities[e]=t;const n=this.meshrep[e];n&&n.traverse((function(e){e instanceof i.eaF&&(e.material.opacity=t,e.material.transparent=t<nr)}))}hasIsosurface(e){return!!this.meshrep[e]}createIsosurface(e,t,n=127,r=1,i=r<nr){if(!this.meshrep[e]){const o=this.createMeshForChannel(e,t,n,r,i);this.meshrep[e]=o,this.channelOpacities[e]=r,this.channelColors[e]=t,this.meshRoot.add(o)}}destroyIsosurface(e){const t=this.meshrep[e];t&&(this.meshRoot.remove(t),t.traverse((function(e){e instanceof i.eaF&&(e.material.dispose(),e.geometry.dispose())})),this.meshrep[e]=null)}saveChannelIsosurface(e,t,n){const r=this.meshrep[e];if(r)if("STL"===t)this.exportSTL(r,n+"_"+this.volume.channelNames[e]);else if("GLTF"===t){const t=[];for(let n=0;n<this.meshrep.length;++n){const r=this.meshrep[n];r&&(t[n]=r.visible,r.visible=n===e)}this.exportGLTF(this.meshRoot,n+"_"+this.volume.channelNames[e]);for(let e=0;e<this.meshrep.length;++e){const n=this.meshrep[e];n&&(n.visible=t[e])}}}exportSTL(e,t){const n=(new bn).parse(e,{binary:!0});Zn.saveBinary(n.buffer,t+".stl")}exportGLTF(e,t){(new wn).parse(e,(function(e){if(e instanceof ArrayBuffer)Zn.saveArrayBuffer(e,t+".glb");else{const n=JSON.stringify(e,null,2);Zn.saveString(n,t+".gltf")}}),(function(e){console.error(e)}),{trs:!1,onlyVisible:!0,truncateDrawRange:!0,binary:!0,forceIndices:!1,forcePowerOfTwoTextures:!0})}generateIsosurfaceGeometry(e,t){if(!this.volume)return[];const n=this.volume.channels[e].volumeData,r=this.volume.imageInfo.subregionSize.toArray();{const e=new tr(r,new i.imn,!1,!1,!0,n);return e.position.copy(this.meshRoot.position),e.scale.set(.5*this.scale.x,.5*this.scale.y,.5*this.scale.z),e.isovalue=t,e.generateGeometry()||[]}}}class ir{constructor(e,t){this.width=e,this.height=t,this.maskTexture=new i.GYF(new Uint8ClampedArray(this.width*this.height).fill(255),this.width,this.height,i.VT0,i.OUM),this.maskTexture.generateMipmaps=!1,this.maskTexture.magFilter=i.k6q,this.maskTexture.minFilter=i.k6q,this.maskTexture.wrapS=i.ghU,this.maskTexture.wrapT=i.ghU,this.maskTexture.unpackAlignment=1,this.fuseRequested=null,this.channelsDataToFuse=[],this.fuseScene=new i.Z58,this.quadCamera=new i.qUd(-1,1,1,-1,0,1),this.fuseRenderTarget=new i.nWS(this.width,this.height,{minFilter:i.k6q,magFilter:i.k6q,format:i.GWd,type:i.OUM,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,wrapS:i.ghU,wrapT:i.ghU}),this.fuseMaterialProps={vertexShader:fn,depthTest:!1,depthWrite:!1,blending:i.bCz,blendSrc:i.qad,blendDst:i.qad,blendEquation:i.$ei},this.fuseMaterialF=this.setupFuseMaterial("precision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\n\n// the lut texture is a 256x1 rgba texture for each channel\nuniform sampler2D lutSampler;\n\nuniform vec2 lutMinMax;\n\n// src texture is the raw volume intensity data\nuniform sampler2D srcTexture;\n\nvoid main()\n{\n    ivec2 vUv = ivec2(int(gl_FragCoord.x), int(gl_FragCoord.y));\n\n    // load from channel\n    float intensity = texelFetch(srcTexture, vUv, 0).r;\n\n    float ilookup = float(float(intensity) - lutMinMax.x) / float(lutMinMax.y - lutMinMax.x);\n    // apply lut to intensity:\n    vec4 pix = texture(lutSampler, vec2(ilookup, 0.5));\n    gl_FragColor = vec4(pix.xyz*pix.w, pix.w);\n}\n"),this.fuseMaterialUI=this.setupFuseMaterial("precision highp float;\nprecision highp int;\nprecision highp usampler2D;\nprecision highp sampler3D;\n\n// the lut texture is a 256x1 rgba texture for each channel\nuniform sampler2D lutSampler;\n\nuniform vec2 lutMinMax;\nuniform uint highlightedId;\n\n// src texture is the raw volume intensity data\nuniform usampler2D srcTexture;\n\nvoid main() {\n    ivec2 vUv = ivec2(int(gl_FragCoord.x), int(gl_FragCoord.y));\n    uint intensity = texelFetch(srcTexture, vUv, 0).r;\n    float ilookup = float(float(intensity) - lutMinMax.x) / float(lutMinMax.y - lutMinMax.x);\n    // apply lut to intensity:\n    vec4 pix = texture(lutSampler, vec2(ilookup, 0.5));\n    gl_FragColor = vec4(pix.xyz * pix.w, pix.w);\n}\n"),this.fuseMaterialI=this.setupFuseMaterial("precision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\n\n// the lut texture is a 256x1 rgba texture for each channel\nuniform sampler2D lutSampler;\n\nuniform vec2 lutMinMax;\n\n// src texture is the raw volume intensity data\nuniform isampler2D srcTexture;\n\nvoid main()\n{\n    ivec2 vUv = ivec2(int(gl_FragCoord.x), int(gl_FragCoord.y));\n    int intensity = texelFetch(srcTexture, vUv, 0).r;\n    float ilookup = float(float(intensity) - lutMinMax.x) / float(lutMinMax.y - lutMinMax.x);\n    // apply lut to intensity:\n    vec4 pix = texture(lutSampler, vec2(ilookup, 0.5));\n    gl_FragColor = vec4(pix.xyz*pix.w, pix.w);\n}\n"),this.fuseMaterialColorizeUI=this.setupFuseColorizeMaterial("precision highp float;\nprecision highp int;\nprecision highp usampler2D;\nprecision highp sampler3D;\n\nuniform sampler2D featureData;\n/** Min and max feature values that define the endpoints of the color map. Values\n * outside the range will be clamped to the nearest endpoint.\n */\nuniform float featureColorRampMin;\nuniform float featureColorRampMax;\nuniform sampler2D colorRamp;\nuniform usampler2D inRangeIds;\nuniform usampler2D outlierData;\n\n// TODO: Rename to `localId` for consistency\n/**\n * LUT mapping from the segmentation ID (raw pixel value) to the\n * global ID (index in data buffers like `featureData` and `outlierData`).\n * \n * For a given segmentation ID `segId`, the global ID is given by:\n * `segIdToGlobalId[segId - segIdOffset] - 1`.\n*/\nuniform usampler2D segIdToGlobalId;\nuniform uint segIdOffset;\n\nuniform vec3 outlineColor;\n\n/** MUST be synchronized with the DrawMode enum in ColorizeCanvas! */\nconst uint DRAW_MODE_HIDE = 0u;\nconst uint DRAW_MODE_COLOR = 1u;\nconst uint BACKGROUND_ID = 0u;\nconst uint MISSING_DATA_ID = 0xFFFFFFFFu;\n\nuniform vec3 outlierColor;\nuniform uint outlierDrawMode;\nuniform vec3 outOfRangeColor;\nuniform uint outOfRangeDrawMode;\n\nuniform uint highlightedId;\n\nuniform bool useRepeatingCategoricalColors;\n\n// src texture is the raw volume intensity data\nuniform usampler2D srcTexture;\n\nvec4 getFloatFromTex(sampler2D tex, int index) {\n  int width = textureSize(tex, 0).x;\n  ivec2 featurePos = ivec2(index % width, index / width);\n  return texelFetch(tex, featurePos, 0);\n}\nuvec4 getUintFromTex(usampler2D tex, int index) {\n  int width = textureSize(tex, 0).x;\n  ivec2 featurePos = ivec2(index % width, index / width);\n  return texelFetch(tex, featurePos, 0);\n}\nuint getId(ivec2 uv) {\n  uint rawId = texelFetch(srcTexture, uv, 0).r;\n  if (rawId == 0u) {\n    return BACKGROUND_ID;\n  }\n  uvec4 c = getUintFromTex(segIdToGlobalId, int(rawId - segIdOffset));\n  // Note: IDs are offset by `1` to reserve `0` for segmentations that don't\n  // have associated data. `1` MUST be subtracted from the ID when accessing\n  // data buffers.\n  uint globalId = c.r;\n  if (globalId == 0u) {\n    return MISSING_DATA_ID;\n  }\n  return globalId;\n}\n\nvec4 getColorRamp(float val) {\n  float width = float(textureSize(colorRamp, 0).x);\n  float range = (width - 1.0) / width;\n  float adjustedVal = (0.5 / width) + (val * range);\n  return texture(colorRamp, vec2(adjustedVal, 0.5));\n}\n\nvec4 getCategoricalColor(float featureValue) {\n  float width = float(textureSize(colorRamp, 0).x);\n  float modValue = mod(featureValue, width);\n  // The categorical texture uses no interpolation, so when sampling, `modValue`\n  // is rounded to the nearest integer.\n  return getColorRamp(modValue / (width - 1.0));\n}\n\nvec4 getColorFromDrawMode(uint drawMode, vec3 defaultColor) {\n  const uint DRAW_MODE_HIDE = 0u;\n  vec3 backgroundColor = vec3(0.0, 0.0, 0.0);\n  if (drawMode == DRAW_MODE_HIDE) {\n    return vec4(backgroundColor, 0.0);\n  } else {\n    return vec4(defaultColor, 1.0);\n  }\n}\n\nfloat getFeatureVal(uint id) {\n  // Data buffer starts at 0, non-background segmentation IDs start at 1\n  return getFloatFromTex(featureData, int(id) - 1).r;\n}\nuint getOutlierVal(uint id) {\n  // Data buffer starts at 0, non-background segmentation IDs start at 1\n  return getUintFromTex(outlierData, int(id) - 1).r;\n}\nbool getIsInRange(uint id) {\n  return getUintFromTex(inRangeIds, int(id) - 1).r == 1u;\n}\nbool getIsOutlier(float featureVal, uint outlierVal) {\n  return isinf(featureVal) || outlierVal != 0u;\n}\n\nvec4 getObjectColor(ivec2 sUv, float opacity) {\n  // Get the segmentation id at this pixel\n  uint id = getId(sUv);\n\n  // A segmentation id of 0 represents background\n  if (id == BACKGROUND_ID) {\n    return vec4(0, 0, 0, 0);\n  }\n\n  // color the highlighted object. Note, `highlightedId` is a 0-based index\n  // (global ID w/o offset), while `id` is a 1-based index.\n  // if (id - 1u == highlightedId) {\n  //   return vec4(outlineColor, 1.0);\n  // }\n\n  float featureVal = getFeatureVal(id);\n  uint outlierVal = getOutlierVal(id);\n  float normFeatureVal = (featureVal - featureColorRampMin) / (featureColorRampMax - featureColorRampMin);\n\n  // Use the selected draw mode to handle out of range and outlier values;\n  // otherwise color with the color ramp as usual.\n  bool isInRange = getIsInRange(id);\n  bool isOutlier = getIsOutlier(featureVal, outlierVal);\n  bool isMissingData = (id == MISSING_DATA_ID);\n\n  // Features outside the filtered/thresholded range will all be treated the same (use `outOfRangeDrawColor`).\n  // Features inside the range can either be outliers or standard values, and are colored accordingly.\n  vec4 color;\n  if (isMissingData) { \n    // TODO: Add color controls for missing data\n    color = getColorFromDrawMode(outlierDrawMode, outlierColor);\n  } else if (isInRange) {\n    if (isOutlier) {\n      color = getColorFromDrawMode(outlierDrawMode, outlierColor);\n    } else if (useRepeatingCategoricalColors) {\n      color = getCategoricalColor(featureVal);\n    } else {\n      color = getColorRamp(normFeatureVal);\n    }\n  } else {\n    color = getColorFromDrawMode(outOfRangeDrawMode, outOfRangeColor);\n  }\n  color.a *= opacity;\n  return color;\n}\n\nvoid main() {\n  ivec2 vUv = ivec2(int(gl_FragCoord.x), int(gl_FragCoord.y));\n  gl_FragColor = getObjectColor(vUv, 1.0);\n}\n"),this.fuseMaterialF.needsUpdate=!0,this.fuseMaterialUI.needsUpdate=!0,this.fuseMaterialI.needsUpdate=!0,this.fuseGeometry=new i.bdM(2,2)}setupFuseMaterial(e){return new i.BKk({uniforms:{highlightedId:{value:-1},lutSampler:{value:null},lutMinMax:{value:new i.I9Y(0,255)},srcTexture:{value:null}},fragmentShader:e,...this.fuseMaterialProps})}setupFuseColorizeMaterial(e){return new i.BKk({uniforms:{highlightedId:{value:-1},featureData:{value:null},outlierData:{value:null},inRangeIds:{value:null},srcTexture:{value:null},featureColorRampMin:{value:0},featureColorRampMax:{value:1},colorRamp:{value:null},useRepeatingCategoricalColors:{value:!1},outlineColor:{value:new i.Q1f(16777215)},outlierColor:{value:new i.Q1f(4473924)},outOfRangeColor:{value:new i.Q1f(4473924)},outlierDrawMode:{value:0},outOfRangeDrawMode:{value:0},hideOutOfRange:{value:!1},segIdToGlobalId:{value:new i.GYF},segIdOffset:{value:0}},fragmentShader:e,...this.fuseMaterialProps})}getFusedTexture(){return this.fuseRenderTarget.texture}cleanup(){this.fuseScene.clear(),this.maskTexture.dispose()}getShader(e,t){switch(e){case"float32":return this.fuseMaterialF;case"uint8":case"uint16":case"uint32":return t?this.fuseMaterialColorizeUI:this.fuseMaterialUI;case"int8":case"int16":case"int32":return this.fuseMaterialI;default:throw new Error("Unsupported data type for fuse shader")}}fuse(e,t){let n=!1;for(let r=0;r<e.length;++r){const i=e[r],o=i.chIndex;t[o].loaded&&(i.lut=t[o].combineLuts(i.rgbColor,i.lut),n=!0)}if(!n)return this.channelsDataToFuse=[],void(this.fuseRequested=[]);this.fuseRequested=e,this.channelsDataToFuse=t}gpuFuse(e){const t=this.fuseRequested,n=this.channelsDataToFuse;if(t){this.fuseScene.traverse((e=>{e instanceof i.eaF&&e.material.dispose()})),this.fuseScene.clear();for(let e=0;e<t.length;++e)if(t[e].rgbColor){const r=t[e].chIndex;if(!n[r].loaded)continue;const o=void 0!==t[e].feature,a=this.getShader(n[r].dtype,o).clone();a.uniforms.srcTexture.value=n[r].dataTexture,a.uniforms.highlightedId.value=null==t[e].selectedID?-1:t[e].selectedID;const s=t[e].feature;if(o&&s){a.uniforms.featureData.value=s.idsToFeatureValue,a.uniforms.outlierData.value=s.outlierData,a.uniforms.inRangeIds.value=s.inRangeIds,a.uniforms.featureColorRampMin.value=s.featureMin,a.uniforms.featureColorRampMax.value=s.featureMax,a.uniforms.colorRamp.value=s.featureValueToColor,a.uniforms.useRepeatingCategoricalColors.value=s.useRepeatingColor,a.uniforms.outlineColor.value=s.outlineColor,a.uniforms.outlierColor.value=s.outlierColor,a.uniforms.outOfRangeColor.value=s.outOfRangeColor,a.uniforms.outlierDrawMode.value=s.outlierDrawMode,a.uniforms.outOfRangeDrawMode.value=s.outOfRangeDrawMode,a.uniforms.hideOutOfRange.value=s.hideOutOfRange;const e=n[r].frame;let t=s.frameToGlobalIdLookup.get(e);t||(console.warn(`FusedChannelData.gpuFuse: No global ID lookup info for frame ${e} in channel ${r}. A default lookup will be used, which may cause visual artifacts.`),t={texture:new i.GYF(Uint32Array[0]),minSegId:1}),a.uniforms.segIdToGlobalId.value=t.texture,a.uniforms.segIdOffset.value=t.minSegId}else a.uniforms.lutMinMax.value=new i.I9Y(n[r].rawMin,n[r].rawMax),a.uniforms.lutSampler.value=n[r].lutTexture;this.fuseScene.add(new i.eaF(this.fuseGeometry,a))}if(this.fuseScene.children.length>0){e.setRenderTarget(this.fuseRenderTarget),e.autoClearColor=!0;const t=new i.Q1f;e.getClearColor(t);const n=e.getClearAlpha();e.setClearColor(0,0),e.render(this.fuseScene,this.quadCamera),e.setRenderTarget(null),e.setClearColor(t,n)}this.fuseRequested=null}}setChannelAsMask(e,t){if(!t||!t.loaded)return!1;const n=new Uint8ClampedArray(t.imgData.data.length);for(let e=0;e<t.imgData.data.length;e++)n[e]=t.imgData.data[e]>0?255:0;const r={data:n,width:this.width,height:this.height,colorSpace:"srgb"};return this.maskTexture.image=r,this.maskTexture.needsUpdate=!0,!0}}const or=new i.Q1f(16776960);class ar{constructor(e,t=new en(e)){this.volume=e,this.uniforms={iResolution:{type:"v2",value:new i.I9Y(100,100)},CLIP_NEAR:{type:"f",value:.1},CLIP_FAR:{type:"f",value:20},maskAlpha:{type:"f",value:1},BRIGHTNESS:{type:"f",value:0},DENSITY:{type:"f",value:1},GAMMA_MIN:{type:"f",value:0},GAMMA_MAX:{type:"f",value:1},GAMMA_SCALE:{type:"f",value:1},BREAK_STEPS:{type:"i",value:128},ATLAS_DIMS:{type:"v2",value:new i.I9Y(6,6)},SLICES:{type:"f",value:50},isOrtho:{type:"f",value:0},orthoThickness:{type:"f",value:1},orthoScale:{type:"f",value:.5},AABB_CLIP_MIN:{type:"v3",value:new i.Pq0(-.5,-.5,-.5)},AABB_CLIP_MAX:{type:"v3",value:new i.Pq0(.5,.5,.5)},inverseModelViewMatrix:{type:"m4",value:new i.kn4},inverseProjMatrix:{type:"m4",value:new i.kn4},textureAtlas:{type:"t",value:new i.gPd},textureAtlasMask:{type:"t",value:new i.gPd},textureDepth:{type:"t",value:new i.gPd},usingPositionTexture:{type:"i",value:0},maxProject:{type:"i",value:0},interpolationEnabled:{type:"b",value:!0},flipVolume:{type:"v3",value:new i.Pq0(1,1,1)},volumeScale:{type:"v3",value:new i.Pq0(1,1,1)},textureRes:{type:"v2",value:new i.I9Y(1,1)}},[this.geometry,this.geometryMesh]=this.createGeometry(this.uniforms),this.boxHelper=new i.BND(new i.NRn(new i.Pq0(-.5,-.5,-.5),new i.Pq0(.5,.5,.5)),or),this.boxHelper.updateMatrixWorld(),this.boxHelper.visible=!1,this.tickMarksMesh=this.createTickMarks(),this.tickMarksMesh.updateMatrixWorld(),this.tickMarksMesh.visible=!1,this.geometryTransformNode=new i.YJl,this.geometryTransformNode.name="VolumeContainerNode",this.geometryTransformNode.add(this.boxHelper,this.tickMarksMesh,this.geometryMesh),this.emptyPositionTex=new i.GYF(new Uint8Array(Array(16).fill(0)),2,2),this.settings=t,this.updateSettings(t,Qt.ALL),this.updateVolumeDimensions()}updateVolumeDimensions(){const{normPhysicalSize:e,normRegionSize:t}=this.volume;this.geometryMesh.position.copy(this.volume.getContentCenter().multiply(this.settings.scale));const n=e.clone().multiply(this.settings.scale);this.geometryMesh.scale.copy(n).multiply(t),this.setUniform("volumeScale",e),this.boxHelper.box.set(n.clone().multiplyScalar(-.5),n.clone().multiplyScalar(.5)),this.tickMarksMesh.scale.copy(n),this.settings&&this.updateSettings(this.settings,Qt.ROI);const{atlasTileDims:r,subregionSize:o}=this.volume.imageInfo,a=new i.I9Y(o.x,o.y).multiply(r);this.setUniform("ATLAS_DIMS",r),this.setUniform("textureRes",a),this.setUniform("SLICES",this.volume.imageInfo.volumeSize.z),this.channelData&&this.channelData.width===a.x&&this.channelData.height===a.y||(this.channelData?.cleanup(),this.channelData=new ir(a.x,a.y))}viewpointMoved(){}updateSettings(e,t){if(void 0===t&&(t=Qt.ALL),this.settings=e,t&Qt.VIEW){this.geometryMesh.visible=this.settings.visible,this.setUniform("orthoScale",this.settings.orthoScale),this.setUniform("isOrtho",this.settings.isOrtho?1:0);const e=this.settings.viewAxis;if(this.settings.isOrtho&&e){const t=this.settings.bounds.bmax[e]-this.settings.bounds.bmin[e];this.setUniform("orthoThickness",t)}else this.setUniform("orthoThickness",1)}if((t&Qt.VIEW||t&Qt.BOUNDING_BOX)&&(this.tickMarksMesh.visible=this.settings.showBoundingBox&&!this.settings.isOrtho,this.setUniform("maxProject",this.settings.maxProjectMode?1:0)),t&Qt.BOUNDING_BOX){this.boxHelper.visible=this.settings.showBoundingBox;const e=this.settings.boundingBoxColor,t=new i.Q1f(e[0],e[1],e[2]);this.boxHelper.material.color=t,this.tickMarksMesh.material.color=t}if(t&Qt.TRANSFORM&&(this.geometryTransformNode.position.copy(this.settings.translation),this.geometryTransformNode.rotation.copy(this.settings.rotation),this.updateVolumeDimensions(),this.setUniform("flipVolume",this.settings.flipAxes)),t&Qt.MATERIAL&&this.setUniform("DENSITY",this.settings.density),t&Qt.CAMERA&&(this.setUniform("BRIGHTNESS",2*this.settings.brightness),this.setUniform("GAMMA_MIN",this.settings.gammaMin),this.setUniform("GAMMA_MAX",this.settings.gammaMax),this.setUniform("GAMMA_SCALE",this.settings.gammaLevel)),t&Qt.ROI){const e=this.settings.bounds,{normRegionSize:t,normRegionOffset:n}=this.volume,r=t.clone().divideScalar(2).add(n).subScalar(.5),i=e.bmin.clone().sub(r).divide(t).clampScalar(-.5,.5),o=e.bmax.clone().sub(r).divide(t).clampScalar(-.5,.5);this.setUniform("AABB_CLIP_MIN",i),this.setUniform("AABB_CLIP_MAX",o)}t&Qt.SAMPLING&&(this.setUniform("interpolationEnabled",this.settings.useInterpolation),this.setUniform("iResolution",this.settings.resolution)),t&Qt.MASK_ALPHA&&this.setUniform("maskAlpha",this.settings.maskChannelIndex<0?1:this.settings.maskAlpha),t&Qt.MASK_DATA&&this.channelData.setChannelAsMask(this.settings.maskChannelIndex,this.volume.getChannel(this.settings.maskChannelIndex))}createGeometry(e){const t=new i.iNn(1,1,1),n=new i.BKk({uniforms:e,vertexShader:"// switch on high precision floats\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec3 pObj;\n\nvoid main() {\n  pObj = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#define M_PI 3.14159265358979323846\n\nuniform vec2 iResolution;\nuniform vec2 textureRes;\nuniform float GAMMA_MIN;\nuniform float GAMMA_MAX;\nuniform float GAMMA_SCALE;\nuniform float BRIGHTNESS;\nuniform float DENSITY;\nuniform float maskAlpha;\nuniform vec2 ATLAS_DIMS;\nuniform vec3 AABB_CLIP_MIN;\nuniform float CLIP_NEAR;\nuniform vec3 AABB_CLIP_MAX;\nuniform float CLIP_FAR;\nuniform sampler2D textureAtlas;\nuniform sampler2D textureAtlasMask;\nuniform sampler2D textureDepth;\nuniform int usingPositionTexture;\nuniform int BREAK_STEPS;\nuniform float SLICES;\nuniform float isOrtho;\nuniform float orthoThickness;\nuniform float orthoScale;\nuniform int maxProject;\nuniform bool interpolationEnabled;\nuniform vec3 flipVolume;\nuniform vec3 volumeScale;\n\n// view space to axis-aligned volume box\nuniform mat4 inverseModelViewMatrix;\nuniform mat4 inverseProjMatrix;\n\nvarying vec3 pObj;\n\nfloat powf(float a, float b) {\n  return pow(a,b);\n}\n\nfloat rand(vec2 co) {\n  float threadId = gl_FragCoord.x/(gl_FragCoord.y + 1.0);\n  float bigVal = threadId*1299721.0/911.0;\n  vec2 smallVal = vec2(threadId*7927.0/577.0, threadId*104743.0/1039.0);\n  return fract(sin(dot(co, smallVal)) * bigVal);\n}\n\nvec4 luma2Alpha(vec4 color, float vmin, float vmax, float C) {\n  float x = dot(color.rgb, vec3(0.2125, 0.7154, 0.0721));\n  // float x = max(color[2], max(color[0],color[1]));\n  float xi = (x-vmin)/(vmax-vmin);\n  xi = clamp(xi,0.0,1.0);\n  float y = pow(xi,C);\n  y = clamp(y,0.0,1.0);\n  color[3] = y;\n  return color;\n}\n\nvec2 offsetFrontBack(float t) {\n  int a = int(t);\n  int ax = int(ATLAS_DIMS.x);\n  vec2 os = vec2(float(a - (a / ax) * ax), float(a / ax)) / ATLAS_DIMS;\n  return clamp(os, vec2(0.0), vec2(1.0) - vec2(1.0) / ATLAS_DIMS);\n}\n\nvec4 sampleAtlasLinear(sampler2D tex, vec4 pos) {\n  float bounds = float(pos[0] >= 0.0 && pos[0] <= 1.0 &&\n                       pos[1] >= 0.0 && pos[1] <= 1.0 &&\n                       pos[2] >= 0.0 && pos[2] <= 1.0 );\n  float nSlices = float(SLICES);\n  // get location within atlas tile\n  // TODO: get loc1 which follows ray to next slice along ray direction\n  // when flipvolume = 1:  pos\n  // when flipvolume = -1: 1-pos\n  vec2 loc0 = ((pos.xy - 0.5) * flipVolume.xy + 0.5) / ATLAS_DIMS;\n\n  // loc ranges from 0 to 1/ATLAS_DIMS\n  // shrink loc0 to within one half edge texel - so as not to sample across edges of tiles.\n  loc0 = vec2(0.5) / textureRes + loc0 * (vec2(1.0) - ATLAS_DIMS / textureRes);\n  \n  // interpolate between two slices\n  float z = (pos.z)*(nSlices-1.0);\n  float z0 = floor(z);\n  float t = z-z0; //mod(z, 1.0);\n  float z1 = min(z0+1.0, nSlices-1.0);\n\n  // flipped:\n  if (flipVolume.z == -1.0) {\n    z0 = nSlices - z0 - 1.0;\n    z1 = nSlices - z1 - 1.0;\n    t = 1.0 - t;\n  }\n\n  // get slice offsets in texture atlas\n  vec2 o0 = offsetFrontBack(z0) + loc0;\n  vec2 o1 = offsetFrontBack(z1) + loc0;\n\n  vec4 slice0Color = texture2D(tex, o0);\n  vec4 slice1Color = texture2D(tex, o1);\n  // NOTE we could premultiply the mask in the fuse function,\n  // but that is slower to update the maskAlpha value than here in the shader.\n  // it is a memory vs perf tradeoff.  Do users really need to update the maskAlpha at realtime speed?\n  float slice0Mask = texture2D(textureAtlasMask, o0).x;\n  float slice1Mask = texture2D(textureAtlasMask, o1).x;\n  // or use max for conservative 0 or 1 masking?\n  float maskVal = mix(slice0Mask, slice1Mask, t);\n  // take mask from 0..1 to alpha..1\n  maskVal = mix(maskVal, 1.0, maskAlpha);\n  vec4 retval = mix(slice0Color, slice1Color, t);\n  // only mask the rgb, not the alpha(?)\n  retval.rgb *= maskVal;\n  return bounds*retval;\n}\n\nvec4 sampleAtlasNearest(sampler2D tex, vec4 pos) {\n  float bounds = float(pos[0] >= 0.0 && pos[0] <= 1.0 &&\n                       pos[1] >= 0.0 && pos[1] <= 1.0 &&\n                       pos[2] >= 0.0 && pos[2] <= 1.0 );\n  float nSlices = float(SLICES);\n\n  vec2 loc0 = ((pos.xy - 0.5) * flipVolume.xy + 0.5) / ATLAS_DIMS;\n\n  // No interpolation - sample just one slice at a pixel center.\n  // Ideally this would be accomplished in part by switching this texture to linear\n  //   filtering, but three makes this difficult to do through a WebGLRenderTarget.\n  loc0 = floor(loc0 * textureRes) / textureRes;\n  loc0 += vec2(0.5) / textureRes;\n\n  float z = min(floor(pos.z * nSlices), nSlices-1.0);\n  \n  if (flipVolume.z == -1.0) {\n    z = nSlices - z - 1.0;\n  }\n\n  vec2 o = offsetFrontBack(z) + loc0;\n  vec4 voxelColor = texture2D(tex, o);\n\n  // Apply mask\n  float voxelMask = texture2D(textureAtlasMask, o).x;\n  voxelMask = mix(voxelMask, 1.0, maskAlpha);\n  voxelColor.rgb *= voxelMask;\n\n  return bounds*voxelColor;\n}\n\nbool intersectBox(in vec3 r_o, in vec3 r_d, in vec3 boxMin, in vec3 boxMax,\n                  out float tnear, out float tfar) {\n  // compute intersection of ray with all six bbox planes\n  vec3 invR = vec3(1.0,1.0,1.0) / r_d;\n  vec3 tbot = invR * (boxMin - r_o);\n  vec3 ttop = invR * (boxMax - r_o);\n\n  // re-order intersections to find smallest and largest on each axis\n  vec3 tmin = min(ttop, tbot);\n  vec3 tmax = max(ttop, tbot);\n\n  // find the largest tmin and the smallest tmax\n  float largest_tmin  = max(max(tmin.x, tmin.y), tmin.z);\n  float smallest_tmax = min(min(tmax.x, tmax.y), tmax.z);\n\n  tnear = largest_tmin;\n  tfar = smallest_tmax;\n\n  // use >= here?\n  return(smallest_tmax > largest_tmin);\n}\n\nvec4 accumulate(vec4 col, float s, vec4 C) {\n  float stepScale = (1.0 - powf((1.0-col.w),s));\n  col.w = stepScale;\n  col.xyz *= col.w;\n  col = clamp(col,0.0,1.0);\n\n  C = (1.0-C.w)*col + C;\n  return C;\n}\n\nvec4 integrateVolume(vec4 eye_o,vec4 eye_d,\n                     float tnear,   float tfar,\n                     float clipNear, float clipFar,\n                     sampler2D textureAtlas\n                     ) {\n  vec4 C = vec4(0.0);\n  // march along ray from front to back, accumulating color\n\n  // estimate step length\n  const int maxSteps = 512;\n  // modify the 3 components of eye_d by volume scale\n  float scaledSteps = float(BREAK_STEPS) * length((eye_d.xyz/volumeScale));\n  float csteps = clamp(float(scaledSteps), 1.0, float(maxSteps));\n  float invstep = (tfar-tnear)/csteps;\n  // special-casing the single slice to remove the random ray dither.\n  // this removes a Moire pattern visible in single slice images, which we want to view as 2D images as best we can.\n  float r = (SLICES==1.0) ? 0.0 : rand(eye_d.xy);\n  // if ortho and clipped, make step size smaller so we still get same number of steps\n  float tstep = invstep*orthoThickness;\n  float tfarsurf = r*tstep;\n  float overflow = mod((tfarsurf - tfar),tstep); // random dithering offset\n  float t = tnear + overflow;\n  t += r*tstep; // random dithering offset\n  float tdist = 0.0;\n  int numSteps = 0;\n  vec4 pos, col;\n  // We need to be able to scale the alpha contrib with number of ray steps,\n  // in order to make the final color invariant to the step size(?)\n  // use maxSteps (a constant) as the numerator... Not sure if this is sound.\n  float s = 0.5 * float(maxSteps) / csteps;\n  for (int i = 0; i < maxSteps; i++) {\n    pos = eye_o + eye_d*t;\n    // !!! assume box bounds are -0.5 .. 0.5.  pos = (pos-min)/(max-min)\n    // scaling is handled by model transform and already accounted for before we get here.\n    // AABB clip is independent of this and is only used to determine tnear and tfar.\n    pos.xyz = (pos.xyz-(-0.5))/((0.5)-(-0.5)); //0.5 * (pos + 1.0); // map position from [boxMin, boxMax] to [0, 1] coordinates\n\n    vec4 col = interpolationEnabled ? sampleAtlasLinear(textureAtlas, pos) : sampleAtlasNearest(textureAtlas, pos);\n\n    if (maxProject != 0) {\n      col.xyz *= BRIGHTNESS;\n      C = max(col, C);\n    } else {\n      col = luma2Alpha(col, GAMMA_MIN, GAMMA_MAX, GAMMA_SCALE);\n      col.xyz *= BRIGHTNESS;\n      // for practical use the density only matters for regular volume integration\n      col.w *= DENSITY;\n      C = accumulate(col, s, C);\n    }\n    t += tstep;\n    numSteps = i;\n\n    if (t > tfar || t > tnear+clipFar ) break;\n    if (C.w > 1.0 ) break;\n  }\n\n  return C;\n}\n\nvoid main() {\n  gl_FragColor = vec4(0.0);\n  vec2 vUv = gl_FragCoord.xy/iResolution.xy;\n\n  vec3 eyeRay_o, eyeRay_d;\n\n  if (isOrtho == 0.0) {\n    // for perspective rays:\n    // world space camera coordinates\n    // transform to object space\n    eyeRay_o = (inverseModelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;\n    eyeRay_d = normalize(pObj - eyeRay_o);\n  } else {\n    // for ortho rays:\n    float zDist = 2.0;\n    eyeRay_d = (inverseModelViewMatrix*vec4(0.0, 0.0, -zDist, 0.0)).xyz;\n    vec4 ray_o = vec4(2.0*vUv - 1.0, 1.0, 1.0);\n    ray_o.xy *= orthoScale;\n    ray_o.x *= iResolution.x/iResolution.y;\n    eyeRay_o = (inverseModelViewMatrix*ray_o).xyz;\n  }\n\n  // -0.5..0.5 is full box. AABB_CLIP lets us clip to a box shaped ROI to look at\n  // I am applying it here at the earliest point so that the ray march does\n  // not waste steps.  For general shaped ROI, this has to be handled more\n  // generally (obviously)\n  vec3 boxMin = AABB_CLIP_MIN;\n  vec3 boxMax = AABB_CLIP_MAX;\n\n  float tnear, tfar;\n  bool hit = intersectBox(eyeRay_o, eyeRay_d, boxMin, boxMax, tnear, tfar);\n\n  if (!hit) {\n    // return background color if ray misses the cube\n    // is this safe to do when there is other geometry / gObjects drawn?\n    gl_FragColor = vec4(0.0); //C1;//vec4(0.0);\n    return;\n  }\n\n  float clipNear = 0.0;//-(dot(eyeRay_o.xyz, eyeNorm) + dNear) / dot(eyeRay_d.xyz, eyeNorm);\n  float clipFar  = 10000.0;//-(dot(eyeRay_o.xyz,-eyeNorm) + dFar ) / dot(eyeRay_d.xyz,-eyeNorm);\n\n  // Sample the depth/position texture\n  // If this is a depth texture, the r component is a depth value. If this is a position texture,\n  // the xyz components are a view space position and w is 1.0 iff there's a mesh at this fragment.\n  vec4 meshPosSample = texture2D(textureDepth, vUv);\n  // Note: we make a different check for whether a mesh is present with depth vs. position textures.\n  // Here's the check for depth textures:\n  bool hasDepthValue = usingPositionTexture == 0 && meshPosSample.r < 1.0;\n\n  // If there's a depth-contributing mesh at this fragment, we may need to terminate the ray early\n  if (hasDepthValue || (usingPositionTexture == 1 && meshPosSample.a > 0.0)) {\n    if (hasDepthValue) {\n      // We're working with a depth value, so we need to convert back to view space position\n      // Get a projection space position from depth and uv, and unproject back to view space\n      vec4 meshProj = vec4(vUv * 2.0 - 1.0, meshPosSample.r * 2.0 - 1.0, 1.0);\n      vec4 meshView = inverseProjMatrix * meshProj;\n      meshPosSample = vec4(meshView.xyz / meshView.w, 1.0);\n    }\n    // Transform the mesh position to object space\n    vec4 meshObj = inverseModelViewMatrix * meshPosSample;\n\n    // Derive a t value for the mesh intersection\n    // NOTE: divides by 0 when `eyeRay_d.z` is 0. Could be mitigated by picking another component\n    //   to derive with when z is 0, but I found this was rare enough in practice to be acceptable.\n    float tMesh = (meshObj.z - eyeRay_o.z) / eyeRay_d.z;\n    if (tMesh < tfar) {\n      clipFar = tMesh - tnear;\n    }\n  }\n\n  vec4 C = integrateVolume(vec4(eyeRay_o,1.0), vec4(eyeRay_d,0.0),\n                          tnear,    tfar, //intersections of box\n                          clipNear, clipFar,\n                          textureAtlas);\n\n  C = clamp(C, 0.0, 1.0);\n  gl_FragColor = C;\n  return;\n}\n",transparent:!0,depthTest:!0,depthWrite:!1}),r=new i.eaF(t,n);return r.name="Volume",[t,r]}createTickMarks(){const{tickMarkPhysicalLength:e,physicalScale:t,normPhysicalSize:n}=this.volume,r=t/e,o=[],a=.025/n.y+.5,s=1/(n.x*r);for(let e=-.5;e<=.5;e+=s)o.push(e,.5,.5,e,a,.5,e,-.5,-.5,e,-a,-.5,e,.5,-.5,e,a,-.5,e,-.5,.5,e,-a,.5);const l=.025/n.x+.5,c=1/(n.y*r);for(let e=.5;e>=-.5;e-=c)o.push(-.5,e,.5,-l,e,.5,-.5,e,-.5,-l,e,-.5,.5,e,-.5,l,e,-.5,.5,e,.5,l,e,.5);const u=1/(n.z*r);for(let e=.5;e>=-.5;e-=u)o.push(-.5,.5,e,-l,.5,e,-.5,-.5,e,-l,-.5,e,.5,-.5,e,l,-.5,e,.5,.5,e,l,.5,e);const h=new i.LoY;return h.setAttribute("position",new i.THS(new Float32Array(o),3)),new i.DXC(h,new i.mrM({color:or}))}cleanup(){this.geometry.dispose(),this.geometryMesh.material.dispose(),this.channelData.cleanup()}doRender(e,t,n){if(!this.geometryMesh.visible)return;const r=n??this.emptyPositionTex;this.setUniform("textureDepth",r),this.setUniform("usingPositionTexture",r.isDepthTexture?0:1),this.setUniform("CLIP_NEAR",t.near),this.setUniform("CLIP_FAR",t.far),this.channelData.gpuFuse(e),this.setUniform("textureAtlas",this.channelData.getFusedTexture()),this.geometryTransformNode.updateMatrixWorld(!0);const o=new i.kn4;o.multiplyMatrices(t.matrixWorldInverse,this.geometryMesh.matrixWorld),o.invert(),this.setUniform("inverseModelViewMatrix",o),this.setUniform("inverseProjMatrix",t.projectionMatrixInverse)}get3dObject(){return this.geometryTransformNode}setUniform(e,t){this.uniforms[e]&&(this.uniforms[e].value=t)}updateActiveChannels(e,t){this.channelData.fuse(e,t),this.setUniform("textureAtlas",this.channelData.getFusedTexture()),this.setUniform("textureAtlasMask",this.channelData.maskTexture)}setRenderUpdateListener(e){}}const sr=()=>({gInvExposure:{type:"f",value:4},gDenoiseWindowRadius:{type:"i",value:3},gDenoiseNoise:{type:"f",value:.05},gDenoiseInvWindowArea:{type:"f",value:1/49},gDenoiseWeightThreshold:{type:"f",value:.1},gDenoiseLerpThreshold:{type:"f",value:0},gDenoiseLerpC:{type:"f",value:.01},gDenoisePixelSize:{type:"v2",value:new i.I9Y(1,1)},tTexture0:{type:"t",value:null}});class lr{constructor(e){this.mTheta=14*Math.PI/180,this.mPhi=54*Math.PI/180,this.mWidth=1,this.mHeight=1,this.mHalfWidth=.5*this.mWidth,this.mHalfHeight=.5*this.mHeight,this.mDistance=4,this.mSkyRadius=1e3,this.mP=new i.Pq0,this.mTarget=new i.Pq0,this.mArea=1,this.mAreaPdf=1/this.mArea,this.mColor=new i.Pq0(75,75,75),this.mColorTop=new i.Pq0(.3,.3,.3),this.mColorMiddle=new i.Pq0(.3,.3,.3),this.mColorBottom=new i.Pq0(.3,.3,.3),this.mT=e,this.mN=new i.Pq0(0,0,1),this.mU=new i.Pq0(1,0,0),this.mV=new i.Pq0(0,1,0),this.update(new i.Pq0(0,0,0))}update(e,t){this.mHalfWidth=.5*this.mWidth,this.mHalfHeight=.5*this.mHeight,this.mTarget.copy(e),this.mP.x=this.mDistance*Math.sin(this.mPhi)*Math.sin(this.mTheta),this.mP.z=this.mDistance*Math.sin(this.mPhi)*Math.cos(this.mTheta),this.mP.y=this.mDistance*Math.cos(this.mPhi),this.mP.add(this.mTarget),t&&(this.mP.applyMatrix4(t),this.mTarget.applyMatrix4(t)),0===this.mT?(this.mArea=this.mWidth*this.mHeight,this.mAreaPdf=1/this.mArea):1===this.mT&&(this.mP.copy(e),this.mTarget.addVectors(this.mP,new i.Pq0(0,0,1)),this.mSkyRadius=1e3*e.length()*2,this.mArea=4*Math.PI*Math.pow(this.mSkyRadius,2),this.mAreaPdf=1/this.mArea),this.mN.subVectors(this.mTarget,this.mP).normalize(),1===this.mN.y||-1===this.mN.y?this.mU.crossVectors(this.mN,new i.Pq0(1,0,0)).normalize():this.mU.crossVectors(this.mN,new i.Pq0(0,1,0)).normalize(),this.mV.crossVectors(this.mN,this.mU).normalize()}}const cr=[[255,0,255],[255,255,255],[0,255,255]],ur=(hr=123,function(){return(2147483647&(hr=0|Math.imul(48271,hr)))/2147483648});var hr;const dr=e=>(cr[e]||(cr[e]=function(e,t,n){let r,i,o,a=0;if(1===arguments.length){const r=e;t=r.s,n=r.v,a=r.h}else a=e;const s=Math.floor(6*a),l=6*a-s,c=n*(1-t),u=n*(1-l*t),h=n*(1-(1-l)*t);switch(s%6){case 0:r=n,i=h,o=c;break;case 1:r=u,i=n,o=c;break;case 2:r=c,i=n,o=h;break;case 3:r=c,i=u,o=n;break;case 4:r=h,i=c,o=n;break;case 5:r=n,i=c,o=u}return[Math.round(255*r),Math.round(255*i),Math.round(255*o)]}(ur(),.5*ur()+.5,.5*ur()+.5)),cr[e]);function fr(e,t,n){return Math.min(Math.max(t,e),n)}function pr(e,t,n){return n*(t-e)+e}function mr(e,t,n,r,i,o,a){return t+((e-t)/(n-t)*(a-o)+o-r)/(i-r)*(n-t)}function gr(e,t,n,r,i,o,a){return t+((e-t)/(n-t)*(i-r)+r-o)/(a-o)*(n-t)}const vr=256,yr=4*vr;function br(e){return[e.color[0],e.color[1],e.color[2],Math.floor(255*e.opacity)]}const _r=(e=0,t=1)=>[{x:0,opacity:e,color:[255,255,255]},{x:255,opacity:t,color:[255,255,255]}];class wr{constructor(){this.lut=new Uint8Array(yr),this.controlPoints=[],this.createFullRange()}createFromMinMax(e,t){if(t<e){const n=t;t=e,e=n}if(e<0&&t<0)return this.controlPoints=_r(1,1),this.createFromControlPoints(this.controlPoints);if(e>=255&&t>=255)return this.controlPoints=_r(0,0),this.createFromControlPoints(this.controlPoints);const n=[];let r=0;e<0&&(r=-e/(t-e)),n.push({x:0,opacity:r,color:[255,255,255]}),e>0&&n.push({x:e,opacity:0,color:[255,255,255]}),t<255&&(t===e?n.push({x:e+.5,opacity:1,color:[255,255,255]}):n.push({x:t,opacity:1,color:[255,255,255]}));let i=1;return t>255&&(i=(255-e)/(t-e)),n.push({x:255,opacity:i,color:[255,255,255]}),this.createFromControlPoints(n)}createFullRange(){return this.controlPoints=_r(),this.createFromControlPoints(this.controlPoints)}createFromWindowLevel(e,t){const n=t-.5*e,r=t+.5*e;return this.createFromMinMax(255*n,255*r)}createFromControlPoints(e){return this.lut=function(e){const t=vr,n=new Uint8Array(4*t).fill(0);if(0===e.length)return n;if(e.sort(((e,t)=>e.x-t.x)),1===e.length){const r=br(e[0]);for(let i=fr(e[0].x,0,255);i<t;++i)n[4*i+0]=r[0],n[4*i+1]=r[1],n[4*i+2]=r[2],n[4*i+3]=r[3];return n}let r=e[0],i=e[1],o=br(r),a=br(i),s=1,l=0;for(let c=0;c<t;++c){for(;c>i.x;)r=i,o=a,s++,i=s>=e.length?{x:255,color:i.color,opacity:i.opacity}:e[s],a=br(i);l=i.x===r.x?1:(c-r.x)/(i.x-r.x),n[4*c+0]=fr(pr(o[0],a[0],l),0,255),n[4*c+1]=fr(pr(o[1],a[1],l),0,255),n[4*c+2]=fr(pr(o[2],a[2],l),0,255),n[4*c+3]=fr(pr(o[3],a[3],l),0,255)}return n}(e),this.controlPoints=e,this}createFromEqHistogram(e){const t=[];for(let n=0;n<e.getNumBins();++n)t[n]=0;t[0]=e.getBin(0);for(let n=1;n<e.getNumBins();++n)t[n]=t[n-1]+e.getBin(n);if(t[t.length-1]-t[0]>0){const e=[{x:0,opacity:0,color:[255,255,255]}];let n=0,r=0,i=0,o=0;for(let a=1;a<vr;++a)o=i,i=fr(Math.round(255*(t[a]-t[0])),0,255),n=i-o,n!=r&&(e.push({x:a-1,opacity:o/255,color:[255,255,255]}),r=n);return e.push({x:255,opacity:1,color:[255,255,255]}),this.createFromControlPoints(e)}return this.createFullRange()}createLabelColors(e){const t=new Uint8Array(yr).fill(0),n=[];n.push({x:0,opacity:0,color:[0,0,0]});let r=0,i=0,o=0,a=0,s=0,l=0,c=0,u=0;for(let h=1;h<vr;++h){const d=Math.floor(h/(vr-1)*(e.getNumBins()-1));if(e.getBin(d)>0){const e=dr(d);t[4*h+0]=e[0],t[4*h+1]=e[1],t[4*h+2]=e[2],t[4*h+3]=255,s=e[0],l=e[1],c=e[2],u=1}else s=0,l=0,c=0,u=0;s===r&&l===i&&c===o&&u===a||(0===a&&n.push({x:h-.5,opacity:a,color:[r,i,o]}),n.push({x:h,opacity:u,color:[s,l,c]}),r=s,i=l,o=c,a=u)}return this.lut=t,this.controlPoints=n,this}remapDomains(e,t,n,r){this.lut=function(e,t,n,r,i){const o=new Uint8Array(yr);for(let a=0;a<vr;++a){let s=mr(a,0,vr-1,t,n,r,i);s<0&&(s=0),s>vr-1&&(s=vr-1);const l=Math.floor(s),c=Math.ceil(s),u=s-l;o[4*a+0]=Math.round(pr(e[4*l+0],e[4*c+0],u)),o[4*a+1]=Math.round(pr(e[4*l+1],e[4*c+1],u)),o[4*a+2]=Math.round(pr(e[4*l+2],e[4*c+2],u)),o[4*a+3]=Math.round(pr(e[4*l+3],e[4*c+3],u))}return o}(this.lut,e,t,n,r),this.controlPoints=xr(this.controlPoints,e,t,n,r)}}function xr(e,t,n,r,i,o=!0){if(0===e.length)return e;const a=[],s=e[0].x,l=e[e.length-1].x;for(let o=0;o<e.length;++o){const s=e[o],l={x:gr(s.x,0,vr-1,t,n,r,i),opacity:s.opacity,color:[s.color[0],s.color[1],s.color[2]]};a.push(l)}return o?function(e,t,n){const r=1e-4,i=e[0],o=e[1],a=e[e.length-2],s=e[e.length-1];return Math.abs(i.opacity-(o?.opacity??1/0))<r&&(i.x<0?i.x=Math.min(0,o.x-1):t<r&&(i.x=0)),Math.abs(s.opacity-(a?.opacity??1/0))<r&&(s.x>255?s.x=Math.max(255,a.x+1):n>254.9999&&(s.x=255)),e}(a,s,l):a}class Sr{pathTracingUniforms=(()=>({tPreviousTexture:{type:"t",value:new i.gPd},uSampleCounter:{type:"f",value:0},uFrameCounter:{type:"f",value:1},uResolution:{type:"v2",value:new i.I9Y},gClippedAaBbMin:{type:"v3",value:new i.Pq0(0,0,0)},gClippedAaBbMax:{type:"v3",value:new i.Pq0(1,1,1)},gVolCenter:{type:"v3",value:new i.Pq0(0,0,0)},gDensityScale:{type:"f",value:50},gStepSize:{type:"f",value:1},gStepSizeShadow:{type:"f",value:1},gInvAaBbMax:{type:"v3",value:new i.Pq0},gNChannels:{type:"i",value:0},gShadingType:{type:"i",value:0},gGradientDeltaX:{type:"v3",value:new i.Pq0(.01,0,0)},gGradientDeltaY:{type:"v3",value:new i.Pq0(0,.01,0)},gGradientDeltaZ:{type:"v3",value:new i.Pq0(0,0,.01)},gInvGradientDelta:{type:"f",value:0},gGradientFactor:{type:"f",value:.25},gCamera:{value:{mFrom:new i.Pq0,mU:new i.Pq0,mV:new i.Pq0,mN:new i.Pq0,mScreen:new i.IUQ,mInvScreen:new i.I9Y,mFocalDistance:0,mApertureSize:0,mIsOrtho:0}},gLights:{value:[new lr(1),new lr(0)]},volumeTexture:{type:"t",value:new i.gPd},gLutTexture:{type:"t",value:new i.gPd},gIntensityMax:{type:"v4",value:new i.IUQ(1,1,1,1)},gIntensityMin:{type:"v4",value:new i.IUQ(0,0,0,0)},gOpacity:{type:"1fv",value:[1,1,1,1]},gEmissive:{type:"v3v",value:[new i.Pq0(0,0,0),new i.Pq0(0,0,0),new i.Pq0(0,0,0),new i.Pq0(0,0,0)]},gDiffuse:{type:"v3v",value:[new i.Pq0(1,0,0),new i.Pq0(0,1,0),new i.Pq0(0,0,1),new i.Pq0(1,0,1)]},gSpecular:{type:"v3v",value:[new i.Pq0(0,0,0),new i.Pq0(0,0,0),new i.Pq0(0,0,0),new i.Pq0(0,0,0)]},gGlossiness:{type:"1fv",value:[1,1,1,1]},uShowLights:{type:"f",value:0},flipVolume:{type:"v3",value:new i.Pq0(1,1,1)}}))();denoiseShaderUniforms=sr();screenOutputShaderUniforms={gInvExposure:{type:"f",value:4},tTexture0:{type:"t",value:null}};constructor(e,t=new en(e)){this.volume=e,this.viewChannels=[-1,-1,-1,-1];const{x:n,y:r,z:o}=e.imageInfo.subregionSize,a=new Uint8Array(n*r*o*4).fill(0);this.volumeTexture=new i.dYF(a,n,r,o),this.volumeTexture.minFilter=this.volumeTexture.magFilter=i.k6q,this.volumeTexture.generateMipmaps=!1,this.volumeTexture.needsUpdate=!0;const s=new Uint8Array(4*yr).fill(1),l=new i.GYF(s,256,4,i.GWd,i.OUM);l.minFilter=l.magFilter=i.k6q,l.needsUpdate=!0,this.pathTracingUniforms.gLutTexture.value=l,this.cameraIsMoving=!1,this.sampleCounter=0,this.frameCounter=0,this.pathTracingRenderTarget=new i.nWS(2,2,{minFilter:i.hxR,magFilter:i.hxR,format:i.GWd,type:i.RQf,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1}),this.screenTextureRenderTarget=new i.nWS(2,2,{minFilter:i.hxR,magFilter:i.hxR,format:i.GWd,type:i.RQf,depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1}),this.pathTracingUniforms.volumeTexture.value=this.volumeTexture,this.pathTracingUniforms.tPreviousTexture.value=this.screenTextureRenderTarget.texture,this.pathTracingRenderToBuffer=new gn("precision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\n\n#define PI (3.1415926535897932384626433832795)\n#define PI_OVER_2 (1.57079632679489661923)\n#define PI_OVER_4 (0.785398163397448309616)\n#define INV_PI (1.0/PI)\n#define INV_2_PI (0.5/PI)\n#define INV_4_PI (0.25/PI)\n\nconst vec3 BLACK = vec3(0,0,0);\nconst vec3 WHITE = vec3(1.0,1.0,1.0);\nconst int ShaderType_Brdf = 0;\nconst int ShaderType_Phase = 1;\nconst int ShaderType_Mixed = 2;\nconst float MAX_RAY_LEN = 1500000.0f;\n\nin vec2 vUv;\n\nstruct Camera {\n  vec3 mFrom;\n  vec3 mU, mV, mN;\n  vec4 mScreen;  // left, right, bottom, top\n  vec2 mInvScreen;  // 1/w, 1/h\n  float mFocalDistance;\n  float mApertureSize;\n  float mIsOrtho; // 1 or 0\n};\n\nuniform Camera gCamera;\n\nstruct Light {\n  float   mTheta;\n  float   mPhi;\n  float   mWidth;\n  float   mHalfWidth;\n  float   mHeight;\n  float   mHalfHeight;\n  float   mDistance;\n  float   mSkyRadius;\n  vec3    mP;\n  vec3    mTarget;\n  vec3    mN;\n  vec3    mU;\n  vec3    mV;\n  float   mArea;\n  float   mAreaPdf;\n  vec3    mColor;\n  vec3    mColorTop;\n  vec3    mColorMiddle;\n  vec3    mColorBottom;\n  int     mT;\n};\nconst int NUM_LIGHTS = 2;\nuniform Light gLights[2];\n\nuniform vec3 gClippedAaBbMin;\nuniform vec3 gClippedAaBbMax;\nuniform vec3 gVolCenter;\nuniform float gDensityScale;\nuniform float gStepSize;\nuniform float gStepSizeShadow;\nuniform sampler3D volumeTexture;\nuniform vec3 gInvAaBbMax;\nuniform int gNChannels;\nuniform int gShadingType;\nuniform vec3 gGradientDeltaX;\nuniform vec3 gGradientDeltaY;\nuniform vec3 gGradientDeltaZ;\nuniform float gInvGradientDelta;\nuniform float gGradientFactor;\nuniform float uShowLights;\nuniform vec3 flipVolume;\n\n// per channel\n// the luttexture is a 256x4 rgba texture\n// each row is a 256 element lookup table.\nuniform sampler2D gLutTexture;\nuniform vec4 gIntensityMax;\nuniform vec4 gIntensityMin;\nuniform float gOpacity[4];\nuniform vec3 gEmissive[4];\nuniform vec3 gDiffuse[4];\nuniform vec3 gSpecular[4];\nuniform float gGlossiness[4];\n\n// compositing / progressive render\nuniform float uFrameCounter;\nuniform float uSampleCounter;\nuniform vec2 uResolution;\nuniform sampler2D tPreviousTexture;\n\n// from iq https://www.shadertoy.com/view/4tXyWN\nfloat rand( inout uvec2 seed )\n{\n  seed += uvec2(1);\n  uvec2 q = 1103515245U * ( (seed >> 1U) ^ (seed.yx) );\n  uint  n = 1103515245U * ( (q.x) ^ (q.y >> 3U) );\n  return float(n) * (1.0 / float(0xffffffffU));\n}\n\nvec3 XYZtoRGB(vec3 xyz) {\n  return vec3(\n    3.240479f*xyz[0] - 1.537150f*xyz[1] - 0.498535f*xyz[2],\n    -0.969256f*xyz[0] + 1.875991f*xyz[1] + 0.041556f*xyz[2],\n    0.055648f*xyz[0] - 0.204043f*xyz[1] + 1.057311f*xyz[2]\n  );\n}\n\n// Used to convert from linear RGB to XYZ space\nconst mat3 RGB_2_XYZ = (mat3(\n  0.4124564, 0.3575761, 0.1804375,\n  0.2126729, 0.7151522, 0.0721750,\n  0.0193339, 0.1191920, 0.9503041\n));\nvec3 RGBtoXYZ(vec3 rgb) {\n  return rgb * RGB_2_XYZ;\n}\n\nvec3 getUniformSphereSample(in vec2 U)\n{\n  float z = 1.f - 2.f * U.x;\n  float r = sqrt(max(0.f, 1.f - z*z));\n  float phi = 2.f * PI * U.y;\n  float x = r * cos(phi);\n  float y = r * sin(phi);\n  return vec3(x, y, z);\n}\n\nfloat SphericalPhi(in vec3 Wl)\n{\n  float p = atan(Wl.z, Wl.x);\n  return (p < 0.f) ? p + 2.f * PI : p;\n}\n\nfloat SphericalTheta(in vec3 Wl)\n{\n  return acos(clamp(Wl.y, -1.f, 1.f));\n}\n\nbool SameHemisphere(in vec3 Ww1, in vec3 Ww2)\n{\n   return (Ww1.z * Ww2.z) > 0.0f;\n}\n\nvec2 getConcentricDiskSample(in vec2 U)\n{\n  float r, theta;\n  // Map 0..1 to -1..1\n  float sx = 2.0 * U.x - 1.0;\n  float sy = 2.0 * U.y - 1.0;\n\n  // Map square to (r,theta)\n\n  // Handle degeneracy at the origin\n  if (sx == 0.0 && sy == 0.0)\n  {\n    return vec2(0.0f, 0.0f);\n  }\n\n  // quadrants of disk\n  if (sx >= -sy)\n  {\n    if (sx > sy)\n    {\n      r = sx;\n      if (sy > 0.0)\n        theta = sy/r;\n      else\n        theta = 8.0f + sy/r;\n    }\n    else\n    {\n      r = sy;\n      theta = 2.0f - sx/r;\n    }\n  }\n  else\n  {\n    if (sx <= sy)\n    {\n      r = -sx;\n      theta = 4.0f - sy/r;\n    }\n    else\n    {\n      r = -sy;\n      theta = 6.0f + sx/r;\n    }\n  }\n\n  theta *= PI_OVER_4;\n\n  return vec2(r*cos(theta), r*sin(theta));\n}\n\nvec3 getCosineWeightedHemisphereSample(in vec2 U)\n{\n  vec2 ret = getConcentricDiskSample(U);\n  return vec3(ret.x, ret.y, sqrt(max(0.f, 1.f - ret.x * ret.x - ret.y * ret.y)));\n}\n\nstruct Ray {\n  vec3 m_O;\n  vec3 m_D;\n  float m_MinT, m_MaxT;\n};\n\nvec3 rayAt(Ray r, float t) {\n  return r.m_O + t*r.m_D;\n}\n\nRay GenerateCameraRay(in Camera cam, in vec2 Pixel, in vec2 ApertureRnd)\n{\n  // negating ScreenPoint.y flips the up/down direction. depends on whether you want pixel 0 at top or bottom\n  // we could also have flipped mScreen and mInvScreen, or cam.mV?\n  vec2 ScreenPoint = vec2(\n    cam.mScreen.x + (cam.mInvScreen.x * Pixel.x),\n    cam.mScreen.z + (cam.mInvScreen.y * Pixel.y)\n  );\n  vec3 dxy = (ScreenPoint.x * cam.mU) + (-ScreenPoint.y * cam.mV);\n\n  // orthographic camera ray: start at (camera pos + screen point), go in direction N\n  // perspective camera ray: start at camera pos, go in direction (N + screen point)\n  vec3 RayO = cam.mFrom + cam.mIsOrtho * dxy;\n  vec3 RayD = normalize(cam.mN + (1.0 - cam.mIsOrtho) * dxy);\n\n  if (cam.mApertureSize != 0.0f)\n  {\n    vec2 LensUV = cam.mApertureSize * getConcentricDiskSample(ApertureRnd);\n\n    vec3 LI = cam.mU * LensUV.x + cam.mV * LensUV.y;\n    RayO += LI;\n    RayD = normalize((RayD * cam.mFocalDistance) - LI);\n  }\n\n  return Ray(RayO, RayD, 0.0, MAX_RAY_LEN);\n}\n\nbool IntersectBox(in Ray R, out float pNearT, out float pFarT)\n{\n  vec3 invR\t\t= vec3(1.0f, 1.0f, 1.0f) / R.m_D;\n  vec3 bottomT\t\t= invR * (vec3(gClippedAaBbMin.x, gClippedAaBbMin.y, gClippedAaBbMin.z) - R.m_O);\n  vec3 topT\t\t= invR * (vec3(gClippedAaBbMax.x, gClippedAaBbMax.y, gClippedAaBbMax.z) - R.m_O);\n  vec3 minT\t\t= min(topT, bottomT);\n  vec3 maxT\t\t= max(topT, bottomT);\n  float largestMinT = max(max(minT.x, minT.y), max(minT.x, minT.z));\n  float smallestMaxT = min(min(maxT.x, maxT.y), min(maxT.x, maxT.z));\n\n  pNearT = largestMinT;\n  pFarT\t= smallestMaxT;\n\n  return smallestMaxT > largestMinT;\n}\n\n// assume volume is centered at 0,0,0 so p spans -bounds to + bounds\n// transform p to range from 0,0,0 to 1,1,1 for volume texture sampling.\n// optionally invert axes\nvec3 PtoVolumeTex(vec3 p) {\n  vec3 uvw = (p - gVolCenter) * gInvAaBbMax + vec3(0.5, 0.5, 0.5);\n  // if flipVolume = 1, uvw is unchanged.\n  // if flipVolume = -1, uvw = 1 - uvw\n  uvw = (flipVolume*(uvw - 0.5) + 0.5);\n  return uvw;\n}\n\nconst float UINT8_MAX = 1.0;//255.0;\n\n// strategy: sample up to 4 channels, and take the post-LUT maximum intensity as the channel that wins\n// we will return the unmapped raw intensity value from the volume so that other luts can be applied again later.\nfloat GetNormalizedIntensityMax4ch(in vec3 P, out int ch)\n{\n  vec4 intensity = UINT8_MAX * texture(volumeTexture, PtoVolumeTex(P));\n\n  //intensity = (intensity - gIntensityMin) / (gIntensityMax - gIntensityMin);\n  vec4 ilut = vec4(0.0, 0.0, 0.0, 0.0);\n  // w in the lut texture is \"opacity\"\n  ilut.x = texture(gLutTexture, vec2(intensity.x, 0.5/4.0)).w / 255.0;\n  ilut.y = texture(gLutTexture, vec2(intensity.y, 1.5/4.0)).w / 255.0;\n  ilut.z = texture(gLutTexture, vec2(intensity.z, 2.5/4.0)).w / 255.0;\n  ilut.w = texture(gLutTexture, vec2(intensity.w, 3.5/4.0)).w / 255.0;\n\n  float maxIn = 0.0;\n  float iOut = 0.0;\n  ch = 0;\n  for (int i = 0; i < min(gNChannels, 4); ++i) {\n    if (ilut[i] > maxIn) {\n      maxIn = ilut[i];\n      ch = i;\n      iOut = intensity[i];\n    }\n  }\n\n  //return maxIn;\n  return iOut;\n}\n\nfloat GetNormalizedIntensity4ch(vec3 P, int ch)\n{\n  vec4 intensity = UINT8_MAX * texture(volumeTexture, PtoVolumeTex(P));\n  // select channel\n  float intensityf = intensity[ch];\n  //intensityf = (intensityf - gIntensityMin[ch]) / (gIntensityMax[ch] - gIntensityMin[ch]);\n  //intensityf = texture(gLutTexture, vec2(intensityf, (0.5+float(ch))/4.0)).x;\n\n  return intensityf;\n}\n\n// note that gInvGradientDelta is maxpixeldim of volume\n// gGradientDeltaX,Y,Z is 1/X,Y,Z of volume\nvec3 Gradient4ch(vec3 P, int ch)\n{\n  vec3 Gradient;\n\n  Gradient.x = (GetNormalizedIntensity4ch(P + (gGradientDeltaX), ch) - GetNormalizedIntensity4ch(P - (gGradientDeltaX), ch)) * gInvGradientDelta;\n  Gradient.y = (GetNormalizedIntensity4ch(P + (gGradientDeltaY), ch) - GetNormalizedIntensity4ch(P - (gGradientDeltaY), ch)) * gInvGradientDelta;\n  Gradient.z = (GetNormalizedIntensity4ch(P + (gGradientDeltaZ), ch) - GetNormalizedIntensity4ch(P - (gGradientDeltaZ), ch)) * gInvGradientDelta;\n\n  return Gradient;\n}\n\nfloat GetOpacity(float NormalizedIntensity, int ch)\n{\n  // apply lut\n  float o = texture(gLutTexture, vec2(NormalizedIntensity, (0.5+float(ch))/4.0)).w / 255.0;\n  float Intensity = o * gOpacity[ch];\n  return Intensity;\n}\n\nvec3 GetEmissionN(float NormalizedIntensity, int ch)\n{\n  return gEmissive[ch];\n}\n\nvec3 GetDiffuseN(float NormalizedIntensity, int ch)\n{\n  vec4 col = texture(gLutTexture, vec2(NormalizedIntensity, (0.5+float(ch))/4.0));\n  //vec3 col = vec3(1.0, 1.0, 1.0);\n  return col.xyz * gDiffuse[ch];\n}\n\nvec3 GetSpecularN(float NormalizedIntensity, int ch)\n{\n  return gSpecular[ch];\n}\n\nfloat GetGlossinessN(float NormalizedIntensity, int ch)\n{\n  return gGlossiness[ch];\n}\n\n// a bsdf sample, a sample on a light source, and a randomly chosen light index\nstruct LightingSample {\n  float m_bsdfComponent;\n  vec2  m_bsdfDir;\n  vec2  m_lightPos;\n  float m_lightComponent;\n  float m_LightNum;\n};\n\nLightingSample LightingSample_LargeStep(inout uvec2 seed) {\n  return LightingSample(\n    rand(seed),\n    vec2(rand(seed), rand(seed)),\n    vec2(rand(seed), rand(seed)),\n    rand(seed),\n    rand(seed)\n    );\n}\n\n// return a color xyz\nvec3 Light_Le(in Light light, in vec2 UV)\n{\n  if (light.mT == 0)\n    return RGBtoXYZ(light.mColor) / light.mArea;\n\n  if (light.mT == 1)\n  {\n    if (UV.y > 0.0f)\n      return RGBtoXYZ(mix(light.mColorMiddle, light.mColorTop, abs(UV.y)));\n    else\n      return RGBtoXYZ(mix(light.mColorMiddle, light.mColorBottom, abs(UV.y)));\n  }\n\n  return BLACK;\n}\n\n// return a color xyz\nvec3 Light_SampleL(in Light light, in vec3 P, out Ray Rl, out float Pdf, in LightingSample LS)\n{\n  vec3 L = BLACK;\n  Pdf = 0.0;\n  vec3 Ro = vec3(0,0,0), Rd = vec3(0,0,1);\n  if (light.mT == 0)\n  {\n    Ro = (light.mP + ((-0.5f + LS.m_lightPos.x) * light.mWidth * light.mU) + ((-0.5f + LS.m_lightPos.y) * light.mHeight * light.mV));\n    Rd = normalize(P - Ro);\n    L = dot(Rd, light.mN) > 0.0f ? Light_Le(light, vec2(0.0f)) : BLACK;\n    Pdf = abs(dot(Rd, light.mN)) > 0.0f ? dot(P-Ro, P-Ro) / (abs(dot(Rd, light.mN)) * light.mArea) : 0.0f;\n  }\n  else if (light.mT == 1)\n  {\n    Ro = light.mP + light.mSkyRadius * getUniformSphereSample(LS.m_lightPos);\n    Rd = normalize(P - Ro);\n    L = Light_Le(light, vec2(1.0f) - 2.0f * LS.m_lightPos);\n    Pdf = pow(light.mSkyRadius, 2.0f) / light.mArea;\n  }\n\n  Rl = Ray(Ro, Rd, 0.0f, length(P - Ro));\n\n  return L;\n}\n\n// Intersect ray with light\nbool Light_Intersect(Light light, inout Ray R, out float T, out vec3 L, out float pPdf)\n{\n  if (light.mT == 0)\n  {\n    // Compute projection\n    float DotN = dot(R.m_D, light.mN);\n\n    // Ray is coplanar with light surface\n    if (DotN >= 0.0f)\n      return false;\n\n    // Compute hit distance\n    T = (-light.mDistance - dot(R.m_O, light.mN)) / DotN;\n\n    // Intersection is in ray's negative direction\n    if (T < R.m_MinT || T > R.m_MaxT)\n      return false;\n\n    // Determine position on light\n    vec3 Pl = rayAt(R, T);\n\n    // Vector from point on area light to center of area light\n    vec3 Wl = Pl - light.mP;\n\n    // Compute texture coordinates\n    vec2 UV = vec2(dot(Wl, light.mU), dot(Wl, light.mV));\n\n    // Check if within bounds of light surface\n    if (UV.x > light.mHalfWidth || UV.x < -light.mHalfWidth || UV.y > light.mHalfHeight || UV.y < -light.mHalfHeight)\n      return false;\n\n    R.m_MaxT = T;\n\n    //pUV = UV;\n\n    if (DotN < 0.0f)\n      L = RGBtoXYZ(light.mColor) / light.mArea;\n    else\n      L = BLACK;\n\n    pPdf = dot(R.m_O-Pl, R.m_O-Pl) / (DotN * light.mArea);\n\n    return true;\n  }\n\n  else if (light.mT == 1)\n  {\n    T = light.mSkyRadius;\n\n    // Intersection is in ray's negative direction\n    if (T < R.m_MinT || T > R.m_MaxT)\n      return false;\n\n    R.m_MaxT = T;\n\n    vec2 UV = vec2(SphericalPhi(R.m_D) * INV_2_PI, SphericalTheta(R.m_D) * INV_PI);\n\n    L = Light_Le(light, vec2(1.0f,1.0f) - 2.0f * UV);\n\n    pPdf = pow(light.mSkyRadius, 2.0f) / light.mArea;\n    //pUV = UV;\n\n    return true;\n  }\n\n  return false;\n}\n\nfloat Light_Pdf(in Light light, in vec3 P, in vec3 Wi)\n{\n  vec3 L;\n  vec2 UV;\n  float Pdf = 1.0f;\n\n  Ray Rl = Ray(P, Wi, 0.0f, 100000.0f);\n\n  if (light.mT == 0)\n  {\n    float T = 0.0f;\n\n    if (!Light_Intersect(light, Rl, T, L, Pdf))\n      return 0.0f;\n\n    return pow(T, 2.0f) / (abs(dot(light.mN, -Wi)) * light.mArea);\n  }\n\n  else if (light.mT == 1)\n  {\n    return pow(light.mSkyRadius, 2.0f) / light.mArea;\n  }\n\n  return 0.0f;\n}\n\nstruct VolumeShader {\n  int m_Type; // 0 = bsdf, 1 = phase\n\n  vec3 m_Kd; // isotropic phase // xyz color\n  vec3 m_R; // specular reflectance\n  float m_Ior;\n  float m_Exponent;\n  vec3 m_Nn;\n  vec3 m_Nu;\n  vec3 m_Nv;\n};\n\n// return a xyz color\nvec3 ShaderPhase_F(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  return shader.m_Kd * INV_PI;\n}\n\nfloat ShaderPhase_Pdf(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  return INV_4_PI;\n}\n\nvec3 ShaderPhase_SampleF(in VolumeShader shader, in vec3 Wo, out vec3 Wi, out float Pdf, in vec2 U)\n{\n  Wi\t= getUniformSphereSample(U);\n  Pdf\t= ShaderPhase_Pdf(shader, Wo, Wi);\n\n  return ShaderPhase_F(shader, Wo, Wi);\n}\n\n// return a xyz color\nvec3 Lambertian_F(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  return shader.m_Kd * INV_PI;\n}\n\nfloat Lambertian_Pdf(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  //return abs(Wi.z)*INV_PI;\n  return SameHemisphere(Wo, Wi) ? abs(Wi.z) * INV_PI : 0.0f;\n}\n\n// return a xyz color\nvec3 Lambertian_SampleF(in VolumeShader shader, in vec3 Wo, out vec3 Wi, out float Pdf, in vec2 U)\n{\n  Wi = getCosineWeightedHemisphereSample(U);\n\n  if (Wo.z < 0.0f)\n    Wi.z *= -1.0f;\n\n  Pdf = Lambertian_Pdf(shader, Wo, Wi);\n\n  return Lambertian_F(shader, Wo, Wi);\n}\n\nvec3 SphericalDirection(in float SinTheta, in float CosTheta, in float Phi)\n{\n  return vec3(SinTheta * cos(Phi), SinTheta * sin(Phi), CosTheta);\n}\n\nvoid Blinn_SampleF(in VolumeShader shader, in vec3 Wo, out vec3 Wi, out float Pdf, in vec2 U)\n{\n  // Compute sampled half-angle vector wh for Blinn distribution\n  float costheta = pow(U.x, 1.f / (shader.m_Exponent+1.0));\n  float sintheta = sqrt(max(0.f, 1.f - costheta*costheta));\n  float phi = U.y * 2.f * PI;\n\n  vec3 wh = SphericalDirection(sintheta, costheta, phi);\n\n  if (!SameHemisphere(Wo, wh))\n    wh = -wh;\n\n  // Compute incident direction by reflecting about wh\n  Wi = -Wo + 2.f * dot(Wo, wh) * wh;\n\n  // Compute PDF for wi from Blinn distribution\n  float blinn_pdf = ((shader.m_Exponent + 1.f) * pow(costheta, shader.m_Exponent)) / (2.f * PI * 4.f * dot(Wo, wh));\n\n  if (dot(Wo, wh) <= 0.f)\n    blinn_pdf = 0.f;\n\n  Pdf = blinn_pdf;\n}\n\nfloat Blinn_D(in VolumeShader shader, in vec3 wh)\n{\n  float costhetah = abs(wh.z);//AbsCosTheta(wh);\n  return (shader.m_Exponent+2.0) * INV_2_PI * pow(costhetah, shader.m_Exponent);\n}\nfloat Microfacet_G(in VolumeShader shader, in vec3 wo, in vec3 wi, in vec3 wh)\n{\n  float NdotWh = abs(wh.z);//AbsCosTheta(wh);\n  float NdotWo = abs(wo.z);//AbsCosTheta(wo);\n  float NdotWi = abs(wi.z);//AbsCosTheta(wi);\n  float WOdotWh = abs(dot(wo, wh));\n\n  return min(1.f, min((2.f * NdotWh * NdotWo / WOdotWh), (2.f * NdotWh * NdotWi / WOdotWh)));\n}\n\nvec3 Microfacet_F(in VolumeShader shader, in vec3 wo, in vec3 wi)\n{\n  float cosThetaO = abs(wo.z);//AbsCosTheta(wo);\n  float cosThetaI = abs(wi.z);//AbsCosTheta(wi);\n\n  if (cosThetaI == 0.f || cosThetaO == 0.f)\n    return BLACK;\n\n  vec3 wh = wi + wo;\n\n  if (wh.x == 0. && wh.y == 0. && wh.z == 0.)\n    return BLACK;\n\n  wh = normalize(wh);\n  float cosThetaH = dot(wi, wh);\n\n  vec3 F = WHITE;//m_Fresnel.Evaluate(cosThetaH);\n\n  return shader.m_R * Blinn_D(shader, wh) * Microfacet_G(shader, wo, wi, wh) * F / (4.f * cosThetaI * cosThetaO);\n}\n\nvec3 ShaderBsdf_WorldToLocal(in VolumeShader shader, in vec3 W)\n{\n  return vec3(dot(W, shader.m_Nu), dot(W, shader.m_Nv), dot(W, shader.m_Nn));\n}\n\nvec3 ShaderBsdf_LocalToWorld(in VolumeShader shader, in vec3 W)\n{\n  return vec3(\tshader.m_Nu.x * W.x + shader.m_Nv.x * W.y + shader.m_Nn.x * W.z,\n    shader.m_Nu.y * W.x + shader.m_Nv.y * W.y + shader.m_Nn.y * W.z,\n    shader.m_Nu.z * W.x + shader.m_Nv.z * W.y + shader.m_Nn.z * W.z);\n}\n\nfloat Blinn_Pdf(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  vec3 wh = normalize(Wo + Wi);\n\n  float costheta = abs(wh.z);//AbsCosTheta(wh);\n  // Compute PDF for wi from Blinn distribution\n  float blinn_pdf = ((shader.m_Exponent + 1.f) * pow(costheta, shader.m_Exponent)) / (2.f * PI * 4.f * dot(Wo, wh));\n\n  if (dot(Wo, wh) <= 0.0f)\n    blinn_pdf = 0.0f;\n\n  return blinn_pdf;\n}\n\nvec3 Microfacet_SampleF(in VolumeShader shader, in vec3 wo, out vec3 wi, out float Pdf, in vec2 U)\n{\n  Blinn_SampleF(shader, wo, wi, Pdf, U);\n\n  if (!SameHemisphere(wo, wi))\n    return BLACK;\n\n  return Microfacet_F(shader, wo, wi);\n}\n\nfloat Microfacet_Pdf(in VolumeShader shader, in vec3 wo, in vec3 wi)\n{\n  if (!SameHemisphere(wo, wi))\n    return 0.0f;\n\n  return Blinn_Pdf(shader, wo, wi);\n}\n\n// return a xyz color\nvec3 ShaderBsdf_F(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  vec3 Wol = ShaderBsdf_WorldToLocal(shader, Wo);\n  vec3 Wil = ShaderBsdf_WorldToLocal(shader, Wi);\n\n  vec3 R = vec3(0,0,0);\n\n  R += Lambertian_F(shader, Wol, Wil);\n  R += Microfacet_F(shader, Wol, Wil);\n\n  return R;\n}\n\nfloat ShaderBsdf_Pdf(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  vec3 Wol = ShaderBsdf_WorldToLocal(shader, Wo);\n  vec3 Wil = ShaderBsdf_WorldToLocal(shader, Wi);\n\n  float Pdf = 0.0f;\n\n  Pdf += Lambertian_Pdf(shader, Wol, Wil);\n  Pdf += Microfacet_Pdf(shader, Wol, Wil);\n\n  return Pdf;\n}\n\n\nvec3 ShaderBsdf_SampleF(in VolumeShader shader, in LightingSample S, in vec3 Wo, out vec3 Wi, out float Pdf, in vec2 U)\n{\n  vec3 Wol = ShaderBsdf_WorldToLocal(shader, Wo);\n  vec3 Wil = vec3(0,0,0);\n\n  vec3 R = vec3(0,0,0);\n\n  if (S.m_bsdfComponent <= 0.5f)\n  {\n    Lambertian_SampleF(shader, Wol, Wil, Pdf, S.m_bsdfDir);\n  }\n  else\n  {\n    Microfacet_SampleF(shader, Wol, Wil, Pdf, S.m_bsdfDir);\n  }\n\n  Pdf += Lambertian_Pdf(shader, Wol, Wil);\n  Pdf += Microfacet_Pdf(shader, Wol, Wil);\n\n  R += Lambertian_F(shader, Wol, Wil);\n  R += Microfacet_F(shader, Wol, Wil);\n\n  Wi = ShaderBsdf_LocalToWorld(shader, Wil);\n\n  //return vec3(1,1,1);\n  return R;\n}\n\n// return a xyz color\nvec3 Shader_F(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  if (shader.m_Type == 0) {\n    return ShaderBsdf_F(shader, Wo, Wi);\n  }\n  else {\n    return ShaderPhase_F(shader, Wo, Wi);\n  }\n}\n\nfloat Shader_Pdf(in VolumeShader shader, in vec3 Wo, in vec3 Wi)\n{\n  if (shader.m_Type == 0) {\n    return ShaderBsdf_Pdf(shader, Wo, Wi);\n  }\n  else {\n    return ShaderPhase_Pdf(shader, Wo, Wi);\n  }\n}\n\nvec3 Shader_SampleF(in VolumeShader shader, in LightingSample S, in vec3 Wo, out vec3 Wi, out float Pdf, in vec2 U)\n{\n  //return vec3(1,0,0);\n  if (shader.m_Type == 0) {\n    return ShaderBsdf_SampleF(shader, S, Wo, Wi, Pdf, U);\n  }\n  else {\n    return ShaderPhase_SampleF(shader, Wo, Wi, Pdf, U);\n  }\n}\n\n\nbool IsBlack(in vec3 v) {\n  return (v.x==0.0 && v.y == 0.0 && v.z == 0.0);\n}\n\nfloat PowerHeuristic(float nf, float fPdf, float ng, float gPdf)\n{\n  float f = nf * fPdf;\n  float g = ng * gPdf;\n  // The power heuristic is Veach's MIS balance heuristic except each component is being squared\n  // balance heuristic would be f/(f+g) ...?\n  return (f * f) / (f * f + g * g);\n}\n\nfloat MISContribution(float pdf1, float pdf2)\n{\n  return PowerHeuristic(1.0f, pdf1, 1.0f, pdf2);\n}\n\n// \"shadow ray\" using gStepSizeShadow, test whether it can exit the volume or not\nbool DoesSecondaryRayScatterInVolume(inout Ray R, inout uvec2 seed)\n{\n  float MinT;\n  float MaxT;\n  vec3 Ps;\n\n  if (!IntersectBox(R, MinT, MaxT))\n    return false;\n\n  MinT = max(MinT, R.m_MinT);\n  MaxT = min(MaxT, R.m_MaxT);\n\n  // delta (Woodcock) tracking\n  float S\t= -log(rand(seed)) / gDensityScale;\n  float Sum = 0.0f;\n  float SigmaT = 0.0f;\n\n  MinT += rand(seed) * gStepSizeShadow;\n  int ch = 0;\n  float intensity = 0.0;\n  while (Sum < S)\n  {\n    Ps = rayAt(R, MinT);  // R.m_O + MinT * R.m_D;\n\n    if (MinT > MaxT)\n      return false;\n\n    intensity = GetNormalizedIntensityMax4ch(Ps, ch);\n    SigmaT = gDensityScale * GetOpacity(intensity, ch);\n\n    Sum += SigmaT * gStepSizeShadow;\n    MinT += gStepSizeShadow;\n  }\n\n  return true;\n}\n\nint GetNearestLight(Ray R, out vec3 oLightColor, out vec3 Pl, out float oPdf)\n{\n  int hit = -1;\n  float T = 0.0f;\n  Ray rayCopy = R;\n  float pdf = 0.0f;\n\n  for (int i = 0; i < 2; i++)\n  {\n    if (Light_Intersect(gLights[i], rayCopy, T, oLightColor, pdf))\n    {\n      Pl = rayAt(R, T);\n      hit = i;\n    }\n  }\n  oPdf = pdf;\n\n  return hit;\n}\n\n// return a XYZ color\n// Wo is direction from scatter point out toward incident ray direction\n\n// Wi goes toward light sample and is not necessarily perfect reflection of Wo\n// ^Wi   ^N    ^Wo\n//  \\\\    |    //\n//   \\\\   |   //\n//    \\\\  |  //\n//     \\\\ | //\n//      \\\\|// Pe = volume sample where scattering occurs\n//   ---------\nvec3 EstimateDirectLight(int shaderType, float Density, int ch, in Light light, in LightingSample LS, in vec3 Wo, in vec3 Pe, in vec3 N, inout uvec2 seed)\n{\n  vec3 Ld = BLACK, Li = BLACK, F = BLACK;\n\n  vec3 diffuse = GetDiffuseN(Density, ch);\n  vec3 specular = GetSpecularN(Density, ch);\n  float glossiness = GetGlossinessN(Density, ch);\n\n  // can N and Wo be coincident????\n  vec3 nu = normalize(cross(N, Wo));\n  vec3 nv = normalize(cross(N, nu));\n\n  // the IoR here is hard coded... and unused!!!!\n  VolumeShader Shader = VolumeShader(shaderType, RGBtoXYZ(diffuse), RGBtoXYZ(specular), 2.5f, glossiness, N, nu, nv);\n\n  float LightPdf = 1.0f, ShaderPdf = 1.0f;\n\n  Ray Rl = Ray(vec3(0,0,0), vec3(0,0,1.0), 0.0, MAX_RAY_LEN);\n  // Rl is ray from light toward Pe in volume, with a max traversal of the distance from Pe to Light sample pos.\n  Li = Light_SampleL(light, Pe, Rl, LightPdf, LS);\n\n  // Wi: negate ray direction: from volume scatter point toward light...?\n  vec3 Wi = -Rl.m_D, P = vec3(0,0,0);\n\n  // we will calculate two lighting contributions and combine them by MIS.\n\n  F = Shader_F(Shader,Wo, Wi);\n\n  ShaderPdf = Shader_Pdf(Shader, Wo, Wi);\n\n  // get a lighting contribution along Rl;  see if Rl would scatter in the volume or not\n  if (!IsBlack(Li) && (ShaderPdf > 0.0f) && (LightPdf > 0.0f) && !DoesSecondaryRayScatterInVolume(Rl, seed))\n  {\n    // ray from light can see through volume to Pe!\n\n    float dotProd = 1.0;\n    if (shaderType == ShaderType_Brdf){\n\n      // (use abs or clamp here?)\n      dotProd = abs(dot(Wi, N));\n    }\n    Ld += F * Li * dotProd * MISContribution(LightPdf, ShaderPdf) / LightPdf;\n\n  }\n\n  // get a lighting contribution by sampling nearest light from the scattering point\n  F = Shader_SampleF(Shader, LS, Wo, Wi, ShaderPdf, LS.m_bsdfDir);\n  if (!IsBlack(F) && (ShaderPdf > 0.0f))\n  {\n    vec3 Pl = vec3(0,0,0);\n    int n = GetNearestLight(Ray(Pe, Wi, 0.0f, 1000000.0f), Li, Pl, LightPdf);\n    if (n > -1)\n    {\n      Light pLight = gLights[n];\n      LightPdf = Light_Pdf(pLight, Pe, Wi);\n\n      if ((LightPdf > 0.0f) && !IsBlack(Li)) {\n        Ray rr = Ray(Pl, normalize(Pe - Pl), 0.0f, length(Pe - Pl));\n        if (!DoesSecondaryRayScatterInVolume(rr, seed))\n        {\n          float dotProd = 1.0;\n          if (shaderType == ShaderType_Brdf){\n\n            // (use abs or clamp here?)\n            dotProd = abs(dot(Wi, N));\n          }\n          // note order of MIS params is swapped\n          Ld += F * Li * dotProd * MISContribution(ShaderPdf, LightPdf) / ShaderPdf;\n        }\n\n      }\n    }\n  }\n\n  return Ld;\n\n}\n\n// return a linear xyz color\nvec3 UniformSampleOneLight(int shaderType, float Density, int ch, in vec3 Wo, in vec3 Pe, in vec3 N, inout uvec2 seed)\n{\n  //if (NUM_LIGHTS == 0)\n  //  return BLACK;\n\n  // select a random light, a random 2d sample on light, and a random 2d sample on brdf\n  LightingSample LS = LightingSample_LargeStep(seed);\n\n  int WhichLight = int(floor(LS.m_LightNum * float(NUM_LIGHTS)));\n\n  Light light = gLights[WhichLight];\n\n  return float(NUM_LIGHTS) * EstimateDirectLight(shaderType, Density, ch, light, LS, Wo, Pe, N, seed);\n\n}\n\nbool SampleScatteringEvent(inout Ray R, inout uvec2 seed, out vec3 Ps)\n{\n  float MinT;\n  float MaxT;\n\n  if (!IntersectBox(R, MinT, MaxT))\n    return false;\n\n  MinT = max(MinT, R.m_MinT);\n  MaxT = min(MaxT, R.m_MaxT);\n\n  // delta (Woodcock) tracking\n\n  // notes, not necessarily coherent:\n  // ray march along the ray's projected path and keep an average sigmaT value.\n  // The distance is weighted by the intensity at each ray step sample. High intensity increases the apparent distance.\n  // When the distance has become greater than the average sigmaT value given by -log(RandomFloat[0, 1]) / averageSigmaT\n  // then that would be considered the interaction position.\n\n  // sigmaT = sigmaA + sigmaS = absorption coeff + scattering coeff = extinction coeff\n\n  // Beer-Lambert law: transmittance T(t) = exp(-sigmaT*t)  where t is a distance!\n\n  // importance sampling the exponential function to produce a free path distance S\n  // the PDF is p(t) = sigmaT * exp(-sigmaT * t)\n  // In a homogeneous volume,\n  // S is the free-path distance = -ln(1-zeta)/sigmaT where zeta is a random variable\n  // density scale = 0   => S --\x3e 0..inf.  Low density means randomly sized ray paths\n  // density scale = inf => S --\x3e 0.       High density means short ray paths!\n\n  // note that ln(x:0..1) is negative\n\n  // here gDensityScale represents sigmaMax, a majorant of sigmaT\n  // it is a parameter that should be set as close to the max extinction coefficient as possible.\n  float S\t= -log(rand(seed)) / gDensityScale;\n\n  float Sum\t\t= 0.0f;\n  float SigmaT\t= 0.0f; // accumulated extinction along ray march\n\n  // start: take one step now.\n  MinT += rand(seed) * gStepSize;\n\n  int ch = 0;\n  float intensity = 0.0;\n\n  // ray march until we have traveled S (or hit the maxT of the ray)\n  while (Sum < S)\n  {\n    Ps = rayAt(R, MinT);  // R.m_O + MinT * R.m_D;\n\n    // if we exit the volume with no scattering\n    if (MinT > MaxT)\n      return false;\n\n    intensity = GetNormalizedIntensityMax4ch(Ps, ch);\n    SigmaT = gDensityScale * GetOpacity(intensity, ch);\n\n    Sum += SigmaT * gStepSize;\n    MinT += gStepSize;\n  }\n\n  // at this time, MinT - original MinT is the T transmission distance before a scatter event.\n  // Ps is the point\n\n  return true;\n}\n\n\nvec4 CalculateRadiance(inout uvec2 seed) {\n  float r = rand(seed);\n  //return vec4(r,0,0,1);\n\n  vec3 Lv = BLACK, Li = BLACK;\n\n  //Ray Re = Ray(vec3(0,0,0), vec3(0,0,1), 0.0, MAX_RAY_LEN);\n\n  vec2 UV = vUv*uResolution + vec2(rand(seed), rand(seed));\n\n  Ray Re = GenerateCameraRay(gCamera, UV, vec2(rand(seed), rand(seed)));\n\n  //return vec4(vUv, 0.0, 1.0);\n  //return vec4(0.5*(Re.m_D + 1.0), 1.0);\n  //return vec4(Re.m_D, 1.0);\n\n  //Re.m_MinT = 0.0f;\n  //Re.m_MaxT = MAX_RAY_LEN;\n\n  vec3 Pe = vec3(0,0,0), Pl = vec3(0,0,0);\n  float lpdf = 0.0;\n\n  float alpha = 0.0;\n  // find point Pe along ray Re\n  if (SampleScatteringEvent(Re, seed, Pe))\n  {\n    alpha = 1.0;\n    // is there a light between Re.m_O and Pe? (ray's maxT is distance to Pe)\n    // (test to see if area light was hit before volume.)\n    int i = GetNearestLight(Ray(Re.m_O, Re.m_D, 0.0f, length(Pe - Re.m_O)), Li, Pl, lpdf);\n    if (i > -1)\n    {\n      // set sample pixel value in frame estimate (prior to accumulation)\n      return vec4(Li, 1.0);\n    }\n\n    int ch = 0;\n    float D = GetNormalizedIntensityMax4ch(Pe, ch);\n\n    // emission from volume\n    Lv += RGBtoXYZ(GetEmissionN(D, ch));\n\n    vec3 gradient = Gradient4ch(Pe, ch);\n    // send ray out from Pe toward light\n    switch (gShadingType)\n    {\n      case ShaderType_Brdf:\n      {\n        Lv += UniformSampleOneLight(ShaderType_Brdf, D, ch, normalize(-Re.m_D), Pe, normalize(gradient), seed);\n        break;\n      }\n\n      case ShaderType_Phase:\n      {\n        Lv += 0.5f * UniformSampleOneLight(ShaderType_Phase, D, ch, normalize(-Re.m_D), Pe, normalize(gradient), seed);\n        break;\n      }\n\n      case ShaderType_Mixed:\n      {\n        //const float GradMag = GradientMagnitude(Pe, volumedata.gradientVolumeTexture[ch]) * (1.0/volumedata.intensityMax[ch]);\n        float GradMag = length(gradient);\n        float PdfBrdf = (1.0f - exp(-gGradientFactor * GradMag));\n\n        vec3 cls; // xyz color\n        if (rand(seed) < PdfBrdf) {\n          cls = UniformSampleOneLight(ShaderType_Brdf, D, ch, normalize(-Re.m_D), Pe, normalize(gradient), seed);\n        }\n        else {\n          cls = 0.5f * UniformSampleOneLight(ShaderType_Phase, D, ch, normalize(-Re.m_D), Pe, normalize(gradient), seed);\n        }\n\n        Lv += cls;\n\n        break;\n      }\n    }\n  }\n  else\n  {\n    // background color:\n    // set Lv to a selected color based on environment light source?\n    // if (uShowLights > 0.0) {\n    //   int n = GetNearestLight(Ray(Re.m_O, Re.m_D, 0.0f, 1000000.0f), Li, Pl, lpdf);\n    //   if (n > -1)\n    //     Lv = Li;\n    // }\n    //Lv = vec3(r,0,0);\n  }\n\n  // set sample pixel value in frame estimate (prior to accumulation)\n\n  return vec4(Lv, alpha);\n}\n\nvec4 CumulativeMovingAverage(vec4 A, vec4 Ax, float N)\n{\n   return A + ((Ax - A) / max((N), 1.0f));\n}\n\nvoid main()\n{\n  // seed for rand(seed) function\n  uvec2 seed = uvec2(uFrameCounter, uFrameCounter + 1.0) * uvec2(gl_FragCoord);\n\n  // perform path tracing and get resulting pixel color\n  vec4 pixelColor = CalculateRadiance( seed );\n\n  vec4 previousColor = texture(tPreviousTexture, vUv);\n  if (uSampleCounter < 1.0) {\n    previousColor = vec4(0,0,0,0);\n  }\n\n  pc_fragColor = CumulativeMovingAverage(previousColor, pixelColor, uSampleCounter);\n}\n",this.pathTracingUniforms),this.screenTextureRenderToBuffer=new gn(pn,{image:{value:this.pathTracingRenderTarget.texture}}),this.screenOutputGeometry=new i.bdM(2,2),this.screenOutputMaterial=new i.BKk({uniforms:this.screenOutputShaderUniforms,vertexShader:fn,fragmentShader:"precision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nuniform float gInvExposure;\nuniform sampler2D tTexture0;\nin vec2 vUv;\n\n// Used to convert from XYZ to linear RGB space\nconst mat3 XYZ_2_RGB = (mat3(\n  3.2404542, -1.5371385, -0.4985314,\n -0.9692660,  1.8760108,  0.0415560,\n  0.0556434, -0.2040259,  1.0572252\n));\n\nvec3 XYZtoRGB(vec3 xyz) {\n  return xyz * XYZ_2_RGB;\n}\n\nvoid main() {\n  vec4 pixelColor = texture(tTexture0, vUv);\n\n  pixelColor.rgb = XYZtoRGB(pixelColor.rgb);\n\n  // pixelColor.rgb = pow(pixelColor.rgb, vec3(1.0/2.2));\n  pixelColor.rgb = 1.0-exp(-pixelColor.rgb*gInvExposure);\n  pixelColor = clamp(pixelColor, 0.0, 1.0);\n\n  pc_fragColor = pixelColor; // sqrt(pixelColor);\n  // out_FragColor = pow(pixelColor, vec4(1.0/2.2));\n}\n",depthWrite:!1,depthTest:!1,blending:i.NTi,transparent:!0}),this.denoiseShaderUniforms=sr(),this.screenOutputDenoiseMaterial=new i.BKk({uniforms:this.denoiseShaderUniforms,vertexShader:fn,fragmentShader:"precision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nuniform float gInvExposure;\nuniform int gDenoiseWindowRadius;\nuniform float gDenoiseNoise;\nuniform float gDenoiseInvWindowArea;\nuniform float gDenoiseWeightThreshold;\nuniform float gDenoiseLerpThreshold;\nuniform float gDenoiseLerpC;\nuniform vec2 gDenoisePixelSize;\n\nuniform sampler2D tTexture0;\nin vec2 vUv;\n\n// Used to convert from XYZ to linear RGB space\nconst mat3 XYZ_2_RGB = (mat3(\n 3.2404542, -1.5371385, -0.4985314,\n -0.9692660,  1.8760108,  0.0415560,\n  0.0556434, -0.2040259,  1.0572252\n));\n\nvec3 XYZtoRGB(vec3 xyz) {\n  return xyz * XYZ_2_RGB;\n}\n\nvoid main()\n{\n  vec4 pixelColor = texture(tTexture0, vUv);\n  // TODO TONE MAP!!!!!!\n  pixelColor.rgb = XYZtoRGB(pixelColor.rgb);\n\n  pixelColor.rgb = 1.0-exp(-pixelColor.rgb*gInvExposure);\n  pixelColor = clamp(pixelColor, 0.0, 1.0);\n\n  /////////////////////\n  /////////////////////\n  /////////////////////\n  /////////////////////\n  //// DENOISING FILTER\n  /////////////////////\n  // see https://developer.download.nvidia.com/compute/cuda/1.1-Beta/x86_website/projects/imageDenoising/doc/imageDenoising.pdf\n  /////////////////////\n  vec4 clr00 = pixelColor;\n\n  float fCount = 0.0;\n  float SumWeights = 0.0;\n  vec3 clr = vec3(0.0, 0.0, 0.0);\n\n  vec2 uvsample = vUv;\n  vec3 rgbsample;\n  for (int i = -gDenoiseWindowRadius; i <= gDenoiseWindowRadius; i++) {\n    for (int j = -gDenoiseWindowRadius; j <= gDenoiseWindowRadius; j++) {\n\n      // boundary checking?\n      vec3 clrIJ = texture(tTexture0, vUv + vec2(float(i)/gDenoisePixelSize.x, float(j)/gDenoisePixelSize.y)).rgb;\n      //vec3 clrIJ = texelFetch(tTexture0, ivec2(gl_FragCoord.xy) + ivec2(i,j), 0).rgb;\n\n      rgbsample = XYZtoRGB(clrIJ);\n      // tone map!\n      rgbsample = 1.0 - exp(-rgbsample * gInvExposure);\n      rgbsample = clamp(rgbsample, 0.0, 1.0);\n\n      clrIJ = rgbsample;\n\n      float distanceIJ = (clr00.x-clrIJ.x)*(clr00.x-clrIJ.x) + (clr00.y-clrIJ.y)*(clr00.y-clrIJ.y) + (clr00.z-clrIJ.z)*(clr00.z-clrIJ.z);\n\n      // gDenoiseNoise = 1/h^2\n      //\n      float weightIJ = exp(-(distanceIJ * gDenoiseNoise + float(i * i + j * j) * gDenoiseInvWindowArea));\n\n      clr += (clrIJ * weightIJ);\n\n      SumWeights += weightIJ;\n\n      fCount += (weightIJ > gDenoiseWeightThreshold) ? gDenoiseInvWindowArea : 0.0;\n    }\n  }\n\n  SumWeights = 1.0 / SumWeights;\n\n  clr.rgb *= SumWeights;\n\n  float LerpQ = (fCount > gDenoiseLerpThreshold) ? gDenoiseLerpC : 1.0f - gDenoiseLerpC;\n\n  clr.rgb = mix(clr.rgb, clr00.rgb, LerpQ);\n  clr.rgb = clamp(clr.rgb, 0.0, 1.0);\n\n  pc_fragColor = vec4(clr.rgb, clr00.a);\n}\n",depthWrite:!1,depthTest:!1,blending:i.NTi,transparent:!0}),this.screenOutputMaterial.uniforms.tTexture0.value=this.pathTracingRenderTarget.texture,this.screenOutputDenoiseMaterial.uniforms.tTexture0.value=this.pathTracingRenderTarget.texture,this.screenOutputMesh=new i.eaF(this.screenOutputGeometry,this.screenOutputMaterial),this.gradientDelta=1/Math.max(n,Math.max(r,o));const c=1/this.gradientDelta;this.pathTracingUniforms.gGradientDeltaX.value=new i.Pq0(this.gradientDelta,0,0),this.pathTracingUniforms.gGradientDeltaY.value=new i.Pq0(0,this.gradientDelta,0),this.pathTracingUniforms.gGradientDeltaZ.value=new i.Pq0(0,0,this.gradientDelta),this.pathTracingUniforms.gInvGradientDelta.value=c,this.pathTracingUniforms.gGradientFactor.value=50,this.updateSettings(t),this.settings=t;const u=this.getNormVolumeSize();this.pathTracingUniforms.gInvAaBbMax.value=new i.Pq0(1/u.x,1/u.y,1/u.z).divide(e.normRegionSize),this.updateLightsSecondary()}cleanup(){this.volumeTexture.dispose()}setRenderUpdateListener(e){this.renderUpdateListener=e}resetProgress(){0!==this.sampleCounter&&this.renderUpdateListener&&this.renderUpdateListener(0),this.sampleCounter=0}getNormVolumeSize(){return this.volume.normPhysicalSize.clone().multiply(this.settings.scale)}updateSettings(e,t){if(void 0===t&&(t=Qt.ALL),this.settings=e,t&Qt.SAMPLING){const e=this.settings.resolution.clone(),t=window.devicePixelRatio?window.devicePixelRatio:1,n=Math.floor(e.x*this.settings.pixelSamplingRate/t),r=Math.floor(e.y*this.settings.pixelSamplingRate/t);this.pathTracingUniforms.uResolution.value.x=n,this.pathTracingUniforms.uResolution.value.y=r,this.pathTracingRenderTarget.setSize(n,r),this.screenTextureRenderTarget.setSize(n,r),this.pathTracingUniforms.gStepSize.value=this.settings.primaryRayStepSize*this.gradientDelta,this.pathTracingUniforms.gStepSizeShadow.value=this.settings.secondaryRayStepSize*this.gradientDelta}if(t&Qt.TRANSFORM&&(this.pathTracingUniforms.flipVolume.value=this.settings.flipAxes),t&Qt.MATERIAL&&(this.pathTracingUniforms.gDensityScale.value=150*this.settings.density,this.updateMaterial()),t&Qt.ROI){const{normRegionSize:e,normRegionOffset:t}=this.volume,{bmin:n,bmax:r}=this.settings.bounds,i=this.getNormVolumeSize(),o=t.clone().subScalar(.5).multiply(i),a=t.clone().add(e).subScalar(.5).multiply(i),s=n.clone().multiply(i);this.pathTracingUniforms.gClippedAaBbMin.value=s.clamp(o,a);const l=r.clone().multiply(i);this.pathTracingUniforms.gClippedAaBbMax.value=l.clamp(o,a),this.pathTracingUniforms.gVolCenter.value=this.volume.getContentCenter().multiply(this.settings.scale)}t&Qt.CAMERA&&this.updateExposure(this.settings.brightness),t&Qt.MASK_ALPHA&&this.updateVolumeData4(),t&Qt.VIEW&&(this.pathTracingUniforms.gCamera.value.mIsOrtho=this.settings.isOrtho?1:0),t&Qt.SAMPLING&&(this.volumeTexture.minFilter=this.volumeTexture.magFilter=e.useInterpolation?i.k6q:i.hxR,this.volumeTexture.needsUpdate=!0),this.resetProgress()}updateVolumeDimensions(){this.updateSettings(this.settings,Qt.ROI)}doRender(e,t){if(!this.volumeTexture)return;this.cameraIsMoving?(this.resetProgress(),this.frameCounter+=1):(this.sampleCounter+=1,this.frameCounter+=1,this.renderUpdateListener&&this.renderUpdateListener(this.sampleCounter)),this.pathTracingUniforms.uSampleCounter.value=this.sampleCounter,this.pathTracingUniforms.uFrameCounter.value=this.frameCounter,t.updateMatrixWorld(!0);const n=t.matrixWorld.clone();n.setPosition(new i.Pq0(0,0,0)),this.updateLightsSecondary(n);let r=new i.Pq0;r=t.getWorldDirection(r);const o=(new i.Pq0).copy(t.up),a=(new i.Pq0).copy(t.position),s=(new i.kn4).makeRotationFromQuaternion((new i.PTz).setFromEuler(this.settings.rotation).invert());a.sub(this.settings.translation),a.applyMatrix4(s),o.applyMatrix4(s),r.applyMatrix4(s),this.pathTracingUniforms.gCamera.value.mIsOrtho=qt(t)?1:0,this.pathTracingUniforms.gCamera.value.mFrom.copy(a),this.pathTracingUniforms.gCamera.value.mN.copy(r),this.pathTracingUniforms.gCamera.value.mU.crossVectors(this.pathTracingUniforms.gCamera.value.mN,o).normalize(),this.pathTracingUniforms.gCamera.value.mV.crossVectors(this.pathTracingUniforms.gCamera.value.mU,this.pathTracingUniforms.gCamera.value.mN).normalize();const l=qt(t)?Math.abs(t.top)/t.zoom:Math.tan(.5*t.fov*Math.PI/180),c=this.pathTracingUniforms.uResolution.value.x/this.pathTracingUniforms.uResolution.value.y;this.pathTracingUniforms.gCamera.value.mScreen.set(-l*c,l*c,l,-l);const u=this.pathTracingUniforms.gCamera.value.mScreen;this.pathTracingUniforms.gCamera.value.mInvScreen.set((u.y-u.x)/this.pathTracingUniforms.uResolution.value.x,(u.w-u.z)/this.pathTracingUniforms.uResolution.value.y);const h=.035*Math.max(this.sampleCounter-1,1)*.33;h>0&&h<1?(this.screenOutputDenoiseMaterial.uniforms.gDenoiseLerpC.value=h,this.screenOutputMesh.material=this.screenOutputDenoiseMaterial):this.screenOutputMesh.material=this.screenOutputMaterial,this.screenOutputDenoiseMaterial.uniforms.gDenoisePixelSize.value.x=this.pathTracingUniforms.uResolution.value.x,this.screenOutputDenoiseMaterial.uniforms.gDenoisePixelSize.value.y=this.pathTracingUniforms.uResolution.value.y,this.pathTracingRenderToBuffer.render(e,this.pathTracingRenderTarget),this.screenTextureRenderToBuffer.render(e,this.screenTextureRenderTarget),e.setRenderTarget(null)}get3dObject(){return this.screenOutputMesh}onStartControls(){this.cameraIsMoving=!0}onChangeControls(){}onEndControls(){this.cameraIsMoving=!1,this.resetProgress()}viewpointMoved(){this.resetProgress()}updateActiveChannels(e,t){const n=[-1,-1,-1,-1];let r=0;const i=this.volume.imageInfo.numChannels;for(let o=0;o<i&&r<4;++o)0!==e[o].rgbColor&&t[o].loaded&&(n[r]=o,r++);n.every(((e,t)=>e===this.viewChannels[t]),this)||(this.pathTracingUniforms.gNChannels.value=r,this.viewChannels=n,this.updateVolumeData4(),this.resetProgress(),this.updateLuts(e,t),this.updateMaterial())}updateVolumeData4(){const{x:e,y:t,z:n}=this.volume.imageInfo.subregionSize,r=new Uint8Array(e*t*n*4);r.fill(0);for(let i=0;i<4;++i){const o=this.viewChannels[i];if(-1===o)continue;const a=this.volume.getChannel(o);for(let o=0;o<n;++o)for(let n=0;n<t;++n)for(let s=0;s<e;++s)r[i+4*s+4*n*e+4*o*e*t]=255*a.normalizeRaw(a.getIntensity(s,n,o));if(-1!==this.settings.maskChannelIndex&&this.settings.maskAlpha<1){const o=this.volume.getChannel(this.settings.maskChannelIndex);let a=1;const s=this.settings.maskAlpha;for(let l=0;l<n;++l)for(let n=0;n<t;++n)for(let c=0;c<e;++c)a=o.getIntensity(c,n,l)>0?1:s,r[i+4*c+4*n*e+4*l*e*t]*=a}}this.volumeTexture.image.data.set(r),this.volumeTexture.needsUpdate=!0}updateLuts(e,t){for(let n=0;n<this.pathTracingUniforms.gNChannels.value;++n){const r=this.viewChannels[n],i=t[r].combineLuts(e[r].rgbColor);this.pathTracingUniforms.gLutTexture.value.image.data.set(i,n*yr),this.pathTracingUniforms.gIntensityMax.value.setComponent(n,this.volume.channels[r].histogram.getMax()/255),this.pathTracingUniforms.gIntensityMin.value.setComponent(n,this.volume.channels[r].histogram.getMin()/255)}this.pathTracingUniforms.gLutTexture.value.needsUpdate=!0,this.resetProgress()}updateMaterial(){for(let e=0;e<this.viewChannels.length;++e){const t=this.viewChannels[e];if(t>-1){const n=this.volume.getChannel(t).combineLuts(this.settings.diffuse[t]);this.pathTracingUniforms.gLutTexture.value.image.data.set(n,e*yr),this.pathTracingUniforms.gLutTexture.value.needsUpdate=!0,this.pathTracingUniforms.gDiffuse.value[e]=new i.Pq0(1,1,1),this.pathTracingUniforms.gSpecular.value[e]=(new i.Pq0).fromArray(this.settings.specular[t]).multiplyScalar(1/255),this.pathTracingUniforms.gEmissive.value[e]=(new i.Pq0).fromArray(this.settings.emissive[t]).multiplyScalar(1/255),this.pathTracingUniforms.gGlossiness.value[e]=this.settings.glossiness[t]}}this.resetProgress()}updateShadingMethod(e){this.pathTracingUniforms.gShadingType.value=e,this.resetProgress()}updateShowLights(e){this.pathTracingUniforms.uShowLights.value=e,this.resetProgress()}updateExposure(e){e>.99999&&(e=.99999),this.screenOutputMaterial.uniforms.gInvExposure.value=1/(1-e)-1,this.screenOutputDenoiseMaterial.uniforms.gInvExposure.value=1/(1-e)-1,this.resetProgress()}updateCamera(e,t,n){this.pathTracingUniforms.gCamera.value.mApertureSize=n,this.pathTracingUniforms.gCamera.value.mFocalDistance=t,this.resetProgress()}updateLights(e){this.pathTracingUniforms.gLights.value[0].mColorTop=(new i.Pq0).copy(e[0].mColorTop),this.pathTracingUniforms.gLights.value[0].mColorMiddle=(new i.Pq0).copy(e[0].mColorMiddle),this.pathTracingUniforms.gLights.value[0].mColorBottom=(new i.Pq0).copy(e[0].mColorBottom),this.pathTracingUniforms.gLights.value[1].mColor=(new i.Pq0).copy(e[1].mColor),this.pathTracingUniforms.gLights.value[1].mTheta=e[1].mTheta,this.pathTracingUniforms.gLights.value[1].mPhi=e[1].mPhi,this.pathTracingUniforms.gLights.value[1].mDistance=e[1].mDistance,this.pathTracingUniforms.gLights.value[1].mWidth=e[1].mWidth,this.pathTracingUniforms.gLights.value[1].mHeight=e[1].mHeight,this.updateLightsSecondary(),this.resetProgress()}updateLightsSecondary(e){console.log("lights secondary");const t=this.getNormVolumeSize(),n=new i.Pq0(.5*t.x,.5*t.y,.5*t.z);for(let t=0;t<2;++t)this.pathTracingUniforms.gLights.value[t].update(n,e)}updateClipRegion(e,t,n,r,o,a){this.settings.bounds={bmin:new i.Pq0(e-.5,n-.5,o-.5),bmax:new i.Pq0(t-.5,r-.5,a-.5)};const s=this.getNormVolumeSize();this.pathTracingUniforms.gClippedAaBbMin.value=new i.Pq0(e*s.x-.5*s.x,n*s.y-.5*s.y,o*s.z-.5*s.z),this.pathTracingUniforms.gClippedAaBbMax.value=new i.Pq0(t*s.x-.5*s.x,r*s.y-.5*s.y,a*s.z-.5*s.z),this.resetProgress()}setZSlice(e){return!0}}class Er{needRedraw=!1;channelToPick=0;constructor(e,t=new en(e)){this.volume=e,this.uniforms={iResolution:{type:"v2",value:new i.I9Y(100,100)},textureRes:{type:"v2",value:new i.I9Y(1,1)},ATLAS_DIMS:{type:"v2",value:new i.I9Y(6,6)},AABB_CLIP_MIN:{type:"v3",value:new i.Pq0(-.5,-.5,-.5)},CLIP_NEAR:{type:"f",value:.1},AABB_CLIP_MAX:{type:"v3",value:new i.Pq0(.5,.5,.5)},CLIP_FAR:{type:"f",value:20},textureAtlas:{type:"t",value:new i.gPd},textureDepth:{type:"t",value:new i.gPd},usingPositionTexture:{type:"i",value:0},BREAK_STEPS:{type:"i",value:128},SLICES:{type:"f",value:50},isOrtho:{type:"f",value:0},orthoThickness:{type:"f",value:1},orthoScale:{type:"f",value:.5},maxProject:{type:"i",value:0},flipVolume:{type:"v3",value:new i.Pq0(1,1,1)},volumeScale:{type:"v3",value:new i.Pq0(1,1,1)},inverseModelViewMatrix:{type:"m4",value:new i.kn4},inverseProjMatrix:{type:"m4",value:new i.kn4}},[this.geometry,this.geometryMesh]=this.createGeometry(this.uniforms),this.geometryTransformNode=new i.YJl,this.geometryTransformNode.name="PickVolumeContainerNode",this.geometryTransformNode.add(this.geometryMesh),this.scene=new i.Z58,this.scene.name="PickVolumeScene",this.scene.add(this.geometryTransformNode),this.emptyPositionTex=new i.GYF(new Uint8Array(Array(16).fill(0)),2,2),this.pickBuffer=new i.nWS(2,2,{count:1,minFilter:i.hxR,magFilter:i.hxR,format:i.GWd,type:i.RQf,generateMipmaps:!1}),this.pickBuffer.textures[0].name="objectinfo",this.settings=t,this.updateSettings(t,Qt.ALL),this.updateVolumeDimensions()}setChannelToPick(e){this.channelToPick=e}getChannelToPick(){return this.channelToPick}getPickBuffer(){return this.pickBuffer}updateVolumeDimensions(){const{normPhysicalSize:e,normRegionSize:t}=this.volume;this.geometryMesh.position.copy(this.volume.getContentCenter().multiply(this.settings.scale));const n=e.clone().multiply(this.settings.scale);this.geometryMesh.scale.copy(n).multiply(t),this.setUniform("volumeScale",e),this.settings&&this.updateSettings(this.settings,Qt.ROI);const{atlasTileDims:r,subregionSize:o}=this.volume.imageInfo,a=new i.I9Y(o.x,o.y).multiply(r);this.setUniform("ATLAS_DIMS",r),this.setUniform("textureRes",a),this.setUniform("SLICES",this.volume.imageInfo.volumeSize.z)}viewpointMoved(){this.needRedraw=!0}updateSettings(e,t){if(void 0===t&&(t=Qt.ALL),this.settings=e,t&Qt.VIEW){this.needRedraw=!0,this.geometryMesh.visible=this.settings.visible,this.setUniform("orthoScale",this.settings.orthoScale),this.setUniform("isOrtho",this.settings.isOrtho?1:0);const e=this.settings.viewAxis;if(this.settings.isOrtho&&e){const t=this.settings.bounds.bmax[e]-this.settings.bounds.bmin[e];this.setUniform("orthoThickness",t)}else this.setUniform("orthoThickness",1)}if(t&Qt.VIEW||Qt.BOUNDING_BOX,t&Qt.TRANSFORM&&(this.needRedraw=!0,this.geometryTransformNode.position.copy(this.settings.translation),this.geometryTransformNode.rotation.copy(this.settings.rotation),this.updateVolumeDimensions(),this.setUniform("flipVolume",this.settings.flipAxes)),Qt.MATERIAL,Qt.CAMERA,t&Qt.ROI){this.needRedraw=!0;const e=this.settings.bounds,{normRegionSize:t,normRegionOffset:n}=this.volume,r=t.clone().divideScalar(2).add(n).subScalar(.5),i=e.bmin.clone().sub(r).divide(t).clampScalar(-.5,.5),o=e.bmax.clone().sub(r).divide(t).clampScalar(-.5,.5);this.setUniform("AABB_CLIP_MIN",i),this.setUniform("AABB_CLIP_MAX",o)}if(t&Qt.SAMPLING){this.needRedraw=!0;const e=this.settings.resolution.clone(),t=window.devicePixelRatio?window.devicePixelRatio:1,n=Math.floor(e.x/t),r=Math.floor(e.y/t);this.setUniform("iResolution",new i.I9Y(n,r)),this.pickBuffer.setSize(n,r)}Qt.MASK_ALPHA,Qt.MASK_DATA}createGeometry(e){const t=new i.iNn(1,1,1),n=new i.BKk({uniforms:e,vertexShader:"// switch on high precision floats\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec3 pObj;\n\nvoid main() {\n  pObj = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n#ifdef GL_ES\nprecision highp float;\nprecision highp usampler2D;\n#endif\n\n#define M_PI 3.14159265358979323846\n\nuniform vec2 iResolution;\nuniform vec2 textureRes;\n\n//uniform float maskAlpha;\nuniform uvec2 ATLAS_DIMS;\nuniform vec3 AABB_CLIP_MIN;\nuniform float CLIP_NEAR;\nuniform vec3 AABB_CLIP_MAX;\nuniform float CLIP_FAR;\n// one raw channel atlas that has segmentation data\nuniform usampler2D textureAtlas;\n//uniform sampler2D textureAtlasMask;\nuniform sampler2D textureDepth;\nuniform int usingPositionTexture;\nuniform int BREAK_STEPS;\nuniform float SLICES;\nuniform float isOrtho;\nuniform float orthoThickness;\nuniform float orthoScale;\nuniform int maxProject;\nuniform vec3 flipVolume;\nuniform vec3 volumeScale;\n\n// view space to axis-aligned volume box\nuniform mat4 inverseModelViewMatrix;\nuniform mat4 inverseProjMatrix;\n\nvarying vec3 pObj;\n\nfloat powf(float a, float b) {\n  return pow(a,b);\n}\n\nfloat rand(vec2 co) {\n  float threadId = gl_FragCoord.x/(gl_FragCoord.y + 1.0);\n  float bigVal = threadId*1299721.0/911.0;\n  vec2 smallVal = vec2(threadId*7927.0/577.0, threadId*104743.0/1039.0);\n  return fract(sin(dot(co, smallVal)) * bigVal);\n}\n\n// get the uv offset into the atlas for the given z slice\n// ATLAS_DIMS is the number of z slices across the atlas texture\nvec2 offsetFrontBack(uint a) {\n  uint ax = ATLAS_DIMS.x;\n  vec2 tiles = vec2(1.0f/float(ATLAS_DIMS.x), 1.0f/float(ATLAS_DIMS.y));\n  vec2 os = vec2(float(a % ax), float(a / ax)) * tiles;\n  return clamp(os, vec2(0.0), vec2(1.0) - vec2(1.0) * tiles);\n}\n\nuint sampleAtlasNearest(usampler2D tex, vec4 pos) {\n  uint bounds = uint(pos[0] >= 0.0 && pos[0] <= 1.0 &&\n                       pos[1] >= 0.0 && pos[1] <= 1.0 &&\n                       pos[2] >= 0.0 && pos[2] <= 1.0 );\n  float nSlices = float(SLICES);\n\n  // ascii art of a texture atlas:\n  //  +------------------+\n  //  | 0  | 1  | 2  | 3 |\n  //  +------------------+\n  //  | 4  | 5  | 6  | 7 | \n  //  +------------------+\n  //  | 8  | 9  |10  |11 |\n  //  +------------------+\n  //  |12  |13  |14  |15 |\n  //  +------------------+\n  // Each tile is one z-slice of the 3D texture, which has been flattened\n  // into an atlased 2D texture.\n\n  // pos.xy is 0-1 range. Apply the xy flip here and then divide by number of tiles in x and y to normalize\n  // to a single tile. This results in a uv coordinate that's in the correct X and Y position but only for\n  // the first tile (z slice) of the atlas texture, z=0.\n  vec2 loc0 = ((pos.xy - 0.5) * flipVolume.xy + 0.5) / vec2(float(ATLAS_DIMS.x), float(ATLAS_DIMS.y));\n  \n  // Next, offset the UV coordinate so we are sampling in the correct Z slice.\n  // Round z to the nearest (floor) slice\n  float z = min(floor(pos.z * nSlices), nSlices-1.0);\n  // flip z coordinate if needed\n  if (flipVolume.z == -1.0) {\n    z = nSlices - z - 1.0;\n  }\n\n  // calculate the offset to the z slice in the atlas texture\n  vec2 o = offsetFrontBack(uint(z)) + loc0;\n  //uint voxelColor = texture2D(tex, o).x;\n  uint voxelColor = texelFetch(tex, ivec2(o * textureRes), 0).x;\n\n  // Apply mask\n  // float voxelMask = texture2D(textureAtlasMask, o).x;\n  // voxelMask = mix(voxelMask, 1.0, maskAlpha);\n  // voxelColor.rgb *= voxelMask;\n\n  return bounds*voxelColor;\n}\n\nbool intersectBox(in vec3 r_o, in vec3 r_d, in vec3 boxMin, in vec3 boxMax,\n                  out float tnear, out float tfar) {\n  // compute intersection of ray with all six bbox planes\n  vec3 invR = vec3(1.0,1.0,1.0) / r_d;\n  vec3 tbot = invR * (boxMin - r_o);\n  vec3 ttop = invR * (boxMax - r_o);\n\n  // re-order intersections to find smallest and largest on each axis\n  vec3 tmin = min(ttop, tbot);\n  vec3 tmax = max(ttop, tbot);\n\n  // find the largest tmin and the smallest tmax\n  float largest_tmin  = max(max(tmin.x, tmin.y), tmin.z);\n  float smallest_tmax = min(min(tmax.x, tmax.y), tmax.z);\n\n  tnear = largest_tmin;\n  tfar = smallest_tmax;\n\n  // use >= here?\n  return(smallest_tmax > largest_tmin);\n}\n\nvec4 integrateVolume(vec4 eye_o,vec4 eye_d,\n                     float tnear,   float tfar,\n                     float clipNear, float clipFar,\n                     usampler2D textureAtlas\n                     ) {\n  uint C = 0u;\n  // march along ray from front to back, accumulating color\n\n  // estimate step length\n  const int maxSteps = 512;\n  // modify the 3 components of eye_d by volume scale\n  float scaledSteps = float(BREAK_STEPS) * length((eye_d.xyz/volumeScale));\n  float csteps = clamp(float(scaledSteps), 1.0, float(maxSteps));\n  float invstep = (tfar-tnear)/csteps;\n  // Removed random ray dither to prevent artifacting\n  float r = 0.0; // (SLICES==1.0) ? 0.0 : rand(eye_d.xy);\n  // if ortho and clipped, make step size smaller so we still get same number of steps\n  float tstep = invstep*orthoThickness;\n  float tfarsurf = r*tstep;\n  float overflow = mod((tfarsurf - tfar),tstep); // random dithering offset\n  float t = tnear + overflow;\n  t += r*tstep; // random dithering offset\n  float tdist = 0.0;\n  int numSteps = 0;\n  vec4 pos, col;\n  for (int i = 0; i < maxSteps; i++) {\n    pos = eye_o + eye_d*t;\n    // !!! assume box bounds are -0.5 .. 0.5.  pos = (pos-min)/(max-min)\n    // scaling is handled by model transform and already accounted for before we get here.\n    // AABB clip is independent of this and is only used to determine tnear and tfar.\n    pos.xyz = (pos.xyz-(-0.5))/((0.5)-(-0.5)); //0.5 * (pos + 1.0); // map position from [boxMin, boxMax] to [0, 1] coordinates\n\n    uint col = sampleAtlasNearest(textureAtlas, pos);\n\n    // FOR INTERSECTION / PICKING, the FIRST nonzero intensity terminates the raymarch\n\n    if (maxProject != 0) {\n      C = max(col, C);\n    } else {\n      if (col > 0u) {\n        C = col;\n        break;\n      }\n    }\n    t += tstep;\n    numSteps = i;\n\n    if (t > tfar || t > tnear+clipFar ) break;\n  }\n\n  return vec4(float(C));\n}\n\nvoid main() {\n  gl_FragColor = vec4(0.0);\n  vec2 vUv = gl_FragCoord.xy/iResolution.xy;\n\n  vec3 eyeRay_o, eyeRay_d;\n\n  if (isOrtho == 0.0) {\n    // for perspective rays:\n    // world space camera coordinates\n    // transform to object space\n    eyeRay_o = (inverseModelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;\n    eyeRay_d = normalize(pObj - eyeRay_o);\n  } else {\n    // for ortho rays:\n    float zDist = 2.0;\n    eyeRay_d = (inverseModelViewMatrix*vec4(0.0, 0.0, -zDist, 0.0)).xyz;\n    vec4 ray_o = vec4(2.0*vUv - 1.0, 1.0, 1.0);\n    ray_o.xy *= orthoScale;\n    ray_o.x *= iResolution.x/iResolution.y;\n    eyeRay_o = (inverseModelViewMatrix*ray_o).xyz;\n  }\n\n  // -0.5..0.5 is full box. AABB_CLIP lets us clip to a box shaped ROI to look at\n  // I am applying it here at the earliest point so that the ray march does\n  // not waste steps.  For general shaped ROI, this has to be handled more\n  // generally (obviously)\n  vec3 boxMin = AABB_CLIP_MIN;\n  vec3 boxMax = AABB_CLIP_MAX;\n\n  float tnear, tfar;\n  bool hit = intersectBox(eyeRay_o, eyeRay_d, boxMin, boxMax, tnear, tfar);\n\n  if (!hit) {\n    // return background color if ray misses the cube\n    // is this safe to do when there is other geometry / gObjects drawn?\n    gl_FragColor = vec4(0.0); //C1;//vec4(0.0);\n    return;\n  }\n\n  float clipNear = 0.0;//-(dot(eyeRay_o.xyz, eyeNorm) + dNear) / dot(eyeRay_d.xyz, eyeNorm);\n  float clipFar  = 10000.0;//-(dot(eyeRay_o.xyz,-eyeNorm) + dFar ) / dot(eyeRay_d.xyz,-eyeNorm);\n\n  // Sample the depth/position texture\n  // If this is a depth texture, the r component is a depth value. If this is a position texture,\n  // the xyz components are a view space position and w is 1.0 iff there's a mesh at this fragment.\n  vec4 meshPosSample = texture2D(textureDepth, vUv);\n  // Note: we make a different check for whether a mesh is present with depth vs. position textures.\n  // Here's the check for depth textures:\n  bool hasDepthValue = usingPositionTexture == 0 && meshPosSample.r < 1.0;\n\n  // If there's a depth-contributing mesh at this fragment, we may need to terminate the ray early\n  if (hasDepthValue || (usingPositionTexture == 1 && meshPosSample.a > 0.0)) {\n    if (hasDepthValue) {\n      // We're working with a depth value, so we need to convert back to view space position\n      // Get a projection space position from depth and uv, and unproject back to view space\n      vec4 meshProj = vec4(vUv * 2.0 - 1.0, meshPosSample.r * 2.0 - 1.0, 1.0);\n      vec4 meshView = inverseProjMatrix * meshProj;\n      meshPosSample = vec4(meshView.xyz / meshView.w, 1.0);\n    }\n    // Transform the mesh position to object space\n    vec4 meshObj = inverseModelViewMatrix * meshPosSample;\n\n    // Derive a t value for the mesh intersection\n    // NOTE: divides by 0 when `eyeRay_d.z` is 0. Could be mitigated by picking another component\n    //   to derive with when z is 0, but I found this was rare enough in practice to be acceptable.\n    float tMesh = (meshObj.z - eyeRay_o.z) / eyeRay_d.z;\n    if (tMesh < tfar) {\n      clipFar = tMesh - tnear;\n    }\n  }\n\n  vec4 C = integrateVolume(vec4(eyeRay_o,1.0), vec4(eyeRay_d,0.0),\n                          tnear,    tfar, //intersections of box\n                          clipNear, clipFar,\n                          textureAtlas);\n\n  gl_FragColor = C;\n  return;\n}\n",depthTest:!0,depthWrite:!1}),r=new i.eaF(t,n);return r.name="PickVolume",[t,r]}cleanup(){this.scene.clear(),this.geometryTransformNode.clear(),this.geometry.dispose(),this.geometryMesh.material.dispose()}doRender(e,t,n){if(!this.geometryMesh.visible)return;if(!this.needRedraw)return;this.needRedraw=!1,this.setUniform("iResolution",this.settings.resolution);const r=n??this.emptyPositionTex;this.setUniform("textureDepth",r),this.setUniform("usingPositionTexture",r.isDepthTexture?0:1),this.setUniform("CLIP_NEAR",t.near),this.setUniform("CLIP_FAR",t.far);const o=this.volume.getChannel(this.channelToPick).dataTexture;this.setUniform("textureAtlas",o),this.setUniform("textureRes",new i.I9Y(o.image.width,o.image.height)),this.geometryTransformNode.updateMatrixWorld(!0);const a=new i.kn4;a.multiplyMatrices(t.matrixWorldInverse,this.geometryMesh.matrixWorld),a.invert(),this.setUniform("inverseModelViewMatrix",a),this.setUniform("inverseProjMatrix",t.projectionMatrixInverse),t.layers.set(0),e.setRenderTarget(this.pickBuffer),e.autoClear=!0;const s=new i.Q1f;e.getClearColor(s);const l=e.getClearAlpha();e.setClearColor(0,0),e.render(this.scene,t),e.autoClear=!0,e.setClearColor(s,l),e.setRenderTarget(null)}get3dObject(){return this.geometryTransformNode}setUniform(e,t){this.uniforms[e]&&(this.uniforms[e].value=t)}updateActiveChannels(e,t){}setRenderUpdateListener(e){}}const Ar=new i.Q1f(16776960);class Mr{sliceUpdateWaiting=!1;constructor(e,t=new en(e)){this.volume=e,this.uniforms={iResolution:{type:"v2",value:new i.I9Y(100,100)},CLIP_NEAR:{type:"f",value:0},CLIP_FAR:{type:"f",value:1e4},maskAlpha:{type:"f",value:1},BRIGHTNESS:{type:"f",value:0},DENSITY:{type:"f",value:1},GAMMA_MIN:{type:"f",value:0},GAMMA_MAX:{type:"f",value:1},GAMMA_SCALE:{type:"f",value:1},BREAK_STEPS:{type:"i",value:128},ATLAS_DIMS:{type:"v2",value:new i.I9Y(6,6)},Z_SLICE:{type:"i",value:0},SLICES:{type:"f",value:50},isOrtho:{type:"f",value:0},orthoThickness:{type:"f",value:1},orthoScale:{type:"f",value:.5},AABB_CLIP_MIN:{type:"v3",value:new i.Pq0(-.5,-.5,-.5)},AABB_CLIP_MAX:{type:"v3",value:new i.Pq0(.5,.5,.5)},inverseModelViewMatrix:{type:"m4",value:new i.kn4},textureAtlas:{type:"t",value:new i.gPd},textureAtlasMask:{type:"t",value:new i.gPd},maxProject:{type:"i",value:0},interpolationEnabled:{type:"b",value:!0},flipVolume:{type:"v3",value:new i.Pq0(1,1,1)},volumeScale:{type:"v3",value:new i.Pq0(1,1,1)},textureRes:{type:"v2",value:new i.I9Y(1,1)}},[this.geometry,this.geometryMesh]=this.createGeometry(this.uniforms),this.boxHelper=new i.BND(new i.NRn(new i.Pq0(-.5,-.5,-.5),new i.Pq0(.5,.5,.5)),Ar),this.boxHelper.updateMatrixWorld(),this.boxHelper.visible=!1,this.geometryTransformNode=new i.YJl,this.geometryTransformNode.name="VolumeContainerNode",this.geometryTransformNode.add(this.boxHelper,this.geometryMesh),this.setUniform("Z_SLICE",Math.floor(e.imageInfo.volumeSize.z/2)),this.settings=t,this.updateVolumeDimensions(),this.updateSettings(t,Qt.ALL)}updateSlice(){const e=Math.floor(this.settings.zSlice),t=this.volume.imageInfo.volumeSize.z;if(e<0||e>=t)return!1;const n=this.volume.imageInfo.subregionOffset.z,r=n+this.volume.imageInfo.subregionSize.z;return e<n||e>=r?this.sliceUpdateWaiting=!0:(this.setUniform("Z_SLICE",e),this.sliceUpdateWaiting=!1),!0}updateVolumeDimensions(){const e=this.volume.normPhysicalSize.clone().multiply(this.settings.scale),t=e.clone().multiply(this.volume.normRegionSize),n=this.volume.getContentCenter().clone().multiply(this.settings.scale);this.geometryMesh.position.copy(n),this.geometryMesh.scale.copy(t),this.setUniform("volumeScale",t),this.boxHelper.box.set(e.clone().multiplyScalar(-.5),e.clone().multiplyScalar(.5));const{atlasTileDims:r,subregionSize:o,volumeSize:a}=this.volume.imageInfo,s=new i.I9Y(o.x,o.y).multiply(r);this.setUniform("ATLAS_DIMS",r),this.setUniform("textureRes",s),this.setUniform("SLICES",a.z),this.sliceUpdateWaiting&&this.updateSlice(),this.channelData&&this.channelData.width===s.x&&this.channelData.height===s.y||(this.channelData?.cleanup(),this.channelData=new ir(s.x,s.y))}updateSettings(e,t){if(void 0===t&&(t=Qt.ALL),this.settings=e,t&Qt.VIEW){this.geometryMesh.visible=this.settings.visible,this.setUniform("orthoScale",this.settings.orthoScale),this.setUniform("isOrtho",this.settings.isOrtho?1:0);const e=this.settings.viewAxis;if(this.settings.isOrtho&&null!==e){const t=this.settings.bounds.bmax[e]-this.settings.bounds.bmin[e];this.setUniform("orthoThickness",t)}else this.setUniform("orthoThickness",1)}if(t&Qt.BOUNDING_BOX){this.boxHelper.visible=this.settings.showBoundingBox;const e=this.settings.boundingBoxColor,t=new i.Q1f(e[0],e[1],e[2]);this.boxHelper.material.color=t}if(t&Qt.TRANSFORM&&(this.geometryTransformNode.position.copy(this.settings.translation),this.geometryTransformNode.rotation.copy(this.settings.rotation),this.setUniform("flipVolume",this.settings.flipAxes)),t&Qt.MATERIAL&&this.setUniform("DENSITY",this.settings.density),t&Qt.CAMERA&&(this.setUniform("BRIGHTNESS",2*this.settings.brightness),this.setUniform("GAMMA_MIN",this.settings.gammaMin),this.setUniform("GAMMA_MAX",this.settings.gammaMax),this.setUniform("GAMMA_SCALE",this.settings.gammaLevel)),t&Qt.ROI){const e=this.settings.bounds,{normRegionSize:t,normRegionOffset:n}=this.volume,r=t.clone().divideScalar(2).add(n).subScalar(.5),o=e.bmin.clone().sub(r).divide(t).clampScalar(-.5,.5),a=e.bmax.clone().sub(r).divide(t).clampScalar(-.5,.5);if(this.setUniform("AABB_CLIP_MIN",o),this.setUniform("AABB_CLIP_MAX",a),this.updateSlice()){const e=Math.floor(this.settings.zSlice)/this.volume.imageInfo.volumeSize.z,t=(Math.floor(this.settings.zSlice)+1)/this.volume.imageInfo.volumeSize.z;this.volume.updateRequiredData({subregion:new i.NRn(new i.Pq0(0,0,e),new i.Pq0(1,1,t))})}}t&Qt.SAMPLING&&(this.setUniform("interpolationEnabled",this.settings.useInterpolation),this.setUniform("iResolution",this.settings.resolution)),t&Qt.MASK_ALPHA&&this.setUniform("maskAlpha",this.settings.maskChannelIndex<0?1:this.settings.maskAlpha),t&Qt.MASK_DATA&&this.channelData.setChannelAsMask(this.settings.maskChannelIndex,this.volume.getChannel(this.settings.maskChannelIndex))}createGeometry(e){const t=new i.bdM(1,1),n=new i.eaF(t);n.name="Plane";const r=new i.BKk({uniforms:e,vertexShader:"precision highp float;\nprecision highp int;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix *\n    modelViewMatrix *\n    vec4(position, 1.0);\n}\n",fragmentShader:"\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform vec2 textureRes;\nuniform float GAMMA_MIN;\nuniform float GAMMA_MAX;\nuniform float GAMMA_SCALE;\nuniform float BRIGHTNESS;\nuniform float DENSITY;\nuniform float maskAlpha;\nuniform vec2 ATLAS_DIMS;\nuniform vec3 AABB_CLIP_MIN;\nuniform vec3 AABB_CLIP_MAX;\nuniform sampler2D textureAtlas;\nuniform sampler2D textureAtlasMask;\nuniform int Z_SLICE;\nuniform float SLICES;\nuniform bool interpolationEnabled;\nuniform vec3 flipVolume;\n\nvarying vec2 vUv;\n\n// for atlased texture, we need to find the uv offset for the slice at t\nvec2 offsetFrontBack(float t) {\n  int a = int(t);\n  int ax = int(ATLAS_DIMS.x);\n  vec2 os = vec2(float(a - (a / ax) * ax), float(a / ax)) / ATLAS_DIMS;\n  return clamp(os, vec2(0.0), vec2(1.0) - vec2(1.0) / ATLAS_DIMS);\n}\n\nvec4 sampleAtlas(sampler2D tex, vec4 pos) {\n  float bounds = float(pos[0] >= 0.0 && pos[0] <= 1.0 &&\n    pos[1] >= 0.0 && pos[1] <= 1.0 &&\n    pos[2] >= 0.0 && pos[2] <= 1.0);\n\n  float nSlices = float(SLICES);\n\n  vec2 loc0 = ((pos.xy - 0.5) * flipVolume.xy + 0.5) / ATLAS_DIMS;\n\n\n  if (interpolationEnabled) {\n    // loc ranges from 0 to 1/ATLAS_DIMS\n    // shrink loc0 to within one half edge texel - so as not to sample across edges of tiles.\n    loc0 = loc0 * (vec2(1.0) - ATLAS_DIMS / textureRes);\n  }\n  else {\n    // No interpolation - sample just one slice at a pixel center.\n    loc0 = floor(loc0 * textureRes) / textureRes;\n  }\n  loc0 += vec2(0.5) / textureRes;\n\n  float z = min(floor(pos.z * nSlices), nSlices - 1.0);\n\n  if(flipVolume.z == -1.0) {\n    z = nSlices - z - 1.0;\n  }\n\n  vec2 o = offsetFrontBack(z) + loc0;\n  vec4 voxelColor = texture2D(tex, o);\n\n  // Apply mask\n  float voxelMask = texture2D(textureAtlasMask, o).x;\n  voxelMask = mix(voxelMask, 1.0, maskAlpha);\n  voxelColor.rgb *= voxelMask;\n\n  return bounds * voxelColor;\n}\n\nvoid main() {\n  gl_FragColor = vec4(0.0);\n\n  vec3 boxMin = AABB_CLIP_MIN;\n  vec3 boxMax = AABB_CLIP_MAX;\n  // Normalize UV for [-0.5, 0.5] range\n  vec2 normUv = vUv - vec2(0.5);\n\n  // Return background color if outside of clipping box\n  if(normUv.x < boxMin.x || normUv.x > boxMax.x || normUv.y < boxMin.y || normUv.y > boxMax.y) {\n    gl_FragColor = vec4(0.0);\n    return;\n  }\n\n  // Normalize z-slice by total slices\n  vec4 pos = vec4(vUv, \n    (SLICES==1.0 && Z_SLICE==0) ? 0.0 : float(Z_SLICE) / (SLICES - 1.0), \n    0.0);\n\n  vec4 C;\n  C = sampleAtlas(textureAtlas, pos);\n  C.xyz *= BRIGHTNESS;\n\n  C = clamp(C, 0.0, 1.0);\n  gl_FragColor = C;\n  return;\n}",transparent:!0,depthTest:!0,depthWrite:!1});return n.material=r,[t,n]}cleanup(){this.geometry.dispose(),this.geometryMesh.material.dispose(),this.channelData.cleanup()}viewpointMoved(){}doRender(e,t){if(!this.geometryMesh.visible)return;this.channelData.gpuFuse(e),this.setUniform("textureAtlas",this.channelData.getFusedTexture()),this.setUniform("textureAtlasMask",this.channelData.maskTexture),this.geometryTransformNode.updateMatrixWorld(!0);const n=new i.kn4;n.multiplyMatrices(t.matrixWorldInverse,this.geometryMesh.matrixWorld);const r=new i.kn4;r.copy(n).invert(),this.setUniform("inverseModelViewMatrix",r)}get3dObject(){return this.geometryTransformNode}updateActiveChannels(e,t){this.channelData.fuse(e,t),this.setUniform("textureAtlas",this.channelData.getFusedTexture()),this.setUniform("textureAtlasMask",this.channelData.maskTexture)}setUniform(e,t){this.uniforms[e]&&(this.uniforms[e].value=t)}setRenderUpdateListener(e){}}Math.PI,Math.PI;class Tr{constructor(){this.pass=new gn("precision highp float;\nprecision highp int;\nprecision highp usampler2D;\nprecision highp sampler3D;\n\n/**\n * LUT mapping from the segmentation ID (raw pixel value) to the\n * global ID (index in data buffers like `featureData` and `outlierData`).\n * \n * For a given local pixel ID `localId`, the global ID is given by:\n * `localIdToGlobalId[localId - localIdOffset] - 1`.\n*/\nuniform usampler2D localIdToGlobalId;\nuniform uint localIdOffset;\nuniform bool useGlobalIdLookup;\n/* Pick buffer. Used to determine IDs. */\nuniform sampler2D pickBuffer;\n\nuniform int highlightedId;\nuniform int outlineThickness;\nuniform float outlineAlpha;\nuniform vec3 outlineColor;\nuniform float devicePixelRatio;\n\nconst uint BACKGROUND_ID = 0u;\nconst uint MISSING_DATA_ID = 0xFFFFFFFFu;\nconst int ID_OFFSET = 1;\n\nuvec4 getUintFromTex(usampler2D tex, int index) {\n  int width = textureSize(tex, 0).x;\n  ivec2 featurePos = ivec2(index % width, index / width);\n  return uvec4(texelFetch(tex, featurePos, 0));\n}\n\nuint getId(ivec2 uv) {\n  float rawId = texelFetch(pickBuffer, uv, 0).g;\n  if (rawId == 0.0) {\n    return BACKGROUND_ID;\n  }\n  int localId = int(rawId) - int(localIdOffset);\n  if (!useGlobalIdLookup) {\n    return uint(localId + ID_OFFSET);\n  }\n  uvec4 c = getUintFromTex(localIdToGlobalId, localId);\n  // Note: IDs are offset by `ID_OFFSET` (`=1`) to reserve `0` for local IDs\n  // that don't have associated data in the global lookup. `ID_OFFSET` MUST be\n  // subtracted from the ID when accessing data buffers.\n  uint globalId = c.r;\n  if (globalId == 0u) {\n    return MISSING_DATA_ID;\n  }\n  return globalId;\n}\n\nbool isEdge(ivec2 uv, int id, int thickness) {\n  float wStep = 1.0;\n  float hStep = 1.0;\n  float thicknessFloat = float(thickness);\n  // sample around the pixel to see if we are on an edge\n  int R = int(getId(uv + ivec2(thicknessFloat * wStep, 0))) - ID_OFFSET;\n  int L = int(getId(uv + ivec2(-thicknessFloat * wStep, 0))) - ID_OFFSET;\n  int T = int(getId(uv + ivec2(0, thicknessFloat * hStep))) - ID_OFFSET;\n  int B = int(getId(uv + ivec2(0, -thicknessFloat * hStep))) - ID_OFFSET;\n  // if any neighbors are not id then this is an edge\n  return id != -1 && (R != id || L != id || T != id || B != id);\n}\n\nvoid main(void) {\n  ivec2 vUv = ivec2(int(gl_FragCoord.x / devicePixelRatio), int(gl_FragCoord.y / devicePixelRatio));\n\n  uint rawId = getId(vUv);\n  int id = int(rawId) - ID_OFFSET;\n\n  if (id == highlightedId && isEdge(vUv, id, outlineThickness)) {\n    gl_FragColor = vec4(outlineColor, outlineAlpha);\n  } else {\n    gl_FragColor = vec4(0, 0, 0, 0.0);\n  }\n}",(()=>{const e=new i.GYF(new Float32Array([1,0,0,0]),1,1,i.GWd,i.RQf),t=new i.GYF(new Uint32Array([0]),1,1,i.ZQM,i.bkx);return t.needsUpdate=!0,{pickBuffer:new i.nc$(e),highlightedId:new i.nc$(94),outlineThickness:new i.nc$(2),outlineColor:new i.nc$(new i.Q1f(1,0,1)),outlineAlpha:new i.nc$(1),useGlobalIdLookup:new i.nc$(!1),localIdToGlobalId:new i.nc$(t),localIdOffset:new i.nc$(0),devicePixelRatio:new i.nc$(1)}})(),mn.TRANSPARENT),this.frameToGlobalIdLookup=null,this.frame=0}setOutlineColor(e,t=1){var n,r,i;this.pass.material.uniforms.outlineColor.value=e,this.pass.material.uniforms.outlineAlpha.value=(n=t,r=0,i=1,Math.max(r,Math.min(i,n)))}setOutlineThickness(e){this.pass.material.uniforms.outlineThickness.value=Math.floor(e)}syncGlobalIdLookup(){const e=this.pass.material.uniforms,t=this.frameToGlobalIdLookup?.get(this.frame);t?(e.useGlobalIdLookup.value=!0,e.localIdToGlobalId.value=t.texture,e.localIdOffset.value=t.minSegId):e.useGlobalIdLookup.value=!1}setGlobalIdLookup(e){this.frameToGlobalIdLookup!==e&&(this.frameToGlobalIdLookup=e,this.syncGlobalIdLookup())}setFrame(e){this.frame!==e&&(this.frame=e,this.syncGlobalIdLookup())}setHighlightedId(e){this.pass.material.uniforms.highlightedId.value=e}render(e,t,n){const r=this.pass.material.uniforms;r.devicePixelRatio.value=window.devicePixelRatio,r.pickBuffer.value=n.texture;const i=e.autoClear;e.autoClear=!1,this.pass.render(e,t??void 0),e.autoClear=i}}class Cr{constructor(e,t){switch(this.volume=e,this.settings=new en(e),this.onChannelDataReadyCallback=void 0,this.viewMode=Jt.NONE,this.channelColors=this.volume.channelColorsDefault.slice(),this.channelOptions=new Array(this.volume.imageInfo.numChannels).fill({}),this.fusion=this.channelColors.map(((e,t)=>{let n;return n=0===e[0]&&0===e[1]&&0===e[2]?0:[e[0],e[1],e[2]],{chIndex:t,lut:new Uint8Array(yr),rgbColor:n,selectedID:-1}})),this.sceneRoot=new i.B69,this.childObjectsGroup=new i.YJl,this.childObjects=new Set,this.sceneRoot.add(this.childObjectsGroup),t.renderMode=t.renderMode||Wt.RAYMARCH,t.renderMode){case Wt.PATHTRACE:this.renderMode=Wt.PATHTRACE,this.volumeRendering=new Sr(this.volume,this.settings);break;case Wt.SLICE:case Wt.RAYMARCH:default:this.renderMode=Wt.RAYMARCH,this.volumeRendering=new ar(this.volume,this.settings)}this.pickRendering&&(this.pickRendering=new Er(this.volume,this.settings)),this.contourRendering=new Tr,this.meshVolume=new rr(this.volume),t.renderMode!==Wt.RAYMARCH&&t.renderMode!==Wt.SLICE||(this.childObjectsGroup.add(this.meshVolume.get3dObject()),this.childObjects.add(this.meshVolume)),this.sceneRoot.add(this.volumeRendering.get3dObject()),this.sceneRoot.position.set(0,0,0),this.updateScale(),this.settings.translation=(new i.Pq0).fromArray(this.volume.getTranslation()),this.settings.rotation=(new i.O9p).fromArray(this.volume.getRotation()),this.setOptions(t)}getPickBuffer(){return this.pickRendering?.getPickBuffer()}updateChannelDataRequired(e){const{enabled:t,isosurfaceEnabled:n}=this.channelOptions[e],r=t||n||e===this.settings.maskChannelIndex,i=this.volume.loadSpecRequired.channels;i.includes(e)?r||this.volume.updateRequiredData({channels:i.filter((t=>t!==e))}):r&&this.volume.updateRequiredData({channels:[...i,e]})}setOptions(e){void 0!==(e=e||{}).maskChannelIndex&&this.setChannelAsMask(e.maskChannelIndex),void 0!==e.maskAlpha&&this.setMaskAlpha(e.maskAlpha),void 0!==e.clipBounds&&(this.settings.bounds={bmin:new i.Pq0(e.clipBounds[0],e.clipBounds[2],e.clipBounds[4]),bmax:new i.Pq0(e.clipBounds[1],e.clipBounds[3],e.clipBounds[5])},this.setAxisClip(Jt.X,e.clipBounds[0],e.clipBounds[1]),this.setAxisClip(Jt.Y,e.clipBounds[2],e.clipBounds[3]),this.setAxisClip(Jt.Z,e.clipBounds[4],e.clipBounds[5])),void 0!==e.translation&&this.setTranslation((new i.Pq0).fromArray(e.translation)),void 0!==e.rotation&&this.setRotation((new i.O9p).fromArray(e.rotation)),void 0!==e.renderMode&&this.setVolumeRendering(e.renderMode),void 0===e.primaryRayStepSize&&void 0===e.secondaryRayStepSize||this.setRayStepSizes(e.primaryRayStepSize,e.secondaryRayStepSize),void 0!==e.showBoundingBox&&this.setShowBoundingBox(e.showBoundingBox),void 0!==e.boundingBoxColor&&this.setBoundingBoxColor(e.boundingBoxColor),void 0!==e.channels&&(this.channelOptions=e.channels,this.channelOptions.forEach(((e,t)=>{this.setChannelOptions(t,e)})))}setChannelOptions(e,t){if(this.channelOptions[e]=Object.assign(this.channelOptions[e],t),void 0!==t.enabled&&this.setVolumeChannelEnabled(e,t.enabled),void 0!==t.color&&this.updateChannelColor(e,t.color),void 0!==t.isosurfaceEnabled){const n=this.hasIsosurface(e);if(n!==t.isosurfaceEnabled){if(n&&!t.isosurfaceEnabled)this.meshVolume.destroyIsosurface(e);else if(!n&&t.isosurfaceEnabled&&this.volume.channels[e].loaded){const{isovalue:n,isosurfaceOpacity:r}=t;this.meshVolume.createIsosurface(e,this.channelColors[e],n,r)}this.updateChannelDataRequired(e)}else t.isosurfaceEnabled&&(void 0!==t.isovalue&&this.meshVolume.updateIsovalue(e,t.isovalue),void 0!==t.isosurfaceOpacity&&this.meshVolume.updateOpacity(e,t.isosurfaceOpacity))}else void 0!==t.isovalue&&this.meshVolume.updateIsovalue(e,t.isovalue),void 0!==t.isosurfaceOpacity&&this.meshVolume.updateOpacity(e,t.isosurfaceOpacity)}setRayStepSizes(e,t){e===this.settings.primaryRayStepSize&&t===this.settings.secondaryRayStepSize||(void 0!==e&&(this.settings.primaryRayStepSize=e),void 0!==t&&(this.settings.secondaryRayStepSize=t),this.volumeRendering.updateSettings(this.settings,Qt.SAMPLING),this.pickRendering?.updateSettings(this.settings,Qt.SAMPLING))}updateScale(){const{normPhysicalSize:e,normRegionSize:t}=this.volume,n=e.clone().multiply(t).multiply(this.settings.scale);this.childObjectsGroup.scale.copy(n),this.childObjectsGroup.position.copy(this.volume.getContentCenter().multiply(this.settings.scale)),this.volumeRendering.updateVolumeDimensions(),this.volumeRendering.updateSettings(this.settings,Qt.TRANSFORM),this.pickRendering?.updateVolumeDimensions(),this.pickRendering?.updateSettings(this.settings,Qt.TRANSFORM)}setOrthoScale(e){this.settings.orthoScale!==e&&(this.settings.orthoScale=e,this.volumeRendering.updateSettings(this.settings,Qt.VIEW),this.pickRendering?.updateSettings(this.settings,Qt.VIEW))}setResolution(e,t){const n=new i.I9Y(e,t);if(!this.settings.resolution.equals(n)){for(const n of this.childObjects)n.setResolution(e,t);this.settings.resolution=n,this.volumeRendering.updateSettings(this.settings,Qt.SAMPLING),this.pickRendering?.updateSettings(this.settings,Qt.SAMPLING)}}setAxisClip(e,t,n,r){if(this.settings.bounds.bmax[e]!==n||this.settings.bounds.bmin[e]!==t||this.settings.viewAxis!==e||this.settings.isOrtho!==(r||!1)){if(this.settings.bounds.bmax[e]=n,this.settings.bounds.bmin[e]=t,this.settings.viewAxis=e,this.settings.isOrtho=r||!1,e!==Jt.NONE&&this.renderMode!==Wt.PATHTRACE)for(const i of this.childObjects)i.setAxisClip(e,t,n,!!r);this.volumeRendering.updateSettings(this.settings,Qt.ROI|Qt.VIEW),this.pickRendering?.updateSettings(this.settings,Qt.ROI|Qt.VIEW)}}modeStringToAxis(e){return{X:Jt.X,YZ:Jt.X,Y:Jt.Y,XZ:Jt.Y,Z:Jt.Z,XY:Jt.Z}[e]||Jt.NONE}setViewMode(e,t){const n=this.modeStringToAxis(e);this.viewMode=n,n===Jt.Z?this.renderMode!==Wt.RAYMARCH&&this.renderMode!==Wt.PATHTRACE||this.setVolumeRendering(Wt.SLICE):this.renderMode===Wt.SLICE&&this.setVolumeRendering(t),this.settings.viewAxis!==n&&(this.settings.viewAxis=n,this.volumeRendering.updateSettings(this.settings,Qt.VIEW),this.pickRendering?.updateSettings(this.settings,Qt.VIEW))}setIsOrtho(e){this.settings.isOrtho!==e&&(this.settings.isOrtho=e,this.volumeRendering.updateSettings(this.settings,Qt.VIEW),this.pickRendering?.updateSettings(this.settings,Qt.VIEW))}setInterpolationEnabled(e){this.settings.useInterpolation!==e&&(this.settings.useInterpolation=e,this.volumeRendering.updateSettings(this.settings,Qt.SAMPLING),this.pickRendering?.updateSettings(this.settings,Qt.SAMPLING))}setOrthoThickness(e){if(this.renderMode!==Wt.PATHTRACE)for(const t of this.childObjects)t.setOrthoThickness(e)}setGamma(e,t,n){this.settings.gammaMin===e&&this.settings.gammaLevel===t&&this.settings.gammaMax===n||(this.settings.gammaMin=e,this.settings.gammaLevel=t,this.settings.gammaMax=n,this.volumeRendering.updateSettings(this.settings,Qt.CAMERA),this.pickRendering?.updateSettings(this.settings,Qt.CAMERA))}setFlipAxes(e,t,n){const r=new i.Pq0(e,t,n);if(!this.settings.flipAxes.equals(r)){this.settings.flipAxes=r;for(const r of this.childObjects)r.setFlipAxes(e,t,n);this.volumeRendering.updateSettings(this.settings,Qt.TRANSFORM),this.pickRendering?.updateSettings(this.settings,Qt.TRANSFORM)}}setMaxProjectMode(e){this.settings.maxProjectMode!==e&&(this.settings.maxProjectMode=e,this.volumeRendering.updateSettings(this.settings,Qt.VIEW),this.pickRendering?.updateSettings(this.settings,Qt.VIEW))}onAnimate(e,t,n){if(t.updateMatrixWorld(!0),t.matrixWorldInverse.copy(t.matrixWorld).invert(),this.volumeRendering.doRender(e,t,n),this.renderMode!==Wt.PATHTRACE)for(const e of this.childObjects)e.doRender()}enablePicking(e,t){e?(this.pickRendering||(this.pickRendering=new Er(this.volume,this.settings)),this.pickRendering.setChannelToPick(t)):(this.pickRendering?.cleanup(),this.pickRendering=void 0)}fillPickBuffer(e,t,n){this.pickRendering?.doRender(e,t,n)}drawContours(e){this.pickRendering&&this.contourRendering&&this.contourRendering.render(e,e.getRenderTarget(),this.pickRendering.getPickBuffer())}getViewMode(){return this.viewMode}getIsovalue(e){return this.meshVolume.getIsovalue(e)}hasIsosurface(e){return this.meshVolume.hasIsosurface(e)}setSelectedID(e,t){return this.contourRendering.setHighlightedId(t),this.fusion.length>0&&t!==this.fusion[e].selectedID&&(this.fusion[e].selectedID=t,!0)}fuse(){if(this.volume&&(this.volumeRendering.updateActiveChannels(this.fusion,this.volume.channels),this.pickRendering)){const e=this.pickRendering.getChannelToPick(),t=this.volume.channels[e];t&&this.contourRendering.setFrame(t.frame)}}setRenderUpdateListener(e){this.renderUpdateListener=e,this.renderMode===Wt.PATHTRACE&&this.volumeRendering.setRenderUpdateListener(e)}updateShadingMethod(e){this.renderMode===Wt.PATHTRACE&&this.volumeRendering.updateShadingMethod(e?1:0)}updateMaterial(){this.volumeRendering.updateActiveChannels(this.fusion,this.volume.channels),this.volumeRendering.updateSettings(this.settings,Qt.MATERIAL),this.pickRendering?.updateActiveChannels(this.fusion,this.volume.channels),this.pickRendering?.updateSettings(this.settings,Qt.MATERIAL)}updateLuts(){this.volumeRendering.updateActiveChannels(this.fusion,this.volume.channels),this.volumeRendering.updateSettings(this.settings,Qt.MATERIAL),this.pickRendering?.updateActiveChannels(this.fusion,this.volume.channels),this.pickRendering?.updateSettings(this.settings,Qt.MATERIAL)}setVoxelSize(e){this.volume.setVoxelSize(e),this.updateScale()}cleanup(){for(const e of this.childObjects)e.cleanup();this.volumeRendering.cleanup(),this.pickRendering?.cleanup()}getChannel(e){return this.volume.getChannel(e)}onChannelLoaded(e){for(let t=0;t<e.length;++t){const n=e[t],r=this.channelOptions[n];if(this.setChannelOptions(n,r),r.isosurfaceEnabled){this.meshVolume.destroyIsosurface(n);const{isovalue:e,isosurfaceOpacity:t}=r;this.meshVolume.createIsosurface(n,this.channelColors[n],e,t)}}this.onChannelDataReadyCallback?.()}onChannelAdded(e){this.channelColors[e]=this.volume.channelColorsDefault[e],this.fusion[e]={chIndex:e,lut:new Uint8Array[yr],rgbColor:[this.channelColors[e][0],this.channelColors[e][1],this.channelColors[e][2]],selectedID:-1},this.settings.diffuse[e]=[this.channelColors[e][0],this.channelColors[e][1],this.channelColors[e][2]],this.settings.specular[e]=[0,0,0],this.settings.emissive[e]=[0,0,0],this.settings.glossiness[e]=0}saveChannelIsosurface(e,t){this.meshVolume.saveChannelIsosurface(e,t,this.volume.name)}setVolumeChannelEnabled(e,t){this.fusion[e].rgbColor=t?this.channelColors[e]:0,this.settings.visible=!this.fusion.every((e=>0===e.rgbColor)),this.volumeRendering.updateSettings(this.settings,Qt.VIEW),this.pickRendering?.updateSettings(this.settings,Qt.VIEW),this.updateChannelDataRequired(e)}isVolumeChannelEnabled(e){return 0!==this.fusion[e].rgbColor}updateChannelColor(e,t){this.channelColors[e]&&(this.channelColors[e]=t,this.settings.diffuse[e]=t,0!==this.fusion[e].rgbColor&&(this.fusion[e].rgbColor=t),this.meshVolume.updateMeshColors(this.channelColors))}updateMeshColors(){this.meshVolume.updateMeshColors(this.channelColors)}getChannelColor(e){return this.channelColors[e]}updateChannelMaterial(e,t,n,r,i){this.channelColors[e]&&(this.updateChannelColor(e,t),this.settings.diffuse[e]=t,this.settings.specular[e]=n,this.settings.emissive[e]=r,this.settings.glossiness[e]=i)}setDensity(e){this.settings.density=e,this.volumeRendering.updateSettings(this.settings,Qt.MATERIAL),this.pickRendering?.updateSettings(this.settings,Qt.MATERIAL)}getDensity(){return this.settings.density}setBrightness(e){this.settings.brightness=e,this.volumeRendering.updateSettings(this.settings,Qt.CAMERA),this.pickRendering?.updateSettings(this.settings,Qt.CAMERA)}getBrightness(){return this.settings.brightness}setChannelAsMask(e){this.volume.channels[e]&&this.volume.channels[e].loaded&&(this.settings.maskChannelIndex=e,this.updateChannelDataRequired(e),this.volumeRendering.updateSettings(this.settings,Qt.MASK_DATA),this.pickRendering?.updateSettings(this.settings,Qt.MASK_DATA))}setChannelColorizeFeature(e,t){t?(this.fusion[e].feature=t,this.contourRendering.setOutlineColor(t.outlineColor,t.outlineAlpha),this.contourRendering.setGlobalIdLookup(t.frameToGlobalIdLookup)):(this.fusion[e].feature=void 0,this.contourRendering.setGlobalIdLookup(null)),this.volumeRendering.updateSettings(this.settings,Qt.MATERIAL),this.pickRendering?.updateSettings(this.settings,Qt.MATERIAL)}setMaskAlpha(e){this.settings.maskAlpha=e,this.volumeRendering.updateSettings(this.settings,Qt.MASK_ALPHA),this.pickRendering?.updateSettings(this.settings,Qt.MASK_ALPHA)}setShowBoundingBox(e){this.settings.showBoundingBox=e,this.volumeRendering.updateSettings(this.settings,Qt.BOUNDING_BOX),this.pickRendering?.updateSettings(this.settings,Qt.BOUNDING_BOX)}setBoundingBoxColor(e){this.settings.boundingBoxColor=e,this.volumeRendering.updateSettings(this.settings,Qt.BOUNDING_BOX),this.pickRendering?.updateSettings(this.settings,Qt.BOUNDING_BOX)}getIntensity(e,t,n,r){return this.volume.getIntensity(e,t,n,r)}onStartControls(){this.renderMode===Wt.PATHTRACE&&this.volumeRendering.onStartControls()}onChangeControls(){this.renderMode===Wt.PATHTRACE&&this.volumeRendering.onChangeControls(),this.pickRendering?.viewpointMoved()}onEndControls(){this.renderMode===Wt.PATHTRACE&&this.volumeRendering.onEndControls()}onResetCamera(){this.volumeRendering.viewpointMoved(),this.pickRendering?.viewpointMoved()}onCameraChanged(e,t,n){this.renderMode===Wt.PATHTRACE&&this.volumeRendering.updateCamera(e,t,n),this.pickRendering?.viewpointMoved()}updateClipRegion(e,t,n,r,o,a){this.settings.bounds.bmin=new i.Pq0(e-.5,n-.5,o-.5),this.settings.bounds.bmax=new i.Pq0(t-.5,r-.5,a-.5);for(const i of this.childObjects)i.updateClipRegion(e,t,n,r,o,a);this.volumeRendering.updateSettings(this.settings,Qt.ROI),this.pickRendering?.updateSettings(this.settings,Qt.ROI)}updateLights(e){this.renderMode===Wt.PATHTRACE&&this.volumeRendering.updateLights(e)}setPixelSamplingRate(e){this.settings.pixelSamplingRate=e,this.volumeRendering.updateSettings(this.settings,Qt.SAMPLING),this.pickRendering?.updateSettings(this.settings,Qt.SAMPLING)}setVolumeRendering(e){if(e!==Wt.PATHTRACE||this.renderMode!==Wt.PATHTRACE){switch(this.renderMode!==Wt.SLICE&&this.renderMode!==Wt.RAYMARCH||this.sceneRoot.remove(this.meshVolume.get3dObject()),this.sceneRoot.remove(this.volumeRendering.get3dObject()),this.volumeRendering.cleanup(),this.pickRendering?.cleanup(),e){case Wt.PATHTRACE:this.volumeRendering=new Sr(this.volume,this.settings),this.volume.updateRequiredData({subregion:new i.NRn(new i.Pq0(0,0,0),new i.Pq0(1,1,1))}),this.volumeRendering.setRenderUpdateListener(this.renderUpdateListener);break;case Wt.SLICE:this.volumeRendering=new Mr(this.volume,this.settings);break;case Wt.RAYMARCH:default:this.volumeRendering=new ar(this.volume,this.settings),this.volume.updateRequiredData({subregion:new i.NRn(new i.Pq0(0,0,0),new i.Pq0(1,1,1))})}this.pickRendering&&(this.pickRendering=new Er(this.volume,this.settings)),e!==Wt.RAYMARCH&&e!==Wt.SLICE||(this.renderUpdateListener&&this.renderUpdateListener(0),this.sceneRoot.add(this.meshVolume.get3dObject())),this.sceneRoot.add(this.volumeRendering.get3dObject()),this.renderMode=e,this.fuse()}}setTranslation(e){this.settings.translation.copy(e),this.meshVolume.setTranslation(this.settings.translation),this.volumeRendering.updateSettings(this.settings,Qt.TRANSFORM),this.pickRendering?.updateSettings(this.settings,Qt.TRANSFORM)}setRotation(e){this.settings.rotation.copy(e),this.meshVolume.setRotation(this.settings.rotation),this.volumeRendering.updateSettings(this.settings,Qt.TRANSFORM),this.pickRendering?.updateSettings(this.settings,Qt.TRANSFORM)}setScale(e){this.settings.scale.copy(e),this.updateScale()}addLineObject(e){this.childObjects.has(e)||(this.childObjects.add(e),this.childObjectsGroup.add(e.get3dObject()),e.setResolution(this.settings.resolution.x,this.settings.resolution.y),e.setFlipAxes(this.settings.flipAxes.x,this.settings.flipAxes.y,this.settings.flipAxes.z))}hasLineObject(e){return this.childObjects.has(e)}removeLineObject(e){this.childObjects.has(e)&&(this.childObjects.delete(e),this.childObjectsGroup.remove(e.get3dObject()))}setupGui(e){e.addInput(this.settings,"translation").on("change",(({value:e})=>this.setTranslation(e))),e.addInput(this.settings,"rotation").on("change",(({value:e})=>this.setRotation(e)));const t=e.addFolder({title:"Multiscale loading"});t.addInput(this.volume.loadSpecRequired,"maxAtlasEdge").on("change",(({value:e})=>this.volume.updateRequiredData({maxAtlasEdge:e}))),t.addInput(this.volume.loadSpecRequired,"useExplicitLevel").on("change",(({value:e})=>this.volume.updateRequiredData({useExplicitLevel:e}))),t.addInput(this.volume.loadSpecRequired,"scaleLevelBias").on("change",(({value:e})=>this.volume.updateRequiredData({scaleLevelBias:e}))),t.addInput(this.volume.loadSpecRequired,"multiscaleLevel").on("change",(({value:e})=>this.volume.updateRequiredData({multiscaleLevel:e})));const n=e.addFolder({title:"Pathtrace",expanded:!1});n.addInput(this.settings,"primaryRayStepSize",{min:1,max:100}).on("change",(({value:e})=>this.setRayStepSizes(e))),n.addInput(this.settings,"secondaryRayStepSize",{min:1,max:100}).on("change",(({value:e})=>this.setRayStepSizes(void 0,e)))}setZSlice(e){const t=this.volume.imageInfo.volumeSize.z;return this.settings.zSlice!==e&&e<t&&e>=0&&(this.settings.zSlice=e,this.volumeRendering.updateSettings(this.settings,Qt.ROI),this.pickRendering?.updateSettings(this.settings,Qt.ROI),!0)}get showBoundingBox(){return this.settings.showBoundingBox}}const Ir=Wt.RAYMARCH,Rr=Wt.PATHTRACE,Pr={numChunksToPrefetchAhead:5,prefetchAlongNonPlayingAxis:!1,throttleArrivingChannelData:!0};class Lr{constructor(e){const t=void 0===e?.useWebGL2||e.useWebGL2;this.canvas3d=new vn(e?.parentElement,t),this.redraw=this.redraw.bind(this),this.scene=new i.Z58,this.backgroundColor=new i.Q1f(0),this.lights=[],this.pixelSamplingRate=.75,this.exposure=.5,this.volumeRenderMode=Wt.RAYMARCH,window.addEventListener("resize",(()=>this.resize(null))),this.lightContainer=new i.B69,this.ambientLight=new i.$p8,this.spotLight=new i.nCl,this.reflectedLight=new i.ZyN,this.fillLight=new i.ZyN,this.buildScene(),this.tweakpane=null,window.addEventListener("keydown",this.handleKeydown)}preRender(){const e=this.scene.getObjectByName("lightContainer");if(e&&e.rotation.setFromRotationMatrix(this.canvas3d.camera.matrixWorld),this.image&&qt(this.canvas3d.camera)){const{top:e,zoom:t}=this.canvas3d.camera;this.image.setOrthoScale(Math.abs(e)/t),this.updateOrthoScaleBar(this.image.volume)}}updateOrthoScaleBar(e){this.canvas3d.updateOrthoScaleBar(e.physicalScale,e.imageInfo.spatialUnit)}updatePerspectiveScaleBar(e){this.canvas3d.updatePerspectiveScaleBar(e.tickMarkPhysicalLength,e.imageInfo.spatialUnit)}updateTimestepIndicator(e){const{times:t,timeScale:n,timeUnit:r}=e.imageInfo,i=e.loadSpec.time;this.canvas3d.updateTimestepIndicator(i*n,t*n,r)}capture(e){return this.canvas3d.requestCapture(e)}getDOMElement(){return this.canvas3d.containerdiv}getCanvasDOMElement(){return this.canvas3d.renderer.domElement}getCameraState(){return this.canvas3d.getCameraState()}setCameraState(e){this.canvas3d.setCameraState(e),this.redraw()}getViewProjectionMatrix(){const e=this.canvas3d.camera;return(new i.kn4).multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse)}redraw(e=!1){e?this.canvas3d.onAnimationLoop():this.canvas3d.redraw()}setOnRenderCallback(e){this.canvas3d.setOnRenderCallback(e)}unsetImage(){return this.image&&(this.canvas3d.removeControlHandlers(),this.canvas3d.animateFuncs=[],this.canvas3d.postMeshRenderFuncs=[],this.canvas3d.overlayRenderFuncs=[],this.scene.remove(this.image.sceneRoot)),this.image}addVolume(e,t){e.addVolumeDataObserver(this),(t=t||{}).renderMode=this.volumeRenderMode,this.setImage(new Cr(e,t))}setVolumeChannelOptions(e,t,n){this.image?.setChannelOptions(t,n),this.redraw()}setVolumeDisplayOptions(e,t){this.image?.setOptions(t),this.redraw()}removeVolume(e){const t=this.unsetImage();t&&t.cleanup(),e&&e.removeVolumeDataObserver(this)}removeAllVolumes(){this.image&&this.removeVolume(this.image.volume),this.image=void 0}setRenderUpdateListener(e){this.renderUpdateListener=e,this.image?.setRenderUpdateListener(e)}onVolumeData(e,t){this.image?.updateScale(),this.image?.onChannelLoaded(t),e.isLoaded()&&this.tweakpane&&this.tweakpane.refresh()}onVolumeChannelAdded(e,t){this.image?.onChannelAdded(t)}onVolumeLoadError(e,t){this.loadErrorHandler?.(e,t)}setLoadErrorHandler(e){this.loadErrorHandler=e}setTime(e,t,n){const r=Math.max(0,Math.min(t,e.imageInfo.times-1)),i=e.updateRequiredData({time:r},n);return this.updateTimestepIndicator(e),i}setScaleLevelBias(e,t){e.updateRequiredData({scaleLevelBias:t})}setVolumeChannelAsMask(e,t){this.image?.setChannelAsMask(t),this.redraw()}setChannelColorizeFeature(e,t,n){this.image?.setChannelColorizeFeature(t,n),this.image?.fuse(),this.redraw()}setVoxelSize(e,t,n){this.image&&(this.image.setVoxelSize((new i.Pq0).fromArray(t)),n&&this.image.volume.setUnitSymbol(n),this.updatePerspectiveScaleBar(this.image.volume)),this.redraw()}setRayStepSizes(e,t,n){this.image?.setRayStepSizes(t,n),this.redraw()}setShowBoundingBox(e,t){this.image?.setShowBoundingBox(t),this.canvas3d.setShowPerspectiveScaleBar(t&&this.canvas3d.showOrthoScaleBar&&this.volumeRenderMode!==Wt.PATHTRACE),this.redraw()}setBoundingBoxColor(e,t){this.image?.setBoundingBoxColor(t),this.canvas3d.setPerspectiveScaleBarColor(t),this.redraw()}setBackgroundColor(e){const t=(new i.Q1f).fromArray(e);this.backgroundColor=t,this.canvas3d.setClearColor(t,1),this.redraw()}hasIsosurface(e,t){return this.image?.hasIsosurface(t)||!1}saveChannelIsosurface(e,t,n){this.image?.saveChannelIsosurface(t,n)}setImage(e){const t=this.unsetImage();return this.image=e,this.scene.add(e.sceneRoot),this.image.setResolution(this.canvas3d.getWidth(),this.canvas3d.getHeight()),this.image.setIsOrtho(qt(this.canvas3d.camera)),this.image.setBrightness(this.exposure),this.canvas3d.setControlHandlers(this.onStartControls.bind(this),this.onChangeControls.bind(this),this.onEndControls.bind(this)),this.canvas3d.animateFuncs.push(this.preRender.bind(this)),this.canvas3d.animateFuncs.push(e.onAnimate.bind(e)),this.canvas3d.postMeshRenderFuncs.push(e.fillPickBuffer.bind(e)),this.canvas3d.overlayRenderFuncs.push(e.drawContours.bind(e)),this.updatePerspectiveScaleBar(e.volume),this.updateTimestepIndicator(e.volume),this.redraw(),t}onStartControls(){this.volumeRenderMode!==Wt.PATHTRACE&&this.canvas3d.startRenderLoop(),this.image?.onStartControls()}onChangeControls(){this.image?.onChangeControls()}onEndControls(){this.image?.onEndControls(),this.volumeRenderMode===Wt.PATHTRACE||this.canvas3d.controls.autoRotate||this.canvas3d.stopRenderLoop(),this.redraw()}buildScene(){this.scene=this.canvas3d.scene,this.canvas3d.setClearColor(this.backgroundColor,1),this.lights=[new lr(1),new lr(0)],this.lightContainer=new i.B69,this.lightContainer.name="lightContainer",this.ambientLight=new i.$p8(yn.ambientLightSettings.color,yn.ambientLightSettings.intensity),this.ambientLight.layers.enable(1),this.lightContainer.add(this.ambientLight),this.spotLight=new i.nCl(yn.spotlightSettings.color,yn.spotlightSettings.intensity),this.spotLight.position.set(yn.spotlightSettings.position.x,yn.spotlightSettings.position.y,yn.spotlightSettings.position.z),this.spotLight.target=new i.B69,this.spotLight.angle=yn.spotlightSettings.angle,this.spotLight.layers.enable(1),this.lightContainer.add(this.spotLight),this.reflectedLight=new i.ZyN(yn.reflectedLightSettings.color),this.reflectedLight.position.set(yn.reflectedLightSettings.position.x,yn.reflectedLightSettings.position.y,yn.reflectedLightSettings.position.z),this.reflectedLight.castShadow=yn.reflectedLightSettings.castShadow,this.reflectedLight.intensity=yn.reflectedLightSettings.intensity,this.reflectedLight.layers.enable(1),this.lightContainer.add(this.reflectedLight),this.fillLight=new i.ZyN(yn.fillLightSettings.color),this.fillLight.position.set(yn.fillLightSettings.position.x,yn.fillLightSettings.position.y,yn.fillLightSettings.position.z),this.fillLight.castShadow=yn.fillLightSettings.castShadow,this.fillLight.intensity=yn.fillLightSettings.intensity,this.fillLight.layers.enable(1),this.lightContainer.add(this.fillLight),this.scene.add(this.lightContainer)}setCameraMode(e){this.canvas3d.switchViewMode(e),this.image?.setViewMode(e,this.volumeRenderMode),this.image?.setIsOrtho("3D"!==e),this.canvas3d.redraw()}setZSlice(e,t){return!!this.image?.setZSlice(t)&&(this.canvas3d.redraw(),!0)}setShowAxis(e){this.canvas3d.showAxis=e,this.canvas3d.redraw()}setShowScaleBar(e){this.canvas3d.setShowOrthoScaleBar(e),this.canvas3d.setShowPerspectiveScaleBar(e&&!!this.image?.showBoundingBox&&this.volumeRenderMode!==Wt.PATHTRACE)}setShowTimestepIndicator(e){const t=this.image?.volume.imageInfo.times,n=!!t&&t>1;this.canvas3d.setShowTimestepIndicator(e&&n)}setAxisPosition(e,t,n=Xt.BOTTOM_LEFT){this.canvas3d.setAxisPosition(e,t,n),this.canvas3d.showAxis&&this.canvas3d.redraw()}setScaleBarPosition(e,t,n=Xt.BOTTOM_RIGHT){this.canvas3d.setIndicatorPosition(!1,e,t,n)}setTimestepIndicatorPosition(e,t,n=Xt.BOTTOM_RIGHT){this.canvas3d.setIndicatorPosition(!0,e,t,n)}setAutoRotate(e){this.canvas3d.setAutoRotate(e),e?this.onStartControls():this.onEndControls()}setScaleUnit(e){this.image&&(this.image.volume.setUnitSymbol(e),this.updatePerspectiveScaleBar(this.image.volume),qt(this.canvas3d.camera)&&this.updateOrthoScaleBar(this.image.volume))}setFlipVolume(e,t,n,r){this.image?.setFlipAxes(t,n,r),this.redraw()}setInterpolationEnabled(e,t){this.image?.setInterpolationEnabled(t),this.redraw()}resize(e,t,n,r,i,o){this.canvas3d.resize(e,t,n,r,i,o),this.image?.setResolution(this.canvas3d.getWidth(),this.canvas3d.getHeight()),this.redraw()}updateDensity(e,t){this.image?.setDensity(t),this.redraw()}updateShadingMethod(e,t){this.image?.updateShadingMethod(t)}setGamma(e,t,n,r){this.image?.setGamma(t,n,r),this.redraw()}setMaxProjectMode(e,t){this.image?.setMaxProjectMode(t),this.redraw()}updateActiveChannels(e){this.image?.fuse(),this.redraw()}updateLuts(e){this.image?.updateLuts(),this.redraw()}updateMaterial(e){this.image?.updateMaterial(),this.redraw()}updateExposure(e){this.exposure=e,this.image?.setBrightness(e),this.redraw()}updateCamera(e,t,n){this.canvas3d.updateCameraFocus(e,t,n),this.image?.onCameraChanged(e,t,n),this.redraw()}updateClipRegion(e,t,n,r,i,o,a){this.image?.updateClipRegion(t,n,r,i,o,a),this.redraw()}setAxisClip(e,t,n,r,i){this.image?.setAxisClip(t,n,r,i),this.redraw()}updateLights(e){this.lights=e,this.image?.updateLights(e)}updatePixelSamplingRate(e){this.pixelSamplingRate!==e&&(this.pixelSamplingRate=e,this.image?.setPixelSamplingRate(e))}updateMaskAlpha(e,t){this.image?.setMaskAlpha(t),this.redraw()}setVolumeChannelEnabled(e,t,n){this.image?.setChannelOptions(t,{enabled:n}),this.redraw()}updateChannelMaterial(e,t,n,r,i,o){this.image?.updateChannelMaterial(t,n,r,i,o)}updateChannelColor(e,t,n){this.image?.updateChannelColor(t,n)}setVolumeRenderMode(e){if(e!==this.volumeRenderMode){if(this.volumeRenderMode=e,this.image){if(this.image.getViewMode()===Jt.Z)return;e===Wt.PATHTRACE&&this.canvas3d.hasWebGL2?(this.image.setVolumeRendering(Wt.PATHTRACE),this.image.updateLights(this.lights),this.canvas3d.startRenderLoop()):e===Wt.RAYMARCH&&(this.image.setVolumeRendering(Wt.RAYMARCH),this.canvas3d.redraw()),this.updatePixelSamplingRate(this.pixelSamplingRate),this.image.setIsOrtho(qt(this.canvas3d.camera)),this.image.setResolution(this.canvas3d.getWidth(),this.canvas3d.getHeight()),this.setAutoRotate(this.canvas3d.controls.autoRotate),this.image.setRenderUpdateListener(this.renderUpdateListener)}this.canvas3d.setShowPerspectiveScaleBar(this.canvas3d.showOrthoScaleBar&&!!this.image?.showBoundingBox&&e!==Wt.PATHTRACE)}}setVolumeTranslation(e,t){this.image?.setTranslation((new i.Pq0).fromArray(t)),this.redraw()}setVolumeRotation(e,t){this.image?.setRotation((new i.O9p).fromArray(t)),this.redraw()}setVolumeScale(e,t){this.image?.setScale((new i.Pq0).fromArray(t)),this.redraw()}resetCamera(){this.canvas3d.resetCamera(),this.image?.onResetCamera(),this.redraw()}hasWebGL2(){return this.canvas3d.hasWebGL2}handleKeydown=e=>{"Digit1"===e.code&&e.altKey&&e.ctrlKey&&(this.tweakpane?(this.tweakpane.dispose(),this.tweakpane=null):this.tweakpane=this.setupGui(this.canvas3d.containerdiv))};removeEventListeners(){window.removeEventListener("keydown",this.handleKeydown)}setSelectedID(e,t,n){const r=this.image?.setSelectedID(t,n);r&&(this.image?.fuse(),this.redraw())}addLineObject(e){this.image&&(this.image.addLineObject(e),this.redraw())}hasLineObject(e){return!!this.image&&this.image.hasLineObject(e)}removeLineObject(e){this.image&&(this.image.removeLineObject(e),this.redraw())}enablePicking(e,t,n=0){this.image&&this.image.enablePicking(t,n)}hitTest(e,t){return this.image?this.canvas3d.hitTest(e,t,this.image.getPickBuffer()):-1}setupGui(e){const t=new o.Pane({title:"Advanced Settings",container:e});Object.assign(t.element.style,{position:"absolute",top:"0",right:"0"});const n=t.addFolder({title:"Lights (isosurface)"}),r=(e,t)=>{const r=n.addFolder({title:t,expanded:!1});r.addInput(e,"color",{color:{type:"float"}}),r.addInput(e,"intensity",{min:0}),e.isAmbientLight||r.addInput(e,"position")};r(this.spotLight,"spot light"),r(this.ambientLight,"ambient light"),r(this.reflectedLight,"reflected light"),r(this.fillLight,"fill light"),this.image?.setupGui(t);const i=t.addFolder({title:"Prefetch"}),a=this.image?.volume.loader;return i.addInput(Pr,"numChunksToPrefetchAhead").on("change",(e=>{a?.updateFetchOptions?.({maxPrefetchDistance:[e.value,e.value,e.value,e.value]}),this.image?.volume.updateRequiredData({})})),i.addInput(Pr,"prefetchAlongNonPlayingAxis").on("change",(e=>{a?.updateFetchOptions?.({onlyPriorityDirections:!e.value})})),i.addInput(Pr,"throttleArrivingChannelData").on("change",(e=>{a?.getContext?.().setThrottleChannelData(e.value)})),t}}class kr{constructor(e){this.dataMinBin=0,this.dataMaxBin=0,this.maxBin=0,this.bins=new Uint32Array,this.min=0,this.max=0,this.binSize=0;const t=kr.calculateHistogram(e,256);this.bins=t.bins,this.min=t.min,this.max=t.max,this.binSize=t.binSize;for(let e=0;e<this.bins.length;e++)if(this.bins[e]>0){this.dataMinBin=e;break}for(let e=this.bins.length-1;e>=0;e--)if(this.bins[e]>0){this.dataMaxBin=e;break}this.pixelCount=e.length,this.maxBin=1;let n=this.bins[1];for(let e=1;e<this.bins.length;e++)this.bins[e]>n&&(this.maxBin=e,n=this.bins[e])}static findBin(e,t,n,r){const i=(e-t)/n;return r?Math.max(Math.min(Math.floor(i),255),0):i}findBinOfValue(e){return kr.findBin(e,this.min,this.binSize,!0)}findFractionalBinOfValue(e){return kr.findBin(e,this.min,this.binSize,!1)}getValueFromBinIndex(e){return this.min+e*this.binSize}getDataMin(){return this.min}getDataMax(){return this.max}getMin(){return this.dataMinBin}getMax(){return this.dataMaxBin}getNumBins(){return this.bins.length}getBin(e){return this.bins[e]}getBinRange(e){return[this.min+e*this.binSize,this.min+(e+1)*this.binSize]}findBinOfPercentile(e){const t=this.pixelCount*e;let n=0,r=0;for(n=0;n<this.bins.length&&(r+=this.bins[n],!(r>t));++n);return n}findBestFitBins(){const e=this.pixelCount/10;let t=0,n=0;for(t=1;t<this.bins.length&&(n+=this.bins[t],!(n>e));++t);const r=t;for(n=0,t=this.bins.length-1;t>=1&&(n+=this.bins[t],!(n>e));--t);return[r,t]}findAutoIJBins(){const e=this.pixelCount,t=e/10,n=e/5e3;let r=this.bins.length-1,i=1;for(let e=1;e<this.bins.length;++e)if(this.bins[e]>n&&this.bins[e]<=t){r=e;break}for(let e=this.bins.length-1;e>=1;--e)if(this.bins[e]>n&&this.bins[e]<=t){i=e;break}return i<r&&(r=0,i=255),[r,i]}findAutoMinMax(){const e=Math.floor(.1*this.bins[this.maxBin]);let t=0,n=this.bins.length-1;for(let n=1;n<this.bins.length;++n)if(this.bins[n]>e){t=n;break}for(let t=this.bins.length-1;t>=1;--t)if(this.bins[t]>e){n=t;break}return[t,n]}static calculateHistogram(e,t=1){t<1&&(t=1);let n=e[0],r=e[0];for(let t=1;t<e.length;t++)e[t]<n?n=e[t]:e[t]>r&&(r=e[t]);const i=new Uint32Array(t).fill(0),o=(a=e)instanceof Float32Array||a instanceof Float64Array?r:r+1;var a;const s=o<=n?1:(o-n)/t;for(let t=0;t<e.length;t++){const r=e[t];i[kr.findBin(r,n,s,!0)]++}return{bins:i,min:n,max:r,binSize:s}}}class Dr{constructor(e){this.loaded=!1,this.dtype="uint8",this.imgData={data:new Uint8Array,width:0,height:0},this.rawMin=0,this.rawMax=255,this.frame=0,this.dataTexture=new i.GYF(new Uint8Array,0,0),this.lutTexture=new i.GYF(new Uint8Array(yr),256,1,i.GWd,i.OUM),this.lutTexture.minFilter=this.lutTexture.magFilter=i.k6q,this.lutTexture.generateMipmaps=!1,this.volumeData=new Uint8Array,this.name=e,this.histogram=new kr(new Uint8Array),this.dims=[0,0,0],this.lut=(new wr).createFromMinMax(0,255),this.colorPalette=new Uint8Array(yr).fill(0),this.colorPaletteAlpha=0}combineLuts(e,t){const n=t||new Uint8Array(yr);if(!e)return n;const r=[e[0]/255,e[1]/255,e[2]/255];if(1===this.colorPaletteAlpha)n.set(this.colorPalette);else if(0===this.colorPaletteAlpha){n.set(this.lut.lut);for(let e=0;e<yr/4;++e)n[4*e+0]*=r[0],n[4*e+1]*=r[1],n[4*e+2]*=r[2]}else for(let e=0;e<yr/4;++e)n[4*e+0]=this.colorPalette[4*e+0]*this.colorPaletteAlpha+this.lut.lut[4*e+0]*(1-this.colorPaletteAlpha)*r[0],n[4*e+1]=this.colorPalette[4*e+1]*this.colorPaletteAlpha+this.lut.lut[4*e+1]*(1-this.colorPaletteAlpha)*r[1],n[4*e+2]=this.colorPalette[4*e+2]*this.colorPaletteAlpha+this.lut.lut[4*e+2]*(1-this.colorPaletteAlpha)*r[2],n[4*e+3]=this.colorPalette[4*e+3]*this.colorPaletteAlpha+this.lut.lut[4*e+3]*(1-this.colorPaletteAlpha);return this.lutTexture.image.data.set(n),this.lutTexture.needsUpdate=!0,n}setRawDataRange(e,t){0===this.rawMin&&0===this.rawMax||0===e&&0===t||(this.lut.remapDomains(this.rawMin,this.rawMax,e,t),this.rawMin=e,this.rawMax=t)}getHistogram(){return this.histogram}getIntensity(e,t,n){return this.volumeData[e+t*this.dims[0]+n*(this.dims[0]*this.dims[1])]}normalizeRaw(e){return(e-this.rawMin)/(this.rawMax-this.rawMin)}getIntensityFromAtlas(e,t,n){const r=this.imgData.width/this.dims[0],i=n%r,o=Math.floor(n/r),a=i*this.dims[0]+e+(o*this.dims[1]+t)*this.imgData.width;return this.imgData.data[a]}rebuildDataTexture(e,t,n){this.dataTexture&&this.dataTexture.dispose();let r=i.Kzv,o=i.OUM,a="LUMINANCE";switch(this.dtype){case"uint8":o=i.OUM,r=i.ZQM,a="R8UI";break;case"int8":o=i.tJf,r=i.ZQM,a="R8I";break;case"uint16":o=i.cHt,r=i.ZQM,a="R16UI";break;case"int16":o=i.fBL,r=i.ZQM,a="R16I";break;case"uint32":o=i.bkx,r=i.ZQM,a="R32UI";break;case"int32":o=i.Yuy,r=i.ZQM,a="R32I";break;case"float32":o=i.RQf,r=i.VT0,a="R32F";break;default:console.warn("unsupported dtype for channel data",this.dtype)}this.dataTexture=new i.GYF(e,t,n,r,o,i.UTZ,i.ghU,i.ghU,i.hxR,i.hxR),this.dataTexture.internalFormat=a,this.dataTexture.needsUpdate=!0}setFromAtlas(e,t,n,r,i,o,a,s=0){this.dtype=r,this.imgData={data:e,width:t,height:n},this.rebuildDataTexture(this.imgData.data,t,n),this.loaded=!0,this.histogram=new kr(e),this.frame=s,this.setRawDataRange(i,o),this.unpackFromAtlas(a.x,a.y,a.z)}unpackFromAtlas(e,t,n){const r=this.imgData.data;this.dims=[e,t,n];const i=Gt[this.dtype];this.volumeData=new i(e*t*n);const o=this.imgData.width/e,a=this.imgData.width;let s=0,l=0,c=0,u=0,h=0;for(let i=0;i<n;++i){s=i%o,l=Math.floor(i/o),c=s*e+l*t*a;for(let n=0;n<t;++n)u=n*a,h=i*(e*t)+n*e,this.volumeData.set(r.subarray(c+u,c+u+e),h)}}setFromVolumeData(e,t,n,r,i,o,a,s,l,c=0){this.dims=[t,n,r],this.volumeData=e,this.dtype=l,this.frame=c,this.packToAtlas(t,n,r,i,o),this.loaded=!0,this.setRawDataRange(a,s),this.histogram=new kr(this.volumeData)}packToAtlas(e,t,n,r,i){(r%e!=0||i%t!=0||r/e*(i/t)<n)&&(console.log("ERROR - atlas and volume dims are inconsistent"),console.log(r,i,e,t,n));const o=Gt[this.dtype];this.imgData={width:r,height:i,data:new o(r*i)},this.imgData.data.fill(0);const a=this.imgData.data,s=e,l=t,c=n,u=this.imgData.width/s,h=this.imgData.width;let d=0,f=0,p=0,m=0,g=0;for(let e=0;e<c;++e){d=e%u,f=Math.floor(e/u),p=d*s+f*l*h;for(let t=0;t<l;++t)m=t*h,g=e*(s*l)+t*s,a.set(this.volumeData.subarray(g,g+s),p+m)}this.rebuildDataTexture(this.imgData.data,r,i)}setLut(e){this.lut=e}setColorPalette(e){this.colorPalette=e}setColorPaletteAlpha(e){this.colorPaletteAlpha=e}}function Or(e){return new i.Pq0(e.shape[4],e.shape[3],e.shape[2])}class Nr{constructor(e){this.imageInfo=e||{name:"",atlasTileDims:[1,1],subregionSize:[1,1,1],subregionOffset:[0,0,0],combinedNumChannels:1,channelNames:["0"],channelColors:[[255,255,255]],multiscaleLevel:0,multiscaleLevelDims:[{shape:[1,1,1,1,1],spacing:[1,1,1,1,1],spaceUnit:"",timeUnit:"",dataType:"uint8"}],transform:{translation:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}}}get currentLevelDims(){return this.imageInfo.multiscaleLevelDims[this.imageInfo.multiscaleLevel]}get numChannels(){return this.imageInfo.combinedNumChannels}get originalSize(){return Or(this.imageInfo.multiscaleLevelDims[0])}get volumeSize(){return Or(this.currentLevelDims)}get physicalPixelSize(){return e=this.imageInfo.multiscaleLevelDims[0],new i.Pq0(e.spacing[4],e.spacing[3],e.spacing[2]);var e}get spatialUnit(){return this.imageInfo.multiscaleLevelDims[0].spaceUnit}get times(){return this.currentLevelDims.shape[0]}get timeScale(){return this.currentLevelDims.spacing[0]}get timeUnit(){return this.currentLevelDims.timeUnit}get numMultiscaleLevels(){return this.imageInfo.multiscaleLevelDims.length}get channelNames(){return this.imageInfo.channelNames}get channelColors(){return this.imageInfo.channelColors}get subregionSize(){return new i.Pq0(...this.imageInfo.subregionSize)}get subregionOffset(){return new i.Pq0(...this.imageInfo.subregionOffset)}get multiscaleLevel(){return this.imageInfo.multiscaleLevel}get atlasTileDims(){return new i.I9Y(...this.imageInfo.atlasTileDims)}get transform(){return{translation:new i.Pq0(...this.imageInfo.transform.translation),rotation:new i.Pq0(...this.imageInfo.transform.rotation),scale:new i.Pq0(...this.imageInfo.transform.scale)}}}const Ur=4096;function Fr(e,t,n){let r=1,o=e,a=o*t/(r*n),s=r,l=o;for(;a>1;)s=r,l=o,o-=1,r=Math.ceil(e/o),a=o*t/(r*n);return new i.I9Y(s,l)}function zr(e,t=4096){const n=e[2],r=e[1],i=e[0];return Math.floor(t/n)*Math.floor(t/r)>=i}class Br{time=0;subregion=new i.NRn(new i.Pq0(0,0,0),new i.Pq0(1,1,1));useExplicitLevel=!1}class Vr{setPrefetchPriority(e){}syncMultichannelLoading(e){}updateFetchOptions(e){}async createVolume(e,t){const{imageInfo:n,loadSpec:r}=await this.createImageInfo(e),i=new jr(n,r,this);return i.channelLoadCallback=t,i.imageMetadata=function(e){const t=new Nr(e),n=t.volumeSize.clone().multiply(t.physicalPixelSize),r={};return r.Dimensions={...t.subregionSize},r["Original dimensions"]={...t.originalSize},r["Physical size"]={x:n.x+t.spatialUnit,y:n.y+t.spatialUnit,z:n.z+t.spatialUnit},r["Physical size per pixel"]={x:t.physicalPixelSize.x+t.spatialUnit,y:t.physicalPixelSize.y+t.spatialUnit,z:t.physicalPixelSize.z+t.spatialUnit},r["Multiresolution levels"]=e.multiscaleLevelDims,r.Channels=e.combinedNumChannels,r["Time series frames"]=t.times||1,e.userData&&!function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(e.userData)&&(r["User data"]=e.userData),r}(n),i}async loadVolumeData(e,t,n){const r={...e.loadSpec,...t};return this.loadRawChannelData(e.imageInfo.imageInfo,r,((t,n)=>{t&&(e.imageInfo=new Nr(t),e.updateDimensions()),e.loadSpec={...n,...r}}),((t,r,i,o,a)=>{for(let s=0;s<t.length;s++){const l=t[s],c=r[s],u=i[s],h=o[s],d=e.loadSpec.time;a?e.setChannelDataFromAtlas(l,u,a[0],a[1],h,c,d):e.setChannelDataFromVolume(l,u,h,c,d),n?.(e,l)}}))}}class jr{constructor(e={name:"",atlasTileDims:[1,1],subregionSize:[1,1,1],subregionOffset:[0,0,0],combinedNumChannels:1,channelNames:["0"],channelColors:[[255,255,255]],multiscaleLevel:0,multiscaleLevelDims:[{shape:[1,1,1,1,1],spacing:[1,1,1,1,1],spaceUnit:"",timeUnit:"",dataType:"uint8"}],transform:{translation:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}},t=new Br,n){if(this.loaded=!1,this.imageInfo=new Nr(e),this.name=e.name,this.loadSpec={multiscaleLevel:0,scaleLevelBias:0,maxAtlasEdge:Ur,channels:Array.from({length:this.imageInfo.numChannels},((e,t)=>t)),...t},this.loadSpecRequired={...this.loadSpec,channels:this.loadSpec.channels.slice(),subregion:this.loadSpec.subregion.clone()},this.loader=n,this.imageMetadata={},this.normRegionSize=new i.Pq0(1,1,1),this.normRegionOffset=new i.Pq0(0,0,0),this.physicalSize=new i.Pq0(1,1,1),this.physicalScale=1,this.normPhysicalSize=new i.Pq0(1,1,1),this.physicalPixelSize=this.imageInfo.physicalPixelSize,this.tickMarkPhysicalLength=1,this.setVoxelSize(this.physicalPixelSize),this.numChannels=this.imageInfo.numChannels,this.channelNames=this.imageInfo.channelNames.slice(),this.channelColorsDefault=this.imageInfo.channelColors?this.imageInfo.channelColors.slice():this.channelNames.map(((e,t)=>dr(t))),this.channelColorsDefault.length<this.imageInfo.numChannels)for(let e=this.channelColorsDefault.length-1;e<this.imageInfo.numChannels;++e)this.channelColorsDefault[e]=dr(e);this.channels=[];for(let e=0;e<this.imageInfo.numChannels;++e){const t=new Dr(this.channelNames[e]);this.channels.push(t),t.dims=this.imageInfo.subregionSize.toArray()}this.physicalUnitSymbol=this.imageInfo.spatialUnit,this.volumeDataObservers=[]}setUnloaded(){this.loaded=!1,this.channels.forEach((e=>{e.loaded=!1}))}isLoaded(){return this.loaded}updateDimensions(){const{volumeSize:e,subregionSize:t,subregionOffset:n}=this.imageInfo;this.setVoxelSize(this.physicalPixelSize),this.normRegionSize=t.clone().divide(e),this.normRegionOffset=n.clone().divide(e)}mustLoadNewData(){return this.loadSpec.useExplicitLevel!==this.loadSpecRequired.useExplicitLevel||this.loadSpec.time!==this.loadSpecRequired.time||!this.loadSpec.subregion.containsBox(this.loadSpecRequired.subregion)||this.loadSpecRequired.channels.some((e=>!this.loadSpec.channels.includes(e)))}mayLoadNewScaleLevel(){return!this.loadSpec.subregion.equals(this.loadSpecRequired.subregion)||this.loadSpecRequired.maxAtlasEdge!==this.loadSpec.maxAtlasEdge||this.loadSpecRequired.multiscaleLevel!==this.loadSpec.multiscaleLevel||this.loadSpecRequired.scaleLevelBias!==this.loadSpec.scaleLevelBias}async updateRequiredData(e,t){this.loadSpecRequired={...this.loadSpecRequired,...e};let n=this.mustLoadNewData();if(!n&&this.mayLoadNewScaleLevel()){const e=await this.loadScaleLevelDims();if(e){const t=e.map((({shape:e})=>[e[2],e[3],e[4]])),r=function(e,t){if(e.useExplicitLevel&&void 0!==e.multiscaleLevel)return Math.max(0,Math.min(t.length-1,e.multiscaleLevel));let n=function(e,t=4096){if(e.length<=1)return 0;for(let n=0;n<e.length;++n)if(zr(e[n],t))return n}(t,e.maxAtlasEdge);if(void 0!==n&&(n=Math.max(n+(e.scaleLevelBias??0),e.multiscaleLevel??0),n=Math.max(0,Math.min(t.length-1,n)),zr(t[n],e.maxAtlasEdge)))return n;void 0===n&&(n=t.length-1);const r=t[n];return console.error(`Volume is too large; no multiscale level found that fits in preferred memory footprint. Selected level ${n}  has dimensions `,r,`. Max atlas edge allowed is ${e.maxAtlasEdge}.`),console.log("All available levels: ",t),n}(this.loadSpecRequired,t);n=this.imageInfo.multiscaleLevel!==r}}n&&await this.loadNewData(t)}async loadScaleLevelDims(){try{return await(this.loader?.loadDims(this.loadSpecRequired))}catch(e){return void this.volumeDataObservers.forEach((t=>t.onVolumeLoadError(this,e)))}}async loadNewData(e){this.setUnloaded(),this.loadSpec={...this.loadSpecRequired,subregion:this.loadSpecRequired.subregion.clone()};try{await(this.loader?.loadVolumeData(this,void 0,e))}catch(e){throw this.volumeDataObservers.forEach((t=>t.onVolumeLoadError(this,e))),e}}setVoxelSize(e){e.x=e.x>0?e.x:1,e.y=e.y>0?e.y:1,e.z=e.z>0?e.z:1,this.physicalPixelSize=e,this.physicalSize=this.imageInfo.originalSize.clone().multiply(this.physicalPixelSize),this.physicalScale=Math.max(this.physicalSize.x,this.physicalSize.y,this.physicalSize.z),this.normPhysicalSize=this.physicalSize.clone().divideScalar(this.physicalScale),this.tickMarkPhysicalLength=10**Math.floor(Math.log10(this.physicalScale/2))}setUnitSymbol(e){this.physicalUnitSymbol=e}getContentCenter(){return this.normRegionSize.clone().divideScalar(2).add(this.normRegionOffset).subScalar(.5).multiply(this.normPhysicalSize)}cleanup(){}getChannel(e){return this.channels[e]}onChannelLoaded(e){this.loadSpec.channels.every((e=>this.channels[e].loaded))&&(this.loaded=!0),e.forEach((e=>this.channelLoadCallback?.(this,e))),this.volumeDataObservers.forEach((t=>t.onVolumeData(this,e)))}setChannelDataFromAtlas(e,t,n,r,i,o="uint8",a=0){this.channels[e].setFromAtlas(t,n,r,o,i[0],i[1],this.imageInfo.subregionSize,a),this.onChannelLoaded([e])}setChannelDataFromVolume(e,t,n,r="uint8",i=0){const{subregionSize:o,atlasTileDims:a}=this.imageInfo;this.channels[e].setFromVolumeData(t,o.x,o.y,o.z,a.x*o.x,a.y*o.y,n[0],n[1],r,i),this.onChannelLoaded([e])}appendEmptyChannel(e,t){const n=this.imageInfo.numChannels,r=e||"channel_"+n,i=t||dr(n);this.numChannels+=1,this.channelNames.push(r),this.channelColorsDefault.push(i),this.channels.push(new Dr(r));for(let e=0;e<this.volumeDataObservers.length;++e)this.volumeDataObservers[e].onVolumeChannelAdded(this,n);return n}getIntensity(e,t,n,r){return this.channels[e].getIntensity(t,n,r)}getHistogram(e){return this.channels[e].getHistogram()}setLut(e,t){this.channels[e].setLut(t)}setColorPalette(e,t){this.channels[e].setColorPalette(t)}setColorPaletteAlpha(e,t){this.channels[e].setColorPaletteAlpha(t)}getRotation(){return this.imageInfo.transform.rotation.toArray()}getTranslation(){return this.voxelsToWorldSpace(this.imageInfo.transform.translation.toArray())}voxelsToWorldSpace(e){const t=1/Math.max(this.physicalSize.x,Math.max(this.physicalSize.y,this.physicalSize.z));return(new i.Pq0).fromArray(e).multiply(this.physicalPixelSize).multiplyScalar(t).toArray()}addVolumeDataObserver(e){this.volumeDataObservers.push(e)}removeVolumeDataObserver(e){if(e){const t=this.volumeDataObservers.indexOf(e);-1!==t&&this.volumeDataObservers.splice(t,1)}}removeAllVolumeDataObservers(){this.volumeDataObservers=[]}}function Hr(e,t,n=null){return void 0===t&&(t=e,e=null),{start:e,stop:t,step:n}}class Gr{#e;constructor(e,t,n){"number"==typeof e?this.#e=new Uint8Array(e):e instanceof ArrayBuffer?this.#e=new Uint8Array(e,t,n):this.#e=new Uint8Array(Array.from(e,(e=>e?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return this.#e.byteOffset}get byteLength(){return this.#e.byteLength}get buffer(){return this.#e.buffer}get length(){return this.#e.length}get(e){let t=this.#e[e];return"number"==typeof t?0!==t:t}set(e,t){this.#e[e]=t?1:0}fill(e){this.#e.fill(e?1:0)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class Wr{_data;chars;#t;constructor(e,t,n,r){if(this.chars=e,this.#t=new TextEncoder,"number"==typeof t)this._data=new Uint8Array(t*e);else if(t instanceof ArrayBuffer)r&&(r*=e),this._data=new Uint8Array(t,n,r);else{let n=Array.from(t);this._data=new Uint8Array(n.length*e);for(let e=0;e<n.length;e++)this.set(e,n[e])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(e){const t=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);return(new TextDecoder).decode(t).replace(/\x00/g,"")}set(e,t){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*e,this.chars);n.fill(0),n.set(this.#t.encode(t))}fill(e){const t=this.#t.encode(e);for(let e=0;e<this.length;e++)this._data.set(t,e*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}class qr{#n;chars;constructor(e,t,n,r){if(this.chars=e,"number"==typeof t)this.#n=new Int32Array(t*e);else if(t instanceof ArrayBuffer)r&&(r*=e),this.#n=new Int32Array(t,n,r);else{const n=t,r=new qr(e,1);this.#n=new Int32Array(function*(){for(let e of n)r.set(0,e),yield*r.#n}())}}get BYTES_PER_ELEMENT(){return this.#n.BYTES_PER_ELEMENT*this.chars}get byteLength(){return this.#n.byteLength}get byteOffset(){return this.#n.byteOffset}get buffer(){return this.#n.buffer}get length(){return this.#n.length/this.chars}get(e){const t=this.chars*e;let n="";for(let e=0;e<this.chars;e++)n+=String.fromCodePoint(this.#n[t+e]);return n.replace(/\u0000/g,"")}set(e,t){const n=this.chars*e,r=this.#n.subarray(n,n+this.chars);r.fill(0);for(let e=0;e<this.chars;e++)r[e]=t.codePointAt(e)??0}fill(e){this.set(0,e);let t=this.#n.subarray(0,this.chars);for(let e=1;e<this.length;e++)this.#n.set(t,e*this.chars)}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.get(e)}}function Xr(e){const t=(new TextDecoder).decode(e);return JSON.parse(t)}function $r(e,t){const n=t/2,r=t-1;let i=0;for(let o=0;o<e.length;o+=t)for(let t=0;t<n;t+=1)i=e[o+t],e[o+t]=e[o+r-t],e[o+r-t]=i}function Yr(e){if("v2:object"===e)return globalThis.Array;let t=e.match(/v2:([US])(\d+)/);if(t){let[,e,n]=t;return("U"===e?qr:Wr).bind(null,Number(n))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:Gr}[e];return ti(n,`Unknown or unsupported data_type: ${e}`),n}function Kr(e,t){const n=e.length;"string"==typeof t&&(t="C"===t?Array.from({length:n},((e,t)=>t)):Array.from({length:n},((e,t)=>n-1-t))),ti(n===t.length,"Order length must match the number of dimensions.");let r=1,i=new Array(n);for(let n=t.length-1;n>=0;n--)i[t[n]]=r,r*=e[t[n]];return i}function Zr({name:e,configuration:t}){if("default"===e){const e=t?.separator??"/";return t=>["c",...t].join(e)}if("v2"===e){const e=t?.separator??".";return t=>t.join(e)||"0"}throw new Error(`Unknown chunk key encoding: ${e}`)}function Qr(e){return"sharding_indexed"===e?.name}function Jr(e){return"uint64"!==e.data_type&&"int64"!==e.data_type||null==e.fill_value?e.fill_value:BigInt(e.fill_value)}function ei(e,...t){if(!t.some((t=>e instanceof t)))throw e}function ti(e,t=""){if(!e)throw new Error(t)}async function ni(e,{format:t,signal:n}){const r=e instanceof Response?e:new Response(e);ti(r.body,"Response does not contain body.");try{const e=new Response(r.body.pipeThrough(new DecompressionStream(t),{signal:n}));return await e.arrayBuffer()}catch{throw n?.throwIfAborted(),new Error(`Failed to decode ${t}`)}}class ri{kind="array_to_array";constructor(e,t){ti(e.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(e,t){return new ri(e,t)}encode(e){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(e){return e}}const ii=function(){const e=new Uint32Array([305419896]);return!(18===new Uint8Array(e.buffer,e.byteOffset,e.byteLength)[0])}();function oi(e){return"BYTES_PER_ELEMENT"in e?e.BYTES_PER_ELEMENT:4}class ai{kind="array_to_bytes";#r;#i;#o;#a;#s;constructor(e,t){this.#s=e?.endian,this.#i=Yr(t.data_type),this.#a=t.shape,this.#r=Kr(t.shape,"C");const n=new this.#i(0);this.#o=n.BYTES_PER_ELEMENT}static fromConfig(e,t){return new ai(e,t)}encode(e){let t=new Uint8Array(e.data.buffer);return ii&&"big"===this.#s&&$r(t,oi(this.#i)),t}decode(e){return ii&&"big"===this.#s&&$r(e,oi(this.#i)),{data:new this.#i(e.buffer,e.byteOffset,e.byteLength/this.#o),shape:this.#a,stride:this.#r}}}class si{kind="bytes_to_bytes";static fromConfig(){return new si}encode(e){throw new Error("Not implemented")}decode(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength-4)}}class li{kind="bytes_to_bytes";static fromConfig(e){return new li}encode(e){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(e){const t=await ni(e,{format:"gzip"});return new Uint8Array(t)}}function ci(e,t){return ti(!Number.isNaN(t),"JsonCodec allow_nan is false but NaN was encountered during encoding."),ti(t!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),ti(t!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),t}function ui(e,t){return t instanceof Object&&!Array.isArray(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t}class hi{configuration;kind="array_to_bytes";#l;#c;constructor(e={}){this.configuration=e;const{encoding:t="utf-8",skipkeys:n=!1,ensure_ascii:r=!0,check_circular:i=!0,allow_nan:o=!0,sort_keys:a=!0,indent:s,strict:l=!0}=e;let c=e.separators;c||(c=s?[", ",": "]:[",",":"]),this.#l={encoding:t,skipkeys:n,ensure_ascii:r,check_circular:i,allow_nan:o,indent:s,separators:c,sort_keys:a},this.#c={strict:l}}static fromConfig(e){return new hi(e)}encode(e){const{indent:t,encoding:n,ensure_ascii:r,check_circular:i,allow_nan:o,sort_keys:a}=this.#l;ti("utf-8"===n,"JsonCodec does not yet support non-utf-8 encoding.");const s=[];ti(i,"JsonCodec does not yet support skipping the check for circular references during encoding."),o||s.push(ci),a&&s.push(ui);const l=Array.from(e.data);let c;l.push("|O"),l.push(e.shape),s.length&&(c=(e,t)=>{let n=t;for(let t of s)n=t(e,n);return n});let u=JSON.stringify(l,c,t);return r&&(u=u.replace(/[\u007F-\uFFFF]/g,(e=>{const t=`0000${e.charCodeAt(0).toString(16)}`;return`\\u${t.substring(t.length-4)}`}))),(new TextEncoder).encode(u)}decode(e){const{strict:t}=this.#c;ti(t,"JsonCodec does not yet support non-strict decoding.");const n=Xr(e),r=n.pop();return n.pop(),ti(r,"0D not implemented for JsonCodec."),{data:n,shape:r,stride:Kr(r,"C")}}}function di(e){return e instanceof Gr||e instanceof Wr||e instanceof qr?new Proxy(e,{get:(e,t)=>e.get(Number(t)),set:(e,t,n)=>(e.set(Number(t),n),!0)}):e}class fi{kind="array_to_array";#u;#h;constructor(e,t){let n=e.order??"C",r=t.shape.length,i=new Array(r),o=new Array(r);if("C"===n)for(let e=0;e<r;++e)i[e]=e,o[e]=e;else if("F"===n)for(let e=0;e<r;++e)i[e]=r-e-1,o[e]=r-e-1;else i=n,i.forEach(((e,t)=>{ti(void 0===o[e],`Invalid permutation: ${JSON.stringify(n)}`),o[e]=t}));this.#u=i,this.#h=o}static fromConfig(e,t){return new fi(e,t)}encode(e){return function(e,t){let n=function(e){return ti(e.shape.length===e.stride.length,"Shape and stride must have the same length."),e.stride.map(((e,t)=>({stride:e,index:t}))).sort(((e,t)=>t.stride-e.stride)).map((e=>e.index))}(e);return ti(n.length===t.length,"Orders must match"),n.every(((e,n)=>e===t[n]))}(e,this.#h)?e:function(e,t){let n=function(e,t){let n;return n=e.data instanceof Wr||e.data instanceof qr?new e.constructor(e.data.length,e.data.chars):new e.constructor(e.data.length),{data:n,shape:e.shape,stride:Kr(e.shape,t)}}(e,t),r=e.shape.length,i=e.data.length,o=Array(r).fill(0),a=di(e.data),s=di(n.data);for(let t=0;t<i;t++){let i=0;for(let e=0;e<r;e++)i+=o[e]*n.stride[e];s[i]=a[t],o[0]+=1;for(let t=0;t<r;t++)if(o[t]===e.shape[t]){if(t+1===r)break;o[t]=0,o[t+1]+=1}}return n}(e,this.#h)}decode(e){return{data:e.data,shape:e.shape,stride:Kr(e.shape,this.#u)}}}class pi{kind="array_to_bytes";#a;#d;constructor(e){this.#a=e,this.#d=Kr(e,"C")}static fromConfig(e,t){return new pi(t.shape)}encode(e){throw new Error("Method not implemented.")}decode(e){let t=new TextDecoder,n=new DataView(e.buffer),r=Array(n.getUint32(0,!0)),i=4;for(let o=0;o<r.length;o++){let a=n.getUint32(i,!0);i+=4,r[o]=t.decode(e.buffer.slice(i,i+a)),i+=a}return{data:r,shape:this.#a,stride:this.#d}}}class mi{kind="bytes_to_bytes";static fromConfig(e){return new mi}encode(e){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(e){const t=await ni(e,{format:"deflate"});return new Uint8Array(t)}}const gi=(new Map).set("blosc",(()=>n.e(502).then(n.bind(n,5121)).then((e=>e.default)))).set("lz4",(()=>n.e(274).then(n.bind(n,3274)).then((e=>e.default)))).set("zstd",(()=>n.e(505).then(n.bind(n,7505)).then((e=>e.default)))).set("gzip",(()=>li)).set("zlib",(()=>mi)).set("transpose",(()=>fi)).set("bytes",(()=>ai)).set("crc32c",(()=>si)).set("vlen-utf8",(()=>pi)).set("json2",(()=>hi)).set("bitround",(()=>ri));function vi(e){let t;return{async encode(n){t||(t=await yi(e));for(const e of t.array_to_array)n=await e.encode(n);let r=await t.array_to_bytes.encode(n);for(const e of t.bytes_to_bytes)r=await e.encode(r);return r},async decode(n){t||(t=await yi(e));for(let e=t.bytes_to_bytes.length-1;e>=0;e--)n=await t.bytes_to_bytes[e].decode(n);let r=await t.array_to_bytes.decode(n);for(let e=t.array_to_array.length-1;e>=0;e--)r=await t.array_to_array[e].decode(r);return r}}}async function yi(e){let t,n=e.codecs.map((async e=>{let t=await(gi.get(e.name)?.());return ti(t,`Unknown codec: ${e.name}`),{Codec:t,meta:e}})),r=[],i=[];for await(let{Codec:o,meta:a}of n){let n=o.fromConfig(a.configuration,e);switch(n.kind){case"array_to_array":r.push(n);break;case"array_to_bytes":t=n;break;default:i.push(n)}}return t||(ti("v2:object"!==e.data_type,`Cannot encode ${e.data_type} to bytes without a codec`),t=ai.fromConfig({endian:"little"},e)),{array_to_array:r,array_to_bytes:t,bytes_to_bytes:i}}const bi=18446744073709551615n;function _i(e,t,n,r){ti(e.store.getRange,"Store does not support range requests");let i=e.store.getRange.bind(e.store),o=t.map(((e,t)=>e/r.chunk_shape[t])),a=vi({data_type:"uint64",shape:[...o,2],codecs:r.index_codecs}),s={};return async t=>{let r,l=t.map(((e,t)=>Math.floor(e/o[t]))),c=e.resolve(n(l)).path;if(c in s)r=s[c];else{let e=4,t=16*o.reduce(((e,t)=>e*t),1),n=await i(c,{suffixLength:t+e});r=s[c]=n?await a.decode(n):null}if(null===r)return;let{data:u,shape:h,stride:d}=r,f=t.map(((e,t)=>e%h[t])).reduce(((e,t,n)=>e+t*d[n]),0),p=u[f],m=u[f+1];return p!==bi||m!==bi?i(c,{offset:Number(p),length:Number(m)}):void 0}}class wi{store;path;constructor(e,t="/"){this.store=e,this.path=t}resolve(e){let t=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new wi(this.store,new URL(e,t).pathname)}}class xi extends wi{kind="group";#f;constructor(e,t,n){super(e,t),this.#f=n}get attrs(){return this.#f.attributes}}function Si(e){const t=e.find((e=>"transpose"===e.name));return t?.configuration?.order??"C"}const Ei=Symbol("zarrita.context");class Ai extends wi{kind="array";#f;[Ei];constructor(e,t,n){super(e,t),this.#f={...n,fill_value:Jr(n)},this[Ei]=function(e,t){let{configuration:n}=t.codecs.find(Qr)??{},r={encode_chunk_key:Zr(t.chunk_key_encoding),TypedArray:Yr(t.data_type),fill_value:t.fill_value};if(n){let i=Si(n.codecs);return{...r,kind:"sharded",chunk_shape:n.chunk_shape,codec:vi({data_type:t.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides:e=>Kr(e,i),get_chunk_bytes:_i(e,t.chunk_grid.configuration.chunk_shape,r.encode_chunk_key,n)}}let i=Si(t.codecs);return{...r,kind:"regular",chunk_shape:t.chunk_grid.configuration.chunk_shape,codec:vi({data_type:t.data_type,shape:t.chunk_grid.configuration.chunk_shape,codecs:t.codecs}),get_strides:e=>Kr(e,i),async get_chunk_bytes(t,n){let i=r.encode_chunk_key(t),o=e.resolve(i).path;return e.store.get(o,n)}}}(this,n)}get attrs(){return this.#f.attributes}get shape(){return this.#f.shape}get chunks(){return this[Ei].chunk_shape}get dtype(){return this.#f.data_type}async getChunk(e,t){let n=this[Ei],r=await n.get_chunk_bytes(e,t);if(!r){let e=n.chunk_shape.reduce(((e,t)=>e*t),1),t=new n.TypedArray(e);return t.fill(n.fill_value),{data:t,shape:n.chunk_shape,stride:n.get_strides(n.chunk_shape)}}return n.codec.decode(r)}is(e){return function(e,t){if("number"!==t&&"bigint"!==t&&"boolean"!==t&&"object"!==t&&"string"!==t)return e===t;let n="bool"===e;if("boolean"===t)return n;let r=e.startsWith("v2:U")||e.startsWith("v2:S");if("string"===t)return r;let i="int64"===e||"uint64"===e;if("bigint"===t)return i;let o="v2:object"===e;return"object"===t?o:!(r||i||n||o)}(this.dtype,e)}}class Mi extends Error{constructor(e,t={}){super(`Node not found: ${e}`,t),this.name="NodeNotFoundError"}}class Ti extends Error{constructor(e){super(`Missing key: ${e}`),this.name="KeyError"}}let Ci=function(){let e=new WeakMap;function t(t){let n=e.get(t)??{v2:0,v3:0};return e.set(t,n),n}return{increment(e,n){t(e)[n]+=1},version_max(e){let n=t(e);return n.v3>n.v2?"v3":"v2"}}}();async function Ii(e,t){let{path:n}=e.resolve(".zarray"),r=await e.store.get(n);if(!r)throw new Mi("v2 array",{cause:new Ti(n)});return Ci.increment(e.store,"v2"),new Ai(e.store,e.path,function(e,t={}){let n=[],r=function(e){if("|O"===e)return{data_type:"v2:object"};let t=e.match(/^([<|>])(.*)$/);ti(t,`Invalid dtype: ${e}`);let[,n,r]=t,i={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[r]??(r.startsWith("S")||r.startsWith("U")?`v2:${r}`:void 0);return ti(i,`Unsupported or unknown dtype: ${e}`),"|"===n?{data_type:i}:{data_type:i,endian:"<"===n?"little":"big"}}(e.dtype);"F"===e.order&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in r&&"big"===r.endian&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:t,...r}of e.filters??[])n.push({name:t,configuration:r});if(e.compressor){let{id:t,...r}=e.compressor;n.push({name:t,configuration:r})}return{zarr_format:3,node_type:"array",shape:e.shape,data_type:r.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:e.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:e.dimension_separator??"."}},codecs:n,fill_value:e.fill_value,attributes:t}}(Xr(r),t))}async function Ri(e,t){let{path:n}=e.resolve(".zgroup"),r=await e.store.get(n);if(!r)throw new Mi("v2 group",{cause:new Ti(n)});return Ci.increment(e.store,"v2"),new xi(e.store,e.path,function(e,t={}){return{zarr_format:3,node_type:"group",attributes:t}}(Xr(r),t))}async function Pi(e,t={}){let n="store"in e?e.store:e,r=Ci.version_max(n),i="v2"===r?Pi.v2:Pi.v3,o="v2"===r?Pi.v3:Pi.v2;return i(e,t).catch((n=>(ei(n,Mi),o(e,t))))}Pi.v2=async function(e,t={}){let n="store"in e?e:new wi(e),r={};return(t.attrs??1)&&(r=await async function(e){let t=await e.store.get(e.resolve(".zattrs").path);return t?Xr(t):{}}(n)),"array"===t.kind?Ii(n,r):"group"===t.kind?Ri(n,r):Ii(n,r).catch((e=>(ei(e,Mi),Ri(n,r))))},Pi.v3=async function(e,t={}){let n="store"in e?e:new wi(e),r=await async function(e){let{store:t,path:n}=e.resolve("zarr.json"),r=await e.store.get(n);if(!r)throw new Mi("v3 array or group",{cause:new Ti(n)});let i=Xr(r);return"array"===i.node_type&&(i.fill_value=Jr(i)),"array"===i.node_type?new Ai(t,e.path,i):new xi(t,e.path,i)}(n);if(Ci.increment(n.store,"v3"),void 0===t.kind)return r;if("array"===t.kind&&r instanceof Ai)return r;if("group"===t.kind&&r instanceof xi)return r;let i=r instanceof Ai?"array":"group";throw new Error(`Expected node of kind ${t.kind}, found ${i}.`)},Error,Symbol.iterator,Symbol.iterator,Symbol.iterator,Symbol.iterator;const Li=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map((e=>[e.name,e])),ki=new Map(Li);let Di=function(e){return e.UNKNOWN="unknown",e.NOT_FOUND="not_found",e.TOO_LARGE="too_large",e.LOAD_DATA_FAILED="load_data_failed",e.INVALID_METADATA="invalid_metadata",e.INVALID_MULTI_SOURCE_ZARR="invalid_multi_source_zarr",e}({});class Oi extends Error{constructor(e,t){super(e,t),this.name="VolumeLoadError",this.type=t?.type??Di.UNKNOWN}}function Ni(e="Unknown error occurred while loading volume data",t=Di.UNKNOWN,n){return r=>{if(void 0!==n&&r===n)return r;if(r instanceof Oi)throw r;throw console.log(`Error loading volume data: ${r}`),new Oi(e,{type:t,cause:r})}}ki.set("NodeNotFoundError",Mi),ki.set("KeyError",Ti),ki.set("VolumeLoadError",Oi);const{di:Ui}=r;function Fi(e){switch(e){case"uint8":case"int8":return 1;case"uint16":case"int16":return 2;case"uint32":case"int32":case"float32":return 4;case"float64":return 8;default:throw new Error(`Unsupported dtype: ${e}`)}}const zi=(e,t)=>{const n=Fr(e.sizeZ,e.sizeX,e.sizeY);return{name:e.name,atlasTileDims:[n.x,n.y],subregionSize:[e.sizeX,e.sizeY,e.sizeZ],subregionOffset:[0,0,0],combinedNumChannels:e.sizeC,channelNames:e.channelNames,channelColors:void 0,multiscaleLevel:0,multiscaleLevelDims:[{shape:[1,e.sizeC,e.sizeZ,e.sizeY,e.sizeX],spacing:[1,1,e.physicalPixelSize[2],e.physicalPixelSize[1],e.physicalPixelSize[0]],spaceUnit:e.spatialUnit||"m",timeUnit:"s",dataType:t}],transform:{translation:[0,0,0],rotation:[0,0,0],scale:[1,1,1]},userData:e.userData}};class Bi extends Vr{constructor(e,t){if(super(),this.jsonInfo=t,this.data=e,this.data.shape[0]!==this.jsonInfo.sizeC||this.data.shape[1]!==this.jsonInfo.sizeZ||this.data.shape[2]!==this.jsonInfo.sizeY||this.data.shape[3]!==this.jsonInfo.sizeX)throw new Error("RawArrayLoader: data shape does not match metadata")}async loadDims(e){const t=this.jsonInfo;return[{shape:[1,t.sizeC,t.sizeZ,t.sizeY,t.sizeX],spacing:[1,1,t.physicalPixelSize[2],t.physicalPixelSize[1],t.physicalPixelSize[0]],spaceUnit:t.spatialUnit||"m",dataType:this.data.dtype,timeUnit:"s"}]}async createImageInfo(e){return{imageInfo:zi(this.jsonInfo,this.data.dtype),loadSpec:e}}loadRawChannelData(e,t,n,r){const o=t.channels;n(void 0,{...t,subregion:new i.NRn(new i.Pq0(0,0,0),new i.Pq0(1,1,1)),multiscaleLevel:0});for(let t=0;t<e.combinedNumChannels;++t){if(o&&o.length>0&&!o.includes(t))continue;const e=this.data.shape[3]*this.data.shape[2]*this.data.shape[1],n=new(0,Gt[this.data.dtype])(this.data.buffer.buffer,t*e*Fi(this.data.dtype),e),i=dn(n);r([t],[this.data.dtype],[n],[i])}return Promise.resolve()}}function Vi(e){return(t,...n)=>Hi(e,t,n)}function ji(e,t){return Vi(Xi(e,t).get)}const{apply:Hi,construct:Gi,defineProperty:Wi,get:qi,getOwnPropertyDescriptor:Xi,getPrototypeOf:$i,has:Yi,ownKeys:Ki,set:Zi,setPrototypeOf:Qi}=Reflect,{EPSILON:Ji,MAX_SAFE_INTEGER:eo,isFinite:to,isNaN:no}=Number,{iterator:ro,species:io,toStringTag:oo,for:ao}=Symbol,so=Object,{create:lo,defineProperty:co,freeze:uo,is:ho}=so,fo=so.prototype,po=(fo.__lookupGetter__&&Vi(fo.__lookupGetter__),so.hasOwn||Vi(fo.hasOwnProperty),Array),mo=(po.isArray,po.prototype),go=(Vi(mo.join),Vi(mo.push),Vi(mo.toLocaleString),mo[ro]),vo=Vi(go),{abs:yo,trunc:bo}=Math,_o=ArrayBuffer,wo=(_o.isView,_o.prototype),xo=(Vi(wo.slice),ji(wo,"byteLength"),"undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null),So=(xo&&ji(xo.prototype,"byteLength"),$i(Uint8Array)),Eo=(So.from,So.prototype),Ao=(Eo[ro],Vi(Eo.keys),Vi(Eo.values),Vi(Eo.entries),Vi(Eo.set),Vi(Eo.reverse),Vi(Eo.fill),Vi(Eo.copyWithin),Vi(Eo.sort),Vi(Eo.slice),Vi(Eo.subarray),ji(Eo,"buffer"),ji(Eo,"byteOffset"),ji(Eo,"length"),ji(Eo,oo),Uint8Array),Mo=Uint16Array,To=Uint32Array,Co=Float32Array,Io=$i([][ro]()),Ro=Vi(Io.next),Po=Vi(function*(){}().next),Lo=$i(Io),ko=DataView.prototype,Do=Vi(ko.getUint16),Oo=(Vi(ko.setUint16),TypeError,WeakSet.prototype),No=(Vi(Oo.add),Vi(Oo.has),WeakMap),Uo=No.prototype,Fo=Vi(Uo.get),zo=(Vi(Uo.has),Vi(Uo.set)),Bo=new No,Vo=lo(null,{next:{value:function(){const e=Fo(Bo,this);return Ro(e)}},[ro]:{value:function(){return this}}}),jo=new No,Ho=lo(Lo,{next:{value:function(){const e=Fo(jo,this);return Po(e)},writable:!0,configurable:!0}});for(const e of Ki(Io))"next"!==e&&co(Ho,e,Xi(Io,e));const Go=new _o(4),Wo=new Co(Go),qo=new To(Go),Xo=new Mo(512),$o=new Ao(512);for(let e=0;e<256;++e){const t=e-127;t<-24?(Xo[e]=0,Xo[256|e]=32768,$o[e]=24,$o[256|e]=24):t<-14?(Xo[e]=1024>>-t-14,Xo[256|e]=1024>>-t-14|32768,$o[e]=-t-1,$o[256|e]=-t-1):t<=15?(Xo[e]=t+15<<10,Xo[256|e]=t+15<<10|32768,$o[e]=13,$o[256|e]=13):t<128?(Xo[e]=31744,Xo[256|e]=64512,$o[e]=24,$o[256|e]=24):(Xo[e]=31744,Xo[256|e]=64512,$o[e]=13,$o[256|e]=13)}const Yo=new To(2048);for(let e=1;e<1024;++e){let t=e<<13,n=0;for(;!(8388608&t);)t<<=1,n-=8388608;t&=-8388609,n+=947912704,Yo[e]=t|n}for(let e=1024;e<2048;++e)Yo[e]=939524096+(e-1024<<13);const Ko=new To(64);for(let e=1;e<31;++e)Ko[e]=e<<23;Ko[31]=1199570944,Ko[32]=2147483648;for(let e=33;e<63;++e)Ko[e]=2147483648+(e-32<<23);Ko[63]=3347054592;const Zo=new Mo(64);for(let e=1;e<64;++e)32!==e&&(Zo[e]=1024);function Qo(e,t,...n){return function(e){const t=e>>10;return qo[0]=Yo[Zo[t]+(1023&e)]+Ko[t],Wo[0]}(Do(e,t,...function(e){if(e[ro]===go&&Io.next===Ro)return e;const t=lo(Vo);return zo(Bo,t,vo(e)),t}(n)))}var Jo=n(7379),ea=n(563),ta=n(8622);const na=new Map;function ra(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>na.set(e,t)))}function ia(e,t,n,r=1){return new(Object.getPrototypeOf(e).constructor)(t*n*r)}function oa(e,t,n){return(1-n)*e+n*t}function aa(e,t,n){let r=0;for(let i=t;i<n;++i)r+=e[i];return r}function sa(e,t,n){switch(e){case 1:if(t<=8)return new Uint8Array(n);if(t<=16)return new Uint16Array(n);if(t<=32)return new Uint32Array(n);break;case 2:if(8===t)return new Int8Array(n);if(16===t)return new Int16Array(n);if(32===t)return new Int32Array(n);break;case 3:switch(t){case 16:case 32:return new Float32Array(n);case 64:return new Float64Array(n)}}throw Error("Unsupported data format/bitsPerSample")}ra([void 0,1],(()=>n.e(121).then(n.bind(n,7502)).then((e=>e.default)))),ra(5,(()=>n.e(764).then(n.bind(n,2764)).then((e=>e.default)))),ra(6,(()=>{throw new Error("old style JPEG compression is not supported.")})),ra(7,(()=>n.e(457).then(n.bind(n,6457)).then((e=>e.default)))),ra([8,32946],(()=>Promise.all([n.e(148),n.e(424)]).then(n.bind(n,424)).then((e=>e.default)))),ra(32773,(()=>n.e(30).then(n.bind(n,1030)).then((e=>e.default)))),ra(34887,(()=>Promise.all([n.e(148),n.e(414)]).then(n.bind(n,1414)).then((async e=>(await e.zstd.init(),e))).then((e=>e.default)))),ra(50001,(()=>n.e(568).then(n.bind(n,6568)).then((e=>e.default))));const la=class{constructor(e,t,n,r,i,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=n,this.littleEndian=r,this.tiles=i?{}:null,this.isTiled=!e.StripOffsets;const a=e.PlanarConfiguration;if(this.planarConfiguration=void 0===a?1:a,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,n=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(e,t){return Qo(this,e,t)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){return sa(this.getSampleFormat(e),this.getBitsPerSample(e),t)}async getTileOrStrip(e,t,n,r,i){const o=Math.ceil(this.getWidth()/this.getTileWidth()),a=Math.ceil(this.getHeight()/this.getTileHeight());let s;const{tiles:l}=this;let c,u;1===this.planarConfiguration?s=t*o+e:2===this.planarConfiguration&&(s=n*o*a+t*o+e),this.isTiled?(c=this.fileDirectory.TileOffsets[s],u=this.fileDirectory.TileByteCounts[s]):(c=this.fileDirectory.StripOffsets[s],u=this.fileDirectory.StripByteCounts[s]);const h=(await this.source.fetch([{offset:c,length:u}],i))[0];let d;return null!==l&&l[s]?d=l[s]:(d=(async()=>{let e=await r.decode(this.fileDirectory,h);const n=this.getSampleFormat(),i=this.getBitsPerSample();return function(e,t){return(1!==e&&2!==e||!(t<=32)||t%8!=0)&&(3!==e||16!==t&&32!==t&&64!==t)}(n,i)&&(e=function(e,t,n,r,i,o,a){const s=new DataView(e),l=2===n?1:r,c=sa(t,i,2===n?a*o:a*o*r),u=parseInt("1".repeat(i),2);if(1===t){let e;e=1===n?r*i:i;let t=o*e;7&t&&(t=t+7&-8);for(let e=0;e<a;++e){const n=e*t;for(let t=0;t<o;++t){const r=n+t*l*i;for(let n=0;n<l;++n){const a=r+n*i,h=(e*o+t)*l+n,d=Math.floor(a/8),f=a%8;if(f+i<=8)c[h]=s.getUint8(d)>>8-i-f&u;else if(f+i<=16)c[h]=s.getUint16(d)>>16-i-f&u;else if(f+i<=24){const e=s.getUint16(d)<<8|s.getUint8(d+2);c[h]=e>>24-i-f&u}else c[h]=s.getUint32(d)>>32-i-f&u}}}}return c.buffer}(e,n,this.planarConfiguration,this.getSamplesPerPixel(),i,this.getTileWidth(),this.getBlockHeight(t))),e})(),null!==l&&(l[s]=d)),{x:e,y:t,sample:n,data:await d}}async _readRaster(e,t,n,r,i,o,a,s,l){const c=this.getTileWidth(),u=this.getTileHeight(),h=this.getWidth(),d=this.getHeight(),f=Math.max(Math.floor(e[0]/c),0),p=Math.min(Math.ceil(e[2]/c),Math.ceil(h/c)),m=Math.max(Math.floor(e[1]/u),0),g=Math.min(Math.ceil(e[3]/u),Math.ceil(d/u)),v=e[2]-e[0];let y=this.getBytesPerPixel();const b=[],_=[];for(let e=0;e<t.length;++e)1===this.planarConfiguration?b.push(aa(this.fileDirectory.BitsPerSample,0,t[e])/8):b.push(0),_.push(this.getReaderForSample(t[e]));const w=[],{littleEndian:x}=this;for(let o=m;o<g;++o)for(let a=f;a<p;++a){let s;1===this.planarConfiguration&&(s=this.getTileOrStrip(a,o,0,i,l));for(let f=0;f<t.length;++f){const p=f,m=t[f];2===this.planarConfiguration&&(y=this.getSampleByteSize(m),s=this.getTileOrStrip(a,o,m,i,l));const g=s.then((i=>{const o=i.data,a=new DataView(o),s=this.getBlockHeight(i.y),l=i.y*u,f=i.x*c,m=l+s,g=(i.x+1)*c,w=_[p],S=Math.min(s,s-(m-e[3]),d-l),E=Math.min(c,c-(g-e[2]),h-f);for(let i=Math.max(0,e[1]-l);i<S;++i)for(let o=Math.max(0,e[0]-f);o<E;++o){const s=(i*c+o)*y,u=w.call(a,s+b[p],x);let h;r?(h=(i+l-e[1])*v*t.length+(o+f-e[0])*t.length+p,n[h]=u):(h=(i+l-e[1])*v+o+f-e[0],n[p][h]=u)}}));w.push(g)}}if(await Promise.all(w),o&&e[2]-e[0]!==o||a&&e[3]-e[1]!==a){let i;return i=r?function(e,t,n,r,i,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return function(e,t,n,r,i,o){const a=t/r,s=n/i,l=ia(e,r,i,o);for(let c=0;c<i;++c){const i=Math.min(Math.round(s*c),n-1);for(let n=0;n<r;++n){const s=Math.min(Math.round(a*n),t-1);for(let a=0;a<o;++a){const u=e[i*t*o+s*o+a];l[c*r*o+n*o+a]=u}}}return l}(e,t,n,r,i,o);case"bilinear":case"linear":return function(e,t,n,r,i,o){const a=t/r,s=n/i,l=ia(e,r,i,o);for(let c=0;c<i;++c){const i=s*c,u=Math.floor(i),h=Math.min(Math.ceil(i),n-1);for(let n=0;n<r;++n){const s=a*n,d=s%1,f=Math.floor(s),p=Math.min(Math.ceil(s),t-1);for(let a=0;a<o;++a){const s=e[u*t*o+f*o+a],m=e[u*t*o+p*o+a],g=e[h*t*o+f*o+a],v=e[h*t*o+p*o+a],y=oa(oa(s,m,d),oa(g,v,d),i%1);l[c*r*o+n*o+a]=y}}}return l}(e,t,n,r,i,o);default:throw new Error(`Unsupported resampling method: '${a}'`)}}(n,e[2]-e[0],e[3]-e[1],o,a,t.length,s):function(e,t,n,r,i,o="nearest"){switch(o.toLowerCase()){case"nearest":return function(e,t,n,r,i){const o=t/r,a=n/i;return e.map((e=>{const s=ia(e,r,i);for(let l=0;l<i;++l){const i=Math.min(Math.round(a*l),n-1);for(let n=0;n<r;++n){const a=Math.min(Math.round(o*n),t-1),c=e[i*t+a];s[l*r+n]=c}}return s}))}(e,t,n,r,i);case"bilinear":case"linear":return function(e,t,n,r,i){const o=t/r,a=n/i;return e.map((e=>{const s=ia(e,r,i);for(let l=0;l<i;++l){const i=a*l,c=Math.floor(i),u=Math.min(Math.ceil(i),n-1);for(let n=0;n<r;++n){const a=o*n,h=a%1,d=Math.floor(a),f=Math.min(Math.ceil(a),t-1),p=e[c*t+d],m=e[c*t+f],g=e[u*t+d],v=e[u*t+f],y=oa(oa(p,m,h),oa(g,v,h),i%1);s[l*r+n]=y}}return s}))}(e,t,n,r,i);default:throw new Error(`Unsupported resampling method: '${o}'`)}}(n,e[2]-e[0],e[3]-e[1],o,a,s),i.width=o,i.height=a,i}return n.width=o||e[2]-e[0],n.height=a||e[3]-e[1],n}async readRasters({window:e,samples:t=[],interleave:n,pool:r=null,width:i,height:o,resampleMethod:a,fillValue:s,signal:l}={}){const c=e||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const u=(c[2]-c[0])*(c[3]-c[1]),h=this.getSamplesPerPixel();if(t&&t.length){for(let e=0;e<t.length;++e)if(t[e]>=h)return Promise.reject(new RangeError(`Invalid sample index '${t[e]}'.`))}else for(let e=0;e<h;++e)t.push(e);let d;if(n)d=sa(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),u*t.length),s&&d.fill(s);else{d=[];for(let e=0;e<t.length;++e){const n=this.getArrayForSample(t[e],u);Array.isArray(s)&&e<s.length?n.fill(s[e]):s&&!Array.isArray(s)&&n.fill(s),d.push(n)}}const f=r||await async function(e){const t=na.get(e.Compression);if(!t)throw new Error(`Unknown compression method identifier: ${e.Compression}`);return new(await t())(e)}(this.fileDirectory);return await this._readRaster(c,t,d,n,f,i,o,a,l)}async readRGB({window:e,interleave:t=!0,pool:n=null,width:r,height:i,resampleMethod:o,enableAlpha:a=!1,signal:s}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===ta.ub.RGB){let l=[0,1,2];if(this.fileDirectory.ExtraSamples!==ta.AC.Unspecified&&a){l=[];for(let e=0;e<this.fileDirectory.BitsPerSample.length;e+=1)l.push(e)}return this.readRasters({window:e,interleave:t,samples:l,pool:n,width:r,height:i,resampleMethod:o,signal:s})}let u;switch(c){case ta.ub.WhiteIsZero:case ta.ub.BlackIsZero:case ta.ub.Palette:u=[0];break;case ta.ub.CMYK:u=[0,1,2,3];break;case ta.ub.YCbCr:case ta.ub.CIELab:u=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const h={window:l,interleave:!0,samples:u,pool:n,width:r,height:i,resampleMethod:o,signal:s},{fileDirectory:d}=this,f=await this.readRasters(h),p=2**this.fileDirectory.BitsPerSample[0];let m;switch(c){case ta.ub.WhiteIsZero:m=function(e,t){const{width:n,height:r}=e,i=new Uint8Array(n*r*3);let o;for(let n=0,r=0;n<e.length;++n,r+=3)o=256-e[n]/t*256,i[r]=o,i[r+1]=o,i[r+2]=o;return i}(f,p);break;case ta.ub.BlackIsZero:m=function(e,t){const{width:n,height:r}=e,i=new Uint8Array(n*r*3);let o;for(let n=0,r=0;n<e.length;++n,r+=3)o=e[n]/t*256,i[r]=o,i[r+1]=o,i[r+2]=o;return i}(f,p);break;case ta.ub.Palette:m=function(e,t){const{width:n,height:r}=e,i=new Uint8Array(n*r*3),o=t.length/3,a=t.length/3*2;for(let n=0,r=0;n<e.length;++n,r+=3){const s=e[n];i[r]=t[s]/65536*256,i[r+1]=t[s+o]/65536*256,i[r+2]=t[s+a]/65536*256}return i}(f,d.ColorMap);break;case ta.ub.CMYK:m=function(e){const{width:t,height:n}=e,r=new Uint8Array(t*n*3);for(let t=0,n=0;t<e.length;t+=4,n+=3){const i=e[t],o=e[t+1],a=e[t+2],s=e[t+3];r[n]=(255-i)/256*255*((255-s)/256),r[n+1]=(255-o)/256*255*((255-s)/256),r[n+2]=(255-a)/256*255*((255-s)/256)}return r}(f);break;case ta.ub.YCbCr:m=function(e){const{width:t,height:n}=e,r=new Uint8ClampedArray(t*n*3);for(let t=0,n=0;t<e.length;t+=3,n+=3){const i=e[t],o=e[t+1],a=e[t+2];r[n]=i+1.402*(a-128),r[n+1]=i-.34414*(o-128)-.71414*(a-128),r[n+2]=i+1.772*(o-128)}return r}(f);break;case ta.ub.CIELab:m=function(e){const{width:t,height:n}=e,r=new Uint8Array(t*n*3);for(let t=0,n=0;t<e.length;t+=3,n+=3){let i,o,a,s=(e[t+0]+16)/116,l=(e[t+1]<<24>>24)/500+s,c=s-(e[t+2]<<24>>24)/200;l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),s=1*(s*s*s>.008856?s*s*s:(s-16/116)/7.787),c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),i=3.2406*l+-1.5372*s+-.4986*c,o=-.9689*l+1.8758*s+.0415*c,a=.0557*l+-.204*s+1.057*c,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,r[n]=255*Math.max(0,Math.min(1,i)),r[n+1]=255*Math.max(0,Math.min(1,o)),r[n+2]=255*Math.max(0,Math.min(1,a))}return r}(f);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const e=new Uint8Array(m.length/3),t=new Uint8Array(m.length/3),n=new Uint8Array(m.length/3);for(let r=0,i=0;r<m.length;r+=3,++i)e[i]=m[r],t[i]=m[r+1],n[i]=m[r+2];m=[e,t,n]}return m.width=f.width,m.height=f.height,m}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let r=ea(n,"Item");r=null===e?r.filter((e=>void 0===Jo(e,"sample"))):r.filter((t=>Number(Jo(t,"sample"))===e));for(let e=0;e<r.length;++e){const n=r[e];t[Jo(n,"name")]=n.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(n)return 0===n[1]&&0===n[4]?[n[0],-n[5],n[10]]:[Math.sqrt(n[0]*n[0]+n[4]*n[4]),-Math.sqrt(n[1]*n[1]+n[5]*n[5]),n[10]];if(e){const[t,n,r]=e.getResolution();return[t*e.getWidth()/this.getWidth(),n*e.getHeight()/this.getHeight(),r*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(e=!1){const t=this.getHeight(),n=this.getWidth();if(this.fileDirectory.ModelTransformation&&!e){const[e,r,i,o,a,s,l,c]=this.fileDirectory.ModelTransformation,u=[[0,0],[0,t],[n,0],[n,t]].map((([t,n])=>[o+e*t+r*n,c+a*t+s*n])),h=u.map((e=>e[0])),d=u.map((e=>e[1]));return[Math.min(...h),Math.min(...d),Math.max(...h),Math.max(...d)]}{const e=this.getOrigin(),r=this.getResolution(),i=e[0],o=e[1],a=i+r[0]*n,s=o+r[1]*t;return[Math.min(i,a),Math.min(o,s),Math.max(i,a),Math.max(o,s)]}}};class ca{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const n=this.getUint32(e,t),r=this.getUint32(e+4,t);let i;if(t){if(i=n+2**32*r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*n+r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}getInt64(e,t){let n=0;const r=(128&this._dataView.getUint8(e+(t?7:0)))>0;let i=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(t?o:7-o));r&&(i?0!==a&&(a=255&~(a-1),i=!1):a=255&~a),n+=a*256**o}return r&&(n=-n),n}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return Qo(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class ua{constructor(e,t,n,r){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=n,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),n=this.readUint32(e+4);let r;if(this._littleEndian){if(r=t+2**32*n,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*t+n,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(e){let t=0;const n=(128&this._dataView.getUint8(e+(this._littleEndian?7:0)))>0;let r=!0;for(let i=0;i<8;i++){let o=this._dataView.getUint8(e+(this._littleEndian?i:7-i));n&&(r?0!==o&&(o=255&~(o-1),r=!1):o=255&~o),t+=o*256**i}return n&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}function ha(e){if(void 0!==Object.fromEntries)return Object.fromEntries(e);const t={};for(const[n,r]of e)t[n.toLowerCase()]=r;return t}function da(e){return ha(e.split("\r\n").map((e=>{const t=e.split(":").map((e=>e.trim()));return t[0]=t[0].toLowerCase(),t})))}function fa(e){let t,n,r;return e&&([,t,n,r]=e.match(/bytes (\d+)-(\d+)\/(\d+)/),t=parseInt(t,10),n=parseInt(n,10),r=parseInt(r,10)),{start:t,end:n,total:r}}class pa{async fetch(e,t=void 0){return Promise.all(e.map((e=>this.fetchSlice(e,t))))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class ma extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield e)}for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const r="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;return this.cache.has(e)?this.cache.set(e,{value:t,expiry:r}):this._set(e,{value:t,expiry:r}),this}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[r,i]=n;!1===this._deleteIfExpired(r,i)&&(yield[r,i.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[r,i]=n;this.cache.has(r)||!1===this._deleteIfExpired(r,i)&&(yield[r,i.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,r]of this.entriesAscending())e.call(t,r,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class ga extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,ga),this.name="AbortError"}}class va extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const ya=va;class ba{constructor(e,t,n=null){this.offset=e,this.length=t,this.data=n}get top(){return this.offset+this.length}}class _a{constructor(e,t,n){this.offset=e,this.length=t,this.blockIds=n}}class wa extends pa{constructor(e,{blockSize:t=65536,cacheSize:n=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new ma({maxSize:n,onEviction:(e,t)=>{this.evictedBlocks.set(e,t)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const n=[],r=[],i=[];this.evictedBlocks.clear();for(const{offset:t,length:o}of e){let e=t+o;const{fileSize:a}=this;null!==a&&(e=Math.min(e,a));for(let o=Math.floor(t/this.blockSize)*this.blockSize;o<e;o+=this.blockSize){const e=Math.floor(o/this.blockSize);this.blockCache.has(e)||this.blockRequests.has(e)||(this.blockIdsToFetch.add(e),r.push(e)),this.blockRequests.has(e)&&n.push(this.blockRequests.get(e)),i.push(e)}}await async function(){return new Promise((e=>setTimeout(e,undefined)))}(),this.fetchBlocks(t);const o=[];for(const e of r)this.blockRequests.has(e)&&o.push(this.blockRequests.get(e));await Promise.allSettled(n),await Promise.allSettled(o);const a=[],s=i.filter((e=>this.abortedBlockIds.has(e)||!this.blockCache.has(e)));if(s.forEach((e=>this.blockIdsToFetch.add(e))),s.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const e of s){const t=this.blockRequests.get(e);if(!t)throw new Error(`Block ${e} is not in the block requests`);a.push(t)}await Promise.allSettled(a)}if(t&&t.aborted)throw new ga("Request was aborted");const l=i.map((e=>this.blockCache.get(e)||this.evictedBlocks.get(e))),c=l.filter((e=>!e));if(c.length)throw new ya(c,"Request failed");const u=new Map(function(e,t){const n=Array.isArray(e)?e:Array.from(e),r=Array.isArray(t)?t:Array.from(t);return n.map(((e,t)=>[e,r[t]]))}(i,l));return this.readSliceData(e,u)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(t,e);for(let r=0;r<t.length;++r){const i=t[r];for(const t of i.blockIds)this.blockRequests.set(t,(async()=>{try{const e=(await n)[r],i=t*this.blockSize,o=i-e.offset,a=Math.min(o+this.blockSize,e.data.byteLength),s=e.data.slice(o,a),l=new ba(i,s.byteLength,s,t);this.blockCache.set(t,l),this.abortedBlockIds.delete(t)}catch(n){if("AbortError"!==n.name)throw n;n.signal=e,this.blockCache.delete(t),this.abortedBlockIds.add(t)}finally{this.blockRequests.delete(t)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort(((e,t)=>e-t));if(0===t.length)return[];let n=[],r=null;const i=[];for(const e of t)null===r||r+1===e?(n.push(e),r=e):(i.push(new _a(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[e],r=e);return i.push(new _a(n[0]*this.blockSize,n.length*this.blockSize,n)),i}readSliceData(e,t){return e.map((e=>{let n=e.offset+e.length;null!==this.fileSize&&(n=Math.min(this.fileSize,n));const r=Math.floor(e.offset/this.blockSize),i=Math.floor(n/this.blockSize),o=new ArrayBuffer(e.length),a=new Uint8Array(o);for(let o=r;o<=i;++o){const r=t.get(o),i=r.offset-e.offset;let s,l=0,c=0;i<0?l=-i:i>0&&(c=i),s=r.top-n<0?r.length-l:n-r.offset-l;const u=new Uint8Array(r.data,l,s);a.set(u,c)}return o}))}}class xa{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Sa{constructor(e){this.url=e}async request({headers:e,signal:t}={}){throw new Error("request is not implemented")}}class Ea extends xa{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class Aa extends Sa{constructor(e,t){super(e),this.credentials=t}async request({headers:e,signal:t}={}){const n=await fetch(this.url,{headers:e,credentials:this.credentials,signal:t});return new Ea(n)}}class Ma extends xa{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class Ta extends Sa{constructRequest(e,t){return new Promise(((n,r)=>{const i=new XMLHttpRequest;i.open("GET",this.url),i.responseType="arraybuffer";for(const[t,n]of Object.entries(e))i.setRequestHeader(t,n);i.onload=()=>{const e=i.response;n(new Ma(i,e))},i.onerror=r,i.onabort=()=>r(new ga("Request aborted")),i.send(),t&&(t.aborted&&i.abort(),t.addEventListener("abort",(()=>i.abort())))}))}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}var Ca=n(8625),Ia=n(6504),Ra=n(6580);class Pa extends xa{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class La extends Sa{constructor(e){super(e),this.parsedUrl=Ra.parse(this.url),this.httpApi="http:"===this.parsedUrl.protocol?Ca:Ia}constructRequest(e,t){return new Promise(((n,r)=>{const i=this.httpApi.get({...this.parsedUrl,headers:e},(e=>{const t=new Promise((t=>{const n=[];e.on("data",(e=>{n.push(e)})),e.on("end",(()=>{const e=Buffer.concat(n).buffer;t(e)})),e.on("error",r)}));n(new Pa(e,t))}));i.on("error",r),t&&(t.aborted&&i.destroy(new ga("Request aborted")),t.addEventListener("abort",(()=>i.destroy(new ga("Request aborted")))))}))}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class ka extends pa{constructor(e,t,n,r){super(),this.client=e,this.headers=t,this.maxRanges=n,this.allowFullFile=r,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length,Promise.all(e.map((e=>this.fetchSlice(e,t)))))}async fetchSlices(e,t){const n=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map((({offset:e,length:t})=>`${e}-${e+t}`)).join(",")}`},signal:t});if(n.ok){if(206===n.status){const{type:r,params:i}=function(e){const[t,...n]=e.split(";").map((e=>e.trim()));return{type:t,params:ha(n.map((e=>e.split("="))))}}(n.getHeader("content-type"));if("multipart/byteranges"===r){const e=function(e,t){let n=null;const r=new TextDecoder("ascii"),i=[],o=`--${t}`,a=`${o}--`;for(let t=0;t<10;++t)r.decode(new Uint8Array(e,t,o.length))===o&&(n=t);if(null===n)throw new Error("Could not find initial boundary");for(;n<e.byteLength;){const t=r.decode(new Uint8Array(e,n,Math.min(o.length+1024,e.byteLength-n)));if(0===t.length||t.startsWith(a))break;if(!t.startsWith(o))throw new Error("Part does not start with boundary");const s=t.substr(o.length+2);if(0===s.length)break;const l=s.indexOf("\r\n\r\n"),c=da(s.substr(0,l)),{start:u,end:h,total:d}=fa(c["content-range"]),f=n+o.length+l+4,p=parseInt(h,10)+1-parseInt(u,10);i.push({headers:c,data:e.slice(f,f+p),offset:u,length:p,fileSize:d}),n=f+p+4}return i}(await n.getData(),i.boundary);return this._fileSize=e[0].fileSize||null,e}const o=await n.getData(),{start:a,end:s,total:l}=fa(n.getHeader("content-range"));this._fileSize=l||null;const c=[{data:o,offset:a,length:s-a}];if(e.length>1){const n=await Promise.all(e.slice(1).map((e=>this.fetchSlice(e,t))));return c.concat(n)}return c}{if(!this.allowFullFile)throw new Error("Server responded with full file");const e=await n.getData();return this._fileSize=e.byteLength,[{data:e,offset:0,length:e.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:n,length:r}=e,i=await this.client.request({headers:{...this.headers,Range:`bytes=${n}-${n+r}`},signal:t});if(i.ok){if(206===i.status){const e=await i.getData(),{total:t}=fa(i.getHeader("content-range"));return this._fileSize=t||null,{data:e,offset:n,length:r}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const e=await i.getData();return this._fileSize=e.byteLength,{data:e,offset:0,length:e.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function Da(e,{blockSize:t,cacheSize:n}){return null===t?e:new wa(e,{blockSize:t,cacheSize:n})}function Oa(e){switch(e){case ta.s$.BYTE:case ta.s$.ASCII:case ta.s$.SBYTE:case ta.s$.UNDEFINED:return 1;case ta.s$.SHORT:case ta.s$.SSHORT:return 2;case ta.s$.LONG:case ta.s$.SLONG:case ta.s$.FLOAT:case ta.s$.IFD:return 4;case ta.s$.RATIONAL:case ta.s$.SRATIONAL:case ta.s$.DOUBLE:case ta.s$.LONG8:case ta.s$.SLONG8:case ta.s$.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${e}`)}}function Na(e,t,n,r){let i=null,o=null;const a=Oa(t);switch(t){case ta.s$.BYTE:case ta.s$.ASCII:case ta.s$.UNDEFINED:i=new Uint8Array(n),o=e.readUint8;break;case ta.s$.SBYTE:i=new Int8Array(n),o=e.readInt8;break;case ta.s$.SHORT:i=new Uint16Array(n),o=e.readUint16;break;case ta.s$.SSHORT:i=new Int16Array(n),o=e.readInt16;break;case ta.s$.LONG:case ta.s$.IFD:i=new Uint32Array(n),o=e.readUint32;break;case ta.s$.SLONG:i=new Int32Array(n),o=e.readInt32;break;case ta.s$.LONG8:case ta.s$.IFD8:i=new Array(n),o=e.readUint64;break;case ta.s$.SLONG8:i=new Array(n),o=e.readInt64;break;case ta.s$.RATIONAL:i=new Uint32Array(2*n),o=e.readUint32;break;case ta.s$.SRATIONAL:i=new Int32Array(2*n),o=e.readInt32;break;case ta.s$.FLOAT:i=new Float32Array(n),o=e.readFloat32;break;case ta.s$.DOUBLE:i=new Float64Array(n),o=e.readFloat64;break;default:throw new RangeError(`Invalid field type: ${t}`)}if(t!==ta.s$.RATIONAL&&t!==ta.s$.SRATIONAL)for(let t=0;t<n;++t)i[t]=o.call(e,r+t*a);else for(let t=0;t<n;t+=2)i[t]=o.call(e,r+t*a),i[t+1]=o.call(e,r+(t*a+4));return t===ta.s$.ASCII?new TextDecoder("utf-8").decode(i):i}class Ua{constructor(e,t,n){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=n}}class Fa extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class za{async readRasters(e={}){const{window:t,width:n,height:r}=e;let{resX:i,resY:o,bbox:a}=e;const s=await this.getImage();let l=s;const c=await this.getImageCount(),u=s.getBoundingBox();if(t&&a)throw new Error('Both "bbox" and "window" passed.');if(n||r){if(t){const[e,n]=s.getOrigin(),[r,i]=s.getResolution();a=[e+t[0]*r,n+t[1]*i,e+t[2]*r,n+t[3]*i]}const e=a||u;if(n){if(i)throw new Error("Both width and resX passed");i=(e[2]-e[0])/n}if(r){if(o)throw new Error("Both width and resY passed");o=(e[3]-e[1])/r}}if(i||o){const e=[];for(let t=0;t<c;++t){const n=await this.getImage(t),{SubfileType:r,NewSubfileType:i}=n.fileDirectory;(0===t||2===r||1&i)&&e.push(n)}e.sort(((e,t)=>e.getWidth()-t.getWidth()));for(let t=0;t<e.length;++t){const n=e[t],r=(u[2]-u[0])/n.getWidth(),a=(u[3]-u[1])/n.getHeight();if(l=n,i&&i>r||o&&o>a)break}}let h=t;if(a){const[e,t]=s.getOrigin(),[n,r]=l.getResolution(s);h=[Math.round((a[0]-e)/n),Math.round((a[1]-t)/r),Math.round((a[2]-e)/n),Math.round((a[3]-t)/r)],h=[Math.min(h[0],h[2]),Math.min(h[1],h[3]),Math.max(h[0],h[2]),Math.max(h[1],h[3])]}return l.readRasters({...e,window:h})}}class Ba extends za{constructor(e,t,n,r,i={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=n,this.firstIFDOffset=r,this.cache=i.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const n=this.bigTiff?4048:1024;return new ua((await this.source.fetch([{offset:e,length:void 0!==t?t:n}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,n=this.bigTiff?8:2;let r=await this.getSlice(e);const i=this.bigTiff?r.readUint64(e):r.readUint16(e),o=i*t+(this.bigTiff?16:6);r.covers(e,o)||(r=await this.getSlice(e,o));const a={};let s=e+(this.bigTiff?8:2);for(let e=0;e<i;s+=t,++e){const e=r.readUint16(s),t=r.readUint16(s+2),n=this.bigTiff?r.readUint64(s+4):r.readUint32(s+4);let i,o;const l=Oa(t),c=s+(this.bigTiff?12:8);if(l*n<=(this.bigTiff?8:4))i=Na(r,t,n,c);else{const e=r.readOffset(c),o=Oa(t)*n;i=r.covers(e,o)?Na(r,t,n,e):Na(await this.getSlice(e,o),t,n,e)}o=1===n&&-1===ta.NZ.indexOf(e)&&t!==ta.s$.RATIONAL&&t!==ta.s$.SRATIONAL?i[0]:i,a[ta.$[e]]=o}const l=function(e){const t=e.GeoKeyDirectory;if(!t)return null;const n={};for(let r=4;r<=4*t[3];r+=4){const i=ta.Hm[t[r]],o=t[r+1]?ta.$[t[r+1]]:null,a=t[r+2],s=t[r+3];let l=null;if(o){if(l=e[o],null==l)throw new Error(`Could not get value of geoKey '${i}'.`);"string"==typeof l?l=l.substring(s,s+a-1):l.subarray&&(l=l.subarray(s,s+a),1===a&&(l=l[0]))}else l=s;n[i]=l}return n}(a),c=r.readOffset(e+n+t*i);return new Ua(a,l,c)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(0===e)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){if(t instanceof Fa)throw new Fa(e);throw t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(0===t.nextIFDByteOffset)throw new Fa(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new la(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(e){if(!(e instanceof Fa))throw e;t=!1}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;let t=await this.getSlice(e,130);if("GDAL_STRUCTURAL_METADATA_SIZE="===Na(t,ta.s$.ASCII,30,e)){const n=Na(t,ta.s$.ASCII,130,e).split("\n")[0],r=Number(n.split("=")[1].split(" ")[0])+n.length;r>130&&(t=await this.getSlice(e,r));const i=Na(t,ta.s$.ASCII,r,e);this.ghostValues={},i.split("\n").filter((e=>e.length>0)).map((e=>e.split("="))).forEach((([e,t])=>{this.ghostValues[e]=t}))}return this.ghostValues}static async fromSource(e,t,n){const r=(await e.fetch([{offset:0,length:1024}],n))[0],i=new ca(r),o=i.getUint16(0,0);let a;if(18761===o)a=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");a=!1}const s=i.getUint16(2,a);let l;if(42===s)l=!1;else{if(43!==s)throw new TypeError("Invalid magic number.");if(l=!0,8!==i.getUint16(4,a))throw new Error("Unsupported offset byte-size.")}const c=l?i.getUint64(8,a):i.getUint32(4,a);return new Ba(e,a,l,c,t)}close(){return"function"==typeof this.source.close&&this.source.close()}}class Va extends Error{name="NonError";constructor(e){super(Va._prepareSuperMessage(e))}static _prepareSuperMessage(e){try{return JSON.stringify(e)}catch{return String(e)}}}const ja=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Ha=new WeakSet,Ga=e=>ki.get(e)??Error,Wa=({from:e,seen:t,to:n,forceEnumerable:r,maxDepth:i,depth:o,useToJSON:a,serialize:s})=>{if(n||(n=Array.isArray(e)?[]:!s&&Xa(e)?new(Ga(e.name)):{}),t.push(e),o>=i)return n;if(a&&"function"==typeof e.toJSON&&!Ha.has(e))return(e=>{Ha.add(e);const t=e.toJSON();return Ha.delete(e),t})(e);const l=e=>Wa({from:e,seen:[...t],forceEnumerable:r,maxDepth:i,depth:o,useToJSON:a,serialize:s});for(const[r,i]of Object.entries(e))if(i&&i instanceof Uint8Array&&"Buffer"===i.constructor.name)n[r]="[object Buffer]";else if(null===i||"object"!=typeof i||"function"!=typeof i.pipe){if("function"!=typeof i)if(i&&"object"==typeof i)t.includes(e[r])?n[r]="[Circular]":(o++,n[r]=l(e[r]));else try{n[r]=i}catch{}}else n[r]="[object Stream]";for(const{property:t,enumerable:i}of ja)void 0!==e[t]&&null!==e[t]&&Object.defineProperty(n,t,{value:Xa(e[t])?l(e[t]):e[t],enumerable:!!r||i,configurable:!0,writable:!0});return n};function qa(e,t={}){const{maxDepth:n=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(function(e){return Boolean(e)&&"object"==typeof e&&"message"in e&&!Array.isArray(e)}(e)){const t=Ga(e.name);return Wa({from:e,seen:[],to:new t,maxDepth:n,depth:0,serialize:!1})}return new Va(e)}function Xa(e){return Boolean(e)&&"object"==typeof e&&"name"in e&&"message"in e&&"stack"in e}class $a{sizex=0;sizey=0;sizez=1;sizec=1;sizet=1;unit="";pixeltype="";dimensionorder="";pixelsizex=1;pixelsizey=1;pixelsizez=1;channelnames=[]}function Ya(e){const t={uint8:"uint8",uint16:"uint16",uint32:"uint32",int8:"int8",int16:"int16",int32:"int32",float:"float32"}[e];return void 0===t?(console.warn(`Unsupported OME pixel type ${e}; defaulting to uint8`),"uint8"):t}function Ka(e,t){const n=e.getAttribute(t);if(null===n)throw new Oi(`Missing attribute ${t} in OME-TIFF metadata`,{type:Di.INVALID_METADATA});return n}class Za extends Vr{constructor(e){super(),this.url=e}async loadOmeDims(){if(!this.dims){const t=await async function(e,t={},n){return Ba.fromSource(function(e,{forceXHR:t=!1,...n}={}){return"function"!=typeof fetch||t?"undefined"!=typeof XMLHttpRequest?function(e,{headers:t={},maxRanges:n=0,allowFullFile:r=!1,...i}={}){const o=new Ta(e);return Da(new ka(o,t,n,r),i)}(e,n):function(e,{headers:t={},maxRanges:n=0,allowFullFile:r=!1,...i}={}){const o=new La(e);return Da(new ka(o,t,n,r),i)}(e,n):function(e,{headers:t={},credentials:n,maxRanges:r=0,allowFullFile:i=!1,...o}={}){const a=new Aa(e,n);return Da(new ka(a,t,r,i),o)}(e,n)}(e,t),n)}(this.url[0],{allowFullFile:!0}).catch(Ni(`Could not open TIFF file at ${this.url[0]}`,Di.NOT_FOUND)),n=await t.getImage().catch(Ni("Failed to open TIFF image",Di.NOT_FOUND)),r=function(e){if(void 0===e)return;const t=function(e){return e.trim().replace(/[\u0000]$/g,"").trim()}(e),n=new DOMParser;try{return n.parseFromString(t,"text/xml").getElementsByTagName("OME")[0]}catch(e){return}}(n.getFileDirectory().ImageDescription);if(void 0!==r){const e=r.getElementsByTagName("Image")[0];this.dims=function(e){const t=new $a,n=e.getElementsByTagName("Pixels")[0];t.sizex=Number(Ka(n,"SizeX")),t.sizey=Number(Ka(n,"SizeY")),t.sizez=Number(n.getAttribute("SizeZ")),t.sizec=Number(n.getAttribute("SizeC")),t.sizet=Number(n.getAttribute("SizeT")),t.unit=n.getAttribute("PhysicalSizeXUnit")||"",t.pixeltype=n.getAttribute("Type")||"",t.dimensionorder=n.getAttribute("DimensionOrder")||"XYZCT",t.pixelsizex=Number(n.getAttribute("PhysicalSizeX")),t.pixelsizey=Number(n.getAttribute("PhysicalSizeY")),t.pixelsizez=Number(n.getAttribute("PhysicalSizeZ"));const r=n.getElementsByTagName("Channel");for(let e=0;e<r.length;++e){const n=r[e].getAttribute("Name"),i=r[e].getAttribute("ID");t.channelnames.push(n||i||"Channel"+e)}return t}(e)}else console.warn("Could not read OME-TIFF metadata from file. Doing our best with base TIFF metadata."),this.dims=new $a,this.dims.sizex=n.getWidth(),this.dims.sizey=n.getHeight(),this.dims.sizec=this.url.length>1?this.url.length:1,this.dims.pixeltype=1===(e=n.getBytesPerPixel())?"uint8":2===e?"uint16":"uint32",this.dims.channelnames=Array.from({length:this.dims.sizec},((e,t)=>"Channel"+t))}var e;return this.dims}async loadDims(e){const t=await this.loadOmeDims(),n=Fr(t.sizez,t.sizex,t.sizey),r=Ur,i=Math.floor(r/n.x),o=Math.floor(r/n.y);return[{shape:[t.sizet,t.sizec,t.sizez,o,i],spacing:[1,1,t.pixelsizez,t.pixelsizey*t.sizey/o,t.pixelsizex*t.sizex/i],spaceUnit:t.unit?t.unit:"micron",dataType:Ya(t.pixeltype),timeUnit:"s"}]}async createImageInfo(e){const t=await this.loadOmeDims(),n=Fr(t.sizez,t.sizex,t.sizey),r=Ur,i=Math.floor(r/n.x),o=Math.floor(r/n.y);return{imageInfo:{name:"TEST",atlasTileDims:[n.x,n.y],subregionSize:[i,o,t.sizez],subregionOffset:[0,0,0],combinedNumChannels:t.sizec,channelNames:t.channelnames,multiscaleLevel:0,multiscaleLevelDims:[{shape:[t.sizet,t.sizec,t.sizez,o,i],spacing:[1,1,t.pixelsizez,t.pixelsizey*t.sizey/o,t.pixelsizex*t.sizex/i],spaceUnit:t.unit||"",timeUnit:"",dataType:Ya(t.pixeltype)}],transform:{translation:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}},loadSpec:new Br}}async loadRawChannelData(e,t,r,i){const o=await this.loadOmeDims(),a=new Nr(e).volumeSize,s=[];for(let t=0;t<e.combinedNumChannels;++t){const r=new Promise(((r,s)=>{const l={channel:t,tilesizex:a.x,tilesizey:a.y,sizec:e.combinedNumChannels,sizez:a.z,dimensionOrder:o.dimensionorder,bytesPerSample:(c=o.pixeltype,"uint8"===c?1:"uint16"===c?2:4),url:this.url.length>1?this.url[t]:this.url[0]};var c;const u=new Worker(new URL(n.p+n.u(647),n.b),{type:void 0});u.onmessage=e=>{if(e.data.isError)return void s(qa(e.data.error));const{data:t,dtype:n,channel:o,range:a}=e.data;i([o],[n],[t],[a]),u.terminate(),r()},u.postMessage(l)}));s.push(r)}await Promise.all(s)}}let Qa=function(e){return e[e.T_MINUS=0]="T_MINUS",e[e.T_PLUS=1]="T_PLUS",e[e.Z_MINUS=2]="Z_MINUS",e[e.Z_PLUS=3]="Z_PLUS",e[e.Y_MINUS=4]="Y_MINUS",e[e.Y_PLUS=5]="Y_PLUS",e[e.X_MINUS=6]="X_MINUS",e[e.X_PLUS=7]="X_PLUS",e}({}),Ja=function(e){return e.ZARR="zarr",e.JSON="json",e.TIFF="tiff",e.DATA="data",e}({});var es=n(9739);let ts=function(e){return e[e.INIT=0]="INIT",e[e.CREATE_LOADER=1]="CREATE_LOADER",e[e.CLOSE_LOADER=2]="CLOSE_LOADER",e[e.CREATE_VOLUME=3]="CREATE_VOLUME",e[e.LOAD_DIMS=4]="LOAD_DIMS",e[e.LOAD_VOLUME_DATA=5]="LOAD_VOLUME_DATA",e[e.SET_PREFETCH_PRIORITY_DIRECTIONS=6]="SET_PREFETCH_PRIORITY_DIRECTIONS",e[e.SYNCHRONIZE_MULTICHANNEL_LOADING=7]="SYNCHRONIZE_MULTICHANNEL_LOADING",e[e.UPDATE_FETCH_OPTIONS=8]="UPDATE_FETCH_OPTIONS",e}({}),ns=function(e){return e[e.SUCCESS=0]="SUCCESS",e[e.ERROR=1]="ERROR",e[e.EVENT=2]="EVENT",e}({}),rs=function(e){return e[e.METADATA_UPDATE=0]="METADATA_UPDATE",e[e.CHANNEL_LOAD=1]="CHANNEL_LOAD",e}({});function is(e){return{...e,subregion:new i.NRn((new i.Pq0).copy(e.subregion.min),(new i.Pq0).copy(e.subregion.max))}}const os=es(1,16);class as{pendingRequests=[];workerOpen=!0;onEvent=void 0;constructor(){this.worker=new Worker(new URL(n.p+n.u(283),n.b),{type:void 0}),this.worker.onmessage=this.receiveMessage.bind(this)}registerMessagePromise(e){for(const[t,n]of this.pendingRequests.entries())if(void 0===n)return this.pendingRequests[t]=e,t;return this.pendingRequests.push(e)-1}get isOpen(){return this.workerOpen}close(){this.worker.terminate(),this.workerOpen=!1}sendMessage(e,t,n){let r=-1;const i=new Promise(((t,n)=>{r=this.registerMessagePromise({type:e,resolve:t,reject:n})})),o={msgId:r,type:e,payload:t,loaderId:n};return this.worker.postMessage(o),i}receiveMessage({data:e}){if(e.responseResult===ns.EVENT)this.onEvent?.(e);else{const t=this.pendingRequests[e.msgId];if(void 0===t)throw new Error(`Received response for unknown message ID ${e.msgId}`);if(t.type!==e.type)throw new Error(`Received response of type ${e.type} for message of type ${t.type}`);e.responseResult===ns.ERROR?t.reject(qa(e.payload)):t.resolve(e.payload),this.pendingRequests[e.msgId]=void 0}}}class ss extends Vr{currentLoadId=-1;currentLoadCallback=void 0;currentMetadataUpdateCallback=void 0;constructor(e,t,n){super(),this.loaderId=e,this.workerHandle=t,this.context=n}getLoaderId(){if(void 0===this.loaderId||!this.workerHandle.isOpen)throw new Error("Tried to use a closed loader");return this.loaderId}getContext(){return this.context}close(){void 0!==this.loaderId&&(this.workerHandle.sendMessage(ts.CLOSE_LOADER,void 0,this.loaderId),this.loaderId=void 0)}setPrefetchPriority(e){return this.workerHandle.sendMessage(ts.SET_PREFETCH_PRIORITY_DIRECTIONS,e,this.getLoaderId())}updateFetchOptions(e){return this.workerHandle.sendMessage(ts.UPDATE_FETCH_OPTIONS,e,this.getLoaderId())}syncMultichannelLoading(e){return this.workerHandle.sendMessage(ts.SYNCHRONIZE_MULTICHANNEL_LOADING,e,this.getLoaderId())}loadDims(e){return this.workerHandle.sendMessage(ts.LOAD_DIMS,e,this.getLoaderId())}async createImageInfo(e){const{imageInfo:t,loadSpec:n}=await this.workerHandle.sendMessage(ts.CREATE_VOLUME,e,this.getLoaderId());return{imageInfo:t,loadSpec:is(n)}}loadRawChannelData(e,t,n,r){this.currentLoadCallback=r,this.currentMetadataUpdateCallback=n,this.currentLoadId+=1;const i={imageInfo:e,loadSpec:t,loadId:this.currentLoadId};return this.workerHandle.sendMessage(ts.LOAD_VOLUME_DATA,i,this.getLoaderId())}onChannelData(e){e.loaderId===this.loaderId&&e.loadId===this.currentLoadId&&this.currentLoadCallback?.(e.channelIndex,e.dtype,e.data,e.ranges,e.atlasDims)}onUpdateMetadata(e){if(e.loaderId!==this.loaderId||e.loadId!==this.currentLoadId)return;const t=e.imageInfo,n=e.loadSpec&&is(e.loadSpec);this.currentMetadataUpdateCallback?.(t,n)}}const ls=class{throttleChannelData=!1;constructor(e,t,n){this.workerHandle=new as,this.workerHandle.onEvent=this.handleEvent.bind(this),this.loaders=new Map,this.openPromise=this.workerHandle.sendMessage(ts.INIT,{maxCacheSize:e,maxActiveRequests:t,maxLowPriorityRequests:n})}onOpen(){return this.workerHandle.isOpen?this.openPromise:Promise.reject("Worker is closed")}close(){this.workerHandle.close()}handleEvent(e){const t=this.loaders.get(e.loaderId);t&&(e.eventType===rs.CHANNEL_LOAD?this.throttleChannelData?os((()=>t.onChannelData(e))):t.onChannelData(e):e.eventType===rs.METADATA_UPDATE&&t.onUpdateMetadata(e))}async createLoader(e,t){const n=Array.isArray(e)?e[0]:e,r=t?.fileType||function(e){return e.endsWith(".json")?Ja.JSON:e.endsWith(".tif")||e.endsWith(".tiff")?Ja.TIFF:Ja.ZARR}(n);if(r===Ja.TIFF){const t=Array.isArray(e)?e:[e];return new Za(t)}if(r===Ja.DATA){if(!t?.rawArrayOptions)throw new Error("Failed to create loader: Must provide RawArrayOptions for RawArrayLoader");return new Bi(t.rawArrayOptions.data,t.rawArrayOptions.metadata)}const i=await this.workerHandle.sendMessage(ts.CREATE_LOADER,{path:e,options:t});if(void 0===i)throw new Error("Failed to create loader");const o=new ss(i,this.workerHandle,this);return this.loaders.set(i,o),o}setThrottleChannelData(e){this.throttleChannelData=e}}},3145:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{A:()=>r})},6369:(e,t,n)=>{"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{A:()=>r})},9417:(e,t,n)=>{"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{A:()=>r})},467:(e,t,n)=>{"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,l,"next",e)}function l(e){r(a,i,o,s,l,"throw",e)}s(void 0)}))}}n.d(t,{A:()=>i})},3029:(e,t,n)=>{"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{A:()=>r})},2901:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(816);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,r.A)(i.key),i)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},9426:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(3954),i=n(2176),o=n(6822);function a(e){var t=(0,i.A)();return function(){var n,i=(0,r.A)(e);if(t){var a=(0,r.A)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,o.A)(this,n)}}},4467:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(816);function i(e,t,n){return(t=(0,r.A)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},8168:(e,t,n)=>{"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(null,arguments)}n.d(t,{A:()=>r})},3954:(e,t,n)=>{"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{A:()=>r})},5501:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(3662);function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.A)(e,t)}},2176:(e,t,n)=>{"use strict";function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(r=function(){return!!e})()}n.d(t,{A:()=>r})},3893:(e,t,n)=>{"use strict";function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{A:()=>r})},6562:(e,t,n)=>{"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{A:()=>r})},9379:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(4467);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},3986:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{A:()=>r})},6822:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var r=n(2284),i=n(9417);function o(e,t){if(t&&("object"==(0,r.A)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.A)(e)}},675:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2284);function i(){i=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,o=Object.create(i.prototype),s=new L(r||[]);return a(o,"_invoke",{value:C(e,n,s)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="suspendedYield",g="executing",v="completed",y={};function b(){}function _(){}function w(){}var x={};h(x,l,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(k([])));E&&E!==n&&o.call(E,l)&&(x=E);var A=w.prototype=b.prototype=Object.create(x);function M(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,a,s,l){var c=f(e[i],e,a);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==(0,r.A)(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,l)}))}l(c.arg)}var i;a(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function C(t,n,r){var i=p;return function(o,a){if(i===g)throw Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=I(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=g;var c=f(t,n,r);if("normal"===c.type){if(i=r.done?v:m,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function I(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,I(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=f(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function k(t){if(t||""===t){var n=t[l];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(o.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError((0,r.A)(t)+" is not iterable")}return _.prototype=w,a(A,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:_,configurable:!0}),_.displayName=h(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,h(e,u,"GeneratorFunction")),e.prototype=Object.create(A),e},t.awrap=function(e){return{__await:e}},M(T.prototype),h(T.prototype,c,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new T(d(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},M(A),h(A,u,"Generator"),h(A,l,(function(){return this})),h(A,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=k,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(P),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:k(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}},3662:(e,t,n)=>{"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{A:()=>r})},5544:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(6369),i=n(7800),o=n(6562);function a(e,t){return(0,r.A)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||(0,i.A)(e,t)||(0,o.A)()}},7695:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(6369),i=n(3893),o=n(7800),a=n(6562);function s(e){return(0,r.A)(e)||(0,i.A)(e)||(0,o.A)(e)||(0,a.A)()}},436:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(3145),i=n(3893),o=n(7800);function a(e){return function(e){if(Array.isArray(e))return(0,r.A)(e)}(e)||(0,i.A)(e)||(0,o.A)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},816:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(2284);function i(e){var t=function(e){if("object"!=(0,r.A)(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=(0,r.A)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==(0,r.A)(t)?t:t+""}},2284:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})},7800:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(3145);function i(e,t){if(e){if("string"==typeof e)return(0,r.A)(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.A)(e,t):void 0}}},6188:(e,t,n)=>{"use strict";n.d(t,{k02:()=>r});const r={prefix:"fas",iconName:"up-right-from-square",icon:[512,512,["external-link-alt"],"f35d","M352 0c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9L370.7 96 201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L416 141.3l41.4 41.4c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6l0-128c0-17.7-14.3-32-32-32L352 0zM80 32C35.8 32 0 67.8 0 112L0 432c0 44.2 35.8 80 80 80l320 0c44.2 0 80-35.8 80-80l0-112c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 112c0 8.8-7.2 16-16 16L80 448c-8.8 0-16-7.2-16-16l0-320c0-8.8 7.2-16 16-16l112 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L80 32z"]}},8622:(e,t,n)=>{"use strict";n.d(t,{$:()=>r,AC:()=>c,Hm:()=>d,NZ:()=>o,S3:()=>h,TZ:()=>u,s$:()=>s,ub:()=>l});const r={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},i={};for(const e in r)r.hasOwnProperty(e)&&(i[r[e]]=parseInt(e,10));const o=[i.BitsPerSample,i.ExtraSamples,i.SampleFormat,i.StripByteCounts,i.StripOffsets,i.StripRowCounts,i.TileByteCounts,i.TileOffsets,i.SubIFDs],a={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},s={};for(const e in a)a.hasOwnProperty(e)&&(s[a[e]]=parseInt(e,10));const l={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},c={Unspecified:0,Assocalpha:1,Unassalpha:2},u={Version:0,AddCompression:1},h={None:0,Deflate:1,Zstandard:2},d={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},f={};for(const e in d)d.hasOwnProperty(e)&&(f[d[e]]=parseInt(e,10))},4922:(e,t,n)=>{"use strict";n.d(t,{$EB:()=>f,$Yl:()=>U,$_I:()=>be,$ei:()=>E,$p8:()=>Wo,A$4:()=>ui,AQS:()=>sn,B69:()=>Ur,BKk:()=>zi,BND:()=>ta,BXX:()=>Xe,B_h:()=>nt,CMB:()=>Ne,CSG:()=>So,CVz:()=>Qe,CWW:()=>wt,Cfg:()=>ge,DXC:()=>vo,Dmk:()=>Pe,EZo:()=>g,EdD:()=>y,FFZ:()=>Vt,FV:()=>te,FXf:()=>w,Fn:()=>mt,FvD:()=>bo,GJx:()=>he,GWd:()=>De,GYF:()=>Ki,Gwm:()=>W,H23:()=>gt,HIg:()=>ke,HO_:()=>_t,HXV:()=>Ke,I9Y:()=>rn,IE4:()=>Ge,IUQ:()=>Cn,Iit:()=>Ni,IzY:()=>na,Jnc:()=>s,K52:()=>q,KDk:()=>et,KLL:()=>Lt,KRh:()=>Y,Kef:()=>yt,Kwu:()=>v,Kzv:()=>Oe,LAk:()=>re,LiQ:()=>C,LlO:()=>Fi,LoY:()=>_i,MW4:()=>hi,Mjd:()=>J,Mmk:()=>pn,N5j:()=>At,NRn:()=>Un,NTi:()=>m,Nex:()=>ra,Nt7:()=>L,Nwf:()=>Jo,Nz6:()=>We,O9p:()=>_r,OUM:()=>_e,Om:()=>ue,OuU:()=>R,PJ3:()=>St,PPD:()=>ro,PTz:()=>kn,Pq0:()=>Dn,Q1f:()=>ni,QP0:()=>l,Qev:()=>Wt,Qrf:()=>ot,RQf:()=>Me,Riy:()=>Je,RrE:()=>N,RyA:()=>u,S$4:()=>pt,THS:()=>ci,TdN:()=>Ht,TiK:()=>Ut,TkQ:()=>je,U3G:()=>G,UTZ:()=>oe,V3x:()=>Re,V9B:()=>ai,VCu:()=>_o,VT0:()=>ze,Vb5:()=>a,VxR:()=>Pt,W9U:()=>vt,WNZ:()=>o,Wdf:()=>jt,Wew:()=>Ce,Wk7:()=>c,XG_:()=>bt,XIg:()=>p,XrR:()=>K,YJl:()=>yo,Yuy:()=>Ee,Z58:()=>Yi,ZQM:()=>Be,Zcv:()=>eo,Zr2:()=>Rt,ZyN:()=>Go,_QJ:()=>lt,_Ut:()=>Ui,a55:()=>Yt,a5J:()=>st,aEY:()=>D,aJ8:()=>ie,aVO:()=>Eo,amv:()=>Dt,b4q:()=>Xi,bC7:()=>ht,bCz:()=>b,bI3:()=>Mt,bdM:()=>wo,bkx:()=>Ae,brA:()=>j,bw0:()=>X,c90:()=>He,cHt:()=>Se,caT:()=>$,cj9:()=>nn,czI:()=>rt,dYF:()=>Ln,dcC:()=>Fe,dwI:()=>on,e0p:()=>F,eHc:()=>B,eaF:()=>Li,eoi:()=>Ft,er$:()=>It,f4X:()=>T,fBL:()=>xe,g7M:()=>ne,gJ2:()=>Ie,gO9:()=>_,gPd:()=>Tn,gWB:()=>Bt,ghU:()=>de,hB5:()=>h,hdd:()=>P,hgQ:()=>O,hsX:()=>d,hxR:()=>pe,hy7:()=>ae,iNn:()=>Di,ie2:()=>I,imn:()=>oi,ix0:()=>Te,jR7:()=>qe,jej:()=>dn,jf0:()=>Ct,jzd:()=>zt,k6Q:()=>$e,k6q:()=>ve,kBv:()=>i,kLi:()=>En,kO0:()=>Nt,kRr:()=>ye,kTW:()=>fe,kTp:()=>Ye,kn4:()=>ur,kyO:()=>Q,lGu:()=>V,lPF:()=>cn,ljd:()=>xt,lxW:()=>Oi,lyL:()=>ut,mcG:()=>hn,mrM:()=>io,nCl:()=>Vo,nNL:()=>ee,nST:()=>x,nWS:()=>Rn,nZQ:()=>qo,nc$:()=>ea,o6l:()=>$i,ojh:()=>A,ojs:()=>ft,ov9:()=>z,pBf:()=>Ze,pHI:()=>me,paN:()=>Ve,ppV:()=>yn,psI:()=>at,qUd:()=>jo,qa3:()=>tt,qad:()=>M,qq$:()=>ln,rFo:()=>Pn,rSH:()=>it,sPf:()=>r,tJf:()=>we,tXL:()=>xo,uB5:()=>ct,uV5:()=>ce,ubm:()=>Gi,vim:()=>Ot,vyJ:()=>Tt,wfO:()=>le,wn6:()=>k,wrO:()=>Le,xFO:()=>se,xSv:()=>H,xiE:()=>fn,y3Z:()=>dt,y_p:()=>Z,zdS:()=>Ue,zgK:()=>wr,znC:()=>S});const r="171",i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o=0,a=1,s=2,l=1,c=2,u=3,h=0,d=1,f=2,p=0,m=1,g=2,v=3,y=4,b=5,_=100,w=101,x=102,S=103,E=104,A=200,M=201,T=202,C=203,I=204,R=205,P=206,L=207,k=208,D=209,O=210,N=211,U=212,F=213,z=214,B=0,V=1,j=2,H=3,G=4,W=5,q=6,X=7,$=0,Y=1,K=2,Z=0,Q=1,J=2,ee=3,te=4,ne=5,re=6,ie=7,oe=300,ae=301,se=302,le=303,ce=304,ue=306,he=1e3,de=1001,fe=1002,pe=1003,me=1004,ge=1005,ve=1006,ye=1007,be=1008,_e=1009,we=1010,xe=1011,Se=1012,Ee=1013,Ae=1014,Me=1015,Te=1016,Ce=1017,Ie=1018,Re=1020,Pe=35902,Le=1021,ke=1022,De=1023,Oe=1024,Ne=1025,Ue=1026,Fe=1027,ze=1028,Be=1029,Ve=1030,je=1031,He=1033,Ge=33776,We=33777,qe=33778,Xe=33779,$e=35840,Ye=35841,Ke=35842,Ze=35843,Qe=36196,Je=37492,et=37496,tt=37808,nt=37809,rt=37810,it=37811,ot=37812,at=37813,st=37814,lt=37815,ct=37816,ut=37817,ht=37818,dt=37819,ft=37820,pt=37821,mt=36492,gt=36494,vt=36495,yt=36283,bt=36284,_t=36285,wt=36286,xt=2300,St=2301,Et=2302,At=3201,Mt=0,Tt=1,Ct="",It="srgb",Rt="srgb-linear",Pt="linear",Lt="srgb",kt=7680,Dt=512,Ot=513,Nt=514,Ut=515,Ft=516,zt=517,Bt=518,Vt=519,jt="300 es",Ht=2e3,Gt=2001;class Wt{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const qt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Xt=1234567;const $t=Math.PI/180,Yt=180/Math.PI;function Kt(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(qt[255&e]+qt[e>>8&255]+qt[e>>16&255]+qt[e>>24&255]+"-"+qt[255&t]+qt[t>>8&255]+"-"+qt[t>>16&15|64]+qt[t>>24&255]+"-"+qt[63&n|128]+qt[n>>8&255]+"-"+qt[n>>16&255]+qt[n>>24&255]+qt[255&r]+qt[r>>8&255]+qt[r>>16&255]+qt[r>>24&255]).toLowerCase()}function Zt(e,t,n){return Math.max(t,Math.min(n,e))}function Qt(e,t){return(e%t+t)%t}function Jt(e,t,n){return(1-n)*e+n*t}function en(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function tn(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const nn={DEG2RAD:$t,RAD2DEG:Yt,generateUUID:Kt,clamp:Zt,euclideanModulo:Qt,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Jt,damp:function(e,t,n,r){return Jt(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(Qt(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Xt=e);let t=Xt+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*$t},radToDeg:function(e){return e*Yt},isPowerOfTwo:function(e){return!(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const o=Math.cos,a=Math.sin,s=o(n/2),l=a(n/2),c=o((t+r)/2),u=a((t+r)/2),h=o((t-r)/2),d=a((t-r)/2),f=o((r-t)/2),p=a((r-t)/2);switch(i){case"XYX":e.set(s*u,l*h,l*d,s*c);break;case"YZY":e.set(l*d,s*u,l*h,s*c);break;case"ZXZ":e.set(l*h,l*d,s*u,s*c);break;case"XZX":e.set(s*u,l*p,l*f,s*c);break;case"YXY":e.set(l*f,s*u,l*p,s*c);break;case"ZYZ":e.set(l*p,l*f,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:tn,denormalize:en};class rn{constructor(e=0,t=0){rn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Zt(this.x,e.x,t.x),this.y=Zt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Zt(this.x,e,t),this.y=Zt(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Zt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Zt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class on{constructor(e,t,n,r,i,o,a,s,l){on.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,o,a,s,l)}set(e,t,n,r,i,o,a,s,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],w=r[5],x=r[8];return i[0]=o*p+a*v+s*_,i[3]=o*m+a*y+s*w,i[6]=o*g+a*b+s*x,i[1]=l*p+c*v+u*_,i[4]=l*m+c*y+u*w,i[7]=l*g+c*b+u*x,i[2]=h*p+d*v+f*_,i[5]=h*m+d*y+f*w,i[8]=h*g+d*b+f*x,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*o*c-t*a*l-n*i*c+n*a*s+r*i*l-r*o*s}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=c*o-a*l,h=a*s-c*i,d=l*i-o*s,f=t*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(r*l-c*n)*p,e[2]=(a*n-r*o)*p,e[3]=h*p,e[4]=(c*t-r*s)*p,e[5]=(r*i-a*t)*p,e[6]=d*p,e[7]=(n*s-l*t)*p,e[8]=(o*t-n*i)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,a){const s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*o+l*a)+o+e,-r*l,r*s,-r*(-l*o+s*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(an.makeScale(e,t)),this}rotate(e){return this.premultiply(an.makeRotation(-e)),this}translate(e,t){return this.premultiply(an.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const an=new on;function sn(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function ln(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function cn(){const e=ln("canvas");return e.style.display="block",e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const un={};function hn(e){e in un||(un[e]=!0,console.warn(e))}function dn(e,t,n){return new Promise((function(r,i){setTimeout((function o(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(o,n);break;default:r()}}),n)}))}function fn(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function pn(e){const t=e.elements;-1===t[11]?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=1-t[14])}const mn=(new on).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),gn=(new on).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function vn(){const e={enabled:!0,workingColorSpace:Rt,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===Lt&&(e.r=bn(e.r),e.g=bn(e.g),e.b=bn(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===Lt&&(e.r=_n(e.r),e.g=_n(e.g),e.b=_n(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===Ct?Pt:this.spaces[e].transfer},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[Rt]:{primaries:t,whitePoint:r,transfer:Pt,toXYZ:mn,fromXYZ:gn,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:It},outputColorSpaceConfig:{drawingBufferColorSpace:It}},[It]:{primaries:t,whitePoint:r,transfer:Lt,toXYZ:mn,fromXYZ:gn,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:It}}}),e}const yn=vn();function bn(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function _n(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let wn;class xn{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===wn&&(wn=ln("canvas")),wn.width=e.width,wn.height=e.height;const n=wn.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=wn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=ln("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*bn(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*bn(t[e]/255)):t[e]=bn(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Sn=0;class En{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Sn++}),this.uuid=Kt(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(An(r[t].image)):e.push(An(r[t]))}else e=An(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function An(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?xn.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Mn=0;class Tn extends Wt{constructor(e=Tn.DEFAULT_IMAGE,t=Tn.DEFAULT_MAPPING,n=de,r=de,i=ve,o=be,a=De,s=_e,l=Tn.DEFAULT_ANISOTROPY,c=Ct){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Mn++}),this.uuid=Kt(),this.name="",this.source=new En(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=s,this.offset=new rn(0,0),this.repeat=new rn(1,1),this.center=new rn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new on,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==oe)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case he:e.x=e.x-Math.floor(e.x);break;case de:e.x=e.x<0?0:1;break;case fe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case he:e.y=e.y-Math.floor(e.y);break;case de:e.y=e.y<0?0:1;break;case fe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Tn.DEFAULT_IMAGE=null,Tn.DEFAULT_MAPPING=oe,Tn.DEFAULT_ANISOTROPY=1;class Cn{constructor(e=0,t=0,n=0,r=1){Cn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const o=.01,a=.1,s=e.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],f=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(c-h)<o&&Math.abs(u-p)<o&&Math.abs(f-m)<o){if(Math.abs(c+h)<a&&Math.abs(u+p)<a&&Math.abs(f+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,s=(d+1)/2,v=(g+1)/2,y=(c+h)/4,b=(u+p)/4,_=(f+m)/4;return e>s&&e>v?e<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=b/n):s>v?s<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=y/r,i=_/r):v<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=b/i,r=_/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Zt(this.x,e.x,t.x),this.y=Zt(this.y,e.y,t.y),this.z=Zt(this.z,e.z,t.z),this.w=Zt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Zt(this.x,e,t),this.y=Zt(this.y,e,t),this.z=Zt(this.z,e,t),this.w=Zt(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Zt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class In extends Wt{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Cn(0,0,e,t),this.scissorTest=!1,this.viewport=new Cn(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ve,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const i=new Tn(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);i.flipY=!1,i.generateMipmaps=n.generateMipmaps,i.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let e=0;e<o;e++)this.textures[e]=i.clone(),this.textures[e].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++)this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new En(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Rn extends In{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Pn extends Tn{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=pe,this.minFilter=pe,this.wrapR=de,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ln extends Tn{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=pe,this.minFilter=pe,this.wrapR=de,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class kn{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,o,a){let s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];if(0===a)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===a)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(u!==p||s!==h||l!==d||c!==f){let e=1-a;const t=s*h+l*d+c*f+u*p,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,t*n);e=Math.sin(e*o)/i,a=Math.sin(a*o)/i}const i=a*n;if(s=s*e+h*i,l=l*e+d*i,c=c*e+f*i,u=u*e+p*i,e===1-a){const e=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=e,l*=e,c*=e,u*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,o){const a=n[r],s=n[r+1],l=n[r+2],c=n[r+3],u=i[o],h=i[o+1],d=i[o+2],f=i[o+3];return e[t]=a*f+c*u+s*d-l*h,e[t+1]=s*f+c*h+l*u-a*d,e[t+2]=l*f+c*d+a*h-s*u,e[t+3]=c*f-a*u-s*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,o=e._order,a=Math.cos,s=Math.sin,l=a(n/2),c=a(r/2),u=a(i/2),h=s(n/2),d=s(r/2),f=s(i/2);switch(o){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],a=t[5],s=t[9],l=t[2],c=t[6],u=t[10],h=n+a+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-s)*e,this._y=(i-l)*e,this._z=(o-r)*e}else if(n>a&&n>u){const e=2*Math.sqrt(1+n-a-u);this._w=(c-s)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(i+l)/e}else if(a>u){const e=2*Math.sqrt(1+a-n-u);this._w=(i-l)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(s+c)/e}else{const e=2*Math.sqrt(1+u-n-a);this._w=(o-r)/e,this._x=(i+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Zt(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+o*a+r*l-i*s,this._y=r*c+o*s+i*a-n*l,this._z=i*c+o*l+n*s-r*a,this._w=o*c-n*a-r*s-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const s=1-a*a;if(s<=Number.EPSILON){const e=1-t;return this._w=e*o+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}const l=Math.sqrt(s),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=o*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Dn{constructor(e=0,t=0,n=0){Dn.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Nn.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Nn.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,l=2*(o*r-a*n),c=2*(a*t-i*r),u=2*(i*n-o*t);return this.x=t+s*l+o*u-a*c,this.y=n+s*c+a*l-i*u,this.z=r+s*u+i*c-o*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Zt(this.x,e.x,t.x),this.y=Zt(this.y,e.y,t.y),this.z=Zt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Zt(this.x,e,t),this.y=Zt(this.y,e,t),this.z=Zt(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Zt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return On.copy(this).projectOnVector(e),this.sub(On)}reflect(e){return this.sub(On.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Zt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const On=new Dn,Nn=new kn;class Un{constructor(e=new Dn(1/0,1/0,1/0),t=new Dn(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(zn.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(zn.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=zn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,zn):zn.fromBufferAttribute(r,t),zn.applyMatrix4(e.matrixWorld),this.expandByPoint(zn);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Bn.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Bn.copy(n.boundingBox)),Bn.applyMatrix4(e.matrixWorld),this.union(Bn)}const r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject(r[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,zn),zn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Xn),$n.subVectors(this.max,Xn),Vn.subVectors(e.a,Xn),jn.subVectors(e.b,Xn),Hn.subVectors(e.c,Xn),Gn.subVectors(jn,Vn),Wn.subVectors(Hn,jn),qn.subVectors(Vn,Hn);let t=[0,-Gn.z,Gn.y,0,-Wn.z,Wn.y,0,-qn.z,qn.y,Gn.z,0,-Gn.x,Wn.z,0,-Wn.x,qn.z,0,-qn.x,-Gn.y,Gn.x,0,-Wn.y,Wn.x,0,-qn.y,qn.x,0];return!!Zn(t,Vn,jn,Hn,$n)&&(t=[1,0,0,0,1,0,0,0,1],!!Zn(t,Vn,jn,Hn,$n)&&(Yn.crossVectors(Gn,Wn),t=[Yn.x,Yn.y,Yn.z],Zn(t,Vn,jn,Hn,$n)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,zn).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(zn).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Fn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Fn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Fn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Fn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Fn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Fn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Fn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Fn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Fn)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Fn=[new Dn,new Dn,new Dn,new Dn,new Dn,new Dn,new Dn,new Dn],zn=new Dn,Bn=new Un,Vn=new Dn,jn=new Dn,Hn=new Dn,Gn=new Dn,Wn=new Dn,qn=new Dn,Xn=new Dn,$n=new Dn,Yn=new Dn,Kn=new Dn;function Zn(e,t,n,r,i){for(let o=0,a=e.length-3;o<=a;o+=3){Kn.fromArray(e,o);const a=i.x*Math.abs(Kn.x)+i.y*Math.abs(Kn.y)+i.z*Math.abs(Kn.z),s=t.dot(Kn),l=n.dot(Kn),c=r.dot(Kn);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>a)return!1}return!0}const Qn=new Un,Jn=new Dn,er=new Dn;class tr{constructor(e=new Dn,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):Qn.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Jn.subVectors(e,this.center);const t=Jn.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Jn,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(er.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Jn.copy(e.center).add(er)),this.expandByPoint(Jn.copy(e.center).sub(er))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const nr=new Dn,rr=new Dn,ir=new Dn,or=new Dn,ar=new Dn,sr=new Dn,lr=new Dn;class cr{constructor(e=new Dn,t=new Dn(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,nr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=nr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(nr.copy(this.origin).addScaledVector(this.direction,t),nr.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){rr.copy(e).add(t).multiplyScalar(.5),ir.copy(t).sub(e).normalize(),or.copy(this.origin).sub(rr);const i=.5*e.distanceTo(t),o=-this.direction.dot(ir),a=or.dot(this.direction),s=-or.dot(ir),l=or.lengthSq(),c=Math.abs(1-o*o);let u,h,d,f;if(c>0)if(u=o*s-a,h=o*a-s,f=i*c,u>=0)if(h>=-f)if(h<=f){const e=1/c;u*=e,h*=e,d=u*(u+o*h+2*a)+h*(o*u+h+2*s)+l}else h=i,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h=-i,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;else h<=-f?(u=Math.max(0,-(-o*i+a)),h=u>0?-i:Math.min(Math.max(-i,-s),i),d=-u*u+h*(h+2*s)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-s),i),d=h*(h+2*s)+l):(u=Math.max(0,-(o*i+a)),h=u>0?i:Math.min(Math.max(-i,-s),i),d=-u*u+h*(h+2*s)+l);else h=o>0?-i:i,u=Math.max(0,-(o*h+a)),d=-u*u+h*(h+2*s)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(rr).addScaledVector(ir,h),d}intersectSphere(e,t){nr.subVectors(e.center,this.origin);const n=nr.dot(this.direction),r=nr.dot(nr)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),a=n-o,s=n+o;return s<0?null:a<0?this.at(s,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,a,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||i>r?null:((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,nr)}intersectTriangle(e,t,n,r,i){ar.subVectors(t,e),sr.subVectors(n,e),lr.crossVectors(ar,sr);let o,a=this.direction.dot(lr);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}or.subVectors(this.origin,e);const s=o*this.direction.dot(sr.crossVectors(or,sr));if(s<0)return null;const l=o*this.direction.dot(ar.cross(or));if(l<0)return null;if(s+l>a)return null;const c=-o*or.dot(lr);return c<0?null:this.at(c/a,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ur{constructor(e,t,n,r,i,o,a,s,l,c,u,h,d,f,p,m){ur.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,o,a,s,l,c,u,h,d,f,p,m)}set(e,t,n,r,i,o,a,s,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ur).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/hr.setFromMatrixColumn(e,0).length(),i=1/hr.setFromMatrixColumn(e,1).length(),o=1/hr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=o*c,n=o*u,r=a*c,i=a*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-a*s,t[2]=i-e*l,t[6]=r+n*l,t[10]=o*s}else if("YXZ"===e.order){const e=s*c,n=s*u,r=l*c,i=l*u;t[0]=e+i*a,t[4]=r*a-n,t[8]=o*l,t[1]=o*u,t[5]=o*c,t[9]=-a,t[2]=n*a-r,t[6]=i+e*a,t[10]=o*s}else if("ZXY"===e.order){const e=s*c,n=s*u,r=l*c,i=l*u;t[0]=e-i*a,t[4]=-o*u,t[8]=r+n*a,t[1]=n+r*a,t[5]=o*c,t[9]=i-e*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){const e=o*c,n=o*u,r=a*c,i=a*u;t[0]=s*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=s*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){const e=o*s,n=o*l,r=a*s,i=a*l;t[0]=s*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=o*c,t[9]=-a*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=o*s,n=o*l,r=a*s,i=a*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=o*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=a*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(fr,e,pr)}lookAt(e,t,n){const r=this.elements;return vr.subVectors(e,t),0===vr.lengthSq()&&(vr.z=1),vr.normalize(),mr.crossVectors(n,vr),0===mr.lengthSq()&&(1===Math.abs(n.z)?vr.x+=1e-4:vr.z+=1e-4,vr.normalize(),mr.crossVectors(n,vr)),mr.normalize(),gr.crossVectors(vr,mr),r[0]=mr.x,r[4]=gr.x,r[8]=vr.x,r[1]=mr.y,r[5]=gr.y,r[9]=vr.y,r[2]=mr.z,r[6]=gr.z,r[10]=vr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],w=r[0],x=r[4],S=r[8],E=r[12],A=r[1],M=r[5],T=r[9],C=r[13],I=r[2],R=r[6],P=r[10],L=r[14],k=r[3],D=r[7],O=r[11],N=r[15];return i[0]=o*w+a*A+s*I+l*k,i[4]=o*x+a*M+s*R+l*D,i[8]=o*S+a*T+s*P+l*O,i[12]=o*E+a*C+s*L+l*N,i[1]=c*w+u*A+h*I+d*k,i[5]=c*x+u*M+h*R+d*D,i[9]=c*S+u*T+h*P+d*O,i[13]=c*E+u*C+h*L+d*N,i[2]=f*w+p*A+m*I+g*k,i[6]=f*x+p*M+m*R+g*D,i[10]=f*S+p*T+m*P+g*O,i[14]=f*E+p*C+m*L+g*N,i[3]=v*w+y*A+b*I+_*k,i[7]=v*x+y*M+b*R+_*D,i[11]=v*S+y*T+b*P+_*O,i[15]=v*E+y*C+b*L+_*N,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*s*u-r*l*u-i*a*h+n*l*h+r*a*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*o*h-r*o*d+r*l*c-i*s*c)+e[11]*(+t*l*u-t*a*d-i*o*u+n*o*d+i*a*c-n*l*c)+e[15]*(-r*a*c-t*s*u+t*a*h+r*o*u-n*o*h+n*s*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*h*l+p*s*d-a*m*d-u*s*g+a*h*g,y=f*h*l-c*m*l-f*s*d+o*m*d+c*s*g-o*h*g,b=c*p*l-f*u*l+f*a*d-o*p*d-c*a*g+o*u*g,_=f*u*s-c*p*s-f*a*h+o*p*h+c*a*m-o*u*m,w=t*v+n*y+r*b+i*_;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/w;return e[0]=v*x,e[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*x,e[2]=(a*m*i-p*s*i+p*r*l-n*m*l-a*r*g+n*s*g)*x,e[3]=(u*s*i-a*h*i-u*r*l+n*h*l+a*r*d-n*s*d)*x,e[4]=y*x,e[5]=(c*m*i-f*h*i+f*r*d-t*m*d-c*r*g+t*h*g)*x,e[6]=(f*s*i-o*m*i-f*r*l+t*m*l+o*r*g-t*s*g)*x,e[7]=(o*h*i-c*s*i+c*r*l-t*h*l-o*r*d+t*s*d)*x,e[8]=b*x,e[9]=(f*u*i-c*p*i-f*n*d+t*p*d+c*n*g-t*u*g)*x,e[10]=(o*p*i-f*a*i+f*n*l-t*p*l-o*n*g+t*a*g)*x,e[11]=(c*a*i-o*u*i-c*n*l+t*u*l+o*n*d-t*a*d)*x,e[12]=_*x,e[13]=(c*p*r-f*u*r+f*n*h-t*p*h-c*n*m+t*u*m)*x,e[14]=(f*a*r-o*p*r-f*n*s+t*p*s+o*n*m-t*a*m)*x,e[15]=(o*u*r-c*a*r+c*n*s-t*u*s-o*n*h+t*a*h)*x,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,l=i*o,c=i*a;return this.set(l*o+n,l*a-r*s,l*s+r*a,0,l*a+r*s,c*a+n,c*s-r*o,0,l*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,l=i+i,c=o+o,u=a+a,h=i*l,d=i*c,f=i*u,p=o*c,m=o*u,g=a*u,v=s*l,y=s*c,b=s*u,_=n.x,w=n.y,x=n.z;return r[0]=(1-(p+g))*_,r[1]=(d+b)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(d-b)*w,r[5]=(1-(h+g))*w,r[6]=(m+v)*w,r[7]=0,r[8]=(f+y)*x,r[9]=(m-v)*x,r[10]=(1-(h+p))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=hr.set(r[0],r[1],r[2]).length();const o=hr.set(r[4],r[5],r[6]).length(),a=hr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],dr.copy(this);const s=1/i,l=1/o,c=1/a;return dr.elements[0]*=s,dr.elements[1]*=s,dr.elements[2]*=s,dr.elements[4]*=l,dr.elements[5]*=l,dr.elements[6]*=l,dr.elements[8]*=c,dr.elements[9]*=c,dr.elements[10]*=c,t.setFromRotationMatrix(dr),n.x=i,n.y=o,n.z=a,this}makePerspective(e,t,n,r,i,o,a=Ht){const s=this.elements,l=2*i/(t-e),c=2*i/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r);let d,f;if(a===Ht)d=-(o+i)/(o-i),f=-2*o*i/(o-i);else{if(a!==Gt)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);d=-o/(o-i),f=-o*i/(o-i)}return s[0]=l,s[4]=0,s[8]=u,s[12]=0,s[1]=0,s[5]=c,s[9]=h,s[13]=0,s[2]=0,s[6]=0,s[10]=d,s[14]=f,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,n,r,i,o,a=Ht){const s=this.elements,l=1/(t-e),c=1/(n-r),u=1/(o-i),h=(t+e)*l,d=(n+r)*c;let f,p;if(a===Ht)f=(o+i)*u,p=-2*u;else{if(a!==Gt)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);f=i*u,p=-1*u}return s[0]=2*l,s[4]=0,s[8]=0,s[12]=-h,s[1]=0,s[5]=2*c,s[9]=0,s[13]=-d,s[2]=0,s[6]=0,s[10]=p,s[14]=-f,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const hr=new Dn,dr=new ur,fr=new Dn(0,0,0),pr=new Dn(1,1,1),mr=new Dn,gr=new Dn,vr=new Dn,yr=new ur,br=new kn;class _r{constructor(e=0,t=0,n=0,r=_r.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],o=r[4],a=r[8],s=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Zt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Zt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Zt(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-Zt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(Zt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Zt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return yr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yr,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return br.setFromEuler(this),this.setFromQuaternion(br,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}_r.DEFAULT_ORDER="XYZ";class wr{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let xr=0;const Sr=new Dn,Er=new kn,Ar=new ur,Mr=new Dn,Tr=new Dn,Cr=new Dn,Ir=new kn,Rr=new Dn(1,0,0),Pr=new Dn(0,1,0),Lr=new Dn(0,0,1),kr={type:"added"},Dr={type:"removed"},Or={type:"childadded",child:null},Nr={type:"childremoved",child:null};class Ur extends Wt{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:xr++}),this.uuid=Kt(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ur.DEFAULT_UP.clone();const e=new Dn,t=new _r,n=new kn,r=new Dn(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ur},normalMatrix:{value:new on}}),this.matrix=new ur,this.matrixWorld=new ur,this.matrixAutoUpdate=Ur.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ur.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new wr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Er.setFromAxisAngle(e,t),this.quaternion.multiply(Er),this}rotateOnWorldAxis(e,t){return Er.setFromAxisAngle(e,t),this.quaternion.premultiply(Er),this}rotateX(e){return this.rotateOnAxis(Rr,e)}rotateY(e){return this.rotateOnAxis(Pr,e)}rotateZ(e){return this.rotateOnAxis(Lr,e)}translateOnAxis(e,t){return Sr.copy(e).applyQuaternion(this.quaternion),this.position.add(Sr.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Rr,e)}translateY(e){return this.translateOnAxis(Pr,e)}translateZ(e){return this.translateOnAxis(Lr,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ar.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Mr.copy(e):Mr.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Tr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ar.lookAt(Tr,Mr,this.up):Ar.lookAt(Mr,Tr,this.up),this.quaternion.setFromRotationMatrix(Ar),r&&(Ar.extractRotation(r.matrixWorld),Er.setFromRotationMatrix(Ar),this.quaternion.premultiply(Er.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(kr),Or.child=e,this.dispatchEvent(Or),Or.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Dr),Nr.child=e,this.dispatchEvent(Nr),Nr.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ar.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ar.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ar),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(kr),Or.child=e,this.dispatchEvent(Or),Or.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tr,e,Cr),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tr,Ir,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=o(e.geometries),r=o(e.materials),i=o(e.textures),a=o(e.images),s=o(e.shapes),l=o(e.skeletons),c=o(e.animations),u=o(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}Ur.DEFAULT_UP=new Dn(0,1,0),Ur.DEFAULT_MATRIX_AUTO_UPDATE=!0,Ur.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Fr=new Dn,zr=new Dn,Br=new Dn,Vr=new Dn,jr=new Dn,Hr=new Dn,Gr=new Dn,Wr=new Dn,qr=new Dn,Xr=new Dn,$r=new Cn,Yr=new Cn,Kr=new Cn;class Zr{constructor(e=new Dn,t=new Dn,n=new Dn){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Fr.subVectors(e,t),r.cross(Fr);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Fr.subVectors(r,t),zr.subVectors(n,t),Br.subVectors(e,t);const o=Fr.dot(Fr),a=Fr.dot(zr),s=Fr.dot(Br),l=zr.dot(zr),c=zr.dot(Br),u=o*l-a*a;if(0===u)return i.set(0,0,0),null;const h=1/u,d=(l*s-a*c)*h,f=(o*c-a*s)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,Vr)&&Vr.x>=0&&Vr.y>=0&&Vr.x+Vr.y<=1}static getInterpolation(e,t,n,r,i,o,a,s){return null===this.getBarycoord(e,t,n,r,Vr)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,Vr.x),s.addScaledVector(o,Vr.y),s.addScaledVector(a,Vr.z),s)}static getInterpolatedAttribute(e,t,n,r,i,o){return $r.setScalar(0),Yr.setScalar(0),Kr.setScalar(0),$r.fromBufferAttribute(e,t),Yr.fromBufferAttribute(e,n),Kr.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector($r,i.x),o.addScaledVector(Yr,i.y),o.addScaledVector(Kr,i.z),o}static isFrontFacing(e,t,n,r){return Fr.subVectors(n,t),zr.subVectors(e,t),Fr.cross(zr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Fr.subVectors(this.c,this.b),zr.subVectors(this.a,this.b),.5*Fr.cross(zr).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Zr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Zr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return Zr.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Zr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Zr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,a;jr.subVectors(r,n),Hr.subVectors(i,n),Wr.subVectors(e,n);const s=jr.dot(Wr),l=Hr.dot(Wr);if(s<=0&&l<=0)return t.copy(n);qr.subVectors(e,r);const c=jr.dot(qr),u=Hr.dot(qr);if(c>=0&&u<=c)return t.copy(r);const h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return o=s/(s-c),t.copy(n).addScaledVector(jr,o);Xr.subVectors(e,i);const d=jr.dot(Xr),f=Hr.dot(Xr);if(f>=0&&d<=f)return t.copy(i);const p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),t.copy(n).addScaledVector(Hr,a);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return Gr.subVectors(i,r),a=(u-c)/(u-c+(d-f)),t.copy(r).addScaledVector(Gr,a);const g=1/(m+p+h);return o=p*g,a=h*g,t.copy(n).addScaledVector(jr,o).addScaledVector(Hr,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Qr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Jr={h:0,s:0,l:0},ei={h:0,s:0,l:0};function ti(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class ni{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=It){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,yn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=yn.workingColorSpace){return this.r=e,this.g=t,this.b=n,yn.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=yn.workingColorSpace){if(e=Qt(e,1),t=Zt(t,0,1),n=Zt(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=ti(i,r,e+1/3),this.g=ti(i,r,e),this.b=ti(i,r,e-1/3)}return yn.toWorkingColorSpace(this,r),this}setStyle(e,t=It){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===i)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=It){const n=Qr[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=bn(e.r),this.g=bn(e.g),this.b=bn(e.b),this}copyLinearToSRGB(e){return this.r=_n(e.r),this.g=_n(e.g),this.b=_n(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=It){return yn.fromWorkingColorSpace(ri.copy(this),e),65536*Math.round(Zt(255*ri.r,0,255))+256*Math.round(Zt(255*ri.g,0,255))+Math.round(Zt(255*ri.b,0,255))}getHexString(e=It){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=yn.workingColorSpace){yn.fromWorkingColorSpace(ri.copy(this),t);const n=ri.r,r=ri.g,i=ri.b,o=Math.max(n,r,i),a=Math.min(n,r,i);let s,l;const c=(a+o)/2;if(a===o)s=0,l=0;else{const e=o-a;switch(l=c<=.5?e/(o+a):e/(2-o-a),o){case n:s=(r-i)/e+(r<i?6:0);break;case r:s=(i-n)/e+2;break;case i:s=(n-r)/e+4}s/=6}return e.h=s,e.s=l,e.l=c,e}getRGB(e,t=yn.workingColorSpace){return yn.fromWorkingColorSpace(ri.copy(this),t),e.r=ri.r,e.g=ri.g,e.b=ri.b,e}getStyle(e=It){yn.fromWorkingColorSpace(ri.copy(this),e);const t=ri.r,n=ri.g,r=ri.b;return e!==It?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(Jr),this.setHSL(Jr.h+e,Jr.s+t,Jr.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Jr),e.getHSL(ei);const n=Jt(Jr.h,ei.h,t),r=Jt(Jr.s,ei.s,t),i=Jt(Jr.l,ei.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ri=new ni;ni.NAMES=Qr;let ii=0;class oi extends Wt{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ii++}),this.uuid=Kt(),this.name="",this.type="Material",this.blending=m,this.side=h,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=I,this.blendDst=R,this.blendEquation=_,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ni(0,0,0),this.blendAlpha=0,this.depthFunc=H,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=kt,this.stencilZFail=kt,this.stencilZPass=kt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==m&&(n.blending=this.blending),this.side!==h&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==I&&(n.blendSrc=this.blendSrc),this.blendDst!==R&&(n.blendDst=this.blendDst),this.blendEquation!==_&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==H&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==kt&&(n.stencilFail=this.stencilFail),this.stencilZFail!==kt&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==kt&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ai extends oi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ni(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new _r,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const si=new Dn,li=new rn;class ci{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=35044,this.updateRanges=[],this.gpuType=Me,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)li.fromBufferAttribute(this,t),li.applyMatrix3(e),this.setXY(t,li.x,li.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix3(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix4(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyNormalMatrix(e),this.setXYZ(t,si.x,si.y,si.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.transformDirection(e),this.setXYZ(t,si.x,si.y,si.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=en(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=tn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=en(t,this.array)),t}setX(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=en(t,this.array)),t}setY(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=en(t,this.array)),t}setZ(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=en(t,this.array)),t}setW(e,t){return this.normalized&&(t=tn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),n=tn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),n=tn(n,this.array),r=tn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=tn(t,this.array),n=tn(n,this.array),r=tn(r,this.array),i=tn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class ui extends ci{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class hi extends ci{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class di extends ci{constructor(e,t,n){super(new Float32Array(e),t,n)}}let fi=0;const pi=new ur,mi=new Ur,gi=new Dn,vi=new Un,yi=new Un,bi=new Dn;class _i extends Wt{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:fi++}),this.uuid=Kt(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(sn(e)?hi:ui)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new on).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return pi.makeRotationFromQuaternion(e),this.applyMatrix4(pi),this}rotateX(e){return pi.makeRotationX(e),this.applyMatrix4(pi),this}rotateY(e){return pi.makeRotationY(e),this.applyMatrix4(pi),this}rotateZ(e){return pi.makeRotationZ(e),this.applyMatrix4(pi),this}translate(e,t,n){return pi.makeTranslation(e,t,n),this.applyMatrix4(pi),this}scale(e,t,n){return pi.makeScale(e,t,n),this.applyMatrix4(pi),this}lookAt(e){return mi.lookAt(e),mi.updateMatrix(),this.applyMatrix4(mi.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(gi).negate(),this.translate(gi.x,gi.y,gi.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new di(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Un);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Dn(-1/0,-1/0,-1/0),new Dn(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];vi.setFromBufferAttribute(n),this.morphTargetsRelative?(bi.addVectors(this.boundingBox.min,vi.min),this.boundingBox.expandByPoint(bi),bi.addVectors(this.boundingBox.max,vi.max),this.boundingBox.expandByPoint(bi)):(this.boundingBox.expandByPoint(vi.min),this.boundingBox.expandByPoint(vi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new tr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Dn,1/0);if(e){const n=this.boundingSphere.center;if(vi.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];yi.setFromBufferAttribute(n),this.morphTargetsRelative?(bi.addVectors(vi.min,yi.min),vi.expandByPoint(bi),bi.addVectors(vi.max,yi.max),vi.expandByPoint(bi)):(vi.expandByPoint(yi.min),vi.expandByPoint(yi.max))}vi.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)bi.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(bi));if(t)for(let i=0,o=t.length;i<o;i++){const o=t[i],a=this.morphTargetsRelative;for(let t=0,i=o.count;t<i;t++)bi.fromBufferAttribute(o,t),a&&(gi.fromBufferAttribute(e,t),bi.add(gi)),r=Math.max(r,n.distanceToSquared(bi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ci(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],s=[];for(let e=0;e<n.count;e++)a[e]=new Dn,s[e]=new Dn;const l=new Dn,c=new Dn,u=new Dn,h=new rn,d=new rn,f=new rn,p=new Dn,m=new Dn;function g(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,r),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),f.fromBufferAttribute(i,r),c.sub(l),u.sub(l),d.sub(h),f.sub(h);const o=1/(d.x*f.y-f.x*d.y);isFinite(o)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(o),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(o),a[e].add(p),a[t].add(p),a[r].add(p),s[e].add(m),s[t].add(m),s[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)g(e.getX(t+0),e.getX(t+1),e.getX(t+2))}const y=new Dn,b=new Dn,_=new Dn,w=new Dn;function x(e){_.fromBufferAttribute(r,e),w.copy(_);const t=a[e];y.copy(t),y.sub(_.multiplyScalar(_.dot(t))).normalize(),b.crossVectors(w,t);const n=b.dot(s[e])<0?-1:1;o.setXYZW(e,y.x,y.y,y.z,n)}for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)x(e.getX(t+0)),x(e.getX(t+1)),x(e.getX(t+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new ci(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Dn,i=new Dn,o=new Dn,a=new Dn,s=new Dn,l=new Dn,c=new Dn,u=new Dn;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),o.fromBufferAttribute(t,p),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),a.fromBufferAttribute(n,d),s.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),a.add(c),s.add(c),l.add(c),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,a=t.count;e<a;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),o.fromBufferAttribute(t,e+2),c.subVectors(o,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)bi.fromBufferAttribute(e,t),bi.normalize(),e.setXYZ(t,bi.x,bi.y,bi.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r);let a=0,s=0;for(let i=0,l=t.length;i<l;i++){a=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*r;for(let e=0;e<r;e++)o[s++]=n[a++]}return new ci(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new _i,n=this.index.array,r=this.attributes;for(const i in r){const o=e(r[i],n);t.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],a=i[r];for(let t=0,r=a.length;t<r;t++){const r=e(a[t],n);o.push(r)}t.morphAttributes[r]=o}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let e=0,n=o.length;e<n;e++){const n=o[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t];e.data.attributes[t]=r.toJSON(e.data)}const r={};let i=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],o=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];o.push(r.toJSON(e.data))}o.length>0&&(r[t]=o,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const i=e.morphAttributes;for(const e in i){const n=[],r=i[e];for(let e=0,i=r.length;e<i;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let e=0,t=o.length;e<t;e++){const t=o[e];this.addGroup(t.start,t.count,t.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const wi=new ur,xi=new cr,Si=new tr,Ei=new Dn,Ai=new Dn,Mi=new Dn,Ti=new Dn,Ci=new Dn,Ii=new Dn,Ri=new Dn,Pi=new Dn;class Li extends Ur{constructor(e=new _i,t=new ai){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(i&&a){Ii.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=a[n],s=i[n];0!==r&&(Ci.fromBufferAttribute(s,e),o?Ii.addScaledVector(Ci,r):Ii.addScaledVector(Ci.sub(t),r))}t.add(Ii)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Si.copy(n.boundingSphere),Si.applyMatrix4(i),xi.copy(e.ray).recast(e.near),!1===Si.containsPoint(xi.origin)){if(null===xi.intersectSphere(Si,Ei))return;if(xi.origin.distanceToSquared(Ei)>(e.far-e.near)**2)return}wi.copy(i).invert(),xi.copy(e.ray).applyMatrix4(wi),null!==n.boundingBox&&!1===xi.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,xi)}}_computeIntersections(e,t,n){let r;const i=this.geometry,o=this.material,a=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==a)if(Array.isArray(o))for(let i=0,s=h.length;i<s;i++){const s=h[i],f=o[s.materialIndex];for(let i=Math.max(s.start,d.start),o=Math.min(a.count,Math.min(s.start+s.count,d.start+d.count));i<o;i+=3)r=ki(this,f,e,n,l,c,u,a.getX(i),a.getX(i+1),a.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=s.materialIndex,t.push(r))}else for(let i=Math.max(0,d.start),s=Math.min(a.count,d.start+d.count);i<s;i+=3)r=ki(this,o,e,n,l,c,u,a.getX(i),a.getX(i+1),a.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r));else if(void 0!==s)if(Array.isArray(o))for(let i=0,a=h.length;i<a;i++){const a=h[i],f=o[a.materialIndex];for(let i=Math.max(a.start,d.start),o=Math.min(s.count,Math.min(a.start+a.count,d.start+d.count));i<o;i+=3)r=ki(this,f,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=a.materialIndex,t.push(r))}else for(let i=Math.max(0,d.start),a=Math.min(s.count,d.start+d.count);i<a;i+=3)r=ki(this,o,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}function ki(e,t,n,r,i,o,a,s,l,c){e.getVertexPosition(s,Ai),e.getVertexPosition(l,Mi),e.getVertexPosition(c,Ti);const u=function(e,t,n,r,i,o,a,s){let l;if(l=t.side===d?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,t.side===h,s),null===l)return null;Pi.copy(s),Pi.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(Pi);return c<n.near||c>n.far?null:{distance:c,point:Pi.clone(),object:e}}(e,t,n,r,Ai,Mi,Ti,Ri);if(u){const e=new Dn;Zr.getBarycoord(Ri,Ai,Mi,Ti,e),i&&(u.uv=Zr.getInterpolatedAttribute(i,s,l,c,e,new rn)),o&&(u.uv1=Zr.getInterpolatedAttribute(o,s,l,c,e,new rn)),a&&(u.normal=Zr.getInterpolatedAttribute(a,s,l,c,e,new Dn),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const t={a:s,b:l,c,normal:new Dn,materialIndex:0};Zr.getNormal(Ai,Mi,Ti,t.normal),u.face=t,u.barycoord=e}return u}class Di extends _i{constructor(e=1,t=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const a=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const s=[],l=[],c=[],u=[];let h=0,d=0;function f(e,t,n,r,i,o,f,p,m,g,v){const y=o/m,b=f/g,_=o/2,w=f/2,x=p/2,S=m+1,E=g+1;let A=0,M=0;const T=new Dn;for(let o=0;o<E;o++){const a=o*b-w;for(let s=0;s<S;s++){const h=s*y-_;T[e]=h*r,T[t]=a*i,T[n]=x,l.push(T.x,T.y,T.z),T[e]=0,T[t]=0,T[n]=p>0?1:-1,c.push(T.x,T.y,T.z),u.push(s/m),u.push(1-o/g),A+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=h+t+S*e,r=h+t+S*(e+1),i=h+(t+1)+S*(e+1),o=h+(t+1)+S*e;s.push(n,r,o),s.push(r,i,o),M+=6}a.addGroup(d,M,v),d+=M,h+=A}f("z","y","x",-1,-1,n,t,e,o,i,0),f("z","y","x",1,-1,n,t,-e,o,i,1),f("x","z","y",1,1,e,n,t,r,o,2),f("x","z","y",1,-1,e,n,-t,r,o,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new di(l,3)),this.setAttribute("normal",new di(c,3)),this.setAttribute("uv",new di(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Di(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Oi(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Ni(e){const t={};for(let n=0;n<e.length;n++){const r=Oi(e[n]);for(const e in r)t[e]=r[e]}return t}function Ui(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:yn.workingColorSpace}const Fi={clone:Oi,merge:Ni};class zi extends oi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Oi(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Bi extends Ur{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ur,this.projectionMatrix=new ur,this.projectionMatrixInverse=new ur,this.coordinateSystem=Ht}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Vi=new Dn,ji=new rn,Hi=new rn;class Gi extends Bi{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Yt*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*$t*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Yt*Math.atan(Math.tan(.5*$t*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Vi.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Vi.x,Vi.y).multiplyScalar(-e/Vi.z),Vi.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Vi.x,Vi.y).multiplyScalar(-e/Vi.z)}getViewSize(e,t){return this.getViewBounds(e,ji,Hi),t.subVectors(Hi,ji)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*$t*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const e=o.fullWidth,a=o.fullHeight;i+=o.offsetX*r/e,t-=o.offsetY*n/a,r*=o.width/e,n*=o.height/a}const a=this.filmOffset;0!==a&&(i+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Wi=-90;class qi extends Ur{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Gi(Wi,1,e,t);r.layers=this.layers,this.add(r);const i=new Gi(Wi,1,e,t);i.layers=this.layers,this.add(i);const o=new Gi(Wi,1,e,t);o.layers=this.layers,this.add(o);const a=new Gi(Wi,1,e,t);a.layers=this.layers,this.add(a);const s=new Gi(Wi,1,e,t);s.layers=this.layers,this.add(s);const l=new Gi(Wi,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,o,a,s]=t;for(const e of t)this.remove(e);if(e===Ht)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else{if(e!==Gt)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1)}for(const e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,o,a,s,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,s),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class Xi extends Tn{constructor(e,t,n,r,i,o,a,s,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:ae,n,r,i,o,a,s,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class $i extends Rn{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Xi(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:ve}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",o=new Di(5,5,5),a=new zi({name:"CubemapFromEquirect",uniforms:Oi(n),vertexShader:r,fragmentShader:i,side:d,blending:p});a.uniforms.tEquirect.value=t;const s=new Li(o,a),l=t.minFilter;return t.minFilter===be&&(t.minFilter=ve),new qi(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}}class Yi extends Ur{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new _r,this.environmentIntensity=1,this.environmentRotation=new _r,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Ki extends Tn{constructor(e=null,t=1,n=1,r,i,o,a,s,l=pe,c=pe,u,h){super(null,o,a,s,l,c,r,i,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Zi=new Dn,Qi=new Dn,Ji=new on;class eo{constructor(e=new Dn(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Zi.subVectors(n,t).cross(Qi.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Zi),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ji.getNormalMatrix(e),r=this.coplanarPoint(Zi).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const to=new tr,no=new Dn;class ro{constructor(e=new eo,t=new eo,n=new eo,r=new eo,i=new eo,o=new eo){this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ht){const n=this.planes,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],l=r[4],c=r[5],u=r[6],h=r[7],d=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15];if(n[0].setComponents(s-i,h-l,m-d,b-g).normalize(),n[1].setComponents(s+i,h+l,m+d,b+g).normalize(),n[2].setComponents(s+o,h+c,m+f,b+v).normalize(),n[3].setComponents(s-o,h-c,m-f,b-v).normalize(),n[4].setComponents(s-a,h-u,m-p,b-y).normalize(),t===Ht)n[5].setComponents(s+a,h+u,m+p,b+y).normalize();else{if(t!==Gt)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(a,u,p,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),to.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),to.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(to)}intersectsSprite(e){return to.center.set(0,0,0),to.radius=.7071067811865476,to.applyMatrix4(e.matrixWorld),this.intersectsSphere(to)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(no.x=r.normal.x>0?e.max.x:e.min.x,no.y=r.normal.y>0?e.max.y:e.min.y,no.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(no)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class io extends oi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ni(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const oo=new Dn,ao=new Dn,so=new ur,lo=new cr,co=new tr,uo=new Dn,ho=new Dn;class fo extends Ur{constructor(e=new _i,t=new io){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)oo.fromBufferAttribute(t,e-1),ao.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=oo.distanceTo(ao);e.setAttribute("lineDistance",new di(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),co.copy(n.boundingSphere),co.applyMatrix4(r),co.radius+=i,!1===e.ray.intersectsSphere(co))return;so.copy(r).invert(),lo.copy(e.ray).applyMatrix4(so);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,o.start),r=Math.min(c.count,o.start+o.count);for(let i=n,o=r-1;i<o;i+=l){const n=c.getX(i),r=c.getX(i+1),o=po(this,e,lo,s,n,r);o&&t.push(o)}if(this.isLineLoop){const i=c.getX(r-1),o=c.getX(n),a=po(this,e,lo,s,i,o);a&&t.push(a)}}else{const n=Math.max(0,o.start),r=Math.min(u.count,o.start+o.count);for(let i=n,o=r-1;i<o;i+=l){const n=po(this,e,lo,s,i,i+1);n&&t.push(n)}if(this.isLineLoop){const i=po(this,e,lo,s,r-1,n);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function po(e,t,n,r,i,o){const a=e.geometry.attributes.position;if(oo.fromBufferAttribute(a,i),ao.fromBufferAttribute(a,o),n.distanceSqToSegment(oo,ao,uo,ho)>r)return;uo.applyMatrix4(e.matrixWorld);const s=t.ray.origin.distanceTo(uo);return s<t.near||s>t.far?void 0:{distance:s,point:ho.clone().applyMatrix4(e.matrixWorld),index:i,face:null,faceIndex:null,barycoord:null,object:e}}const mo=new Dn,go=new Dn;class vo extends fo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)mo.fromBufferAttribute(t,e),go.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+mo.distanceTo(go);e.setAttribute("lineDistance",new di(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class yo extends Ur{constructor(){super(),this.isGroup=!0,this.type="Group"}}class bo extends Tn{constructor(e,t,n,r,i,o,a,s,l,c,u,h){super(null,o,a,s,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class _o extends Tn{constructor(e,t,n,r,i,o,a,s,l,c=Ue){if(c!==Ue&&c!==Fe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Ue&&(n=Ae),void 0===n&&c===Fe&&(n=Re),super(null,r,i,o,a,s,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:pe,this.minFilter=void 0!==s?s:pe,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class wo extends _i{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,o=t/2,a=Math.floor(n),s=Math.floor(r),l=a+1,c=s+1,u=e/a,h=t/s,d=[],f=[],p=[],m=[];for(let e=0;e<c;e++){const t=e*h-o;for(let n=0;n<l;n++){const r=n*u-i;f.push(r,-t,0),p.push(0,0,1),m.push(n/a),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<a;t++){const n=t+l*e,r=t+l*(e+1),i=t+1+l*(e+1),o=t+1+l*e;d.push(n,r,o),d.push(r,i,o)}this.setIndex(d),this.setAttribute("position",new di(f,3)),this.setAttribute("normal",new di(p,3)),this.setAttribute("uv",new di(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wo(e.width,e.height,e.widthSegments,e.heightSegments)}}class xo extends oi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ni(16777215),this.specular=new ni(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ni(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mt,this.normalScale=new rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new _r,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class So extends oi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Eo extends oi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Ao(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}class Mo{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<r)){for(let o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=i)break e;{const a=t[1];e<a&&(n=2,i=a);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=t[--n-1],e>=i)break t}o=n,n=0}}for(;n<o;){const r=n+o>>>1;e<t[r]?o=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class To extends Mo{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,o=e+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=e,a=2*t-n;break;case 2402:i=r.length-2,a=t+r[i]-r[i+1];break;default:i=e,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=e,s=2*n-t;break;case 2402:o=1,s=n+r[1]-r[0];break;default:o=e-1,s=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p;for(let e=0;e!==a;++e)i[e]=g*o[c+e]+v*o[l+e]+y*o[s+e]+b*o[u+e];return i}}class Co extends Mo{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,l=s-a,c=(n-t)/(r-t),u=1-c;for(let e=0;e!==a;++e)i[e]=o[l+e]*u+o[s+e]*c;return i}}class Io extends Mo{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ro{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ao(t,this.TimeBufferType),this.values=Ao(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ao(e.times,Array),values:Ao(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Io(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Co(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new To(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case xt:t=this.InterpolantFactoryMethodDiscrete;break;case St:t=this.InterpolantFactoryMethodLinear;break;case Et:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return xt;case this.InterpolantFactoryMethodLinear:return St;case this.InterpolantFactoryMethodSmooth:return Et}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const e=this.getValueSize();this.times=n.slice(i,o),this.values=this.values.slice(i*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let t=0;t!==i;t++){const r=n[t];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,o),e=!1;break}o=r}if(void 0!==r&&(a=r,ArrayBuffer.isView(a)&&!(a instanceof DataView)))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}var a;return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Et,i=e.length-1;let o=1;for(let a=1;a<i;++a){let i=!1;const s=e[a];if(s!==e[a+1]&&(1!==a||s!==e[0]))if(r)i=!0;else{const e=a*n,r=e-n,o=e+n;for(let a=0;a!==n;++a){const n=t[e+a];if(n!==t[r+a]||n!==t[o+a]){i=!0;break}}}if(i){if(a!==o){e[o]=e[a];const r=a*n,i=o*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++o}}if(i>0){e[o]=e[i];for(let e=i*n,r=o*n,a=0;a!==n;++a)t[r+a]=t[e+a];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Ro.prototype.TimeBufferType=Float32Array,Ro.prototype.ValueBufferType=Float32Array,Ro.prototype.DefaultInterpolation=St;class Po extends Ro{constructor(e,t,n){super(e,t,n)}}Po.prototype.ValueTypeName="bool",Po.prototype.ValueBufferType=Array,Po.prototype.DefaultInterpolation=xt,Po.prototype.InterpolantFactoryMethodLinear=void 0,Po.prototype.InterpolantFactoryMethodSmooth=void 0;(class extends Ro{}).prototype.ValueTypeName="color";(class extends Ro{}).prototype.ValueTypeName="number";class Lo extends Mo{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(n-t)/(r-t);let l=e*a;for(let e=l+a;l!==e;l+=4)kn.slerpFlat(i,0,o,l-a,o,l,s);return i}}class ko extends Ro{InterpolantFactoryMethodLinear(e){return new Lo(this.times,this.values,this.getValueSize(),e)}}ko.prototype.ValueTypeName="quaternion",ko.prototype.InterpolantFactoryMethodSmooth=void 0;class Do extends Ro{constructor(e,t,n){super(e,t,n)}}Do.prototype.ValueTypeName="string",Do.prototype.ValueBufferType=Array,Do.prototype.DefaultInterpolation=xt,Do.prototype.InterpolantFactoryMethodLinear=void 0,Do.prototype.InterpolantFactoryMethodSmooth=void 0;(class extends Ro{}).prototype.ValueTypeName="vector";Error;class Oo extends Ur{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ni(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}const No=new ur,Uo=new Dn,Fo=new Dn;class zo{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new rn(512,512),this.map=null,this.mapPass=null,this.matrix=new ur,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ro,this._frameExtents=new rn(1,1),this._viewportCount=1,this._viewports=[new Cn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Uo.setFromMatrixPosition(e.matrixWorld),t.position.copy(Uo),Fo.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fo),t.updateMatrixWorld(),No.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(No),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(No)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Bo extends zo{constructor(){super(new Gi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Yt*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Vo extends Oo{constructor(e,t,n=0,r=Math.PI/3,i=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ur.DEFAULT_UP),this.updateMatrix(),this.target=new Ur,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new Bo}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class jo extends Bi{constructor(e=-1,t=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,o=i+e*this.view.width,a-=t*this.view.offsetY,s=a-t*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class Ho extends zo{constructor(){super(new jo(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Go extends Oo{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ur.DEFAULT_UP),this.updateMatrix(),this.target=new Ur,this.shadow=new Ho}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Wo extends Oo{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class qo extends Gi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}const Xo="\\[\\]\\.:\\/",$o=new RegExp("["+Xo+"]","g"),Yo="[^"+Xo+"]",Ko="[^"+Xo.replace("\\.","")+"]",Zo=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Yo)+/(WCOD+)?/.source.replace("WCOD",Ko)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Yo)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Yo)+"$"),Qo=["material","materials","bones","map"];class Jo{constructor(e,t,n){this.path=t,this.parsedPath=n||Jo.parseTrackName(t),this.node=Jo.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Jo.Composite(e,t,n):new Jo(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace($o,"")}static parseTrackName(e){const t=Zo.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==Qo.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const o=n(i.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=Jo.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const o=e[r];if(void 0===o){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let a=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(s=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Jo.Composite=class{constructor(e,t,n){const r=n||Jo.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Jo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Jo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Jo.prototype.GetterByBindingType=[Jo.prototype._getValue_direct,Jo.prototype._getValue_array,Jo.prototype._getValue_arrayElement,Jo.prototype._getValue_toArray],Jo.prototype.SetterByBindingTypeAndVersioning=[[Jo.prototype._setValue_direct,Jo.prototype._setValue_direct_setNeedsUpdate,Jo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Jo.prototype._setValue_array,Jo.prototype._setValue_array_setNeedsUpdate,Jo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Jo.prototype._setValue_arrayElement,Jo.prototype._setValue_arrayElement_setNeedsUpdate,Jo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Jo.prototype._setValue_fromArray,Jo.prototype._setValue_fromArray_setNeedsUpdate,Jo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1);class ea{constructor(e){this.value=e}clone(){return new ea(void 0===this.value.clone?this.value:this.value.clone())}}class ta extends vo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new _i;r.setIndex(new ci(n,1)),r.setAttribute("position",new di([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new io({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class na extends vo{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new _i;n.setAttribute("position",new di(t,3)),n.setAttribute("color",new di([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(n,new io({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new ni,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function ra(e,t,n,r){const i=function(e){switch(e){case _e:case we:return{byteLength:1,components:1};case Se:case xe:case Te:return{byteLength:2,components:1};case Ce:case Ie:return{byteLength:2,components:4};case Ae:case Ee:case Me:return{byteLength:4,components:1};case Pe:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(r);switch(n){case Le:case Oe:return e*t;case Ne:return e*t*2;case ze:case Be:return e*t/i.components*i.byteLength;case Ve:case je:return e*t*2/i.components*i.byteLength;case ke:return e*t*3/i.components*i.byteLength;case De:case He:return e*t*4/i.components*i.byteLength;case Ge:case We:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case qe:case Xe:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Ye:case Ze:return Math.max(e,16)*Math.max(t,8)/4;case $e:case Ke:return Math.max(e,8)*Math.max(t,8)/2;case Qe:case Je:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case et:case tt:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case nt:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case rt:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case it:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case ot:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case at:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case st:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case lt:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case ct:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case ut:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case ht:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case dt:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case ft:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case pt:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case mt:case gt:case vt:return Math.ceil(e/4)*Math.ceil(t/4)*16;case yt:case bt:return Math.ceil(e/4)*Math.ceil(t/4)*8;case _t:case wt:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r)}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,loaded:!1,exports:{}};return i[e].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=i,a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var i=Object.create(null);a.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,a.d(i,o),i},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,n)=>(a.f[n](e,t),t)),[])),a.u=e=>e+".bundle.js",a.miniCssF=e=>e+".css",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="@aics/vole-app:",a.l=(e,t,i,o)=>{if(n[e])n[e].push(t);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==e||h.getAttribute("data-webpack")==r+i){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",r+i),s.src=e),n[e]=[t];var d=(t,r)=>{s.onerror=s.onload=null,clearTimeout(f);var i=n[e];if(delete n[e],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(r))),t)return t(r)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.p="/vole-app/pr-preview/pr-443/",(()=>{if("undefined"!=typeof document){var e={57:0,283:0};a.f.miniCss=(t,n)=>{e[t]?n.push(e[t]):0!==e[t]&&{226:1}[t]&&n.push(e[t]=(e=>new Promise(((t,n)=>{var r=a.miniCssF(e),i=a.p+r;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var i=(a=n[r]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(i===e||i===t))return a}var o=document.getElementsByTagName("style");for(r=0;r<o.length;r++){var a;if((i=(a=o[r]).getAttribute("data-href"))===e||i===t)return a}})(r,i))return t();((e,t,n,r,i)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",a.nc&&(o.nonce=a.nc),o.onerror=o.onload=n=>{if(o.onerror=o.onload=null,"load"===n.type)r();else{var a=n&&n.type,s=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+s+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=a,l.request=s,o.parentNode&&o.parentNode.removeChild(o),i(l)}},o.href=t,document.head.appendChild(o)})(e,i,0,t,n)})))(t).then((()=>{e[t]=0}),(n=>{throw delete e[t],n})))}}})(),(()=>{a.b=document.baseURI||self.location.href;var e={57:0,283:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise(((n,i)=>r=e[t]=[n,i]));n.push(r[2]=i);var o=a.p+a.u(t),s=new Error;a.l(o,(n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,i,[o,s,l]=n,c=0;if(o.some((t=>0!==e[t]))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);l&&l(a)}for(t&&t(n);c<o.length;c++)i=o[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunk_aics_vole_app=self.webpackChunk_aics_vole_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.nc=void 0,(()=>{"use strict";var e,t=a(5215),n=a(6199),r=a(5319),i=a(6336),o=a(1588),s="0.4.17",l="w:"+s,c="FIS_v2",u=((e={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',e["not-registered"]="Firebase Installation is not registered.",e["installation-not-found"]="Firebase Installation not found.",e["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',e["app-offline"]="Could not process request. Application offline.",e["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",e),h=new i.ErrorFactory("installations","Installations",u);function d(e){return e instanceof i.FirebaseError&&e.code.includes("request-failed")}function f(e){return"https://firebaseinstallations.googleapis.com/v1/projects/"+e.projectId+"/installations"}function p(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function m(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.json()];case 1:return r=t.sent(),i=r.error,[2,h.create("request-failed",{requestName:e,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})]}}))}))}function g(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function v(e,t){var n=t.refreshToken,r=g(e);return r.append("Authorization",function(e){return c+" "+e}(n)),r}function y(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,e()];case 1:return(n=t.sent()).status>=500&&n.status<600?[2,e()]:[2,n]}}))}))}function b(e,n){var r=n.fid;return(0,t.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,s,u;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return n=f(e),i=g(e),o={fid:r,authVersion:c,appId:e.appId,sdkVersion:l},a={method:"POST",headers:i,body:JSON.stringify(o)},[4,y((function(){return fetch(n,a)}))];case 1:return(s=t.sent()).ok?[4,s.json()]:[3,3];case 2:return[2,{fid:(u=t.sent()).fid||r,registrationStatus:2,refreshToken:u.refreshToken,authToken:p(u.authToken)}];case 3:return[4,m("Create Installation",s)];case 4:throw t.sent()}}))}))}function _(e){return new Promise((function(t){setTimeout(t,e)}))}var w=/^[cdef][\w-]{21}$/;function x(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var n=function(e){var n;return(n=e,btoa(String.fromCharCode.apply(String,(0,t.__spread)(n))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(e);return w.test(n)?n:""}catch(e){return""}}function S(e){return e.appName+"!"+e.appId}var E=new Map;function A(e,t){var n=S(e);M(n,t),function(e,t){var n=C();n&&n.postMessage({key:e,fid:t}),I()}(n,t)}function M(e,n){var r,i,o=E.get(e);if(o)try{for(var a=(0,t.__values)(o),s=a.next();!s.done;s=a.next())(0,s.value)(n)}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}var T=null;function C(){return!T&&"BroadcastChannel"in self&&((T=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){M(e.data.key,e.data.fid)}),T}function I(){0===E.size&&T&&(T.close(),T=null)}var R,P="firebase-installations-store",L=null;function k(){return L||(L=(0,o.openDb)("firebase-installations-database",1,(function(e){0===e.oldVersion&&e.createObjectStore(P)}))),L}function D(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return r=S(e),[4,k()];case 1:return i=t.sent(),o=i.transaction(P,"readwrite"),[4,(a=o.objectStore(P)).get(r)];case 2:return s=t.sent(),[4,a.put(n,r)];case 3:return t.sent(),[4,o.complete];case 4:return t.sent(),s&&s.fid===n.fid||A(e,n.fid),[2,n]}}))}))}function O(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return n=S(e),[4,k()];case 1:return r=t.sent(),[4,(i=r.transaction(P,"readwrite")).objectStore(P).delete(n)];case 2:return t.sent(),[4,i.complete];case 3:return t.sent(),[2]}}))}))}function N(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,l;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return r=S(e),[4,k()];case 1:return i=t.sent(),o=i.transaction(P,"readwrite"),[4,(a=o.objectStore(P)).get(r)];case 2:return s=t.sent(),void 0!==(l=n(s))?[3,4]:[4,a.delete(r)];case 3:return t.sent(),[3,6];case 4:return[4,a.put(l,r)];case 5:t.sent(),t.label=6;case 6:return[4,o.complete];case 7:return t.sent(),!l||s&&s.fid===l.fid||A(e,l.fid),[2,l]}}))}))}function U(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,t.__generator)(this,(function(o){switch(o.label){case 0:return[4,N(e,(function(r){var i=function(e){return B(e||{fid:x(),registrationStatus:0})}(r),o=function(e,n){if(0===n.registrationStatus){if(!navigator.onLine)return{installationEntry:n,registrationPromise:Promise.reject(h.create("app-offline"))};var r={fid:n.fid,registrationStatus:1,registrationTime:Date.now()},i=function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,7]),[4,b(e,n)];case 1:return r=t.sent(),[2,D(e,r)];case 2:return d(i=t.sent())&&409===i.serverCode?[4,O(e)]:[3,4];case 3:return t.sent(),[3,6];case 4:return[4,D(e,{fid:n.fid,registrationStatus:0})];case 5:t.sent(),t.label=6;case 6:throw i;case 7:return[2]}}))}))}(e,r);return{installationEntry:r,registrationPromise:i}}return 1===n.registrationStatus?{installationEntry:n,registrationPromise:F(e)}:{installationEntry:n}}(e,i);return n=o.registrationPromise,o.installationEntry}))];case 1:return""!==(r=o.sent()).fid?[3,3]:(i={},[4,n]);case 2:return[2,(i.installationEntry=o.sent(),i)];case 3:return[2,{installationEntry:r,registrationPromise:n}]}}))}))}function F(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,z(e)];case 1:n=t.sent(),t.label=2;case 2:return 1!==n.registrationStatus?[3,5]:[4,_(100)];case 3:return t.sent(),[4,z(e)];case 4:return n=t.sent(),[3,2];case 5:return 0!==n.registrationStatus?[3,7]:[4,U(e)];case 6:return r=t.sent(),i=r.installationEntry,(o=r.registrationPromise)?[2,o]:[2,i];case 7:return[2,n]}}))}))}function z(e){return N(e,(function(e){if(!e)throw h.create("installation-not-found");return B(e)}))}function B(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function V(e,n){var r=e.appConfig,i=e.platformLoggerProvider;return(0,t.__awaiter)(this,void 0,void 0,(function(){var e,o,a,s,c,u;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return e=function(e,t){var n=t.fid;return f(e)+"/"+n+"/authTokens:generate"}(r,n),o=v(r,n),(a=i.getImmediate({optional:!0}))&&o.append("x-firebase-client",a.getPlatformInfoString()),s={installation:{sdkVersion:l}},c={method:"POST",headers:o,body:JSON.stringify(s)},[4,y((function(){return fetch(e,c)}))];case 1:return(u=t.sent()).ok?[4,u.json()]:[3,3];case 2:return[2,p(t.sent())];case 3:return[4,m("Generate Auth Token",u)];case 4:throw t.sent()}}))}))}function j(e,n){return void 0===n&&(n=!1),(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,t.__generator)(this,(function(a){switch(a.label){case 0:return[4,N(e.appConfig,(function(i){if(!G(i))throw h.create("not-registered");var o,a=i.authToken;if(!n&&(2===(o=a).requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(o)))return i;if(1===a.requestStatus)return r=function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,H(e.appConfig)];case 1:r=t.sent(),t.label=2;case 2:return 1!==r.authToken.requestStatus?[3,5]:[4,_(100)];case 3:return t.sent(),[4,H(e.appConfig)];case 4:return r=t.sent(),[3,2];case 5:return 0===(i=r.authToken).requestStatus?[2,j(e,n)]:[2,i]}}))}))}(e,n),i;if(!navigator.onLine)throw h.create("app-offline");var s=function(e){var n={requestStatus:1,requestTime:Date.now()};return(0,t.__assign)((0,t.__assign)({},e),{authToken:n})}(i);return r=function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,t.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,8]),[4,V(e,n)];case 1:return r=a.sent(),o=(0,t.__assign)((0,t.__assign)({},n),{authToken:r}),[4,D(e.appConfig,o)];case 2:return a.sent(),[2,r];case 3:return!d(i=a.sent())||401!==i.serverCode&&404!==i.serverCode?[3,5]:[4,O(e.appConfig)];case 4:return a.sent(),[3,7];case 5:return o=(0,t.__assign)((0,t.__assign)({},n),{authToken:{requestStatus:0}}),[4,D(e.appConfig,o)];case 6:a.sent(),a.label=7;case 7:throw i;case 8:return[2]}}))}))}(e,s),s}))];case 1:return i=a.sent(),r?[4,r]:[3,3];case 2:return o=a.sent(),[3,4];case 3:o=i.authToken,a.label=4;case 4:return[2,o]}}))}))}function H(e){return N(e,(function(e){if(!G(e))throw h.create("not-registered");var n;return 1===(n=e.authToken).requestStatus&&n.requestTime+1e4<Date.now()?(0,t.__assign)((0,t.__assign)({},e),{authToken:{requestStatus:0}}):e}))}function G(e){return void 0!==e&&2===e.registrationStatus}function W(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,U(e)];case 1:return(n=t.sent().registrationPromise)?[4,n]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))}function q(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return r=function(e,t){var n=t.fid;return f(e)+"/"+n}(e,n),i=v(e,n),o={method:"DELETE",headers:i},[4,y((function(){return fetch(r,o)}))];case 1:return(a=t.sent()).ok?[3,3]:[4,m("Delete Installation",a)];case 2:throw t.sent();case 3:return[2]}}))}))}function X(e){return h.create("missing-app-config-values",{valueName:e})}(R=n.default).INTERNAL.registerComponent(new r.Component("installations",(function(e){var n=e.getProvider("app").getImmediate(),r=function(e){var n,r;if(!e||!e.options)throw X("App Configuration");if(!e.name)throw X("App Name");try{for(var i=(0,t.__values)(["projectId","apiKey","appId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!e.options[a])throw X(a)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(n),i={appConfig:r,platformLoggerProvider:e.getProvider("platform-logger")},o={app:n,getId:function(){return function(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,U(e.appConfig)];case 1:return n=t.sent(),r=n.installationEntry,(i=n.registrationPromise)?i.catch(console.error):j(e).catch(console.error),[2,r.fid]}}))}))}(i)},getToken:function(e){return function(e,n){return void 0===n&&(n=!1),(0,t.__awaiter)(this,void 0,void 0,(function(){return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,W(e.appConfig)];case 1:return t.sent(),[4,j(e,n)];case 2:return[2,t.sent().token]}}))}))}(i,e)},delete:function(){return function(e){return(0,t.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,N(n=e.appConfig,(function(e){if(!e||0!==e.registrationStatus)return e}))];case 1:if(!(r=t.sent()))return[3,6];if(1!==r.registrationStatus)return[3,2];throw h.create("delete-pending-registration");case 2:if(2!==r.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw h.create("app-offline");case 3:return[4,q(n,r)];case 4:return t.sent(),[4,O(n)];case 5:t.sent(),t.label=6;case 6:return[2]}}))}))}(i)},onIdChange:function(e){return function(e,t){var n=e.appConfig;return function(e,t){C();var n=S(e),r=E.get(n);r||(r=new Set,E.set(n,r)),r.add(t)}(n,t),function(){!function(e,t){var n=S(e),r=E.get(n);r&&(r.delete(t),0===r.size&&E.delete(n),I())}(n,t)}}(i,e)}};return o}),"PUBLIC")),R.registerVersion("@firebase/installations",s);var $,Y,K,Z,Q=a(2477),J="https://www.googletagmanager.com/gtag/js";(Y=$||($={})).EVENT="event",Y.SET="set",Y.CONFIG="config",(Z=K||(K={})).ADD_SHIPPING_INFO="add_shipping_info",Z.ADD_PAYMENT_INFO="add_payment_info",Z.ADD_TO_CART="add_to_cart",Z.ADD_TO_WISHLIST="add_to_wishlist",Z.BEGIN_CHECKOUT="begin_checkout",Z.CHECKOUT_PROGRESS="checkout_progress",Z.EXCEPTION="exception",Z.GENERATE_LEAD="generate_lead",Z.LOGIN="login",Z.PAGE_VIEW="page_view",Z.PURCHASE="purchase",Z.REFUND="refund",Z.REMOVE_FROM_CART="remove_from_cart",Z.SCREEN_VIEW="screen_view",Z.SEARCH="search",Z.SELECT_CONTENT="select_content",Z.SELECT_ITEM="select_item",Z.SELECT_PROMOTION="select_promotion",Z.SET_CHECKOUT_OPTION="set_checkout_option",Z.SHARE="share",Z.SIGN_UP="sign_up",Z.TIMING_COMPLETE="timing_complete",Z.VIEW_CART="view_cart",Z.VIEW_ITEM="view_item",Z.VIEW_ITEM_LIST="view_item_list",Z.VIEW_PROMOTION="view_promotion",Z.VIEW_SEARCH_RESULTS="view_search_results";var ee,te=new Q.Logger("@firebase/analytics");function ne(e,n,r,i,o,a){return(0,t.__awaiter)(this,void 0,void 0,(function(){var s,l,c,u;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:s=i[o],t.label=1;case 1:return t.trys.push([1,7,,8]),s?[4,n[s]]:[3,3];case 2:return t.sent(),[3,6];case 3:return[4,Promise.all(r)];case 4:return l=t.sent(),(c=l.find((function(e){return e.measurementId===o})))?[4,n[c.appId]]:[3,6];case 5:t.sent(),t.label=6;case 6:return[3,8];case 7:return u=t.sent(),te.error(u),[3,8];case 8:return e($.CONFIG,o,a),[2]}}))}))}function re(e,n,r,i,o){return(0,t.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c,u,h,d,f;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),a=[],o&&o.send_to?(s=o.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(r)]):[3,2];case 1:for(l=t.sent(),c=function(e){var t=l.find((function(t){return t.measurementId===e})),r=t&&n[t.appId];if(!r)return a=[],"break";a.push(r)},u=0,h=s;u<h.length&&(d=h[u],"break"!==c(d));u++);t.label=2;case 2:return 0===a.length&&(a=Object.values(n)),[4,Promise.all(a)];case 3:return t.sent(),e($.EVENT,i,o||{}),[3,5];case 4:return f=t.sent(),te.error(f),[3,5];case 5:return[2]}}))}))}var ie=((ee={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",ee["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",ee["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",ee["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ee["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ee["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",ee["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",ee["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',ee["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',ee),oe=new i.ErrorFactory("analytics","Analytics",ie),ae=new(function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=1e3),this.throttleMetadata=e,this.intervalMillis=t}return e.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},e.prototype.setThrottleMetadata=function(e,t){this.throttleMetadata[e]=t},e.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},e}());function se(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function le(e){var n;return(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,l,c;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return r=e.appId,i=e.apiKey,o={method:"GET",headers:se(i)},a="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",r),[4,fetch(a,o)];case 1:if(200===(s=t.sent()).status||304===s.status)return[3,6];l="",t.label=2;case 2:return t.trys.push([2,4,,5]),[4,s.json()];case 3:return c=t.sent(),(null===(n=c.error)||void 0===n?void 0:n.message)&&(l=c.error.message),[3,5];case 4:return t.sent(),[3,5];case 5:throw oe.create("config-fetch-failed",{httpStatus:s.status,responseMessage:l});case 6:return[2,s.json()]}}))}))}function ce(e,n,r,o){var a=n.throttleEndTimeMillis,s=n.backoffCount;return void 0===o&&(o=ae),(0,t.__awaiter)(this,void 0,void 0,(function(){var n,l,c,u,h,d,f;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:n=e.appId,l=e.measurementId,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,ue(r,a)];case 2:return t.sent(),[3,4];case 3:if(c=t.sent(),l)return te.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+l+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:n,measurementId:l}];throw c;case 4:return t.trys.push([4,6,,7]),[4,le(e)];case 5:return u=t.sent(),o.deleteThrottleMetadata(n),[2,u];case 6:if(!function(e){if(!(e instanceof i.FirebaseError))return!1;var t=Number(e.httpStatus);return 429===t||500===t||503===t||504===t}(h=t.sent())){if(o.deleteThrottleMetadata(n),l)return te.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+l+' provided in the "measurementId" field in the local Firebase config. ['+h.message+"]"),[2,{appId:n,measurementId:l}];throw h}return d=503===Number(h.httpStatus)?(0,i.calculateBackoffMillis)(s,o.intervalMillis,30):(0,i.calculateBackoffMillis)(s,o.intervalMillis),f={throttleEndTimeMillis:Date.now()+d,backoffCount:s+1},o.setThrottleMetadata(n,f),te.debug("Calling attemptFetch again in "+d+" millis"),[2,ce(e,f,r,o)];case 7:return[2]}}))}))}function ue(e,t){return new Promise((function(n,r){var i=Math.max(t-Date.now(),0),o=setTimeout(n,i);e.addEventListener((function(){clearTimeout(o),r(oe.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}var he=function(){function e(){this.listeners=[]}return e.prototype.addEventListener=function(e){this.listeners.push(e)},e.prototype.abort=function(){this.listeners.forEach((function(e){return e()}))},e}();var de,fe,pe={},me=[],ge={},ve="dataLayer",ye="gtag",be=!1;function _e(e){if(be)throw oe.create("already-initialized");e.dataLayerName&&(ve=e.dataLayerName),e.gtagName&&(ye=e.gtagName)}function we(e,n){!function(){var e=[];if((0,i.isBrowserExtension)()&&e.push("This is a browser extension environment."),(0,i.areCookiesEnabled)()||e.push("Cookies are not available."),e.length>0){var t=e.map((function(e,t){return"("+(t+1)+") "+e})).join(" "),n=oe.create("invalid-analytics-context",{errorInfo:t});te.warn(n.message)}}();var r,o,a=e.options.appId;if(!a)throw oe.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw oe.create("no-api-key");te.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+e.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=pe[a])throw oe.create("already-exists",{id:a});if(!be){(function(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(J))return r}return null})()||(r=ve,(o=document.createElement("script")).src=J+"?l="+r,o.async=!0,document.head.appendChild(o)),function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ve);var s=function(e,n,r,i,o){var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window[i].push(arguments)};return window[o]&&"function"==typeof window[o]&&(a=window[o]),window[o]=function(e,n,r,i){return function(o,a,s){return(0,t.__awaiter)(this,void 0,void 0,(function(){var l;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,6,,7]),o!==$.EVENT?[3,2]:[4,re(e,n,r,a,s)];case 1:return t.sent(),[3,5];case 2:return o!==$.CONFIG?[3,4]:[4,ne(e,n,r,i,a,s)];case 3:return t.sent(),[3,5];case 4:e($.SET,a),t.label=5;case 5:return[3,7];case 6:return l=t.sent(),te.error(l),[3,7];case 7:return[2]}}))}))}}(a,e,n,r),{gtagCore:a,wrappedGtag:window[o]}}(pe,me,ge,ve,ye),l=s.wrappedGtag,c=s.gtagCore;fe=l,de=c,be=!0}pe[a]=function(e,n,r,o,a){return(0,t.__awaiter)(this,void 0,void 0,(function(){var s,l,c,u,h,d,f;return(0,t.__generator)(this,(function(p){switch(p.label){case 0:return s=function(e,n){return void 0===n&&(n=ae),(0,t.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,l,c=this;return(0,t.__generator)(this,(function(u){if(r=e.options,i=r.appId,o=r.apiKey,a=r.measurementId,!i)throw oe.create("no-app-id");if(!o){if(a)return[2,{measurementId:a,appId:i}];throw oe.create("no-api-key")}return s=n.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new he,setTimeout((function(){return(0,t.__awaiter)(c,void 0,void 0,(function(){return(0,t.__generator)(this,(function(e){return l.abort(),[2]}))}))}),6e4),[2,ce({appId:i,apiKey:o,measurementId:a},s,l,n)]}))}))}(e),s.then((function(t){r[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&te.warn("The measurement ID in the local Firebase config ("+e.options.measurementId+") does not match the measurement ID fetched from the server ("+t.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(e){return te.error(e)})),n.push(s),l=function(){return(0,t.__awaiter)(this,void 0,void 0,(function(){var e;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return(0,i.isIndexedDBAvailable)()?[3,1]:(te.warn(oe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return t.trys.push([1,3,,4]),[4,(0,i.validateIndexedDBOpenable)()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),te.warn(oe.create("indexeddb-unavailable",{errorInfo:e}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(e){return e?o.getId():void 0})),[4,Promise.all([s,l])];case 1:return c=p.sent(),u=c[0],h=c[1],a("js",new Date),(f={}).origin="firebase",f.update=!0,d=f,null!=h&&(d.firebase_id=h),a($.CONFIG,u.measurementId,d),[2,u.measurementId]}}))}))}(e,me,ge,n,de);var u={app:e,logEvent:function(e,n,r){(function(e,n,r,i,o){return(0,t.__awaiter)(this,void 0,void 0,(function(){var a,s;return(0,t.__generator)(this,(function(l){switch(l.label){case 0:return o&&o.global?(e($.EVENT,r,i),[2]):[3,1];case 1:return[4,n];case 2:a=l.sent(),s=(0,t.__assign)((0,t.__assign)({},i),{send_to:a}),e($.EVENT,r,s),l.label=3;case 3:return[2]}}))}))})(fe,pe[a],e,n,r).catch((function(e){return te.error(e)}))},setCurrentScreen:function(e,n){(function(e,n,r,i){return(0,t.__awaiter)(this,void 0,void 0,(function(){var o;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return i&&i.global?(e($.SET,{screen_name:r}),[2,Promise.resolve()]):[3,1];case 1:return[4,n];case 2:o=t.sent(),e($.CONFIG,o,{update:!0,screen_name:r}),t.label=3;case 3:return[2]}}))}))})(fe,pe[a],e,n).catch((function(e){return te.error(e)}))},setUserId:function(e,n){(function(e,n,r,i){return(0,t.__awaiter)(this,void 0,void 0,(function(){var o;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return i&&i.global?(e($.SET,{user_id:r}),[2,Promise.resolve()]):[3,1];case 1:return[4,n];case 2:o=t.sent(),e($.CONFIG,o,{update:!0,user_id:r}),t.label=3;case 3:return[2]}}))}))})(fe,pe[a],e,n).catch((function(e){return te.error(e)}))},setUserProperties:function(e,n){(function(e,n,r,i){return(0,t.__awaiter)(this,void 0,void 0,(function(){var o,a,s,l,c;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:if(!i||!i.global)return[3,1];for(o={},a=0,s=Object.keys(r);a<s.length;a++)l=s[a],o["user_properties."+l]=r[l];return e($.SET,o),[2,Promise.resolve()];case 1:return[4,n];case 2:c=t.sent(),e($.CONFIG,c,{update:!0,user_properties:r}),t.label=3;case 3:return[2]}}))}))})(fe,pe[a],e,n).catch((function(e){return te.error(e)}))},setAnalyticsCollectionEnabled:function(e){(function(e,n){return(0,t.__awaiter)(this,void 0,void 0,(function(){var r;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return[4,e];case 1:return r=t.sent(),window["ga-disable-"+r]=!n,[2]}}))}))})(pe[a],e).catch((function(e){return te.error(e)}))},INTERNAL:{delete:function(){return delete pe[a],Promise.resolve()}}};return u}var xe="analytics";function Se(){return(0,t.__awaiter)(this,void 0,void 0,(function(){return(0,t.__generator)(this,(function(e){switch(e.label){case 0:if((0,i.isBrowserExtension)())return[2,!1];if(!(0,i.areCookiesEnabled)())return[2,!1];if(!(0,i.isIndexedDBAvailable)())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(0,i.validateIndexedDBOpenable)()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,!1];case 4:return[2]}}))}))}!function(e){e.INTERNAL.registerComponent(new r.Component(xe,(function(e){return we(e.getProvider("app").getImmediate(),e.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:_e,EventName:K,isSupported:Se})),e.INTERNAL.registerComponent(new r.Component("analytics-internal",(function(e){try{return{logEvent:e.getProvider(xe).getImmediate().logEvent}}catch(e){throw oe.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),e.registerVersion("@firebase/analytics","0.6.0")}(n.default);var Ee=a(5577),Ae=a.n(Ee);a(1241),Ae().initializeApp({apiKey:"AIzaSyD691xhXsWl-8QU_9htjZnMUd7siWVCTAE",appId:"1:40711248674:web:511cb4cede47191274237b",authDomain:"allen-cell-resource.firebaseapp.com",databaseURL:"https://allen-cell-resource.firebaseio.com",measurementId:"G-8553S8ESS7",messagingSenderId:"40711248674",projectId:"allen-cell-resource",storageBucket:"allen-cell-resource.appspot.com"}),Ee.analytics.isSupported().then((function(e){e&&Ae().analytics()}));const Me=Ae().firestore();var Te=a(6540),Ce=a(5338),Ie=a(4976);function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ne(r.key),r)}}function De(e,t,n){return t&&ke(e.prototype,t),n&&ke(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oe(e,t,n){return(t=Ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e){var t=function(e){if("object"!=Re(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Re(t)?t:t+""}const Ue=De((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Oe(this,"getDoc",(function(e){return n.firestore.doc(e).get()})),Oe(this,"getCollection",(function(e){return n.firestore.collection(e).get()})),Oe(this,"getAvailableDatasets",(function(){return n.firestore.collection("dataset-descriptions").get().then((function(e){var t=[];return e.forEach((function(e){var n,r=e.data();(!(n=location.hostname)||n.includes("localhost")||n.includes("staging")||n.includes("stg")||r.production)&&t.push(r)})),t}))})),Oe(this,"setCollectionRef",(function(e){n.collectionRef=n.firestore.collection("cfe-datasets").doc(e)})),Oe(this,"getManifest",(function(e){return n.firestore.doc(e).get().then((function(e){return e.data()}))})),Oe(this,"selectDataset",(function(e){return n.getManifest(e).then((function(e){return n.featuresDataPath=e.featuresDataPath,n.thumbnailRoot=e.thumbnailRoot,n.downloadRoot=e.downloadRoot,n.volumeViewerDataRoot=e.volumeViewerDataRoot,n.featuresDisplayOrder=e.featuresDisplayOrder,n.cellLineDataPath=e.cellLineDataPath,n.fileInfoPath=e.fileInfoPath,n.featuresDataOrder=e.featuresDataOrder,n.featureDefsPath=e.featureDefsPath,n.albumPath=e.albumPath,{defaultXAxis:e.defaultXAxis,defaultYAxis:e.defaultYAxis,thumbnailRoot:e.thumbnailRoot,downloadRoot:e.downloadRoot,volumeViewerDataRoot:e.volumeViewerDataRoot}}))})),Oe(this,"getFileInfoByCellId",(function(e){return n.getDoc("".concat(n.fileInfoPath,"/").concat(e)).then((function(e){var t=e.data();if(t)return Le(Le({},t),{},{CellId:t.CellId.toString(),FOVId:t.FOVId.toString()})}))})),Oe(this,"getFileInfoByArrayOfCellIds",(function(e){return Promise.all(e.map((function(e){return n.getDoc("".concat(n.fileInfoPath,"/").concat(e)).then((function(e){var t=e.data();if(t)return Le(Le({},t),{},{CellId:t.CellId.toString(),FOVId:t.FOVId.toString()})}))})))})),this.firestore=t,this.featuresDataPath="",this.cellLineDataPath="",this.thumbnailRoot="",this.downloadRoot="",this.volumeViewerDataRoot="",this.featuresDisplayOrder=[],this.fileInfoPath="",this.datasetId="",this.featuresDataOrder=[],this.albumPath="",this.featureDefsPath="",this.collectionRef=t.collection("cfe-datasets").doc("v1")}));function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ze,Be,Ve,je=a(1130),He=a(6188),Ge=a(982),We=a(1917),qe=a(7767),Xe=a(1250),$e=a(3301),Ye=a(9084),Ke=Xe.Ay.div(ze||(Be=["\n  background-color: var(--color-landingpage-bg);\n  h2,\n  h3,\n  p {\n    margin: 0;\n  }\n"],Ve||(Ve=Be.slice(0)),ze=Object.freeze(Object.defineProperties(Be,{raw:{value:Object.freeze(Ve)}}))));function Ze(e){var t,n=(0,qe.r5)();return t=function(e){return"number"==typeof e.status&&"string"==typeof e.statusText}(n)?n.status+" "+n.statusText:n instanceof Error?n.message:"Unknown error",Te.createElement(Ke,{style:{background:"var(--color-landingpage-bg)",height:"100%"}},Te.createElement(Ye.A,null),Te.createElement($e.yY,{style:{width:"100%",padding:"40px 0"}},Te.createElement("h1",null,"Sorry, something went wrong."),Te.createElement($e.yY,null,Te.createElement("p",null,"We encountered the following error:"),Te.createElement($e.yY,{style:{margin:"20px 0"},$gap:10},Te.createElement("h3",null,t),Te.createElement("p",null,Te.createElement("i",null,"Check the browser console for more details."))),Te.createElement("p",null,"If the issue persists after a refresh,"," ",Te.createElement(Ie.N_,{to:"https://github.com/allen-cell-animated/vole-app/issues/new?template=bug_report.md",rel:"noopener noreferrer",target:"_blank"},"please click here to report it.",Te.createElement(Ge.g,{icon:He.k02,size:"sm",style:{marginBottom:"-1px",marginLeft:"3px"}})))),Te.createElement("br",null),Te.createElement(Ie.N_,{to:"/"},Te.createElement(We.Ay,{type:"primary"},"Return to homepage"))))}var Qe=a(2387);const Je=function(){return Te.useLayoutEffect((function(){var e=function(e){var t;if(e.origin!==window.location.origin){var n,r=e.data;void 0!==r.scenes?(window.localStorage.setItem("url",(0,Qe.am)(r)),void 0!==e.data.meta?window.localStorage.setItem("meta",JSON.stringify(r.meta)):window.localStorage.removeItem("meta"),null===(t=e.source)||void 0===t||t.postMessage("SUCCESS",e.origin)):null===(n=e.source)||void 0===n||n.postMessage("ERROR: no scenes",e.origin)}};return window.addEventListener("message",e),function(){return window.removeEventListener("message",e)}}),[]),null};function et(e){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et(e)}function tt(){tt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,a=Object.create(o.prototype),s=new R(r||[]);return i(a,"_invoke",{value:M(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",m="completed",g={};function v(){}function y(){}function b(){}var _={};c(_,a,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(P([])));x&&x!==n&&r.call(x,a)&&(_=x);var S=b.prototype=v.prototype=Object.create(_);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(i,o,a,s){var l=h(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==et(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function M(t,n,r){var i=d;return function(o,a){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=T(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?m:f,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=m,r.method="throw",r.arg=c.arg)}}}function T(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(et(t)+" is not iterable")}return y.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},E(A.prototype),c(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new A(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(S),c(S,l,"Generator"),c(S,a,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function nt(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function rt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){nt(o,r,i,a,s,"next",e)}function s(e){nt(o,r,i,a,s,"throw",e)}a(void 0)}))}}console.log("vole-app ".concat("production"," build")),console.log("vole-app Version ".concat("2.13.7")),console.log("vole-app Basename ".concat("/vole-app/pr-preview/pr-443/")),console.log("vole-core Version ".concat("4.1.0"));var it,ot=new Ue(Me),at=new URL(window.location.toString());if(""!==at.hash||""!==(it=at).search&&it.search.startsWith("?/")){var st=function(e){if(e.hash.startsWith("#/")){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Fe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.hash.slice(2).split("?"),2),n=t[0],r=t[1];e.pathname+=n,e.search=r?"?".concat(r):"",e.hash=""}return e}(function(e){return function(e){if(!e.search||!e.search.startsWith("?/"))return e;var t=e.search.slice(2).split("&").map((function(e){return e.replace(new RegExp("~and~","g"),"&")})).join("?");return new URL("".concat(e.origin).concat(e.pathname).concat(t).concat(e.hash))}(e)}(at)),lt=st.pathname+st.search+st.hash;console.log("Redirecting to "+lt),window.history.replaceState(null,"",lt)}var ct,ut,ht=[{path:"/",lazy:(ut=rt(tt().mark((function e(){var t;return tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.e(719),a.e(226),a.e(412)]).then(a.bind(a,7428));case 2:return t=e.sent.default,e.abrupt("return",{Component:function(){return Te.createElement(t,{firebaseDb:ot})}});case 4:case"end":return e.stop()}}),e)}))),function(){return ut.apply(this,arguments)}),errorElement:Te.createElement(Ze,null)},{path:"viewer",lazy:(ct=rt(tt().mark((function e(){var t;return tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.e(719),a.e(846),a.e(226),a.e(185)]).then(a.bind(a,4185));case 2:return t=e.sent.default,e.abrupt("return",{Component:function(){return Te.createElement(t,{firebaseDb:ot})}});case 4:case"end":return e.stop()}}),e)}))),function(){return ct.apply(this,arguments)}),errorElement:Te.createElement(Ze,null)},{path:"write_storage",element:Te.createElement(Je,null),errorElement:Te.createElement(Ze,null)}],dt=(0,Ie.Ys)(ht,{basename:"/vole-app/pr-preview/pr-443/"});(0,Ce.H)(document.getElementById("cell-viewer")).render(Te.createElement(je.A,null,Te.createElement(Ie.pg,{router:dt})))})()})();
//# sourceMappingURL=index.bundle.js.map