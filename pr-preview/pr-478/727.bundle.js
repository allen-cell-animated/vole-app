/*! For license information please see 727.bundle.js.LICENSE.txt */
(self.webpackChunk_aics_vole_app=self.webpackChunk_aics_vole_app||[]).push([[283,727],{709(e,t,n){"use strict";n.d(t,{w:()=>w});var r=n(2515),o=n(8e3),a=n(7260),i=n(1917),l=n(6540),c=n(4097);function u(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||f(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||f(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t,n){return(t=function(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=function(e){var t=e.bug,n=e.children;return l.createElement("a",{href:"https://github.com/allen-cell-animated/vole-app/issues/new".concat(t?"?template=bug_report.md":"/choose"),target:"_blank",rel:"noreferrer noopener"},n)},y=l.createElement(l.Fragment,null,"An unknown error occurred. Check the browser console (F12) for more details. If this looks like a bug,"," ",l.createElement(v,{bug:!0},"send us a bug report here"),"."),h=d(d(d(d(d(d({},r.f8.UNKNOWN,l.createElement(l.Fragment,null,"An unknown error occurred while loading volume data. Check the browser console (F12) for more details. If this looks like a bug, ",l.createElement(v,{bug:!0},"send us a bug report here"),".")),r.f8.NOT_FOUND,l.createElement(l.Fragment,null,"The viewer was unable to find any volume data at the specified location. Check that the provided URL is correct and try again.")),r.f8.TOO_LARGE,l.createElement(l.Fragment,null,"No scale level is available for this volume which fits within our maximum GPU memory footprint. This maximum is tuned to ensure compatibility with the majority of browsers. If you're trying to load your own OME-Zarr dataset, you may be able to open this volume by including a lower scale level.")),r.f8.LOAD_DATA_FAILED,l.createElement(l.Fragment,null,"The viewer was able to find a source of volume data at the specified location, but encountered an error while trying to load it. Check that your dataset is complete and properly formatted. You can also check the browser console (F12) for more details about this error. If it looks like a problem on our end,"," ",l.createElement(v,{bug:!0},"start a bug report here"),".")),r.f8.INVALID_METADATA,l.createElement(l.Fragment,null,"The viewer was unable to read all necessary information from this volume's metadata. Check that your dataset's metadata is complete and properly formatted. If you believe your data is valid and should be supported by our viewer, let us know by ",l.createElement(v,null,"opening a GitHub issue"),".")),r.f8.INVALID_MULTI_SOURCE_ZARR,l.createElement(l.Fragment,null,"The viewer is currently configured to consolidate multiple OME-Zarr datasets into a single volume, but the provided datasets can't all be matched up. Ensure that all dataset URLs are correct and that at least one equivalently-sized scale level exists in all datasets.")),b=function(e){var t;return e instanceof Error&&(null===(t=e.toString)||void 0===t?void 0:t.call(e))||"string"==typeof e&&e||"object"===p(e)&&null!==e&&e.title||"Unknown error"},g=function(e){var t=e.errors,n=e.firstErrorCount,r=void 0===n?0:n,c=e.afterClose,u=e.onSkipError,f=s(l.useState(!1),2),m=f[0],d=f[1],v=s(l.useState(0),2),g=v[0],w=v[1],S=Array.isArray(t)?t[0]:t,E=l.createElement(l.Fragment,null,l.createElement("div",null,b(S)+(r>1?" (".concat(r,")"):"")," ",l.createElement(i.Ay,{type:"text",onClick:function(){return d(!m)}},m?"Show less info":"Show more info")),l.createElement("div",{style:{display:m?void 0:"none"}},function(e){var t,n=e.type;return n?null!==(t=h[n])&&void 0!==t?t:y:"object"===p(e)&&null!==e&&e.description||y}(S))),O=Array.isArray(t)&&t.length>1&&l.createElement(i.Ay,{type:"text",onClick:function(){w((function(e){return e+1})),null==u||u()}},"Error ",g+1," of ",t.length+g," ",l.createElement(o.A,null));return l.createElement(a.A,{showIcon:!0,type:"error",className:"load-error-alert",message:E,closable:!0,afterClose:function(){w(0),null==c||c()},action:O})},w=function(){var e=s(l.useState([]),2),t=e[0],n=e[1],r=(0,c.Q)((function(){return new Map})),o=s(l.useState([]),2),a=o[0],i=o[1],f=l.useCallback((function(e){var t,o=b(e);console.error(e instanceof Error?e:o);var a=(null!==(t=r.get(o))&&void 0!==t?t:0)+1;n((function(t){return[].concat(u(t),[e])})),i((function(e){return[].concat(u(e),[a])})),r.set(o,a)}),[r]),m=l.useCallback((function(){n((function(e){return e.slice(1)})),i((function(e){return e.slice(1)}))}),[]),p=l.useCallback((function(){n([]),i([])}),[]),d=a[0];return[t.length>0&&l.createElement(g,{errors:t,firstErrorCount:d,onSkipError:m,afterClose:p}),f]}},4270(e,t,n){"use strict";n.d(t,{$m:()=>T,BO:()=>d,CB:()=>c,Ci:()=>S,D8:()=>A,D_:()=>O,EB:()=>M,L9:()=>C,Lr:()=>w,N1:()=>x,UB:()=>p,Wv:()=>E,YT:()=>g,g1:()=>L,iz:()=>D,jR:()=>h,kP:()=>I,lI:()=>m,lV:()=>l,n1:()=>b,uR:()=>u,xB:()=>v});var r=n(2515),o=n(4381);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t,n){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=970,c=200,u=235,s=[0,0,0],f=[255,255,255],m=[16,16],p=[120,12],d=.5,v=.983,y=[35,140,255],h="Other",b="Channels",g=[255,255,255],w=255,S=1e9,E=10,O=4,x={t:r.HA.T_PLUS,z:r.HA.Z_PLUS,y:r.HA.Y_PLUS,x:r.HA.X_PLUS},C={int8:{min:-Math.pow(2,7),max:Math.pow(2,7)-1},int16:{min:-Math.pow(2,15),max:Math.pow(2,15)-1},int32:{min:-Math.pow(2,31),max:Math.pow(2,31)-1},uint8:{min:0,max:Math.pow(2,8)-1},uint16:{min:0,max:Math.pow(2,16)-1},uint32:{min:0,max:Math.pow(2,32)-1},float32:{min:0,max:Math.pow(2,8)-1},float64:{min:0,max:Math.pow(2,8)-1}},j=[[226,205,179],[111,186,17],[141,163,192],[245,241,203],[224,227,209],[221,155,245],[227,244,245],[255,98,0],[247,219,120]],A=Object.freeze([{colors:j,name:"Default"},{colors:[[190,68,171],[189,211,75],[61,155,169],[128,128,128],[255,255,255],[239,27,45],[238,77,245],[96,255,255]],name:"Thumbnail colors"},{colors:[[128,0,0],[0,128,0],[0,0,128],[32,32,32],[255,255,0],[255,0,255],[0,255,0],[0,0,255]],name:"RGB colors"},{colors:[[128,0,128],[128,128,128],[0,128,128],[128,128,0],[255,255,255],[255,0,0],[255,0,255],[0,255,255]],name:"White structure"}]),P=i(i(i(i({},o.nE.threeD,[0,0,5]),o.nE.xy,[0,0,2]),o.nE.xz,[0,2,0]),o.nE.yz,[2,0,0]),k=i(i(i(i({},o.nE.threeD,[0,1,0]),o.nE.xy,[0,1,0]),o.nE.xz,[0,0,1]),o.nE.yz,[0,0,1]),I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.nE.threeD;return{position:P[e],target:[0,0,0],up:k[e],fov:20,orthoScale:.5}},M=function(){return{groups:[{name:"Channels",channels:[{match:[0,1,2],enabled:!0},{match:"(.+)",enabled:!1}]}]}},T=function(){return{viewMode:o.nE.threeD,renderMode:o.G9.volumetric,imageType:o.yj.segmentedCell,showAxes:!1,showBoundingBox:!1,backgroundColor:s,boundingBoxColor:f,autorotate:!1,maskAlpha:0,brightness:70,density:50,levels:y,interpolationEnabled:!0,region:{x:[0,1],y:[0,1],z:[0,1]},slice:{x:.5,y:.5,z:.5},time:0,scene:0,cameraState:void 0}},N=j;function D(e){return N[e%N.length]}var L=function(){return{name:"",displayName:"",volumeEnabled:!1,isosurfaceEnabled:!1,colorizeEnabled:!1,colorizeAlpha:1,isovalue:128,opacity:1,color:D(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0),useControlPoints:!1,ramp:[0,w],controlPoints:[{x:0,opacity:0,color:[255,255,255]},{x:255,opacity:1,color:[255,255,255]}],plotMin:0,plotMax:w,keepIntensityRange:!1}}},4381(e,t,n){"use strict";n.d(t,{G9:()=>o,nE:()=>r,yj:()=>a});var r=function(e){return e.threeD="3D",e.xy="XY",e.xz="XZ",e.yz="YZ",e}({}),o=function(e){return e.volumetric="volumetric",e.maxProject="maxproject",e.pathTrace="pathtrace",e}({}),a=function(e){return e.segmentedCell="cell",e.fullField="fov",e}({})},4097(e,t,n){"use strict";n.d(t,{G:()=>o,Q:()=>a});var r=n(6540);function o(e,t){var n=(0,r.useRef)(t),o=(0,r.useCallback)((function(t){n.current=t,e(t)}),[e,n]);return[n,o]}function a(e){var t=(0,r.useRef)(null);return null===t.current&&(t.current=e()),t.current}},3668(e,t,n){"use strict";n.d(t,{HW:()=>w,ND:()=>S,f5:()=>b,hm:()=>g});var r=n(2543);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var u="GLOBAL_ENTRY_QUEUE",s=function(e){return e.Scenes="scenes",e.Meta="meta",e}(s||{}),f={scenes:25,meta:1e3},m=function(e){return e.includes(",")?encodeURIComponent(e):e};function p(e,t){try{return window.localStorage.setItem(e,t),!0}catch(e){if(e instanceof DOMException&&"QuotaExceededError"===e.name)return!1;throw e}}function d(e,t,n){for(var r=[];!p(e,Array.isArray(t)?t.join(","):t);){var o=n.shift();if(void 0===o){var l,c=i(r);try{for(c.s();!(l=c.n()).done;){var u=a(l.value,2),s=u[0];p(s,u[1])&&n.unshift(s)}}catch(e){c.e(e)}finally{c.f()}return!1}var f=window.localStorage.getItem(o);null!==f&&(r.push([o,f]),window.localStorage.removeItem(o))}return!0}var v=function(){var e,t;return null!==(e=null===(t=window.localStorage.getItem(u))||void 0===t?void 0:t.split(","))&&void 0!==e?e:[]},y=function(e){return d(u,e,e)};function h(e,t){for(var n=v(),o=t?"".concat(t,"@"):"",l=(0,r.mapKeys)(e,(function(e,t){return m(t)})),c=0,u=[],s=n.filter((function(e){if(e.startsWith(o)){if(e.slice(o.length)in l)return!1;void 0!==t&&u.push(c)}return c+=1,!0})),p=0,h=Object.keys(l);p<h.length;p++){var b=h[p];u.push(s.length),s.push(o+b)}if(void 0!==t){var g,w=i(u.slice(0,-f[t]).reverse());try{for(w.s();!(g=w.n()).done;){var S=g.value,E=a(s.splice(S,1),1)[0];window.localStorage.removeItem(E),delete l[E.slice(o.length)]}}catch(e){w.e(e)}finally{w.f()}}for(var O=Object.entries(l),x=O.length<2?void 0:o+O[0][0],C=!0,j=0,A=Object.entries(l);j<A.length;j++){var P=a(A[j],2),k=P[0],I=P[1],M=d(o+k,I,s);C=C&&M}var T=y(s);return C&&T&&(void 0===x||null!==window.localStorage.getItem(x))}function b(e){return h((0,r.mapValues)(e,(function(e){return JSON.stringify(e)})),s.Meta)}function g(e,t){return h((n={},r=m(e),a=t,(r=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(r))in n?Object.defineProperty(n,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[r]=a,n),s.Scenes);var n,r,a}function w(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Set,o=e.map((function(e){if(!Array.isArray(e)){var t="".concat(s.Meta,"@").concat(m(e)),n=window.localStorage.getItem(t);if(null!==n)return r.add(t),JSON.parse(n)}}));if(r.size>0&&!n){var a=v().filter((function(e){return!r.has(e)}));a.push.apply(a,function(e){if(Array.isArray(e))return c(e)}(t=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),y(a)}return o}function S(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="".concat(s.Scenes,"@").concat(m(e)),r=window.localStorage.getItem(n);if(null!==r){if(!t){var o=v(),a=o.indexOf(n);-1!==a&&o.splice(a,1),o.push(n),y(o)}return r}}},5870(e,t,n){"use strict";n.d(t,{RM:()=>le,$7:()=>ie,Zv:()=>ot,bT:()=>nt,wu:()=>at});var r=n(2543),o=n(4270),a=n(4381);function i(e){var t={};for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}function l(e,t){var n={};for(var o in e)(0,r.isEqual)(e[o],t[o])||(n[o]=e[o]);return n}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function m(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}const v=m((function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"getDoc",(function(e){return n.firestore.doc(e).get()})),p(this,"getAvailableDatasets",(function(){return n.firestore.collection("dataset-descriptions").get().then((function(e){var t=[];return e.forEach((function(e){var n,r=e.data();(!(n=location.hostname)||n.includes("localhost")||n.includes("staging")||n.includes("stg")||r.production)&&t.push(r)})),t}))})),p(this,"setCollectionRef",(function(e){n.collectionRef=n.firestore.collection("cfe-datasets").doc(e)})),p(this,"getManifest",(function(e){return n.firestore.doc(e).get().then((function(e){return e.data()}))})),p(this,"selectDataset",(function(e){return n.getManifest(e).then((function(e){return n.featuresDataPath=e.featuresDataPath,n.thumbnailRoot=e.thumbnailRoot,n.downloadRoot=e.downloadRoot,n.volumeViewerDataRoot=e.volumeViewerDataRoot,n.featuresDisplayOrder=e.featuresDisplayOrder,n.cellLineDataPath=e.cellLineDataPath,n.fileInfoPath=e.fileInfoPath,n.featuresDataOrder=e.featuresDataOrder,n.featureDefsPath=e.featureDefsPath,n.albumPath=e.albumPath,s({},e)}))})),p(this,"getFileInfoByCellId",(function(e){return n.getDoc("".concat(n.fileInfoPath,"/").concat(e)).then((function(e){var t=e.data();if(t)return s(s({},t),{},{CellId:t.CellId.toString(),FOVId:t.FOVId.toString()})}))})),p(this,"getFileInfoByArrayOfCellIds",(function(e){return Promise.all(e.map((function(e){return n.getDoc("".concat(n.fileInfoPath,"/").concat(e)).then((function(e){var t=e.data();if(t)return s(s({},t),{},{CellId:t.CellId.toString(),FOVId:t.FOVId.toString()})}))})))})),this.firestore=t,this.featuresDataPath="",this.cellLineDataPath="",this.thumbnailRoot="",this.downloadRoot="",this.volumeViewerDataRoot="",this.featuresDisplayOrder=[],this.fileInfoPath="",this.datasetId="",this.featuresDataOrder=[],this.albumPath="",this.featureDefsPath="",this.collectionRef=t.collection("cfe-datasets").doc("v1")}));function y(e,t,n){return Math.min(Math.max(e,t),n)}var h,b,g,w,S,E,O,x,C,j,A,P,k,I,M,T,N,D,L=n(3668);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function B(){var e=G(),t=e.m(B),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,z(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(B=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new $(e,t)},AsyncIterator:H,async:function(e,t,n,o,i){return(r(t)?U:V)(a(e),t,n,o,i)},keys:F,values:z}})()}function z(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(R(e)+" is not iterable")}function F(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function V(e,t,n,r,o){var a=U(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function U(e,t,n,r,o){return new H(G().w(e,t,n,r),o||Promise)}function H(e,t){function n(r,o,a,i){try{var l=e[r](o),c=l.value;return c instanceof $?t.resolve(c.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(c).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(_(H.prototype),_(H.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),_(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function G(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return _(u,"_invoke",function(n,r,o){var a,l,c,u=0,s=o||[],f=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,l=0,c=e,m.n=n,i}};function p(n,r){for(l=n,c=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,a=s[t],p=m.p,d=a[2];n>3?(o=d===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,m.v=r,m.n=a[1]):p<d&&(o=n<3||a[0]>r||r>d)&&(a[4]=n,a[5]=r,m.n=d,l=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!f;){a||(l?l<3?(l>1&&(m.n=-1),p(l,c)):m.n=c:m.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(f=m.n<0)?c:n.call(r,m))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(_(t={},r,(function(){return this})),t),f=u.prototype=l.prototype=Object.create(s);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,_(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,_(f,"constructor",u),_(u,"constructor",c),c.displayName="GeneratorFunction",_(u,o,"GeneratorFunction"),_(f),_(f,o,"Generator"),_(f,r,(function(){return this})),_(f,"toString",(function(){return"[object Generator]"})),(G=function(){return{w:a,m}})()}function _(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_=function(e,t,n,r){function a(t,n){_(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},_(e,t,n,r)}function $(e,t){this.v=e,this.k=t}function W(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){W(a,r,o,i,l,"next",e)}function l(e){W(a,r,o,i,l,"throw",e)}i(void 0)}))}}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){oe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||J(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=J(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function K(e){return function(e){if(Array.isArray(e))return ee(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||J(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){if(e){if("string"==typeof e)return ee(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ae(r.key),r)}}function ne(e,t,n){return t&&te(e.prototype,t),n&&te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t,n){return(t=ae(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e){var t=function(e){if("object"!=R(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R(t)?t:t+""}var ie=/%2C/g,le=/%3A/g,ce=[255,255,255],ue=/-?[0-9]*.?[0-9]+/,se=/^c[0-9]+$/,fe=/^-?[a-z0-9.]*:[ ]*-?[a-z0-9.]*$/,me=new RegExp("^".concat(ue.source,":").concat(ue.source,"$")),pe=new RegExp("^".concat(ue.source,",").concat(ue.source,",").concat(ue.source,"$")),de=new RegExp("^(".concat(ue.source,":").concat(ue.source,")(,").concat(ue.source,":").concat(ue.source,"){2}$")),ve=new RegExp("(([0-9a-fA-F]{6})|".concat("1",")")),ye=new RegExp("(".concat(ue.source,":").concat(ue.source,":").concat(ve.source,")")),he=new RegExp("^".concat(ve.source,"$")),be=new RegExp("^".concat(ye.source,"(,").concat(ye.source,")*$")),ge=new RegExp("^".concat(ye.source,"(:").concat(ye.source,")*$")),we=function(e){return e.View="view",e.Mode="mode",e.Mask="mask",e.Image="image",e.Axes="axes",e.BoundingBox="bb",e.BoundingBoxColor="bbcol",e.BackgroundColor="bgcol",e.Autorotate="rot",e.Brightness="bright",e.Density="dens",e.Levels="lvl",e.Interpolation="interp",e.Region="reg",e.Slice="slice",e.Time="t",e.Scene="scene",e.CameraState="cam",e}({}),Se=function(e){return e.Position="pos",e.Target="tar",e.Up="up",e.OrthoScale="ort",e.Fov="fov",e}({}),Ee=function(e){return e.Color="col",e.Colorize="clz",e.ColorizeAlpha="cza",e.IsosurfaceAlpha="isa",e.Lut="lut",e.ControlPoints="cpt",e.ControlPointsLegacy="cps",e.Ramp="ram",e.RampLegacy="rmp",e.ControlPointsEnabled="cpe",e.VolumeEnabled="ven",e.SurfaceEnabled="sen",e.IsosurfaceValue="isv",e.KeepRange="pin",e}({});Ee.Color,Ee.Colorize,Ee.ColorizeAlpha,Ee.IsosurfaceAlpha,Ee.Lut,Ee.ControlPointsLegacy,Ee.ControlPoints,Ee.ControlPointsEnabled,Ee.RampLegacy,Ee.Ramp,Ee.VolumeEnabled,Ee.SurfaceEnabled,Ee.IsosurfaceValue,Ee.KeepRange,h=we.View,b=we.Mode,g=we.Mask,w=we.Image,S=we.Axes,E=we.BoundingBox,O=we.BoundingBoxColor,x=we.BackgroundColor,C=we.Autorotate,j=we.Brightness,A=we.Density,P=we.Levels,k=we.Interpolation,I=we.Region,M=we.Slice,T=we.Time,N=we.Scene,D=we.CameraState;var Oe=ne((function e(){re(this,e),oe(this,h,void 0),oe(this,b,void 0),oe(this,g,void 0),oe(this,w,void 0),oe(this,S,void 0),oe(this,E,void 0),oe(this,O,void 0),oe(this,x,void 0),oe(this,C,void 0),oe(this,j,void 0),oe(this,A,void 0),oe(this,P,void 0),oe(this,k,void 0),oe(this,I,void 0),oe(this,M,void 0),oe(this,T,void 0),oe(this,N,void 0),oe(this,D,void 0)})),xe=ne((function e(){re(this,e),oe(this,"url",void 0),oe(this,"manifest",void 0),oe(this,"dataset",void 0),oe(this,"id",void 0),oe(this,"collectionid",void 0),oe(this,"msgorigin",void 0)})),Ce=ne((function e(){re(this,e),oe(this,"ch",void 0),oe(this,"luts",void 0),oe(this,"colors",void 0)})),je=[].concat(K(Object.keys(new Oe)),K(Object.keys(new xe)),K(Object.keys(new Ce))),Ae=function(e){return-1!==je.indexOf(e)},Pe=function(e){return se.test(e)};function ke(e){var t,n={},r=q(e.entries());try{for(r.s();!(t=r.n()).done;){var o=X(t.value,2),a=o[0],i=o[1];(Ae(a)||Pe(a))&&(n[a]=i)}}catch(e){r.e(e)}finally{r.f()}return n}var Ie=function(e,t){var n=(e.startsWith("?")?e.slice(1):e).split("&"),r=t+"=",o=n.find((function(e){return e.startsWith(r)}));return null==o?void 0:o.slice(r.length)},Me=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return!1},n=e;!t(n)&&!URL.canParse(n);)try{var r=decodeURIComponent(n);if(r===n)return n;n=r}catch(e){return n}return n},Te=function(e){return Me(e,(function(e){return/[+ ,]/.test(e)})).split(/[+ ]/).map((function(e){var t=Me(e,(function(e){return e.includes(",")})).split(",");return 1===t.length?t:t.map((function(e){return Me(e)}))}))};function Ne(e){if(""===e)return{};var t,n={},r=q(e.split(","));try{for(r.s();!(t=r.n()).done;){var o=t.value,a=o.indexOf(":"),i=o.slice(0,a),l=o.slice(a+1);n[decodeURIComponent(i).trim()]=decodeURIComponent(l).trim()}}catch(e){r.e(e)}finally{r.f()}return n}function De(e){var t=[];for(var n in e){var r=e[n];if(void 0!==r){var o=encodeURIComponent(r.trim()).replace(le,":");t.push("".concat(encodeURIComponent(n.trim()),":").concat(o))}}return t.join(",")}function Le(e,t,n){if(void 0!==e){var r=Number.parseFloat(e);return Number.isNaN(r)?void 0:y(r,t,n)}}function Re(e,t,n){if(void 0!==e){var r=Number.parseInt(e,10);if(!Number.isNaN(r))return y(r,t,n)}}function Be(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return void 0!==e&&Object.values(t).includes(e)?e:n}function ze(e){if(void 0!==e)return"1"===e}function Fe(e){if(e&&he.test(e))return"1"===e?ce:[Number.parseInt(e.slice(0,2),16),Number.parseInt(e.slice(2,4),16),Number.parseInt(e.slice(4,6),16)]}function Ve(e){return e.map((function(e){return e.toString(16).padStart(2,"0")})).join("").toLowerCase()}function Ue(e){if(e&&pe.test(e)){var t=X(e.split(",").map((function(e){return Le(e,0,1)})),3),n=t[0],r=t[1],o=t[2];if(void 0!==n&&void 0!==r&&void 0!==o)return{x:n,y:r,z:o}}}function He(e,t){var n,r,o;if(e){var a=null!==(n=null==t?void 0:t.min)&&void 0!==n?n:Number.NEGATIVE_INFINITY,i=null!==(r=null==t?void 0:t.max)&&void 0!==r?r:Number.POSITIVE_INFINITY,l=null!==(o=null==t?void 0:t.separator)&&void 0!==o?o:",",c=X(e.split(l).map((function(e){return Le(e,a,i)})),3),u=c[0],s=c[1],f=c[2];if(void 0!==u&&void 0!==s&&void 0!==f)return[u,s,f]}}function Ge(e){if(e&&de.test(e)){var t=e.split(",").map((function(e){var t=X(e.split(":").map((function(e){return Le(e,0,1)})),2),n=t[0],r=t[1];if(void 0!==n&&void 0!==r)return n<r?[n,r]:[r,n]})),n=X(t,3),r=n[0],o=n[1],a=n[2];if(void 0!==r&&void 0!==o&&void 0!==a)return{x:r,y:o,z:a}}}function _e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;return Number.isInteger(e)?e.toString():Number(e.toPrecision(t)).toString()}function $e(e){return[e.x,e.y,e.z]}function We(e){if(void 0!==e)return e?"1":"0"}function Ze(e){if(e){var t=Ne(e);return i({position:He(t[Se.Position],{separator:":"}),target:He(t[Se.Target],{separator:":"}),up:He(t[Se.Up],{separator:":"}),orthoScale:Le(t[Se.OrthoScale],0,1/0),fov:Le(t[Se.Fov],0,180)})}}function Ye(e){if(e&&(ge.test(e)||be.test(e)))return(be.test(e)?e.split(",").map((function(e){return e.split(":")})):e.split(":").reduce((function(e,t,n,r){return(n+1)%3==0&&e.push([r[n-2],r[n-1],r[n]]),e}),[])).map((function(e){var t,n,r,o=X(e,3),a=o[0],i=o[1],l=o[2];return{x:null!==(t=Le(a,-1/0,1/0))&&void 0!==t?t:0,opacity:null!==(n=Le(i,0,1))&&void 0!==n?n:1,color:null!==(r=Fe(l))&&void 0!==r?r:ce}})).sort((function(e,t){return e.x-t.x}))}function Qe(e){var t={maskAlpha:Re(e[we.Mask],0,100),imageType:Be(e[we.Image],a.yj),showAxes:ze(e[we.Axes]),showBoundingBox:ze(e[we.BoundingBox]),boundingBoxColor:Fe(e[we.BoundingBoxColor]),backgroundColor:Fe(e[we.BackgroundColor]),autorotate:ze(e[we.Autorotate]),brightness:Le(e[we.Brightness],0,100),density:Le(e[we.Density],0,100),levels:He(e[we.Levels],{min:0,max:255}),interpolationEnabled:ze(e[we.Interpolation]),region:Ge(e[we.Region]),slice:Ue(e[we.Slice]),time:Re(e[we.Time],0,Number.POSITIVE_INFINITY),scene:Re(e[we.Scene],0,Number.POSITIVE_INFINITY),renderMode:Be(e[we.Mode],a.G9),cameraState:Ze(e[we.CameraState])};if(e.view){var n,r={"3D":a.nE.threeD,Z:a.nE.xy,Y:a.nE.xz,X:a.nE.yz};n=Object.keys(r).includes(e.view.toUpperCase())?e.view.toUpperCase():"3D",t.viewMode=r[n]}return i(t)}function Xe(e){if(e.ch){for(var t={groups:[{name:"Channels",channels:[]}]},n=t.groups[0].channels,r=e.ch.split(",").map((function(e){return Number.parseInt(e,10)})),o=0;o<r.length;++o)n.push({match:r[o],enabled:!0});if(e.luts){var a=e.luts.split(",");if(a.length!==2*n.length)console.warn("ILL-FORMED QUERYSTRING: luts must have a min/max for each ch");else for(var i=0;i<n.length;++i)n[i].lut=[a[2*i],a[2*i+1]]}if(e.colors){var l=e.colors.split(",");if(l.length!==n.length)console.warn("ILL-FORMED QUERYSTRING: if colors specified, must have a color for each ch");else for(var c=0;c<n.length;++c)n[c].color=l[c]}return t}}function qe(e){var t=new Map;if(Object.keys(e).forEach((function(n){if(Pe(n)){var r=Number.parseInt(n.slice(1),10);try{var o=function(e,t){var n={match:e,enabled:ze(t[Ee.VolumeEnabled]),surfaceEnabled:ze(t[Ee.SurfaceEnabled]),isovalue:Le(t[Ee.IsosurfaceValue],-1/0,1/0),keepIntensityRange:ze(t[Ee.KeepRange]),surfaceOpacity:Le(t[Ee.IsosurfaceAlpha],0,1),colorizeEnabled:ze(t[Ee.Colorize]),colorizeAlpha:Le(t[Ee.ColorizeAlpha],0,1),controlPointsEnabled:ze(t[Ee.ControlPointsEnabled])};if(t[Ee.Color]&&ve.test(t.col)&&(n.color=t[Ee.Color]),t[Ee.Lut]&&fe.test(t.lut)){var r=X(t[Ee.Lut].split(":"),2),o=r[0],a=r[1];n.intensity=Q(Q({},n.intensity),{},{lut:[o.trim(),a.trim()]})}if(t[Ee.Ramp]){if(me.test(t[Ee.Ramp])){var i=X(t[Ee.Ramp].split(":"),2),l=i[0],c=i[1];n.intensity=Q(Q({},n.intensity),{},{ramp:[Number.parseFloat(l),Number.parseFloat(c)]})}}else if(t[Ee.RampLegacy]&&me.test(t[Ee.RampLegacy])){var u=X(t[Ee.RampLegacy].split(":"),2),s=u[0],f=u[1];n.ramp=[Number.parseFloat(s),Number.parseFloat(f)]}if(t[Ee.ControlPoints]){var m=Ye(t[Ee.ControlPoints]);m&&(n.intensity=Q(Q({},n.intensity),{},{controlPoints:m}))}else if(t[Ee.ControlPointsLegacy]){var p=Ye(t[Ee.ControlPointsLegacy]);p&&(n.controlPoints=p)}return n}(r,Ne(e[n]));t.set(r,o)}catch(e){console.warn("url_utils.getArgsFromParams: Failed to parse channel settings for channel ".concat(r," from URL parameters."),e)}}})),t.size>0)return{groups:[{name:"Channels",channels:Array.from(t.values())}]}}function Ke(e,t,n){return Je.apply(this,arguments)}function Je(){return(Je=Z(B().mark((function e(t,n,r){var o,a,i,l,c,u,s,f,m,p,d,y,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new v(t),a={},e.next=4,o.getAvailableDatasets();case 4:i=e.sent,l=void 0,c=q(i),e.prev=7,c.s();case 9:if((u=c.n()).done){e.next=19;break}if(s=u.value,f=s.datasets,m=Object.keys(f),!(p=m.find((function(e){return e===n})))){e.next=17;break}return l=f[p],e.abrupt("break",19);case 17:e.next=9;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(7),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:if(void 0!==l){e.next=30;break}return console.error("No matching dataset: ".concat(n)),e.abrupt("return",{});case 30:return e.next=32,o.selectDataset(l.manifest);case 32:return d=e.sent,y=d.volumeViewerDataRoot+"/",a.imageDownloadHref=d.downloadRoot+"/"+r,e.next=37,o.getFileInfoByCellId(r);case 37:return h=e.sent,a.imageUrl=y+h.volumeviewerPath,a.parentImageUrl=y+h.fovVolumeviewerPath,e.abrupt("return",a);case 41:case"end":return e.stop()}}),e,null,[[7,21,24,27]])})))).apply(this,arguments)}function et(e){return tt.apply(this,arguments)}function tt(){return(tt=Z(B().mark((function e(t){var n,r,o,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:n=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),console.error(e.t0),new Error("JSON manifest could not be fetched from URL '".concat(t,"': ").concat(e.t0));case 10:if(n.ok){e.next=12;break}throw new Error("JSON manifest could not be fetched from URL '".concat(t,"': Received ").concat(n.status," ").concat(n.statusText));case 12:return e.prev=12,e.next=15,n.json();case 15:r=e.sent,e.next=21;break;case 18:throw e.prev=18,e.t1=e.catch(12),new Error("Could not parse JSON manifest from URL '".concat(t,"': ").concat(e.t1));case 21:if(void 0!==(o=r.scenes)){e.next=24;break}throw new Error("No 'scenes' property was found in JSON manifest from URL '".concat(t,"'"));case 24:if("string"==typeof o&&(o=[o]),Array.isArray(o)&&0!==o.length&&(i=o,Array.isArray(i)&&i.every((function(e){return"string"==typeof e||function(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e)})))){e.next=27;break}throw new Error("Invalid 'scenes' property found in JSON manifest from URL '".concat(t,"'. 'scenes' must be a non-empty array of strings or string arrays."));case 27:return a=void 0,void 0!==r.meta&&Array.isArray(r.meta)&&(a=r.meta),e.abrupt("return",{scenes:o,metadata:a});case 30:case"end":return e.stop()}var i}),e,null,[[0,6],[12,18]])})))).apply(this,arguments)}function nt(e,t){return rt.apply(this,arguments)}function rt(){return(rt=Z(B().mark((function e(t,n){var r,o,a,l,c,u,s,f,m,p,d,v,y,h,b,g,w,S;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URLSearchParams(t),o=ke(r),a={},l=Qe(o),c=Xe(o),u=qe(o),a.viewerChannelSettings=null!=u?u:c,void 0===o.manifest&&void 0===o.url&&void 0===o.collectionid){e.next=35;break}if(!o.manifest){e.next=18;break}return e.next=11,et(o.manifest);case 11:f=e.sent,m=f.scenes,p=f.metadata,s=m,a.metadata=null!=p?p:void 0,e.next=24;break;case 18:d=o.collectionid,v=o.msgorigin,y=void 0!==d&&void 0===v?(0,L.ND)(d):void 0,h=null!=y?y:Ie(t,"url"),s=Te(h),a.metadata=(0,L.HW)(s);case 24:b=s[0],g=Array.isArray(b)?b[0]:b,w=s.length>1||b.length>1?{scenes:s}:b[0],a.cellId="1",a.imageUrl=w,a.imageDownloadHref=g,a.parentImageUrl="",a.parentImageDownloadHref="",g.endsWith("json")||a.viewerChannelSettings||(a.viewerChannelSettings={groups:[{name:"Channels",channels:[{match:[0,1,2],enabled:!0},{match:"(.+)",enabled:!1}]}]}),e.next=40;break;case 35:if(!(o.dataset&&o.id&&n)){e.next=40;break}return e.next=38,Ke(n,o.dataset,o.id);case 38:S=e.sent,a=Q(Q({},a),S);case 40:return e.abrupt("return",{args:i(a),viewerSettings:i(l)});case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ot(e,t){var n,r=e.imageUrl,o=null!==(n=t.scenes)&&void 0!==n?n:"string"==typeof r?[r]:r.scenes,a=o[0],i=1===o.length&&"string"==typeof a?a:{scenes:o},l=t.meta,c=l&&o.map((function(e){if(!Array.isArray(e))return l[e]})),u=null!=c?c:e.metadata;return Q(Q({},e),{},void 0===u?{imageUrl:i}:{imageUrl:i,metadata:u})}function at(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],c=function(e,t){var n,r,c,u,s,f,m;t&&(e=l(e,(0,o.$m)()));var p=(oe(oe(oe(oe(oe(oe(oe(oe(oe(oe(m={},we.Mode,e.renderMode),we.Mask,null===(n=e.maskAlpha)||void 0===n?void 0:n.toString()),we.Image,e.imageType),we.Axes,We(e.showAxes)),we.BoundingBox,We(e.showBoundingBox)),we.BoundingBoxColor,e.boundingBoxColor&&Ve(e.boundingBoxColor)),we.BackgroundColor,e.backgroundColor&&Ve(e.backgroundColor)),we.Autorotate,We(e.autorotate)),we.Brightness,null===(r=e.brightness)||void 0===r?void 0:r.toString()),we.Density,null===(c=e.density)||void 0===c?void 0:c.toString()),oe(oe(oe(oe(oe(oe(oe(m,we.Interpolation,We(e.interpolationEnabled)),we.Region,e.region&&$e(e.region).map((function(e){return e.map((function(e){return _e(e)})).join(":")})).join(",")),we.Slice,e.slice&&$e(e.slice).map((function(e){return _e(e)})).join(",")),we.Levels,null===(u=e.levels)||void 0===u?void 0:u.join(",")),we.Time,null===(s=e.time)||void 0===s?void 0:s.toString()),we.Scene,null===(f=e.scene)||void 0===f?void 0:f.toString()),we.CameraState,e.cameraState&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.nE.threeD;if(!t||(e=l(e,(0,o.kP)(n)),0!==Object.keys(e).length)){var r=De(oe(oe(oe(oe(oe({},Se.Position,e.position&&e.position.map((function(e){return _e(e)})).join(":")),Se.Target,e.target&&e.target.map((function(e){return _e(e)})).join(":")),Se.Up,e.up&&e.up.map((function(e){return _e(e)})).join(":")),Se.OrthoScale,void 0===e.orthoScale?void 0:_e(e.orthoScale)),Se.Fov,void 0===e.fov?void 0:_e(e.fov)));return""===r?void 0:r}}(e.cameraState,t,e.viewMode))),d=oe(oe(oe(oe({},a.nE.threeD,"3D"),a.nE.xy,"Z"),a.nE.xz,"Y"),a.nE.yz,"X");return p[we.View]=e.viewMode&&d[e.viewMode],i(p)}(e,n),u=null===(t=e.channelSettings)||void 0===t?void 0:t.reduce((function(e,t,a){return e["c".concat(a)]=De(function(e,t){var n,a,c,u,s;return t&&(e=l(e,(0,o.g1)())),i((oe(oe(oe(oe(oe(oe(oe(oe(oe(oe(s={},Ee.VolumeEnabled,We(e.volumeEnabled)),Ee.SurfaceEnabled,We(e.isosurfaceEnabled)),Ee.IsosurfaceValue,null===(n=e.isovalue)||void 0===n?void 0:n.toString()),Ee.IsosurfaceAlpha,null===(a=e.opacity)||void 0===a?void 0:a.toString()),Ee.Colorize,We(e.colorizeEnabled)),Ee.ColorizeAlpha,null===(c=e.colorizeAlpha)||void 0===c?void 0:c.toString()),Ee.Color,e.color&&Ve(e.color)),Ee.ControlPoints,e.controlPoints&&e.controlPoints.map((function(e){var t=_e(e.x),n=_e(e.opacity),o=(0,r.isEqual)(e.color,ce)?"1":Ve(e.color);return"".concat(t,":").concat(n,":").concat(o)})).join(":")),Ee.ControlPointsEnabled,We(e.useControlPoints)),Ee.Ramp,null===(u=e.ramp)||void 0===u?void 0:u.join(":")),oe(s,Ee.KeepRange,We(e.keepIntensityRange))))}(t,n)),e}),{});return Q(Q({},c),u)}},6373(e,t,n){"use strict";n.d(t,{Mn:()=>s,oj:()=>u,zK:()=>f});var r=n(4270);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,a=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){if("number"==typeof n.match){if(n.match===t)return!0}else if(Array.isArray(n.match)){var r,o=a(n.match);try{for(o.s();!(r=o.n()).done;){var i=r.value;if("number"==typeof i){if(i===t)return!0}else if(new RegExp(i).test(e))return!0}}catch(e){o.e(e)}finally{o.f()}}else{if("string"!=typeof n.match)throw new Error("match is required for channel settings groups, and must be a string, number, or array of strings or numbers");if(new RegExp(n.match).test(e))return!0}return!1}function c(e,t,n){var r,o=a(n.channels);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(l(e,t,i))return i}}catch(e){o.e(e)}finally{o.f()}}function u(e,t,n){if(n.groups){var r,o=a(n.groups);try{for(o.s();!(r=o.n()).done;){var i=c(e,t,r.value);if(void 0!==i)return i}}catch(e){o.e(e)}finally{o.f()}}}function s(e,t,n){if(n){var r=u(e,t,n);if(r)return r.name||e}return e}function f(e,t){if(!e)return{};if(!t)return n={},i=r.n1,c=e.map((function(e,t){return t})),(i=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(i))in n?Object.defineProperty(n,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[i]=c,n;var n,i,c,u=t.groups,s={},f=[];if(void 0!==u){var m,p=a(u);try{var d=function(){var t=m.value;s[t.name]=[],t.channels.forEach((function(n){e.forEach((function(e,r){f.includes(r)||l(e,r,n)&&(s[t.name].push(r),f.push(r))}))}))};for(p.s();!(m=p.n()).done;)d()}catch(e){p.e(e)}finally{p.f()}}if(f.length<e.length){var v=0===u.length?r.n1:r.jR;s[v]=[],e.forEach((function(e,t){f.includes(t)||s[v].push(t)}))}return s}},2890(e,t,n){"use strict";n.d(t,{S8:()=>a,uO:()=>i});var r=n(4270),o=n(6373);function a(e){for(var t=[],n=0;n<e.length;n++)(e[n].volumeEnabled||e[n].isosurfaceEnabled)&&t.push(n);return t}function i(e,t,n,a){var i,l,c,u,s,f,m,p,d,v,y,h,b,g,w,S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,r.g1)(),E={};return a&&(E=null!==(b=(0,o.oj)(e,t,a))&&void 0!==b?b:{}),{name:null!=e?e:"Channel "+t,displayName:(0,o.Mn)(null!=e?e:"Channel "+t,t,a),volumeEnabled:null!==(i=E.enabled)&&void 0!==i?i:S.volumeEnabled,isosurfaceEnabled:null!==(l=E.surfaceEnabled)&&void 0!==l?l:S.isosurfaceEnabled,colorizeEnabled:null!==(c=E.colorizeEnabled)&&void 0!==c?c:S.colorizeEnabled,colorizeAlpha:null!==(u=E.colorizeAlpha)&&void 0!==u?u:S.colorizeAlpha,isovalue:null!==(s=E.isovalue)&&void 0!==s?s:S.isovalue,opacity:null!==(f=E.surfaceOpacity)&&void 0!==f?f:S.opacity,color:null!==(g=null!==(p=E.color)&&void 0!==p?p:"",w=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(g),m=w?[parseInt(w[1],16),parseInt(w[2],16),parseInt(w[3],16)]:null)&&void 0!==m?m:n,useControlPoints:null!==(d=E.controlPointsEnabled)&&void 0!==d?d:S.useControlPoints,keepIntensityRange:null!==(v=E.keepIntensityRange)&&void 0!==v?v:S.keepIntensityRange,controlPoints:null!==(y=E.controlPoints)&&void 0!==y?y:S.controlPoints,ramp:null!==(h=E.ramp)&&void 0!==h?h:S.ramp,plotMin:S.plotMin,plotMax:S.plotMax}}},9475(e,t,n){"use strict";n.d(t,{Lt:()=>k,ss:()=>P,Tk:()=>A});var r=n(1511),o=n(7134),a=n(4270),i=n(4381),l=n(2890);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e){if("object"!=f(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==f(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var m=function(e){return"object"===f(e)&&null!==e&&!Array.isArray(e)},p={viewMode:function(e,t){var n=t.renderMode;return{viewMode:e,renderMode:e!==i.nE.threeD&&n===i.G9.pathTrace?i.G9.volumetric:n}},renderMode:function(e,t){var n=t.viewMode,r=t.autorotate,o=e===i.G9.pathTrace;return o&&n!==i.nE.threeD?{}:{renderMode:e,autorotate:r&&!o}},autorotate:function(e,t){var n=t.renderMode;return{autorotate:e&&n!==i.G9.pathTrace}}},d=function(e,t,n){var r=p[t];if(r)return r(n,e);var o=e[t];return s({},t,m(o)&&m(n)?u(u({},o),n):n)},v=function(e,t){for(var n={},r=0,o=Object.keys(t);r<o.length;r++){var a=o[r];Object.assign(n,d(e,a,t[a]))}return n};function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e,t,n){var r,o=e.channelSettings,a=e.viewMode,c=e.time,u=e.slice,s=e.scene,f=a!==t.viewMode&&(a===i.nE.xy||t.viewMode===i.nE.xy),m=c!==t.time,p=t.viewMode===i.nE.xy&&!(t.slice.z===u.z),d=t.scene!==s,y=f||m||p||d,b=v(e,t),w=n.map((function(e,t){return g(g({},e),{},{name:o[t].name,displayName:o[t].displayName,controlPoints:o[t].controlPoints,ramp:o[t].ramp,plotMin:o[t].plotMin,plotMax:o[t].plotMax})})),S=function(e){if(Array.isArray(e))return h(e)}(r=Array(n.length).keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),E=[];return y&&(E=(0,l.S8)(n),S=S.filter((function(e){return!E.includes(e)}))),g(g({},b),{},{channelSettings:w,channelsToReset:S,channelsToResetOnLoad:E})},E=function(e){return{channelsToReset:[],channelsToResetOnLoad:[],savedViewerChannelSettings:void 0,useDefaultViewerChannelSettings:!1,onResetChannel:function(t){e((function(e){var n=e.channelsToReset,r=e.channelsToResetOnLoad;return{channelsToReset:n.filter((function(e){return e!==t})),channelsToResetOnLoad:r.filter((function(e){return e!==t}))}}))},resetToSavedViewerState:function(t,n){e((function(e){var r,o=e.channelSettings,c=g(g({},(0,a.$m)()),{},{cameraState:(0,a.kP)(null!==(r=null==t?void 0:t.viewMode)&&void 0!==r?r:i.nE.threeD)},t),u=o.map((function(e,t){return(0,l.uO)(o[t].name,t,(0,a.iz)(t),n)}));return g(g({},S(e,c,u)),{},{useDefaultViewerChannelSettings:!1})}))},resetToDefaultViewerState:function(){e((function(e){var t=e.channelSettings,n=g(g({},(0,a.$m)()),{},{cameraState:(0,a.kP)(i.nE.threeD)}),r=t.map((function(e,t){var n=(0,a.g1)(t);return n.volumeEnabled=t<3,n}));return g(g({},S(e,n,r)),{},{useDefaultViewerChannelSettings:!0})}))}}};function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return(t=function(e){var t=function(e){if("object"!=O(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==O(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=(0,r.v)()((0,o.eh)((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return C(C(C({},E.apply(void 0,[e].concat(n))),(0,a.$m)()),{},{channelSettings:[],changeViewerSetting:function(t,n){return e((function(e){return d(e,t,n)}))},mergeViewerSettings:function(t){return e((function(e){return v(e,t)}))},changeChannelSetting:function(t,n){e((function(e){return{channelSettings:e.channelSettings.map((function(e,r){return(Array.isArray(t)?t.includes(r):t===r)?C(C({},e),n):e}))}}))},replaceAllChannelSettings:function(t){return e({channelSettings:t})},applyColorPresets:function(t){e((function(e){return{channelSettings:e.channelSettings.map((function(e,n){return C(C({},e),{},{color:t[n%t.length]})}))}}))}})}))),P=function(e){return{viewMode:e.viewMode,renderMode:e.renderMode,imageType:e.imageType,showAxes:e.showAxes,showBoundingBox:e.showBoundingBox,boundingBoxColor:e.boundingBoxColor,backgroundColor:e.backgroundColor,autorotate:e.autorotate,maskAlpha:e.maskAlpha,brightness:e.brightness,density:e.density,levels:e.levels,interpolationEnabled:e.interpolationEnabled,region:e.region,slice:e.slice,time:e.time,scene:e.scene,cameraState:e.cameraState}},k=function(e){return function(t){return t[e]}}},3473(e,t,n){"use strict";n.d(t,{N$:()=>wr,nE:()=>c.nE,Zv:()=>Sr.Zv,bT:()=>Sr.bT,f5:()=>Er.f5,hm:()=>Er.hm});var r=n(2515),o=n(3067),a=n(2543),i=n(6540),l=n(4270),c=n(4381),u=n(6373);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=e.charAt(0);if("m"===n){var r=parseFloat(e.substring(1))/100;return t.maxBin*r}if("p"===n){var o=parseFloat(e.substring(1))/100;return t.findBinOfPercentile(o)}if("v"===n){var a=parseFloat(e.substring(1));return t.findFractionalBinOfValue(a)}return parseFloat(e)}function b(e,t,n){var o,a,i,c,s,f=e.getHistogram(t),p=function(e){var t=e.findBinOfPercentile(l.BO),n=e.findBinOfPercentile(l.xB);return(new r.Sd).createFromMinMax(t,n)}(f),v=[],y=[],b=p,g=e.channelNames[t],S=n&&(0,u.oj)(g,t,n);return S&&(b=null!==(i=function(e,t){var n,o,a,i=null!==(n=null===(o=t.intensity)||void 0===o?void 0:o.lut)&&void 0!==n?n:t.lut;if(void 0!==i&&2===i.length&&(a="autoij"===i[0]||"autoij"===i[1]?e.findAutoIJBins():[h(i[0],e),h(i[1],e)],Number.isFinite(a[0])&&Number.isFinite(a[1]))){var c=[Math.min(a[0],a[1]),Math.max(a[0],a[1])],u=[{x:c[0],opacity:0,color:l.YT},{x:c[1],opacity:1,color:l.YT}];return(new r.Sd).createFromControlPoints(u)}}(f,S))&&void 0!==i?i:p),y=null!=S&&null!==(o=S.intensity)&&void 0!==o&&o.controlPoints?S.intensity.controlPoints:(null!==(c=null==S?void 0:S.controlPoints)&&void 0!==c?c:d(b.controlPoints)).map((function(e){return m(m({},e),{},{x:f.getValueFromBinIndex(e.x)})})),v=null!=S&&null!==(a=S.intensity)&&void 0!==a&&a.ramp?w(S.intensity.ramp):(null!=S&&S.ramp?w(S.ramp):d(b.controlPoints)).map((function(e){return m(m({},e),{},{x:f.getValueFromBinIndex(e.x)})})),s=null!=S&&S.controlPointsEnabled?(new r.Sd).createFromControlPoints(y):(new r.Sd).createFromControlPoints(v),e.setLut(t,s),{ramp:v,controlPoints:y}}function g(e){if(e.length<=1)return[0,l.Lr];if(2===e.length)return[e[0].x,e[1].x];if(3===e.length){if(e[0].opacity!==e[1].opacity&&e[0].opacity!==e[2].opacity&&e[1].opacity!==e[2].opacity)return[e[0].x,e[2].x];if(e[0].opacity!==e[1].opacity)return[e[0].x,e[1].x];if(e[1].opacity!==e[2].opacity)return[e[1].x,e[2].x]}return[e[1].x,e[e.length-2].x]}function w(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||v(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1];return[{x:Math.min(o-1,0),opacity:0,color:l.YT},{x:o,opacity:0,color:l.YT},{x:a,opacity:1,color:l.YT},{x:Math.max(a+1,l.Lr),opacity:1,color:l.YT}]}var S=n(4097),E=n(9475),O=n(466);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function C(e,t,n){return(t=function(e){var t=function(e){if("object"!=x(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==x(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=C(C(C(C({},c.nE.yz,"x"),c.nE.xz,"y"),c.nE.xy,"z"),c.nE.threeD,null),A=function(e){return[e.r,e.g,e.b]},P=function(e){return{r:e[0],g:e[1],b:e[2]}},k=function(e){return[e[0]/255,e[1]/255,e[2]/255]},I=function(e){return"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")")};function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var T={fireImmediately:!0},N={fireImmediately:!0,equalityFn:O.x},D=function(e){return function(t){var n=t.region,r=t.slice,o=t.viewMode;return{region:n[e],slice:r[e],viewMode:o}}},L=function(e,t,n){var o=function(e){return function(r){var o,a,i=(o=r.region,a=2,function(e){if(Array.isArray(e))return e}(o)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(o,a)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(o,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=i[0],u=i[1],s=r.slice,f=r.viewMode,m=0,p=1;f===c.nE.threeD?(m=l,p=u):(j[f]===e?(m=s,p=s+1/n.imageInfo.volumeSize[e]):(m=0,p=1),"z"===e&&f===c.nE.xy&&t.setZSlice(n,Math.floor(s*n.imageInfo.volumeSize.z))),t.setAxisClip(n,e,m-.5,p-.5,!1)}},a=[e.subscribe((0,E.Lt)("showBoundingBox"),(function(e){return t.setShowBoundingBox(n,e)}),T),e.subscribe((0,E.Lt)("boundingBoxColor"),(function(e){return t.setBoundingBoxColor(n,k(e))}),T),e.subscribe((0,E.Lt)("renderMode"),(function(e){t.setMaxProjectMode(n,e===c.G9.maxProject),t.setVolumeRenderMode(e===c.G9.pathTrace?r.Nc:r.CS),t.updateActiveChannels(n)}),T),e.subscribe((0,E.Lt)("maskAlpha"),(function(e){t.updateMaskAlpha(n,1-e/100),t.updateActiveChannels(n)}),T),e.subscribe((0,E.Lt)("density"),(function(e){return t.updateDensity(n,e/100)}),T),e.subscribe((0,E.Lt)("levels"),(function(e){var r=function(e){var t=Number(e[0]),n=Number(e[1]),r=Number(e[2]);(n>r||n<t)&&(n=.5*(t+r));var o=((n/=255)-(t/=255))/((r/=255)-t),a=4*o*o;return(n-.5)*(n-.5)<5e-4&&(a=1),{min:t,max:r,scale:a}}(e),o=r.min,a=r.max,i=r.scale;t.setGamma(n,o,a,i)}),T),e.subscribe((0,E.Lt)("interpolationEnabled"),(function(e){return t.setInterpolationEnabled(n,e)}),T),e.subscribe(D("x"),o("x"),N),e.subscribe(D("y"),o("y"),N),e.subscribe(D("z"),o("z"),N)];return function(){return a.forEach((function(e){return e()}))}},R=n(4922);function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,V(r.key),r)}}function F(e,t,n){return(t=V(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V(e){var t=function(e){if("object"!=B(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==B(t)?t:t+""}var U=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),F(this,"playingAxis",null),F(this,"playWaitingForLoad",!1),F(this,"playHolding",!1),F(this,"playTimeoutId",0)},t=[{key:"setPlayingAxis",value:function(e){var t;this.playingAxis=e,null===(t=this.onPlayingAxisChanged)||void 0===t||t.call(this,e)}},{key:"playStep",value:function(){var e;this.playingAxis&&!this.playHolding&&this.stepAxis&&(null!==(e=this.getVolumeIsLoaded)&&void 0!==e&&e.call(this)?(this.stepAxis(this.playingAxis),this.playTimeoutId=window.setTimeout(this.playStep.bind(this),125)):this.playWaitingForLoad=!0)}},{key:"onImageLoaded",value:function(){this.playWaitingForLoad&&(this.playWaitingForLoad=!1,this.playStep())}},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];window.clearTimeout(this.playTimeoutId),this.playTimeoutId=0,this.playWaitingForLoad=!1,null===this.playingAxis||e||(this.playHolding=!1,this.setPlayingAxis(null))}},{key:"play",value:function(e){null!==this.playingAxis&&this.pause(!0),this.setPlayingAxis(e),this.playStep()}},{key:"startHold",value:function(e){this.playHolding=!0,this.pause(e===this.playingAxis)}},{key:"endHold",value:function(){this.playHolding&&(this.playHolding=!1,this.playStep())}}],t&&z(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function H(){var e=Y(),t=e.m(H),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,G(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(H=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new X(e,t)},AsyncIterator:Z,async:function(e,t,n,o,i){return(r(t)?W:$)(a(e),t,n,o,i)},keys:_,values:G}})()}function G(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(q(e)+" is not iterable")}function _(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function $(e,t,n,r,o){var a=W(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function W(e,t,n,r,o){return new Z(Y().w(e,t,n,r),o||Promise)}function Z(e,t){function n(r,o,a,i){try{var l=e[r](o),c=l.value;return c instanceof X?t.resolve(c.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(c).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(Q(Z.prototype),Q(Z.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Q(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function Y(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return Q(u,"_invoke",function(n,r,o){var a,l,c,u=0,s=o||[],f=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,l=0,c=e,m.n=n,i}};function p(n,r){for(l=n,c=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,a=s[t],p=m.p,d=a[2];n>3?(o=d===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,m.v=r,m.n=a[1]):p<d&&(o=n<3||a[0]>r||r>d)&&(a[4]=n,a[5]=r,m.n=d,l=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!f;){a||(l?l<3?(l>1&&(m.n=-1),p(l,c)):m.n=c:m.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(f=m.n<0)?c:n.call(r,m))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(Q(t={},r,(function(){return this})),t),f=u.prototype=l.prototype=Object.create(s);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,Q(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,Q(f,"constructor",u),Q(u,"constructor",c),c.displayName="GeneratorFunction",Q(u,o,"GeneratorFunction"),Q(f),Q(f,o,"Generator"),Q(f,r,(function(){return this})),Q(f,"toString",(function(){return"[object Generator]"})),(Y=function(){return{w:a,m}})()}function Q(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Q=function(e,t,n,r){function a(t,n){Q(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Q(e,t,n,r)}function X(e,t){this.v=e,this.k=t}function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function K(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function J(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){K(a,r,o,i,l,"next",e)}function l(e){K(a,r,o,i,l,"throw",e)}i(void 0)}))}}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ne(r.key),r)}}function te(e,t,n){return(t=ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e){var t=function(e){if("object"!=q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==q(t)?t:t+""}var re=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),te(this,"currentScene",0),te(this,"syncChannels",!1),te(this,"prefetchPriority",[]),this.paths=n,this.context=t,this.loaders=new Array(n.length).fill(void 0)},t=[{key:"getLoader",value:(a=J(H().mark((function e(t){var n,o,a;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentScene=t,n=this.loaders[t]){e.next=12;break}return o=this.paths[t],a={},"object"!==q(o)||Array.isArray(o)||(a.rawArrayOptions=o,a.fileType=r.Ai.DATA,o=""),e.next=8,this.context.onOpen();case 8:return e.next=10,this.context.createLoader(o,a);case 10:n=e.sent,this.loaders[t]=n;case 12:return n.syncMultichannelLoading(this.syncChannels),n.setPrefetchPriority(this.prefetchPriority),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadScene",value:(o=J(H().mark((function e(t,n,r,o){var a,i,l;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLoader(t);case 2:return i=e.sent,l=null!=r?r:n.loadSpecRequired,n.loader=i,e.next=7,i.createImageInfo(l);case 7:n.imageInfo.imageInfo=e.sent.imageInfo,null==o||null===(a=o.onCreateScene)||void 0===a||a.call(o,n,t),i.loadVolumeData(n,l,null==o?void 0:o.onChannelLoaded);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"createVolume",value:(n=J(H().mark((function e(t,n,r){var o;return H().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLoader(t);case 2:return o=e.sent,e.abrupt("return",o.createVolume(n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"syncMultichannelLoading",value:function(e){this.syncChannels=e;var t=this.loaders[this.currentScene];t&&t.syncMultichannelLoading(e)}},{key:"setPrefetchPriority",value:function(e){this.prefetchPriority=e;var t=this.loaders[this.currentScene];t&&t.setPrefetchPriority(e)}}],t&&ee(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o,a}(),oe=n(2890);function ae(e){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae(e)}function ie(){var e=me(),t=e.m(ie),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,le(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ie=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new de(e,t)},AsyncIterator:fe,async:function(e,t,n,o,i){return(r(t)?se:ue)(a(e),t,n,o,i)},keys:ce,values:le}})()}function le(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ae(e)+" is not iterable")}function ce(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function ue(e,t,n,r,o){var a=se(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function se(e,t,n,r,o){return new fe(me().w(e,t,n,r),o||Promise)}function fe(e,t){function n(r,o,a,i){try{var l=e[r](o),c=l.value;return c instanceof de?t.resolve(c.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(c).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(pe(fe.prototype),pe(fe.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),pe(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function me(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return pe(u,"_invoke",function(n,r,o){var a,l,c,u=0,s=o||[],f=!1,m={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,l=0,c=e,m.n=n,i}};function p(n,r){for(l=n,c=r,t=0;!f&&u&&!o&&t<s.length;t++){var o,a=s[t],p=m.p,d=a[2];n>3?(o=d===r)&&(c=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,m.v=r,m.n=a[1]):p<d&&(o=n<3||a[0]>r||r>d)&&(a[4]=n,a[5]=r,m.n=d,l=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,d){if(u>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,d),l=s,c=d;(t=l<2?e:c)||!f;){a||(l?l<3?(l>1&&(m.n=-1),p(l,c)):m.n=c:m.v=c);try{if(u=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(f=m.n<0)?c:n.call(r,m))!==i)break}catch(t){a=e,l=1,c=t}finally{u=1}}return{value:t,done:f}}}(n,o,a),!0),u}var i={};function l(){}function c(){}function u(){}t=Object.getPrototypeOf;var s=[][r]?t(t([][r]())):(pe(t={},r,(function(){return this})),t),f=u.prototype=l.prototype=Object.create(s);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,pe(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=u,pe(f,"constructor",u),pe(u,"constructor",c),c.displayName="GeneratorFunction",pe(u,o,"GeneratorFunction"),pe(f),pe(f,o,"Generator"),pe(f,r,(function(){return this})),pe(f,"toString",(function(){return"[object Generator]"})),(me=function(){return{w:a,m}})()}function pe(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}pe=function(e,t,n,r){function a(t,n){pe(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},pe(e,t,n,r)}function de(e,t){this.v=e,this.k=t}function ve(e,t,n,r,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t,n){return(t=function(e){var t=function(e){if("object"!=ae(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ae(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return we(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Se=function(e){return e[e.REQUESTED=0]="REQUESTED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR",e}({}),Ee=function(e){return e[e.TIME=0]="TIME",e[e.SCENE=1]="SCENE",e}(Ee||{}),Oe=function(e){var t=(0,i.useRef)(e);return(0,i.useEffect)((function(){t.current=e}),[e]),t};var xe=n(3567),Ce=n(1600),je=n(2153),Ae=n(6795),Pe=n(1917),ke=n(5144),Ie=n(4297);function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Te(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Te(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Ne=function(e){var t=e.value,n=e.step,r=void 0===n?1:n,o=e.precision,a=void 0===o?r:o,l=e.min,c=void 0===l?0:l,u=e.max,s=void 0===u?Number.MAX_SAFE_INTEGER:u,f=e.disabled,m=void 0!==f&&f,p=e.className,d=void 0===p?"":p,v=e.onChange,y=Me(i.useState(!1),2),h=y[0],b=y[1],g=Me((0,S.G)(b,h),2),w=g[0],E=g[1],O=Me(i.useState(""),2),x=O[0],C=O[1],j=i.useRef(null),A=function(e){return Math.min(Math.max(e,c),s)},P=function(e){return A(Math.round(e/a)*a)},k=function(e){return!(isNaN(e)||e===t||m)},I=P(t),M=function(e){var t,n=A(I+(e?r:-r));k(n)&&(v(n),C(n.toString()),E(!0)),null===(t=j.current)||void 0===t||t.focus()},T="numinput"+(m?" numinput-disabled":"")+(d&&" ".concat(d));return i.createElement("div",{className:T,onKeyDown:function(e){var t=e.key;if(["Up","ArrowUp","Down","ArrowDown"].includes(t))M("Up"===t||"ArrowUp"===t),e.preventDefault();else if("Enter"===t){var n;null===(n=j.current)||void 0===n||n.blur()}}},i.createElement("input",{value:h?x:I,step:r,min:c,max:s,disabled:m,className:"numinput-input",autoComplete:"off",role:"spinbutton","aria-valuenow":I,"aria-valuemin":c,"aria-valuemax":s,ref:j,onChange:function(e){return function(e){C(e);var t=""===e?0:parseFloat(e),n=P(t);k(n)&&v(n)}(e.target.value)},onFocus:function(){w.current||(C(I.toString()),E(!0))},onBlur:function(){return E(!1)}}),i.createElement("div",{className:"numinput-controls"},i.createElement("div",{className:"numinput-controls-button numinput-controls-button-up",role:"button","aria-label":"Increase Value","aria-disabled":m,onClick:function(){return M(!0)}},i.createElement(ke.A,{className:"numinput-controls-button-icon"})),i.createElement("div",{className:"numinput-controls-button numinput-controls-button-down",role:"button","aria-label":"Decrease Value","aria-disabled":m,onClick:function(){return M(!1)}},i.createElement(Ie.A,{className:"numinput-controls-button-icon"}))))};var De=n(7057),Le=n.n(De);function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return(t=function(e){var t=function(e){if("object"!=Re(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Re(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ue=i.memo(Le(),(function(e,t){return t.noUpdate}));const He=function(e){var t,n,r=(t=i.useState(!1),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],a=r[1],l=function(e,t){return function(){a(e),t&&t.apply(void 0,arguments)}},c=l(!0,e.onStart),u=l(!1,e.onEnd);return i.createElement(Ue,ze(ze({},e),{},{noUpdate:o,onStart:c,onEnd:u}))};function Ge(e){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ge(e)}function _e(e,t,n){return(t=function(e){var t=function(e){if("object"!=Ge(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ge(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return We(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ze=["x","y","z"],Ye=function(e){var t=e.label,n=e.vals,r=e.valsReadout,o=void 0===r?n:r,a=e.max,l=e.onSlide,c=e.onChange,u=void 0===c?l:c,s=e.onStart,f=e.onEnd,m=n.length>1,p=m?0:1,d=m?l:function(e){return null==l?void 0:l([e[0]-1])},v=m?u:function(e){return null==u?void 0:u([e[0]-1])};return i.createElement("span",{className:"axis-slider-container"},i.createElement("span",{className:"slider-name"},t),a<=p?i.createElement("i",null,"No values to adjust"):i.createElement("span",{className:"axis-slider"},i.createElement(He,{className:m?"":"slider-single-handle",connect:!0,range:{min:p,max:a},start:m?n:[n[0]+1],step:1,margin:1,behaviour:"drag",pips:{mode:"positions",values:[25,50,75],density:25,format:{to:function(){return""}}},format:{to:Math.round,from:parseInt},onSlide:d,onChange:v,onStart:s,onEnd:f})),a>p&&i.createElement("span",{className:"slider-values"},i.createElement(Ne,{min:p,max:a,value:o[0]+(m?0:1),onChange:function(e){return null==u?void 0:u(m?[e,n[1]]:[e-1])}}),m&&i.createElement(i.Fragment,null," , ",i.createElement(Ne,{min:p,max:a,value:o[1],onChange:function(e){return null==u?void 0:u([n[0],e])}}))," / ",a))},Qe=function(e){var t=e.onChange,n=e.onStart,r=e.onEnd,o=$e((0,i.useState)(e.val),2),a=o[0],l=o[1],c=$e((0,i.useState)(!1),2),u=c[0],s=c[1],f=(0,i.useCallback)((function(e){var n=$e(e,1)[0];return null==t?void 0:t(n)}),[t]),m=(0,i.useCallback)((function(e){var t=$e(e,1)[0];return l(t)}),[]),p=(0,i.useCallback)((function(){l(e.val),s(!0),null==n||n()}),[n,e.val]),d=(0,i.useCallback)((function(){s(!1),null==r||r()}),[r]);return i.createElement(i.Fragment,null,i.createElement(Ye,{label:e.label,vals:[e.val],valsReadout:e.updateWhileSliding||!u?void 0:[a],max:e.max,onSlide:e.updateWhileSliding?f:m,onChange:e.updateWhileSliding?void 0:f,onStart:p,onEnd:d}),e.max>1&&i.createElement(Ae.A,{placement:"top",title:"Play through sequence",trigger:["hover","focus"]},i.createElement(Pe.Ay,{className:"slider-play-button",onClick:function(){return e.onTogglePlayback(!e.playing)},icon:e.playing?i.createElement(Ce.A,null):i.createElement(je.A,null),"aria-label":(e.playing?"Pause ":"Play ")+e.label})))};const Xe=function(e){var t=j[e.mode],n=function(t){e.playControls.playHolding&&e.playingAxis===t||e.playControls.pause()};(0,i.useEffect)((function(){return e.playControls.pause()}),[e.mode,e.image,e.playControls]);var r,o,a,l=function(t,n){n?e.playControls.play(t):e.playControls.pause()};return i.createElement("div",{className:t?"clip-sliders clip-sliders-2d":"clip-sliders"},i.createElement("span",{className:"slider-group"},i.createElement("h4",{className:"slider-group-title"},"ROI"),i.createElement("span",{className:"slider-group-rows"},t?(r=t,o=e.numSlices[r],a=e.numSlicesLoaded[r],i.createElement("div",{key:r+o+a,className:"slider-row slider-".concat(r)},i.createElement(Qe,{label:r.toUpperCase(),val:Math.round(e.slices[r]*o),max:o,onChange:function(t){return function(t,r){n(t),e.changeViewerSetting("slice",_e({},t,r/e.numSlices[t]))}(r,t)},onStart:function(){return e.playControls.startHold(r)},onEnd:function(){return e.playControls.endHold()},playing:e.playingAxis===r,onTogglePlayback:function(e){return l(r,e)},updateWhileSliding:o===a}))):Ze.map((function(t){var r=e.numSlices[t];if(1===r)return null;var o=e.region[t];return i.createElement("div",{key:t+r+"3d",className:"slider-row slider-".concat(t)},i.createElement(Ye,{label:t.toUpperCase(),vals:[Math.round(o[0]*r),Math.round(o[1]*r)],max:r,onSlide:function(r){return function(t,r,o){n(t);var a=e.changeViewerSetting,i=e.numSlices[t];a("region",_e({},t,[r/i,o/i]))}(t,r[0],r[1])},onStart:function(){return e.playControls.startHold(t)},onEnd:function(){return e.playControls.endHold()}}))})))),e.numTimesteps>1&&i.createElement("span",{className:"slider-group"},i.createElement("h4",{className:"slider-group-title"},"Time"),i.createElement("span",{className:"slider-group-rows"},i.createElement("div",{className:"slider-row slider-t"},i.createElement(Qe,{label:"",val:e.time,max:e.numTimesteps,playing:"t"===e.playingAxis,onTogglePlayback:function(e){return l("t",e)},onChange:function(t){return function(t){n("t"),e.changeViewerSetting("time",t)}(t)},onStart:function(){return e.playControls.startHold("t")},onEnd:function(){return e.playControls.endHold()}})))),e.numScenes>1&&i.createElement("span",{className:"slider-group"},i.createElement("h4",{className:"slider-group-title"},"Scene"),i.createElement("span",{className:"slider-group-rows"},i.createElement("div",{className:"slider-row slider-scene"},i.createElement(Ye,{label:"",vals:[e.scene],max:e.numScenes,onChange:function(t){var n=$e(t,1)[0];return e.changeViewerSetting("scene",n)}})))))};var qe=n(6143),Ke=n(6933);function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Je.apply(null,arguments)}function et(){return et=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},et.apply(null,arguments)}function tt(){return tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tt.apply(null,arguments)}function nt(){return nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nt.apply(null,arguments)}function rt(){return rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rt.apply(null,arguments)}function ot(){return ot=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ot.apply(null,arguments)}function at(){return at=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},at.apply(null,arguments)}function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},it.apply(null,arguments)}function lt(){return lt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lt.apply(null,arguments)}function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ct.apply(null,arguments)}function ut(){return ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ut.apply(null,arguments)}const st={axes:function(e){return i.createElement("svg",Je({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("circle",{cx:6.26,cy:12.84,r:1,fill:"currentColor"}),i.createElement("path",{fill:"currentColor",d:"m14.27 15.23.7-1.64H8.11c.09-.23.15-.48.15-.75s-.06-.52-.15-.75h6.86l-.7-1.64 5.66 2.39zM6.26.03 3.87 5.69 5.51 5v5.99q.345-.15.75-.15c.405 0 .52.05.75.15V5l1.64.69zM5.59 17.23.07 19.91 2 14.08l.77 1.6 1.61-1.83s.08-.06.11-.09c.23.44.62.78 1.09.95-.02.04-.04.09-.07.12L3.9 16.67z"}))},boundingBox:function(e){return i.createElement("svg",et({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M13.28 10.25a.38.38 0 1 0 .76 0V9a.38.38 0 1 0-.76 0zm-2.5 3.42a.38.38 0 0 0-.38-.38H9.15a.38.38 0 1 0 0 .76h1.25c.21 0 .38-.17.38-.38m3.93.52-.68-.67v-1.26a.38.38 0 1 0-.76 0v1.05h-.88a.38.38 0 1 0 0 .76h1.1l.68.67c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53Zm2.31 2.29-.89-.88a.377.377 0 0 0-.53 0c-.15.15-.15.38 0 .53l.89.88c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53M4.29 13.67a.38.38 0 0 0-.38-.38H2.66a.38.38 0 1 0 0 .76h1.25c.21 0 .38-.17.38-.38m8.98-9.92a.38.38 0 1 0 .76 0V2.5a.38.38 0 1 0-.76 0zm.75 2a.38.38 0 1 0-.76 0v.08h.75v-.08Zm-.38 1.62c.21 0 .38-.17.38-.38v-.17h-.75v.17c0 .21.17.38.38.38Zm0-3.25c.21 0 .38-.17.38-.38V2.49a.38.38 0 1 0-.76 0v1.25c0 .21.17.38.38.38M3.9 13.3H2.65a.38.38 0 1 0 0 .76H3.9a.38.38 0 1 0 0-.76m1.62.38c0 .19.14.34.32.36v-.73c-.18.03-.32.18-.32.36Zm10.59 1.93a.377.377 0 0 0-.53 0c-.15.15-.15.38 0 .53l.89.88c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53zm2.86 2.84-.56-.55a.37.37 0 0 0-.53 0c-.15.15-.15.38 0 .53l.55.54h.54zm-8.58-5.14H9.14a.38.38 0 1 0 0 .76h1.25a.38.38 0 1 0 0-.76m3.62.22v-1.26a.38.38 0 1 0-.76 0v1.05h-.88a.38.38 0 1 0 0 .76h1.1l.68.67c.07.07.17.11.26.11s.19-.04.27-.11c.15-.15.15-.38 0-.53l-.68-.67Zm-.37-2.89c.21 0 .38-.17.38-.38V9.01a.38.38 0 1 0-.76 0v1.25c0 .21.17.38.38.38m-6.12 3.05a.38.38 0 0 0-.38-.38h-.3v.75h.3c.21 0 .38-.17.38-.38Z"}),i.createElement("path",{fill:"currentColor",d:"m19.83 5.98-.7-.69L14.7.88l-.69-.69a.5.5 0 0 0-.35-.15H.52c-.28 0-.5.22-.5.5v13.13c0 .14.06.26.15.35.46.46.7.69.7.69l4.44 4.41s.23.23.7.69c.09.09.21.15.35.15h13.13c.28 0 .5-.22.5-.5V6.33a.5.5 0 0 0-.15-.35ZM5.85 13.31v4.96l-4.29-4.26s-.19-.19-.55-.54V1.74L5.3 6s.19.19.55.54zm.16-8.02L1.73 1.04h11.71l.55.55 4.28 4.25H6.55L6 5.29Zm.84 13.68V6.83h12.13v12.13H6.85Z"}))},camera:function(e){return i.createElement("svg",tt({xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 2",viewBox:"0 0 32 32",role:"img"},e),i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"M29.54 32H2.46C1.1 32 0 30.9 0 29.55V15.34c0-1.35 1.1-2.45 2.46-2.45H9.1c1.21 0 2.34-.54 3.1-1.48l.88-1.09a3.92 3.92 0 0 1 3.08-1.47h6.32c1.21 0 2.33.54 3.08 1.47l.88 1.09a3.97 3.97 0 0 0 3.1 1.48c1.36 0 2.46 1.1 2.46 2.45v14.21C32 30.9 30.9 32 29.54 32M2.46 13.9c-.8 0-1.46.65-1.46 1.45v14.21c0 .8.65 1.45 1.46 1.45h27.08c.8 0 1.46-.65 1.46-1.45V15.34c0-.8-.65-1.45-1.46-1.45-1.52 0-2.93-.68-3.88-1.85l-.88-1.09c-.56-.7-1.4-1.1-2.3-1.1h-6.32c-.9 0-1.74.4-2.3 1.1l-.88 1.09a4.95 4.95 0 0 1-3.88 1.85H2.46Zm4.25 4.85c.58 0 1.04-.46 1.04-1.03s-.47-1.03-1.04-1.03H5.04c-.58 0-1.04.46-1.04 1.03s.47 1.03 1.04 1.03zm12.61-3.24c2.81 0 5.09 2.29 5.09 5.1s-2.28 5.1-5.09 5.1-5.09-2.29-5.09-5.1 2.28-5.1 5.09-5.1m0-2c-3.91 0-7.09 3.18-7.09 7.1s3.17 7.1 7.09 7.1 7.09-3.18 7.09-7.1-3.17-7.1-7.09-7.1M19.39 3.87c-.28 0-.5-.22-.5-.5V.5c0-.28.22-.5.5-.5s.5.22.5.5v2.87c0 .28-.22.5-.5.5m4.76 1.12 2.15-2.34c.19-.2.17-.52-.03-.71a.514.514 0 0 0-.71.03l-2.15 2.34c-.19.2-.17.52.03.71.1.09.22.13.34.13a.5.5 0 0 0 .37-.16m-8.95.03c.2-.19.22-.5.03-.71l-2.15-2.34c-.19-.2-.5-.21-.71-.03-.2.19-.22.5-.03.71l2.15 2.34c.1.11.23.16.37.16.12 0 .24-.04.34-.13"})))},channels:function(e){return i.createElement("svg",nt({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M13.55 10.36h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76M2.65 6.64a.38.38 0 0 1-.38-.38v-.3c0-.26.03-.52.08-.78.04-.2.24-.33.45-.29.2.04.33.24.29.45-.04.2-.07.41-.07.62v.3c0 .21-.17.38-.38.38Zm1.06-2.7c-.1 0-.2-.04-.28-.12a.38.38 0 0 1 .02-.53c.27-.25.59-.46.92-.62.19-.09.41 0 .5.18s0 .41-.18.5c-.27.12-.51.29-.73.49-.07.07-.16.1-.25.1m9.78-.86h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76M13.44 17.69h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-3 0h-1a.38.38 0 1 1 0-.76h1a.38.38 0 1 1 0 .76m-2.95-.32c-.05 0-.11-.01-.16-.04-.33-.16-.64-.38-.91-.63-.15-.14-.16-.38-.02-.53s.38-.16.53-.02c.22.2.46.37.73.5.19.09.26.32.17.5-.06.13-.2.21-.34.21Zm-1.78-2.28c-.17 0-.33-.12-.37-.3-.05-.24-.07-.48-.07-.73v-.34a.38.38 0 1 1 .76 0v.34c0 .19.02.39.06.58.04.2-.09.4-.29.44h-.08ZM5.42 12.69H.01v-5.4h5.41zm-4.4-1h3.4v-3.4H1.01v3.4ZM19.99 5.41h-5.4V0h5.4zm-4.4-1h3.4V1h-3.4v3.4ZM19.99 12.69h-5.4v-5.4h5.4zm-4.4-1h3.4v-3.4h-3.4zM19.99 19.97h-5.4v-5.4h5.4zm-4.4-1h3.4v-3.4h-3.4z"}))},closePanel:function(e){return i.createElement("svg",rt({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M10.64 17.78c-.21 0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21-4.6-6.21c-.33-.44-.23-1.07.21-1.4s1.07-.23 1.4.21l5.03 6.8c.26.35.26.84 0 1.19l-5.03 6.81a1 1 0 0 1-.81.41Z"}),i.createElement("path",{fill:"currentColor",d:"M4.33 17.84c-.21 0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21-4.59-6.21c-.33-.44-.23-1.07.21-1.4s1.07-.23 1.4.21l5.03 6.81c.26.35.26.83 0 1.19l-5.03 6.81a1 1 0 0 1-.81.41Z"}))},download:function(e){return i.createElement("svg",ot({xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 2",viewBox:"0 0 32 32",role:"img"},e),i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"M17 14.93V0h-2v14.93l-3.44-1.46L16 24l4.44-10.53z"}),i.createElement("path",{d:"M28.5 32h-25A2.5 2.5 0 0 1 1 29.5V20h1v9.5c0 .83.67 1.5 1.5 1.5h25c.83 0 1.5-.67 1.5-1.5V20h1v9.5a2.5 2.5 0 0 1-2.5 2.5"})))},dropdownArrow:function(e){return i.createElement("svg",at({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,viewBox:"0 0 12 12",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M1.117 3.12a.47.47 0 0 1 .662.035L6.006 7.85l4.227-4.695a.469.469 0 1 1 .697.627L6.372 8.845A.47.47 0 0 1 6.006 9a.47.47 0 0 1-.366-.155L1.082 3.782a.47.47 0 0 1 .035-.662"}))},metadata:function(e){return i.createElement("svg",it({xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 2",viewBox:"0 0 32 32",role:"img"},e),i.createElement("g",{fill:"currentColor"},i.createElement("path",{d:"M19.46 21.54c0-.28-.22-.5-.5-.5H.5c-.28 0-.5.22-.5.5s.22.5.5.5h18.46c.28 0 .5-.22.5-.5m3.52-14.03c0-.28-.22-.5-.5-.5H.51c-.28 0-.51.23-.51.5s.22.5.5.5h21.98c.28 0 .5-.22.5-.5m-4.74 7.01c0-.28-.22-.5-.5-.5H.5c-.28 0-.5.22-.5.5s.22.5.5.5h17.25c.28 0 .5-.22.5-.5ZM32 .5c0-.28-.22-.5-.5-.5H.54c-.28 0-.5.22-.5.5s.22.5.5.5H31.5c.28 0 .5-.22.5-.5M23.62 14.79l.16-.56h6.29L25.4 27.89c-.13.4-.26.81-.4 1.23-.13.42-.2.81-.2 1.19 0 .32.09.6.28.83.18.23.46.34.83.34.42 0 .84-.15 1.25-.44s.78-.64 1.13-1.03c.34-.39.63-.79.87-1.19s.41-.73.51-.97l.47.2c-.11.21-.27.54-.49.99-.23.44-.53.89-.93 1.33-.39.44-.88.83-1.46 1.15S26 32 25.2 32c-.87 0-1.56-.18-2.08-.54s-.77-.97-.77-1.83c0-.46.08-.96.24-1.51s.32-1.05.48-1.51l4.07-11.81h-3.52Zm4.67-6.57c0 .54.18.99.53 1.35s.8.54 1.32.54.97-.18 1.32-.54.53-.81.53-1.35-.18-.99-.53-1.35-.8-.54-1.32-.54-.97.18-1.32.54-.53.81-.53 1.35"})))},preferences:function(e){return i.createElement("svg",lt({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M8.04 3.61H.81a.749.749 0 1 1 0-1.5h7.23zm11.15-1.5h-5.65v1.5h5.65c.41 0 .75-.34.75-.75s-.34-.75-.75-.75M10.79 5.61c-.41 0-.75-.34-.75-.75V.85c0-.41.34-.75.75-.75s.75.34.75.75v4.01c0 .41-.34.75-.75.75M2.81 10.75h-2c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h2zm16.38-1.5H8.31v1.5h10.88c.41 0 .75-.34.75-.75s-.34-.75-.75-.75M5.56 12.76c-.41 0-.75-.34-.75-.75V7.99c0-.41.34-.75.75-.75s.75.34.75.75V12c0 .41-.34.75-.75.75ZM19.94 17.14c0 .41-.34.75-.75.75h-3.08v-1.5h3.08c.41 0 .75.34.75.75m-9.33-.75H.81c-.41 0-.75.34-.75.75s.34.75.75.75h9.8zM13.36 19.9c-.41 0-.75-.34-.75-.75v-4.01c0-.41.34-.75.75-.75s.75.34.75.75v4.01c0 .41-.34.75-.75.75"}))},resetView:function(e){return i.createElement("svg",ct({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,"data-name":"icon-resetView",viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M.6 5.48c-.28 0-.5-.22-.5-.5V.09h4.89c.28 0 .5.22.5.5s-.22.5-.5.5H1.1v3.89c0 .28-.22.5-.5.5M4.99 19.91H.1v-4.88c0-.28.22-.5.5-.5s.5.22.5.5v3.88h3.89c.28 0 .5.22.5.5s-.22.5-.5.5M19.9 19.91h-4.89c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h3.89v-3.88c0-.28.22-.5.5-.5s.5.22.5.5zM19.4 6.11c-.28 0-.5-.22-.5-.5V1.09h-4.51c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h5.51v5.52c0 .28-.22.5-.5.5M16.46 16.46H3.54V3.54h12.92zm-10.92-2h8.92V5.54H5.54z"}))},turnTable:function(e){return i.createElement("svg",ut({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,viewBox:"0 0 20 20",role:"img"},e),i.createElement("path",{fill:"currentColor",d:"M19.19 7.69c-.09.16-.19.3-.3.44-.26-.29-.55-.56-.85-.8.34-.28.58-.61.61-.99.05-.55-.4-1.15-.95-1.59-.56-.45-1.23-.79-1.92-1.07-.08-.04-.12-.13-.08-.21.03-.07.11-.11.19-.09.73.21 1.46.48 2.15.89.34.21.67.46.95.79.28.32.51.76.55 1.25.05.49-.1.99-.35 1.38M7.85 5.12l1.54-1.8c-1.27.03-2.52.18-3.73.46-.71.16-1.4.37-2.05.65-.64.28-1.25.63-1.67 1.06-.43.45-.54.87-.33 1.29.22.45.76.88 1.36 1.19 1.13.6 2.46.94 3.81 1.15-.27.42-.51.87-.7 1.35-1.29-.23-2.56-.6-3.79-1.26-.71-.4-1.46-.9-1.93-1.83C.13 6.92.06 6.33.2 5.81c.14-.53.43-.94.75-1.27.65-.65 1.39-1.04 2.13-1.35.75-.32 1.51-.54 2.28-.71 1.39-.31 2.79-.45 4.19-.46L8.28 0l5.86 3.07zM18.17 8.83c-.31-.36-.66-.67-1.05-.95h-.01a6.6 6.6 0 0 0-3.89-1.26c-2.16 0-4.09 1.03-5.3 2.63-.33.42-.61.88-.82 1.38a6.68 6.68 0 0 0 6.12 9.35 6.68 6.68 0 0 0 6.68-6.68c0-1.73-.65-3.29-1.73-4.47m-4.95 10.15c-3.13 0-5.68-2.55-5.68-5.68 0-.92.22-1.79.62-2.56.26-.52.6-1 1.01-1.41a5.63 5.63 0 0 1 4.05-1.71 5.62 5.62 0 0 1 4.11 1.78 5.6 5.6 0 0 1 1.57 3.9c0 3.13-2.55 5.68-5.68 5.68"}),i.createElement("path",{fill:"currentColor",d:"m12.83 10.68-1.18-.94v7.16l4.48-3.58zm-.18 1.14 1.88 1.5-1.88 1.5z"}))}};function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function mt(){return mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mt.apply(null,arguments)}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vt(e,t,n){return(t=function(e){var t=function(e){if("object"!=ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yt={fontSize:"19px"};const ht=function(e){var t=dt({},e);return t.style=dt(dt({},yt),e.style),i.createElement(Ke.A,mt({component:st[e.type]},t))};function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const gt=function(e){var t,n,r=e.children,o=e.open,a=e.title,l=e.height,c=e.onOpenChange,u=(t=(0,i.useState)(!0),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return bt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],f=u[1],m=null!=o?o:s,p=(0,i.useCallback)((function(){void 0===o&&f(!m),null==c||c(!m)}),[m,o,c]),d=i.createElement(Pe.Ay,{className:"options-button",size:"small",onClick:p},a||"Options",i.createElement(ht,{type:"closePanel",className:"button-arrow",style:{fontSize:"15px"}}));return i.createElement("div",{className:"bottom-panel"},i.createElement(qe.A,{className:"drawer",placement:"bottom",closable:!1,getContainer:!1,open:m,mask:!1,title:d,height:null!=l?l:190},i.createElement("div",{className:"drawer-body-wrapper"},r)))};function wt(e){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wt(e)}function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return(t=function(e){var t=function(e){if("object"!=wt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const xt=function(e){var t=i.createRef();i.useEffect((function(){t.current.appendChild(e.view3d.getDOMElement())}),[e.view3d,t]);var n,r,o=e.appHeight,a=e.visibleControls,u=e.numTimesteps,s=e.numScenes,f=(0,E.Tk)((0,E.Lt)("changeViewerSetting")),m=(0,E.Tk)((0,E.Lt)("viewMode")),p=(0,E.Tk)((0,E.Lt)("region")),d=(0,E.Tk)((0,E.Lt)("slice")),v=(0,E.Tk)((0,E.Lt)("time")),y=(0,E.Tk)((0,E.Lt)("scene")),h=u>1&&s>1&&m===c.nE.threeD;return i.createElement("div",{className:"cell-canvas",style:Et(Et({},Ct.viewer),{},{height:o})},i.createElement("div",{ref:t,style:Ct.view3d}),i.createElement(gt,{title:"Clipping",open:e.clippingPanelOpen,onOpenChange:e.onClippingPanelOpenChange,height:h?l.uR:l.CB},a.axisClipSliders&&!!e.image&&i.createElement(Xe,{mode:m,image:e.image,changeViewerSetting:f,numSlices:e.numSlices,numSlicesLoaded:e.numSlicesLoaded,numScenes:s,region:p,slices:d,numTimesteps:u,time:v,scene:y,playControls:e.playControls,playingAxis:e.playingAxis})),(n=e.loadingImage&&!e.playingAxis?i.createElement("div",{style:Ct.noImage},i.createElement(xe.A,{style:{fontSize:60,zIndex:1e3}})):null,(r=e.loadingImage||e.image?null:i.createElement("div",{style:Ct.noImage},"No image selected"))&&e.view3d&&e.view3d.removeAllVolumes(),r||n))};var Ct={viewer:{display:"flex",position:"relative"},view3d:{width:"100%",display:"flex",overflow:"hidden"},noImage:{position:"absolute",zIndex:999,top:0,left:0,bottom:0,right:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#eeeee",color:"#9b9b9b",fontSize:"2em",opacity:.75}},jt=n(4604),At=n(3955),Pt=n(696),kt=n(8526),It=n(9914),Mt=n(920),Tt=n(5189);function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(n),!0).forEach((function(t){Rt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rt(e,t,n){return(t=function(e){var t=function(e){if("object"!=Nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return zt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Ft={r:"241",g:"112",b:"19",a:"1"};const Vt=function(e){var t=Bt(i.useState(!1),2),n=t[0],r=t[1],o=Bt(i.useState(!1),2),l=o[0],c=o[1],u=Bt(i.useState(e.color||Ft),2),s=u[0],f=u[1],m=i.useRef(null);i.useEffect((function(){return f(e.color)}),[e.color]);var p=e.width||36,d=l?{bottom:"21px"}:{top:"0px"};return i.createElement("div",null,i.createElement("div",{style:Ut.swatch,ref:m,onClick:function(){var e=m.current.getBoundingClientRect(),t=e.bottom>window.innerHeight-310;r(!n),c(t&&e.top>310)}},i.createElement("div",{style:Lt(Lt({},Ut.color),{},{width:"".concat(p,"px"),background:"rgba(".concat((0,a.map)(s,(function(e){return e})),")")})})),i.createElement("div",{style:{position:"absolute"}},n?i.createElement("div",{style:Lt(Lt({},Ut.popover),d)},i.createElement("div",{style:Ut.cover,onClick:function(){return r(!1)}}),i.createElement(Tt.Xq,{color:s,onChange:function(t){var n;f(t.rgb),null===(n=e.onColorChange)||void 0===n||n.call(e,t.rgb,s,e.idx)},onChangeComplete:function(t){var n;f(t.rgb),null===(n=e.onColorChangeComplete)||void 0===n||n.call(e,t.rgb,s,e.idx)},disableAlpha:e.disableAlpha})):null))};var Ut={color:{height:"14px",margin:"3px",borderRadius:"2px"},swatch:{borderRadius:"3px",border:"1px solid var(--color-controlpanel-border)",display:"inline-block",cursor:"pointer",verticalAlign:"middle"},popover:{position:"absolute",zIndex:"9999"},cover:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},Ht=n(9569),Gt=n(1636),_t=n(126),$t=n(5457),Wt={to:Math.round,from:Number};const Zt=function(e){var t;return i.createElement("div",{className:"viewer-control-row"},i.createElement("div",{className:"control-name"},e.label),i.createElement("div",{className:"control"},void 0!==e.start&&!e.hideSlider&&i.createElement("div",{className:"control-slider"},i.createElement(He,{range:{min:null!==(t=e.min)&&void 0!==t?t:0,max:e.max},start:e.start,connect:!0,tooltips:!0,behaviour:"drag",format:e.formatInteger?Wt:void 0,onUpdate:e.onUpdate,onChange:e.onChange})),e.children&&i.createElement("div",{className:"control-extra"},e.children)))};function Yt(e){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(e)}function Qt(e){return function(e){if(Array.isArray(e))return tn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||en(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xt(Object(n),!0).forEach((function(t){Kt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kt(e,t,n){return(t=function(e){var t=function(e){if("object"!=Yt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Yt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||en(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(e,t){if(e){if("string"==typeof e)return tn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(e,t):void 0}}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var nn=function(e){return e.Min="min",e.Max="max",e.Isosurface="surf",e}(nn||{}),rn={autoXF:function(e){var t=Jt(e.findAutoMinMax(),2),n=t[0],o=t[1];return(new r.Sd).createFromMinMax(n,o)},auto2XF:function(e){var t=Jt(e.findAutoIJBins(),2),n=t[0],o=t[1];return(new r.Sd).createFromMinMax(n,o)},auto98XF:function(e){var t=e.findBinOfPercentile(l.BO),n=e.findBinOfPercentile(l.xB);return(new r.Sd).createFromMinMax(t,n)},bestFitXF:function(e){var t=Jt(e.findBestFitBins(),2),n=t[0],o=t[1];return(new r.Sd).createFromMinMax(n,o)},resetXF:function(e){return(new r.Sd).createFullRange()}},on={draw:function(e,t){var n=Math.sqrt(1.9*t),r=.4*n,o=.325*n;e.moveTo(-o,-n),e.lineTo(o,-n),e.lineTo(o,-r),e.lineTo(0,0),e.lineTo(-o,-r),e.closePath()}},an=.75*Math.pow(2,2),ln=2*(Math.SQRT2-.5),cn=.5*(Math.SQRT2-1)*2,un={draw:function(e,t){var n=Math.max(t-an,0),r=cn+n/(2*Math.SQRT2*2);e.moveTo(1,0),e.lineTo(r+1,-r),e.lineTo(r+1-Math.SQRT2,-r-Math.SQRT2),e.lineTo(0,-ln),e.lineTo(-r-1+Math.SQRT2,-r-Math.SQRT2),e.lineTo(-r-1,-r),e.lineTo(-1,0),e.closePath()}},sn=function(e,t,n){return[qt(qt({},e),{},{x:t}),qt(qt({},e),{},{x:n})]},fn=function(e,t,n){var r=(n-e.x)/(t.x-e.x);return{x:n,opacity:e.opacity+(t.opacity-e.opacity)*r,color:e.color.map((function(e,n){return e+(t.color[n]-e)*r}))}},mn=function(e){var t=e.controlPoints,n=e.id,r=t[t.length-1].x-t[0].x;return i.createElement("defs",null,i.createElement("linearGradient",{id:n,gradientUnits:"objectBoundingBox",spreadMethod:"pad",x2:"100%"},t.map((function(e,n){var o="".concat((e.x-t[0].x)/r*100,"%"),a=Math.min(e.opacity,.75);return i.createElement("stop",{key:n,stopColor:I(e.color),stopOpacity:a,offset:o})}))))},pn=function(e){return void 0===e?"":Number(e).toFixed(0)},dn=function(e,t,n){return Math.min(Math.max(e,t),n)};const vn=function(e){var t=e.changeChannelSetting,n=e.plotMin,r=e.plotMax,o=e.width-25-20,a=e.height-18-30,c=Jt((0,i.useState)(null),2),u=c[0],s=c[1],f=Jt((0,i.useState)(null),2),m=f[0],p=f[1],d=(0,i.useCallback)((function(e){return t({controlPoints:e})}),[t]),v=(0,i.useCallback)((function(e){return t({ramp:e})}),[t]),y=Jt((0,i.useState)(0),2),h=y[0],b=y[1],E=Jt((0,S.G)(d,e.controlPoints),2),O=E[0],x=E[1],C=Jt((0,S.G)(p,m),2),j=C[0],k=C[1],M=Jt((0,i.useState)(null),2),T=M[0],N=M[1],D=(0,i.useRef)(l.YT),L=(0,i.useRef)(null),R=e.channelData.histogram,B=l.L9[e.channelData.dtype],z=(0,i.useMemo)((function(){return $t.m4Y().domain([n,r]).range([0,o])}),[o,n,r]),F=(0,i.useMemo)((function(){return $t.m4Y().domain([0,1]).range([a,0])}),[a]),V=function(e){var t,n,r=null!==(t=null===(n=L.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==t?t:{x:0,y:0};return[z.invert(dn(e.clientX-r.x-25,0,o)),F.invert(dn(e.clientY-r.y-18,0,a))]},U=function(e){m===nn.Isosurface&&t({isovalue:h}),k(null),e.currentTarget.releasePointerCapture(e.pointerId)},H=function(e){if(e.preventDefault(),e.target&&L.current){var t=L.current.getBoundingClientRect(),n=e.target.getBoundingClientRect(),r=n.left+n.width/2-t.left<t.width/2?n.right-t.left+2:n.left-t.right-2,o=window.innerHeight-n.bottom<310?t.top-n.bottom:n.top-t.top;N([r,o])}else N(null)},G=(0,i.useMemo)((function(){return function(e,t,n){var r=e.slice(),o=r[0],a=r[r.length-1];if(a.x<t)return sn(a,t,n);if(o.x>n)return sn(o,t,n);if(o.x>t)r.unshift(qt(qt({},o),{},{x:t}));else{for(var i=void 0;r[0].x<t&&r.length>1;)i=r.shift();void 0!==i&&r.unshift(fn(i,r[0],t))}if(a.x<n)r.push(qt(qt({},a),{},{x:n}));else{for(var l=void 0;r[r.length-1].x>n&&r.length>1;)l=r.pop();void 0!==l&&r.push(fn(l,r[r.length-1],n))}return r}(e.useControlPoints?e.controlPoints.slice():w(e.ramp),n,r)}),[e.controlPoints,e.ramp,e.useControlPoints,n,r]),_=(0,i.useMemo)((function(){var e;return null!==(e=$t.Wcw().x((function(e){return z(e.x)})).y0((function(e){return F(e.opacity)})).y1(a).curve($t.lUB)(G))&&void 0!==e?e:void 0}),[G,z,F,a]),$=(0,i.useMemo)((function(){var e;return null!==(e=$t.HRO().type(on).size(80)())&&void 0!==e?e:void 0}),[]),W=(0,i.useMemo)((function(){var e;return null!==(e=$t.HRO().type(un).size(21)())&&void 0!==e?e:void 0}),[]),Z=(0,i.useCallback)((function(t){var n=z.ticks(4),r=Jt(z.domain(),2),o=r[0],a=r[1],i=a-o;(n[0]-o)/i<.1?n[0]=o:n.unshift(o),(n[n.length-1]-o)/i>.9?n[n.length-1]=a:n.push(a),$t.Ltv(t).call($t.l78(z).tickValues(n).tickPadding(e.useControlPoints?3:10))}),[z,e.useControlPoints]),Y=(0,i.useCallback)((function(e){return $t.Ltv(e).call($t.V4s(F).ticks(4))}),[F]),Q=(0,i.useCallback)((function(e){if(null!==e){var t=R.getNumBins();if(!(t<1)){var i=R.findFractionalBinOfValue(n),l=R.findFractionalBinOfValue(r),c=function(e){for(var t=[],n=Number.NEGATIVE_INFINITY,r=0;r<e.getNumBins();r++){var o=e.getBin(r);t.push(o),n=Math.max(n,o)}return{binLengths:t,max:n}}(R),u=c.binLengths,s=c.max,f=Math.max(0,Math.ceil(i)),m=Math.min(t,Math.floor(l)),p=u.slice(f,m),d=o/(l-i),v=$t.ZEH().domain([.1,s]).range([a,0]).base(2).clamp(!0);$t.Ltv(e).selectAll(".bar").data(p).join("rect").attr("class","bar").attr("width",d).attr("x",(function(e,t){return z(R.getValueFromBinIndex(t+f))})).attr("y",(function(e){return v(e)})).attr("height",(function(e){return a-v(e)}))}}}),[z,R,o,a,n,r]),X=(0,i.useCallback)((function(t){s(null),D.current=l.YT;var n=rn[t](R).controlPoints.map((function(e){return qt(qt({},e),{},{x:R.getValueFromBinIndex(e.x)})}));e.useControlPoints?x(n.map((function(e){return qt(qt({},e),{},{color:l.YT})}))):v(g(n))}),[R,e.useControlPoints,x,v]),q=null;e.volumeEnabled&&e.useControlPoints&&(q=e.controlPoints.filter((function(e){return n<=e.x&&e.x<=r})).map((function(e,t){return i.createElement("circle",{key:t,className:t===u?"selected":"",cx:z(e.x),cy:F(e.opacity),style:{fill:I(e.color)},r:5,onPointerDown:function(){return k(t)},onContextMenu:H})}))),null!==q&&null!==u&&q.push(q.splice(u,1)[0]);var K,J,ee,te,ne=null===m?"":"number"==typeof m?" dragging-point":" dragging-slider",re=m===nn.Isosurface?h:e.isovalue,oe=e.volumeEnabled&&!e.useControlPoints,ae=e.channelData,ie=ae.rawMin,le=ae.rawMax;return i.createElement("div",{className:"tf-editor"},i.createElement("div",{className:"tf-editor-control-row"},i.createElement("div",null,i.createElement(Pe.Ay,{size:"small",onClick:function(){return t({plotMin:ie,plotMax:le})}},"Fit to data"),i.createElement(Pe.Ay,{size:"small",onClick:function(){return t({plotMin:B.min,plotMax:B.max})}},"Full range")),i.createElement("div",null,"Plot min/max",i.createElement(_t.A,{value:n,onChange:function(e){return null!==e&&t({plotMin:e,plotMax:Math.max(e+1,r)})},formatter:pn,min:B.min,max:B.max-1,size:"small",controls:!1}),i.createElement(_t.A,{value:r,onChange:function(e){return null!==e&&t({plotMax:e,plotMin:Math.min(e-1,n)})},formatter:pn,min:B.min+1,max:B.max,size:"small",controls:!1}))),null!==T&&i.createElement("div",{className:"tf-editor-popover"},i.createElement("div",{className:"tf-editor-cover",onClick:function(){return N(null)}}),i.createElement("div",{style:(K=T,J=Jt(K,2),ee=J[0],te=J[1],Kt(Kt({position:"absolute"},ee<0?"right":"left",Math.abs(ee)),te<0?"bottom":"top",te))},i.createElement(Tt.Xq,{color:P(D.current),onChange:function(t){if(D.current=A(t.rgb),null!==u){var n=Qt(e.controlPoints);n[u].color=D.current,x(n)}},disableAlpha:!0}))),i.createElement("svg",{className:"tf-editor-svg".concat(ne),ref:L,width:e.width,height:e.height,onPointerDown:function(t){if(e.useControlPoints){if(null===j.current&&0===t.button){var n=Jt(V(t),2),r={x:n[0],opacity:n[1],color:D.current},o=$t.ylB((function(e,t){return e.x-t.x})).left(e.controlPoints,r);k(o);var a=Qt(e.controlPoints);a.splice(o,0,r),x(a)}else O.current=e.controlPoints;"string"!=typeof j.current&&s(j.current)}0===t.button&&null!==j.current?t.currentTarget.setPointerCapture(t.nativeEvent.pointerId):k(null)},onPointerMove:function(t){if(null!==j.current)if(1&t.buttons){t.stopPropagation(),t.preventDefault();var n=Jt(V(t),2),r=n[0],o=n[1];"number"==typeof j.current?function(e,t,n){var r=Qt(O.current),o=r[e];o.x=t,o.opacity=n;var a=$t.ylB((function(e,t){return e.x-t.x})),i=a.left(r,o),l=a.right(r,o);if(i<e){var c=e-i;r.splice(i,c);var u=e-c;k(u),s(u)}else l>e+1&&r.splice(e+1,l-e-1);x(r)}(j.current,r,o):function(t,n){if(t===nn.Min){var r=e.ramp[1];v([Math.min(n,r),r])}else if(t===nn.Max){var o=e.ramp[0];v([o,Math.max(n,o)])}else b(n)}(j.current,r)}else U(t)},onPointerUp:U},i.createElement(mn,{controlPoints:G,id:"tfGradient-".concat(e.id)}),i.createElement("g",{transform:"translate(".concat(25,",").concat(18,")")},i.createElement("g",{ref:Q}),e.volumeEnabled&&i.createElement("path",{className:"line",fill:"url(#tfGradient-".concat(e.id,")"),d:_}),i.createElement("g",{ref:Z,className:"axis",transform:"translate(0,".concat(a,")")}),i.createElement("g",{ref:Y,className:"axis"}),q,e.volumeEnabled&&!e.useControlPoints&&i.createElement("g",{className:"sliders sliders-ramp"},n<=e.ramp[0]&&e.ramp[0]<=r&&i.createElement("g",{transform:"translate(".concat(z(e.ramp[0]),")")},i.createElement("line",{y1:a,strokeDasharray:"5,5",strokeWidth:2}),i.createElement("line",{className:"slider-click-target",y1:a,strokeWidth:6,onPointerDown:function(){return k(nn.Min)}}),i.createElement("path",{d:$,transform:"translate(0,".concat(a,") rotate(180)"),onPointerDown:function(){return k(nn.Min)}})),n<=e.ramp[1]&&e.ramp[1]<=r&&i.createElement("g",{transform:"translate(".concat(z(e.ramp[1]),")")},i.createElement("line",{y1:a,strokeDasharray:"5,5",strokeWidth:2}),i.createElement("line",{className:"slider-click-target",y1:a,strokeWidth:6,onPointerDown:function(){return k(nn.Max)}}),i.createElement("path",{d:$,onPointerDown:function(){return k(nn.Max)}}))),e.isosurfaceEnabled&&n<=re&&re<=r&&i.createElement("g",{className:"sliders sliders-isovalue",transform:"translate(".concat(z(re),")")},i.createElement("line",{className:"slider-isosurface",y1:a,strokeDasharray:"4,4",strokeWidth:2}),i.createElement("line",{className:"slider-click-target",y1:a,strokeWidth:6,onPointerDown:function(){b(e.isovalue),k(nn.Isosurface)}}),i.createElement("path",{d:W,onPointerDown:function(){return k(nn.Isosurface)}}),i.createElement("path",{d:W,transform:"translate(0,".concat(a,") rotate(180)"),onPointerDown:function(){return k(nn.Isosurface)}})))),e.volumeEnabled&&i.createElement(i.Fragment,null,i.createElement("h4",null,"Volume settings"),i.createElement("div",{className:"tf-editor-control-row"},i.createElement("div",null,i.createElement(jt.A,{trigger:["click"],menu:{items:[{key:"auto98XF",label:"Default (50% - 98%)"},{key:"auto2XF",label:"ImageJ Auto"},{key:"resetXF",label:"Auto 1 (0% - 100%)"},{key:"bestFitXF",label:"Auto 2 (10% - 90%)"}],onClick:function(e){var t=e.key;return X(t)}}},i.createElement(Pe.Ay,{size:"small"},i.createElement("span",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"4px"}},"Apply ramp",i.createElement(ht,{type:"dropdownArrow",style:{fontSize:"14px"}}))))),i.createElement("div",null,oe&&i.createElement(i.Fragment,null,i.createElement("span",null,"Levels min/max"),i.createElement(_t.A,{value:e.ramp[0],onChange:function(t){return null!==t&&v([t,e.ramp[1]])},formatter:pn,min:B.min,max:Math.min(e.ramp[1],B.max),size:"small",controls:!1}),i.createElement(_t.A,{value:e.ramp[1],onChange:function(t){return null!==t&&v([e.ramp[0],t])},formatter:pn,min:Math.max(B.min,e.ramp[0]),max:B.max,size:"small",controls:!1}),i.createElement(Ae.A,{title:"".concat(e.keepIntensityRange?"Do not keep":"Keep"," intensity threshold values when switching volumes.")},i.createElement(Pe.Ay,{onClick:function(){return e.changeChannelSetting({keepIntensityRange:!e.keepIntensityRange})},style:{height:24,padding:"0 4px"},type:e.keepIntensityRange?"default":"text"},i.createElement("span",{style:{margin:0}},e.keepIntensityRange?i.createElement(Ht.A,null):i.createElement(Gt.A,null))))))),i.createElement(Zt,{label:i.createElement(i.Fragment,null,i.createElement(Mt.A,{checked:e.useControlPoints,onChange:function(e){return t({useControlPoints:e.target.checked})}},"Advanced"),i.createElement(Mt.A,{checked:e.colorizeEnabled,onChange:function(e){return t({colorizeEnabled:e.target.checked})},style:{marginLeft:"5px"}},"Colorize")),max:1,start:e.colorizeAlpha,onUpdate:function(e){var n=Jt(e,1)[0];return t({colorizeAlpha:n})},hideSlider:!e.colorizeEnabled})),e.isosurfaceEnabled&&i.createElement(i.Fragment,null,i.createElement("h4",null,"Isosurface settings"),i.createElement("div",{className:"tf-editor-control-row"},i.createElement("div",null,"Isovalue",i.createElement(_t.A,{value:e.isovalue,onChange:function(e){return null!==e&&t({isovalue:e})},formatter:pn,min:B.min,max:B.max,size:"small",controls:!1})),i.createElement("div",null,"Export surface",i.createElement(Pe.Ay,{size:"small",onClick:function(){return e.saveIsosurface("GLTF")}},"GLTF"),i.createElement(Pe.Ay,{size:"small",onClick:function(){return e.saveIsosurface("STL")}},"STL"))),i.createElement(Zt,{label:"Opacity",max:1,start:e.opacity,onUpdate:function(e){var n=Jt(e,1)[0];return t({opacity:n})}})))};function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const hn=function(e){var t,n,r,o,a,l,c,u,s,f,m=e.index,p=e.saveIsosurface,d=(s=(0,i.useState)(!1),f=2,function(e){if(Array.isArray(e))return e}(s)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(s,f)||function(e,t){if(e){if("string"==typeof e)return yn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yn(e,t):void 0}}(s,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=d[0],y=d[1],h=(0,E.Tk)((0,E.Lt)("changeChannelSetting")),b=(0,E.Tk)((function(t){return t.channelSettings[e.index]})),g=(0,i.useCallback)((function(e){return h(m,e)}),[h,m]),w=(0,i.useCallback)((function(e){return p(m,e)}),[p,m]),S=i.createElement("div",{className:"channel-visibility-controls"},i.createElement(Mt.A,{checked:b.volumeEnabled,onChange:function(e){var t=e.target;h(m,{volumeEnabled:t.checked})}},"Vol"),i.createElement(Mt.A,{checked:b.isosurfaceEnabled,onChange:function(e){var t=e.target;h(m,{isosurfaceEnabled:t.checked})}},"Surf"),i.createElement(Pe.Ay,{icon:i.createElement(ht,{type:"preferences",style:{fontSize:"16px"}}),onClick:function(){return y(!v)},title:"Open channel settings",type:"text"})),O=v?"channel-row":"channel-row controls-closed";return i.createElement(kt.A.Item,{key:m,className:O},i.createElement(kt.A.Item.Meta,{title:e.name,avatar:i.createElement(Vt,{color:P(b.color),onColorChange:function(e,t,n){var r=A(e);h(n,{color:r})},onColorChangeComplete:e.onColorChangeComplete,disableAlpha:!0,idx:m,width:18})}),S,v&&i.createElement("div",{style:{width:"100%"}},b.volumeEnabled||b.isosurfaceEnabled?i.createElement(i.Fragment,null,(b.volumeEnabled||b.isosurfaceEnabled)&&(t=b.controlPoints,n=b.colorizeEnabled,r=b.colorizeAlpha,o=b.useControlPoints,a=b.ramp,l=b.plotMin,c=b.plotMax,u=b.isovalue,i.createElement(vn,{id:"TFEditor"+m,width:418,height:145,channelData:e.channelDataForChannel,controlPoints:t,changeChannelSetting:g,colorizeEnabled:n,colorizeAlpha:r,useControlPoints:o,ramp:a,plotMin:l,plotMax:c,keepIntensityRange:b.keepIntensityRange,isovalue:u,opacity:b.opacity,volumeEnabled:b.volumeEnabled,isosurfaceEnabled:b.isosurfaceEnabled,saveIsosurface:w}))):i.createElement("h4",{style:{fontStyle:"italic"}},"Not currently visible")))},bn=function(e){var t=!!e.checkedList.length&&e.checkedList.length<e.allOptions.length,n=e.checkedList.length===e.allOptions.length;return i.createElement(Mt.A,{indeterminate:t,onChange:function(t){var n=t.target;return e.onChange(n.checked,e.allOptions)},checked:n,style:e.style},e.children)};function gn(e){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn(e)}function wn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Sn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var En=function(e){return(0,It.k)((function(t){return t.channelSettings.map((function(t){return t[e]}))}))};const On=function(e){var t=e.channelGroupedByType,n=e.channelDataChannels,r=e.filterFunc,o=e.viewerChannelSettings,a=(0,E.Tk)((0,E.Lt)("changeChannelSetting")),l=En("volumeEnabled"),c=En("isosurfaceEnabled"),s=En("name"),f=(0,E.Tk)(l),m=(0,E.Tk)(c),p=(0,E.Tk)(s),d=function(e){return function(t,n){var r,o,i;a(n,(r={},i=t,(o=function(e){var t=function(e){if("object"!=gn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=gn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==gn(t)?t:t+""}(o=e))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i,r))}},v=d("volumeEnabled"),y=d("isosurfaceEnabled"),h=function(e){var t=[],n=[];return e.forEach((function(e){f[e]&&t.push(e),m[e]&&n.push(e)})),i.createElement(i.Fragment,null,i.createElement(bn,{allOptions:e,checkedList:t,onChange:v},"All Vol"),i.createElement(bn,{allOptions:e,checkedList:n,onChange:y,style:{flex:5}},"All Surf"))},b=function(t){var r=p[t];return r?i.createElement(hn,{key:t,index:t,channelDataForChannel:n[t],name:(0,u.Mn)(r,t,o),onColorChangeComplete:e.onColorChangeComplete,saveIsosurface:e.saveIsosurface}):null},g=Object.keys(t)[0],w=n&&Object.entries(t).filter((function(e){var t=wn(e,2),n=t[0];return t[1].length>0&&(!r||r(n))})).map((function(e){var t=wn(e,2),n=t[0],r=t[1];return{key:n,label:n,children:i.createElement(kt.A,{itemLayout:"horizontal",dataSource:r,renderItem:b}),extra:h(r)}}));return i.createElement(Pt.A,{bordered:!1,defaultActiveKey:g,items:w,collapsible:"icon"})};var xn=function(e){var t=e.color,n=e.onColorChange,r=e.children;return i.createElement("div",{style:Cn.colorPickerRow},i.createElement("span",{style:Cn.colorPicker},i.createElement(Vt,{color:P(t),onColorChange:function(e){return n(A(e))},width:18,disableAlpha:!0})),i.createElement("span",null,r))},Cn={colorPickerRow:{padding:"14px 0",display:"flex",borderBottom:"1px solid #6e6e6e",color:"var(--color-controlpanel-text)"},colorPicker:{marginRight:"16px"}};const jn=function(e){var t=(0,E.Tk)((0,E.Lt)("showBoundingBox")),n=(0,E.Tk)((0,E.Lt)("backgroundColor")),r=(0,E.Tk)((0,E.Lt)("boundingBoxColor")),o=(0,E.Tk)((0,E.Lt)("changeViewerSetting"));return i.createElement(i.Fragment,null,e.visibleControls.backgroundColorPicker&&i.createElement(xn,{color:n,onColorChange:function(e){return o("backgroundColor",e)}},"Background color"),e.visibleControls.boundingBoxColorPicker&&i.createElement(xn,{color:r,onColorChange:function(e){return o("boundingBoxColor",e)}},"Bounding box color",!t&&i.createElement("i",null," - bounding box turned off")))},An=function(e){var t=(0,E.Tk)((0,E.Lt)("maskAlpha")),n=(0,E.Tk)((0,E.Lt)("brightness")),r=(0,E.Tk)((0,E.Lt)("density")),o=(0,E.Tk)((0,E.Lt)("levels")),a=(0,E.Tk)((0,E.Lt)("interpolationEnabled")),l=(0,E.Tk)((0,E.Lt)("changeViewerSetting")),c=function(e,t,n,r){return i.createElement(Zt,{label:e,start:t,max:n,onUpdate:function(e,t,n){var o=1===n.length?n[0]:n;l(r,o)}})},u=e.visibleControls;return i.createElement("div",{style:{paddingTop:18,paddingBottom:22}},u.alphaMaskSlider&&c("mask cell",t,100,"maskAlpha"),u.brightnessSlider&&c("brightness",n,100,"brightness"),u.densitySlider&&c("density",r,100,"density"),u.levelsSliders&&c("levels",o,255,"levels"),u.interpolationControl&&i.createElement(Zt,{label:"interpolate",hideSlider:!0},i.createElement(Mt.A,{checked:a,onChange:function(e){var t=e.target;return l("interpolationEnabled",t.checked)}})))};var Pn=n(8e3);function kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function In(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?In(Object(n),!0).forEach((function(t){Tn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tn(e,t,n){return(t=function(e){var t=function(e){if("object"!=Nn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nn(e){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nn(e)}var Dn=function(e){return"object"===Nn(e)&&null!==e},Ln=function(e){var t,n,r=e.metadata,o=e.title,a=(t=i.useState(!0),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(t,n)||function(e,t){if(e){if("string"==typeof e)return kn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kn(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[0],c=a[1],u=l?" metadata-collapse-collapsed":"";return i.createElement(i.Fragment,null,i.createElement("tr",{className:"metadata-row-collapse-title"+u,onClick:function(){return c(!l)}},i.createElement("td",{colSpan:2},i.createElement("span",{className:"metadata-collapse-caret"},i.createElement(Pn.A,{style:{transform:"rotate(".concat(l?0:90,"deg)")}})),o)),i.createElement("tr",{className:"metadata-row-collapse-content"+u},i.createElement("td",{className:"metadata-collapse-content",colSpan:2},i.createElement(Rn,{metadata:r}))))},Rn=function(e){var t=e.metadata,n=e.topLevel,r=Object.keys(t),o=Array.isArray(t);return i.createElement("table",{className:"viewer-metadata-table"+(n?" metadata-top-level":"")},i.createElement("tbody",null,r.map((function(e,n){var r=function(e){if(!Dn(e)||Array.isArray(e))return e;var t={},n={};for(var r in e)Dn(e[r])?t[r]=e[r]:n[r]=e[r];return Mn(Mn({},t),n)}(o?t[n]:t[e]);return Dn(r)?i.createElement(Ln,{key:e,metadata:r,title:e}):i.createElement("tr",{key:e},i.createElement("td",{className:"metadata-key"},e),i.createElement("td",{className:"metadata-value"},r+""))}))))};const Bn=function(e){var t=e.metadata;return i.createElement(Rn,{metadata:t,topLevel:!0})};function zn(){return zn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zn.apply(null,arguments)}function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(e)}function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Un(e,t,n){return(t=function(e){var t=function(e){if("object"!=Fn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fn(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hn=function(e){return e[e.Channels=0]="Channels",e[e.Advanced=1]="Advanced",e[e.Metadata=2]="Metadata",e}(Hn||{}),Gn=Un(Un(Un({},Hn.Channels,"Channel Settings"),Hn.Advanced,"Advanced Settings"),Hn.Metadata,"Metadata");const _n=function(e){var t,n,r,o,a,c=(o=i.useState(Hn.Channels),a=2,function(e){if(Array.isArray(e))return e}(o)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(o,a)||function(e,t){if(e){if("string"==typeof e)return Vn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vn(e,t):void 0}}(o,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=c[0],s=c[1],f=(0,E.Tk)((0,E.Lt)("resetToDefaultViewerState")),m=i.useRef(null),p=m.current?function(){return m.current}:void 0,d=e.viewerChannelSettings,v=e.visibleControls,y=e.hasImage,h=function(t,n){return i.createElement(Ae.A,zn({title:Gn[t],placement:"right"},!e.collapsed&&{open:!1}),i.createElement(Pe.Ay,{className:u===t?"ant-btn-icon-only btn-tabactive":"ant-btn-icon-only",onClick:function(){return s(t),void e.setCollapsed(!1)},icon:"string"==typeof n?n:void 0},"object"===Fn(n)&&n))};return i.createElement("div",{className:"control-panel-col-container",ref:m},i.createElement("div",{className:"control-panel-tab-col",style:{flex:"0 0 50px"}},i.createElement(Pe.Ay,{className:"ant-btn-icon-only btn-collapse"+(e.collapsed?" btn-collapse-collapsed":""),onClick:function(){return e.setCollapsed(!e.collapsed)}},i.createElement(ht,{type:"closePanel"})),i.createElement("div",{className:"tab-divider"}),h(Hn.Channels,i.createElement(ht,{type:"channels"})),h(Hn.Advanced,i.createElement(ht,{type:"preferences"})),e.visibleControls.metadataViewer&&h(Hn.Metadata,i.createElement(ht,{type:"metadata"}))),i.createElement("div",{className:"control-panel-col",style:{flex:"0 0 450px"}},i.createElement("h2",{className:"control-panel-title"},Gn[u]),v.colorPresetsDropdown&&u===Hn.Channels&&(r={items:l.D8.map((function(e,t){return{key:t,label:e.name}})),onClick:function(t){var n=t.key;return e.onApplyColorPresets(l.D8[n].colors)}},i.createElement("div",{className:"color-presets-dropdown"},i.createElement(jt.A,{trigger:["click"],menu:r,getPopupContainer:p},i.createElement(Pe.Ay,null,i.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"4px"}},"Apply palette",i.createElement(ht,{type:"dropdownArrow",style:{fontSize:"14px"}})))))),y&&i.createElement("div",{className:"channel-rows-list"},u===Hn.Channels&&i.createElement(On,{channelDataChannels:e.channelDataChannels,channelGroupedByType:e.channelGroupedByType,saveIsosurface:e.saveIsosurface,onColorChangeComplete:e.onColorChangeComplete,onApplyColorPresets:e.onApplyColorPresets,filterFunc:e.filterFunc,viewerChannelSettings:d}),u===Hn.Advanced&&(t=[{key:0,label:"Rendering adjustments",children:i.createElement(An,{imageName:e.imageName,pixelSize:e.pixelSize,visibleControls:v})}],(n=v.backgroundColorPicker||v.boundingBoxColorPicker)&&t.push({key:1,label:"Customize",children:i.createElement(jn,{visibleControls:e.visibleControls})}),i.createElement(At.A,{gap:10,vertical:!0},i.createElement(Pt.A,{bordered:!1,defaultActiveKey:n?[0,1]:0,items:t}),i.createElement("div",{style:{margin:"0 10px",width:"fit-content"}},i.createElement(Ae.A,{trigger:["hover","focus"],placement:"right",title:"Clears ALL rendering settings and channel configuration to the default viewer state. This will replace any edits to channel settings, color presets, and rendering adjustments."},i.createElement(Pe.Ay,{onClick:f},"Clear all settings"))))),u===Hn.Metadata&&i.createElement(Bn,{metadata:e.metadata}))))};var $n=n(709),Wn=n(1130),Zn=n(581),Yn=n(770),Qn=n(9772);const Xn=function(e){var t=e.fovDownloadHref,n=e.cellDownloadHref;if(e.hasFov){var r={className:"download-dropdown",items:[{key:"1",label:i.createElement("a",{href:n},i.createElement(ht,{type:"download"})," Segmented cell")},{key:"2",label:i.createElement("a",{href:t},i.createElement(ht,{type:"download"})," Full field image")}]};return i.createElement(Ae.A,{trigger:["hover","focus"],placement:"bottom",title:"Download volume data"},i.createElement(jt.A,{menu:r,placement:"bottomRight",trigger:["click"]},i.createElement(Pe.Ay,{className:"ant-btn-icon-only btn-borderless"},i.createElement(ht,{type:"download"}))))}return n?i.createElement(Ae.A,{trigger:["hover","focus"],placement:"bottom",title:"Download volume data"},i.createElement(Pe.Ay,{className:"ant-btn-icon-only btn-borderless",href:n},i.createElement(ht,{type:"download"}))):null};var qn=[c.nE.threeD,c.nE.xy,c.nE.xz,c.nE.yz];const Kn=function(e){return i.createElement(Yn.Ay.Group,{onChange:function(t){var n=t.target;e.mode!==n.value&&e.onViewModeChange(n.value)},value:e.mode.toString()},qn.map((function(e,t){return i.createElement(Yn.Ay.Button,{key:t,value:e.toString()},e)})))};function Jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return er(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?er(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tr={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const nr=function(e){var t=i.useRef(null),n=i.useRef(null),r=i.useRef(null),o=i.useRef(null),l=i.useRef(null),u=Jn(i.useState(!1),2),s=u[0],f=u[1],m=Jn(i.useState(!1),2),p=m[0],d=m[1],v=Jn(i.useState(!1),2),y=v[0],h=v[1],b=(0,E.Tk)((0,E.Lt)("imageType")),g=(0,E.Tk)((0,E.Lt)("renderMode")),w=(0,E.Tk)((0,E.Lt)("viewMode")),S=(0,E.Tk)((0,E.Lt)("autorotate")),O=(0,E.Tk)((0,E.Lt)("showAxes")),x=(0,E.Tk)((0,E.Lt)("showBoundingBox")),C=(0,E.Tk)((0,E.Lt)("changeViewerSetting")),j=i.useCallback((function(){var e=n.current;e&&(d(e.scrollLeft>0),h(e.scrollLeft<e.scrollWidth-e.clientWidth))}),[]),A=i.useMemo((function(){return(0,a.debounce)((function(){if(r.current&&l.current&&o.current&&n.current){var e=r.current.getBoundingClientRect(),t=l.current.getBoundingClientRect(),a=o.current.getBoundingClientRect();f((function(r){return r?n.current.getBoundingClientRect().width<=2*Math.max(e.width,a.width)+t.width+15:e.right>t.left||t.right>a.left})),j()}}),50)}),[j]);i.useEffect((function(){return A(),window.addEventListener("resize",A),function(){return window.removeEventListener("resize",A)}}),[A]);var P=function(e){return n.current.scrollLeft+=e},k=function(e){return"ant-btn-icon-only btn-borderless"+(e?" btn-active":"")},I=e.visibleControls,M=w!==c.nE.threeD,T=I.viewModeRadioButtons||I.resetCameraButton||I.autoRotateButton,N=I.showAxesButton||I.showBoundingBoxButton,D=O?"Hide axes":"Show axes",L=x?"Hide bounding box":"Show bounding box",R=S?"Turn off turntable":"Turn on turntable",B=t.current?function(){return t.current}:void 0;return i.createElement("div",{className:"viewer-toolbar-container".concat(s?" viewer-toolbar-scroll":""),ref:t},i.createElement("div",{className:"viewer-toolbar-scroll-left",style:{display:p?"flex":"none"},onClick:function(){return P(-100)}},i.createElement(ht,{type:"closePanel",style:{fontSize:"12px",transform:"rotate(180deg)"}})),i.createElement("div",{className:"viewer-toolbar",ref:n,onWheel:function(e){e.preventDefault(),0!==e.deltaY&&P(e.deltaY)},onScroll:j},i.createElement("div",{className:"viewer-toolbar-left",ref:r},i.createElement(Ae.A,{placement:"bottom",title:"Reset to initial settings",trigger:["focus","hover"]},i.createElement(Pe.Ay,{className:"ant-btn-icon-only btn-borderless",onClick:e.resetToSavedViewerState},i.createElement(Zn.A,null),i.createElement("span",{style:tr},"Reset to initial settings")))),i.createElement("div",{className:"viewer-toolbar-center",ref:l},T&&i.createElement("div",{className:"viewer-toolbar-group"},I.viewModeRadioButtons&&i.createElement(Kn,{mode:w,onViewModeChange:function(e){return C("viewMode",e)}}),I.resetCameraButton&&i.createElement(Ae.A,{placement:"bottom",title:"Reset camera"},i.createElement(Pe.Ay,{className:"ant-btn-icon-only btn-borderless",onClick:e.resetCamera},i.createElement(ht,{type:"resetView"}))),I.autoRotateButton&&i.createElement(Ae.A,{placement:"bottom",title:R},i.createElement(Pe.Ay,{className:k(S&&!M),disabled:M||g===c.G9.pathTrace,onClick:function(){return C("autorotate",!S)}},i.createElement(ht,{type:"turnTable"})))),I.fovCellSwitchControls&&e.hasCellId&&e.hasParentImage&&i.createElement("div",{className:"viewer-toolbar-group"},i.createElement(Yn.Ay.Group,{value:b,onChange:function(e){var t=e.target;return C("imageType",t.value)}},i.createElement(Yn.Ay.Button,{value:c.yj.segmentedCell},"Single cell"),i.createElement(Yn.Ay.Button,{value:c.yj.fullField},"Full field"))),i.createElement("div",{className:"viewer-toolbar-group"},i.createElement(Qn.A,{className:"select-render-setting",popupClassName:"viewer-toolbar-dropdown",value:g,onChange:function(e){return C("renderMode",e)},getPopupContainer:B},i.createElement(Qn.A.Option,{value:c.G9.volumetric,key:c.G9.volumetric},"Volumetric"),e.canPathTrace&&i.createElement(Qn.A.Option,{value:c.G9.pathTrace,key:c.G9.pathTrace,disabled:M},"Path trace"),i.createElement(Qn.A.Option,{value:c.G9.maxProject,key:c.G9.maxProject},"Max project"))),N&&i.createElement("div",{className:"viewer-toolbar-group"},I.showAxesButton&&i.createElement(Ae.A,{placement:"bottom",title:D},i.createElement(Pe.Ay,{className:k(O),onClick:function(){return C("showAxes",!O)}},i.createElement(ht,{type:"axes"}))),I.showBoundingBoxButton&&i.createElement(Ae.A,{placement:"bottom",title:L},i.createElement(Pe.Ay,{className:k(x),onClick:function(){return C("showBoundingBox",!x)}},i.createElement(ht,{type:"boundingBox"}))))),i.createElement("div",{className:"viewer-toolbar-right viewer-toolbar-group",ref:o},i.createElement(Ae.A,{placement:"bottom",title:"Download"},i.createElement(Xn,{cellDownloadHref:e.cellDownloadHref,fovDownloadHref:e.fovDownloadHref,hasFov:e.hasCellId&&e.hasParentImage})),i.createElement(Ae.A,{placement:"bottom",title:"Screenshot"},i.createElement(Pe.Ay,{className:"ant-btn-icon-only btn-borderless",onClick:e.downloadScreenshot},i.createElement(ht,{type:"camera"}))))),i.createElement("div",{className:"viewer-toolbar-scroll-right",style:{display:y?"flex":"none"},onClick:function(){return P(100)}},i.createElement(ht,{type:"closePanel",style:{fontSize:"12px"}})))};function rr(e){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(e)}function or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?or(Object(n),!0).forEach((function(t){ir(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):or(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ir(e,t,n){return(t=function(e){var t=function(e){if("object"!=rr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const cr=function(e){var t=e.index,n=e.view3d,o=e.image,a=e.version,l=(0,It.k)((function(e){return e.channelSettings[t]})),c=(0,E.Tk)(l),u=c.volumeEnabled,s=c.isosurfaceEnabled,f=c.isovalue,m=c.colorizeEnabled,p=c.colorizeAlpha,d=c.opacity,v=c.color,y=function(e,t){var n;(0,i.useEffect)((function(){if(o&&a>0)return e(o)}),[].concat(function(e){if(Array.isArray(e))return lr(e)}(n=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return lr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lr(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[o,a]))};(0,i.useEffect)((function(){o&&(n.setVolumeChannelEnabled(o,t,u),n.updateLuts(o))}),[o,u,t,n]),(0,i.useEffect)((function(){o&&n.setVolumeChannelOptions(o,t,{isosurfaceEnabled:s})}),[o,s,t,n]),y((function(e){return n.setVolumeChannelOptions(e,t,{isovalue:f})}),[f,t,n]),y((function(e){return n.setVolumeChannelOptions(e,t,{isosurfaceOpacity:d})}),[d,t,n]),y((function(e){n.setVolumeChannelOptions(e,t,{color:v}),n.updateLuts(e)}),[v,t,n]);var h=c.controlPoints,b=c.ramp,g=c.useControlPoints;return y((function(e){if(!(g&&h.length<2)){var o=e.getHistogram(t),a=function(e){return(new r.Sd).createFromControlPoints(e)}((g?h:w(b)).map((function(e){return ar(ar({},e),{},{x:o.findFractionalBinOfValue(e.x)})})));e.setLut(t,a),n.updateLuts(e)}}),[h,b,g,t,n]),y((function(e){if(m){var n=(new r.Sd).createLabelColors(e.getHistogram(t));e.setColorPalette(t,n.lut)}}),[m,t,n]),y((function(e){e.setColorPaletteAlpha(t,m?p:0),n.updateLuts(e)}),[m,p,t,n]),null};function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(n),!0).forEach((function(t){mr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mr(e,t,n){return(t=function(e){var t=function(e){if("object"!=ur(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ur(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ur(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||dr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(e,t){if(e){if("string"==typeof e)return vr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vr(e,t):void 0}}function vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var yr=o.A.Sider,hr=o.A.Content,br={alphaMaskSlider:!0,autoRotateButton:!0,axisClipSliders:!0,brightnessSlider:!0,backgroundColorPicker:!0,boundingBoxColorPicker:!0,colorPresetsDropdown:!0,densitySlider:!0,levelsSliders:!0,interpolationControl:!0,saveSurfaceButtons:!0,fovCellSwitchControls:!0,viewModeRadioButtons:!0,resetCameraButton:!0,showAxesButton:!0,showBoundingBoxButton:!0,metadataViewer:!0},gr={rawData:void 0,rawDims:void 0,imageUrl:"",parentImageUrl:"",appHeight:"100vh",visibleControls:br,viewerSettings:(0,l.$m)(),cellId:"",imageDownloadHref:"",parentImageDownloadHref:"",pixelSize:void 0,canvasMargin:"0 0 0 0",view3dRef:void 0,showError:void 0};const wr=function(e){var t,n,s,f,m,p,d,v,y;e=fr(fr({},gr),e);var h=(0,E.Tk)((0,E.Lt)("imageType")),w=(0,E.Tk)((0,E.Lt)("viewMode")),O=(0,E.Tk)((0,E.Lt)("scene")),x=(0,E.Tk)((0,E.Lt)("time")),C=(0,E.Tk)((0,E.Lt)("showAxes")),j=(0,E.Tk)((0,E.Lt)("channelSettings")),A=(0,E.Tk)((0,E.Lt)("changeChannelSetting")),P=(0,E.Tk)((0,E.Lt)("applyColorPresets")),I=(0,E.Tk)((0,E.Lt)("resetToSavedViewerState")),M=(0,i.useCallback)((function(){return I(e.viewerSettings,e.viewerChannelSettings)}),[I,e.viewerSettings,e.viewerChannelSettings]),D=(0,i.useRef)();if(e.viewerSettings&&!(0,a.isEqual)(e.viewerSettings,D.current)){for(var B=0,z=Object.keys(e.viewerSettings);B<z.length;B++){var F,V,H=z[B],G=e.viewerSettings[H],_=null!==(F=null===(V=D.current)||void 0===V?void 0:V[H])&&void 0!==F?F:void 0;void 0===G||(0,a.isEqual)(G,_)||E.Tk.getState().changeViewerSetting(H,G)}D.current=e.viewerSettings}var $=(0,S.Q)((function(){return new r.Pg}));void 0!==e.view3dRef&&(e.view3dRef.current=$);var W=pr((0,$n.w)(),2),Z=W[0],Y=W[1],Q=null!==(t=e.showError)&&void 0!==t?t:Y;(0,i.useEffect)((function(){return $.setLoadErrorHandler((function(e,t){return Q(t)})),function(){return $.setLoadErrorHandler(void 0)}}),[$,Q]);var X=(0,i.useRef)(""),q=(0,i.useRef)([]),K=e,J=K.imageUrl,ee=K.parentImageUrl,te=K.rawData,ne=K.rawDims,ae=(0,i.useMemo)((function(){if(te&&ne)return[{data:te,metadata:ne}];var e,t=h===c.yj.fullField&&void 0!==ee?ee:J;if((0,a.isEqual)(t,X.current))return q.current;X.current=t;var n=null!==(e=t.scenes)&&void 0!==e?e:[t];return q.current=n,n}),[J,ee,te,ne,h]),le=null===(n=e.viewerChannelSettings)||void 0===n?void 0:n.maskChannelName,ce=(0,i.useRef)([]),ue=(0,i.useRef)(void 0),se=e.onImageTitleChange,fe=(0,i.useCallback)((function(t){var n,r;if(null===(n=ue.current)||void 0===n||n.call(ue),null!==t){var o=E.Tk.getState().channelSettings,a=t.channelNames;ce.current=a.map((function(e,t){var n;return null!==(n=o[t])&&void 0!==n&&n.keepIntensityRange?ce.current[t]:void 0}));var i=E.Tk.getState().useDefaultViewerChannelSettings?(0,l.EB)():e.viewerChannelSettings,c=null===(r=t.imageInfo.channelColors)||void 0===r?void 0:r.map((function(e,t){if(void 0===i)return e;var n=(0,u.oj)(a[t],t,i);return void 0!==(null==n?void 0:n.color)?void 0:e}));Array.isArray(c)&&c.forEach((function(e,t){Array.isArray(e)&&t<a.length&&A(t,{color:e})})),$.addVolume(t,{channels:t.channelNames.map((function(e,t){var n,r=o.find((function(t){return t.name===e}));return r?{enabled:r.volumeEnabled,isosurfaceEnabled:r.isosurfaceEnabled,isovalue:r.isovalue,isosurfaceOpacity:r.opacity,color:null!==(n=null==c?void 0:c[t])&&void 0!==n?n:r.color}:{}}))}),$.updateActiveChannels(t);var s=function(e,t){var n=[e.subscribe((0,E.Lt)("viewMode"),(function(e){t.setCameraMode(e),t.resize(null)}),T),e.subscribe((0,E.Lt)("cameraState"),(function(e){e&&t.setCameraState(e)}),N),e.subscribe((0,E.Lt)("autorotate"),t.setAutoRotate.bind(t),T),e.subscribe((0,E.Lt)("showAxes"),t.setShowAxis.bind(t),T),e.subscribe((0,E.Lt)("backgroundColor"),(function(e){return t.setBackgroundColor(k(e))}),T),e.subscribe((0,E.Lt)("brightness"),(function(e){t.updateExposure(e/100)}),T)];return function(){return n.forEach((function(e){return e()}))}}(E.Tk,$),f=L(E.Tk,$,t);ue.current=function(){s(),f(),$.removeAllVolumes(),ue.current=void 0}}}),[e.viewerChannelSettings,$,A]),me=pr((0,i.useState)(void 0),2),pe=me[0],de=me[1],ye=(0,i.useCallback)((function(e,t){null==se||se(e.imageInfo.imageInfo.name),de(t)}),[se]),we=(0,i.useCallback)((function(t,n,r){var o=E.Tk.getState(),a=o.channelsToResetOnLoad,i=o.useDefaultViewerChannelSettings,c=o.channelSettings[n],s=i?(0,l.EB)():e.viewerChannelSettings,f=t.getChannel(n),m=!c||!c.controlPoints||!c.ramp,p=void 0!==ce.current[n],d=(null==c?void 0:c.keepIntensityRange)&&p;if(r&&!d||m||a.includes(n)){var v,y=b(t,n,s),h=y.ramp,w=y.controlPoints,S=t.channelNames[n],O=s&&(0,u.oj)(S,n,s),x=f.rawMin+(f.rawMax-f.rawMin)/2,C=null!==(v=null==O?void 0:O.isovalue)&&void 0!==v?v:x;A(n,{controlPoints:w,ramp:g(h),plotMin:f.rawMin,plotMax:f.rawMax,isovalue:C})}else A(n,{plotMin:Math.min(f.rawMin,c.plotMin),plotMax:Math.max(f.rawMax,c.plotMax)});ce.current[n]=[f.rawMin,f.rawMax],$.updateLuts(t),$.onVolumeData(t,[n]),t.channelNames[n]===le&&$.setVolumeChannelAsMask(t,n),t.isLoaded()&&$.updateActiveChannels(t)}),[$,A,le,e.viewerChannelSettings]),xe=(0,i.useCallback)((function(e){Q(e),null==se||se(void 0)}),[Q,se]),Ce=function(e,t){var n=(0,E.Tk)((0,E.Lt)("channelSettings")),o=(0,E.Tk)((0,E.Lt)("changeViewerSetting")),a=(0,E.Tk)((0,E.Lt)("replaceAllChannelSettings")),s=Oe(null==t?void 0:t.onError),f=Oe(null==t?void 0:t.onChannelLoaded),m=Oe(null==t?void 0:t.onChangeScene),p=Oe(null==t?void 0:t.onCreateImage),d=null==t?void 0:t.maskChannelName,v=ge((0,i.useState)(null),2),y=v[0],h=v[1],b=(0,S.Q)((function(){return new r.nO(l.Ci,l.Wv,l.D_)})),g=(0,i.useMemo)((function(){return new re(b,e)}),[b,e]),w=(0,S.Q)((function(){return new U})),O=ge((0,i.useState)(null),2),x=O[0],C=O[1];(0,i.useEffect)((function(){w.onPlayingAxisChanged=function(e){var t=null!==e;if(C(e),g.setPrefetchPriority(e?[l.N1[e]]:[]),g.syncMultichannelLoading(t),y){var n=y.imageInfo,r=n.volumeSize,o=n.subregionSize,a=t&&("t"===e||r[e]!==o[e]);y.updateRequiredData({scaleLevelBias:a?1:0})}}}),[g,w,y]);var j=ge((0,i.useState)([]),2),A=j[0],P=j[1],k=ge((0,S.G)(P,A),2),I=k[0],M=k[1],T=ge((0,i.useState)(!1),2),N=T[0],D=T[1],L=(0,i.useRef)(!0),B=(0,i.useMemo)((function(){if(N)return Se.ERROR;var e=A.reduce((function(e,t,r){var o=ge(e,2),a=o[0],i=o[1],l=n[r];if(l&&(l.volumeEnabled||l.isosurfaceEnabled||d===l.name)){var c=t>0;return[a&&c,i&&!c]}return[a,i]}),[!0,!0]),t=ge(e,2),r=t[0],o=t[1];return r&&L.current&&(L.current=!1),o?Se.REQUESTED:r?Se.LOADED:Se.LOADING}),[A,n,d,N]),z=(0,i.useCallback)((function(e){D(!1),M(I.current.map((function(t){return Math.min(t,e===Ee.SCENE?-1:0)})))}),[I,M]),F=(0,i.useCallback)((function(e){var t;throw D(!0),null===(t=s.current)||void 0===t||t.call(s,e),e}),[s]),V=ge((0,i.useState)({}),2),H=V[0],G=V[1],_=(0,i.useCallback)((function(e,t){var n,r=-1===I.current[t];null===(n=f.current)||void 0===n||n.call(f,e,t,r);var o=I.current.slice();o[t]=Math.max(o[t],0)+1,M(o),e.isLoaded()&&w.onImageLoaded()}),[I,f,w,M]);(0,i.useEffect)((function(){var e=E.Tk.getState().channelSettings;M(new Array(I.current.length).fill(-1)),D(!1),L.current=!0;var n=function(n){var r=E.Tk.getState().useDefaultViewerChannelSettings?(0,l.EB)():null==t?void 0:t.viewerChannelSettings,o=(0,u.zK)(n,r);G(o);var i=n.map((function(t,n){var o,a=(0,l.iz)(n);return he(he({},null!==(o=e[n])&&void 0!==o?o:(0,oe.uO)(t,n,a,r)),{},{name:t})}));return a(i),i},i=function(){var e,a=(e=ie().mark((function e(){var a,i,u,s,f,d,v,y,b,S,O,x,C,j,A,P,k;return ie().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=E.Tk.getState().scene,u=E.Tk.getState().time,(s=new r.wK).time=u,e.next=6,g.createVolume(i,s,_).catch(F);case 6:f=e.sent,d=f.imageInfo.channelNames,v=n(d),M(new Array(d.length).fill(-1)),h(f),null===(a=p.current)||void 0===a||a.call(p,f),w.stepAxis=function(e){var t=E.Tk.getState().time,n=E.Tk.getState().slice;if("t"===e)o("time",(t+1)%f.imageInfo.times);else{var r=f.imageInfo.volumeSize[e],a=n[e]*r;o("slice",he(he({},n),{},be({},e,(a+1)%r/r)))}},w.getVolumeIsLoaded=f.isLoaded.bind(f),(y=new r.wK).time=u,b=v?v.map((function(e,t){return e.volumeEnabled?t:-1})).filter((function(e){return e>=0})):[],S=E.Tk.getState(),O=S.useDefaultViewerChannelSettings,x=O?(0,l.EB)():null==t?void 0:t.viewerChannelSettings,(C=null==x?void 0:x.maskChannelName)&&(j=d.indexOf(C))>=0&&!b.includes(j)&&b.push(j),y.channels=b,A=E.Tk.getState().viewMode,P=E.Tk.getState().slice,A===c.nE.xy&&(y.subregion=new R.NRn(new R.Pq0(0,0,P.z),new R.Pq0(1,1,P.z))),k=m.current,g.loadScene(i,f,y,{onCreateScene:k}).catch(F);case 27:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ve(a,r,o,i,l,"next",e)}function l(e){ve(a,r,o,i,l,"throw",e)}i(void 0)}))});return function(){return a.apply(this,arguments)}}();i()}),[g,F,p,m,f,I,M,w,z,_,o,a,null==t?void 0:t.viewerChannelSettings]);var $=(0,i.useCallback)((function(e,t){y&&!L.current&&(e.setTime(y,t).catch(F),z(Ee.TIME))}),[y,F,z,L]),W=(0,i.useCallback)((function(e){if(y&&!L.current){var t=m.current;g.loadScene(e,y,void 0,{onCreateScene:t}).catch(F),z(Ee.SCENE)}}),[y,F,g,z,L,m]);return(0,i.useMemo)((function(){return{image:y,channelVersions:A,imageLoadStatus:B,setTime:$,setScene:W,playControls:w,playingAxis:x,channelGroupedByType:H}}),[y,A,B,$,W,w,x,H])}(ae,{viewerChannelSettings:e.viewerChannelSettings,onCreateImage:fe,onChannelLoaded:we,onChangeScene:ye,onError:xe,maskChannelName:le}),je=Ce.image,Ae=Ce.setTime,Pe=Ce.setScene,ke=e.rawData&&e.rawDims?1:null!==(s=null===(f=e.imageUrl.scenes)||void 0===f?void 0:f.length)&&void 0!==s?s:1,Ie=null!==(m=null==je?void 0:je.imageInfo.volumeSize)&&void 0!==m?m:{x:1,y:1,z:1},Me=null!==(p=null==je?void 0:je.imageInfo.subregionSize)&&void 0!==p?p:{x:0,y:0,z:0},Te=null!==(d=null==je?void 0:je.imageInfo.times)&&void 0!==d?d:1,Ne=pr((0,i.useState)((function(){return window.innerWidth<l.lV})),2),De=Ne[0],Le=Ne[1],Re=pr((0,i.useState)(!1),2),Be=Re[0],ze=Re[1],Fe=pr((0,i.useState)(!0),2),Ve=Fe[0],Ue=Fe[1],He=(0,i.useRef)(0),Ge=(0,i.useCallback)((function(e,t){je&&$.saveChannelIsosurface(je,e,t)}),[je,$]),_e=(0,i.useCallback)((function(){$.capture((function(e){var t=document.createElement("a");t.href=e,t.download="screenshot.png",t.click()}))}),[$]),$e=e.metadataFormatter,We=(0,i.useMemo)((function(){var t=null==je?void 0:je.imageMetadata;t&&$e&&(t=$e(t));var n,r,o=e.metadata;return n=Array.isArray(o)?o.length>=ke&&void 0!==pe?o[pe]:o[0]:o,t&&Object.keys(t).length>0?fr({Image:t},n):null!==(r=n)&&void 0!==r?r:{}}),[e.metadata,$e,je,pe,ke]);(0,i.useEffect)((function(){var e=Te>1,t=ke>1,n=w===c.nE.threeD;!function(e,t,n,r,o){var a=l.lI[1],i=pr(l.UB,2),c=i[0],u=i[1];if(t){var s=(n&&r&&o?l.uR:l.CB)-40;a+=s,u+=s}n&&(c+=120,e.setShowTimestepIndicator(!0)),e.setAxisPosition(l.lI[0],a),e.setTimestepIndicatorPosition(l.UB[0],u),e.setScaleBarPosition(c,u)}($,Ve,e,t,n),Ve&&($.setShowScaleBar(!1),$.setShowTimestepIndicator(!1),$.setShowAxis(!1),window.clearTimeout(He.current),He.current=window.setTimeout((function(){$.setShowScaleBar(!0),$.setShowTimestepIndicator(!0),C&&$.setShowAxis(!0)}),300))}),[$,Te,ke,w,C,Ve]),(0,i.useEffect)((function(){var e=(0,a.debounce)((function(){window.innerWidth<l.lV?Be||(Le(!0),ze(!0)):ze(!1)}),500);return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[Be]);var Ze=e.onControlPanelToggle;(0,i.useEffect)((function(){return Ze&&Ze(De)}),[De,Ze]),(0,i.useEffect)((function(){window.setTimeout((function(){window.dispatchEvent(new Event("resize"))}),200)}),[De]);var Ye=function(e,t){var n;(0,i.useEffect)((function(){if(je&&Ce.imageLoadStatus===Se.LOADED)return e(je)}),[].concat(function(e){if(Array.isArray(e))return vr(e)}(n=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||dr(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[je,Ce.imageLoadStatus]))};Ye((function(t){for(var n=E.Tk.getState(),r=n.channelsToReset,o=n.onResetChannel,a=n.useDefaultViewerChannelSettings?(0,l.EB)():e.viewerChannelSettings,i=0;i<j.length;i++)if(r.includes(i)){var c=b(t,i,a),u=c.ramp,s=c.controlPoints;A(i,{controlPoints:s,ramp:g(u)}),o(i)}}),[A,j,e.viewerChannelSettings]),(0,i.useEffect)((function(){return Ae($,x)}),[$,x,Ae]),(0,i.useEffect)((function(){return Pe(O)}),[O,Pe]),Ye((function(t){var n;return $.setVolumeTranslation(t,(null===(n=e.transform)||void 0===n?void 0:n.translation)||[0,0,0])}),[null===(v=e.transform)||void 0===v?void 0:v.translation,$]),Ye((function(t){var n;return $.setVolumeRotation(t,(null===(n=e.transform)||void 0===n?void 0:n.rotation)||[0,0,0])}),[null===(y=e.transform)||void 0===y?void 0:y.rotation,$]);var Qe=(0,i.useMemo)((function(){return fr(fr({},br),e.visibleControls)}),[e.visibleControls]),Xe=(0,i.useMemo)((function(){return je?je.imageInfo.physicalPixelSize.toArray():[1,1,1]}),[je]),qe=(0,i.useMemo)((function(){return $.resetCamera.bind($)}),[$]);return i.createElement(Wn.A,null,Z,i.createElement(o.A,{className:"cell-viewer-app",style:{height:e.appHeight}},j.map((function(e,t){var n=e.name;return i.createElement(cr,{key:"".concat(t,"_").concat(n),index:t,view3d:$,image:je,version:Ce.channelVersions[t]})})),i.createElement(yr,{className:"control-panel-holder",collapsible:!0,defaultCollapsed:!1,collapsedWidth:50,trigger:null,collapsed:De,width:500},i.createElement(_n,{visibleControls:Qe,collapsed:De,imageName:null==je?void 0:je.name,hasImage:!!je,pixelSize:Xe,channelDataChannels:null==je?void 0:je.channels,channelGroupedByType:Ce.channelGroupedByType,setCollapsed:Le,saveIsosurface:Ge,onApplyColorPresets:P,viewerChannelSettings:e.viewerChannelSettings,metadata:We})),i.createElement(o.A,{className:"cell-viewer-wrapper",style:{margin:e.canvasMargin}},i.createElement(hr,null,i.createElement(nr,{fovDownloadHref:e.parentImageDownloadHref,cellDownloadHref:e.imageDownloadHref,hasParentImage:!!e.parentImageUrl,hasCellId:!!e.cellId,canPathTrace:!!$&&$.hasWebGL2(),resetCamera:qe,downloadScreenshot:_e,resetToSavedViewerState:M,visibleControls:Qe}),i.createElement(xt,{view3d:$,image:je,loadingImage:Ce.imageLoadStatus===Se.REQUESTED,numSlices:Ie,numSlicesLoaded:Me,numTimesteps:Te,numScenes:ke,playControls:Ce.playControls,playingAxis:Ce.playingAxis,appHeight:e.appHeight,visibleControls:Qe,clippingPanelOpen:Ve,onClippingPanelOpenChange:Ue})))))};var Sr=n(5870),Er=n(3668)},1408(e,t,n){"use strict";n.d(t,{A:()=>g});var r,o=n(4604),a=n(6426),i=n(1917),l=n(6540),c=n(4976),u=n(4368),s=n(3301),f=n(1250);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(null,arguments)}var p=l.forwardRef((function(e,t){return l.createElement(i.Ay,m({},e,{ref:t,type:"primary"}),e.children)}));p.displayName="PrimaryButton";var d,v,y=(0,f.Ay)(p)(r||(d=["\n  &&& {\n    background-color: var(--color-button-secondary-bg);\n    border: 1px solid var(--color-button-secondary-outline);\n    color: var(--color-button-secondary-text);\n  }\n"],v||(v=d.slice(0)),r=Object.freeze(Object.defineProperties(d,{raw:{value:Object.freeze(v)}}))));function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(){var e=h((0,l.useState)(),2),t=e[0],n=e[1],r=l.useRef(null),f=h((0,l.useState)(!1),2),m=f[0],p=f[1],d=[{key:"github",label:l.createElement(c.N_,{to:"https://github.com/allen-cell-animated/vole-app",target:"_blank",rel:"noreferrer noopener"},"Visit GitHub repository")},{key:"github-issue",label:l.createElement(c.N_,{to:"https://github.com/allen-cell-animated/vole-app/issues/new/choose",target:"_blank",rel:"noreferrer noopener"},"Report issue via GitHub")},{key:"forum",label:l.createElement(c.N_,{to:"https://forum.allencell.org/c/software-code/11",target:"_blank",rel:"noreferrer noopener"},"Allen Cell Discussion Forum")},{key:"version",label:"Version info",onClick:function(){p(!0)}}];(0,l.useEffect)((function(){n(r.current)}),[]);var v=null!==t?function(){return t}:void 0;return l.createElement("div",{ref:r},l.createElement(o.A,{menu:{items:d},getPopupContainer:v,trigger:["click"]},l.createElement(y,null,l.createElement(s.eJ,{$gap:6},"Help ",l.createElement(u.en,null)))),l.createElement(a.A,{open:m,title:"Version info",getContainer:v,onCancel:function(){return p(!1)},footer:l.createElement(i.Ay,{onClick:function(){return p(!1)}},"Close")},l.createElement(s.yY,{$gap:0},l.createElement("p",{style:{margin:0}},"Vol-E App v","3.1.1"),l.createElement("p",{style:{margin:0}},"Vol-E Core package v","4.6.4"))))}},9768(e,t,n){"use strict";n.d(t,{A:()=>T});var r=n(7028),o=n(1917),a=n(6426),i=n(7457),l=n(5929),c=n(6540),u=n(1250),s=n(8486);function f(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var d,v,y=n(9898),h=n(3301);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return(t=function(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var O,x={startCharacters:3,endCharacters:35},C=u.Ay.div(d||(d=E(["\n  display: flex;\n  flex-direction: row;\n  vertical-align: bottom;\n  white-space: nowrap;\n\n  ","\n"])),(function(e){return(0,u.AH)(v||(v=E(["\n      --startWidth: calc(1em * "," * ",");\n      --endWidth: calc(1em * "," * ",");\n\n      & span {\n        display: inline-block;\n        vertical-align: bottom;\n        white-space: nowrap;\n        overflow: hidden;\n      }\n\n      & span:first-child {\n        max-width: calc(100% - var(--endWidth));\n        min-width: var(--startWidth);\n        text-overflow: ellipsis;\n        overflow: hidden;\n      }\n\n      & span:last-child {\n        max-width: calc(100% - var(--startWidth));\n        direction: rtl;\n        z-index: 800;\n      }\n    "])),e.$startChars+3,.5,e.$endChars,.5)}));function j(e){var t=w(w({},x),e),n=Math.max(0,t.startCharacters),r=Math.max(0,t.endCharacters);t.text.length<=n+r&&(r=t.text.length-n);var o=Math.max(0,t.text.length-r),a=t.text.slice(0,o),i=t.text.slice(o);return c.createElement(C,{$startChars:n,$endChars:r,"aria-label":t.text,title:t.text},c.createElement("span",null,a),c.createElement("span",null,"",i))}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var k,I,M=u.Ay.div(O||(k=["\n  // Get the dropdown to size itself based on the webpage width, but resize itself to match the\n  // input area (~100vw - 100px of padding) when the webpage is very narrow\n  .ant-select-dropdown {\n    // TODO: Size to max-content so there isn't extra dead space past the end of the current items.\n    // Setting width to max-content directly causes the dropdown to collapse to a width of\n    // 0 pixels when more than 8 items are present and scrolling becomes enabled.\n    width: 100% !important;\n    max-width: calc(max(50vw, min(400px, 100vw - 100px)));\n  }\n"],I||(I=k.slice(0)),O=Object.freeze(Object.defineProperties(k,{raw:{value:Object.freeze(I)}}))));function T(e){var t=A((0,c.useState)(!1),2),n=t[0],u=t[1],p=A((0,c.useState)(""),2),d=p[0],v=p[1],b=A((0,c.useState)(""),2),g=b[0],w=b[1],S=A(function(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,s.Mj)("WEBSITE_3D_CELL_VIEWER.recentDatasets",[]),2),t=e[0],n=e[1],r=(0,c.useMemo)((function(){return t.filter((function(e){var t=e.url,n=e.label;return"string"==typeof t&&"string"==typeof n}))}),[t]);r.length!==t.length&&n(r);var o=(0,c.useCallback)((function(e){if(null!==r){var t=r.findIndex((function(t){return t.url===e.url}));n(-1===t?[e].concat(f(r.slice(0,99))):[e].concat(f(r.slice(0,t)),f(r.slice(t+1))))}else n([e])}),[r,n]);return[r||[],o]}(),2),E=S[0],O=S[1],x=(0,c.useRef)(null),C=function(e){e&&(v(""),w("")),u(e)},P=(0,c.useMemo)((function(){return new l.A(E,{keys:["label"],isCaseSensitive:!1,shouldSort:!0,ignoreLocation:!0,findAllMatches:!0})}),[E]),k=(0,c.useMemo)((function(){return(""===d?E.slice(0,20):P.search(d).slice(0,20).map((function(e){return e.item}))).map((function(e){return{label:c.createElement(j,{text:e.label}),value:e.url}}))}),[d,P,E]),I=x.current?function(){return x.current}:void 0;return c.createElement(M,{ref:x},c.createElement(o.Ay,{type:"link",onClick:function(){return C(!n)}},c.createElement(r.A,null),"Load"),c.createElement(a.A,{open:n,title:"Load",onCancel:function(){return C(!1)},getContainer:x.current||void 0,okButtonProps:{},footer:c.createElement(o.Ay,{type:"default",onClick:function(){return C(!1)}},"Cancel"),destroyOnClose:!0},c.createElement("p",{style:{fontSize:"16px"}},"Provide the URL to load your OME-Zarr or OME-TIFF* data."),c.createElement("p",{style:{fontSize:"12px"}},c.createElement("i",null,"*Note: this tool is intended for OME-Zarr use. Large ","(> 100 MB)"," OME-TIFF files are not supported.")),c.createElement(h.Ye,{$gap:6},c.createElement(i.A,{value:d,onChange:function(e){return v(e)},onSelect:v,style:{width:"100%"},allowClear:!0,options:k,getPopupContainer:I,placeholder:"Enter a URL...",autoFocus:!0}),c.createElement(o.Ay,{type:"primary",onClick:function(){var t=d.trim();if((0,y.A)(t)){var n={imageUrl:t,imageDownloadHref:t,cellId:"1",parentImageUrl:"",parentImageDownloadHref:"",viewerChannelSettings:{groups:[{name:"Channels",channels:[{match:[0,1,2],enabled:!0},{match:"(.+)",enabled:!1}]}]}};e.onLoad(n),O({url:d,label:d}),C(!1)}else w("Please enter a valid URL, starting with https://, s3://, or gs://.")}},"Load")),""!==g&&c.createElement("p",{style:{color:"var(--color-text-error)"}},g)))}},8625(){},6504(){},6580(){}}]);
//# sourceMappingURL=727.bundle.js.map