{"version":3,"file":"727.bundle.js","mappings":"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","sources":["webpack://@aics/vole-app/./src/aics-image-viewer/components/ErrorAlert/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/shared/constants.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/enums.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/hooks.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/storage.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/datatypes.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/firebase/index.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/math.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/urlParsing.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/viewerChannelSettings.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/viewerState.ts","webpack://@aics/vole-app/./src/aics-image-viewer/state/util.ts","webpack://@aics/vole-app/./src/aics-image-viewer/state/reset.ts","webpack://@aics/vole-app/./src/aics-image-viewer/state/store.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/controlPointsToLut.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/types.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/colorRepresentations.ts","webpack://@aics/vole-app/./src/aics-image-viewer/state/subscribers.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/sliderValuesToImageValues.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/playControls.ts","webpack://@aics/vole-app/./src/aics-image-viewer/shared/utils/sceneStore.ts","webpack://@aics/vole-app/./src/aics-image-viewer/components/useVolume.ts","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/NumericInput/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/SmarterSlider.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/AxisClipSliders/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/turnTable.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/index.ts","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/axes.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/boundingBox.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/camera.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/channels.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/closePanel.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/download.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/dropdownArrow.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/metadata.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/preferences.svg","webpack://@aics/vole-app/./src/aics-image-viewer/assets/icons/resetView.svg","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/ViewerIcon.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/BottomPanel/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/CellViewerCanvasWrapper/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ColorPicker.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/SliderRow/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/TfEditor/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ChannelsWidgetRow/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/shared/SharedCheckBox.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ChannelsWidget.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/CustomizeWidget.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/GlobalVolumeControls.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/MetadataViewer/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/ControlPanel/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/Toolbar/DownloadButton.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/Toolbar/ViewModeRadioButtons.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/Toolbar/index.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/App/ChannelUpdater.tsx","webpack://@aics/vole-app/./src/aics-image-viewer/components/App/index.tsx","webpack://@aics/vole-app/./website/components/Buttons/index.tsx","webpack://@aics/vole-app/./website/components/HelpDropdown.tsx","webpack://@aics/vole-app/./website/utils/react_utils.ts","webpack://@aics/vole-app/./website/components/MiddleTruncatedText.tsx","webpack://@aics/vole-app/./website/components/Modals/LoadModal.tsx"],"sourcesContent":["import { type VolumeLoadError, VolumeLoadErrorType } from \"@aics/vole-core\";\nimport { RightOutlined } from \"@ant-design/icons\";\nimport { Alert, Button } from \"antd\";\nimport React from \"react\";\n\nimport { useConstructor } from \"../../shared/utils/hooks\";\n\nimport \"./styles.css\";\n\nexport type ErrorAlertDescription = {\n  title: string;\n  description: React.ReactNode;\n};\n\nconst IssueLink: React.FC<React.PropsWithChildren<{ bug?: boolean }>> = ({ bug, children }) => (\n  <a\n    href={`https://github.com/allen-cell-animated/vole-app/issues/new${bug ? \"?template=bug_report.md\" : \"/choose\"}`}\n    target=\"_blank\"\n    rel=\"noreferrer noopener\"\n  >\n    {children}\n  </a>\n);\n\nconst UNKNOWN_ERROR_DESCRIPTION: React.ReactNode = (\n  <>\n    An unknown error occurred. Check the browser console (F12) for more details. If this looks like a bug,{\" \"}\n    <IssueLink bug>send us a bug report here</IssueLink>.\n  </>\n);\n\nconst ERROR_TYPE_DESCRIPTIONS: { [T in VolumeLoadErrorType]: React.ReactNode } = {\n  [VolumeLoadErrorType.UNKNOWN]: (\n    <>\n      An unknown error occurred while loading volume data. Check the browser console (F12) for more details. If this\n      looks like a bug, <IssueLink bug>send us a bug report here</IssueLink>.\n    </>\n  ),\n  [VolumeLoadErrorType.NOT_FOUND]: (\n    <>\n      The viewer was unable to find any volume data at the specified location. Check that the provided URL is correct\n      and try again.\n    </>\n  ),\n  [VolumeLoadErrorType.TOO_LARGE]: (\n    <>\n      No scale level is available for this volume which fits within our maximum GPU memory footprint. This maximum is\n      tuned to ensure compatibility with the majority of browsers. If you&apos;re trying to load your own OME-Zarr\n      dataset, you may be able to open this volume by including a lower scale level.\n    </>\n  ),\n  [VolumeLoadErrorType.LOAD_DATA_FAILED]: (\n    <>\n      The viewer was able to find a source of volume data at the specified location, but encountered an error while\n      trying to load it. Check that your dataset is complete and properly formatted. You can also check the browser\n      console (F12) for more details about this error. If it looks like a problem on our end,{\" \"}\n      <IssueLink bug>start a bug report here</IssueLink>.\n    </>\n  ),\n  [VolumeLoadErrorType.INVALID_METADATA]: (\n    <>\n      The viewer was unable to read all necessary information from this volume&apos;s metadata. Check that your\n      dataset&apos;s metadata is complete and properly formatted. If you believe your data is valid and should be\n      supported by our viewer, let us know by <IssueLink>opening a GitHub issue</IssueLink>.\n    </>\n  ),\n  [VolumeLoadErrorType.INVALID_MULTI_SOURCE_ZARR]: (\n    <>\n      The viewer is currently configured to consolidate multiple OME-Zarr datasets into a single volume, but the\n      provided datasets can&apos;t all be matched up. Ensure that all dataset URLs are correct and that at least one\n      equivalently-sized scale level exists in all datasets.\n    </>\n  ),\n};\n\nconst getErrorTitle = (error: unknown): string =>\n  (error instanceof Error && error.toString?.()) ||\n  (typeof error === \"string\" && error) ||\n  (typeof error === \"object\" && error !== null && (error as ErrorAlertDescription).title) ||\n  \"Unknown error\";\n\nconst getErrorDescription = (error: unknown): React.ReactNode => {\n  const type: VolumeLoadErrorType | undefined = (error as VolumeLoadError).type;\n  if (!type) {\n    return (\n      (typeof error === \"object\" && error !== null && (error as ErrorAlertDescription).description) ||\n      UNKNOWN_ERROR_DESCRIPTION\n    );\n  }\n  return ERROR_TYPE_DESCRIPTIONS[type] ?? UNKNOWN_ERROR_DESCRIPTION;\n};\n\nexport type ErrorAlertProps = {\n  errors: unknown;\n  /** The number of times we've seen an error of the type that is currently being displayed before */\n  firstErrorCount?: number;\n  afterClose?: () => void;\n  onSkipError?: () => void;\n};\n\nconst ErrorAlert: React.FC<ErrorAlertProps> = ({ errors, firstErrorCount = 0, afterClose, onSkipError }) => {\n  const [showDetails, setShowDetails] = React.useState(false);\n  const [errorsSeenCount, setErrorsSeenCount] = React.useState(0);\n  const error = Array.isArray(errors) ? errors[0] : errors;\n\n  const errorMessage = (\n    <>\n      <div>\n        {getErrorTitle(error) + (firstErrorCount > 1 ? ` (${firstErrorCount})` : \"\")}{\" \"}\n        <Button type=\"text\" onClick={() => setShowDetails(!showDetails)}>\n          {showDetails ? \"Show less info\" : \"Show more info\"}\n        </Button>\n      </div>\n      <div style={{ display: showDetails ? undefined : \"none\" }}>{getErrorDescription(error)}</div>\n    </>\n  );\n\n  const skipErrorButton = Array.isArray(errors) && errors.length > 1 && (\n    <Button\n      type=\"text\"\n      onClick={() => {\n        setErrorsSeenCount((count) => count + 1);\n        onSkipError?.();\n      }}\n    >\n      Error {errorsSeenCount + 1} of {errors.length + errorsSeenCount} <RightOutlined />\n    </Button>\n  );\n\n  return (\n    <Alert\n      showIcon\n      type=\"error\"\n      className=\"load-error-alert\"\n      message={errorMessage}\n      closable\n      afterClose={() => {\n        setErrorsSeenCount(0);\n        afterClose?.();\n      }}\n      action={skipErrorButton}\n    />\n  );\n};\n\nexport const useErrorAlert = (): [React.ReactNode, (error: unknown) => void] => {\n  const [errorList, setErrorList] = React.useState<unknown[]>([]);\n  // Keep track of which errors have been seen and how many times\n  const seenErrors = useConstructor(() => new Map<string, number>());\n  const [errorCounts, setErrorCounts] = React.useState<number[]>([]);\n\n  const addError = React.useCallback(\n    (error: unknown) => {\n      const errorTitle = getErrorTitle(error);\n      console.error(error instanceof Error ? error : errorTitle);\n      const errorSeenCount = (seenErrors.get(errorTitle) ?? 0) + 1;\n\n      setErrorList((prev) => [...prev, error]);\n      setErrorCounts((prev) => [...prev, errorSeenCount]);\n      seenErrors.set(errorTitle, errorSeenCount);\n    },\n    [seenErrors]\n  );\n\n  const onSkipError = React.useCallback(() => {\n    setErrorList((prev) => prev.slice(1));\n    setErrorCounts((prev) => prev.slice(1));\n  }, []);\n\n  const afterClose = React.useCallback(() => {\n    setErrorList([]);\n    setErrorCounts([]);\n  }, []);\n\n  const errCount = errorCounts[0];\n  const alertComponent = errorList.length > 0 && (\n    <ErrorAlert errors={errorList} firstErrorCount={errCount} onSkipError={onSkipError} afterClose={afterClose} />\n  );\n  return [alertComponent, addError];\n};\n\nexport default ErrorAlert;\n","import { type CameraState, type Channel, PrefetchDirection } from \"@aics/vole-core\";\n\nimport type { ChannelState, ViewerState } from \"../state/types\";\nimport { ImageType, RenderMode, ViewMode } from \"./enums\";\nimport type { AxisName } from \"./types\";\nimport type { ColorArray } from \"./utils/colorRepresentations\";\nimport type { ViewerChannelSettings } from \"./utils/viewerChannelSettings\";\n\n// Add all exported constants here to prevent circular dependencies\nexport const // Control panel will automatically close if viewport is less than this width\n  CONTROL_PANEL_CLOSE_WIDTH = 970,\n  CLIPPING_PANEL_HEIGHT_DEFAULT = 200,\n  CLIPPING_PANEL_HEIGHT_TALL = 235,\n  BACKGROUND_COLOR_DEFAULT: ColorArray = [0, 0, 0],\n  BOUNDING_BOX_COLOR_DEFAULT: ColorArray = [255, 255, 255],\n  AXIS_MARGIN_DEFAULT: [number, number] = [16, 16],\n  SCALE_BAR_MARGIN_DEFAULT: [number, number] = [120, 12],\n  // These settings were chosen to work well with most AICS microscopy pipeline images.\n  // These numbers mean: remap the bottom LUT_MIN_PERCENTILE fraction of pixels to zero intensity,\n  // and linearly increase intensity up to the LUT_MAX_PERCENTILE fraction of pixels.\n  LUT_MIN_PERCENTILE = 0.5,\n  LUT_MAX_PERCENTILE = 0.983,\n  ALPHA_MASK_SLIDER_DEFAULT = 0,\n  BRIGHTNESS_SLIDER_LEVEL_DEFAULT = 70,\n  DENSITY_SLIDER_LEVEL_DEFAULT = 50,\n  LEVELS_SLIDER_DEFAULT: ColorArray = [35.0, 140.0, 255.0],\n  INTERPOLATION_ENABLED_DEFAULT = true,\n  OTHER_CHANNEL_KEY = \"Other\",\n  SINGLE_GROUP_CHANNEL_KEY = \"Channels\";\n\nexport const TFEDITOR_DEFAULT_COLOR: ColorArray = [255, 255, 255];\nexport const TFEDITOR_MAX_BIN = 255;\n\nexport const CACHE_MAX_SIZE = 1_000_000_000;\nexport const QUEUE_MAX_SIZE = 10;\nexport const QUEUE_MAX_LOW_PRIORITY_SIZE = 4;\n\n/** Maps an axis the user can \"play\" through to the direction to prefetch while playing that axis */\nexport const AXIS_TO_LOADER_PRIORITY: Record<AxisName | \"t\", PrefetchDirection> = {\n  t: PrefetchDirection.T_PLUS,\n  z: PrefetchDirection.Z_PLUS,\n  y: PrefetchDirection.Y_PLUS,\n  x: PrefetchDirection.X_PLUS,\n};\n\n/** Maps channel data types to their minimum and maximum values */\nexport const DTYPE_RANGE: { [T in Channel[\"dtype\"]]: { min: number; max: number } } = {\n  int8: { min: -Math.pow(2, 7), max: Math.pow(2, 7) - 1 },\n  int16: { min: -Math.pow(2, 15), max: Math.pow(2, 15) - 1 },\n  int32: { min: -Math.pow(2, 31), max: Math.pow(2, 31) - 1 },\n  uint8: { min: 0, max: Math.pow(2, 8) - 1 },\n  uint16: { min: 0, max: Math.pow(2, 16) - 1 },\n  uint32: { min: 0, max: Math.pow(2, 32) - 1 },\n  // These are obviously not the actual min and max representable values for floats, but the actual ones (`-Infinity`\n  // and `Infinity`) would give us nonsense. These may also produce nonsense, but these types should be rare anyways.\n  float32: { min: 0, max: Math.pow(2, 8) - 1 },\n  float64: { min: 0, max: Math.pow(2, 8) - 1 },\n};\n\nexport const PRESET_COLORS_1: ColorArray[] = [\n  [190, 68, 171],\n  [189, 211, 75],\n  [61, 155, 169],\n  [128, 128, 128],\n  [255, 255, 255],\n  [239, 27, 45],\n  [238, 77, 245],\n  [96, 255, 255],\n];\nexport const PRESET_COLORS_2: ColorArray[] = [\n  [128, 0, 0],\n  [0, 128, 0],\n  [0, 0, 128],\n  [32, 32, 32],\n  [255, 255, 0],\n  [255, 0, 255],\n  [0, 255, 0],\n  [0, 0, 255],\n];\n\nexport const PRESET_COLORS_3: ColorArray[] = [\n  [128, 0, 128],\n  [128, 128, 128],\n  [0, 128, 128],\n  [128, 128, 0],\n  [255, 255, 255],\n  [255, 0, 0],\n  [255, 0, 255],\n  [0, 255, 255],\n];\n\nexport const PRESET_COLORS_0: ColorArray[] = [\n  [226, 205, 179],\n  [111, 186, 17],\n  [141, 163, 192],\n  [245, 241, 203],\n  [224, 227, 209],\n  [221, 155, 245],\n  [227, 244, 245],\n  [255, 98, 0],\n  [247, 219, 120],\n];\n\nexport const PRESET_COLOR_MAP = Object.freeze([\n  {\n    colors: PRESET_COLORS_0,\n    name: \"Default\",\n  },\n  {\n    colors: PRESET_COLORS_1,\n    name: \"Thumbnail colors\",\n  },\n  {\n    colors: PRESET_COLORS_2,\n    name: \"RGB colors\",\n  },\n  {\n    colors: PRESET_COLORS_3,\n    name: \"White structure\",\n  },\n]);\n\n/** Allows the 3D viewer to apply the default camera settings for the view mode. */\nconst USE_VIEW_MODE_DEFAULT_CAMERA = undefined;\n\nconst viewModeToDefaultCameraPosition: Record<ViewMode, [number, number, number]> = {\n  [ViewMode.threeD]: [0, 0, 5],\n  [ViewMode.xy]: [0, 0, 2],\n  [ViewMode.xz]: [0, 2, 0],\n  [ViewMode.yz]: [2, 0, 0],\n};\n\nconst viewModeToDefaultCameraUp: Record<ViewMode, [number, number, number]> = {\n  [ViewMode.threeD]: [0, 1, 0],\n  [ViewMode.xy]: [0, 1, 0],\n  [ViewMode.xz]: [0, 0, 1],\n  [ViewMode.yz]: [0, 0, 1],\n};\n\n/**\n * Reflects the default camera settings the 3D viewer uses on volume load.\n * These SHOULD NOT be changed; otherwise, existing shared links that don't specify the\n * camera settings will use the new defaults and may be in unexpected orientations or positions.\n */\nexport const getDefaultCameraState = (viewMode: ViewMode = ViewMode.threeD): CameraState => ({\n  // Default position varies by view mode\n  position: viewModeToDefaultCameraPosition[viewMode],\n  target: [0, 0, 0],\n  up: viewModeToDefaultCameraUp[viewMode],\n  fov: 20,\n  orthoScale: 0.5,\n});\n\nexport const getDefaultViewerChannelSettings = (): ViewerChannelSettings => ({\n  groups: [\n    {\n      name: \"Channels\",\n      channels: [\n        { match: [0, 1, 2], enabled: true },\n        { match: \"(.+)\", enabled: false },\n      ],\n    },\n  ],\n});\n\n/**\n * Returns the default viewer state as a new object.\n */\nexport const getDefaultViewerState = (): ViewerState => ({\n  viewMode: ViewMode.threeD, // \"XY\", \"XZ\", \"YZ\"\n  renderMode: RenderMode.volumetric, // \"pathtrace\", \"maxproject\"\n  imageType: ImageType.segmentedCell,\n  showAxes: false,\n  showBoundingBox: false,\n  backgroundColor: BACKGROUND_COLOR_DEFAULT,\n  boundingBoxColor: BOUNDING_BOX_COLOR_DEFAULT,\n  autorotate: false,\n  maskAlpha: ALPHA_MASK_SLIDER_DEFAULT,\n  brightness: BRIGHTNESS_SLIDER_LEVEL_DEFAULT,\n  density: DENSITY_SLIDER_LEVEL_DEFAULT,\n  levels: LEVELS_SLIDER_DEFAULT,\n  interpolationEnabled: INTERPOLATION_ENABLED_DEFAULT,\n  region: { x: [0, 1], y: [0, 1], z: [0, 1] },\n  slice: { x: 0.5, y: 0.5, z: 0.5 },\n  time: 0,\n  scene: 0,\n  // Do not override camera position, target, etc. by default;\n  // instead, let the viewer apply default camera settings based on the view mode.\n  // This prevents a bug where the camera's position and view mode are set to\n  // incompatible states and the viewport becomes blank.\n  cameraState: USE_VIEW_MODE_DEFAULT_CAMERA,\n});\n\nconst INIT_COLORS = PRESET_COLORS_0;\n\n/** Returns the default color for a channel, by its index. */\nexport function getDefaultChannelColor(channelIndex: number): ColorArray {\n  return INIT_COLORS[channelIndex % INIT_COLORS.length];\n}\n\n/**\n * Returns the default channel state as a new object. If an index is provided, uses the default\n * color preset for that index.\n * @param index Optional channel index to use for the color preset.\n * @returns a default ChannelState object.\n */\nexport const getDefaultChannelState = (index: number = 0): ChannelState => {\n  return {\n    name: \"\",\n    displayName: \"\",\n    volumeEnabled: false,\n    isosurfaceEnabled: false,\n    colorizeEnabled: false,\n    colorizeAlpha: 1.0,\n    isovalue: 128,\n    opacity: 1.0,\n    color: getDefaultChannelColor(index),\n    useControlPoints: false,\n    ramp: [0, TFEDITOR_MAX_BIN],\n    controlPoints: [\n      { x: 0, opacity: 0, color: [255, 255, 255] },\n      { x: 255, opacity: 1, color: [255, 255, 255] },\n    ],\n    plotMin: 0,\n    plotMax: TFEDITOR_MAX_BIN,\n    keepIntensityRange: false,\n  };\n};\n","export enum ViewMode {\n  threeD = \"3D\",\n  xy = \"XY\",\n  xz = \"XZ\",\n  yz = \"YZ\",\n}\n\nexport enum RenderMode {\n  volumetric = \"volumetric\",\n  maxProject = \"maxproject\",\n  pathTrace = \"pathtrace\",\n}\n\nexport enum ImageType {\n  segmentedCell = \"cell\",\n  fullField = \"fov\",\n}\n","import { type MutableRefObject, useCallback, useRef } from \"react\";\n\n/**\n * Wraps a setter function and keeps a ref updated to follow the set value. Useful for making the most up-to-date value\n * of some state accessible to a closure that might be called after the value is updated.\n */\n// TODO should this replace `useStateWithGetter`?\nexport function useRefWithSetter<T>(setter: (value: T) => void): [MutableRefObject<T | undefined>, (value: T) => void];\nexport function useRefWithSetter<T>(setter: (value: T) => void, init: T): [MutableRefObject<T>, (value: T) => void];\nexport function useRefWithSetter<T>(\n  setter: (value: T) => void,\n  init?: T\n): [MutableRefObject<T | undefined>, (value: T) => void] {\n  const value = useRef<T | undefined>(init);\n  const wrappedSetter = useCallback(\n    (newValue: T) => {\n      value.current = newValue;\n      setter(newValue);\n    },\n    [setter, value]\n  );\n  return [value, wrappedSetter];\n}\n\n/**\n * For objects which are persistent for the lifetime of the component, not\n * a member of state, and require a constructor to create. Wraps `useRef`.\n */\nexport function useConstructor<T>(constructor: () => T): T {\n  const value = useRef<T | null>(null);\n  if (value.current === null) {\n    value.current = constructor();\n  }\n  return value.current;\n}\n","import { mapKeys, mapValues } from \"lodash\";\n\nimport type { MetadataRecord } from \"../types\";\n\nconst QUEUE_KEY = \"GLOBAL_ENTRY_QUEUE\";\n\nconst enum StorageEntryType {\n  Scenes = \"scenes\",\n  Meta = \"meta\",\n}\n\nconst MAX_ENTRIES: { [K in StorageEntryType]: number } = {\n  scenes: 25,\n  meta: 1000,\n};\n\nconst sanitizeStorageKey = (key: string): string => (key.includes(\",\") ? encodeURIComponent(key) : key);\n\n/** `window.localStorage.setItem`, but returns `false` on quota exceeded instead of erroring */\nfunction safeSetItem(key: string, value: string): boolean {\n  try {\n    window.localStorage.setItem(key, value);\n    return true;\n  } catch (e) {\n    // `setItem` throws a `QuotaExceededError` when the browser won't let us put any more data in local storage\n    if (e instanceof DOMException && e.name === \"QuotaExceededError\") {\n      return false;\n    }\n    throw e;\n  }\n}\n\n/**\n * Wrapper for `window.localStorage.setItem` that accepts a `queue` of evictable storage keys, and attempts to safely\n * handle exceeding the storage quota by removing items off the back of the `queue` until space is available.\n *\n * Also, unlike `setItem`, this function can accept `value`s of type `string[]`. This allows `queue` to also be passed\n * into `value`, so that it can be written to storage *after* picking up any evictions that are made during the write.\n *\n * Returns `false` if `value` could not fit into storage even after removing everything from `queue`, `true` otherwise.\n */\nfunction setStorageItem(key: string, value: string | string[], queue: string[]): boolean {\n  const removedItems: [string, string][] = [];\n\n  while (!safeSetItem(key, Array.isArray(value) ? value.join(\",\") : value)) {\n    // can't fit `value` in the store; remove something off the back of `queue` and try again\n    const evictKey = queue.shift();\n\n    if (evictKey === undefined) {\n      // nothing left to remove means `value` is larger than the entire store\n      // give up on inserting it and try to put everything we removed back\n      for (const [key, value] of removedItems) {\n        if (safeSetItem(key, value)) {\n          queue.unshift(key);\n        }\n      }\n      return false;\n    }\n\n    const removedValue = window.localStorage.getItem(evictKey);\n    if (removedValue !== null) {\n      removedItems.push([evictKey, removedValue]);\n      window.localStorage.removeItem(evictKey);\n    }\n  }\n\n  return true;\n}\n\nconst getStorageQueue = (): string[] => window.localStorage.getItem(QUEUE_KEY)?.split(\",\") ?? [];\n/** If this function returns `false`, something serious has gone wrong and using local storage is likely impossible. */\nconst setStorageQueue = (queue: string[]): boolean => setStorageItem(QUEUE_KEY, queue, queue);\n\n/**\n * Writes a bundle of `entries` to local storage, all with an optional `entryType` for categorizing the data.\n *\n * Entries written with this function are tracked like a least-recently-used cache, and evicted when either:\n * - the size of local storage exceeds the browser's quota\n * - the number of entries of type `entryType` exceeds the maximum for that type\n *\n * Returns `true` if all entries fit in storage, or `false` if some did not.\n */\nfunction writeStorage(entries: Record<string, string>, entryType?: StorageEntryType): boolean {\n  const prevQueue = getStorageQueue();\n  const typePrefix = entryType ? `${entryType}@` : \"\";\n  const escapedEntries = mapKeys(entries, (_, key) => sanitizeStorageKey(key));\n\n  // filter keys we're currently inserting out of the queue (to be re-inserted at the front)\n  let index = 0;\n  const thisTypeIndexes: number[] = [];\n  const queue = prevQueue.filter((k) => {\n    if (k.startsWith(typePrefix)) {\n      if (k.slice(typePrefix.length) in escapedEntries) {\n        return false;\n      } else if (entryType !== undefined) {\n        // start saving the location of entries of this type, for enforcing the maximum entry count below\n        thisTypeIndexes.push(index);\n      }\n    }\n\n    index += 1;\n    return true;\n  });\n\n  // push new keys onto the end\n  for (const key of Object.keys(escapedEntries)) {\n    thisTypeIndexes.push(queue.length);\n    queue.push(typePrefix + key);\n  }\n\n  // enforce the maximum number of entries for this type (e.g. no more than 25 of type \"scenes\")\n  if (entryType !== undefined) {\n    const evictIndexes = thisTypeIndexes.slice(0, -MAX_ENTRIES[entryType]);\n    for (const index of evictIndexes.reverse()) {\n      let [evictKey] = queue.splice(index, 1);\n      window.localStorage.removeItem(evictKey);\n      delete escapedEntries[evictKey.slice(typePrefix.length)];\n    }\n  }\n\n  // write the new entries\n  const entryList = Object.entries(escapedEntries);\n  const firstKey = entryList.length < 2 ? undefined : typePrefix + entryList[0][0];\n  let allEntriesFit = true;\n\n  for (const [key, value] of Object.entries(escapedEntries)) {\n    const entryFits = setStorageItem(typePrefix + key, value, queue);\n    allEntriesFit = allEntriesFit && entryFits;\n  }\n\n  // TODO if the queue somehow doesn't fit, it's a much more serious problem than an individual entry.\n  //   Should that be communicated in the return type?\n  const queueFit = setStorageQueue(queue);\n  return allEntriesFit && queueFit && (firstKey === undefined || window.localStorage.getItem(firstKey) !== null);\n}\n\n/**\n * Writes a bundle of metadata records keyed by image URL to local storage.\n *\n * Returns `true` if all records fit into local storage, or `false` if at least one did not.\n */\nexport function writeMetadata(meta: Record<string, MetadataRecord>): boolean {\n  const stringMeta = mapValues(meta, (metaVal) => JSON.stringify(metaVal));\n  return writeStorage(stringMeta, StorageEntryType.Meta);\n}\n\n/**\n * Writes a scene `url` to local storage at the given `key`.\n *\n * Returns `false` if the entry did not fit in local storage, or `true` if it did.\n */\nexport function writeScenes(key: string, url: string): boolean {\n  return writeStorage({ [sanitizeStorageKey(key)]: url }, StorageEntryType.Scenes);\n}\n\nexport function readStoredMetadata(\n  scenes: (string | string[])[],\n  skipCacheUpdate: boolean = false\n): (MetadataRecord | undefined)[] {\n  const keySet = new Set<string>();\n  const result = scenes.map((scene) => {\n    if (Array.isArray(scene)) {\n      // can't handle multi-source scenes (yet)\n      return undefined;\n    }\n\n    const globalKey = `${StorageEntryType.Meta}@${sanitizeStorageKey(scene)}`;\n    const meta = window.localStorage.getItem(globalKey);\n    if (meta === null) {\n      return undefined;\n    }\n\n    keySet.add(globalKey);\n    return JSON.parse(meta) as MetadataRecord;\n  });\n\n  if (keySet.size > 0 && !skipCacheUpdate) {\n    const prevQueue = getStorageQueue();\n    const queue = prevQueue.filter((key) => !keySet.has(key));\n    queue.push(...keySet);\n    setStorageQueue(queue);\n  }\n\n  return result;\n}\n\nexport function readStoredScenes(key: string, skipCacheUpdate: boolean = false): string | undefined {\n  const globalKey = `${StorageEntryType.Scenes}@${sanitizeStorageKey(key)}`;\n  const result = window.localStorage.getItem(globalKey);\n\n  if (result === null) {\n    return undefined;\n  }\n\n  if (!skipCacheUpdate) {\n    const queue = getStorageQueue();\n    const entryIndex = queue.indexOf(globalKey);\n    if (entryIndex !== -1) {\n      queue.splice(entryIndex, 1);\n    }\n    queue.push(globalKey);\n    setStorageQueue(queue);\n  }\n\n  return result;\n}\n","import { isEqual } from \"lodash\";\n\n/**\n * Returns a (shallow) copy of an object with all properties that are\n * `undefined` removed.\n */\nexport function removeUndefinedProperties<T>(obj: T): Partial<T> {\n  const result: Partial<T> = {};\n  for (const key in obj) {\n    if (obj[key] !== undefined) {\n      result[key] = obj[key];\n    }\n  }\n  return result;\n}\n\n/**\n * Returns a copy of `obj` where all properties with values that match the properties of `match`\n * are removed. Matching is determined by deep equality (see `isDeepEqual()`).\n */\nexport function removeMatchingProperties<T extends Object>(obj: Partial<T>, match: T): Partial<T> {\n  const result: Partial<T> = {};\n  for (const key in obj) {\n    if (!isEqual(obj[key], match[key])) {\n      result[key] = obj[key];\n    }\n  }\n  return result;\n}\n","import type {\n  DocumentData,\n  DocumentReference,\n  DocumentSnapshot,\n  FirebaseFirestore,\n  QuerySnapshot,\n} from \"@firebase/firestore-types\";\n\n// TODO: These types are shared with Cell Feature Explorer. Can they be moved to\n// a shared package?\n\nexport interface DatasetMetaData {\n  name: string;\n  version: string;\n  datasets?: { [key: string]: DatasetMetaData };\n  id: string;\n  description: string;\n  image: string;\n  link?: string;\n  manifest?: string;\n  production?: boolean;\n  userData: {\n    isNew: boolean;\n    inReview: boolean;\n    totalTaggedStructures: number;\n    totalCells: number;\n    totalFOVs: number;\n  };\n}\nexport interface FileInfo {\n  CellId: string;\n  CellLineName: string;\n  FOVId: string;\n  structureProteinName: string;\n  fovThumbnailPath: string;\n  fovVolumeviewerPath: string;\n  thumbnailPath: string;\n  volumeviewerPath: string;\n}\n\ninterface ManifestDocumentData extends DocumentData {\n  featuresDataPath: string;\n  cellLineDataPath: string;\n  thumbnailRoot: string;\n  downloadRoot: string;\n  volumeViewerDataRoot: string;\n  featuresDisplayOrder: string[];\n  defaultXAxis: string;\n  defaultYAxis: string;\n  fileInfoPath: string;\n  featuresDataOrder: string[];\n  albumPath: string;\n  featureDefsPath: string;\n}\n\nfunction isDevOrStagingSite(host: string): boolean {\n  // first condition is for testing with no client\n  return !host || host.includes(\"localhost\") || host.includes(\"staging\") || host.includes(\"stg\");\n}\n\nclass FirebaseRequest {\n  private firestore: FirebaseFirestore;\n  private fileInfoPath: string;\n\n  // TODO: These properties are private and unused. Remove?\n  private collectionRef: DocumentReference;\n  private featuresDataPath: string;\n  private cellLineDataPath: string;\n  private thumbnailRoot: string;\n  private downloadRoot: string;\n  private volumeViewerDataRoot: string;\n  private featuresDisplayOrder: string[];\n  private datasetId: string;\n  private featuresDataOrder: string[];\n  private albumPath: string;\n  private featureDefsPath: string;\n\n  constructor(firestore: FirebaseFirestore) {\n    this.firestore = firestore;\n    this.featuresDataPath = \"\";\n    this.cellLineDataPath = \"\";\n    this.thumbnailRoot = \"\";\n    this.downloadRoot = \"\";\n    this.volumeViewerDataRoot = \"\";\n    this.featuresDisplayOrder = [];\n    this.fileInfoPath = \"\";\n    this.datasetId = \"\";\n    this.featuresDataOrder = [];\n    this.albumPath = \"\";\n    this.featureDefsPath = \"\";\n    this.collectionRef = firestore.collection(\"cfe-datasets\").doc(\"v1\");\n  }\n\n  private getDoc = (docPath: string): Promise<DocumentSnapshot<DocumentData>> => {\n    return this.firestore.doc(docPath).get();\n  };\n\n  public getAvailableDatasets = (): Promise<DatasetMetaData[]> => {\n    return this.firestore\n      .collection(\"dataset-descriptions\")\n      .get()\n      .then((snapShot: QuerySnapshot) => {\n        const datasets: DatasetMetaData[] = [];\n\n        snapShot.forEach((doc) => {\n          const metadata = doc.data() as DatasetMetaData;\n          /** if running the site in a local development env or on staging.cfe.allencell.org\n           * include all cards, otherwise, only include cards with a production flag.\n           * this is based on hostname instead of a build time variable so we don't\n           * need a separate build for staging and production\n           */\n\n          if (isDevOrStagingSite(location.hostname)) {\n            datasets.push(metadata);\n          } else if (metadata.production) {\n            datasets.push(metadata);\n          }\n        });\n        return datasets;\n      });\n  };\n\n  public setCollectionRef = (id: string): void => {\n    this.collectionRef = this.firestore.collection(\"cfe-datasets\").doc(id);\n  };\n\n  private getManifest = (ref: string): Promise<ManifestDocumentData> => {\n    return this.firestore\n      .doc(ref)\n      .get()\n      .then((manifestDoc: DocumentData) => {\n        return manifestDoc.data();\n      });\n  };\n\n  public selectDataset = (ref: string): Promise<ManifestDocumentData> => {\n    return this.getManifest(ref).then((data) => {\n      this.featuresDataPath = data.featuresDataPath;\n      this.thumbnailRoot = data.thumbnailRoot;\n      this.downloadRoot = data.downloadRoot;\n      this.volumeViewerDataRoot = data.volumeViewerDataRoot;\n      this.featuresDisplayOrder = data.featuresDisplayOrder;\n      this.cellLineDataPath = data.cellLineDataPath;\n      this.fileInfoPath = data.fileInfoPath;\n      this.featuresDataOrder = data.featuresDataOrder;\n      this.featureDefsPath = data.featureDefsPath;\n      this.albumPath = data.albumPath;\n      return { ...data };\n    });\n  };\n\n  public getFileInfoByCellId = (cellId: string): Promise<FileInfo | undefined> => {\n    return this.getDoc(`${this.fileInfoPath}/${cellId}`).then((doc) => {\n      const data = doc.data() as FileInfo;\n      if (!data) {\n        return;\n      }\n      return {\n        ...data,\n        CellId: data.CellId.toString(),\n        FOVId: data.FOVId.toString(),\n      };\n    });\n  };\n\n  public getFileInfoByArrayOfCellIds = (cellIds: string[]): Promise<(FileInfo | undefined)[]> => {\n    return Promise.all(\n      cellIds.map((id: string) => {\n        return this.getDoc(`${this.fileInfoPath}/${id}`).then((doc) => {\n          const data = doc.data() as FileInfo;\n          if (!data) {\n            return;\n          }\n          return {\n            ...data,\n            CellId: data.CellId.toString(),\n            FOVId: data.FOVId.toString(),\n          };\n        });\n      })\n    );\n  };\n}\n\nexport default FirebaseRequest;\n","export function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n","import type { CameraState, ControlPoint } from \"@aics/vole-core\";\nimport type { FirebaseFirestore } from \"@firebase/firestore-types\";\nimport { isEqual } from \"lodash\";\n\nimport type { AppProps, MultisceneUrls } from \"../../components/App/types\";\nimport type { ViewerStore } from \"../../state/store\";\nimport type { ChannelState, ViewerState } from \"../../state/types\";\nimport { getDefaultCameraState, getDefaultChannelState, getDefaultViewerState } from \"../constants\";\nimport { ImageType, RenderMode, ViewMode } from \"../enums\";\nimport type { ManifestJson, MetadataRecord, PerAxis } from \"../types\";\nimport type { ColorArray } from \"./colorRepresentations\";\nimport { removeMatchingProperties, removeUndefinedProperties } from \"./datatypes\";\nimport FirebaseRequest, { type DatasetMetaData } from \"./firebase\";\nimport { clamp } from \"./math\";\nimport { readStoredMetadata, readStoredScenes } from \"./storage\";\nimport type { ViewerChannelSetting, ViewerChannelSettings } from \"./viewerChannelSettings\";\n\nexport const ENCODED_COMMA_REGEX = /%2C/g;\nexport const ENCODED_COLON_REGEX = /%3A/g;\nconst DEFAULT_CONTROL_POINT_COLOR: [number, number, number] = [255, 255, 255];\nconst DEFAULT_CONTROL_POINT_COLOR_CODE = \"1\";\n\nconst FLOAT_REGEX = /-?[0-9]*.?[0-9]+/;\n\nconst CHANNEL_STATE_KEY_REGEX = /^c[0-9]+$/;\n\n/** Match colon-separated pairs of alphanumeric strings */\nconst LUT_REGEX = /^-?[a-z0-9.]*:[ ]*-?[a-z0-9.]*$/;\n\n/**\n * Match colon-separated pairs of numeric strings, representing histogram bin\n * indices or intensity values.\n */\nconst RAMP_REGEX = new RegExp(`^${FLOAT_REGEX.source}:${FLOAT_REGEX.source}$`);\n\n/**\n * Match comma-separated triplet of numeric strings.\n */\nconst SLICE_REGEX = new RegExp(`^${FLOAT_REGEX.source},${FLOAT_REGEX.source},${FLOAT_REGEX.source}$`);\n\n/**\n * Matches a sequence of three comma-separated min:max number pairs, representing\n * the x, y, and z axes.\n */\nconst REGION_REGEX = new RegExp(\n  `^(${FLOAT_REGEX.source}:${FLOAT_REGEX.source})(,${FLOAT_REGEX.source}:${FLOAT_REGEX.source}){2}$`\n);\n\nconst HEX_COLOR_REGEX = new RegExp(`(([0-9a-fA-F]{6})|${DEFAULT_CONTROL_POINT_COLOR_CODE})`);\n\n/** Represents control points specified by bin indices. */\nconst CONTROL_POINT_REGEX = new RegExp(`(${FLOAT_REGEX.source}:${FLOAT_REGEX.source}:${HEX_COLOR_REGEX.source})`);\n\nconst HEX_COLOR_STR_REGEX = new RegExp(`^${HEX_COLOR_REGEX.source}$`);\n\n/**\n * LEGACY: Matches a COMMA-separated list of control points, where each control point is represented\n * by a triplet of `{x}:{opacity}:{hex color}`.\n * The hex color can be replaced with `1` to represent white (`ffffff`).\n */\nexport const LEGACY_CONTROL_POINTS_REGEX = new RegExp(\n  `^${CONTROL_POINT_REGEX.source}(,${CONTROL_POINT_REGEX.source})*$`\n);\n\n/**\n * Matches a COLON-separated list of control points, where each control point is\n * represented by a triplet of `{x}:{opacity}:{hex color}`.\n * - `x` is a value that will either be parsed as a histogram bin index (legacy,\n *   for `ControlPointsLegacy`) or intensity value (for `ControlPoints`),\n *   depending on on which field is being parsed.\n * - Opacity is a float in the [0, 1] range.\n * - The hex color is a 6-digit hex color (e.g. `ffeecc`), and can be replaced\n *   with `1` to represent white (`ffffff`).\n */\nexport const CONTROL_POINTS_REGEX = new RegExp(`^${CONTROL_POINT_REGEX.source}(:${CONTROL_POINT_REGEX.source})*$`);\n\n/**\n * Enum keys for URL parameters. These are stored as enums for better readability,\n * and are mapped to types in `ViewerStateParams`.\n */\nexport enum ViewerStateKeys {\n  View = \"view\",\n  Mode = \"mode\",\n  Mask = \"mask\",\n  Image = \"image\",\n  Axes = \"axes\",\n  BoundingBox = \"bb\",\n  BoundingBoxColor = \"bbcol\",\n  BackgroundColor = \"bgcol\",\n  Autorotate = \"rot\",\n  Brightness = \"bright\",\n  Density = \"dens\",\n  Levels = \"lvl\",\n  Interpolation = \"interp\",\n  Region = \"reg\",\n  Slice = \"slice\",\n  Time = \"t\",\n  Scene = \"scene\",\n  CameraState = \"cam\",\n}\n\nexport enum CameraTransformKeys {\n  /** Camera position in 3D coordinates. */\n  Position = \"pos\",\n  /** Target position of the trackball controls in 3D coordinates. */\n  Target = \"tar\",\n  /** The up vector of the camera. Will be normalized to magnitude of 1. */\n  Up = \"up\",\n  /** Scale factor for orthographic cameras. */\n  OrthoScale = \"ort\",\n  /** Vertical FOV of the camera view frustum, from top to bottom, in degrees. */\n  Fov = \"fov\",\n}\n\n/**\n * Mapped to types in `ViewerChannelSettingParams`\n */\nexport enum ViewerChannelSettingKeys {\n  Color = \"col\",\n  Colorize = \"clz\",\n  ColorizeAlpha = \"cza\",\n  IsosurfaceAlpha = \"isa\",\n  Lut = \"lut\",\n  ControlPoints = \"cpt\",\n  ControlPointsLegacy = \"cps\",\n  Ramp = \"ram\",\n  RampLegacy = \"rmp\",\n  ControlPointsEnabled = \"cpe\",\n  VolumeEnabled = \"ven\",\n  SurfaceEnabled = \"sen\",\n  IsosurfaceValue = \"isv\",\n  KeepRange = \"pin\",\n}\n\n/**\n * The serialized form of a ViewerChannelSetting, as a dictionary object.\n */\nexport class ViewerChannelSettingParams {\n  /** Color, as a 6-digit hex color.  */\n  [ViewerChannelSettingKeys.Color]?: string = undefined;\n  /** Colorize. \"1\" is enabled. Disabled by default. */\n  [ViewerChannelSettingKeys.Colorize]?: \"1\" | \"0\" = undefined;\n  /** Colorize alpha, in the [0, 1] range. Set to `1.0` by default. */\n  [ViewerChannelSettingKeys.ColorizeAlpha]?: string = undefined;\n  /** Isosurface alpha, in the [0, 1 range]. Set to `1.0` by default.*/\n  [ViewerChannelSettingKeys.IsosurfaceAlpha]?: string = undefined;\n  /**\n   * Lookup table (LUT) to map from volume intensity to opacity. Should be two\n   * alphanumeric values separated by a colon, where the first value is the\n   * minimum and the second is the maximum. Defaults to [0, 255].\n   *\n   * Min and max values are determined as following:\n   * - Plain numbers are indices of histogram bins, typically in the range [0,\n   *   255].\n   * - `v{n}` represents a raw intensity value, where `n` is a number.\n   * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100]\n   *   range.\n   * - `m{n}` represents the median multiplied by `n / 100`.\n   * - `autoij` in either the min or max fields will use the \"auto\" algorithm\n   *   from ImageJ to select the min and max.\n   *\n   * Values will be used to determine the initial control points and ramp if\n   * those fields are not provided.\n   *\n   * @example\n   * ```\n   * \"0:255\"    // min: intensity 0, max: intensity 255.\n   * \"p50:p90\"  // min: 50th percentile, max: 90th percentile.\n   * \"m1:p75\"   // min: median, max: 75th percentile.\n   * \"autoij:0\" // use Auto-IJ to calculate min and max.\n   * ```\n   */\n  [ViewerChannelSettingKeys.Lut]?: string = undefined;\n  /**\n   * Legacy specifier for control points for the transfer function as a list of\n   * `x:opacity:color` triplets, separated by colon. Uses histogram bin indices\n   * instead of intensity values.\n   * - `x` is a histogram bin index in the [0, 255] range.\n   * - `opacity` is a float in the [0, 1] range.\n   * - `color` is a 6-digit hex color, e.g. `ff0000`.\n   *\n   * Will be overridden by the ControlPoints field (`cpt`) if provided.\n   */\n  [ViewerChannelSettingKeys.ControlPointsLegacy]?: string = undefined;\n  /**\n   * Control points for the transfer function, formatted as a list of\n   * `x:opacity:color` triplets, separated by colons.\n   * - `x` is a numeric intensity value.\n   * - `opacity` is a float in the [0, 1] range.\n   * - `color` is a 6-digit hex color, e.g. `ff0000`.\n   *\n   * If provided, overrides the `lut` field when calculating the control points.\n   */\n  [ViewerChannelSettingKeys.ControlPoints]?: string = undefined;\n  /**\n   * Whether to show advanced mode, which will show control points instead of\n   * ramp values defined by the LUT. \"1\" is enabled, disabled by default.\n   */\n  [ViewerChannelSettingKeys.ControlPointsEnabled]?: \"1\" | \"0\" = undefined;\n  /**\n   * Legacy specifier for the transfer function ramp which uses histogram bin\n   * indices instead of intensity values, formatted as `min:max`. Will be\n   * overridden by the Ramp field (`ram`) if provided.\n   */\n  [ViewerChannelSettingKeys.RampLegacy]?: string = undefined;\n  /**\n   * Ramp min and max intensity values (`min:max`). If provided, overrides the\n   * `lut` field when calculating the ramp.\n   */\n  [ViewerChannelSettingKeys.Ramp]?: string = undefined;\n  /** Volume enabled. \"1\" is enabled. Disabled by default. */\n  [ViewerChannelSettingKeys.VolumeEnabled]?: \"1\" | \"0\" = undefined;\n  /** Isosurface enabled. \"1\" is enabled. Disabled by default. */\n  [ViewerChannelSettingKeys.SurfaceEnabled]?: \"1\" | \"0\" = undefined;\n  /** Isosurface value, in the [0, 255] range. Set to `128` by default. */\n  [ViewerChannelSettingKeys.IsosurfaceValue]?: string = undefined;\n  /**\n   * Whether to keep the current contrast settings when loading a new volume.\n   * \"1\" is enabled. Disabled by default.\n   */\n  [ViewerChannelSettingKeys.KeepRange]?: \"1\" | \"0\" = undefined;\n}\n/**\n * Channels, matching the pattern `c0`, `c1`, etc. corresponding to the index of the channel being configured.\n * The channel parameter should have a value that is a comma-separated list of `key:value` pairs, with keys\n * defined in `ViewerChannelSettingJson`.\n */\ntype ChannelParams = { [_ in `c${number}`]?: string };\n\n/** Serialized version of `ViewerState`. */\nexport class ViewerStateParams {\n  /** Axis to view. Valid values are \"3D\", \"X\", \"Y\", and \"Z\". Defaults to \"3D\". */\n  [ViewerStateKeys.View]?: string = undefined;\n  /**\n   * Render mode. Valid values are \"volumetric\", \"maxproject\", and \"pathtrace\".\n   * Defaults to \"volumetric\".\n   */\n  [ViewerStateKeys.Mode]?: string = undefined;\n  /** The opacity of the mask channel, an integer in the range [0, 100]. Defaults to 50. */\n  [ViewerStateKeys.Mask]?: string = undefined;\n  /** The type of image to display. Valid values are \"cell\" and \"fov\". Defaults to \"cell\". */\n  [ViewerStateKeys.Image]?: string = undefined;\n  /** Whether to show the axes helper. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.Axes]?: string = undefined;\n  /** Whether to show the bounding box. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.BoundingBox]?: string = undefined;\n  /** The color of the bounding box, as a 6-digit hex color. */\n  [ViewerStateKeys.BoundingBoxColor]?: string = undefined;\n  /** The background color, as a 6-digit hex color. */\n  [ViewerStateKeys.BackgroundColor]?: string = undefined;\n  /** Whether to autorotate the view. \"1\" is enabled. Disabled by default. */\n  [ViewerStateKeys.Autorotate]?: string = undefined;\n  /** The brightness of the image, an float in the range [0, 100]. Defaults to 70. */\n  [ViewerStateKeys.Brightness]?: string = undefined;\n  /** Density, a float in the range [0, 100]. Defaults to 50. */\n  [ViewerStateKeys.Density]?: string = undefined;\n  /**\n   * Levels for image intensity adjustment. Should be three numeric values separated\n   * by commas, representing the low, middle, and high values in a [0, 255] range.\n   * Values will be sorted in ascending order; empty values will be parsed as 0.\n   */\n  [ViewerStateKeys.Levels]?: string = undefined;\n  /** Whether to enable interpolation. \"1\" is enabled. Enabled by default. */\n  [ViewerStateKeys.Interpolation]?: string = undefined;\n  /** Subregions per axis, as min:max pairs separated by commas.\n   * Defaults to full range (`0:1`) for each axis.\n   */\n  [ViewerStateKeys.Region]?: string = undefined;\n  /** Slice position per X, Y, and Z axes, as a list of comma-separated floats.\n   * 0.5 for all axes by default (e.g. `0.5,0.5,0.5`)\n   */\n  [ViewerStateKeys.Slice]?: string = undefined;\n  /** Frame number, for time-series volumes. 0 by default. */\n  [ViewerStateKeys.Time]?: string = undefined;\n  /** Scene number, for multiscene images. 0 by default. */\n  [ViewerStateKeys.Scene]?: string = undefined;\n  /**\n   * Camera transform settings, as a list of `key:value` pairs separated by commas.\n   * Valid keys are defined in `CameraTransformKeys`:\n   * - `pos`: position\n   * - `tar`: target\n   * - `up`: up\n   * - `rot`: rotation\n   * - `ort`: orthographic scales\n   *\n   * All values are an array of three floats, separated by commas and\n   * encoded using `encodeURIComponent`.\n   */\n  [ViewerStateKeys.CameraState]?: string = undefined;\n}\n\n/** URL parameters that define data sources when loading volumes. */\nclass DataParams {\n  /**\n   * One or more volume URLs to load.\n   *\n   * This parameter may represent a single image with multiple data sources by delimiting each source URL with `,`.\n   * It may also represent multiple scenes by delimiting each scene URL (and/or each collection of multiple\n   * `,`-delimited source URLs) with `+`. E.g. `url1+url2,url3` represents a collection of two scenes, where the first\n   * scene comes from `url1` and the second is a combination of the channels from the images at `url2` and `url3`.\n   *\n   * When parsing, we do our best to account for `%`-encoding, including the possibility that each source/scene URL was\n   * encoded separately, then concatenated with the proper delimiters, then encoded again.\n   */\n  url?: string = undefined;\n  /**\n   * The URL of a JSON manifest. The JSON should contain two properties:\n   *  - \"scenes\": A string array of volume URLs.\n   *  - \"meta\": An array of metadata dictionary objects.\n   *\n   * See `ManifestJson` for the type definition.\n   */\n  manifest?: string = undefined;\n  /** The name of a dataset in the Cell Feature Explorer database. Used with `id`. */\n  dataset?: string = undefined;\n  /** The ID of a cell within the loaded dataset. Used with `dataset`. */\n  id?: string = undefined;\n  /** The key of a collection of scenes stored in local storage. Overrides `url`. */\n  collectionid?: string = undefined;\n  /**\n   * The origin of an opening window that wants to send a message to this window.\n   *\n   * The presence of this param implies that this window has just been opened by another app, and the opening app has\n   * more data to send. Until that message is received, we fall back to `url`. Once that message arrives, the scenes to\n   * open are written to local storage at a new `collectionid` and `msgorigin` is removed, allowing the window to\n   * switch to reading local storage.\n   *\n   * All this happens independently of URL parsing, so the only meaningful thing this parsing code does with this param\n   * is check whether it is present.\n   */\n  msgorigin?: string = undefined;\n}\n\nclass DeprecatedParams {\n  /** Deprecated query parameter for channel settings. */\n  ch?: string = undefined;\n  /** Deprecated query parameter for LUT settings. */\n  luts?: string = undefined;\n  /** Deprecated query parameter for channel colors. */\n  colors?: string = undefined;\n}\n\ntype AppParams = Partial<ViewerStateParams & DataParams & DeprecatedParams & ChannelParams>;\n\n/**\n * A message sent from an external application after this app was opened,\n * containing data that was too large to pack into the URL.\n */\ntype ViewerMessage = {\n  /** A (possibly very long) list of scene URLs. */\n  scenes?: string[];\n  /** A (likely very large) list of metadata records for each scene. */\n  meta?: Record<string, MetadataRecord>;\n  /** The scene to open once this message arrives. */\n  sceneIndex?: number;\n};\n\nconst allowedParamKeys: Array<keyof AppParams> = [\n  ...Object.keys(new ViewerStateParams()),\n  ...Object.keys(new DataParams()),\n  ...Object.keys(new DeprecatedParams()),\n] as Array<keyof AppParams>;\nconst isParamKey = (key: string): key is keyof AppParams => allowedParamKeys.indexOf(key as keyof AppParams) !== -1;\nconst isChannelKey = (key: string): key is keyof ChannelParams => CHANNEL_STATE_KEY_REGEX.test(key);\n\n/**\n * Filters a set of URLSearchParams for only the keys that are valid parameters for the viewer.\n * Non-matching keys are discarded.\n * @param searchParams Input URL search parameters.\n * @returns a dictionary object matching the type of `Params`.\n */\nexport function getAllowedParams(searchParams: URLSearchParams): AppParams {\n  const result: AppParams = {};\n  for (const [key, value] of searchParams.entries()) {\n    if (isParamKey(key) || isChannelKey(key)) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n\n/** Tries to retrieve the given `param` from a `search` string without using `URLSearchParams`, to avoid decoding. */\nconst getSearchParamRaw = (search: string, param: string): string | undefined => {\n  const trimmedSearch = search.startsWith(\"?\") ? search.slice(1) : search;\n  const entries = trimmedSearch.split(\"&\");\n  const key = param + \"=\";\n  const foundKeyValue = entries.find((keyValue) => keyValue.startsWith(key));\n  return foundKeyValue?.slice(key.length);\n};\n\n/**\n * Applies `decodeURIComponent` over and over until `url` either seems to be a valid `URL` or satisfies `condition`.\n */\nconst decodeURLUntilParseable = (url: string, condition = (_url: string) => false): string => {\n  let decoded = url;\n  while (!condition(decoded) && !URL.canParse(decoded)) {\n    try {\n      const nextDecoded = decodeURIComponent(decoded);\n      if (nextDecoded === decoded) {\n        return decoded;\n      }\n      decoded = nextDecoded;\n    } catch {\n      return decoded;\n    }\n  }\n  return decoded;\n};\n\n/** Parses the `url` query param into a 2D URL array: one or more scenes, with one or more sources per scene. */\nexport const parseImageURLParam = (urlParam: string): string[][] => {\n  // Decode until either any valid delimiters appear or `urlParam` is parseable as a single URL.\n  const decodedScenes = decodeURLUntilParseable(urlParam, (url) => /[+ ,]/.test(url));\n  // Split into scene URLs.\n  const sceneUrls = decodedScenes.split(/[+ ]/);\n\n  return sceneUrls.map((scene) => {\n    // Split each scene into multiple sources, if any.\n    const decodedSources = decodeURLUntilParseable(scene, (url) => url.includes(\",\"));\n    const sourceUrls = decodedSources.split(\",\");\n    if (sourceUrls.length === 1) {\n      return sourceUrls;\n    }\n\n    // Try to make sure the source URLs are decoded as well.\n    return sourceUrls.map((source) => decodeURLUntilParseable(source));\n  });\n};\n\n//// DATA PARSING //////////////////////\n\n/**\n * Parse a string list of comma-separated key:value pairs into\n * a key-value object.\n *\n * @param data The string to parse. Expected to be in the format\n * \"key1:value1,key2:value2,...\". Commas in keys or values\n * must be encoded using `encodeURIComponent`.\n * @returns An object with the parsed key-value pairs. Key and value strings\n *  will be decoded using `decodeURIComponent`.\n */\nexport function parseKeyValueList(data: string): Record<string, string> {\n  if (data === \"\") {\n    return {};\n  }\n  const result: Record<string, string> = {};\n  const keyValuePairs = data.split(\",\");\n  for (const pair of keyValuePairs) {\n    const splitIndex = pair.indexOf(\":\");\n    const key = pair.slice(0, splitIndex);\n    const value = pair.slice(splitIndex + 1);\n    result[decodeURIComponent(key).trim()] = decodeURIComponent(value).trim();\n  }\n  return result;\n}\n\nfunction decodeColons(str: string): string {\n  return str.replace(ENCODED_COLON_REGEX, \":\");\n}\n\nexport function objectToKeyValueList(obj: Record<string, string | undefined>): string {\n  const keyValuePairs: string[] = [];\n  for (const key in obj) {\n    const value = obj[key];\n    if (value === undefined) {\n      continue;\n    }\n    // Allow colon separators to remain unencoded to save URL character length.\n    const escapedValue = decodeColons(encodeURIComponent(value.trim()));\n    keyValuePairs.push(`${encodeURIComponent(key.trim())}:${escapedValue}`);\n  }\n  return keyValuePairs.join(\",\");\n}\n\n/**\n * Parses a string to a float and clamps the result to the [min, max] range.\n * Returns `undefined` if the string is undefined or NaN.\n * @param value String to parse as a float. Will be parsed with `Number.parseFloat`.\n * @param min Minimum value, inclusive.\n * @param max Maximum value, inclusive.\n * @returns\n * - The parsed number, clamped to the [min, max] range.\n * - `undefined` if the string is undefined or NaN.\n */\nexport function parseStringFloat(value: string | undefined, min: number, max: number): number | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  const number = Number.parseFloat(value);\n  return Number.isNaN(number) ? undefined : clamp(number, min, max);\n}\n\n/**\n * Parses a string to an integer and clamps the result to the [min, max] range.\n * @param value String to parse as a float. Assumes base 10, parses with `Number.parseInt(value, 10)`.\n * @param min Minimum value, inclusive.\n * @param max Maximum value, inclusive.\n * @returns\n * - The parsed number, clamped to the [min, max] range.\n * - `undefined` if the string is undefined or NaN.\n */\nexport function parseStringInt(value: string | undefined, min: number, max: number): number | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  const number = Number.parseInt(value, 10);\n  if (Number.isNaN(number)) {\n    return undefined;\n  }\n  return clamp(number, min, max);\n}\n\n/**\n * Parses a string to an enum value; if the string is not in the enum, returns the default value.\n * @param value String to parse.\n * @param enumValues Enum. Cannot be a `const enum`, as these are removed at compile time.\n * @param defaultValue Default value to return if the string is not in the enum.\n * @returns A value from the enum or the default value. Note that the return type includes `undefined`\n * if the `defaultValue` is `undefined`.\n */\nexport function parseStringEnum<E extends string, T extends E | undefined>(\n  value: string | undefined,\n  enumValues: Record<string | number | symbol, E>,\n  defaultValue: T = undefined as T\n): T {\n  if (value === undefined || !Object.values(enumValues).includes(value as E)) {\n    return defaultValue;\n  }\n  return value as T;\n}\n\n/**\n * Parses a string boolean value (\"1\" as true, \"0\" as false), and returns `undefined` if the value is `undefined`.\n */\nfunction parseStringBoolean(value: string | undefined): boolean | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  return value === \"1\";\n}\n\nexport function parseHexColorAsColorArray(hexColor: string | undefined): ColorArray | undefined {\n  if (!hexColor || !HEX_COLOR_STR_REGEX.test(hexColor)) {\n    return undefined;\n  }\n  // if (hexColor in COLOR_CODES) {\n  //   return COLOR_CODES[hexColor];\n  // }\n  if (hexColor === DEFAULT_CONTROL_POINT_COLOR_CODE) {\n    return DEFAULT_CONTROL_POINT_COLOR;\n  }\n  const r = Number.parseInt(hexColor.slice(0, 2), 16);\n  const g = Number.parseInt(hexColor.slice(2, 4), 16);\n  const b = Number.parseInt(hexColor.slice(4, 6), 16);\n  return [r, g, b];\n}\n\nfunction colorArrayToHex(color: ColorArray): string {\n  return color\n    .map((c) => c.toString(16).padStart(2, \"0\"))\n    .join(\"\")\n    .toLowerCase();\n}\n\nfunction parseStringSlice(region: string | undefined): PerAxis<number> | undefined {\n  if (!region || !SLICE_REGEX.test(region)) {\n    return undefined;\n  }\n  const [x, y, z] = region.split(\",\").map((val) => parseStringFloat(val, 0, 1));\n  if (x === undefined || y === undefined || z === undefined) {\n    return undefined;\n  }\n  return { x, y, z };\n}\n\n/**\n * Parses an array of three numbers from a string.\n * @param stringArr The string to parse. Should be three numbers separated by a separator.\n * @param options Optional parameters for parsing:\n * - `min`: Minimum value for each number. Default is negative infinity.\n * - `max`: Maximum value for each number. Default is positive infinity.\n * - `separator`: Separator between numbers. Default is `,`.\n * @returns\n * - undefined if the string is undefined or could not be parsed.\n * - An array of three numbers, clamped to the [min, max] range.\n */\nfunction parseThreeNumberArray(\n  stringArr: string | undefined,\n  options?: { min?: number; max?: number; separator?: string }\n): [number, number, number] | undefined {\n  if (!stringArr) {\n    return undefined;\n  }\n\n  const min = options?.min ?? Number.NEGATIVE_INFINITY;\n  const max = options?.max ?? Number.POSITIVE_INFINITY;\n  const separator = options?.separator ?? \",\";\n\n  const [x, y, z] = stringArr.split(separator).map((val) => parseStringFloat(val, min, max));\n  if (x === undefined || y === undefined || z === undefined) {\n    return undefined;\n  }\n  return [x, y, z];\n}\n\nfunction parseStringRegion(region: string | undefined): PerAxis<[number, number]> | undefined {\n  if (!region || !REGION_REGEX.test(region)) {\n    return undefined;\n  }\n  const [x, y, z] = region.split(\",\").map((axis): [number, number] | undefined => {\n    // each is a min/max pair\n    const [min, max] = axis.split(\":\").map((val) => parseStringFloat(val, 0, 1));\n    if (min === undefined || max === undefined) {\n      return undefined;\n    }\n    // Ensure sorted order\n    return min < max ? [min, max] : [max, min];\n  });\n  // Check for undefined values\n  if (x === undefined || y === undefined || z === undefined) {\n    return undefined;\n  }\n  return { x, y, z };\n}\n\n/**\n * Formats a float or integer value to a string with a maximum precision for float values.\n * @param value The number to format.\n * @param maxPrecision The maximum number of significant digits to display for float values.\n * Default is 7.\n * @returns\n * - For integers, the integer value as a string.\n * - For floats, the float value as a string with a maximum of `maxPrecision` significant digits\n * and any trailing zeroes removed.\n *\n * @example\n * ```\n * formatFloat(1.23456, 3) // \"1.23\"\n * formatFloat(123456, 3) // \"123456\"\n * formatFloat(1.3999999999999999, 3) // \"1.4\"\n * ```\n */\nfunction formatFloat(value: number, maxPrecision: number = 7): string {\n  if (Number.isInteger(value)) {\n    return value.toString();\n  }\n  return Number(value.toPrecision(maxPrecision)).toString();\n}\n\nfunction perAxisToArray<T>(perAxis: PerAxis<T>): T[] {\n  return [perAxis.x, perAxis.y, perAxis.z];\n}\n\n/** Serializes a region into a `x1:x2,y1:y2,z1:z2` string format. */\nfunction serializeRegion(region: PerAxis<[number, number]>): string {\n  return perAxisToArray(region)\n    .map((axis) => axis.map((val) => formatFloat(val)).join(\":\"))\n    .join(\",\");\n}\n\n/** Serializes a slice parameter into a `x,y,z` string format. */\nfunction serializeSlice(slice: PerAxis<number>): string {\n  return perAxisToArray(slice)\n    .map((val) => formatFloat(val))\n    .join(\",\");\n}\n\nfunction serializeBoolean(value: boolean | undefined): \"1\" | \"0\" | undefined {\n  if (value === undefined) {\n    return undefined;\n  }\n  return value ? \"1\" : \"0\";\n}\n\nfunction parseCameraState(cameraSettings: string | undefined): Partial<CameraState> | undefined {\n  if (!cameraSettings) {\n    return undefined;\n  }\n  const parsedCameraSettings = parseKeyValueList(cameraSettings);\n  const result: Partial<CameraState> = {\n    position: parseThreeNumberArray(parsedCameraSettings[CameraTransformKeys.Position], { separator: \":\" }),\n    target: parseThreeNumberArray(parsedCameraSettings[CameraTransformKeys.Target], { separator: \":\" }),\n    up: parseThreeNumberArray(parsedCameraSettings[CameraTransformKeys.Up], { separator: \":\" }),\n    // Orthographic scales cannot be negative\n    orthoScale: parseStringFloat(parsedCameraSettings[CameraTransformKeys.OrthoScale], 0, Infinity),\n    fov: parseStringFloat(parsedCameraSettings[CameraTransformKeys.Fov], 0, 180),\n  };\n  return removeUndefinedProperties(result);\n}\n\nexport function serializeCameraState(\n  cameraState: Partial<CameraState>,\n  removeDefaults: boolean,\n  viewMode: ViewMode = ViewMode.threeD\n): string | undefined {\n  if (removeDefaults) {\n    // Note that we use the `getDefaultCameraState()` to get the defaults here,\n    // instead of `getDefaultViewerState().cameraState`. The latter is undefined, which signals\n    // that the camera should not be modified for URLs that don't specify it.\n    cameraState = removeMatchingProperties(cameraState, getDefaultCameraState(viewMode));\n    if (Object.keys(cameraState).length === 0) {\n      return undefined;\n    }\n  }\n  const cameraString = objectToKeyValueList({\n    [CameraTransformKeys.Position]:\n      cameraState.position && cameraState.position.map((value) => formatFloat(value)).join(\":\"),\n    [CameraTransformKeys.Target]: cameraState.target && cameraState.target.map((value) => formatFloat(value)).join(\":\"),\n    [CameraTransformKeys.Up]: cameraState.up && cameraState.up.map((value) => formatFloat(value)).join(\":\"),\n    [CameraTransformKeys.OrthoScale]:\n      cameraState.orthoScale === undefined ? undefined : formatFloat(cameraState.orthoScale),\n    [CameraTransformKeys.Fov]: cameraState.fov === undefined ? undefined : formatFloat(cameraState.fov),\n  });\n  return cameraString === \"\" ? undefined : cameraString;\n}\n\nfunction serializeControlPoints(controlPoints: ControlPoint[]): string {\n  return controlPoints\n    .map((cp) => {\n      const x = formatFloat(cp.x);\n      const opacity = formatFloat(cp.opacity);\n      // Default color is empty string\n      // TODO: Substitute\n      const color = isEqual(cp.color, DEFAULT_CONTROL_POINT_COLOR)\n        ? DEFAULT_CONTROL_POINT_COLOR_CODE\n        : colorArrayToHex(cp.color);\n      return `${x}:${opacity}:${color}`;\n    })\n    .join(\":\");\n}\n\nfunction parseControlPoints(controlPoints: string | undefined): ControlPoint[] | undefined {\n  if (\n    !(controlPoints && (CONTROL_POINTS_REGEX.test(controlPoints) || LEGACY_CONTROL_POINTS_REGEX.test(controlPoints)))\n  ) {\n    return undefined;\n  }\n\n  // Parse raw control point data from the string into an array of [x, opacity, color] triplets.\n  let controlPointStrings: string[][];\n  if (LEGACY_CONTROL_POINTS_REGEX.test(controlPoints)) {\n    // Legacy format uses commas to separate control points.\n    controlPointStrings = controlPoints.split(\",\").map((cp) => cp.split(\":\"));\n  } else {\n    // New format is all colon-separated, where every three elements represent a control point.\n    controlPointStrings = controlPoints.split(\":\").reduce((acc, _val, i, array) => {\n      if ((i + 1) % 3 === 0) {\n        acc.push([array[i - 2], array[i - 1], array[i]]);\n      }\n      return acc;\n    }, [] as string[][]);\n  }\n\n  const newControlPoints = controlPointStrings.map((cp) => {\n    const [x, opacity, color] = cp;\n    return {\n      x: parseStringFloat(x, -Infinity, Infinity) ?? 0,\n      opacity: parseStringFloat(opacity, 0, 1) ?? 1.0,\n      color: parseHexColorAsColorArray(color) ?? DEFAULT_CONTROL_POINT_COLOR,\n    };\n  });\n  // Sort control points by x value\n  return newControlPoints.sort((a, b) => a.x - b.x);\n}\n\n//// DATA SERIALIZATION //////////////////////\n\n/**\n * Parses a ViewerChannelSetting from a JSON object.\n * @param channelIndex Index of the channel, to be turned into a `match` value.\n * @param jsonState The serialized ViewerChannelSetting to parse, as an object.\n * @returns A ViewerChannelSetting object.\n */\nexport function deserializeViewerChannelSetting(\n  channelIndex: number,\n  jsonState: ViewerChannelSettingParams\n): ViewerChannelSetting {\n  // Missing/undefined fields should be handled downstream.\n  const result: ViewerChannelSetting = {\n    match: channelIndex,\n    enabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.VolumeEnabled]),\n    surfaceEnabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.SurfaceEnabled]),\n    isovalue: parseStringFloat(jsonState[ViewerChannelSettingKeys.IsosurfaceValue], -Infinity, Infinity),\n    keepIntensityRange: parseStringBoolean(jsonState[ViewerChannelSettingKeys.KeepRange]),\n    surfaceOpacity: parseStringFloat(jsonState[ViewerChannelSettingKeys.IsosurfaceAlpha], 0, 1),\n    colorizeEnabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.Colorize]),\n    colorizeAlpha: parseStringFloat(jsonState[ViewerChannelSettingKeys.ColorizeAlpha], 0, 1),\n    controlPointsEnabled: parseStringBoolean(jsonState[ViewerChannelSettingKeys.ControlPointsEnabled]),\n  };\n  if (jsonState[ViewerChannelSettingKeys.Color] && HEX_COLOR_REGEX.test(jsonState.col)) {\n    result.color = jsonState[ViewerChannelSettingKeys.Color];\n  }\n  if (jsonState[ViewerChannelSettingKeys.Lut] && LUT_REGEX.test(jsonState.lut)) {\n    const [min, max] = jsonState[ViewerChannelSettingKeys.Lut].split(\":\");\n    result.intensity = { ...result.intensity, lut: [min.trim(), max.trim()] };\n  }\n\n  if (jsonState[ViewerChannelSettingKeys.Ramp]) {\n    if (RAMP_REGEX.test(jsonState[ViewerChannelSettingKeys.Ramp])) {\n      const [min, max] = jsonState[ViewerChannelSettingKeys.Ramp].split(\":\");\n      result.intensity = { ...result.intensity, ramp: [Number.parseFloat(min), Number.parseFloat(max)] };\n    }\n  } else if (jsonState[ViewerChannelSettingKeys.RampLegacy]) {\n    if (RAMP_REGEX.test(jsonState[ViewerChannelSettingKeys.RampLegacy])) {\n      const [min, max] = jsonState[ViewerChannelSettingKeys.RampLegacy].split(\":\");\n      result.ramp = [Number.parseFloat(min), Number.parseFloat(max)];\n    }\n  }\n\n  if (jsonState[ViewerChannelSettingKeys.ControlPoints]) {\n    const parsedResult = parseControlPoints(jsonState[ViewerChannelSettingKeys.ControlPoints]);\n    if (parsedResult) {\n      result.intensity = { ...result.intensity, controlPoints: parsedResult };\n    }\n  } else if (jsonState[ViewerChannelSettingKeys.ControlPointsLegacy]) {\n    const parsedResult = parseControlPoints(jsonState[ViewerChannelSettingKeys.ControlPointsLegacy]);\n    if (parsedResult) {\n      result.controlPoints = parsedResult;\n    }\n  }\n  return result;\n}\n\n/**\n * Serializes a single viewer channel setting into a dictionary of URL parameters\n * (`ViewerChannelSettingParams`).\n * @param channelSetting The channel state object to serialize.\n * @param removeDefaults Whether to remove properties that match the output of `GET_DEFAULT_CHANNEL_STATE`.\n * @returns A `ViewerChannelSettingParams` object with the serialized parameters. Undefined values are removed.\n */\nexport function serializeViewerChannelSetting(\n  channelSetting: Partial<ChannelState>,\n  removeDefaults: boolean\n): Partial<ViewerChannelSettingParams> {\n  if (removeDefaults) {\n    channelSetting = removeMatchingProperties(channelSetting, getDefaultChannelState());\n  }\n  return removeUndefinedProperties({\n    [ViewerChannelSettingKeys.VolumeEnabled]: serializeBoolean(channelSetting.volumeEnabled),\n    [ViewerChannelSettingKeys.SurfaceEnabled]: serializeBoolean(channelSetting.isosurfaceEnabled),\n    [ViewerChannelSettingKeys.IsosurfaceValue]: channelSetting.isovalue?.toString(),\n    [ViewerChannelSettingKeys.IsosurfaceAlpha]: channelSetting.opacity?.toString(),\n    [ViewerChannelSettingKeys.Colorize]: serializeBoolean(channelSetting.colorizeEnabled),\n    [ViewerChannelSettingKeys.ColorizeAlpha]: channelSetting.colorizeAlpha?.toString(),\n    [ViewerChannelSettingKeys.Color]: channelSetting.color && colorArrayToHex(channelSetting.color),\n    [ViewerChannelSettingKeys.ControlPoints]:\n      channelSetting.controlPoints && serializeControlPoints(channelSetting.controlPoints),\n    [ViewerChannelSettingKeys.ControlPointsEnabled]: serializeBoolean(channelSetting.useControlPoints),\n    [ViewerChannelSettingKeys.Ramp]: channelSetting.ramp?.join(\":\"),\n    [ViewerChannelSettingKeys.KeepRange]: serializeBoolean(channelSetting.keepIntensityRange),\n    // Note that Lut is not saved here, as it is expected as user input and is redundant with\n    // the control points and ramp.\n  });\n}\n\nexport function deserializeViewerState(params: ViewerStateParams): Partial<ViewerState> {\n  const result: Partial<ViewerState> = {\n    maskAlpha: parseStringInt(params[ViewerStateKeys.Mask], 0, 100),\n    imageType: parseStringEnum(params[ViewerStateKeys.Image], ImageType),\n    showAxes: parseStringBoolean(params[ViewerStateKeys.Axes]),\n    showBoundingBox: parseStringBoolean(params[ViewerStateKeys.BoundingBox]),\n    boundingBoxColor: parseHexColorAsColorArray(params[ViewerStateKeys.BoundingBoxColor]),\n    backgroundColor: parseHexColorAsColorArray(params[ViewerStateKeys.BackgroundColor]),\n    autorotate: parseStringBoolean(params[ViewerStateKeys.Autorotate]),\n    brightness: parseStringFloat(params[ViewerStateKeys.Brightness], 0, 100),\n    density: parseStringFloat(params[ViewerStateKeys.Density], 0, 100),\n    levels: parseThreeNumberArray(params[ViewerStateKeys.Levels], { min: 0, max: 255 }),\n    interpolationEnabled: parseStringBoolean(params[ViewerStateKeys.Interpolation]),\n    region: parseStringRegion(params[ViewerStateKeys.Region]),\n    slice: parseStringSlice(params[ViewerStateKeys.Slice]),\n    time: parseStringInt(params[ViewerStateKeys.Time], 0, Number.POSITIVE_INFINITY),\n    scene: parseStringInt(params[ViewerStateKeys.Scene], 0, Number.POSITIVE_INFINITY),\n    renderMode: parseStringEnum(params[ViewerStateKeys.Mode], RenderMode),\n    cameraState: parseCameraState(params[ViewerStateKeys.CameraState]),\n  };\n\n  // Handle viewmode, since they use different mappings\n  // TODO: Allow lowercase\n  if (params.view) {\n    const viewParamToViewMode = {\n      \"3D\": ViewMode.threeD,\n      Z: ViewMode.xy,\n      Y: ViewMode.xz,\n      X: ViewMode.yz,\n    };\n    const allowedViews = Object.keys(viewParamToViewMode);\n    let view: \"3D\" | \"X\" | \"Y\" | \"Z\";\n    if (allowedViews.includes(params.view.toUpperCase())) {\n      view = params.view.toUpperCase() as \"3D\" | \"X\" | \"Y\" | \"Z\";\n    } else {\n      view = \"3D\";\n    }\n    result.viewMode = viewParamToViewMode[view];\n  }\n\n  return removeUndefinedProperties(result);\n}\n\n/**\n * Serializes a ViewerState object into a dictionary of URL parameters.\n * @param state The ViewerState to serialize.\n * @param removeDefaults If true, remove properties that match the output of `GET_DEFAULT_VIEWER_STATE`.\n * @returns A `ViewerStateParams` object with the serialized parameters. Undefined values are removed.\n */\nexport function serializeViewerState(state: Partial<ViewerState>, removeDefaults: boolean): ViewerStateParams {\n  if (removeDefaults) {\n    state = removeMatchingProperties(state, getDefaultViewerState());\n  }\n  const result: ViewerStateParams = {\n    [ViewerStateKeys.Mode]: state.renderMode,\n    [ViewerStateKeys.Mask]: state.maskAlpha?.toString(),\n    [ViewerStateKeys.Image]: state.imageType,\n    [ViewerStateKeys.Axes]: serializeBoolean(state.showAxes),\n    [ViewerStateKeys.BoundingBox]: serializeBoolean(state.showBoundingBox),\n    [ViewerStateKeys.BoundingBoxColor]: state.boundingBoxColor && colorArrayToHex(state.boundingBoxColor),\n    [ViewerStateKeys.BackgroundColor]: state.backgroundColor && colorArrayToHex(state.backgroundColor),\n    [ViewerStateKeys.Autorotate]: serializeBoolean(state.autorotate),\n    [ViewerStateKeys.Brightness]: state.brightness?.toString(),\n    [ViewerStateKeys.Density]: state.density?.toString(),\n    [ViewerStateKeys.Interpolation]: serializeBoolean(state.interpolationEnabled),\n    [ViewerStateKeys.Region]: state.region && serializeRegion(state.region),\n    [ViewerStateKeys.Slice]: state.slice && serializeSlice(state.slice),\n    [ViewerStateKeys.Levels]: state.levels?.join(\",\"),\n    [ViewerStateKeys.Time]: state.time?.toString(),\n    [ViewerStateKeys.Scene]: state.scene?.toString(),\n    [ViewerStateKeys.CameraState]:\n      state.cameraState && serializeCameraState(state.cameraState as CameraState, removeDefaults, state.viewMode),\n  };\n\n  const viewModeToViewParam = {\n    [ViewMode.threeD]: \"3D\",\n    [ViewMode.xy]: \"Z\",\n    [ViewMode.xz]: \"Y\",\n    [ViewMode.yz]: \"X\",\n  };\n  result[ViewerStateKeys.View] = state.viewMode && viewModeToViewParam[state.viewMode];\n  return removeUndefinedProperties(result);\n}\n\nfunction parseDeprecatedChannelSettings(params: DeprecatedParams): ViewerChannelSettings | undefined {\n  // old, deprecated channels model\n  if (params.ch) {\n    // ?ch=1,2\n    // ?luts=0,255,0,255\n    // ?colors=ff0000,00ff00\n    const initialChannelSettings: ViewerChannelSettings = {\n      groups: [{ name: \"Channels\", channels: [] }],\n    };\n    const ch = initialChannelSettings.groups[0].channels;\n\n    const channelsOn = params.ch.split(\",\").map((numstr) => Number.parseInt(numstr, 10));\n    for (let i = 0; i < channelsOn.length; ++i) {\n      ch.push({ match: channelsOn[i], enabled: true });\n    }\n    // look for luts or color\n    if (params.luts) {\n      const luts = params.luts.split(\",\");\n      if (luts.length !== ch.length * 2) {\n        console.warn(\"ILL-FORMED QUERYSTRING: luts must have a min/max for each ch\");\n      } else {\n        for (let i = 0; i < ch.length; ++i) {\n          ch[i][\"lut\"] = [luts[i * 2], luts[i * 2 + 1]];\n        }\n      }\n    }\n    if (params.colors) {\n      const colors = params.colors.split(\",\");\n      if (colors.length !== ch.length) {\n        console.warn(\"ILL-FORMED QUERYSTRING: if colors specified, must have a color for each ch\");\n      } else {\n        for (let i = 0; i < ch.length; ++i) {\n          ch[i][\"color\"] = colors[i];\n        }\n      }\n    }\n    return initialChannelSettings;\n  }\n  return undefined;\n}\n\nfunction parseChannelSettings(params: ChannelParams): ViewerChannelSettings | undefined {\n  // Channels keys are formatted as `c0`, `c1`, etc., and the value is string containing\n  // a comma-separated list of key-value pairs.\n  const channelIndexToSettings: Map<number, ViewerChannelSetting> = new Map();\n  Object.keys(params).forEach((key) => {\n    if (isChannelKey(key)) {\n      const channelIndex = Number.parseInt(key.slice(1), 10);\n      try {\n        const channelData = parseKeyValueList(params[key]!);\n        const channelSetting = deserializeViewerChannelSetting(channelIndex, channelData as ViewerChannelSettingParams);\n        channelIndexToSettings.set(channelIndex, channelSetting);\n      } catch (e) {\n        console.warn(\n          `url_utils.getArgsFromParams: Failed to parse channel settings for channel ${channelIndex} from URL parameters.`,\n          e\n        );\n      }\n    }\n  });\n  if (channelIndexToSettings.size > 0) {\n    const groups: ViewerChannelSettings[\"groups\"] = [\n      {\n        name: \"Channels\",\n        channels: Array.from(channelIndexToSettings.values()),\n      },\n    ];\n    return { groups };\n  }\n\n  return undefined;\n}\n\n//// FULL URL PARSING //////////////////////\nasync function loadDataset(firestore: FirebaseFirestore, dataset: string, id: string): Promise<Partial<AppProps>> {\n  const db = new FirebaseRequest(firestore);\n  const args: Partial<AppProps> = {};\n\n  const datasets = await db.getAvailableDatasets();\n\n  let datasetMeta: DatasetMetaData | undefined = undefined;\n  for (const d of datasets) {\n    const innerDatasets = d.datasets!;\n    const names = Object.keys(innerDatasets);\n    const matchingName = names.find((name) => name === dataset);\n    if (matchingName) {\n      datasetMeta = innerDatasets[matchingName];\n      break;\n    }\n  }\n  if (datasetMeta === undefined) {\n    console.error(`No matching dataset: ${dataset}`);\n    return {};\n  }\n\n  const datasetData = await db.selectDataset(datasetMeta.manifest!);\n  const baseUrl = datasetData.volumeViewerDataRoot + \"/\";\n  args.imageDownloadHref = datasetData.downloadRoot + \"/\" + id;\n  // args.fovDownloadHref = datasetData.downloadRoot + \"/\" + id;\n\n  const fileInfo = await db.getFileInfoByCellId(id);\n  args.imageUrl = baseUrl + fileInfo!.volumeviewerPath;\n  args.parentImageUrl = baseUrl + fileInfo!.fovVolumeviewerPath;\n\n  return args;\n}\n\nfunction isStringArray(arr: any[]): arr is string[] {\n  return Array.isArray(arr) && arr.every((item) => typeof item === \"string\");\n}\n\nfunction isValidScenesArray(arr: any[]): arr is (string | string[])[] {\n  return Array.isArray(arr) && arr.every((item) => typeof item === \"string\" || isStringArray(item));\n}\n\nexport async function loadFromManifest(\n  manifestUrl: string\n): Promise<{ scenes: (string | string[])[]; metadata?: MetadataRecord[] }> {\n  let response: Response;\n  let manifestJson: ManifestJson;\n\n  // Fetch manifest\n  try {\n    response = await fetch(manifestUrl);\n  } catch (error) {\n    console.error(error);\n    throw new Error(`JSON manifest could not be fetched from URL '${manifestUrl}': ${error}`);\n  }\n  if (!response.ok) {\n    throw new Error(\n      `JSON manifest could not be fetched from URL '${manifestUrl}': Received ${response.status} ${response.statusText}`\n    );\n  }\n  // Parse JSON\n  try {\n    manifestJson = await response.json();\n  } catch (error) {\n    throw new Error(`Could not parse JSON manifest from URL '${manifestUrl}': ${error}`);\n  }\n\n  // Parse scenes\n  let scenes = manifestJson.scenes;\n  if (scenes === undefined) {\n    throw new Error(`No 'scenes' property was found in JSON manifest from URL '${manifestUrl}'`);\n  }\n  if (typeof scenes === \"string\") {\n    scenes = [scenes];\n  }\n  if (!Array.isArray(scenes) || scenes.length === 0 || !isValidScenesArray(scenes)) {\n    throw new Error(\n      `Invalid 'scenes' property found in JSON manifest from URL '${manifestUrl}'. 'scenes' must be a non-empty array of strings or string arrays.`\n    );\n  }\n\n  // Parse metadata\n  let metadata: MetadataRecord[] | undefined = undefined;\n  if (manifestJson.meta !== undefined && Array.isArray(manifestJson.meta)) {\n    metadata = manifestJson.meta;\n  }\n  return { scenes, metadata };\n}\n\n/**\n * Parses a set of URL search parameters into props for the viewer.\n * @param search The query string to parse, which must be valid in the `URLSearchParams constructor\n * @param firestore Optional Firestore instance. If provided, the function can load data from a\n * Firestore dataset if the `dataset` and `id` parameters are provided.\n * @returns An object containing:\n * - `args`: Partial AppProps object.\n * - `viewerSettings`: Partial ViewerState object.\n *\n * `args` can be passed as props to the `ImageViewerApp`, and `viewerSettings` can be passed to `ViewerStateProvider`.\n */\nexport async function parseViewerUrlParams(\n  search: string,\n  firestore?: FirebaseFirestore\n): Promise<{\n  args: Partial<AppProps>;\n  viewerSettings: Partial<ViewerState>;\n}> {\n  const searchParams = new URLSearchParams(search);\n  const params = getAllowedParams(searchParams);\n  let args: Partial<AppProps> = {};\n  // Parse viewer state\n  const viewerSettings: Partial<ViewerState> = deserializeViewerState(params);\n\n  // Parse channel settings. If per-channel settings are provided, they will override\n  // the old `ch` query parameter.\n  const deprecatedChannelSettings = parseDeprecatedChannelSettings(params);\n  const channelSettings = parseChannelSettings(params);\n  args.viewerChannelSettings = channelSettings ?? deprecatedChannelSettings;\n\n  // Parse data sources (URL or dataset/id pair)\n  if (params.manifest !== undefined || params.url !== undefined || params.collectionid !== undefined) {\n    let scenes: (string | string[])[];\n\n    if (params.manifest) {\n      const { scenes: manifestScenes, metadata: manifestMetadata } = await loadFromManifest(params.manifest);\n      scenes = manifestScenes;\n      args.metadata = manifestMetadata ?? undefined;\n    } else {\n      // Load from URL or storage\n      const { collectionid, msgorigin } = params;\n      const getFromStorage = collectionid !== undefined && msgorigin === undefined;\n      const urlParamFromStorage = getFromStorage ? readStoredScenes(collectionid) : undefined;\n      const urlParam = urlParamFromStorage ?? getSearchParamRaw(search, \"url\")!;\n      scenes = parseImageURLParam(urlParam);\n      args.metadata = readStoredMetadata(scenes);\n    }\n\n    const firstScene = scenes[0];\n    // Get the very first URL for the download button\n    const firstUrl = Array.isArray(firstScene) ? firstScene[0] : firstScene;\n    // If there's only one url, just pass that\n    const imageUrls: string | MultisceneUrls = scenes.length > 1 || firstScene.length > 1 ? { scenes } : firstScene[0];\n\n    args.cellId = \"1\";\n    args.imageUrl = imageUrls;\n    // this is invalid for zarr?\n    args.imageDownloadHref = firstUrl;\n    args.parentImageUrl = \"\";\n    args.parentImageDownloadHref = \"\";\n    // Check if channel settings are already provided (through per-channel settings or\n    // old `ch` query param, or included in JSON files). If not, make first three\n    // channels visible by default.\n    if (!firstUrl.endsWith(\"json\") && !args.viewerChannelSettings) {\n      args.viewerChannelSettings = {\n        groups: [\n          // first 3 channels on by default!\n          {\n            name: \"Channels\",\n            channels: [\n              { match: [0, 1, 2], enabled: true },\n              { match: \"(.+)\", enabled: false },\n            ],\n          },\n        ],\n      };\n    }\n  } else if (params.dataset && params.id && firestore) {\n    // ?dataset=aics_hipsc_v2020.1&id=232265\n    const datasetArgs = await loadDataset(firestore, params.dataset, params.id);\n    args = { ...args, ...datasetArgs };\n  }\n\n  return { args: removeUndefinedProperties(args), viewerSettings: removeUndefinedProperties(viewerSettings) };\n}\n\n/** Adds the data in a newly-arrived `ViewerMessage` to an existing stored `AppProps` instance. */\nexport function addViewerParamsFromMessage<P extends Pick<AppProps, \"imageUrl\" | \"metadata\">>(\n  args: P,\n  message: ViewerMessage\n): P {\n  // get scenes\n  const { imageUrl } = args;\n  const scenes = message.scenes ?? (typeof imageUrl === \"string\" ? [imageUrl] : imageUrl.scenes);\n  const firstScene = scenes[0];\n  const newImageUrl = scenes.length === 1 && typeof firstScene === \"string\" ? firstScene : { scenes };\n\n  // get metadata\n  const { meta } = message;\n  const messageMeta =\n    meta &&\n    scenes.map((scene) => {\n      if (Array.isArray(scene)) {\n        // can't handle multi-source scenes (yet)\n        return undefined;\n      }\n\n      return meta[scene] as MetadataRecord | undefined;\n    });\n  const newMetadata = messageMeta ?? args.metadata;\n\n  if (newMetadata === undefined) {\n    return { ...args, imageUrl: newImageUrl };\n  } else {\n    return { ...args, imageUrl: newImageUrl, metadata: newMetadata };\n  }\n}\n\n/**\n * Serializes the ViewerState and ChannelState of a ViewerStateContext into a URLSearchParams object.\n * @param state ViewerStateContext to serialize.\n * @param removeDefaults If true, shortens parameters by removing any properties that match the default state.\n * This includes the output of GET_DEFAULT_VIEWER_STATE and GET_DEFAULT_CHANNEL_STATE.\n */\nexport function serializeViewerUrlParams(state: Partial<ViewerStore>, removeDefaults: boolean = true): AppParams {\n  const params = serializeViewerState(state, removeDefaults);\n\n  const channelParams = state.channelSettings?.reduce<Record<string, string>>(\n    (acc, channelSetting, index): Record<string, string> => {\n      const key = `c${index}`;\n      acc[key] = objectToKeyValueList(\n        serializeViewerChannelSetting(channelSetting, removeDefaults) as Record<string, string>\n      );\n      return acc;\n    },\n    {} as Record<string, string>\n  );\n\n  return { ...params, ...channelParams };\n}\n","import type { ControlPoint } from \"@aics/vole-core\";\n\nimport { OTHER_CHANNEL_KEY, SINGLE_GROUP_CHANNEL_KEY } from \"../constants\";\n\nexport type IntensitySettings = {\n  /**\n   * Defines a linear function for mapping from intensity values in the volume\n   * to opacity between two [min, max] intensity values.\n   */\n  ramp?: [number, number];\n  /**\n   * Defines a piecewise linear function for mapping from intensity values in\n   * the volume to opacity and color.\n   */\n  controlPoints?: ControlPoint[];\n  /**\n   * Min and max values for the intensity lookup table, which maps from raw intensity values\n   * in the volume to opacity and color. Defaults to [0, 255].\n   *\n   * - Plain numbers are indices of histogram bins, in the range [0, 255].\n   * - `v{n}` represents a raw intensity value, where `n` is an integer.\n   * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100] range.\n   * - `m{n}` represents the median multiplied by `n / 100`.\n   * - `autoij` in either the min or max fields will use the \"auto\" algorithm\n   * from ImageJ to select the min and max.\n   */\n  lut?: [string, string];\n};\n\n/** Settings for a single channel, as passed in via props by App users */\nexport interface ViewerChannelSetting {\n  // regex or string or array of regexes or strings or number for raw channel index\n  // if you want to match on channel index, then you must provide the index here.\n  match: (string | number)[] | string | number;\n\n  // name is the display name for this channel.\n  // if name is not given, use raw data channel name for display\n  name?: string;\n\n  // 6 digit hex rrggbb. defaults to auto-assigned by app\n  color?: string;\n  // default to false\n  enabled?: boolean;\n  // default to false\n  surfaceEnabled?: boolean;\n  /**\n   * Min and max values for the intensity lookup table, which maps from raw intensity values\n   * in the volume to opacity and color. Defaults to [0, 255].\n   *\n   * - Plain numbers are indices of histogram bins, in the range [0, 255].\n   * - `v{n}` represents a raw intensity value, where `n` is an integer.\n   * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100] range.\n   * - `m{n}` represents the median multiplied by `n / 100`.\n   * - `autoij` in either the min or max fields will use the \"auto\" algorithm\n   * from ImageJ to select the min and max.\n   * @deprecated Will be removed in a future update. Specify via `intensity.lut`\n   * instead.\n   */\n  lut?: [string, string];\n  /**\n   * Whether to show control point controls instead of a simpler ramp control.\n   * Defaults to false.\n   */\n  controlPointsEnabled?: boolean;\n  /**\n   * Control points for the transfer function, as histogram bin values.\n   * @deprecated Will be removed in a future update. Specify via `intensity.controlPoints` instead.\n   */\n  controlPoints?: ControlPoint[];\n  /**\n   * Min and max ramp values for the transfer function, as histogram bin values.\n   * @deprecated Will be removed in a future update. Specify via\n   * `intensity.ramp` instead.\n   */\n  ramp?: [number, number];\n  intensity?: IntensitySettings;\n  // valid when surfaceEnabled = true. default 128 or 0.5 of max intensity range\n  isovalue?: number;\n  // valid when surfaceEnabled = true. default 1.0 fully opaque\n  surfaceOpacity?: number;\n  colorizeEnabled?: boolean;\n  colorizeAlpha?: number;\n  /** Whether to keep the current contrast settings when switching volumes. */\n  keepIntensityRange?: boolean;\n}\n\nexport interface ViewerChannelGroup {\n  name: string;\n  channels: ViewerChannelSetting[];\n}\n\nexport interface ViewerChannelSettings {\n  maskChannelName?: string;\n  groups: ViewerChannelGroup[];\n}\n\nexport type ChannelGrouping = { [key: string]: number[] };\n\nexport function matchChannel(channelName: string, channelIndex: number, c: ViewerChannelSetting): boolean {\n  // c could be a number, an array of (strings or numbers), or a single regex\n  if (typeof c.match === \"number\") {\n    if (c.match === channelIndex) {\n      return true;\n    }\n  } else if (Array.isArray(c.match)) {\n    for (const r of c.match) {\n      if (typeof r === \"number\") {\n        if (r === channelIndex) {\n          return true;\n        }\n      } else {\n        const re = new RegExp(r);\n        if (re.test(channelName)) {\n          return true;\n        }\n      }\n    }\n  } else if (typeof c.match === \"string\") {\n    const re = new RegExp(c.match);\n    if (re.test(channelName)) {\n      return true;\n    }\n  } else {\n    throw new Error(\n      \"match is required for channel settings groups, and must be a string, number, or array of strings or numbers\"\n    );\n  }\n  return false;\n}\n\nfunction findFirstChannelMatchOfGroup(\n  channel: string,\n  channelIndex: number,\n  g: ViewerChannelGroup\n): ViewerChannelSetting | undefined {\n  for (const c of g.channels) {\n    if (matchChannel(channel, channelIndex, c)) {\n      return c;\n    }\n  }\n  return undefined;\n}\n\nexport function findFirstChannelMatch(\n  channel: string,\n  channelIndex: number,\n  settings: ViewerChannelSettings\n): ViewerChannelSetting | undefined {\n  if (!settings.groups) {\n    return undefined;\n  }\n  for (const g of settings.groups) {\n    const c = findFirstChannelMatchOfGroup(channel, channelIndex, g);\n    if (c !== undefined) {\n      return c;\n    }\n  }\n  return undefined;\n}\n\nexport function getDisplayName(name: string, index: number, settings?: ViewerChannelSettings): string {\n  if (settings) {\n    const c = findFirstChannelMatch(name, index, settings);\n    if (c) {\n      return c.name || name;\n    }\n  }\n  return name;\n}\n\nexport function makeChannelIndexGrouping(channels: string[], settings?: ViewerChannelSettings): ChannelGrouping {\n  if (!channels) {\n    return {};\n  }\n  if (!settings) {\n    // return all channels\n    return { [SINGLE_GROUP_CHANNEL_KEY]: channels.map((_val, index) => index) };\n  }\n\n  const groups = settings.groups;\n  const grouping: ChannelGrouping = {};\n  const channelsMatched: number[] = [];\n  // this is kinda inefficient but we want to ensure the order as specified in viewerChannelSettings\n  if (groups !== undefined) {\n    for (const g of groups) {\n      grouping[g.name] = [];\n      g.channels.forEach((groupMatch) => {\n        // check all channels against the match\n        channels.forEach((channel, index) => {\n          // make sure channel was not already matched someplace.\n          if (!channelsMatched.includes(index)) {\n            if (matchChannel(channel, index, groupMatch)) {\n              grouping[g.name].push(index);\n              channelsMatched.push(index);\n            }\n          }\n        });\n      });\n    }\n  }\n  // now any channels not still matched go in the catchall group.\n  if (channelsMatched.length < channels.length) {\n    const remainderGroupName = groups.length === 0 ? SINGLE_GROUP_CHANNEL_KEY : OTHER_CHANNEL_KEY;\n    grouping[remainderGroupName] = [];\n    channels.forEach((channel, index) => {\n      // make sure channel was not already matched someplace.\n      if (!channelsMatched.includes(index)) {\n        grouping[remainderGroupName].push(index);\n      }\n    });\n  }\n  return grouping;\n}\n","import type { ChannelState } from \"../../state/types\";\nimport { getDefaultChannelState } from \"../constants\";\nimport type { ColorArray } from \"./colorRepresentations\";\nimport type { ViewerChannelSetting, ViewerChannelSettings } from \"./viewerChannelSettings\";\nimport { findFirstChannelMatch, getDisplayName } from \"./viewerChannelSettings\";\n\n/** Returns the indices of channels that have either the volume or isosurface enabled. */\nexport function getEnabledChannelIndices(channelSettings: ChannelState[]): number[] {\n  const enabledChannels = [];\n  for (let i = 0; i < channelSettings.length; i++) {\n    if (channelSettings[i].volumeEnabled || channelSettings[i].isosurfaceEnabled) {\n      enabledChannels.push(i);\n    }\n  }\n  return enabledChannels;\n}\n\nexport function colorHexToArray(hex: string): ColorArray | null {\n  // hex is a xxxxxx string. split it into array of rgb ints\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  if (result) {\n    return [parseInt(result[1], 16), parseInt(result[2], 16), parseInt(result[3], 16)];\n  } else {\n    return null;\n  }\n}\n\nexport function initializeOneChannelSetting(\n  channelName: string,\n  index: number,\n  defaultColor: ColorArray,\n  viewerChannelSettings?: ViewerChannelSettings,\n  defaultChannelState: ChannelState = getDefaultChannelState()\n): ChannelState {\n  let initSettings = {} as Partial<ViewerChannelSetting>;\n  if (viewerChannelSettings) {\n    // search for channel in settings using groups, names and match values\n    initSettings = findFirstChannelMatch(channelName, index, viewerChannelSettings) ?? {};\n  }\n\n  return {\n    name: channelName ?? \"Channel \" + index,\n    displayName: getDisplayName(channelName ?? \"Channel \" + index, index, viewerChannelSettings),\n    volumeEnabled: initSettings.enabled ?? defaultChannelState.volumeEnabled,\n    isosurfaceEnabled: initSettings.surfaceEnabled ?? defaultChannelState.isosurfaceEnabled,\n    colorizeEnabled: initSettings.colorizeEnabled ?? defaultChannelState.colorizeEnabled,\n    colorizeAlpha: initSettings.colorizeAlpha ?? defaultChannelState.colorizeAlpha,\n    isovalue: initSettings.isovalue ?? defaultChannelState.isovalue,\n    opacity: initSettings.surfaceOpacity ?? defaultChannelState.opacity,\n    color: colorHexToArray(initSettings.color ?? \"\") ?? defaultColor,\n    useControlPoints: initSettings.controlPointsEnabled ?? defaultChannelState.useControlPoints,\n    keepIntensityRange: initSettings.keepIntensityRange ?? defaultChannelState.keepIntensityRange,\n    // Note: The below values are placeholders and will be overridden (and the\n    // initial settings applied) when the channel is first loaded.\n    controlPoints: initSettings.controlPoints ?? defaultChannelState.controlPoints,\n    ramp: initSettings.ramp ?? defaultChannelState.ramp,\n    plotMin: defaultChannelState.plotMin,\n    plotMax: defaultChannelState.plotMax,\n  };\n}\n","import { RenderMode, ViewMode } from \"../shared/enums\";\nimport type { ViewerState } from \"../state/types\";\n\n// TODO move back to a new `types` module (?)\ntype ViewerSettingChangeHandlers = {\n  [K in keyof ViewerState]?: (value: Partial<ViewerState[K]>, settings: ViewerState) => Partial<ViewerState>;\n};\n\nconst isRecord = <T>(val: T): val is Extract<T, Record<string, unknown>> =>\n  typeof val === \"object\" && val !== null && !Array.isArray(val);\n\nconst VIEWER_SETTINGS_CHANGE_HANDLERS: ViewerSettingChangeHandlers = {\n  // Do not allow path trace render mode in 2D view modes\n  viewMode: (viewMode, { renderMode }) => {\n    const switchToVolumetric = viewMode !== ViewMode.threeD && renderMode === RenderMode.pathTrace;\n    return {\n      viewMode,\n      renderMode: switchToVolumetric ? RenderMode.volumetric : renderMode,\n    };\n  },\n\n  // Don't switch to path trace rendering in any view mode other than 3d; if we do switch, turn off autorotate\n  renderMode: (renderMode, { viewMode, autorotate }) => {\n    const willPathtrace = renderMode === RenderMode.pathTrace;\n    if (willPathtrace && viewMode !== ViewMode.threeD) {\n      return {};\n    }\n\n    return {\n      renderMode,\n      autorotate: autorotate && !willPathtrace,\n    };\n  },\n\n  // Do not allow autorotate while in pathtrace mode (button should be disabled, but this provides extra security)\n  autorotate: (autorotate, { renderMode }) => ({\n    autorotate: autorotate && renderMode !== RenderMode.pathTrace,\n  }),\n};\n\n/**\n * Accepts a `key` and a new (potentially partial) `value` for a single field of `ViewerState`, & returns a fragment of\n * `ViewerState` that can safely be merged into `currentState` to apply that value without creating an illegal state.\n */\nexport const validateStateValue = <K extends keyof ViewerState>(\n  currentState: ViewerState,\n  key: K,\n  value: Partial<ViewerState[K]>\n): Partial<ViewerState> => {\n  const changeHandler = VIEWER_SETTINGS_CHANGE_HANDLERS[key];\n\n  if (changeHandler) {\n    // some settings have custom change handlers to avoid creating illegal states; if this one has one, call it\n    return changeHandler(value, currentState);\n  } else {\n    // if not, merge the new value to the current one (if applicable) and return\n    const currentValue = currentState[key];\n    const nextValue = isRecord(currentValue) && isRecord(value) ? { ...currentValue, ...value } : value;\n    return { [key]: nextValue };\n  }\n};\n\n/** Ensures a fragment of `ViewerState` can be safely merged into `currentState` without creating an illegal state. */\nexport const validateState = (\n  currentState: ViewerState,\n  newState: Partial<{ [K in keyof ViewerState]: Partial<ViewerState[K]> }>\n): Partial<ViewerState> => {\n  const validated = {};\n\n  for (const key of Object.keys(newState) as (keyof ViewerState)[]) {\n    Object.assign(validated, validateStateValue(currentState, key, newState[key]));\n  }\n\n  return validated;\n};\n","import type { StateCreator } from \"zustand\";\n\nimport {\n  getDefaultCameraState,\n  getDefaultChannelColor,\n  getDefaultChannelState,\n  getDefaultViewerState,\n} from \"../shared/constants\";\nimport { ViewMode } from \"../shared/enums\";\nimport type { ViewerChannelSettings } from \"../shared/utils/viewerChannelSettings\";\nimport { getEnabledChannelIndices, initializeOneChannelSetting } from \"../shared/utils/viewerState\";\nimport type { ChannelState, ViewerState } from \"../state/types\";\nimport type { ViewerStore } from \"./store\";\nimport { validateState } from \"./util\";\n\nexport type ResetStateActions = {\n  /**\n   * Removes the channel from the list of channels to be reset (as given by\n   * `getChannelsAwaitingReset()` or `getChannelsAwaitingResetOnLoad()`).\n   */\n  onResetChannel: (channelIndex: number) => void;\n\n  /**\n   * Resets the viewer and all channels to a saved initial state, determined\n   * by viewer props.\n   */\n  resetToSavedViewerState: (savedState?: Partial<ViewerState>, viewerChannelSettings?: ViewerChannelSettings) => void;\n\n  /**\n   * Resets the viewer and all channels to the default state, as though\n   * loaded from scratch with no initial parameters set.\n   * Uses the default channel settings as given by `getDefaultViewerChannelSettings()`.\n   */\n  resetToDefaultViewerState: () => void;\n};\n\nexport type ResetState = {\n  useDefaultViewerChannelSettings: boolean;\n  channelsToReset: number[];\n  channelsToResetOnLoad: number[];\n};\n\nexport type ResetStateSlice = ResetStateActions & ResetState;\n\nconst resetState = (\n  currentState: ViewerState & { channelSettings: ChannelState[] },\n  newState: ViewerState,\n  newChannelStates: ChannelState[]\n): ViewerState & Partial<ResetState> & { channelSettings: ChannelState[] } => {\n  const { channelSettings, viewMode, time, slice, scene } = currentState;\n\n  // Needs reset on reload if one of the view modes is 2D while the other is 3D,\n  // if the timestamp is different, or if we're on a different z slice.\n  // TODO: Handle stopping playback? Requires playback to be part of ViewerStateContext\n  const isInDifferentViewMode =\n    viewMode !== newState.viewMode && (viewMode === ViewMode.xy || newState.viewMode === ViewMode.xy);\n  const isAtDifferentTime = time !== newState.time;\n  const isAtDifferentZSlice = newState.viewMode === ViewMode.xy && !(newState.slice.z === slice.z);\n  const isAtDifferentScene = newState.scene !== scene;\n  const willNeedResetOnLoad = isInDifferentViewMode || isAtDifferentTime || isAtDifferentZSlice || isAtDifferentScene;\n\n  const viewerState = validateState(currentState, newState);\n  // Match the names in the new state with the existing state so we do not override the names.\n  // Also don't reset the control points or ramps, since these will be reset in the app.\n  const channelState = newChannelStates.map((state, index) => ({\n    ...state,\n    name: channelSettings[index].name,\n    displayName: channelSettings[index].displayName,\n    controlPoints: channelSettings[index].controlPoints,\n    ramp: channelSettings[index].ramp,\n    plotMin: channelSettings[index].plotMin,\n    plotMax: channelSettings[index].plotMax,\n  }));\n\n  let channelsToReset = [...Array(newChannelStates.length).keys()];\n  let channelsToResetOnLoad: number[] = [];\n  if (willNeedResetOnLoad) {\n    channelsToResetOnLoad = getEnabledChannelIndices(newChannelStates);\n    channelsToReset = channelsToReset.filter((ch) => !channelsToResetOnLoad.includes(ch));\n  }\n\n  return {\n    ...(viewerState as ViewerState),\n    channelSettings: channelState,\n    channelsToReset,\n    channelsToResetOnLoad,\n  };\n};\n\nexport const createResetSlice: StateCreator<ViewerStore, [], [], ResetStateSlice> = (set) => ({\n  channelsToReset: [],\n  channelsToResetOnLoad: [],\n  savedViewerChannelSettings: undefined,\n  useDefaultViewerChannelSettings: false,\n\n  onResetChannel: (channelIndex) => {\n    set(({ channelsToReset, channelsToResetOnLoad }) => ({\n      channelsToReset: channelsToReset.filter((ch) => ch !== channelIndex),\n      channelsToResetOnLoad: channelsToResetOnLoad.filter((ch) => ch !== channelIndex),\n    }));\n  },\n\n  resetToSavedViewerState: (savedState?: Partial<ViewerState>, viewerChannelSettings?: ViewerChannelSettings) => {\n    set((currentState) => {\n      const { channelSettings } = currentState;\n      const newViewerState = {\n        ...getDefaultViewerState(),\n        cameraState: getDefaultCameraState(savedState?.viewMode ?? ViewMode.threeD),\n        ...savedState,\n      };\n\n      const newChannelSettings = channelSettings.map((_, index) => {\n        return initializeOneChannelSetting(\n          channelSettings[index].name,\n          index,\n          getDefaultChannelColor(index),\n          viewerChannelSettings\n        );\n      });\n\n      return {\n        ...resetState(currentState, newViewerState, newChannelSettings),\n        useDefaultViewerChannelSettings: false,\n      };\n    });\n  },\n\n  resetToDefaultViewerState: () => {\n    set((currentState) => {\n      const { channelSettings } = currentState;\n      const defaultViewerState = {\n        ...getDefaultViewerState(),\n        cameraState: getDefaultCameraState(ViewMode.threeD),\n      };\n      const defaultChannelStates = channelSettings.map((_, index) => {\n        const defaultState = getDefaultChannelState(index);\n        defaultState.volumeEnabled = index < 3;\n        return defaultState;\n      });\n\n      return {\n        ...resetState(currentState, defaultViewerState, defaultChannelStates),\n        useDefaultViewerChannelSettings: true,\n      };\n    });\n  },\n});\n","import { create, type StateCreator } from \"zustand\";\nimport { subscribeWithSelector } from \"zustand/middleware\";\n\nimport { getDefaultViewerState } from \"../shared/constants\";\nimport type { ColorArray } from \"../shared/utils/colorRepresentations\";\nimport { createResetSlice, type ResetStateSlice } from \"./reset\";\nimport type { ChannelState, ViewerState } from \"./types\";\nimport { validateState, validateStateValue } from \"./util\";\n\nexport type ViewerStateActions = {\n  changeViewerSetting: <K extends keyof ViewerState>(key: K, value: Partial<ViewerState[K]>) => void;\n  mergeViewerSettings: (value: Partial<{ [K in keyof ViewerState]: Partial<ViewerState[K]> }>) => void;\n  changeChannelSetting: <K extends keyof ChannelState>(\n    index: number | number[],\n    value: Partial<Record<K, ChannelState[K]>>\n  ) => void;\n  replaceAllChannelSettings: (channelSettings: ChannelState[]) => void;\n  applyColorPresets: (colors: ColorArray[]) => void;\n};\n\nexport type ViewerStore = ViewerState &\n  ViewerStateActions &\n  ResetStateSlice & {\n    channelSettings: ChannelState[];\n  };\n\nconst createViewerStateStore: StateCreator<ViewerStore> = (set, ...etc) => ({\n  ...createResetSlice(set, ...etc),\n  ...getDefaultViewerState(),\n  channelSettings: [],\n\n  changeViewerSetting: (key, value) => set((state) => validateStateValue(state, key, value)),\n\n  mergeViewerSettings: (settings) => set((state) => validateState(state, settings)),\n\n  changeChannelSetting: (index, value) => {\n    set(({ channelSettings }) => ({\n      channelSettings: channelSettings.map((channel, channelIndex) => {\n        const changeThisChannel = Array.isArray(index) ? index.includes(channelIndex) : index === channelIndex;\n        return changeThisChannel ? { ...channel, ...value } : channel;\n      }),\n    }));\n  },\n\n  replaceAllChannelSettings: (channelSettings) => set({ channelSettings }),\n\n  applyColorPresets: (colors) => {\n    set(({ channelSettings }) => ({\n      channelSettings: channelSettings.map((channel, channelIndex) => ({\n        ...channel,\n        color: colors[channelIndex % colors.length],\n      })),\n    }));\n  },\n});\n\nexport const useViewerState = create<ViewerStore>()(subscribeWithSelector(createViewerStateStore));\n\nexport const selectViewerSettings = (store: ViewerStore): ViewerState => ({\n  viewMode: store.viewMode,\n  renderMode: store.renderMode,\n  imageType: store.imageType,\n  showAxes: store.showAxes,\n  showBoundingBox: store.showBoundingBox,\n  boundingBoxColor: store.boundingBoxColor,\n  backgroundColor: store.backgroundColor,\n  autorotate: store.autorotate,\n  maskAlpha: store.maskAlpha,\n  brightness: store.brightness,\n  density: store.density,\n  levels: store.levels,\n  interpolationEnabled: store.interpolationEnabled,\n  region: store.region,\n  slice: store.slice,\n  time: store.time,\n  scene: store.scene,\n  cameraState: store.cameraState,\n});\n\n/**\n * A small boilerplate-reducer for subscribing to a single state value with `useViewerStore`.\n * Should only be used with string literals for best type-checking results.\n */\nexport const select = <K extends string>(key: K) => {\n  return <V>(settings: Record<K, V>) => settings[key];\n};\n","import {  type ControlPoint, type Histogram, Lut, type Volume } from \"@aics/vole-core\";\n\nimport { LUT_MAX_PERCENTILE, LUT_MIN_PERCENTILE, TFEDITOR_DEFAULT_COLOR, TFEDITOR_MAX_BIN } from \"../constants\";\nimport { findFirstChannelMatch, type ViewerChannelSetting, type ViewerChannelSettings } from \"./viewerChannelSettings\";\n\n/**\n * @param {Object[]} controlPoints - array of `{x:number, opacity:number,\n * color:string}`, where `x` is a histogram bin index.\n * @returns {Uint8Array} array of length 256*4 representing the rgba values of\n * the gradient\n */\nexport function binIndexedControlPointsToLut(controlPoints: ControlPoint[]): Lut {\n  const lut = new Lut().createFromControlPoints(controlPoints);\n  return lut;\n}\n\n/** Returns a default lookup table based on a min/max percentile of the current volume's data. */\nexport function getDefaultLut(histogram: Histogram): Lut {\n  const hmin = histogram.findBinOfPercentile(LUT_MIN_PERCENTILE);\n  const hmax = histogram.findBinOfPercentile(LUT_MAX_PERCENTILE);\n  return new Lut().createFromMinMax(hmin, hmax);\n}\n\n/**\n * Parses a single LUT value from a string, where the value is either a number, a percentile, or a median multiplier.\n */\nfunction parseLutValue(value: string, histogram: Histogram): number {\n  // look at first char of string.\n  const firstChar = value.charAt(0);\n  if (firstChar === \"m\") {\n    // median\n    const parsedValue = parseFloat(value.substring(1)) / 100.0;\n    return histogram.maxBin * parsedValue;\n  } else if (firstChar === \"p\") {\n    // percentile\n    const parsedValue = parseFloat(value.substring(1)) / 100.0;\n    return histogram.findBinOfPercentile(parsedValue);\n  } else if (firstChar === \"v\") {\n    // value\n    const parsedValue = parseFloat(value.substring(1));\n    return histogram.findFractionalBinOfValue(parsedValue);\n  } else {\n    // plain number\n    return parseFloat(value);\n  }\n}\n\n/**\n * Parses a lookup table (LUT) from a `ViewerChannelSetting` object, where the\n * `lut` field is an array of two alphanumeric strings.\n *\n * @returns a Lut object if the `lut` field is valid; otherwise, returns\n * undefined.\n *\n * Min and max values are determined as following:\n * - Plain numbers are indices of histogram bins, typically in the range [0,\n *   255].\n * - `v{n}` represents a raw intensity value, where `n` is a number.\n * - `p{n}` represents a percentile, where `n` is a percentile in the [0, 100]\n *   range.\n * - `m{n}` represents the median multiplied by `n / 100`.\n * - `autoij` in either the min or max fields will use the \"auto\" algorithm from\n *   ImageJ to select the min and max.\n *\n * @example\n * ```\n * \"0:255\"    // min: bin 0, max: bin 255.\n * \"v100:v150\" // min: intensity 100, max: intensity 150.\n * \"p50:p90\"  // min: 50th percentile, max: 90th percentile.\n * \"m1:p75\"   // min: median, max: 75th percentile.\n * \"autoij:0\" // use Auto-IJ to calculate min and max.\n * ```\n */\nexport function parseLutFromSettings(histogram: Histogram, initSettings: ViewerChannelSetting): Lut | undefined {\n  // TODO: Consider minimizing the types/classes this function is interacting\n  // with, since it is only using `initSettings.lut` and the returned Lut is a\n  // wrapper around the control point array, e.g.\n  // `parseControlPointsFromLutParam(histogram: Histogram, lutParam: [string,\n  // string] | undefined): ControlPoint[] | undefined`\n\n  // There are two possible locations for the LUT settings, due to legacy\n  // reasons. `initSettings.lut` is deprecated in favor of\n  // `initSettings.intensity.lut`.\n  const settingsLut = initSettings.intensity?.lut ?? initSettings.lut;\n  if (settingsLut === undefined || settingsLut.length !== 2) {\n    return undefined;\n  }\n\n  let lutValues: [number, number];\n  if (settingsLut[0] === \"autoij\" || settingsLut[1] === \"autoij\") {\n    lutValues = histogram.findAutoIJBins();\n  } else {\n    lutValues = [parseLutValue(settingsLut[0], histogram), parseLutValue(settingsLut[1], histogram)];\n  }\n  if (!Number.isFinite(lutValues[0]) || !Number.isFinite(lutValues[1])) {\n    return undefined;\n  }\n  const sortedLutValues = [Math.min(lutValues[0], lutValues[1]), Math.max(lutValues[0], lutValues[1])];\n  const controlPoints = [\n    {\n      x: sortedLutValues[0],\n      opacity: 0,\n      color: TFEDITOR_DEFAULT_COLOR,\n    },\n    {\n      x: sortedLutValues[1],\n      opacity: 1,\n      color: TFEDITOR_DEFAULT_COLOR,\n    },\n  ];\n  // Create directly from control points instead of using\n  // `Lut.createFromMinMax()` because it applies clamping to the [0, 255] range.\n  return new Lut().createFromControlPoints(controlPoints);\n}\n\n/**\n * Initializes the lookup table (LUT) that maps from volume intensity values to color + opacity and applies the LUT to the volume.\n *\n * @param aimg The loaded volume data.\n * @param channelIndex The index of the channel to initialize the LUT for.\n * @param channelSettings The ViewerChannelSettings object that may contain settings for this channel. If relevant\n * settings are not found, a default LUT will be used.\n * @returns an object containing the retrieved ramp control points and \"advanced mode\" control points.\n *\n * LUT values will be determined using the following rules:\n * - If no `lut` is provided in the `channelSettings`, a default LUT is calculated using min/max percentiles of the data.\n * - Otherwise, `lut` will be parsed as described in `ViewerChannelSettingParams.lut`.\n * - The `controlPoints` and `ramp` fields in the `channelSettings` will be used to override the returned \"advanced mode\"\n * control points and ramp, respectively.\n *\n * If `controlPointsEnabled` is set to true in the `channelSettings`, the \"advanced mode\" control points will be applied\n * to the volume; otherwise, the ramp will be applied.\n */\nexport function initializeLut(\n  aimg: Volume,\n  channelIndex: number,\n  channelSettings?: ViewerChannelSettings\n): { ramp: ControlPoint[]; controlPoints: ControlPoint[] } {\n  const histogram = aimg.getHistogram(channelIndex);\n  const defaultLut = getDefaultLut(histogram);\n\n  let ramp: ControlPoint[] = [];\n  let controlPoints: ControlPoint[] = [];\n  let lut = defaultLut;\n\n  const name = aimg.channelNames[channelIndex];\n  const initSettings = channelSettings && findFirstChannelMatch(name, channelIndex, channelSettings);\n\n  // Attempt to load a LUT from the settings, which will be used as a fallback\n  // to initialize the control points and ramp.\n  if (initSettings) {\n    lut = parseLutFromSettings(histogram, initSettings) ?? defaultLut;\n  }\n\n  // Use raw intensity values for control points or ramp if provided in the\n  // settings. Otherwise, get default values from the LUT by remapping\n  // from histogram bin indices.\n  if (initSettings?.intensity?.controlPoints) {\n    // Raw intensity values can be used directly.\n    controlPoints = initSettings.intensity.controlPoints;\n  } else {\n    // No provided value; use histogram to convert from bin index to raw\n    // intensity values.\n    const binIndexedControlPoints = initSettings?.controlPoints ?? [...lut.controlPoints];\n    controlPoints = binIndexedControlPoints.map((cp) => ({\n      ...cp,\n      x: histogram.getValueFromBinIndex(cp.x),\n    }));\n  }\n\n  // Initialize the ramp\n  if (initSettings?.intensity?.ramp) {\n    ramp = rampToControlPoints(initSettings.intensity.ramp);\n  } else {\n    const binIndexedRamp = initSettings?.ramp ? rampToControlPoints(initSettings.ramp) : [...lut.controlPoints];\n    ramp = binIndexedRamp.map((cp) => ({\n      ...cp,\n      x: histogram.getValueFromBinIndex(cp.x),\n    }));\n  }\n\n  // Apply whatever lut is currently visible\n  let visibleLut: Lut;\n  if (initSettings?.controlPointsEnabled) {\n    visibleLut = new Lut().createFromControlPoints(controlPoints);\n  } else {\n    visibleLut = new Lut().createFromControlPoints(ramp);\n  }\n\n  aimg.setLut(channelIndex, visibleLut);\n  return { ramp, controlPoints };\n}\n\nexport function controlPointsToRamp(controlPoints: ControlPoint[]): [number, number] {\n  if (controlPoints.length <= 1) {\n    return [0, TFEDITOR_MAX_BIN];\n  } else if (controlPoints.length === 2) {\n    return [controlPoints[0].x, controlPoints[1].x];\n  } else if (controlPoints.length === 3) {\n    if (\n      controlPoints[0].opacity !== controlPoints[1].opacity &&\n      controlPoints[0].opacity !== controlPoints[2].opacity &&\n      controlPoints[1].opacity !== controlPoints[2].opacity\n    ) {\n      // if all 3 are unequal, assume a ramp from first to last\n      return [controlPoints[0].x, controlPoints[2].x];\n    } else if (controlPoints[0].opacity !== controlPoints[1].opacity) {\n      return [controlPoints[0].x, controlPoints[1].x];\n    } else if (controlPoints[1].opacity !== controlPoints[2].opacity) {\n      return [controlPoints[1].x, controlPoints[2].x];\n    }\n  }\n  return [controlPoints[1].x, controlPoints[controlPoints.length - 2].x];\n}\n\nexport function rampToControlPoints([min, max]: [number, number]): ControlPoint[] {\n  return [\n    { x: Math.min(min - 1, 0), opacity: 0, color: TFEDITOR_DEFAULT_COLOR },\n    { x: min, opacity: 0, color: TFEDITOR_DEFAULT_COLOR },\n    { x: max, opacity: 1, color: TFEDITOR_DEFAULT_COLOR },\n    { x: Math.max(max + 1, TFEDITOR_MAX_BIN), opacity: 1, color: TFEDITOR_DEFAULT_COLOR },\n  ];\n}\n","import type { CSSProperties } from \"react\";\n\nimport { ViewMode } from \"./enums\";\n\nexport type AxisName = \"x\" | \"y\" | \"z\";\nexport type PerAxis<T> = Record<AxisName, T>;\nexport const activeAxisMap: { [A in ViewMode]: AxisName | null } = {\n  [ViewMode.yz]: \"x\",\n  [ViewMode.xz]: \"y\",\n  [ViewMode.xy]: \"z\",\n  [ViewMode.threeD]: null,\n};\n\nexport type IsosurfaceFormat = \"GLTF\" | \"STL\";\n\nexport type Styles = { [key: string]: CSSProperties };\n\nexport type MetadataEntry = string | number | boolean | MetadataRecord | MetadataEntry[] | null | undefined;\nexport type MetadataRecord = { [key: string]: MetadataEntry };\n\nexport type ManifestJson = {\n  scenes?: string | (string | string[])[];\n  meta?: MetadataRecord[];\n};\n","export type ColorObject = { r: number; g: number; b: number };\nexport type ColorArray = [number, number, number];\n\nexport const colorObjectToArray = (obj: ColorObject): ColorArray => [obj.r, obj.g, obj.b];\n\nexport const colorArrayToObject = (arr: ColorArray): ColorObject => ({ r: arr[0], g: arr[1], b: arr[2] });\n\nexport const colorArrayToFloats = (arr: ColorArray): ColorArray => [arr[0] / 255, arr[1] / 255, arr[2] / 255];\n\nexport const colorArrayToString = (arr: ColorArray): string => `rgb(${arr[0]}, ${arr[1]}, ${arr[2]})`;\n","import { RENDERMODE_PATHTRACE, RENDERMODE_RAYMARCH, type View3d, type Volume } from \"@aics/vole-core\";\nimport { shallow } from \"zustand/shallow\";\n\nimport { RenderMode, ViewMode } from \"../shared/enums\";\nimport { activeAxisMap, type AxisName } from \"../shared/types\";\nimport { colorArrayToFloats } from \"../shared/utils/colorRepresentations\";\nimport {\n  alphaSliderToImageValue,\n  brightnessSliderToImageValue,\n  densitySliderToImageValue,\n  gammaSliderToImageValues,\n} from \"../shared/utils/sliderValuesToImageValues\";\nimport { select, type useViewerState, type ViewerStore } from \"./store\";\n\nconst REF_EQ = { fireImmediately: true };\nconst DEEP_EQ = { fireImmediately: true, equalityFn: shallow };\n\nexport const subscribeViewToState = (store: typeof useViewerState, view3d: View3d): (() => void) => {\n  const unsubscribers = [\n    // view mode\n    store.subscribe(\n      select(\"viewMode\"),\n      (viewMode) => {\n        view3d.setCameraMode(viewMode);\n        view3d.resize(null);\n      },\n      REF_EQ\n    ),\n\n    // camera state\n    store.subscribe(\n      select(\"cameraState\"),\n      (cameraState) => {\n        if (cameraState) {\n          view3d.setCameraState(cameraState);\n        }\n      },\n      DEEP_EQ\n    ),\n\n    // autorotate\n    store.subscribe(select(\"autorotate\"), view3d.setAutoRotate.bind(view3d), REF_EQ),\n\n    // show axes\n    store.subscribe(select(\"showAxes\"), view3d.setShowAxis.bind(view3d), REF_EQ),\n\n    // background color\n    store.subscribe(\n      select(\"backgroundColor\"),\n      (backgroundColor) => view3d.setBackgroundColor(colorArrayToFloats(backgroundColor)),\n      REF_EQ\n    ),\n\n    // brightness\n    store.subscribe(\n      select(\"brightness\"),\n      (brightness) => {\n        view3d.updateExposure(brightnessSliderToImageValue(brightness));\n      },\n      REF_EQ\n    ),\n  ];\n\n  return () => unsubscribers.forEach((unsubscribe) => unsubscribe());\n};\n\ntype AxisClipUpdateInfo = {\n  region: [number, number];\n  slice: number;\n  viewMode: ViewMode;\n};\n\nconst selectAxisClipUpdateInfo = (axis: AxisName): ((store: ViewerStore) => AxisClipUpdateInfo) => {\n  return ({ region, slice, viewMode }) => ({ region: region[axis], slice: slice[axis], viewMode });\n};\n\nexport const subscribeImageToState = (store: typeof useViewerState, view3d: View3d, image: Volume): (() => void) => {\n  const axisClipUpdater = (axis: AxisName) => {\n    return ({ region: [minval, maxval], slice, viewMode }: AxisClipUpdateInfo) => {\n      let isOrthoAxis = false;\n      let axismin = 0.0;\n      let axismax = 1.0;\n      if (viewMode === ViewMode.threeD) {\n        // 3d mode: just use the region from state\n        axismin = minval;\n        axismax = maxval;\n      } else {\n        // 2d mode: if this is the looked-down axis...\n        if (activeAxisMap[viewMode] === axis) {\n          // ...show a one-slice region around `slice`\n          const oneSlice = 1 / image.imageInfo.volumeSize[axis];\n          axismin = slice;\n          axismax = slice + oneSlice;\n        } else {\n          // ...otherwise, reset to [0, 1] - we probably just changed `viewMode` to 2d and want to see the whole slice\n          axismin = 0.0;\n          axismax = 1.0;\n        }\n\n        // also, \"look down z\" has a special mode with its own special setting\n        if (axis === \"z\" && viewMode === ViewMode.xy) {\n          view3d.setZSlice(image, Math.floor(slice * image.imageInfo.volumeSize.z));\n        }\n      }\n\n      // view3d wants the coordinates in the -0.5 to 0.5 range\n      view3d.setAxisClip(image, axis, axismin - 0.5, axismax - 0.5, isOrthoAxis);\n      // TODO necessary?\n      // view3d.setCameraMode(viewMode);\n      // TODO under some circumstances, this effect will trigger a load. Ideally, this would be reflected in the load\n      //   state managed by `useVolume`. This is complicated by the fact that the relevant methods (`setAxisClip` and\n      //   `setZSlice`) don't provide a channel load callback like other load-triggering methods (e.g. `setTime`).\n    };\n  };\n\n  const unsubscribers = [\n    // show bounding box\n    store.subscribe(\n      select(\"showBoundingBox\"),\n      (showBoundingBox) => view3d.setShowBoundingBox(image, showBoundingBox),\n      REF_EQ\n    ),\n\n    // bounding box color\n    store.subscribe(\n      select(\"boundingBoxColor\"),\n      (boundingBoxColor) => view3d.setBoundingBoxColor(image, colorArrayToFloats(boundingBoxColor)),\n      REF_EQ\n    ),\n\n    // render mode\n    store.subscribe(\n      select(\"renderMode\"),\n      (renderMode) => {\n        view3d.setMaxProjectMode(image, renderMode === RenderMode.maxProject);\n        view3d.setVolumeRenderMode(renderMode === RenderMode.pathTrace ? RENDERMODE_PATHTRACE : RENDERMODE_RAYMARCH);\n        view3d.updateActiveChannels(image);\n      },\n      REF_EQ\n    ),\n\n    // mask alpha\n    store.subscribe(\n      select(\"maskAlpha\"),\n      (maskAlpha) => {\n        view3d.updateMaskAlpha(image, alphaSliderToImageValue(maskAlpha));\n        view3d.updateActiveChannels(image);\n      },\n      REF_EQ\n    ),\n\n    // density\n    store.subscribe(\n      select(\"density\"),\n      (density) => view3d.updateDensity(image, densitySliderToImageValue(density)),\n      REF_EQ\n    ),\n\n    // gamma\n    store.subscribe(\n      select(\"levels\"),\n      (levels) => {\n        const { min, max, scale } = gammaSliderToImageValues(levels);\n        view3d.setGamma(image, min, max, scale);\n      },\n      REF_EQ\n    ),\n\n    // interpolation\n    store.subscribe(\n      select(\"interpolationEnabled\"),\n      (enabled) => view3d.setInterpolationEnabled(image, enabled),\n      REF_EQ\n    ),\n\n    // clipping\n    store.subscribe(selectAxisClipUpdateInfo(\"x\"), axisClipUpdater(\"x\"), DEEP_EQ),\n    store.subscribe(selectAxisClipUpdateInfo(\"y\"), axisClipUpdater(\"y\"), DEEP_EQ),\n    store.subscribe(selectAxisClipUpdateInfo(\"z\"), axisClipUpdater(\"z\"), DEEP_EQ),\n\n    // TODO reset channels, time, scene?\n  ];\n\n  return () => unsubscribers.forEach((unsubscribe) => unsubscribe());\n};\n","type ImageValues = {\n  min: number;\n  max: number;\n  scale: number;\n};\n\nexport const gammaSliderToImageValues = (sliderValues: [number, number, number]): ImageValues => {\n  let min = Number(sliderValues[0]);\n  let mid = Number(sliderValues[1]);\n  let max = Number(sliderValues[2]);\n\n  if (mid > max || mid < min) {\n    mid = 0.5 * (min + max);\n  }\n  let div = 255;\n  min /= div;\n  max /= div;\n  mid /= div;\n  let diff = max - min;\n  let x = (mid - min) / diff;\n  let scale = 4 * x * x;\n  if ((mid - 0.5) * (mid - 0.5) < 0.0005) {\n    scale = 1.0;\n  }\n  return {\n    min,\n    max,\n    scale,\n  };\n};\n\n// Density and brightness were once overloaded for the two rendering modes in the volume viewer (raymarch & pathtrace).\n// Now both work the same, and the mapping from slider values to numbers in vole-core is relatively straightforward.\n// But the mapping can still be tweaked here in the future, should we want to.\n\n/** vole-core expects a value from 0..1 for density. */\nexport const densitySliderToImageValue = (sliderValue: number): number => sliderValue / 100.0;\n\n/** vole-core expects a value from 0..1 for brigness. */\nexport const brightnessSliderToImageValue = (sliderValue: number): number => sliderValue / 100.0;\n\n/** vole-core expects a value from 0..1 for alpha, and its scale is inverted from the app's slider. */\nexport const alphaSliderToImageValue = (sliderValue: number): number => 1 - sliderValue / 100.0;\n","import type { AxisName } from \"../types\";\n\ntype PlayAxisName = AxisName | \"t\";\n\nconst PLAY_STEP_INTERVAL_MS = 125;\n\nexport default class PlayControls {\n  playingAxis: PlayAxisName | null = null;\n  playWaitingForLoad = false;\n  playHolding = false;\n  playTimeoutId = 0;\n\n  public getVolumeIsLoaded?: () => boolean;\n  public stepAxis?: (axis: PlayAxisName) => void;\n  public onPlayingAxisChanged?: (axis: PlayAxisName | null) => void;\n\n  private setPlayingAxis(axis: PlayAxisName | null): void {\n    this.playingAxis = axis;\n    this.onPlayingAxisChanged?.(axis);\n  }\n\n  private playStep(): void {\n    if (!this.playingAxis || this.playHolding || !this.stepAxis) {\n      return;\n    }\n    // If the volume is not loaded, wait for it to load before continuing\n    if (!this.getVolumeIsLoaded?.()) {\n      this.playWaitingForLoad = true;\n      return;\n    }\n\n    this.stepAxis(this.playingAxis);\n    this.playTimeoutId = window.setTimeout(this.playStep.bind(this), PLAY_STEP_INTERVAL_MS);\n  }\n\n  /** Call whenever new data is loaded to resume playback if it was paused for data loading. */\n  onImageLoaded(): void {\n    if (this.playWaitingForLoad) {\n      this.playWaitingForLoad = false;\n      this.playStep();\n    }\n  }\n\n  /**\n   * Pause playback on the currently playing axis.\n   * `willResume` marks this as a temporary suspension, e.g. while the user is scrubbing along the playing axis.\n   */\n  pause(willResume: boolean = false): void {\n    window.clearTimeout(this.playTimeoutId);\n    this.playTimeoutId = 0;\n    this.playWaitingForLoad = false;\n    if (this.playingAxis !== null && !willResume) {\n      this.playHolding = false;\n      this.setPlayingAxis(null);\n    }\n  }\n\n  /** Begin playback on `axis`. */\n  play(axis: PlayAxisName): void {\n    if (this.playingAxis !== null) {\n      this.pause(true);\n    }\n    this.setPlayingAxis(axis);\n    this.playStep();\n  }\n\n  /** If `axis` is currently playing, begin a temporary hold on playback while other input is pending. */\n  startHold(axis: PlayAxisName): void {\n    this.playHolding = true;\n    this.pause(axis === this.playingAxis);\n  }\n\n  /** If a playback hold is active, end it. */\n  endHold(): void {\n    if (this.playHolding) {\n      this.playHolding = false;\n      this.playStep();\n    }\n  }\n}\n","import type {\n  CreateLoaderOptions,\n  LoadSpec,\n  PrefetchDirection,\n  RawArrayLoaderOptions,\n  Volume,\n  VolumeLoaderContext,\n} from \"@aics/vole-core\";\nimport { VolumeFileFormat } from \"@aics/vole-core\";\nimport type { ThreadableVolumeLoader } from \"@aics/vole-core/es/types/loaders/IVolumeLoader\";\n\nexport type LoadSceneOptions = {\n  onCreateScene?: (volume: Volume, sceneIndex: number) => void;\n  onChannelLoaded?: (volume: Volume, channelIndex: number) => void;\n};\n\nexport default class SceneStore {\n  context: VolumeLoaderContext;\n  loaders: (ThreadableVolumeLoader | undefined)[];\n  paths: (string | string[] | RawArrayLoaderOptions)[];\n  currentScene: number = 0;\n  syncChannels: boolean = false;\n  prefetchPriority: PrefetchDirection[] = [];\n\n  constructor(context: VolumeLoaderContext, paths: (string | string[] | RawArrayLoaderOptions)[]) {\n    this.paths = paths;\n    this.context = context;\n    this.loaders = new Array(paths.length).fill(undefined);\n  }\n\n  /** Get the loader associated with the given scene index, or create it if it doesn't exist */\n  private async getLoader(scene: number): Promise<ThreadableVolumeLoader> {\n    this.currentScene = scene;\n    let loader = this.loaders[scene];\n\n    if (!loader) {\n      let path = this.paths[scene];\n      let options: Partial<CreateLoaderOptions> = {};\n      if (typeof path === \"object\" && !Array.isArray(path)) {\n        options.rawArrayOptions = path;\n        options.fileType = VolumeFileFormat.DATA;\n        path = \"\";\n      }\n\n      await this.context.onOpen();\n      loader = await this.context.createLoader(path, options);\n      this.loaders[scene] = loader;\n    }\n\n    loader.syncMultichannelLoading(this.syncChannels);\n    loader.setPrefetchPriority(this.prefetchPriority);\n    return loader;\n  }\n\n  public async loadScene(scene: number, image: Volume, loadSpec?: LoadSpec, options?: LoadSceneOptions): Promise<void> {\n    const loader = await this.getLoader(scene);\n    const spec = loadSpec ?? image.loadSpecRequired;\n\n    image.loader = loader;\n    image.imageInfo.imageInfo = (await loader.createImageInfo(spec)).imageInfo;\n    options?.onCreateScene?.(image, scene);\n    loader.loadVolumeData(image, spec, options?.onChannelLoaded);\n  }\n\n  public async createVolume(\n    scene: number,\n    loadSpec: LoadSpec,\n    onChannelLoaded?: (volume: Volume, channelIndex: number) => void\n  ): Promise<Volume> {\n    const loader = await this.getLoader(scene);\n    return loader.createVolume(loadSpec, onChannelLoaded);\n  }\n\n  public syncMultichannelLoading(sync: boolean): void {\n    this.syncChannels = sync;\n    const currentLoader = this.loaders[this.currentScene];\n    if (currentLoader) {\n      currentLoader.syncMultichannelLoading(sync);\n    }\n  }\n\n  public setPrefetchPriority(priority: PrefetchDirection[]): void {\n    this.prefetchPriority = priority;\n    const currentLoader = this.loaders[this.currentScene];\n    if (currentLoader) {\n      currentLoader.setPrefetchPriority(priority);\n    }\n  }\n}\n","import { LoadSpec, type RawArrayLoaderOptions, type View3d, type Volume, VolumeLoaderContext } from \"@aics/vole-core\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { Box3, Vector3 } from \"three\";\n\nimport {\n  AXIS_TO_LOADER_PRIORITY,\n  CACHE_MAX_SIZE,\n  getDefaultChannelColor,\n  getDefaultViewerChannelSettings,\n  QUEUE_MAX_LOW_PRIORITY_SIZE,\n  QUEUE_MAX_SIZE,\n} from \"../shared/constants\";\nimport { ViewMode } from \"../shared/enums\";\nimport type { AxisName } from \"../shared/types\";\nimport { useConstructor, useRefWithSetter } from \"../shared/utils/hooks\";\nimport PlayControls from \"../shared/utils/playControls\";\nimport SceneStore from \"../shared/utils/sceneStore\";\nimport type { ChannelGrouping, ViewerChannelSettings } from \"../shared/utils/viewerChannelSettings\";\nimport {  makeChannelIndexGrouping } from \"../shared/utils/viewerChannelSettings\";\nimport { initializeOneChannelSetting } from \"../shared/utils/viewerState\";\nimport { select, useViewerState } from \"../state/store\";\nimport type { ChannelState } from \"../state/types\";\n\nexport type UseVolumeOptions = {\n  viewerChannelSettings?: ViewerChannelSettings;\n  /** Callback called just once when the volume is created. */\n  onCreateImage?: (image: Volume) => void;\n  /** Callback called on any scene change, including the initial image load. */\n  onChangeScene?: (image: Volume, sceneIndex: number) => void;\n  /** Callback for when a single channel of the volume has loaded. */\n  onChannelLoaded?: (image: Volume, channelIndex: number, isInitialLoad: boolean) => void;\n  /** Callback for when image loading encounters an error. */\n  onError?: (error: unknown) => void;\n  /** The name of a channel which should be treated as a mask rather than as viewable data. */\n  maskChannelName?: string;\n};\n\nexport const enum ImageLoadStatus {\n  REQUESTED,\n  LOADING,\n  LOADED,\n  ERROR,\n}\n\nconst enum LoadType {\n  TIME,\n  SCENE,\n}\n\n// Used by `channelVersions` (see below)\nconst CHANNEL_INITIAL_LOAD = -1;\nconst CHANNEL_RELOAD = 0;\n\nexport type ReactiveVolume = {\n  image: Volume | null;\n  /**\n   * Indicates the load status of each channel:\n   *\n   * - `-1` indicates the channel has not yet loaded and will get some extra initialization (e.g. LUTs) when it loads.\n   * - `0` indicates the channel has been loaded once, but is currently waiting for new data.\n   * - `1` or greater indicates the channel is loaded. Note this is not exactly `1` to handle multiple simultaneous\n   *   loads; if multiple loads are issued before the first one completes, _incrementing_ rather than _setting_ the\n   *   version number means we react to each load when it completes, rather than just the first.\n   */\n  channelVersions: number[];\n  imageLoadStatus: ImageLoadStatus;\n  setTime: (view3d: View3d, time: number) => void;\n  setScene: (scene: number) => void;\n  playControls: PlayControls;\n  playingAxis: AxisName | \"t\" | null;\n  channelGroupedByType: ChannelGrouping;\n};\n\n/**\n * Temporary hack while `useEffectEvent` is still experimental.\n *\n * Some functions play the role of event handlers (called to notify that something has happened) _within_ an effect.\n * Without any intervention, the linter will insist the function needs to be in the effect's dependencies, even though\n * it would make no sense to re-run the effect when the handler changes. So we hide the function behind a stable ref.\n *\n * See https://react.dev/learn/separating-events-from-effects#declaring-an-effect-event\n */\nconst useEffectEventRef = <T extends undefined | ((...args: any[]) => void)>(\n  callback: T\n): React.MutableRefObject<T> => {\n  const callbackRef = useRef<T>(callback);\n  useEffect(() => {\n    callbackRef.current = callback;\n  }, [callback]);\n  return callbackRef;\n};\n\n/**\n * Hook to open a volume from one or more sources (URLs or raw data) and provide controls for (re)loading and playback.\n *\n * @param scenePaths An array of volume data sources, one per scene. These can be:\n * - a string URL to a single source, or\n * - an array of strings to load multiple sources as a single volume, or\n * - a `RawArrayLoaderOptions` object to load raw data directly.\n * @param options An optional object with callbacks and other info. See docs for `UseVolumeOptions`.\n * @returns An object with the current image, its load status, and controls for playback and loading.\n */\nconst useVolume = (\n  scenePaths: (string | string[] | RawArrayLoaderOptions)[],\n  options?: UseVolumeOptions\n): ReactiveVolume => {\n  const channelSettings = useViewerState(select(\"channelSettings\"));\n  const changeViewerSetting = useViewerState(select(\"changeViewerSetting\"));\n  const replaceAllChannelSettings = useViewerState(select(\"replaceAllChannelSettings\"));\n\n  const onErrorRef = useEffectEventRef(options?.onError);\n  const onChannelLoadedRef = useEffectEventRef(options?.onChannelLoaded);\n  const onChangeSceneRef = useEffectEventRef(options?.onChangeScene);\n  const onCreateImageRef = useEffectEventRef(options?.onCreateImage);\n  const maskChannelName = options?.maskChannelName;\n\n  // set up our big objects: the image, its loading infrastructure, and controls for playback\n  const [image, setImage] = useState<Volume | null>(null);\n  const loadContext = useConstructor(\n    () => new VolumeLoaderContext(CACHE_MAX_SIZE, QUEUE_MAX_SIZE, QUEUE_MAX_LOW_PRIORITY_SIZE)\n  );\n  const sceneLoader = useMemo(() => new SceneStore(loadContext, scenePaths), [loadContext, scenePaths]);\n  const playControls = useConstructor(() => new PlayControls());\n  const [playingAxis, setPlayingAxis] = useState<AxisName | \"t\" | null>(null);\n  useEffect(() => {\n    playControls.onPlayingAxisChanged = (axis) => {\n      const isPlaying = axis !== null;\n      setPlayingAxis(axis);\n      // prioritize prefetching along the playing axis\n      sceneLoader.setPrefetchPriority(axis ? [AXIS_TO_LOADER_PRIORITY[axis]] : []);\n      // sync multichannel loading so we don't show loaded channels one at a time\n      sceneLoader.syncMultichannelLoading(isPlaying);\n      if (image) {\n        // If we're playing and entire axis is not in memory (T always, Z likely), downlevel to speed things up\n        const { volumeSize, subregionSize } = image.imageInfo;\n        const shouldDownlevel = isPlaying && (axis === \"t\" || volumeSize[axis] !== subregionSize[axis]);\n        image.updateRequiredData({ scaleLevelBias: shouldDownlevel ? 1 : 0 });\n      }\n    };\n  }, [sceneLoader, playControls, image]);\n\n  // track which channels have been loaded\n  const [channelVersions, _setChannelVersions] = useState<number[]>([]);\n  const [channelVersionsRef, setChannelVersions] = useRefWithSetter(_setChannelVersions, channelVersions);\n\n  // Some extra items for tracking load status\n  const [loadThrewError, setLoadThrewError] = useState(false);\n  const inInitialLoadRef = useRef(true);\n\n  // derive whether the image is loaded from whether any and/or all channels are loaded\n  const imageLoadStatus = useMemo(() => {\n    if (loadThrewError) {\n      return ImageLoadStatus.ERROR;\n    }\n\n    const [allLoaded, noneLoaded] = channelVersions.reduce(\n      ([allLoaded, noneLoaded], version, idx) => {\n        const setting = channelSettings[idx];\n        if (setting && (setting.volumeEnabled || setting.isosurfaceEnabled || maskChannelName === setting.name)) {\n          const loaded = version > 0;\n          return [allLoaded && loaded, noneLoaded && !loaded];\n        }\n        return [allLoaded, noneLoaded];\n      },\n      [true, true]\n    );\n\n    if (allLoaded && inInitialLoadRef.current) {\n      inInitialLoadRef.current = false;\n    }\n\n    return noneLoaded ? ImageLoadStatus.REQUESTED : allLoaded ? ImageLoadStatus.LOADED : ImageLoadStatus.LOADING;\n  }, [channelVersions, channelSettings, maskChannelName, loadThrewError]);\n\n  const setIsLoading = useCallback(\n    (loadType: LoadType) => {\n      setLoadThrewError(false);\n      setChannelVersions(\n        channelVersionsRef.current.map((version) =>\n          // For scenes, reinitialize all channels.\n          Math.min(version, loadType === LoadType.SCENE ? CHANNEL_INITIAL_LOAD : CHANNEL_RELOAD)\n        )\n      );\n    },\n    [channelVersionsRef, setChannelVersions]\n  );\n\n  const onError = useCallback(\n    (e: unknown): never => {\n      setLoadThrewError(true);\n      onErrorRef.current?.(e);\n      throw e;\n    },\n    [onErrorRef]\n  );\n\n  // channel indexes, sorted by category\n  const [channelGroupedByType, setChannelGroupedByType] = useState<ChannelGrouping>({});\n\n  const onChannelDataLoaded = useCallback(\n    (aimg: Volume, channelIndex: number): void => {\n      // let the hook caller know that this channel has loaded\n      const isInitialLoad = channelVersionsRef.current[channelIndex] === CHANNEL_INITIAL_LOAD;\n      onChannelLoadedRef.current?.(aimg, channelIndex, isInitialLoad);\n\n      // set this channel as loaded\n      const newVersions = channelVersionsRef.current.slice();\n      newVersions[channelIndex] = Math.max(newVersions[channelIndex], CHANNEL_RELOAD) + 1;\n      setChannelVersions(newVersions);\n\n      // if the whole image has loaded, let `playControls` know (if we're playing, it may want to go to the next frame)\n      if (aimg.isLoaded()) {\n        playControls.onImageLoaded();\n      }\n    },\n    [channelVersionsRef, onChannelLoadedRef, playControls, setChannelVersions]\n  );\n\n  // effect to start the initial load of the image\n  useEffect(() => {\n    const channelSettings = useViewerState.getState().channelSettings;\n    setChannelVersions(new Array(channelVersionsRef.current.length).fill(CHANNEL_INITIAL_LOAD));\n    setLoadThrewError(false);\n    inInitialLoadRef.current = true;\n\n    const setChannelStateForNewImage = (channelNames: string[]): ChannelState[] | undefined => {\n      const { useDefaultViewerChannelSettings } = useViewerState.getState();\n      const viewerChannelSettings = useDefaultViewerChannelSettings\n        ? getDefaultViewerChannelSettings()\n        : options?.viewerChannelSettings;\n      const grouping = makeChannelIndexGrouping(channelNames, viewerChannelSettings);\n      setChannelGroupedByType(grouping);\n\n      const newChannelSettings = channelNames.map((name, index) => {\n        const color = getDefaultChannelColor(index);\n        const channelSetting =\n          channelSettings[index] ?? initializeOneChannelSetting(name, index, color, viewerChannelSettings);\n        return { ...channelSetting, name };\n      });\n      replaceAllChannelSettings(newChannelSettings);\n      return newChannelSettings;\n    };\n\n    const openImage = async (): Promise<void> => {\n      const scene = useViewerState.getState().scene;\n      const time = useViewerState.getState().time;\n\n      const loadSpec = new LoadSpec();\n      loadSpec.time = time;\n\n      const aimg = await sceneLoader.createVolume(scene, loadSpec, onChannelDataLoaded).catch(onError);\n\n      const channelNames = aimg.imageInfo.channelNames;\n      const newChannelSettings = setChannelStateForNewImage(channelNames);\n\n      setChannelVersions(new Array(channelNames.length).fill(CHANNEL_INITIAL_LOAD));\n      setImage(aimg);\n\n      onCreateImageRef.current?.(aimg);\n\n      playControls.stepAxis = (axis: AxisName | \"t\") => {\n        const time = useViewerState.getState().time;\n        const slice = useViewerState.getState().slice;\n\n        if (axis === \"t\") {\n          changeViewerSetting(\"time\", (time + 1) % aimg.imageInfo.times);\n        } else {\n          const max = aimg.imageInfo.volumeSize[axis];\n          const current = slice[axis] * max;\n          changeViewerSetting(\"slice\", { ...slice, [axis]: ((current + 1) % max) / max });\n        }\n      };\n      playControls.getVolumeIsLoaded = aimg.isLoaded.bind(aimg);\n\n      const requiredLoadSpec = new LoadSpec();\n      requiredLoadSpec.time = time;\n\n      // make the currently enabled channels \"required\":\n      // find all enabled indices in newChannelSettings:\n      const requiredChannelsToLoad = newChannelSettings\n        ? newChannelSettings.map((channel, index) => (channel.volumeEnabled ? index : -1)).filter((index) => index >= 0)\n        : [];\n\n      // add mask channel to required channels, if specified\n      const { useDefaultViewerChannelSettings } = useViewerState.getState();\n      const viewerChannelSettings = useDefaultViewerChannelSettings\n        ? getDefaultViewerChannelSettings()\n        : options?.viewerChannelSettings;\n      const maskChannelName = viewerChannelSettings?.maskChannelName;\n      if (maskChannelName) {\n        const maskChannelIndex = channelNames.indexOf(maskChannelName);\n        if (maskChannelIndex >= 0 && !requiredChannelsToLoad.includes(maskChannelIndex)) {\n          requiredChannelsToLoad.push(maskChannelIndex);\n        }\n      }\n      requiredLoadSpec.channels = requiredChannelsToLoad;\n\n      const viewMode = useViewerState.getState().viewMode;\n      const slice = useViewerState.getState().slice;\n\n      // When in 2D Z-axis view mode, we restrict the subregion to only the current slice. This is\n      // to match an optimization that volume viewer does by loading Z-slices at a higher resolution,\n      // and ensures the very first volume that is loaded is the same as the one that\n      // will be shown whenever we switch back to the same viewer settings (2D Z-axis view mode).\n      // (We don't do this for ZX and YZ modes because we assume that the data won't be chunked along the\n      // X or Y axes in ways that would improve loading resolution, and we load the full 3D volume instead.)\n      if (viewMode === ViewMode.xy) {\n        requiredLoadSpec.subregion = new Box3(new Vector3(0, 0, slice.z), new Vector3(1, 1, slice.z));\n      }\n\n      // initiate loading only after setting up new channel settings,\n      // in case the loader callback fires before the state is set\n      const onCreateScene = onChangeSceneRef.current;\n      sceneLoader.loadScene(scene, aimg, requiredLoadSpec, { onCreateScene }).catch(onError);\n    };\n\n    openImage();\n  }, [\n    sceneLoader,\n    onError,\n    onCreateImageRef,\n    onChangeSceneRef,\n    onChannelLoadedRef,\n    channelVersionsRef,\n    setChannelVersions,\n    playControls,\n    setIsLoading,\n    onChannelDataLoaded,\n    changeViewerSetting,\n    replaceAllChannelSettings,\n    options?.viewerChannelSettings,\n  ]);\n  // of the above dependencies, we expect only `sceneLoader` to change.\n\n  const setTime = useCallback(\n    (view3d: View3d, time: number): void => {\n      if (image && !inInitialLoadRef.current) {\n        view3d.setTime(image, time).catch(onError);\n        setIsLoading(LoadType.TIME);\n      }\n    },\n    [image, onError, setIsLoading, inInitialLoadRef]\n  );\n\n  const setScene = useCallback(\n    (scene: number): void => {\n      if (image && !inInitialLoadRef.current) {\n        const onCreateScene = onChangeSceneRef.current;\n        sceneLoader.loadScene(scene, image, undefined, { onCreateScene }).catch(onError);\n        setIsLoading(LoadType.SCENE);\n      }\n    },\n    [image, onError, sceneLoader, setIsLoading, inInitialLoadRef, onChangeSceneRef]\n  );\n\n  return useMemo(\n    () => ({\n      image,\n      channelVersions,\n      imageLoadStatus,\n      setTime,\n      setScene,\n      playControls,\n      playingAxis,\n      channelGroupedByType,\n    }),\n    [image, channelVersions, imageLoadStatus, setTime, setScene, playControls, playingAxis, channelGroupedByType]\n  );\n};\n\nexport default useVolume;\n","import React from \"react\";\nimport { CaretDownOutlined, CaretUpOutlined } from \"@ant-design/icons\";\n\nimport { useRefWithSetter } from \"../../../shared/utils/hooks\";\n\nimport \"./styles.css\";\n\ninterface NumericInputProps {\n  value: number;\n  step?: number;\n  precision?: number;\n  min?: number;\n  max?: number;\n  disabled?: boolean;\n  className?: string;\n  onChange: (value: number) => void;\n}\n\n/**\n * Fully-controlled numeric input (value must be supplied from state in parent).\n * Changeable with arrow keys, typing values, or clickable arrows. Inspired by\n * ant's `InputNumber`, but conforms to our style and behavior expectations.\n */\nconst NumericInput: React.FC<NumericInputProps> = ({\n  value,\n  step = 1,\n  precision = step,\n  min = 0,\n  max = Number.MAX_SAFE_INTEGER,\n  disabled = false,\n  className = \"\",\n  onChange,\n}) => {\n  // While the input has focus, allow invalid input, just don't call `onChange` with it\n  const [hasFocus, _setHasFocus] = React.useState(false);\n  // State doesn't update before focus handler runs - keep a ref following focus state\n  const [hasFocusRef, setHasFocus] = useRefWithSetter(_setHasFocus, hasFocus);\n\n  // Hold the potentially invalid contents of the focused input here\n  const [textContent, setTextContent] = React.useState(\"\");\n\n  const inputRef = React.useRef<HTMLInputElement>(null);\n\n  const clamp = (newValue: number): number => Math.min(Math.max(newValue, min), max);\n  const roundToPrecision = (newValue: number): number => clamp(Math.round(newValue / precision) * precision);\n  const shouldChange = (newValue: number): boolean => !(isNaN(newValue) || newValue === value || disabled);\n\n  const displayedValue = roundToPrecision(value);\n\n  const onFocus = (): void => {\n    if (!hasFocusRef.current) {\n      // propagate current value to `textContent` on focus\n      setTextContent(displayedValue.toString());\n      setHasFocus(true);\n    }\n  };\n\n  const changeByStep = (up: boolean): void => {\n    const delta = up ? step : -step;\n    const newValue = clamp(displayedValue + delta);\n\n    if (shouldChange(newValue)) {\n      onChange(newValue);\n      setTextContent(newValue.toString());\n      // let the focus handler know we've taken care of things, so it won't restore the previous value\n      setHasFocus(true);\n    }\n\n    inputRef.current?.focus();\n  };\n\n  const onKeyDown: React.KeyboardEventHandler<HTMLDivElement> = (event) => {\n    const { key } = event;\n\n    if ([\"Up\", \"ArrowUp\", \"Down\", \"ArrowDown\"].includes(key)) {\n      changeByStep(key === \"Up\" || key === \"ArrowUp\");\n      event.preventDefault();\n    } else if (key === \"Enter\") {\n      inputRef.current?.blur();\n    }\n  };\n\n  const handleTyping = (inputStr: string): void => {\n    setTextContent(inputStr);\n\n    // if the user clears all text, assume they mean 0 (or the extremum closest to it)\n    // this is likely not completely general, but should be reasonable for any of our purposes\n    const inputNum = inputStr === \"\" ? 0 : parseFloat(inputStr);\n    const newValue = roundToPrecision(inputNum);\n\n    if (shouldChange(newValue)) {\n      onChange(newValue);\n    }\n  };\n\n  const fullClassName = \"numinput\" + (disabled ? \" numinput-disabled\" : \"\") + (className && ` ${className}`);\n  return (\n    <div className={fullClassName} onKeyDown={onKeyDown}>\n      <input\n        value={hasFocus ? textContent : displayedValue}\n        step={step}\n        min={min}\n        max={max}\n        disabled={disabled}\n        className=\"numinput-input\"\n        autoComplete=\"off\"\n        role=\"spinbutton\"\n        aria-valuenow={displayedValue}\n        aria-valuemin={min}\n        aria-valuemax={max}\n        ref={inputRef}\n        onChange={({ target }) => handleTyping(target.value)}\n        onFocus={onFocus}\n        onBlur={() => setHasFocus(false)}\n      />\n      <div className=\"numinput-controls\">\n        <div\n          className=\"numinput-controls-button numinput-controls-button-up\"\n          role=\"button\"\n          aria-label=\"Increase Value\"\n          aria-disabled={disabled}\n          onClick={() => changeByStep(true)}\n        >\n          <CaretUpOutlined className=\"numinput-controls-button-icon\" />\n        </div>\n        <div\n          className=\"numinput-controls-button numinput-controls-button-down\"\n          role=\"button\"\n          aria-label=\"Decrease Value\"\n          aria-disabled={disabled}\n          onClick={() => changeByStep(false)}\n        >\n          <CaretDownOutlined className=\"numinput-controls-button-icon\" />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default NumericInput;\n","import Nouislider, { type NouisliderProps } from \"nouislider-react\";\nimport React from \"react\";\n\ntype CallbackArgs = Parameters<NonNullable<NouisliderProps[\"onStart\"]>>;\n\nconst MemoedNouislider = React.memo(\n  Nouislider as React.ComponentType<NouisliderProps & { noUpdate: boolean }>,\n  (_prevProps, { noUpdate }) => noUpdate\n);\n\n/** A wrapper around `Nouislider` that prevents updates while the slider is being dragged. */\nconst SmarterSlider: React.FC<NouisliderProps> = (props) => {\n  const [noUpdate, setNoUpdate] = React.useState(false);\n  const wrapEventHandler = (shouldNotUpdate: boolean, handler?: (...args: CallbackArgs) => void) => {\n    return (...args: CallbackArgs) => {\n      setNoUpdate(shouldNotUpdate);\n      if (handler) handler(...args);\n    };\n  };\n\n  const onStart = wrapEventHandler(true, props.onStart);\n  const onEnd = wrapEventHandler(false, props.onEnd);\n  return <MemoedNouislider {...{ ...props, noUpdate, onStart, onEnd }} />;\n};\n\nexport default SmarterSlider;\n","import type { Volume } from \"@aics/vole-core\";\nimport { CaretRightOutlined, PauseOutlined } from \"@ant-design/icons\";\nimport { Button, Tooltip } from \"antd\";\nimport React, { useCallback, useEffect, useState } from \"react\";\n\nimport type { ViewMode } from \"../../shared/enums\";\nimport { activeAxisMap, type AxisName, type PerAxis } from \"../../shared/types\";\nimport type PlayControls from \"../../shared/utils/playControls\";\nimport type { ViewerStateActions } from \"../../state/store\";\n\nimport NumericInput from \"../shared/NumericInput\";\nimport SmarterSlider from \"../shared/SmarterSlider\";\n\nimport \"./styles.css\";\n\nconst AXES: AxisName[] = [\"x\", \"y\", \"z\"];\n\ntype SliderRowProps = {\n  label: string;\n  vals: number[];\n  valsReadout?: number[];\n  max: number;\n  // These event handlers attach to the events of the same names provided by noUiSlider.\n  // Their behavior is documented at https://refreshless.com/nouislider/events-callbacks/\n  onSlide?: (values: number[]) => void;\n  /** `onChange` is called on the corresponding noUiSlider event AND on interaction with a spinbox. */\n  onChange?: (values: number[]) => void;\n  onStart?: () => void;\n  onEnd?: () => void;\n};\n\n/** A single slider row, with a slider, one or two spinbox inputs, and a max value */\nconst SliderRow: React.FC<SliderRowProps> = ({\n  label,\n  vals,\n  valsReadout = vals,\n  max,\n  onSlide,\n  onChange = onSlide,\n  onStart,\n  onEnd,\n}) => {\n  const isRange = vals.length > 1;\n  // If slider is a range, handles represent slice *edges*: the range around only the 1st slice is [0, 1]; the range\n  // around only the last is [max-1, max].\n  // If slider is not a range, just work with slices, but don't 0-index: 1st slice is 1, last is max\n  const min = isRange ? 0 : 1;\n  const wrappedOnSlide = isRange ? onSlide : (values: number[]) => onSlide?.([values[0] - 1]);\n  const wrappedOnChange = isRange ? onChange : (values: number[]) => onChange?.([values[0] - 1]);\n\n  return (\n    <span className=\"axis-slider-container\">\n      <span className=\"slider-name\">{label}</span>\n      {max <= min ? (\n        <i>No values to adjust</i>\n      ) : (\n        <span className=\"axis-slider\">\n          <SmarterSlider\n            className={isRange ? \"\" : \"slider-single-handle\"}\n            connect={true}\n            range={{ min, max }}\n            start={isRange ? vals : [vals[0] + 1]}\n            step={1}\n            margin={1}\n            behaviour=\"drag\"\n            pips={{\n              mode: \"positions\",\n              values: [25, 50, 75],\n              density: 25,\n              format: {\n                // remove labels from pips\n                to: () => \"\",\n              },\n            }}\n            // round slider output to nearest slice; assume any string inputs represent ints\n            format={{ to: Math.round, from: parseInt }}\n            onSlide={wrappedOnSlide}\n            onChange={wrappedOnChange}\n            onStart={onStart}\n            onEnd={onEnd}\n          />\n        </span>\n      )}\n      {max > min && (\n        <span className=\"slider-values\">\n          <NumericInput\n            min={min}\n            max={max}\n            value={valsReadout[0] + (isRange ? 0 : 1)}\n            onChange={(value) => onChange?.(isRange ? [value, vals[1]] : [value - 1])}\n          />\n          {isRange && (\n            <>\n              {\" , \"}\n              <NumericInput\n                min={min}\n                max={max}\n                value={valsReadout[1]}\n                onChange={(value) => onChange?.([vals[0], value])}\n              />\n            </>\n          )}\n          {\" / \"}\n          {max}\n        </span>\n      )}\n    </span>\n  );\n};\n\ntype PlaySliderRowProps = {\n  label: string;\n  val: number;\n  max: number;\n  playing: boolean;\n  updateWhileSliding?: boolean;\n  onTogglePlayback: (play: boolean) => void;\n  // These event handlers attach to the events of the same names provided by noUiSlider.\n  // Their behavior is documented at https://refreshless.com/nouislider/events-callbacks/\n  /**\n   * `onChange`'s behavior depends on `updateWhileSliding`: if true, it's called on slide and on release;\n   * if false, it's called only on slide.\n   */\n  onChange?: (values: number) => void;\n  onStart?: () => void;\n  onEnd?: () => void;\n};\n\n/** Wrapper around `SliderRow` that adds a play button and accounts for the case where not all of an axis is loaded */\nconst PlaySliderRow: React.FC<PlaySliderRowProps> = (props) => {\n  const { onChange, onStart, onEnd } = props;\n  // In partially-loaded axes, stores the displayed value of the slider while the user is sliding it\n  const [valReadout, setValReadout] = useState(props.val);\n  // Tracks when the user is sliding the slider and `valReadout` may have to sub in for props\n  const [sliderHeld, setSliderHeld] = useState(false);\n\n  const wrappedOnChange = useCallback(([val]: number[]) => onChange?.(val), [onChange]);\n  const wrappedSetValReadout = useCallback(([val]: number[]) => setValReadout(val), []);\n  const wrappedOnStart = useCallback((): void => {\n    setValReadout(props.val);\n    setSliderHeld(true);\n    onStart?.();\n  }, [onStart, props.val]);\n  const wrappedOnEnd = useCallback((): void => {\n    setSliderHeld(false);\n    onEnd?.();\n  }, [onEnd]);\n\n  return (\n    <>\n      <SliderRow\n        label={props.label}\n        vals={[props.val]}\n        valsReadout={props.updateWhileSliding || !sliderHeld ? undefined : [valReadout]}\n        max={props.max}\n        onSlide={props.updateWhileSliding ? wrappedOnChange : wrappedSetValReadout}\n        onChange={props.updateWhileSliding ? undefined : wrappedOnChange}\n        onStart={wrappedOnStart}\n        onEnd={wrappedOnEnd}\n      />\n      {props.max > 1 && (\n        <Tooltip placement=\"top\" title=\"Play through sequence\" trigger={[\"hover\", \"focus\"]}>\n          <Button\n            className=\"slider-play-button\"\n            onClick={() => props.onTogglePlayback(!props.playing)}\n            icon={props.playing ? <PauseOutlined /> : <CaretRightOutlined />}\n            aria-label={(props.playing ? \"Pause \" : \"Play \") + props.label}\n          />\n        </Tooltip>\n      )}\n    </>\n  );\n};\n\ntype AxisClipSlidersProps = {\n  mode: ViewMode;\n  image: Volume | null;\n  changeViewerSetting: ViewerStateActions[\"changeViewerSetting\"];\n  numSlices: PerAxis<number>;\n  numSlicesLoaded: PerAxis<number>;\n  numScenes: number;\n  region: PerAxis<[number, number]>;\n  slices: PerAxis<number>;\n  numTimesteps: number;\n  time: number;\n  scene: number;\n  playingAxis: AxisName | \"t\" | null;\n  playControls: PlayControls;\n};\n\nconst AxisClipSliders: React.FC<AxisClipSlidersProps> = (props) => {\n  const activeAxis = activeAxisMap[props.mode];\n\n  const pauseOnInput = (axis: AxisName | \"t\"): void => {\n    // Pause on slider input unless user is scrubbing along the playing axis (playback is held while this is happening)\n    if (!props.playControls.playHolding || props.playingAxis !== axis) {\n      props.playControls.pause();\n    }\n  };\n\n  const updateRegion = (axis: AxisName, minval: number, maxval: number): void => {\n    pauseOnInput(axis);\n\n    const { changeViewerSetting, numSlices } = props;\n    // get a value from 0-1\n    const max = numSlices[axis];\n    const start = minval / max;\n    const end = maxval / max;\n    changeViewerSetting(\"region\", { [axis]: [start, end] });\n  };\n\n  const updateSlice = (axis: AxisName, slice: number): void => {\n    pauseOnInput(axis);\n    props.changeViewerSetting(\"slice\", { [axis]: slice / props.numSlices[axis] });\n  };\n\n  const updateTime = (time: number): void => {\n    pauseOnInput(\"t\");\n    props.changeViewerSetting(\"time\", time);\n  };\n\n  // Pause when view mode or volume size has changed\n  useEffect(() => props.playControls.pause(), [props.mode, props.image, props.playControls]);\n\n  const handlePlayPause = (axis: AxisName | \"t\", willPlay: boolean): void => {\n    if (willPlay) {\n      props.playControls.play(axis);\n    } else {\n      props.playControls.pause();\n    }\n  };\n\n  const create2dAxisSlider = (axis: AxisName): React.ReactNode => {\n    const numSlices = props.numSlices[axis];\n    const numSlicesLoaded = props.numSlicesLoaded[axis];\n\n    return (\n      <div key={axis + numSlices + numSlicesLoaded} className={`slider-row slider-${axis}`}>\n        <PlaySliderRow\n          label={axis.toUpperCase()}\n          val={Math.round(props.slices[axis] * numSlices)}\n          max={numSlices}\n          onChange={(val) => updateSlice(axis, val)}\n          onStart={() => props.playControls.startHold(axis)}\n          onEnd={() => props.playControls.endHold()}\n          playing={props.playingAxis === axis}\n          onTogglePlayback={(willPlay) => handlePlayPause(axis, willPlay)}\n          updateWhileSliding={numSlices === numSlicesLoaded}\n        />\n      </div>\n    );\n  };\n\n  const create3dAxisSlider = (axis: AxisName): React.ReactNode => {\n    const numSlices = props.numSlices[axis];\n    if (numSlices === 1) {\n      return null;\n    }\n    const region = props.region[axis];\n\n    return (\n      <div key={axis + numSlices + \"3d\"} className={`slider-row slider-${axis}`}>\n        <SliderRow\n          label={axis.toUpperCase()}\n          vals={[Math.round(region[0] * numSlices), Math.round(region[1] * numSlices)]}\n          max={numSlices}\n          onSlide={(values) => updateRegion(axis, values[0], values[1])}\n          onStart={() => props.playControls.startHold(axis)}\n          onEnd={() => props.playControls.endHold()}\n        />\n      </div>\n    );\n  };\n\n  return (\n    <div className={activeAxis ? \"clip-sliders clip-sliders-2d\" : \"clip-sliders\"}>\n      <span className=\"slider-group\">\n        <h4 className=\"slider-group-title\">ROI</h4>\n        <span className=\"slider-group-rows\">\n          {activeAxis ? create2dAxisSlider(activeAxis) : AXES.map(create3dAxisSlider)}\n        </span>\n      </span>\n\n      {props.numTimesteps > 1 && (\n        <span className=\"slider-group\">\n          <h4 className=\"slider-group-title\">Time</h4>\n          <span className=\"slider-group-rows\">\n            <div className=\"slider-row slider-t\">\n              <PlaySliderRow\n                label={\"\"}\n                val={props.time}\n                max={props.numTimesteps}\n                playing={props.playingAxis === \"t\"}\n                onTogglePlayback={(willPlay) => handlePlayPause(\"t\", willPlay)}\n                onChange={(time) => updateTime(time)}\n                onStart={() => props.playControls.startHold(\"t\")}\n                onEnd={() => props.playControls.endHold()}\n              />\n            </div>\n          </span>\n        </span>\n      )}\n\n      {props.numScenes > 1 && (\n        <span className=\"slider-group\">\n          <h4 className=\"slider-group-title\">Scene</h4>\n          <span className=\"slider-group-rows\">\n            <div className=\"slider-row slider-scene\">\n              <SliderRow\n                label={\"\"}\n                vals={[props.scene]}\n                max={props.numScenes}\n                onChange={([scene]) => props.changeViewerSetting(\"scene\", scene)}\n              />\n            </div>\n          </span>\n        </span>\n      )}\n    </div>\n  );\n};\n\nexport default AxisClipSliders;\n","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-turnTable-f\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"arrow-tail\" d=\"M19.19,7.69c-.09,.16-.19,.3-.3,.44-.26-.29-.55-.56-.85-.8,.34-.28,.58-.61,.61-.99,.05-.55-.4-1.15-.95-1.59-.56-.45-1.23-.79-1.92-1.07-.08-.04-.12-.13-.08-.21,.03-.07,.11-.11,.19-.09,.73,.21,1.46,.48,2.15,.89,.34,.21,.67,.46,.95,.79,.28,.32,.51,.76,.55,1.25,.05,.49-.1,.99-.35,1.38Z\" fill=\"currentColor\"/>\n  <path id=\"arrow-head\" d=\"M7.85,5.12l1.54-1.8c-1.27,.03-2.52,.18-3.73,.46-.71,.16-1.4,.37-2.05,.65-.64,.28-1.25,.63-1.67,1.06-.43,.45-.54,.87-.33,1.29,.22,.45,.76,.88,1.36,1.19,1.13,.6,2.46,.94,3.81,1.15-.27,.42-.51,.87-.7,1.35-1.29-.23-2.56-.6-3.79-1.26-.71-.4-1.46-.9-1.93-1.83-.23-.46-.3-1.05-.16-1.57,.14-.53,.43-.94,.75-1.27,.65-.65,1.39-1.04,2.13-1.35,.75-.32,1.51-.54,2.28-.71,1.39-.31,2.79-.45,4.19-.46L8.28,0l5.86,3.07-6.29,2.05Z\" fill=\"currentColor\"/>\n  <path id=\"button\" d=\"M18.17,8.83c-.31-.36-.66-.67-1.05-.95h-.01c-1.09-.79-2.43-1.26-3.89-1.26-2.16,0-4.09,1.03-5.3,2.63-.33,.42-.61,.88-.82,1.38-.36,.81-.56,1.72-.56,2.67,0,3.69,2.99,6.68,6.68,6.68s6.68-2.99,6.68-6.68c0-1.73-.65-3.29-1.73-4.47Zm-4.95,10.15c-3.13,0-5.68-2.55-5.68-5.68,0-.92,.22-1.79,.62-2.56,.26-.52,.6-1,1.01-1.41,1.03-1.06,2.47-1.71,4.05-1.71,1,0,1.94,.26,2.76,.72,.5,.28,.96,.64,1.35,1.06,.97,1.01,1.57,2.38,1.57,3.9,0,3.13-2.55,5.68-5.68,5.68Z\" fill=\"currentColor\"/>\n  <path id=\"play-head\" d=\"M12.83,10.68l-1.18-.94v7.16l4.48-3.58-3.3-2.64Zm-.18,1.14l1.88,1.5-1.88,1.5v-3Z\" fill=\"currentColor\"/>\n</svg>","import axes from \"./axes.svg\";\nimport boundingBox from \"./boundingBox.svg\";\nimport camera from \"./camera.svg\";\nimport channels from \"./channels.svg\";\nimport closePanel from \"./closePanel.svg\";\nimport download from \"./download.svg\";\nimport dropdownArrow from \"./dropdownArrow.svg\";\nimport metadata from \"./metadata.svg\";\nimport preferences from \"./preferences.svg\";\nimport resetView from \"./resetView.svg\";\nimport turnTable from \"./turnTable.svg\";\n\nexport default {\n  axes,\n  boundingBox,\n  camera,\n  channels,\n  closePanel,\n  download,\n  dropdownArrow,\n  metadata,\n  preferences,\n  resetView,\n  turnTable,\n};\n","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-axes\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <circle id=\"center\" cx=\"6.26\" cy=\"12.84\" r=\"1\" fill=\"currentColor\"/>\n  <path id=\"arrow-x\" d=\"M14.27,15.23l.7-1.64h-6.86c.09-.23,.15-.48,.15-.75s-.06-.52-.15-.75h6.86l-.7-1.64,5.66,2.39-5.66,2.39Z\" fill=\"currentColor\"/>\n  <path id=\"arrow-y\" d=\"M6.26,.03L3.87,5.69l1.64-.69v5.99c.23-.1,.48-.15,.75-.15s.52,.05,.75,.15V5l1.64,.69L6.26,.03Z\" fill=\"currentColor\"/>\n  <path id=\"arrow-z\" d=\"M5.59,17.23L.07,19.91l1.93-5.83,.77,1.6,1.61-1.83s.08-.06,.11-.09c.23,.44,.62,.78,1.09,.95-.02,.04-.04,.09-.07,.12l-1.61,1.84,1.69,.56Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 20 20\">\n    <path id=\"back\" d=\"M.52,13.67m12.76-3.42c0,.21,.17,.38,.38,.38s.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25Zm-2.5,3.42c0-.21-.17-.38-.38-.38h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38Zm3.93,.52l-.68-.67s0,0,0-.01v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.05h-.88c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.1l.68,.67c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53Zm2.31,2.29l-.89-.88c-.15-.15-.38-.14-.53,0-.15,.15-.15,.38,0,.53l.89,.88c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53Zm-12.73-2.81c0-.21-.17-.38-.38-.38h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38ZM13.27,3.75c0,.21,.17,.38,.38,.38s.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25Zm.75,2c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v.08h.75v-.08Zm-.38,1.62c.21,0,.38-.17,.38-.38v-.17h-.75v.17c0,.21,.17,.38,.38,.38Zm0-3.25c.21,0,.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25c0,.21,.17,.38,.38,.38ZM3.9,13.3h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38s-.17-.38-.38-.38Zm1.62,.38c0,.19,.14,.34,.32,.36v-.73c-.18,.03-.32,.18-.32,.36Zm10.59,1.93c-.15-.15-.38-.14-.53,0-.15,.15-.15,.38,0,.53l.89,.88c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53l-.89-.88Zm2.86,2.84l-.56-.55c-.15-.15-.38-.15-.53,0-.15,.15-.15,.38,0,.53l.55,.54h.54v-.52Zm-8.58-5.14h-1.25c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.25c.21,0,.38-.17,.38-.38s-.17-.38-.38-.38Zm3.62,.22s0,0,0-.01v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.05h-.88c-.21,0-.38,.17-.38,.38s.17,.38,.38,.38h1.1l.68,.67c.07,.07,.17,.11,.26,.11s.19-.04,.27-.11c.15-.15,.15-.38,0-.53l-.68-.67Zm-.37-2.89c.21,0,.38-.17,.38-.38v-1.25c0-.21-.17-.38-.38-.38s-.38,.17-.38,.38v1.25c0,.21,.17,.38,.38,.38Zm-6.12,3.05c0-.21-.17-.38-.38-.38h-.3v.75h.3c.21,0,.38-.17,.38-.38Z\" fill=\"currentColor\"/>\n    <path id=\"front\" d=\"M19.83,5.98h0l-.7-.69L14.7,.88s-.23-.23-.69-.69c0,0,0,0,0,0,0,0,0,0,0,0h0c-.09-.09-.21-.15-.35-.15H.52C.24,.04,.02,.26,.02,.54V13.67c0,.14,.06,.26,.15,.35,0,0,0,0,0,0,.46,.46,.7,.69,.7,.69l4.44,4.41s.23,.23,.7,.69c0,0,0,0,0,0,.09,.09,.21,.15,.35,.15h13.13c.28,0,.5-.22,.5-.5V6.33c0-.14-.06-.26-.15-.35ZM5.85,13.31v4.96L1.56,14.01s-.19-.19-.55-.54V1.74L5.3,6s.19,.19,.55,.54v6.77Zm.16-8.02L1.73,1.04H13.44c.36,.36,.55,.55,.55,.55l4.28,4.25H6.55c-.36-.36-.55-.55-.55-.55Zm.84,13.68V6.83h12.13v12.13H6.85Z\" fill=\"currentColor\"/>\n</svg>\n","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"Layer_2\" data-name=\"Layer 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <g id=\"icon-camera\">\n    <path id=\"camera-body\" d=\"M29.54,32H2.46c-1.36,0-2.46-1.1-2.46-2.45V15.34c0-1.35,1.1-2.45,2.46-2.45h6.64c1.21,0,2.34-.54,3.1-1.48l.88-1.09c.75-.94,1.88-1.47,3.08-1.47h6.32c1.21,0,2.33,.54,3.08,1.47l.88,1.09c.76,.94,1.89,1.48,3.1,1.48,1.36,0,2.46,1.1,2.46,2.45v14.21c0,1.35-1.1,2.45-2.46,2.45ZM2.46,13.9c-.8,0-1.46,.65-1.46,1.45v14.21c0,.8,.65,1.45,1.46,1.45H29.54c.8,0,1.46-.65,1.46-1.45V15.34c0-.8-.65-1.45-1.46-1.45-1.52,0-2.93-.68-3.88-1.85l-.88-1.09c-.56-.7-1.4-1.1-2.3-1.1h-6.32c-.9,0-1.74,.4-2.3,1.1l-.88,1.09c-.95,1.18-2.36,1.85-3.88,1.85H2.46Zm4.25,4.85c.58,0,1.04-.46,1.04-1.03s-.47-1.03-1.04-1.03h-1.67c-.58,0-1.04,.46-1.04,1.03s.47,1.03,1.04,1.03h1.67Zm12.61-3.24c2.81,0,5.09,2.29,5.09,5.1s-2.28,5.1-5.09,5.1-5.09-2.29-5.09-5.1,2.28-5.1,5.09-5.1m0-2c-3.91,0-7.09,3.18-7.09,7.1s3.17,7.1,7.09,7.1,7.09-3.18,7.09-7.1-3.17-7.1-7.09-7.1h0Z\" fill=\"currentColor\"/>\n    <path id=\"burst-lines\" d=\"M19.39,3.87c-.28,0-.5-.22-.5-.5V.5c0-.28,.22-.5,.5-.5s.5,.22,.5,.5V3.37c0,.28-.22,.5-.5,.5Zm4.76,1.12l2.15-2.34c.19-.2,.17-.52-.03-.71-.2-.18-.52-.17-.71,.03l-2.15,2.34c-.19,.2-.17,.52,.03,.71,.1,.09,.22,.13,.34,.13,.13,0,.27-.05,.37-.16Zm-8.95,.03c.2-.19,.22-.5,.03-.71l-2.15-2.34c-.19-.2-.5-.21-.71-.03-.2,.19-.22,.5-.03,.71l2.15,2.34c.1,.11,.23,.16,.37,.16,.12,0,.24-.04,.34-.13Z\" fill=\"currentColor\"/>\n  </g>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-channels\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"line-mid\" d=\"M13.55,10.36h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Z\" fill=\"currentColor\"/>\n  <path id=\"line-top\" d=\"M2.65,6.64c-.21,0-.38-.17-.38-.38v-.3c0-.26,.03-.52,.08-.78,.04-.2,.24-.33,.45-.29,.2,.04,.33,.24,.29,.45-.04,.2-.07,.41-.07,.62v.3c0,.21-.17,.38-.38,.38Zm1.06-2.7c-.1,0-.2-.04-.28-.12-.14-.15-.13-.39,.02-.53,.27-.25,.59-.46,.92-.62,.19-.09,.41,0,.5,.18s0,.41-.18,.5c-.27,.12-.51,.29-.73,.49-.07,.07-.16,.1-.25,.1Zm9.78-.86h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Z\" fill=\"currentColor\"/>\n  <path id=\"line-bottom\" d=\"M13.44,17.69h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-3,0h-1c-.21,0-.38-.17-.38-.38s.17-.38,.38-.38h1c.21,0,.38,.17,.38,.38s-.17,.38-.38,.38Zm-2.95-.32c-.05,0-.11-.01-.16-.04-.33-.16-.64-.38-.91-.63-.15-.14-.16-.38-.02-.53s.38-.16,.53-.02c.22,.2,.46,.37,.73,.5,.19,.09,.26,.32,.17,.5-.06,.13-.2,.21-.34,.21Zm-1.78-2.28c-.17,0-.33-.12-.37-.3-.05-.24-.07-.48-.07-.73v-.34c0-.21,.17-.38,.38-.38s.38,.17,.38,.38v.34c0,.19,.02,.39,.06,.58,.04,.2-.09,.4-.29,.44-.02,0-.05,0-.08,0Z\" fill=\"currentColor\"/>\n  <path id=\"channel-composite\" d=\"M5.42,12.69H.01V7.29H5.42v5.4Zm-4.4-1h3.4v-3.4H1.01v3.4Z\" fill=\"currentColor\"/>\n  <path id=\"channel-1\" d=\"M19.99,5.41h-5.4V0h5.4V5.41Zm-4.4-1h3.4V1h-3.4v3.4Z\" fill=\"currentColor\"/>\n  <path id=\"channel-2\" d=\"M19.99,12.69h-5.4V7.29h5.4v5.4Zm-4.4-1h3.4v-3.4h-3.4v3.4Z\" fill=\"currentColor\"/>\n  <path id=\"channel-3\" d=\"M19.99,19.97h-5.4v-5.4h5.4v5.4Zm-4.4-1h3.4v-3.4h-3.4v3.4Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-openPanel\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"chevron-2\" d=\"M10.64,17.78c-.21,0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21L9.83,3.76c-.33-.44-.23-1.07,.21-1.4,.44-.33,1.07-.23,1.4,.21l5.03,6.8c.26,.35,.26,.84,0,1.19l-5.03,6.81c-.2,.27-.5,.41-.81,.41Z\" fill=\"currentColor\"/>\n  <path id=\"chevron-1\" d=\"M4.33,17.84c-.21,0-.41-.06-.59-.2-.44-.33-.54-.96-.21-1.4l4.59-6.21L3.53,3.82c-.33-.44-.23-1.07,.21-1.4,.44-.33,1.07-.23,1.4,.21l5.03,6.81c.26,.35,.26,.83,0,1.19l-5.03,6.81c-.2,.27-.5,.41-.81,.41Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"Layer_2\" data-name=\"Layer 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <g id=\"icon-download\">\n    <polygon id=\"arrow\" points=\"17 14.93 17 0 15 0 15 14.93 11.56 13.47 16 24 20.44 13.47 17 14.93\" fill=\"currentColor\"/>\n    <path id=\"base\" d=\"M28.5,32H3.5c-1.38,0-2.5-1.12-2.5-2.5v-9.5h1v9.5c0,.83,.67,1.5,1.5,1.5H28.5c.83,0,1.5-.67,1.5-1.5v-9.5h1v9.5c0,1.38-1.12,2.5-2.5,2.5Z\" fill=\"currentColor\"/>\n  </g>\n</svg>","<svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"14\"\n    height=\"14\"\n    viewBox=\"0 0 12 12\"\n>\n    <path\n        fill=\"currentColor\"\n        d=\"M1.11652 3.1204C1.30891 2.94718 1.6053 2.96271 1.77853 3.1551L6.0059 7.85006L10.2333 3.1551C10.4065 2.96271 10.7029 2.94718 10.8953 3.12041C11.0876 3.29363 11.1032 3.59002 10.9299 3.78241L6.37171 8.84486C6.27496 8.9523 6.1398 9.00459 6.00579 8.99963C5.87185 9.00453 5.73678 8.95224 5.64008 8.84485L1.08183 3.78241C0.908604 3.59002 0.924137 3.29363 1.11652 3.1204Z\"\n    />\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"Layer_2\" data-name=\"Layer 2\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <g id=\"icon-metadata\">\n    <path id=\"lines\" d=\"M19.46,21.54c0-.28-.22-.5-.5-.5H.5c-.28,0-.5,.22-.5,.5s.22,.5,.5,.5H18.96c.28,0,.5-.22,.5-.5Zm3.52-14.03c0-.28-.22-.5-.5-.5H.51C.23,7.01,0,7.24,0,7.51s.22,.5,.5,.5H22.48c.28,0,.5-.22,.5-.5Zm-4.74,7.01c0-.28-.22-.5-.5-.5H.5c-.28,0-.5,.22-.5,.5s.22,.5,.5,.5H17.75c.28,0,.5-.22,.5-.5ZM32,.5c0-.28-.22-.5-.5-.5H.54C.26,0,.04,.22,.04,.5s.22,.5,.5,.5H31.5c.28,0,.5-.22,.5-.5Z\" fill=\"currentColor\"/>\n    <path id=\"i\" d=\"M23.62,14.79l.16-.56h6.29l-4.67,13.66c-.13,.4-.26,.81-.4,1.23-.13,.42-.2,.81-.2,1.19,0,.32,.09,.6,.28,.83,.18,.23,.46,.34,.83,.34,.42,0,.84-.15,1.25-.44s.78-.64,1.13-1.03c.34-.39,.63-.79,.87-1.19s.41-.73,.51-.97l.47,.2c-.11,.21-.27,.54-.49,.99-.23,.44-.53,.89-.93,1.33-.39,.44-.88,.83-1.46,1.15s-1.26,.48-2.06,.48c-.87,0-1.56-.18-2.08-.54s-.77-.97-.77-1.83c0-.46,.08-.96,.24-1.51,.16-.55,.32-1.05,.48-1.51l4.07-11.81h-3.52Zm4.67-6.57c0,.54,.18,.99,.53,1.35s.8,.54,1.32,.54,.97-.18,1.32-.54,.53-.81,.53-1.35-.18-.99-.53-1.35-.8-.54-1.32-.54-.97,.18-1.32,.54-.53,.81-.53,1.35Z\" fill=\"currentColor\"/>\n  </g>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-preferences\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"bar-1\" d=\"M8.04,3.61H.81C.39,3.61,.06,3.27,.06,2.86s.34-.75,.75-.75h7.23v1.5Zm11.15-1.5h-5.65v1.5h5.65c.41,0,.75-.34,.75-.75s-.34-.75-.75-.75Z\" fill=\"currentColor\"/>\n  <path id=\"slider-head-1\" d=\"M10.79,5.61c-.41,0-.75-.34-.75-.75V.85c0-.41,.34-.75,.75-.75s.75,.34,.75,.75V4.86c0,.41-.34,.75-.75,.75Z\" fill=\"currentColor\"/>\n  <path id=\"bar-2\" d=\"M2.81,10.75H.81c-.41,0-.75-.34-.75-.75s.34-.75,.75-.75H2.81v1.5Zm16.38-1.5H8.31v1.5h10.88c.41,0,.75-.34,.75-.75s-.34-.75-.75-.75Z\" fill=\"currentColor\"/>\n  <path id=\"slider-head-2\" d=\"M5.56,12.76c-.41,0-.75-.34-.75-.75V7.99c0-.41,.34-.75,.75-.75s.75,.34,.75,.75v4.01c0,.41-.34,.75-.75,.75Z\" fill=\"currentColor\"/>\n  <path id=\"bar-3\" d=\"M19.94,17.14c0,.41-.34,.75-.75,.75h-3.08v-1.5h3.08c.41,0,.75,.34,.75,.75Zm-9.33-.75H.81c-.41,0-.75,.34-.75,.75s.34,.75,.75,.75H10.61v-1.5Z\" fill=\"currentColor\"/>\n  <path id=\"slider-head-3\" d=\"M13.36,19.9c-.41,0-.75-.34-.75-.75v-4.01c0-.41,.34-.75,.75-.75s.75,.34,.75,.75v4.01c0,.41-.34,.75-.75,.75Z\" fill=\"currentColor\"/>\n</svg>","<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg id=\"icon-resetView-2\" data-name=\"icon-resetView\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 20 20\">\n  <path id=\"corner-top-left\" d=\"M.6,5.48c-.28,0-.5-.22-.5-.5V.09H4.99c.28,0,.5,.22,.5,.5s-.22,.5-.5,.5H1.1v3.89c0,.28-.22,.5-.5,.5Z\" fill=\"currentColor\"/>\n  <path id=\"corner-bottom-left\" d=\"M4.99,19.91H.1v-4.88c0-.28,.22-.5,.5-.5s.5,.22,.5,.5v3.88h3.89c.28,0,.5,.22,.5,.5s-.22,.5-.5,.5Z\" fill=\"currentColor\"/>\n  <path id=\"corner-bottom-right\" d=\"M19.9,19.91h-4.89c-.28,0-.5-.22-.5-.5s.22-.5,.5-.5h3.89v-3.88c0-.28,.22-.5,.5-.5s.5,.22,.5,.5v4.88Z\" fill=\"currentColor\"/>\n  <path id=\"corner-top-right\" d=\"M19.4,6.11c-.28,0-.5-.22-.5-.5V1.09h-4.51c-.28,0-.5-.22-.5-.5s.22-.5,.5-.5h5.51V5.61c0,.28-.22,.5-.5,.5Z\" fill=\"currentColor\"/>\n  <path id=\"frame\" d=\"M16.46,16.46H3.54V3.54h12.92v12.92Zm-10.92-2H14.46V5.54H5.54V14.46Z\" fill=\"currentColor\"/>\n</svg>","import Icon from \"@ant-design/icons\";\nimport type { IconComponentProps } from \"@ant-design/icons/lib/components/Icon\";\nimport React from \"react\";\n\nimport ICONS from \"../../assets/icons\";\n\nconst STYLE = { fontSize: \"19px\" };\ntype ViewerIconProps = { type: keyof typeof ICONS } & Omit<IconComponentProps, \"type\" | \"component\" | \"ref\">;\n\n/** Wrapper component for easy inclusion of our own custom icons. */\nconst ViewerIcon: React.FC<ViewerIconProps> = (props) => {\n  const newProps = { ...props };\n  newProps.style = { ...STYLE, ...props.style };\n  return <Icon component={ICONS[props.type]} {...newProps} />;\n};\n\nexport default ViewerIcon;\n","import { Button, Drawer } from \"antd\";\nimport React, { useCallback, useState } from \"react\";\n\nimport ViewerIcon from \"../shared/ViewerIcon\";\n\nimport \"./styles.css\";\n\ntype BottomPanelProps = {\n  title?: string;\n  open?: boolean;\n  onOpenChange?: (visible: boolean) => void;\n  children?: React.ReactNode;\n  height?: number;\n};\n\nconst BottomPanel: React.FC<BottomPanelProps> = ({ children, open: openProp, title, height, onOpenChange }) => {\n  const [openState, setOpenState] = useState(true);\n  const open = openProp ?? openState;\n\n  const toggleDrawer = useCallback((): void => {\n    if (openProp === undefined) {\n      setOpenState(!open);\n    }\n\n    onOpenChange?.(!open);\n  }, [open, openProp, onOpenChange]);\n\n  const optionsButton = (\n    <Button className=\"options-button\" size=\"small\" onClick={toggleDrawer}>\n      {title || \"Options\"}\n      <ViewerIcon type=\"closePanel\" className=\"button-arrow\" style={{ fontSize: \"15px\" }} />\n    </Button>\n  );\n\n  return (\n    <div className=\"bottom-panel\">\n      <Drawer\n        className=\"drawer\"\n        placement=\"bottom\"\n        closable={false}\n        getContainer={false}\n        open={open}\n        mask={false}\n        title={optionsButton}\n        height={height ?? 190}\n      >\n        <div className=\"drawer-body-wrapper\">{children}</div>\n      </Drawer>\n    </div>\n  );\n};\n\nexport default BottomPanel;\n","import type { View3d, Volume } from \"@aics/vole-core\";\nimport { LoadingOutlined } from \"@ant-design/icons\";\nimport React from \"react\";\n\nimport { CLIPPING_PANEL_HEIGHT_DEFAULT, CLIPPING_PANEL_HEIGHT_TALL } from \"../../shared/constants\";\nimport { ViewMode } from \"../../shared/enums\";\nimport type { AxisName, PerAxis, Styles } from \"../../shared/types\";\nimport type PlayControls from \"../../shared/utils/playControls\";\nimport { select, useViewerState } from \"../../state/store\";\n\nimport AxisClipSliders from \"../AxisClipSliders\";\nimport BottomPanel from \"../BottomPanel\";\n\nimport \"./styles.css\";\n\ntype ViewerWrapperProps = {\n  view3d: View3d;\n  loadingImage: boolean;\n  appHeight: string;\n  image: Volume | null;\n  numSlices: PerAxis<number>;\n  numSlicesLoaded: PerAxis<number>;\n  playControls: PlayControls;\n  playingAxis: AxisName | \"t\" | null;\n  numTimesteps: number;\n  numScenes: number;\n  visibleControls: {\n    axisClipSliders: boolean;\n  };\n  clippingPanelOpen?: boolean;\n  onClippingPanelOpenChange?: (visible: boolean) => void;\n};\n\nconst ViewerWrapper: React.FC<ViewerWrapperProps> = (props) => {\n  const view3dviewerRef = React.createRef<HTMLDivElement>();\n\n  React.useEffect(() => {\n    view3dviewerRef.current!.appendChild(props.view3d.getDOMElement());\n  }, [props.view3d, view3dviewerRef]);\n\n  const renderOverlay = (): React.ReactNode => {\n    // Don't show spinner during playback - we may be constantly loading new data, it'll block the view!\n    const showSpinner = props.loadingImage && !props.playingAxis;\n    const spinner = showSpinner ? (\n      <div style={STYLES.noImage}>\n        <LoadingOutlined style={{ fontSize: 60, zIndex: 1000 }} />\n      </div>\n    ) : null;\n\n    const noImageText =\n      !props.loadingImage && !props.image ? <div style={STYLES.noImage}>No image selected</div> : null;\n    if (!!noImageText && props.view3d) {\n      props.view3d.removeAllVolumes();\n    }\n    return noImageText || spinner;\n  };\n\n  const { appHeight, visibleControls, numTimesteps, numScenes } = props;\n\n  const changeViewerSetting = useViewerState(select(\"changeViewerSetting\"));\n  const viewMode = useViewerState(select(\"viewMode\"));\n  const region = useViewerState(select(\"region\"));\n  const slice = useViewerState(select(\"slice\"));\n  const time = useViewerState(select(\"time\"));\n  const scene = useViewerState(select(\"scene\"));\n\n  const clippingPanelTall = numTimesteps > 1 && numScenes > 1 && viewMode === ViewMode.threeD;\n\n  return (\n    <div className=\"cell-canvas\" style={{ ...STYLES.viewer, height: appHeight }}>\n      <div ref={view3dviewerRef} style={STYLES.view3d}></div>\n      <BottomPanel\n        title=\"Clipping\"\n        open={props.clippingPanelOpen}\n        onOpenChange={props.onClippingPanelOpenChange}\n        height={clippingPanelTall ? CLIPPING_PANEL_HEIGHT_TALL : CLIPPING_PANEL_HEIGHT_DEFAULT}\n      >\n        {visibleControls.axisClipSliders && !!props.image && (\n          <AxisClipSliders\n            mode={viewMode}\n            image={props.image}\n            changeViewerSetting={changeViewerSetting}\n            numSlices={props.numSlices}\n            numSlicesLoaded={props.numSlicesLoaded}\n            numScenes={numScenes}\n            region={region}\n            slices={slice}\n            numTimesteps={numTimesteps}\n            time={time}\n            scene={scene}\n            playControls={props.playControls}\n            playingAxis={props.playingAxis}\n          />\n        )}\n      </BottomPanel>\n      {renderOverlay()}\n    </div>\n  );\n};\n\nexport default ViewerWrapper;\n\nconst STYLES: Styles = {\n  viewer: {\n    display: \"flex\",\n    position: \"relative\",\n  },\n  view3d: {\n    width: \"100%\",\n    display: \"flex\",\n    overflow: \"hidden\",\n  },\n  noImage: {\n    position: \"absolute\",\n    zIndex: 999,\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#eeeee\",\n    color: \"#9b9b9b\",\n    fontSize: \"2em\",\n    opacity: 0.75,\n  },\n};\n","import { map } from \"lodash\";\nimport React from \"react\";\nimport { type ColorResult, SketchPicker } from \"react-color\";\n\nimport type { Styles } from \"../shared/types\";\nimport type { ColorObject } from \"../shared/utils/colorRepresentations\";\n\n// if there are fewer than this many screen pixels below the swatch but more above, open above the swatch\nconst OPEN_ABOVE_MARGIN = 310;\n\ntype ColorChangeHandler = (currentColor: ColorObject, prevColor?: ColorObject, idx?: number) => void;\n\ninterface ColorPickerProps {\n  color: ColorObject;\n  width: number;\n  onColorChange?: ColorChangeHandler;\n  onColorChangeComplete?: ColorChangeHandler;\n  idx?: any;\n  disableAlpha?: boolean;\n}\n\nconst DEFAULT_COLOR = {\n  r: \"241\",\n  g: \"112\",\n  b: \"19\",\n  a: \"1\",\n};\n\nconst ColorPicker: React.FC<ColorPickerProps> = (props) => {\n  const [isOpen, setIsOpen] = React.useState(false);\n  const [openAboveSwatch, setOpenAboveSwatch] = React.useState(false);\n  const [currentColor, setCurrentColor] = React.useState(props.color || DEFAULT_COLOR);\n\n  const swatchRef = React.useRef<HTMLDivElement>(null);\n\n  const handleClick = (): void => {\n    const swatchRect = swatchRef.current!.getBoundingClientRect();\n    const noRoomBelowSwatch = swatchRect.bottom > window.innerHeight - OPEN_ABOVE_MARGIN;\n    setIsOpen(!isOpen);\n    setOpenAboveSwatch(noRoomBelowSwatch && swatchRect.top > OPEN_ABOVE_MARGIN);\n  };\n\n  const handleClose = (): void => setIsOpen(false);\n\n  const handleChange = (color: ColorResult): void => {\n    setCurrentColor(color.rgb);\n    // supply onColorChange callback in props.\n    props.onColorChange?.(color.rgb, currentColor, props.idx);\n  };\n\n  const handleChangeComplete = (color: ColorResult): void => {\n    setCurrentColor(color.rgb);\n    // supply onColorChange callback in props.\n    props.onColorChangeComplete?.(color.rgb, currentColor, props.idx);\n  };\n\n  React.useEffect(() => setCurrentColor(props.color), [props.color]);\n\n  const width = props.width || 36;\n  const popoverDirectionStyle = openAboveSwatch ? { bottom: \"21px\" } : { top: \"0px\" };\n  return (\n    <div>\n      <div style={STYLES.swatch} ref={swatchRef} onClick={handleClick}>\n        <div style={{ ...STYLES.color, width: `${width}px`, background: `rgba(${map(currentColor, (ele) => ele)})` }} />\n      </div>\n      <div style={{ position: \"absolute\" }}>\n        {isOpen ? (\n          <div style={{ ...STYLES.popover, ...popoverDirectionStyle }}>\n            <div style={STYLES.cover} onClick={handleClose} />\n            <SketchPicker\n              color={currentColor}\n              onChange={handleChange}\n              onChangeComplete={handleChangeComplete}\n              disableAlpha={props.disableAlpha}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n};\n\nexport default ColorPicker;\n\nconst STYLES: Styles = {\n  color: {\n    height: \"14px\",\n    margin: \"3px\",\n    borderRadius: \"2px\",\n  },\n  swatch: {\n    borderRadius: \"3px\",\n    border: \"1px solid var(--color-controlpanel-border)\",\n    display: \"inline-block\",\n    cursor: \"pointer\",\n    verticalAlign: \"middle\",\n  },\n  popover: {\n    position: \"absolute\",\n    zIndex: \"9999\",\n  },\n  cover: {\n    position: \"fixed\",\n    top: \"0px\",\n    right: \"0px\",\n    bottom: \"0px\",\n    left: \"0px\",\n  },\n};\n","import type { NouisliderProps } from \"nouislider-react\";\nimport React from \"react\";\n\nimport SmarterSlider from \"../SmarterSlider\";\n\nimport \"./styles.css\";\n\ntype SliderRowProps = {\n  label: React.ReactNode;\n  start?: number | number[];\n  step?: number;\n  formatInteger?: boolean;\n  min?: number;\n  max?: number;\n  onUpdate?: NouisliderProps[\"onUpdate\"];\n  onChange?: NouisliderProps[\"onChange\"];\n  hideSlider?: boolean;\n\n  children?: React.ReactNode;\n};\n\nconst INTEGER_FORMATTER = { to: Math.round, from: Number };\n\n/** A component to ensure a single unified style across the many labeled slider rows in the control panel */\nconst SliderRow: React.FC<SliderRowProps> = (props) => (\n  <div className=\"viewer-control-row\">\n    <div className=\"control-name\">{props.label}</div>\n    <div className=\"control\">\n      {props.start !== undefined && !props.hideSlider && (\n        <div className=\"control-slider\">\n          <SmarterSlider\n            range={{ min: props.min ?? 0, max: props.max }}\n            start={props.start}\n            connect={true}\n            tooltips={true}\n            behaviour=\"drag\"\n            format={props.formatInteger ? INTEGER_FORMATTER : undefined}\n            onUpdate={props.onUpdate}\n            onChange={props.onChange}\n          />\n        </div>\n      )}\n      {props.children && <div className=\"control-extra\">{props.children}</div>}\n    </div>\n  </div>\n);\n\nexport default SliderRow;\n","import { type Channel, type ControlPoint, type Histogram, Lut } from \"@aics/vole-core\";\nimport { PushpinFilled, PushpinOutlined } from \"@ant-design/icons\";\nimport { Button, Checkbox, Dropdown, InputNumber, Tooltip } from \"antd\";\nimport * as d3 from \"d3\";\nimport \"nouislider/distribute/nouislider.css\";\nimport React, { useCallback, useMemo, useRef, useState } from \"react\";\nimport { type ColorResult, SketchPicker } from \"react-color\";\n\nimport { DTYPE_RANGE, LUT_MAX_PERCENTILE, LUT_MIN_PERCENTILE, TFEDITOR_DEFAULT_COLOR } from \"../../shared/constants\";\nimport type { IsosurfaceFormat } from \"../../shared/types\";\nimport {\n  type ColorArray,\n  colorArrayToObject,\n  colorArrayToString,\n  colorObjectToArray,\n} from \"../../shared/utils/colorRepresentations\";\nimport { controlPointsToRamp, rampToControlPoints } from \"../../shared/utils/controlPointsToLut\";\nimport { useRefWithSetter } from \"../../shared/utils/hooks\";\nimport type { ChannelState } from \"../../state/types\";\n\nimport SliderRow from \"../shared/SliderRow\";\nimport ViewerIcon from \"../shared/ViewerIcon\";\n\nimport \"./styles.css\";\n\n/**The color picker opens next to control points like a context menu. This constant gives it a bit of space. */\nconst TFEDITOR_COLOR_PICKER_MARGIN_X_PX = 2;\n/** If a control point is within this distance of the bottom of the screen, open the color picker upward */\nconst TFEDITOR_COLOR_PICKER_OPEN_UPWARD_MARGIN_PX = 310;\n\nconst TFEDITOR_GRADIENT_MAX_OPACITY = 0.75;\nconst TFEDITOR_NUM_TICKS = 4;\n/**\n * If the first or last \"round\" tick mark is within this ratio of the end of the x axis, remove it to get it out of the\n * way of the tick mark right at the end.\n *\n * For instance, if the x range is [0, 255], the last tick mark d3 generates will likely be at 250. That should be\n * removed to get it out of the way of the tick mark at 255! But if the range is [0, 390], it may be that the last tick\n * mark is at 300. It would make no sense to remove that tick mark to make space for one at 390.\n */\nconst TFEDITOR_END_TICK_MARGIN = 0.1;\n\nconst TFEDITOR_MARGINS = {\n  top: 18,\n  right: 20,\n  bottom: 30, // includes space for x-axis\n  left: 25,\n};\n\nconst MOUSE_EVENT_BUTTONS_PRIMARY = 1;\n\nconst enum TfEditorSliderHandle {\n  Min = \"min\",\n  Max = \"max\",\n  Isosurface = \"surf\",\n}\n\ntype TfEditorProps = {\n  id: string;\n  width: number;\n  height: number;\n  channelData: Channel;\n  changeChannelSetting: (value: Partial<ChannelState>) => void;\n  volumeEnabled: boolean;\n  isosurfaceEnabled: boolean;\n  colorizeEnabled: boolean;\n  colorizeAlpha: number;\n  useControlPoints: boolean;\n  controlPoints: ControlPoint[];\n  ramp: [number, number];\n  isovalue: number;\n  opacity: number;\n  plotMin: number;\n  plotMax: number;\n  keepIntensityRange: boolean;\n  saveIsosurface: (format: IsosurfaceFormat) => void;\n};\n\nconst TF_GENERATORS: Record<string, (histogram: Histogram) => Lut> = {\n  autoXF: (histo) => {\n    // Currently unused. min and max are the first and last bins whose values are >=10% that of the max bin\n    const [hmin, hmax] = histo.findAutoMinMax();\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  auto2XF: (histo) => {\n    const [hmin, hmax] = histo.findAutoIJBins();\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  auto98XF: (histo) => {\n    const hmin = histo.findBinOfPercentile(LUT_MIN_PERCENTILE);\n    const hmax = histo.findBinOfPercentile(LUT_MAX_PERCENTILE);\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  bestFitXF: (histo) => {\n    const [hmin, hmax] = histo.findBestFitBins();\n    return new Lut().createFromMinMax(hmin, hmax);\n  },\n  resetXF: (_histo) => new Lut().createFullRange(),\n};\n\n// RAMP SLIDER HANDLE\n// *---*\n// |   |\n// |   |\n//  \\ /\n//   *\n// width: 0.65 * height; height of rectangle: 0.6 * height; height of triangle: 0.4 * height\nconst sliderHandleSymbol: d3.SymbolType = {\n  draw: (context, size) => {\n    // size is symbol area in px^2\n    const height = Math.sqrt(size * 1.9);\n    const triangleHeight = height * 0.4;\n    const halfWidth = height * 0.325;\n\n    context.moveTo(-halfWidth, -height);\n    context.lineTo(halfWidth, -height);\n    context.lineTo(halfWidth, -triangleHeight);\n    context.lineTo(0, 0);\n    context.lineTo(-halfWidth, -triangleHeight);\n    context.closePath();\n  },\n};\n\n// ISOVALUE SLIDER HANDLE\n//     / \\  / \\\n//     \\  \\/  /\n//      \\    /\n//       *--*\n// start ^  ^ end\nconst LINE_WIDTH = 2;\n// the \"base\" is the 5-sided area where both lines meet - think of a square with side length\n// `LINE_WIDTH`, rotated 45deg, with the bottom corner cut off where the slider line meets the handle\nconst BASE_AREA = Math.pow(LINE_WIDTH, 2) * 0.75;\nconst BASE_HEIGHT = (Math.SQRT2 - 0.5) * LINE_WIDTH;\n// how much the base \"sticks out\" horizontally on either side of the slider line\nconst BASE_MARGIN = (Math.SQRT2 - 1) * 0.5 * LINE_WIDTH;\nconst isovalueHandleSymbol: d3.SymbolType = {\n  draw: (context, size) => {\n    const linesArea = Math.max(size - BASE_AREA, 0);\n    const margin = BASE_MARGIN + linesArea / (2 * Math.SQRT2 * LINE_WIDTH);\n\n    context.moveTo(1, 0);\n    context.lineTo(margin + 1, -margin);\n    context.lineTo(margin + 1 - Math.SQRT2, -margin - Math.SQRT2);\n    context.lineTo(0, -BASE_HEIGHT);\n    context.lineTo(-margin - 1 + Math.SQRT2, -margin - Math.SQRT2);\n    context.lineTo(-margin - 1, -margin);\n    context.lineTo(-1, 0);\n    context.closePath();\n  },\n};\n\n/** For when all control points are outside the plot's range: just fill the plot with the settings from 1 point */\nconst coverRangeWithPoint = (point: ControlPoint, plotMin: number, plotMax: number): ControlPoint[] => {\n  return [\n    { ...point, x: plotMin },\n    { ...point, x: plotMax },\n  ];\n};\n\n/** For when some control points are outside the plot's range: create an intermediate point on the edge of the range */\nconst createPointOnRangeBoundary = (outOfRangePt: ControlPoint, inRangePt: ControlPoint, x: number): ControlPoint => {\n  const rangeRatio = (x - outOfRangePt.x) / (inRangePt.x - outOfRangePt.x);\n  const opacity = outOfRangePt.opacity + (inRangePt.opacity - outOfRangePt.opacity) * rangeRatio;\n  const color = outOfRangePt.color.map((c, i) => c + (inRangePt.color[i] - c) * rangeRatio) as ColorArray;\n  return { x, opacity, color };\n};\n\n/**\n * Ensures the list of `controlPoints` exactly covers the range from `plotMin` to `plotMax` by removing any\n * out-of-range points and adding new points right at the edges of the range.\n */\nconst fitControlPointsToRange = (controlPoints: ControlPoint[], plotMin: number, plotMax: number): ControlPoint[] => {\n  const points = controlPoints.slice();\n\n  const firstPoint = points[0];\n  const lastPoint = points[points.length - 1];\n\n  // If all control points are outside the range, just fill the range with the first or last point.\n  if (lastPoint.x < plotMin) {\n    return coverRangeWithPoint(lastPoint, plotMin, plotMax);\n  }\n  if (firstPoint.x > plotMax) {\n    return coverRangeWithPoint(firstPoint, plotMin, plotMax);\n  }\n\n  if (firstPoint.x > plotMin) {\n    // If the control points don't go all the way to the min, add a new point at the min.\n    points.unshift({ ...firstPoint, x: plotMin });\n  } else {\n    // If some control points are out of range, remove those points...\n    let outOfRangePoint: ControlPoint | undefined = undefined;\n    while (points[0].x < plotMin && points.length > 1) {\n      outOfRangePoint = points.shift();\n    }\n\n    // ...and create a new point at the edge of the range.\n    if (outOfRangePoint !== undefined) {\n      points.unshift(createPointOnRangeBoundary(outOfRangePoint, points[0], plotMin));\n    }\n  }\n\n  if (lastPoint.x < plotMax) {\n    // If the control points don't go all the way to the max, add a new point at the max.\n    points.push({ ...lastPoint, x: plotMax });\n  } else {\n    // If some control points are out of range, remove those points...\n    let outOfRangePoint: ControlPoint | undefined = undefined;\n    while (points[points.length - 1].x > plotMax && points.length > 1) {\n      outOfRangePoint = points.pop();\n    }\n\n    // ...and create a new point at the edge of the range.\n    if (outOfRangePoint !== undefined) {\n      points.push(createPointOnRangeBoundary(outOfRangePoint, points[points.length - 1], plotMax));\n    }\n  }\n\n  return points;\n};\n\n/** Defines an SVG gradient with id `id` based on the provided `controlPoints` */\nconst ControlPointGradientDef: React.FC<{ controlPoints: ControlPoint[]; id: string }> = ({ controlPoints, id }) => {\n  const range = controlPoints[controlPoints.length - 1].x - controlPoints[0].x;\n  return (\n    <defs>\n      <linearGradient id={id} gradientUnits=\"objectBoundingBox\" spreadMethod=\"pad\" x2=\"100%\">\n        {controlPoints.map((cp, i) => {\n          const offset = `${((cp.x - controlPoints[0].x) / range) * 100}%`;\n          const opacity = Math.min(cp.opacity, TFEDITOR_GRADIENT_MAX_OPACITY);\n          return <stop key={i} stopColor={colorArrayToString(cp.color)} stopOpacity={opacity} offset={offset} />;\n        })}\n      </linearGradient>\n    </defs>\n  );\n};\n\n/** Retrieves the bin contents and max bin value from `histogram` */\nfunction getHistogramBinLengths(histogram: Histogram): { binLengths: number[]; max: number } {\n  const binLengths = [];\n  // TODO: Change `histogram.bins` to be readable/readonly\n  // so we don't have to copy it here!\n  let max = Number.NEGATIVE_INFINITY;\n  for (let i = 0; i < histogram.getNumBins(); i++) {\n    const binLength = histogram.getBin(i);\n    binLengths.push(binLength);\n    max = Math.max(max, binLength);\n  }\n  return { binLengths, max };\n}\n\nconst colorPickerPositionToStyle = ([x, y]: [number, number]): React.CSSProperties => ({\n  position: \"absolute\",\n  [x < 0 ? \"right\" : \"left\"]: Math.abs(x),\n  [y < 0 ? \"bottom\" : \"top\"]: y,\n});\n\nconst numberFormatter = (v: number | string | undefined): string => (v === undefined ? \"\" : Number(v).toFixed(0));\n\nconst clamp = (value: number, min: number, max: number): number => Math.min(Math.max(value, min), max);\n\nconst TfEditor: React.FC<TfEditorProps> = (props) => {\n  const { changeChannelSetting, plotMin, plotMax } = props;\n\n  const innerWidth = props.width - TFEDITOR_MARGINS.left - TFEDITOR_MARGINS.right;\n  const innerHeight = props.height - TFEDITOR_MARGINS.top - TFEDITOR_MARGINS.bottom;\n\n  const [selectedPointIdx, setSelectedPointIdx] = useState<number | null>(null);\n  const [draggedPointIdx, _setDraggedPointIdx] = useState<number | TfEditorSliderHandle | null>(null);\n\n  const _setCPs = useCallback(\n    (controlPoints: ControlPoint[]) => changeChannelSetting({ controlPoints }),\n    [changeChannelSetting]\n  );\n  const setRamp = useCallback((ramp: [number, number]) => changeChannelSetting({ ramp }), [changeChannelSetting]);\n\n  // The temporary isovalue used while dragging the isovalue slider, which we only want to update on slider release\n  const [draggedIsovalue, setDraggedIsovalue] = useState(0);\n\n  // these bits of state need their freshest, most up-to-date values available in mouse event handlers. make refs!\n  const [controlPointsRef, setControlPoints] = useRefWithSetter(_setCPs, props.controlPoints);\n  const [draggedPointIdxRef, setDraggedPointIdx] = useRefWithSetter(_setDraggedPointIdx, draggedPointIdx);\n\n  // Either `null` when the control panel is closed, or an x offset into the plot to position the color picker.\n  // Positive: offset right from the left edge of the plot; negative: offset left from the right edge of the plot.\n  const [colorPickerPosition, setColorPickerPosition] = useState<[number, number] | null>(null);\n  const lastColorRef = useRef<ColorArray>(TFEDITOR_DEFAULT_COLOR);\n\n  const svgRef = useRef<SVGSVGElement>(null); // need access to SVG element to measure mouse position\n\n  const { histogram } = props.channelData;\n  const typeRange = DTYPE_RANGE[props.channelData.dtype];\n\n  // d3 scales define the mapping between data and screen space (and do the heavy lifting of generating plot axes)\n  /** `xScale` is in raw intensity range, not U8 range. We use `u8ToAbsolute` and `absoluteToU8` to translate to U8. */\n  const xScale = useMemo(\n    () => d3.scaleLinear().domain([plotMin, plotMax]).range([0, innerWidth]),\n    [innerWidth, plotMin, plotMax]\n  );\n  const yScale = useMemo(() => d3.scaleLinear().domain([0, 1]).range([innerHeight, 0]), [innerHeight]);\n\n  const mouseEventToPlotValues = (event: MouseEvent | React.MouseEvent): [number, number] => {\n    const svgRect = svgRef.current?.getBoundingClientRect() ?? { x: 0, y: 0 };\n    return [\n      xScale.invert(clamp(event.clientX - svgRect.x - TFEDITOR_MARGINS.left, 0, innerWidth)),\n      yScale.invert(clamp(event.clientY - svgRect.y - TFEDITOR_MARGINS.top, 0, innerHeight)),\n    ];\n  };\n\n  const dragControlPoint = (draggedIdx: number, x: number, opacity: number): void => {\n    const newControlPoints = [...controlPointsRef.current];\n    const draggedPoint = newControlPoints[draggedIdx];\n    draggedPoint.x = x;\n    draggedPoint.opacity = opacity;\n\n    // Remove control points to keep the list sorted by x value\n    const bisector = d3.bisector<ControlPoint, ControlPoint>((a, b) => a.x - b.x);\n    const idxLeft = bisector.left(newControlPoints, draggedPoint);\n    const idxRight = bisector.right(newControlPoints, draggedPoint);\n\n    if (idxLeft < draggedIdx) {\n      const numPointsToRemove = draggedIdx - idxLeft; // should almost always be 1\n      newControlPoints.splice(idxLeft, numPointsToRemove);\n\n      const newIdx = draggedIdx - numPointsToRemove;\n      setDraggedPointIdx(newIdx);\n      setSelectedPointIdx(newIdx);\n    } else if (idxRight > draggedIdx + 1) {\n      newControlPoints.splice(draggedIdx + 1, idxRight - draggedIdx - 1);\n    }\n\n    setControlPoints(newControlPoints);\n  };\n\n  const dragSlider = (handle: TfEditorSliderHandle, x: number): void => {\n    if (handle === TfEditorSliderHandle.Min) {\n      // dragging the min slider\n      const max = props.ramp[1];\n      setRamp([Math.min(x, max), max]);\n    } else if (handle === TfEditorSliderHandle.Max) {\n      // dragging the max slider\n      const min = props.ramp[0];\n      setRamp([min, Math.max(x, min)]);\n    } else {\n      // dragging the isosurface slider\n      setDraggedIsovalue(x);\n    }\n  };\n\n  const handlePlotPointerDown: React.PointerEventHandler<SVGSVGElement> = (event) => {\n    if (props.useControlPoints) {\n      // Advanced mode - we're either creating a new control point or selecting/dragging an existing one\n      if (draggedPointIdxRef.current === null && event.button === 0) {\n        // this click is not on an existing point - create a new one\n        const [x, opacity] = mouseEventToPlotValues(event);\n        const point = { x, opacity, color: lastColorRef.current };\n\n        // add new control point to controlPoints\n        const index = d3.bisector<ControlPoint, ControlPoint>((a, b) => a.x - b.x).left(props.controlPoints, point);\n        setDraggedPointIdx(index);\n\n        const newControlPoints = [...props.controlPoints];\n        newControlPoints.splice(index, 0, point);\n        setControlPoints(newControlPoints);\n      } else {\n        // this click is on an existing point - update current points to ref (may have been remapped since last edit)\n        controlPointsRef.current = props.controlPoints;\n      }\n\n      if (typeof draggedPointIdxRef.current !== \"string\") {\n        setSelectedPointIdx(draggedPointIdxRef.current);\n      }\n    }\n\n    if (event.button === 0 && draggedPointIdxRef.current !== null) {\n      // get set up to drag the point around, even if the mouse leaves the SVG element\n      event.currentTarget.setPointerCapture(event.nativeEvent.pointerId);\n    } else {\n      setDraggedPointIdx(null);\n    }\n  };\n\n  const handlePlotPointerMove: React.PointerEventHandler<SVGSVGElement> = (event) => {\n    if (draggedPointIdxRef.current === null) {\n      return;\n    }\n\n    if ((event.buttons & MOUSE_EVENT_BUTTONS_PRIMARY) === 0) {\n      handleDragEnd(event);\n      return;\n    }\n\n    event.stopPropagation();\n    event.preventDefault();\n    const [x, opacity] = mouseEventToPlotValues(event);\n\n    // `draggedPointIdxRef` may either be a number (control point index) or a string (ramp slider handle).\n    // The result of this check should always be the same as `props.useControlPoints`, but this narrows the type for TS\n    if (typeof draggedPointIdxRef.current === \"number\") {\n      dragControlPoint(draggedPointIdxRef.current, x, opacity);\n    } else {\n      dragSlider(draggedPointIdxRef.current, x);\n    }\n  };\n\n  const handleDragEnd: React.PointerEventHandler<SVGSVGElement> = (event) => {\n    if (draggedPointIdx === TfEditorSliderHandle.Isosurface) {\n      changeChannelSetting({ isovalue: draggedIsovalue });\n    }\n    setDraggedPointIdx(null);\n    event.currentTarget.releasePointerCapture(event.pointerId);\n  };\n\n  const handleControlPointContextMenu: React.MouseEventHandler<SVGCircleElement> = (event) => {\n    event.preventDefault();\n    if (!event.target || !svgRef.current) {\n      setColorPickerPosition(null);\n      return;\n    }\n\n    const svgRect = svgRef.current.getBoundingClientRect();\n    const cpRect = (event.target as SVGCircleElement).getBoundingClientRect();\n    const cpRectCenter = cpRect.left + cpRect.width / 2;\n\n    // If the control point is closer to the left edge of the SVG, open the color picker to the right\n    const openLeft = cpRectCenter - svgRect.left < svgRect.width / 2;\n    const xPosition = openLeft\n      ? cpRect.right - svgRect.left + TFEDITOR_COLOR_PICKER_MARGIN_X_PX\n      : cpRect.left - svgRect.right - TFEDITOR_COLOR_PICKER_MARGIN_X_PX;\n\n    // If the control point is too close to the bottom of the screen, open the color picker upward\n    const openUp = window.innerHeight - cpRect.bottom < TFEDITOR_COLOR_PICKER_OPEN_UPWARD_MARGIN_PX;\n    const yPosition = openUp ? svgRect.top - cpRect.bottom : cpRect.top - svgRect.top;\n    setColorPickerPosition([xPosition, yPosition]);\n  };\n\n  const handleChangeColor = (color: ColorResult): void => {\n    lastColorRef.current = colorObjectToArray(color.rgb);\n    if (selectedPointIdx !== null) {\n      const newControlPoints = [...props.controlPoints];\n      newControlPoints[selectedPointIdx].color = lastColorRef.current;\n      setControlPoints(newControlPoints);\n    }\n  };\n\n  const controlPointsToRender = useMemo(() => {\n    const points = props.useControlPoints ? props.controlPoints.slice() : rampToControlPoints(props.ramp);\n    return fitControlPointsToRange(points, plotMin, plotMax);\n  }, [props.controlPoints, props.ramp, props.useControlPoints, plotMin, plotMax]);\n\n  /** d3-generated svg data string representing both the line between points and the region filled with gradient */\n  const areaPath = useMemo(() => {\n    const areaGenerator = d3\n      .area<ControlPoint>()\n      .x((d) => xScale(d.x))\n      .y0((d) => yScale(d.opacity))\n      .y1(innerHeight)\n      .curve(d3.curveLinear);\n    return areaGenerator(controlPointsToRender) ?? undefined;\n  }, [controlPointsToRender, xScale, yScale, innerHeight]);\n\n  /** d3-generated svg data string representing the \"basic mode\" min/max slider handles */\n  const sliderHandlePath = useMemo(() => d3.symbol().type(sliderHandleSymbol).size(80)() ?? undefined, []);\n\n  const isovalueHandlePath = useMemo(() => d3.symbol().type(isovalueHandleSymbol).size(21)() ?? undefined, []);\n\n  // The below `useCallback`s are used as \"ref callbacks\" - passed as the `ref` prop of SVG elements in order to render\n  // these elements' content using D3. They are called when the ref'd component mounts and unmounts, and whenever their\n  // identity changes (i.e. whenever their dependencies change).\n\n  const xAxisRef = useCallback(\n    (el: SVGGElement) => {\n      // generate tick marks\n      const ticks = xScale.ticks(TFEDITOR_NUM_TICKS);\n\n      // make sure we have sensible tick marks right at the min and max of the x axis\n      const [min, max] = xScale.domain();\n      const domain = max - min;\n\n      if ((ticks[0] - min) / domain < TFEDITOR_END_TICK_MARGIN) {\n        ticks[0] = min;\n      } else {\n        ticks.unshift(min);\n      }\n\n      if ((ticks[ticks.length - 1] - min) / domain > 1 - TFEDITOR_END_TICK_MARGIN) {\n        ticks[ticks.length - 1] = max;\n      } else {\n        ticks.push(max);\n      }\n\n      // now make the axis!\n      d3.select(el).call(\n        d3\n          .axisBottom(xScale)\n          .tickValues(ticks)\n          .tickPadding(props.useControlPoints ? 3 : 10) // get tick labels out of the way of sliders in \"basic\" mode\n      );\n    },\n    [xScale, props.useControlPoints]\n  );\n\n  const yAxisRef = useCallback(\n    (el: SVGGElement) => d3.select(el).call(d3.axisLeft(yScale).ticks(TFEDITOR_NUM_TICKS)),\n    [yScale]\n  );\n\n  const histogramRef = useCallback(\n    (el: SVGGElement) => {\n      if (el === null) {\n        return;\n      }\n      const numBins = histogram.getNumBins();\n      if (numBins < 1) {\n        return;\n      }\n      const plotMinU8 = histogram.findFractionalBinOfValue(plotMin);\n      const plotMaxU8 = histogram.findFractionalBinOfValue(plotMax);\n      const { binLengths, max } = getHistogramBinLengths(histogram);\n      const start = Math.max(0, Math.ceil(plotMinU8));\n      const end = Math.min(numBins, Math.floor(plotMaxU8));\n      const binLengthsToRender = binLengths.slice(start, end);\n\n      const barWidth = innerWidth / (plotMaxU8 - plotMinU8);\n      const binScale = d3.scaleLog().domain([0.1, max]).range([innerHeight, 0]).base(2).clamp(true);\n\n      d3.select(el)\n        .selectAll(\".bar\") // select all the bars of the histogram\n        .data(binLengthsToRender) // bind the histogram bins to this selection\n        .join(\"rect\") // ensure we have exactly as many bound `rect` elements in the DOM as we have histogram bins\n        .attr(\"class\", \"bar\")\n        .attr(\"width\", barWidth)\n        .attr(\"x\", (_len, idx) => xScale(histogram.getValueFromBinIndex(idx + start))) // set position and height from data\n        .attr(\"y\", (len) => binScale(len))\n        .attr(\"height\", (len) => innerHeight - binScale(len));\n    },\n    [xScale, histogram, innerWidth, innerHeight, plotMin, plotMax]\n  );\n\n  const applyTFGenerator = useCallback(\n    (generator: string): void => {\n      setSelectedPointIdx(null);\n      lastColorRef.current = TFEDITOR_DEFAULT_COLOR;\n      const lut = TF_GENERATORS[generator](histogram);\n      const valueIndexedControlPoints = lut.controlPoints.map((cp) => ({\n        ...cp,\n        x: histogram.getValueFromBinIndex(cp.x),\n      }));\n      if (props.useControlPoints) {\n        setControlPoints(valueIndexedControlPoints.map((cp) => ({ ...cp, color: TFEDITOR_DEFAULT_COLOR })));\n      } else {\n        setRamp(controlPointsToRamp(valueIndexedControlPoints));\n      }\n    },\n    [histogram, props.useControlPoints, setControlPoints, setRamp]\n  );\n\n  let controlPointCircles = null;\n  if (props.volumeEnabled && props.useControlPoints) {\n    // create one svg circle element for each control point\n    controlPointCircles = props.controlPoints\n      .filter((cp) => plotMin <= cp.x && cp.x <= plotMax) // filter out-of-range points\n      .map((cp, i) => (\n        <circle\n          key={i}\n          className={i === selectedPointIdx ? \"selected\" : \"\"}\n          cx={xScale(cp.x)}\n          cy={yScale(cp.opacity)}\n          style={{ fill: colorArrayToString(cp.color) }}\n          r={5}\n          onPointerDown={() => setDraggedPointIdx(i)}\n          onContextMenu={handleControlPointContextMenu}\n        />\n      ));\n  }\n  // move selected control point to the end so it's drawn last and not occluded by other nearby points\n  if (controlPointCircles !== null && selectedPointIdx !== null) {\n    controlPointCircles.push(controlPointCircles.splice(selectedPointIdx, 1)[0]);\n  }\n\n  const dragClass =\n    draggedPointIdx === null ? \"\" : typeof draggedPointIdx === \"number\" ? \" dragging-point\" : \" dragging-slider\";\n  const isovalue = draggedPointIdx === TfEditorSliderHandle.Isosurface ? draggedIsovalue : props.isovalue;\n  const useRamp = props.volumeEnabled && !props.useControlPoints;\n  const { rawMin, rawMax } = props.channelData;\n\n  return (\n    <div className=\"tf-editor\">\n      {/* ----- PLOT RANGE ----- */}\n      <div className=\"tf-editor-control-row\">\n        <div>\n          <Button size=\"small\" onClick={() => changeChannelSetting({ plotMin: rawMin, plotMax: rawMax })}>\n            Fit to data\n          </Button>\n          <Button size=\"small\" onClick={() => changeChannelSetting({ plotMin: typeRange.min, plotMax: typeRange.max })}>\n            Full range\n          </Button>\n        </div>\n        <div>\n          Plot min/max\n          <InputNumber\n            value={plotMin}\n            onChange={(v) => v !== null && changeChannelSetting({ plotMin: v, plotMax: Math.max(v + 1, plotMax) })}\n            formatter={numberFormatter}\n            min={typeRange.min}\n            max={typeRange.max - 1}\n            size=\"small\"\n            controls={false}\n          />\n          <InputNumber\n            value={plotMax}\n            onChange={(v) => v !== null && changeChannelSetting({ plotMax: v, plotMin: Math.min(v - 1, plotMin) })}\n            formatter={numberFormatter}\n            min={typeRange.min + 1}\n            max={typeRange.max}\n            size=\"small\"\n            controls={false}\n          />\n        </div>\n      </div>\n\n      {/* ----- CONTROL POINT COLOR PICKER ----- */}\n      {colorPickerPosition !== null && (\n        <div className=\"tf-editor-popover\">\n          <div className=\"tf-editor-cover\" onClick={() => setColorPickerPosition(null)} />\n          <div style={colorPickerPositionToStyle(colorPickerPosition)}>\n            <SketchPicker\n              color={colorArrayToObject(lastColorRef.current)}\n              onChange={handleChangeColor}\n              disableAlpha={true}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* ----- PLOT SVG ----- */}\n      <svg\n        className={`tf-editor-svg${dragClass}`}\n        ref={svgRef}\n        width={props.width}\n        height={props.height}\n        onPointerDown={handlePlotPointerDown}\n        onPointerMove={handlePlotPointerMove}\n        onPointerUp={handleDragEnd}\n      >\n        <ControlPointGradientDef controlPoints={controlPointsToRender} id={`tfGradient-${props.id}`} />\n        <g transform={`translate(${TFEDITOR_MARGINS.left},${TFEDITOR_MARGINS.top})`}>\n          {/* histogram bars */}\n          <g ref={histogramRef} />\n          {/* line between control points, and the gradient under it */}\n          {props.volumeEnabled && <path className=\"line\" fill={`url(#tfGradient-${props.id})`} d={areaPath} />}\n          {/* plot axes */}\n          <g ref={xAxisRef} className=\"axis\" transform={`translate(0,${innerHeight})`} />\n          <g ref={yAxisRef} className=\"axis\" />\n          {/* \"advanced mode\" control points */}\n          {controlPointCircles}\n          {/* \"basic mode\" sliders */}\n          {props.volumeEnabled && !props.useControlPoints && (\n            <g className=\"sliders sliders-ramp\">\n              {plotMin <= props.ramp[0] && props.ramp[0] <= plotMax && (\n                <g transform={`translate(${xScale(props.ramp[0])})`}>\n                  <line y1={innerHeight} strokeDasharray=\"5,5\" strokeWidth={2} />\n                  <line\n                    className=\"slider-click-target\"\n                    y1={innerHeight}\n                    strokeWidth={6}\n                    onPointerDown={() => setDraggedPointIdx(TfEditorSliderHandle.Min)}\n                  />\n                  <path\n                    d={sliderHandlePath}\n                    transform={`translate(0,${innerHeight}) rotate(180)`}\n                    onPointerDown={() => setDraggedPointIdx(TfEditorSliderHandle.Min)}\n                  />\n                </g>\n              )}\n              {plotMin <= props.ramp[1] && props.ramp[1] <= plotMax && (\n                <g transform={`translate(${xScale(props.ramp[1])})`}>\n                  <line y1={innerHeight} strokeDasharray=\"5,5\" strokeWidth={2} />\n                  <line\n                    className=\"slider-click-target\"\n                    y1={innerHeight}\n                    strokeWidth={6}\n                    onPointerDown={() => setDraggedPointIdx(TfEditorSliderHandle.Max)}\n                  />\n                  <path d={sliderHandlePath} onPointerDown={() => setDraggedPointIdx(TfEditorSliderHandle.Max)} />\n                </g>\n              )}\n            </g>\n          )}\n          {/* isovalue slider */}\n          {props.isosurfaceEnabled && plotMin <= isovalue && isovalue <= plotMax && (\n            <g className=\"sliders sliders-isovalue\" transform={`translate(${xScale(isovalue)})`}>\n              <line className=\"slider-isosurface\" y1={innerHeight} strokeDasharray=\"4,4\" strokeWidth={2} />\n              <line\n                className=\"slider-click-target\"\n                y1={innerHeight}\n                strokeWidth={6}\n                onPointerDown={() => {\n                  setDraggedIsovalue(props.isovalue);\n                  setDraggedPointIdx(TfEditorSliderHandle.Isosurface);\n                }}\n              />\n              <path d={isovalueHandlePath} onPointerDown={() => setDraggedPointIdx(TfEditorSliderHandle.Isosurface)} />\n              <path\n                d={isovalueHandlePath}\n                transform={`translate(0,${innerHeight}) rotate(180)`}\n                onPointerDown={() => setDraggedPointIdx(TfEditorSliderHandle.Isosurface)}\n              />\n            </g>\n          )}\n        </g>\n      </svg>\n\n      {/* ----- VOLUME CONTROLS ----- */}\n      {props.volumeEnabled && (\n        <>\n          <h4>Volume settings</h4>\n\n          {/* preset buttons */}\n          <div className=\"tf-editor-control-row\">\n            <div>\n              <Dropdown\n                trigger={[\"click\"]}\n                menu={{\n                  items: [\n                    { key: \"auto98XF\", label: \"Default (50% - 98%)\" },\n                    { key: \"auto2XF\", label: \"ImageJ Auto\" },\n                    { key: \"resetXF\", label: \"Auto 1 (0% - 100%)\" },\n                    { key: \"bestFitXF\", label: \"Auto 2 (10% - 90%)\" },\n                  ],\n                  onClick: ({ key }) => applyTFGenerator(key),\n                }}\n              >\n                <Button size=\"small\">\n                  <span style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\", gap: \"4px\" }}>\n                    Apply ramp\n                    <ViewerIcon type=\"dropdownArrow\" style={{ fontSize: \"14px\" }} />\n                  </span>\n                </Button>\n              </Dropdown>\n            </div>\n            <div>\n              {useRamp && (\n                <>\n                  <span>Levels min/max</span>\n                  <InputNumber\n                    value={props.ramp[0]}\n                    onChange={(v) => v !== null && setRamp([v, props.ramp[1]])}\n                    formatter={numberFormatter}\n                    min={typeRange.min}\n                    max={Math.min(props.ramp[1], typeRange.max)}\n                    size=\"small\"\n                    controls={false}\n                  />\n                  <InputNumber\n                    value={props.ramp[1]}\n                    onChange={(v) => v !== null && setRamp([props.ramp[0], v])}\n                    formatter={numberFormatter}\n                    min={Math.max(typeRange.min, props.ramp[0])}\n                    max={typeRange.max}\n                    size=\"small\"\n                    controls={false}\n                  />\n                  <Tooltip\n                    title={`${props.keepIntensityRange ? \"Do not keep\" : \"Keep\"} intensity threshold values when switching volumes.`}\n                  >\n                    <Button\n                      onClick={() => props.changeChannelSetting({ keepIntensityRange: !props.keepIntensityRange })}\n                      style={{ height: 24, padding: \"0 4px\" }}\n                      type={props.keepIntensityRange ? \"default\" : \"text\"}\n                    >\n                      <span style={{ margin: 0 }}>\n                        {props.keepIntensityRange ? <PushpinFilled /> : <PushpinOutlined />}\n                      </span>\n                    </Button>\n                  </Tooltip>\n                </>\n              )}\n            </div>\n          </div>\n\n          {/* colorize slider */}\n          <SliderRow\n            label={\n              <>\n                <Checkbox\n                  checked={props.useControlPoints}\n                  onChange={(e) => changeChannelSetting({ useControlPoints: e.target.checked })}\n                >\n                  Advanced\n                </Checkbox>\n                <Checkbox\n                  checked={props.colorizeEnabled}\n                  onChange={(e) => changeChannelSetting({ colorizeEnabled: e.target.checked })}\n                  style={{ marginLeft: \"5px\" }}\n                >\n                  Colorize\n                </Checkbox>\n              </>\n            }\n            max={1}\n            start={props.colorizeAlpha}\n            onUpdate={([colorizeAlpha]) => changeChannelSetting({ colorizeAlpha })}\n            hideSlider={!props.colorizeEnabled}\n          />\n        </>\n      )}\n\n      {/* ----- ISOSURFACE CONTROLS ----- */}\n      {props.isosurfaceEnabled && (\n        <>\n          <h4>Isosurface settings</h4>\n          <div className=\"tf-editor-control-row\">\n            <div>\n              Isovalue\n              <InputNumber\n                value={props.isovalue}\n                onChange={(isovalue) => isovalue !== null && changeChannelSetting({ isovalue })}\n                formatter={numberFormatter}\n                min={typeRange.min}\n                max={typeRange.max}\n                size=\"small\"\n                controls={false}\n              />\n            </div>\n            <div>\n              Export surface\n              <Button size=\"small\" onClick={() => props.saveIsosurface(\"GLTF\")}>\n                GLTF\n              </Button>\n              <Button size=\"small\" onClick={() => props.saveIsosurface(\"STL\")}>\n                STL\n              </Button>\n            </div>\n          </div>\n          <SliderRow\n            label=\"Opacity\"\n            max={1.0}\n            start={props.opacity}\n            onUpdate={([opacity]) => changeChannelSetting({ opacity })}\n          />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default TfEditor;\n","import type { Channel } from \"@aics/vole-core\";\nimport { Button, Checkbox, List } from \"antd\";\nimport type { CheckboxChangeEvent } from \"antd/lib/checkbox\";\nimport React, { useCallback, useState } from \"react\";\n\nimport type { IsosurfaceFormat } from \"../../shared/types\";\nimport { colorArrayToObject, type ColorObject, colorObjectToArray } from \"../../shared/utils/colorRepresentations\";\nimport { select, useViewerState } from \"../../state/store\";\nimport type { ChannelState } from \"../../state/types\";\n\nimport ColorPicker from \"../ColorPicker\";\nimport ViewerIcon from \"../shared/ViewerIcon\";\nimport TfEditor from \"../TfEditor\";\n\nimport \"./styles.css\";\n\ninterface ChannelsWidgetRowProps {\n  index: number;\n  name: string;\n  channelDataForChannel: Channel;\n\n  saveIsosurface: (channelIndex: number, type: IsosurfaceFormat) => void;\n  onColorChangeComplete?: (newRGB: ColorObject, oldRGB?: ColorObject, index?: number) => void;\n}\n\nconst ChannelsWidgetRow: React.FC<ChannelsWidgetRowProps> = (props: ChannelsWidgetRowProps) => {\n  const { index, saveIsosurface } = props;\n  const [controlsOpen, setControlsOpen] = useState(false);\n\n  const changeChannelSetting = useViewerState(select(\"changeChannelSetting\"));\n  const channelState = useViewerState(({ channelSettings }) => channelSettings[props.index]);\n\n  const changeSettingForThisChannel = useCallback(\n    (value: Partial<ChannelState>) => changeChannelSetting(index, value),\n    [changeChannelSetting, index]\n  );\n\n  const saveThisIsosurface = useCallback(\n    (format: IsosurfaceFormat) => saveIsosurface(index, format),\n    [saveIsosurface, index]\n  );\n\n  const volumeCheckHandler = ({ target }: CheckboxChangeEvent): void => {\n    changeChannelSetting(index, { volumeEnabled: target.checked });\n  };\n\n  const isosurfaceCheckHandler = ({ target }: CheckboxChangeEvent): void => {\n    changeChannelSetting(index, { isosurfaceEnabled: target.checked });\n  };\n\n  const onColorChange = (newRGB: ColorObject, _oldRGB?: ColorObject, index?: number): void => {\n    const color = colorObjectToArray(newRGB);\n    changeChannelSetting(index!, { color: color });\n  };\n\n  const createColorPicker = (): React.ReactNode => (\n    <ColorPicker\n      color={colorArrayToObject(channelState.color)}\n      onColorChange={onColorChange}\n      onColorChangeComplete={props.onColorChangeComplete}\n      disableAlpha={true}\n      idx={index}\n      width={18}\n    />\n  );\n\n  const visibilityControls = (\n    <div className=\"channel-visibility-controls\">\n      <Checkbox checked={channelState.volumeEnabled} onChange={volumeCheckHandler}>\n        Vol\n      </Checkbox>\n      <Checkbox checked={channelState.isosurfaceEnabled} onChange={isosurfaceCheckHandler}>\n        Surf\n      </Checkbox>\n      <Button\n        icon={<ViewerIcon type=\"preferences\" style={{ fontSize: \"16px\" }} />}\n        onClick={() => setControlsOpen(!controlsOpen)}\n        title=\"Open channel settings\"\n        type=\"text\"\n      />\n    </div>\n  );\n\n  const createTFEditor = (): React.ReactNode => {\n    // TODO this is most of `channelState`... should `TfEditor` just get `channelState`?\n    const { controlPoints, colorizeEnabled, colorizeAlpha, useControlPoints, ramp, plotMin, plotMax, isovalue } =\n      channelState;\n    return (\n      <TfEditor\n        id={\"TFEditor\" + index}\n        width={418}\n        height={145}\n        channelData={props.channelDataForChannel}\n        controlPoints={controlPoints}\n        changeChannelSetting={changeSettingForThisChannel}\n        colorizeEnabled={colorizeEnabled}\n        colorizeAlpha={colorizeAlpha}\n        useControlPoints={useControlPoints}\n        ramp={ramp}\n        plotMin={plotMin}\n        plotMax={plotMax}\n        keepIntensityRange={channelState.keepIntensityRange}\n        isovalue={isovalue}\n        opacity={channelState.opacity}\n        volumeEnabled={channelState.volumeEnabled}\n        isosurfaceEnabled={channelState.isosurfaceEnabled}\n        saveIsosurface={saveThisIsosurface}\n      />\n    );\n  };\n\n  const renderControls = (): React.ReactNode => {\n    if (!channelState.volumeEnabled && !channelState.isosurfaceEnabled) {\n      return <h4 style={{ fontStyle: \"italic\" }}>Not currently visible</h4>;\n    }\n    return <>{(channelState.volumeEnabled || channelState.isosurfaceEnabled) && createTFEditor()}</>;\n  };\n\n  const rowClass = controlsOpen ? \"channel-row\" : \"channel-row controls-closed\";\n  return (\n    <List.Item key={index} className={rowClass}>\n      <List.Item.Meta title={props.name} avatar={createColorPicker()} />\n      {visibilityControls}\n      {controlsOpen && <div style={{ width: \"100%\" }}>{renderControls()}</div>}\n    </List.Item>\n  );\n};\n\nexport default ChannelsWidgetRow;\n","import { Checkbox } from \"antd\";\nimport type { CheckboxChangeEvent } from \"antd/lib/checkbox\";\nimport React from \"react\";\n\ntype SharedCheckboxProps<T> = React.PropsWithChildren<{\n  allOptions: T[];\n  checkedList: T[];\n  onChange: (checked: boolean, checkedList: T[]) => void;\n  style?: React.CSSProperties;\n}>;\n\nconst SharedCheckbox = <T,>(props: SharedCheckboxProps<T>): React.ReactElement => {\n  const onCheckAllChange = ({ target }: CheckboxChangeEvent): void => props.onChange(target.checked, props.allOptions);\n\n  const indeterminate = !!props.checkedList.length && props.checkedList.length < props.allOptions.length;\n  const checkAll = props.checkedList.length === props.allOptions.length;\n\n  return (\n    <Checkbox indeterminate={indeterminate} onChange={onCheckAllChange} checked={checkAll} style={props.style}>\n      {props.children}\n    </Checkbox>\n  );\n};\n\nexport default SharedCheckbox;\n","import type { Channel } from \"@aics/vole-core\";\nimport { Collapse, type CollapseProps, List } from \"antd\";\nimport React from \"react\";\nimport { useShallow } from \"zustand/shallow\";\n\nimport type { IsosurfaceFormat } from \"../shared/types\";\nimport type { ColorArray, ColorObject } from \"../shared/utils/colorRepresentations\";\nimport type { ChannelGrouping, ViewerChannelSettings } from \"../shared/utils/viewerChannelSettings\";\nimport { getDisplayName } from \"../shared/utils/viewerChannelSettings\";\nimport { select, useViewerState, type ViewerStore } from \"../state/store\";\nimport type { ChannelState } from \"../state/types\";\n\nimport ChannelsWidgetRow from \"./ChannelsWidgetRow\";\nimport SharedCheckBox from \"./shared/SharedCheckBox\";\n\n/** A quick custom hook to grab a single state field from every channel */\nconst useSelectFromAllChannels = <K extends keyof ChannelState>(\n  key: K\n): ((store: ViewerStore) => ChannelState[K][]) => {\n  return useShallow(({ channelSettings }: ViewerStore) => {\n    return channelSettings.map((settings) => settings[key]);\n  });\n};\n\nexport type ChannelsWidgetProps = {\n  channelDataChannels: Channel[] | undefined;\n  channelGroupedByType: ChannelGrouping;\n  viewerChannelSettings?: ViewerChannelSettings;\n\n  saveIsosurface: (channelIndex: number, type: IsosurfaceFormat) => void;\n  onApplyColorPresets: (presets: ColorArray[]) => void;\n\n  filterFunc?: (key: string) => boolean;\n  onColorChangeComplete?: (newRGB: ColorObject, oldRGB?: ColorObject, index?: number) => void;\n};\n\nconst ChannelsWidget: React.FC<ChannelsWidgetProps> = (props: ChannelsWidgetProps) => {\n  const { channelGroupedByType, channelDataChannels, filterFunc, viewerChannelSettings } = props;\n\n  const changeChannelSetting = useViewerState(select(\"changeChannelSetting\"));\n  const selectVolumeEnabled = useSelectFromAllChannels(\"volumeEnabled\");\n  const selectIsosurfaceEnabled = useSelectFromAllChannels(\"isosurfaceEnabled\");\n  const selectNames = useSelectFromAllChannels(\"name\");\n  const volumeEnabled = useViewerState(selectVolumeEnabled);\n  const isosurfaceEnabled = useViewerState(selectIsosurfaceEnabled);\n  const channelNames = useViewerState(selectNames);\n\n  const createCheckboxHandler = (key: keyof ChannelState) => (value: boolean, channelArray: number[]) => {\n    changeChannelSetting(channelArray, { [key]: value });\n  };\n\n  const showVolumes = createCheckboxHandler(\"volumeEnabled\");\n  const showSurfaces = createCheckboxHandler(\"isosurfaceEnabled\");\n\n  const renderVisibilityControls = (channelArray: number[]): React.ReactNode => {\n    let volChecked: number[] = [];\n    let isoChecked: number[] = [];\n    channelArray.forEach((channelIndex: number) => {\n      if (volumeEnabled[channelIndex]) {\n        volChecked.push(channelIndex);\n      }\n      if (isosurfaceEnabled[channelIndex]) {\n        isoChecked.push(channelIndex);\n      }\n    });\n\n    return (\n      <>\n        <SharedCheckBox allOptions={channelArray} checkedList={volChecked} onChange={showVolumes}>\n          All Vol\n        </SharedCheckBox>\n        <SharedCheckBox\n          allOptions={channelArray}\n          checkedList={isoChecked}\n          onChange={showSurfaces}\n          // keep checkboxes lined up when channel rows have settings icon and headers don't\n          style={{ flex: 5 }}\n        >\n          All Surf\n        </SharedCheckBox>\n      </>\n    );\n  };\n\n  const renderChannelRow = (channelIndex: number): React.ReactNode => {\n    const channelName = channelNames[channelIndex];\n    return channelName ? (\n      <ChannelsWidgetRow\n        key={channelIndex}\n        index={channelIndex}\n        channelDataForChannel={channelDataChannels![channelIndex]}\n        name={getDisplayName(channelName, channelIndex, viewerChannelSettings)}\n        onColorChangeComplete={props.onColorChangeComplete}\n        saveIsosurface={props.saveIsosurface}\n      />\n    ) : null;\n  };\n\n  const firstKey = Object.keys(channelGroupedByType)[0];\n  const rows: CollapseProps[\"items\"] =\n    channelDataChannels &&\n    Object.entries(channelGroupedByType)\n      .filter(([key, channelArray]) => channelArray.length > 0 && (!filterFunc || filterFunc(key)))\n      .map(([key, channelArray]) => {\n        const children = <List itemLayout=\"horizontal\" dataSource={channelArray} renderItem={renderChannelRow} />;\n\n        return {\n          key,\n          label: key,\n          children,\n          extra: renderVisibilityControls(channelArray),\n        };\n      });\n\n  return <Collapse bordered={false} defaultActiveKey={firstKey} items={rows} collapsible=\"icon\" />;\n};\n\nexport default ChannelsWidget;\n","import React from \"react\";\n\nimport type { Styles } from \"../shared/types\";\nimport { type ColorArray, colorArrayToObject, colorObjectToArray } from \"../shared/utils/colorRepresentations\";\nimport { select, useViewerState } from \"../state/store\";\n\nimport ColorPicker from \"./ColorPicker\";\n\nconst ColorPickerRow: React.FC<{\n  color: ColorArray;\n  onColorChange: (color: ColorArray) => void;\n  children?: React.ReactNode;\n}> = ({ color, onColorChange, children }) => (\n  <div style={STYLES.colorPickerRow}>\n    <span style={STYLES.colorPicker}>\n      <ColorPicker\n        color={colorArrayToObject(color)}\n        onColorChange={(color) => onColorChange(colorObjectToArray(color))}\n        width={18}\n        disableAlpha={true}\n      />\n    </span>\n    <span>{children}</span>\n  </div>\n);\n\nexport interface CustomizeWidgetProps {\n  visibleControls: {\n    backgroundColorPicker: boolean;\n    boundingBoxColorPicker: boolean;\n  };\n}\n\nconst CustomizeWidget: React.FC<CustomizeWidgetProps> = (props) => {\n  const showBoundingBox = useViewerState(select(\"showBoundingBox\"));\n  const backgroundColor = useViewerState(select(\"backgroundColor\"));\n  const boundingBoxColor = useViewerState(select(\"boundingBoxColor\"));\n  const changeViewerSetting = useViewerState(select(\"changeViewerSetting\"));\n\n  return (\n    <>\n      {props.visibleControls.backgroundColorPicker && (\n        <ColorPickerRow\n          color={backgroundColor}\n          onColorChange={(color) => changeViewerSetting(\"backgroundColor\", color)}\n        >\n          Background color\n        </ColorPickerRow>\n      )}\n      {props.visibleControls.boundingBoxColorPicker && (\n        <ColorPickerRow\n          color={boundingBoxColor}\n          onColorChange={(color) => changeViewerSetting(\"boundingBoxColor\", color)}\n        >\n          Bounding box color\n          {!showBoundingBox && <i> - bounding box turned off</i>}\n        </ColorPickerRow>\n      )}\n    </>\n  );\n};\n\nconst STYLES: Styles = {\n  colorPickerRow: {\n    padding: \"14px 0\",\n    display: \"flex\",\n    borderBottom: \"1px solid #6e6e6e\",\n    color: \"var(--color-controlpanel-text)\",\n  },\n  colorPicker: {\n    marginRight: \"16px\",\n  },\n};\n\nexport default CustomizeWidget;\n","import { Checkbox } from \"antd\";\nimport React from \"react\";\n\nimport { select, useViewerState } from \"../state/store\";\n\nimport SliderRow from \"./shared/SliderRow\";\n\ntype GlobalVolumeControlKey = \"maskAlpha\" | \"brightness\" | \"density\" | \"levels\";\n\nexport interface GlobalVolumeControlsProps {\n  imageName: string | undefined;\n  pixelSize: [number, number, number];\n  visibleControls: {\n    alphaMaskSlider: boolean;\n    brightnessSlider: boolean;\n    densitySlider: boolean;\n    levelsSliders: boolean;\n    interpolationControl: boolean;\n  };\n}\n\nconst GlobalVolumeControls: React.FC<GlobalVolumeControlsProps> = (props) => {\n  const maskAlpha = useViewerState(select(\"maskAlpha\"));\n  const brightness = useViewerState(select(\"brightness\"));\n  const density = useViewerState(select(\"density\"));\n  const levels = useViewerState(select(\"levels\"));\n  const interpolationEnabled = useViewerState(select(\"interpolationEnabled\"));\n  const changeViewerSetting = useViewerState(select(\"changeViewerSetting\"));\n\n  const createSliderRow = (\n    label: string,\n    start: number | number[],\n    max: number,\n    propKey: GlobalVolumeControlKey\n  ): React.ReactNode => {\n    const onUpdate = (_strValues: string[], _handle: number, values: number[]): void => {\n      const selectValue = values.length === 1 ? values[0] : (values as [number, number, number]);\n      changeViewerSetting(propKey, selectValue);\n    };\n\n    return <SliderRow label={label} start={start} max={max} onUpdate={onUpdate} />;\n  };\n\n  const { visibleControls: showControls } = props;\n\n  return (\n    <div style={{ paddingTop: 18, paddingBottom: 22 }}>\n      {showControls.alphaMaskSlider && createSliderRow(\"mask cell\", maskAlpha, 100, \"maskAlpha\")}\n      {showControls.brightnessSlider && createSliderRow(\"brightness\", brightness, 100, \"brightness\")}\n      {showControls.densitySlider && createSliderRow(\"density\", density, 100, \"density\")}\n      {showControls.levelsSliders && createSliderRow(\"levels\", levels, 255, \"levels\")}\n      {showControls.interpolationControl && (\n        <SliderRow label=\"interpolate\" hideSlider={true}>\n          <Checkbox\n            checked={interpolationEnabled}\n            onChange={({ target }) => changeViewerSetting(\"interpolationEnabled\", target.checked)}\n          />\n        </SliderRow>\n      )}\n    </div>\n  );\n};\n\nexport default GlobalVolumeControls;\n","import { RightOutlined } from \"@ant-design/icons\";\nimport React from \"react\";\n\nimport type { MetadataEntry, MetadataRecord } from \"../../shared/types\";\n\nimport \"./styles.css\";\n\ntype MetadataTableProps = {\n  metadata: MetadataRecord | MetadataEntry[];\n  topLevel?: boolean;\n};\n\ntype CollapsibleCategoryProps = {\n  metadata: MetadataRecord | MetadataEntry[];\n  title: string;\n};\n\nconst isCategory = (entry: MetadataEntry): entry is MetadataRecord | MetadataEntry[] =>\n  typeof entry === \"object\" && entry !== null;\n\nconst sortCategoriesFirst = (entry: MetadataEntry): MetadataEntry => {\n  if (!isCategory(entry) || Array.isArray(entry)) {\n    return entry;\n  }\n\n  const cats: MetadataRecord = {};\n  const vals: MetadataRecord = {};\n  for (const key in entry) {\n    if (isCategory(entry[key])) {\n      cats[key] = entry[key];\n    } else {\n      vals[key] = entry[key];\n    }\n  }\n\n  return { ...cats, ...vals };\n};\n\n/** Component to hold collapse state */\nconst MetadataCategory: React.FC<CollapsibleCategoryProps> = ({ metadata, title }) => {\n  const [collapsed, setCollapsed] = React.useState(true);\n  const collapsedClass = collapsed ? \" metadata-collapse-collapsed\" : \"\";\n\n  return (\n    <>\n      <tr className={\"metadata-row-collapse-title\" + collapsedClass} onClick={() => setCollapsed(!collapsed)}>\n        <td colSpan={2}>\n          <span className=\"metadata-collapse-caret\">\n            <RightOutlined style={{ transform: `rotate(${collapsed ? 0 : 90}deg)` }} />\n          </span>\n          {title}\n        </td>\n      </tr>\n      <tr className={\"metadata-row-collapse-content\" + collapsedClass}>\n        <td className=\"metadata-collapse-content\" colSpan={2}>\n          <MetadataTable metadata={metadata} />\n        </td>\n      </tr>\n    </>\n  );\n};\n\nconst MetadataTable: React.FC<MetadataTableProps> = ({ metadata, topLevel }) => {\n  const metadataKeys = Object.keys(metadata);\n  const metadataIsArray = Array.isArray(metadata);\n\n  return (\n    <table className={\"viewer-metadata-table\" + (topLevel ? \" metadata-top-level\" : \"\")}>\n      <tbody>\n        {metadataKeys.map((key, idx) => {\n          const metadataValue = sortCategoriesFirst(metadataIsArray ? metadata[idx] : metadata[key]);\n\n          if (isCategory(metadataValue)) {\n            return <MetadataCategory key={key} metadata={metadataValue} title={key} />;\n          } else {\n            return (\n              <tr key={key}>\n                <td className=\"metadata-key\">{key}</td>\n                <td className=\"metadata-value\">{metadataValue + \"\"}</td>\n              </tr>\n            );\n          }\n        })}\n      </tbody>\n    </table>\n  );\n};\n\nconst MetadataViewer: React.FC<{ metadata: MetadataRecord }> = ({ metadata }) => (\n  <MetadataTable metadata={metadata} topLevel={true} />\n);\n\nexport default MetadataViewer;\n","import { Button, Collapse, type CollapseProps, Dropdown, Flex, type MenuProps, Tooltip } from \"antd\";\nimport type { MenuInfo } from \"rc-menu/lib/interface\";\nimport React from \"react\";\n\nimport { PRESET_COLOR_MAP } from \"../../shared/constants\";\nimport type { MetadataRecord } from \"../../shared/types\";\nimport { select, useViewerState } from \"../../state/store\";\n\nimport ChannelsWidget from \"../ChannelsWidget\";\nimport CustomizeWidget, { type CustomizeWidgetProps } from \"../CustomizeWidget\";\nimport GlobalVolumeControls, { type GlobalVolumeControlsProps } from \"../GlobalVolumeControls\";\nimport MetadataViewer from \"../MetadataViewer\";\nimport ViewerIcon from \"../shared/ViewerIcon\";\n\nimport \"./styles.css\";\n\ntype PropsOf<T> = T extends React.ComponentType<infer P> ? P : never;\n\ninterface ControlPanelProps\n  extends PropsOf<typeof ChannelsWidget>,\n    PropsOf<typeof GlobalVolumeControls>,\n    PropsOf<typeof CustomizeWidget> {\n  hasImage: boolean;\n  visibleControls: GlobalVolumeControlsProps[\"visibleControls\"] &\n    CustomizeWidgetProps[\"visibleControls\"] & {\n      colorPresetsDropdown: boolean;\n      metadataViewer: boolean;\n    };\n  metadata: MetadataRecord;\n  collapsed: boolean;\n  setCollapsed: (value: boolean) => void;\n}\n\nconst enum ControlTab {\n  Channels,\n  Advanced,\n  Metadata,\n}\n\nconst ControlTabNames = {\n  [ControlTab.Channels]: \"Channel Settings\",\n  [ControlTab.Advanced]: \"Advanced Settings\",\n  [ControlTab.Metadata]: \"Metadata\",\n};\n\nfunction ControlPanel(props: ControlPanelProps): React.ReactElement {\n  const [tab, _setTab] = React.useState(ControlTab.Channels);\n  const setTab = (newTab: ControlTab): void => {\n    _setTab(newTab);\n    props.setCollapsed(false);\n  };\n  const resetToDefaultViewerState = useViewerState(select(\"resetToDefaultViewerState\"));\n\n  const controlPanelContainerRef = React.useRef<HTMLDivElement>(null);\n  const getDropdownContainer = controlPanelContainerRef.current ? () => controlPanelContainerRef.current! : undefined;\n\n  const { viewerChannelSettings, visibleControls, hasImage } = props;\n\n  // TODO key is a number, but MenuInfo assumes keys will always be strings\n  //   if future versions of antd make this type more permissive, remove ugly double-cast\n  const makeTurnOnPresetFn = ({ key }: MenuInfo): void =>\n    props.onApplyColorPresets(PRESET_COLOR_MAP[key as unknown as number].colors);\n\n  const renderColorPresetsDropdown = (): React.ReactNode => {\n    const dropDownMenuProps: MenuProps = {\n      items: PRESET_COLOR_MAP.map((preset, index) => {\n        return { key: index, label: preset.name };\n      }),\n      onClick: makeTurnOnPresetFn,\n    };\n    return (\n      <div className=\"color-presets-dropdown\">\n        <Dropdown trigger={[\"click\"]} menu={dropDownMenuProps} getPopupContainer={getDropdownContainer}>\n          <Button>\n            <div style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\", gap: \"4px\" }}>\n              Apply palette\n              <ViewerIcon type=\"dropdownArrow\" style={{ fontSize: \"14px\" }} />\n            </div>\n          </Button>\n        </Dropdown>\n      </div>\n    );\n  };\n\n  const renderTab = (thisTab: ControlTab, icon: React.ReactNode): React.ReactNode => (\n    <Tooltip title={ControlTabNames[thisTab]} placement=\"right\" {...(!props.collapsed && { open: false })}>\n      <Button\n        className={tab === thisTab ? \"ant-btn-icon-only btn-tabactive\" : \"ant-btn-icon-only\"}\n        onClick={() => setTab(thisTab)}\n        icon={typeof icon === \"string\" ? icon : undefined}\n      >\n        {typeof icon === \"object\" && icon}\n      </Button>\n    </Tooltip>\n  );\n\n  const renderAdvancedSettings = (): React.ReactNode => {\n    const items: CollapseProps[\"items\"] = [\n      {\n        key: 0,\n        label: \"Rendering adjustments\",\n        children: (\n          <GlobalVolumeControls\n            imageName={props.imageName}\n            pixelSize={props.pixelSize}\n            visibleControls={visibleControls}\n          />\n        ),\n      },\n    ];\n    const showCustomize = visibleControls.backgroundColorPicker || visibleControls.boundingBoxColorPicker;\n\n    if (showCustomize) {\n      items.push({\n        key: 1,\n        label: \"Customize\",\n        children: <CustomizeWidget visibleControls={props.visibleControls} />,\n      });\n    }\n\n    return (\n      <Flex gap={10} vertical>\n        <Collapse bordered={false} defaultActiveKey={showCustomize ? [0, 1] : 0} items={items} />\n        <div style={{ margin: \"0 10px\", width: \"fit-content\" }}>\n          <Tooltip\n            trigger={[\"hover\", \"focus\"]}\n            placement=\"right\"\n            title=\"Clears ALL rendering settings and channel configuration to the default viewer state.\n            This will replace any edits to channel settings, color presets, and rendering adjustments.\"\n          >\n            <Button onClick={resetToDefaultViewerState}>Clear all settings</Button>\n          </Tooltip>\n        </div>\n      </Flex>\n    );\n  };\n\n  return (\n    <div className=\"control-panel-col-container\" ref={controlPanelContainerRef}>\n      <div className=\"control-panel-tab-col\" style={{ flex: \"0 0 50px\" }}>\n        <Button\n          className={\"ant-btn-icon-only btn-collapse\" + (props.collapsed ? \" btn-collapse-collapsed\" : \"\")}\n          onClick={() => props.setCollapsed(!props.collapsed)}\n        >\n          <ViewerIcon type=\"closePanel\" />\n        </Button>\n\n        <div className=\"tab-divider\" />\n\n        {renderTab(ControlTab.Channels, <ViewerIcon type=\"channels\" />)}\n        {renderTab(ControlTab.Advanced, <ViewerIcon type=\"preferences\" />)}\n        {props.visibleControls.metadataViewer && renderTab(ControlTab.Metadata, <ViewerIcon type=\"metadata\" />)}\n      </div>\n      <div className=\"control-panel-col\" style={{ flex: \"0 0 450px\" }}>\n        <h2 className=\"control-panel-title\">{ControlTabNames[tab]}</h2>\n        {visibleControls.colorPresetsDropdown && tab === ControlTab.Channels && renderColorPresetsDropdown()}\n        {hasImage && (\n          <div className=\"channel-rows-list\">\n            {tab === ControlTab.Channels && (\n              <ChannelsWidget\n                channelDataChannels={props.channelDataChannels}\n                channelGroupedByType={props.channelGroupedByType}\n                saveIsosurface={props.saveIsosurface}\n                onColorChangeComplete={props.onColorChangeComplete}\n                onApplyColorPresets={props.onApplyColorPresets}\n                filterFunc={props.filterFunc}\n                viewerChannelSettings={viewerChannelSettings}\n              />\n            )}\n            {tab === ControlTab.Advanced && renderAdvancedSettings()}\n            {tab === ControlTab.Metadata && <MetadataViewer metadata={props.metadata} />}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default ControlPanel;\n","import { Button, Dropdown, type MenuProps, Tooltip } from \"antd\";\nimport React from \"react\";\n\nimport ViewerIcon from \"../shared/ViewerIcon\";\n\ninterface DownloadButtonProps {\n  cellDownloadHref: string;\n  fovDownloadHref: string;\n  hasFov: boolean;\n}\n\nconst DownloadButton: React.FC<DownloadButtonProps> = ({ fovDownloadHref, cellDownloadHref, hasFov }) => {\n  if (hasFov) {\n    const menu: MenuProps = {\n      className: \"download-dropdown\",\n      items: [\n        {\n          key: \"1\",\n          label: (\n            <a href={cellDownloadHref}>\n              <ViewerIcon type=\"download\" /> Segmented cell\n            </a>\n          ),\n        },\n        {\n          key: \"2\",\n          label: (\n            <a href={fovDownloadHref}>\n              <ViewerIcon type=\"download\" /> Full field image\n            </a>\n          ),\n        },\n      ],\n    };\n    return (\n      <Tooltip trigger={[\"hover\", \"focus\"]} placement=\"bottom\" title={\"Download volume data\"}>\n        <Dropdown menu={menu} placement=\"bottomRight\" trigger={[\"click\"]}>\n          <Button className=\"ant-btn-icon-only btn-borderless\">\n            <ViewerIcon type=\"download\" />\n          </Button>\n        </Dropdown>\n      </Tooltip>\n    );\n  } else if (cellDownloadHref) {\n    return (\n      <Tooltip trigger={[\"hover\", \"focus\"]} placement=\"bottom\" title={\"Download volume data\"}>\n        <Button className=\"ant-btn-icon-only btn-borderless\" href={cellDownloadHref}>\n          <ViewerIcon type=\"download\" />\n        </Button>\n      </Tooltip>\n    );\n  } else {\n    return null;\n  }\n};\n\nexport default DownloadButton;\n","import { Radio } from \"antd\";\nimport type { RadioChangeEvent } from \"antd/lib/radio\";\nimport React from \"react\";\n\nimport { ViewMode } from \"../../shared/enums\";\n\nconst viewModes = [ViewMode.threeD, ViewMode.xy, ViewMode.xz, ViewMode.yz];\n\ninterface ViewModeRadioButtonsProps {\n  mode: ViewMode;\n  onViewModeChange: (newMode: ViewMode) => void;\n}\n\nconst ViewModeRadioButtons: React.FC<ViewModeRadioButtonsProps> = (props) => {\n  const onChangeButton = ({ target }: RadioChangeEvent): void => {\n    if (props.mode !== target.value) {\n      props.onViewModeChange(target.value);\n    }\n  };\n\n  return (\n    <Radio.Group onChange={onChangeButton} value={props.mode.toString()}>\n      {viewModes.map((mode, index) => (\n        <Radio.Button key={index} value={mode.toString()}>\n          {mode}\n        </Radio.Button>\n      ))}\n    </Radio.Group>\n  );\n};\n\nexport default ViewModeRadioButtons;\n","import { ReloadOutlined } from \"@ant-design/icons\";\nimport { Button, Radio, Select, Tooltip } from \"antd\";\nimport { debounce } from \"lodash\";\nimport React from \"react\";\n\nimport { ImageType, RenderMode, ViewMode } from \"../../shared/enums\";\nimport { select, useViewerState } from \"../../state/store\";\n\nimport ViewerIcon from \"../shared/ViewerIcon\";\nimport DownloadButton from \"./DownloadButton\";\nimport ViewModeRadioButtons from \"./ViewModeRadioButtons\";\n\nimport \"./styles.css\";\n\ntype ToolbarProps = {\n  cellDownloadHref: string;\n  fovDownloadHref: string;\n  hasCellId: boolean;\n  hasParentImage: boolean;\n  canPathTrace: boolean;\n\n  resetCamera: () => void;\n  downloadScreenshot: () => void;\n  resetToSavedViewerState: () => void;\n\n  visibleControls: {\n    autoRotateButton: boolean;\n    viewModeRadioButtons: boolean;\n    fovCellSwitchControls: boolean;\n    resetCameraButton: boolean;\n    showAxesButton: boolean;\n    showBoundingBoxButton: boolean;\n  };\n};\n\nconst RESIZE_DEBOUNCE_DELAY = 50;\n\nconst visuallyHiddenStyle: React.CSSProperties = {\n  position: \"absolute\",\n  width: \"1px\",\n  height: \"1px\",\n  padding: \"0\",\n  margin: \"-1px\",\n  overflow: \"hidden\",\n  clip: \"rect(0, 0, 0, 0)\",\n  whiteSpace: \"nowrap\",\n  borderWidth: \"0\",\n};\n\nconst Toolbar: React.FC<ToolbarProps> = (props) => {\n  const containerRef = React.useRef<HTMLDivElement>(null);\n  const barRef = React.useRef<HTMLDivElement>(null);\n  const leftRef = React.useRef<HTMLDivElement>(null);\n  const rightRef = React.useRef<HTMLDivElement>(null);\n  const centerRef = React.useRef<HTMLDivElement>(null);\n\n  const [scrollMode, setScrollMode] = React.useState(false);\n  const [showScrollBtnLeft, setScrollBtnLeft] = React.useState(false);\n  const [showScrollBtnRight, setScrollBtnRight] = React.useState(false);\n\n  const imageType = useViewerState(select(\"imageType\"));\n  const renderMode = useViewerState(select(\"renderMode\"));\n  const viewMode = useViewerState(select(\"viewMode\"));\n  const autorotate = useViewerState(select(\"autorotate\"));\n  const showAxes = useViewerState(select(\"showAxes\"));\n  const showBoundingBox = useViewerState(select(\"showBoundingBox\"));\n  const changeViewerSetting = useViewerState(select(\"changeViewerSetting\"));\n\n  // Scroll buttons are only visible when toolbar can be scrolled in that direction.\n  // This may change on either scroll or resize.\n  const checkScrollBtnVisible = React.useCallback((): void => {\n    const barEl = barRef.current;\n    if (!barEl) {\n      return;\n    }\n    setScrollBtnLeft(barEl.scrollLeft > 0);\n    setScrollBtnRight(barEl.scrollLeft < barEl.scrollWidth - barEl.clientWidth);\n  }, []);\n\n  // This is effectively a `useCallback` - it memoizes a function - but since we're feeding the whole function into\n  // lodash's `debounce`, using `useMemo` memoizes the transformation done by `debounce` as well.\n  const checkSize = React.useMemo(() => {\n    return debounce((): void => {\n      if (!leftRef.current || !centerRef.current || !rightRef.current || !barRef.current) {\n        return;\n      }\n      const leftRect = leftRef.current.getBoundingClientRect();\n      const centerRect = centerRef.current.getBoundingClientRect();\n      const rightRect = rightRef.current.getBoundingClientRect();\n\n      // when calculating width required to leave scroll mode, add a bit of extra width to ensure that triggers\n      // for entering and leaving scroll mode never overlap (causing toolbar to rapidly switch when resizing)\n      const SCROLL_OFF_EXTRA_WIDTH = 15;\n\n      setScrollMode((mode) => {\n        if (mode) {\n          // Leave scroll mode if there is enough space for centered controls not to overlap left/right-aligned ones\n          const barWidth = barRef.current!.getBoundingClientRect().width;\n          const requiredWidth =\n            Math.max(leftRect.width, rightRect.width) * 2 + centerRect.width + SCROLL_OFF_EXTRA_WIDTH;\n          return barWidth <= requiredWidth;\n        } else {\n          // Enter scroll mode if centered controls are overlapping either left/right-aligned ones\n          return leftRect.right > centerRect.left || centerRect.right > rightRect.left;\n        }\n      });\n      checkScrollBtnVisible();\n    }, RESIZE_DEBOUNCE_DELAY);\n  }, [checkScrollBtnVisible]);\n\n  React.useEffect(() => {\n    // Make sure `checkSize` is run once on mount\n    checkSize();\n    window.addEventListener(\"resize\", checkSize);\n    return () => window.removeEventListener(\"resize\", checkSize);\n  }, [checkSize]);\n\n  const scrollX = (amount: number): number => (barRef.current!.scrollLeft += amount);\n\n  // Translate vertical scrolling into horizontal scrolling\n  const wheelHandler: React.WheelEventHandler<HTMLDivElement> = (e) => {\n    e.preventDefault();\n    if (e.deltaY === 0) {\n      return;\n    }\n    scrollX(e.deltaY);\n  };\n\n  const toggleAxis = (): void => changeViewerSetting(\"showAxes\", !showAxes);\n  const toggleBoundingBox = (): void => changeViewerSetting(\"showBoundingBox\", !showBoundingBox);\n  // TODO remove ant-btn-icon-only hack when upgrading antd\n  const classForToggleBtn = (active: boolean): string =>\n    \"ant-btn-icon-only btn-borderless\" + (active ? \" btn-active\" : \"\");\n\n  const { visibleControls } = props;\n  const twoDMode = viewMode !== ViewMode.threeD;\n\n  const renderGroup1 =\n    visibleControls.viewModeRadioButtons || visibleControls.resetCameraButton || visibleControls.autoRotateButton;\n  const renderGroup4 = visibleControls.showAxesButton || visibleControls.showBoundingBoxButton;\n\n  const axesToggleTitle = showAxes ? \"Hide axes\" : \"Show axes\";\n  const boundingBoxToggleTitle = showBoundingBox ? \"Hide bounding box\" : \"Show bounding box\";\n  const turntableToggleTitle = autorotate ? \"Turn off turntable\" : \"Turn on turntable\";\n\n  const getPopupContainer = containerRef.current ? () => containerRef.current! : undefined;\n\n  return (\n    <div className={`viewer-toolbar-container${scrollMode ? \" viewer-toolbar-scroll\" : \"\"}`} ref={containerRef}>\n      <div\n        className=\"viewer-toolbar-scroll-left\"\n        style={{ display: showScrollBtnLeft ? \"flex\" : \"none\" }}\n        onClick={() => scrollX(-100)}\n      >\n        <ViewerIcon type=\"closePanel\" style={{ fontSize: \"12px\", transform: \"rotate(180deg)\" }} />\n      </div>\n      <div className=\"viewer-toolbar\" ref={barRef} onWheel={wheelHandler} onScroll={checkScrollBtnVisible}>\n        <div className=\"viewer-toolbar-left\" ref={leftRef}>\n          <Tooltip placement=\"bottom\" title=\"Reset to initial settings\" trigger={[\"focus\", \"hover\"]}>\n            <Button className=\"ant-btn-icon-only btn-borderless\" onClick={props.resetToSavedViewerState}>\n              <ReloadOutlined />\n              <span style={visuallyHiddenStyle}>Reset to initial settings</span>\n            </Button>\n          </Tooltip>\n        </div>\n        <div className=\"viewer-toolbar-center\" ref={centerRef}>\n          {renderGroup1 && (\n            <div className=\"viewer-toolbar-group\">\n              {visibleControls.viewModeRadioButtons && (\n                <ViewModeRadioButtons\n                  mode={viewMode}\n                  onViewModeChange={(newMode) => changeViewerSetting(\"viewMode\", newMode)}\n                />\n              )}\n              {visibleControls.resetCameraButton && (\n                <Tooltip placement=\"bottom\" title=\"Reset camera\">\n                  <Button className=\"ant-btn-icon-only btn-borderless\" onClick={props.resetCamera}>\n                    <ViewerIcon type=\"resetView\" />\n                  </Button>\n                </Tooltip>\n              )}\n              {visibleControls.autoRotateButton && (\n                <Tooltip placement=\"bottom\" title={turntableToggleTitle}>\n                  <Button\n                    className={classForToggleBtn(autorotate && !twoDMode)}\n                    disabled={twoDMode || renderMode === RenderMode.pathTrace}\n                    onClick={() => changeViewerSetting(\"autorotate\", !autorotate)}\n                  >\n                    <ViewerIcon type=\"turnTable\" />\n                  </Button>\n                </Tooltip>\n              )}\n            </div>\n          )}\n\n          {visibleControls.fovCellSwitchControls && props.hasCellId && props.hasParentImage && (\n            <div className=\"viewer-toolbar-group\">\n              <Radio.Group value={imageType} onChange={({ target }) => changeViewerSetting(\"imageType\", target.value)}>\n                <Radio.Button value={ImageType.segmentedCell}>Single cell</Radio.Button>\n                <Radio.Button value={ImageType.fullField}>Full field</Radio.Button>\n              </Radio.Group>\n            </div>\n          )}\n\n          <div className=\"viewer-toolbar-group\">\n            <Select\n              className=\"select-render-setting\"\n              popupClassName=\"viewer-toolbar-dropdown\"\n              value={renderMode}\n              onChange={(value) => changeViewerSetting(\"renderMode\", value)}\n              getPopupContainer={getPopupContainer}\n            >\n              <Select.Option value={RenderMode.volumetric} key={RenderMode.volumetric}>\n                Volumetric\n              </Select.Option>\n              {props.canPathTrace && (\n                <Select.Option value={RenderMode.pathTrace} key={RenderMode.pathTrace} disabled={twoDMode}>\n                  Path trace\n                </Select.Option>\n              )}\n              <Select.Option value={RenderMode.maxProject} key={RenderMode.maxProject}>\n                Max project\n              </Select.Option>\n            </Select>\n          </div>\n\n          {renderGroup4 && (\n            <div className=\"viewer-toolbar-group\">\n              {visibleControls.showAxesButton && (\n                <Tooltip placement=\"bottom\" title={axesToggleTitle}>\n                  <Button className={classForToggleBtn(showAxes)} onClick={toggleAxis}>\n                    <ViewerIcon type=\"axes\" />\n                  </Button>\n                </Tooltip>\n              )}\n              {visibleControls.showBoundingBoxButton && (\n                <Tooltip placement=\"bottom\" title={boundingBoxToggleTitle}>\n                  <Button className={classForToggleBtn(showBoundingBox)} onClick={toggleBoundingBox}>\n                    <ViewerIcon type=\"boundingBox\" />\n                  </Button>\n                </Tooltip>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"viewer-toolbar-right viewer-toolbar-group\" ref={rightRef}>\n          <Tooltip placement=\"bottom\" title=\"Download\">\n            <DownloadButton\n              cellDownloadHref={props.cellDownloadHref}\n              fovDownloadHref={props.fovDownloadHref}\n              hasFov={props.hasCellId && props.hasParentImage}\n            />\n          </Tooltip>\n          <Tooltip placement=\"bottom\" title=\"Screenshot\">\n            <Button className=\"ant-btn-icon-only btn-borderless\" onClick={props.downloadScreenshot}>\n              <ViewerIcon type=\"camera\" />\n            </Button>\n          </Tooltip>\n        </div>\n      </div>\n      <div\n        className=\"viewer-toolbar-scroll-right\"\n        style={{ display: showScrollBtnRight ? \"flex\" : \"none\" }}\n        onClick={() => scrollX(100)}\n      >\n        <ViewerIcon type=\"closePanel\" style={{ fontSize: \"12px\" }} />\n      </div>\n    </div>\n  );\n};\n\nexport default Toolbar;\n","import { Lut, type View3d, type Volume } from \"@aics/vole-core\";\nimport type React from \"react\";\nimport { useEffect } from \"react\";\nimport { useShallow } from \"zustand/shallow\";\n\nimport { binIndexedControlPointsToLut, rampToControlPoints } from \"../../shared/utils/controlPointsToLut\";\nimport { useViewerState, type ViewerStore } from \"../../state/store\";\nimport type { UseImageEffectType } from \"./types\";\n\ninterface ChannelUpdaterProps {\n  index: number;\n  view3d: View3d;\n  image: Volume | null;\n  version: number;\n}\n\n/**\n * A component that doesn't render anything, but reacts to the provided `ChannelState`\n * and keeps it in sync with the viewer.\n */\nconst ChannelUpdater: React.FC<ChannelUpdaterProps> = ({ index, view3d, image, version }) => {\n  const channelStateSelector = useShallow((state: ViewerStore) => state.channelSettings[index]);\n  const channelState = useViewerState(channelStateSelector);\n  const { volumeEnabled, isosurfaceEnabled, isovalue, colorizeEnabled, colorizeAlpha, opacity, color } = channelState;\n\n  // Effects to update channel settings should check if image is present and channel is loaded first\n  const useImageEffect: UseImageEffectType = (effect, deps) => {\n    useEffect(() => {\n      if (image && version > 0) {\n        return effect(image);\n      }\n      // react-hooks will check that `deps` match `effect`'s dependencies, so we can safely exclude `effect` here\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [...deps, image, version]);\n  };\n\n  // enable/disable channel can't be dependent on channel load state because it may trigger the channel to load\n  useEffect(() => {\n    if (image) {\n      view3d.setVolumeChannelEnabled(image, index, volumeEnabled);\n      view3d.updateLuts(image);\n    }\n  }, [image, volumeEnabled, index, view3d]);\n\n  useEffect(() => {\n    if (image) {\n      view3d.setVolumeChannelOptions(image, index, { isosurfaceEnabled });\n    }\n  }, [image, isosurfaceEnabled, index, view3d]);\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeChannelOptions(currentImage, index, { isovalue }),\n    [isovalue, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeChannelOptions(currentImage, index, { isosurfaceOpacity: opacity }),\n    [opacity, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      view3d.setVolumeChannelOptions(currentImage, index, { color });\n      view3d.updateLuts(currentImage);\n    },\n    [color, index, view3d]\n  );\n\n  const { controlPoints, ramp, useControlPoints } = channelState;\n  useImageEffect(\n    (currentImage) => {\n      if (useControlPoints && controlPoints.length < 2) {\n        return;\n      }\n      const histogram = currentImage.getHistogram(index);\n      const controlPointsToUse = useControlPoints ? controlPoints : rampToControlPoints(ramp);\n      // Convert control points from raw intensity values to histogram bin indices\n      const binIndexedControlPoints = controlPointsToUse.map((cp) => ({\n        ...cp,\n        x: histogram.findFractionalBinOfValue(cp.x),\n      }));\n      const gradient = binIndexedControlPointsToLut(binIndexedControlPoints);\n      currentImage.setLut(index, gradient);\n      view3d.updateLuts(currentImage);\n    },\n    [controlPoints, ramp, useControlPoints, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      if (colorizeEnabled) {\n        // TODO get the labelColors from the tf editor component\n        const lut = new Lut().createLabelColors(currentImage.getHistogram(index));\n        currentImage.setColorPalette(index, lut.lut);\n        // following effect will also run and call `updateLuts`\n      }\n    },\n    [colorizeEnabled, index, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => {\n      currentImage.setColorPaletteAlpha(index, colorizeEnabled ? colorizeAlpha : 0);\n      view3d.updateLuts(currentImage);\n    },\n    [colorizeEnabled, colorizeAlpha, index, view3d]\n  );\n\n  return null;\n};\n\nexport default ChannelUpdater;\n","// 3rd Party Imports\nimport { type RawArrayLoaderOptions, View3d, type Volume } from \"@aics/vole-core\";\nimport { Layout } from \"antd\";\nimport { debounce, isEqual } from \"lodash\";\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\n\nimport {\n  AXIS_MARGIN_DEFAULT,\n  CLIPPING_PANEL_HEIGHT_DEFAULT,\n  CLIPPING_PANEL_HEIGHT_TALL,\n  CONTROL_PANEL_CLOSE_WIDTH,\n  getDefaultViewerChannelSettings,\n  getDefaultViewerState,\n  SCALE_BAR_MARGIN_DEFAULT,\n} from \"../../shared/constants\";\nimport { ImageType, ViewMode } from \"../../shared/enums\";\nimport type { IsosurfaceFormat, MetadataRecord, PerAxis } from \"../../shared/types\";\nimport { controlPointsToRamp, initializeLut } from \"../../shared/utils/controlPointsToLut\";\nimport { useConstructor } from \"../../shared/utils/hooks\";\nimport { findFirstChannelMatch } from \"../../shared/utils/viewerChannelSettings\";\nimport { select, useViewerState } from \"../../state/store\";\nimport { subscribeImageToState, subscribeViewToState } from \"../../state/subscribers\";\nimport type { ViewerState } from \"../../state/types\";\nimport useVolume, { ImageLoadStatus } from \"../useVolume\";\nimport type { AppProps, ControlVisibilityFlags, MultisceneUrls, UseImageEffectType } from \"./types\";\n\nimport CellViewerCanvasWrapper from \"../CellViewerCanvasWrapper\";\nimport ControlPanel from \"../ControlPanel\";\nimport { useErrorAlert } from \"../ErrorAlert\";\nimport StyleProvider from \"../StyleProvider\";\nimport Toolbar from \"../Toolbar\";\nimport ChannelUpdater from \"./ChannelUpdater\";\n\nimport \"../../assets/styles/globals.css\";\nimport \"./styles.css\";\n\nconst { Sider, Content } = Layout;\n\nconst defaultVisibleControls: ControlVisibilityFlags = {\n  alphaMaskSlider: true,\n  autoRotateButton: true,\n  axisClipSliders: true,\n  brightnessSlider: true,\n  backgroundColorPicker: true,\n  boundingBoxColorPicker: true,\n  colorPresetsDropdown: true,\n  densitySlider: true,\n  levelsSliders: true,\n  interpolationControl: true,\n  saveSurfaceButtons: true,\n  fovCellSwitchControls: true,\n  viewModeRadioButtons: true,\n  resetCameraButton: true,\n  showAxesButton: true,\n  showBoundingBoxButton: true,\n  metadataViewer: true,\n};\n\nconst defaultProps: AppProps = {\n  // rawData has a \"dtype\" which is expected to be \"uint8\", a \"shape\":[c,z,y,x] and a \"buffer\" which is a DataView\n  rawData: undefined,\n  // rawDims is the volume dims that normally come from a json file\n  rawDims: undefined,\n\n  imageUrl: \"\",\n  parentImageUrl: \"\",\n\n  appHeight: \"100vh\",\n  visibleControls: defaultVisibleControls,\n  viewerSettings: getDefaultViewerState(),\n  cellId: \"\",\n  imageDownloadHref: \"\",\n  parentImageDownloadHref: \"\",\n  pixelSize: undefined,\n  canvasMargin: \"0 0 0 0\",\n  view3dRef: undefined,\n  showError: undefined,\n};\n\nconst CLIPPING_PANEL_ANIMATION_DURATION_MS = 300;\n\nconst setIndicatorPositions = (\n  view3d: View3d,\n  panelOpen: boolean,\n  hasTime: boolean,\n  hasScenes: boolean,\n  isMode3d: boolean\n): void => {\n  // The height of the clipping panel includes the button, but we're trying to put these elements next to the button\n  const CLIPPING_PANEL_BUTTON_HEIGHT = 40;\n  // Move scale bars this far to the left when showing time series, to make room for timestep indicator\n  const SCALE_BAR_TIME_SERIES_OFFSET = 120;\n\n  let axisY = AXIS_MARGIN_DEFAULT[1];\n  let [scaleBarX, scaleBarY] = SCALE_BAR_MARGIN_DEFAULT;\n  if (panelOpen) {\n    // If we have Time, Scene, X, Y, and Z sliders, the drawer will need to be a bit taller\n    let isTall = hasTime && hasScenes && isMode3d;\n    let clippingPanelFullHeight = isTall ? CLIPPING_PANEL_HEIGHT_TALL : CLIPPING_PANEL_HEIGHT_DEFAULT;\n    let clippingPanelHeight = clippingPanelFullHeight - CLIPPING_PANEL_BUTTON_HEIGHT;\n    // Move indicators up out of the way of the clipping panel\n    axisY += clippingPanelHeight;\n    scaleBarY += clippingPanelHeight;\n  }\n  if (hasTime) {\n    // Move scale bar left out of the way of timestep indicator\n    scaleBarX += SCALE_BAR_TIME_SERIES_OFFSET;\n    // Make sure the timestep indicator is showing\n    view3d.setShowTimestepIndicator(true);\n  }\n\n  view3d.setAxisPosition(AXIS_MARGIN_DEFAULT[0], axisY);\n  view3d.setTimestepIndicatorPosition(SCALE_BAR_MARGIN_DEFAULT[0], scaleBarY);\n  view3d.setScaleBarPosition(scaleBarX, scaleBarY);\n};\n\nconst App: React.FC<AppProps> = (props) => {\n  props = { ...defaultProps, ...props };\n\n  // State management /////////////////////////////////////////////////////////\n  const imageType = useViewerState(select(\"imageType\"));\n  const viewMode = useViewerState(select(\"viewMode\"));\n  const scene = useViewerState(select(\"scene\"));\n  const time = useViewerState(select(\"time\"));\n  const showAxes = useViewerState(select(\"showAxes\"));\n  const channelSettings = useViewerState(select(\"channelSettings\"));\n  const changeChannelSetting = useViewerState(select(\"changeChannelSetting\"));\n  const applyColorPresets = useViewerState(select(\"applyColorPresets\"));\n  const resetToSavedState = useViewerState(select(\"resetToSavedViewerState\"));\n\n  const resetToSavedViewerState = useCallback(\n    () => resetToSavedState(props.viewerSettings, props.viewerChannelSettings),\n    [resetToSavedState, props.viewerSettings, props.viewerChannelSettings]\n  );\n\n  // Apply viewer settings to state that have changed since the last prop\n  const prevViewerSettingsPropsRef = useRef<Partial<ViewerState> | undefined>();\n  if (props.viewerSettings && !isEqual(props.viewerSettings, prevViewerSettingsPropsRef.current)) {\n    for (const key of Object.keys(props.viewerSettings) as (keyof ViewerState)[]) {\n      const value = props.viewerSettings[key];\n      const lastValue = prevViewerSettingsPropsRef.current?.[key] ?? undefined;\n      if (value !== undefined && !isEqual(value, lastValue)) {\n        useViewerState.getState().changeViewerSetting(key, value);\n      }\n    }\n    prevViewerSettingsPropsRef.current = props.viewerSettings;\n  }\n\n  const view3d = useConstructor(() => new View3d());\n  if (props.view3dRef !== undefined) {\n    props.view3dRef.current = view3d;\n  }\n\n  // Allows AppWrapper to pass in its own `useErrorAlert` callbacks, but still keeps error\n  // messaging when App is used standalone.\n  const [errorAlert, _showError] = useErrorAlert();\n  const showError = props.showError ?? _showError;\n\n  useEffect(() => {\n    // Get notifications of loading errors which occur after the initial load, e.g. on time change or new channel load\n    view3d.setLoadErrorHandler((_vol, e) => showError(e));\n    return () => view3d.setLoadErrorHandler(undefined);\n  }, [view3d, showError]);\n\n  const imageUrlRef = useRef<string | string[] | MultisceneUrls>(\"\");\n  const scenesRef = useRef<(string | string[])[] | [RawArrayLoaderOptions]>([]);\n  const { imageUrl, parentImageUrl, rawData, rawDims } = props;\n  const scenes = useMemo((): (string | string[])[] | [RawArrayLoaderOptions] => {\n    if (rawData && rawDims) {\n      return [{ data: rawData, metadata: rawDims }];\n    } else {\n      const showParentImage = imageType === ImageType.fullField && parentImageUrl !== undefined;\n      const path = showParentImage ? parentImageUrl : imageUrl;\n      // Don't reload if we're already looking at this image\n      if (isEqual(path, imageUrlRef.current)) {\n        return scenesRef.current;\n      }\n      imageUrlRef.current = path;\n\n      const result = (path as MultisceneUrls).scenes ?? [path];\n      scenesRef.current = result;\n      return result;\n    }\n  }, [imageUrl, parentImageUrl, rawData, rawDims, imageType]);\n\n  const maskChannelName = props.viewerChannelSettings?.maskChannelName;\n\n  // we need to keep track of channel ranges for remapping control points\n  const channelRangesRef = useRef<([number, number] | undefined)[]>([]);\n\n  const removePreviousImage = useRef<(() => void) | undefined>(undefined);\n\n  const { onImageTitleChange } = props;\n  const onCreateImage = useCallback(\n    (newImage: Volume): void => {\n      removePreviousImage.current?.();\n\n      if (newImage === null) {\n        return;\n      }\n\n      const { channelSettings: channelState } = useViewerState.getState();\n      const { channelNames } = newImage;\n      channelRangesRef.current = channelNames.map((_, i) => {\n        return channelState[i]?.keepIntensityRange ? channelRangesRef.current[i] : undefined;\n      });\n\n      const { useDefaultViewerChannelSettings } = useViewerState.getState();\n      const viewerChannelSettings = useDefaultViewerChannelSettings\n        ? getDefaultViewerChannelSettings()\n        : props.viewerChannelSettings;\n\n      // If the image has channel color metadata, apply those colors now\n      const channelColorMeta = newImage.imageInfo.channelColors?.map((color, index) => {\n        // Filter out channels that have colors in `viewerChannelSettings`\n        if (viewerChannelSettings === undefined) {\n          return color;\n        }\n        const settings = findFirstChannelMatch(channelNames[index], index, viewerChannelSettings);\n        if (settings?.color !== undefined) {\n          return undefined;\n        } else {\n          return color;\n        }\n      });\n      if (Array.isArray(channelColorMeta)) {\n        channelColorMeta.forEach((color, index) => {\n          if (Array.isArray(color) && index < channelNames.length) {\n            changeChannelSetting(index, { color });\n          }\n        });\n      }\n\n      view3d.addVolume(newImage, {\n        // Immediately passing down channel parameters isn't strictly necessary, but keeps things looking consistent on load\n        channels: newImage.channelNames.map((name, index) => {\n          // TODO do we really need to be searching by name here?\n          const ch = channelState.find((channel) => channel.name === name);\n          if (!ch) {\n            return {};\n          }\n          return {\n            enabled: ch.volumeEnabled,\n            isosurfaceEnabled: ch.isosurfaceEnabled,\n            isovalue: ch.isovalue,\n            isosurfaceOpacity: ch.opacity,\n            color: channelColorMeta?.[index] ?? ch.color,\n          };\n        }),\n      });\n\n      view3d.updateActiveChannels(newImage);\n      const unsubscribeView = subscribeViewToState(useViewerState, view3d);\n      const unsubscribeImage = subscribeImageToState(useViewerState, view3d, newImage);\n      removePreviousImage.current = () => {\n        unsubscribeView();\n        unsubscribeImage();\n        view3d.removeAllVolumes();\n        removePreviousImage.current = undefined;\n      };\n    },\n    [props.viewerChannelSettings, view3d, changeChannelSetting]\n  );\n\n  const [loadedScene, setLoadedScene] = useState<number | undefined>(undefined);\n  const onChangeScene = useCallback(\n    (image: Volume, sceneIndex: number) => {\n      onImageTitleChange?.(image.imageInfo.imageInfo.name);\n      setLoadedScene(sceneIndex);\n    },\n    [onImageTitleChange]\n  );\n\n  const onChannelLoaded = useCallback(\n    (image: Volume, channelIndex: number, isInitialLoad: boolean): void => {\n      // TODO this was once a search by name - is that still necessary or will\n      // the index always be correct?\n      const { channelsToResetOnLoad, useDefaultViewerChannelSettings, channelSettings } = useViewerState.getState();\n      const channelState = channelSettings[channelIndex];\n\n      const viewerChannelSettings = useDefaultViewerChannelSettings\n        ? getDefaultViewerChannelSettings()\n        : props.viewerChannelSettings;\n      const thisChannel = image.getChannel(channelIndex);\n      const noLut = !channelState || !channelState.controlPoints || !channelState.ramp;\n\n      const hasOldRange = channelRangesRef.current[channelIndex] !== undefined;\n      const canInitializeToExistingRange = channelState?.keepIntensityRange && hasOldRange;\n      // True if we are loading new data and the old range cannot or should not\n      // be kept (no saved range or keeping intensities is disabled).\n      const needsInitializeToDefaults = isInitialLoad && !canInitializeToExistingRange;\n\n      if (needsInitializeToDefaults || noLut || channelsToResetOnLoad.includes(channelIndex)) {\n        // This channel needs its LUT initialized\n        const { ramp, controlPoints } = initializeLut(image, channelIndex, viewerChannelSettings);\n\n        // Initialize isovalue to channel settings or default to midpoint of data range\n        const name = image.channelNames[channelIndex];\n        const initSettings = viewerChannelSettings && findFirstChannelMatch(name, channelIndex, viewerChannelSettings);\n        const defaultIsovalue = thisChannel.rawMin + (thisChannel.rawMax - thisChannel.rawMin) / 2;\n        const isovalue = initSettings?.isovalue ?? defaultIsovalue;\n\n        changeChannelSetting(channelIndex, {\n          controlPoints: controlPoints,\n          ramp: controlPointsToRamp(ramp),\n          // set the default range of the transfer function editor to cover the full range of the data type\n          plotMin: thisChannel.rawMin,\n          plotMax: thisChannel.rawMax,\n          isovalue,\n        });\n      } else {\n        // Expand the plot min and max to include the current data range as\n        // needed. This keeps the domain visually consistent when replaying\n        // through time or Z slices.\n        //\n        // NOTE: This must use the most up-to-date channel plot range, because\n        // onChannelLoaded can be called multiple times per channel during\n        // loading.\n        changeChannelSetting(channelIndex, {\n          plotMin: Math.min(thisChannel.rawMin, channelState.plotMin),\n          plotMax: Math.max(thisChannel.rawMax, channelState.plotMax),\n        });\n      }\n\n      // save the channel's new range for remapping next time\n      channelRangesRef.current[channelIndex] = [thisChannel.rawMin, thisChannel.rawMax];\n\n      view3d.updateLuts(image);\n      view3d.onVolumeData(image, [channelIndex]);\n\n      if (image.channelNames[channelIndex] === maskChannelName) {\n        view3d.setVolumeChannelAsMask(image, channelIndex);\n      }\n      if (image.isLoaded()) {\n        view3d.updateActiveChannels(image);\n      }\n    },\n    [view3d, changeChannelSetting, maskChannelName, props.viewerChannelSettings]\n  );\n\n  const onError = useCallback(\n    (error: unknown) => {\n      showError(error);\n      onImageTitleChange?.(undefined);\n    },\n    [showError, onImageTitleChange]\n  );\n\n  const volume = useVolume(scenes, {\n    viewerChannelSettings: props.viewerChannelSettings,\n    onCreateImage,\n    onChannelLoaded,\n    onChangeScene,\n    onError,\n    maskChannelName,\n  });\n  const { image, setTime, setScene } = volume;\n\n  const hasRawImage = !!(props.rawData && props.rawDims);\n  const numScenes = hasRawImage ? 1 : ((props.imageUrl as MultisceneUrls).scenes?.length ?? 1);\n  const numSlices: PerAxis<number> = image?.imageInfo.volumeSize ?? { x: 1, y: 1, z: 1 };\n  const numSlicesLoaded: PerAxis<number> = image?.imageInfo.subregionSize ?? { x: 0, y: 0, z: 0 };\n  const numTimesteps = image?.imageInfo.times ?? 1;\n\n  // const [channelGroupedByType, setChannelGroupedByType] = useState<ChannelGrouping>({});\n  const [controlPanelClosed, setControlPanelClosed] = useState(() => window.innerWidth < CONTROL_PANEL_CLOSE_WIDTH);\n  // Only allow auto-close once while the screen is too narrow.\n  const [hasAutoClosedControlPanel, setHasAutoClosedControlPanel] = useState(false);\n\n  const [clippingPanelOpen, setClippingPanelOpen] = useState(true);\n  const clippingPanelOpenTimeout = useRef<number>(0);\n\n  // Imperative callbacks /////////////////////////////////////////////////////\n\n  const saveIsosurface = useCallback(\n    (channelIndex: number, type: IsosurfaceFormat): void => {\n      if (image) view3d.saveChannelIsosurface(image, channelIndex, type);\n    },\n    [image, view3d]\n  );\n\n  const saveScreenshot = useCallback((): void => {\n    view3d.capture((dataUrl: string) => {\n      const anchor = document.createElement(\"a\");\n      anchor.href = dataUrl;\n      anchor.download = \"screenshot.png\";\n      anchor.click();\n    });\n  }, [view3d]);\n\n  const { metadataFormatter } = props;\n  const metadata = useMemo((): MetadataRecord => {\n    let imageMetadata = image?.imageMetadata as MetadataRecord;\n    if (imageMetadata && metadataFormatter) {\n      imageMetadata = metadataFormatter(imageMetadata);\n    }\n    const propsMetadata = props.metadata;\n\n    let sceneMeta: MetadataRecord | undefined;\n    if (Array.isArray(propsMetadata)) {\n      // If metadata is an array, try to index it by scene\n      if (propsMetadata.length >= numScenes && loadedScene !== undefined) {\n        sceneMeta = propsMetadata[loadedScene];\n      } else {\n        sceneMeta = propsMetadata[0];\n      }\n    } else {\n      sceneMeta = propsMetadata;\n    }\n\n    if (imageMetadata && Object.keys(imageMetadata).length > 0) {\n      return { Image: imageMetadata, ...sceneMeta };\n    } else {\n      return sceneMeta ?? {};\n    }\n  }, [props.metadata, metadataFormatter, image, loadedScene, numScenes]);\n\n  useEffect((): void => {\n    const hasTime = numTimesteps > 1;\n    const hasScenes = numScenes > 1;\n    const mode3d = viewMode === ViewMode.threeD;\n\n    setIndicatorPositions(view3d, clippingPanelOpen, hasTime, hasScenes, mode3d);\n\n    // Hide indicators while clipping panel is in motion - otherwise they pop to the right place prematurely\n    if (clippingPanelOpen) {\n      view3d.setShowScaleBar(false);\n      view3d.setShowTimestepIndicator(false);\n      view3d.setShowAxis(false);\n\n      window.clearTimeout(clippingPanelOpenTimeout.current);\n      clippingPanelOpenTimeout.current = window.setTimeout(() => {\n        view3d.setShowScaleBar(true);\n        view3d.setShowTimestepIndicator(true);\n        if (showAxes) {\n          view3d.setShowAxis(true);\n        }\n      }, CLIPPING_PANEL_ANIMATION_DURATION_MS);\n    }\n  }, [view3d, numTimesteps, numScenes, viewMode, showAxes, clippingPanelOpen]);\n\n  // Effects //////////////////////////////////////////////////////////////////\n\n  // On mount\n  useEffect(() => {\n    const onResize = (): void => {\n      if (window.innerWidth < CONTROL_PANEL_CLOSE_WIDTH) {\n        if (!hasAutoClosedControlPanel) {\n          setControlPanelClosed(true);\n          setHasAutoClosedControlPanel(true);\n        }\n      } else {\n        setHasAutoClosedControlPanel(false);\n      }\n    };\n    const onResizeDebounced = debounce(onResize, 500);\n\n    window.addEventListener(\"resize\", onResizeDebounced);\n    return () => window.removeEventListener(\"resize\", onResizeDebounced);\n  }, [hasAutoClosedControlPanel]);\n\n  const { onControlPanelToggle } = props;\n  useEffect(\n    () => onControlPanelToggle && onControlPanelToggle(controlPanelClosed),\n    [controlPanelClosed, onControlPanelToggle]\n  );\n\n  useEffect(() => {\n    // delayed for the animation to finish\n    window.setTimeout(() => {\n      window.dispatchEvent(new Event(\"resize\"));\n    }, 200);\n  }, [controlPanelClosed]);\n\n  /** Custom effect hook for viewer updates that depend on `image`, so we don't have to repeatedly null-check it */\n  const useImageEffect: UseImageEffectType = (effect, deps) => {\n    useEffect(() => {\n      if (image && volume.imageLoadStatus === ImageLoadStatus.LOADED) {\n        return effect(image);\n      }\n      // react-hooks will check that `deps` match `effect`'s dependencies, so we can safely exclude `effect` here\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [...deps, image, volume.imageLoadStatus]);\n  };\n\n  // Effects to imperatively sync `viewerSettings` to `view3d`\n\n  useImageEffect(\n    (image) => {\n      // Check whether any channels are marked to be reset and apply it.\n      const viewerState = useViewerState.getState();\n      const { channelsToReset, onResetChannel, useDefaultViewerChannelSettings } = viewerState;\n      const viewerChannelSettings = useDefaultViewerChannelSettings\n        ? getDefaultViewerChannelSettings()\n        : props.viewerChannelSettings;\n      for (let i = 0; i < channelSettings.length; i++) {\n        if (channelsToReset.includes(i)) {\n          const { ramp, controlPoints } = initializeLut(image, i, viewerChannelSettings);\n          changeChannelSetting(i, { controlPoints: controlPoints, ramp: controlPointsToRamp(ramp) });\n          onResetChannel(i);\n        }\n      }\n    },\n    [changeChannelSetting, channelSettings, props.viewerChannelSettings]\n  );\n\n  // `time` and `scene` have their own special handlers via `volume`, since they both trigger loads\n  useEffect(() => setTime(view3d, time), [view3d, time, setTime]);\n  useEffect(() => setScene(scene), [scene, setScene]);\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeTranslation(currentImage, props.transform?.translation || [0, 0, 0]),\n    [props.transform?.translation, view3d]\n  );\n\n  useImageEffect(\n    (currentImage) => view3d.setVolumeRotation(currentImage, props.transform?.rotation || [0, 0, 0]),\n    [props.transform?.rotation, view3d]\n  );\n\n  // Rendering ////////////////////////////////////////////////////////////////\n\n  const visibleControls = useMemo(\n    (): ControlVisibilityFlags => ({ ...defaultVisibleControls, ...props.visibleControls }),\n    [props.visibleControls]\n  );\n  const pixelSize = useMemo(\n    (): [number, number, number] => (image ? image.imageInfo.physicalPixelSize.toArray() : [1, 1, 1]),\n    [image]\n  );\n  const resetCamera = useMemo(() => view3d.resetCamera.bind(view3d), [view3d]);\n\n  return (\n    <StyleProvider>\n      {errorAlert}\n      <Layout className=\"cell-viewer-app\" style={{ height: props.appHeight }}>\n        {channelSettings.map(({ name }, index) => (\n          <ChannelUpdater\n            key={`${index}_${name}`}\n            index={index}\n            view3d={view3d}\n            image={image}\n            version={volume.channelVersions[index]}\n          />\n        ))}\n        <Sider\n          className=\"control-panel-holder\"\n          collapsible={true}\n          defaultCollapsed={false}\n          collapsedWidth={50}\n          trigger={null}\n          collapsed={controlPanelClosed}\n          width={500}\n        >\n          <ControlPanel\n            visibleControls={visibleControls}\n            collapsed={controlPanelClosed}\n            // image state\n            imageName={image?.name}\n            hasImage={!!image}\n            pixelSize={pixelSize}\n            channelDataChannels={image?.channels}\n            channelGroupedByType={volume.channelGroupedByType}\n            // functions\n            setCollapsed={setControlPanelClosed}\n            saveIsosurface={saveIsosurface}\n            onApplyColorPresets={applyColorPresets}\n            viewerChannelSettings={props.viewerChannelSettings}\n            metadata={metadata}\n          />\n        </Sider>\n        <Layout className=\"cell-viewer-wrapper\" style={{ margin: props.canvasMargin }}>\n          <Content>\n            <Toolbar\n              fovDownloadHref={props.parentImageDownloadHref}\n              cellDownloadHref={props.imageDownloadHref}\n              hasParentImage={!!props.parentImageUrl}\n              hasCellId={!!props.cellId}\n              canPathTrace={view3d ? view3d.hasWebGL2() : false}\n              resetCamera={resetCamera}\n              downloadScreenshot={saveScreenshot}\n              resetToSavedViewerState={resetToSavedViewerState}\n              visibleControls={visibleControls}\n            />\n            <CellViewerCanvasWrapper\n              view3d={view3d}\n              image={image}\n              loadingImage={volume.imageLoadStatus === ImageLoadStatus.REQUESTED}\n              numSlices={numSlices}\n              numSlicesLoaded={numSlicesLoaded}\n              numTimesteps={numTimesteps}\n              numScenes={numScenes}\n              playControls={volume.playControls}\n              playingAxis={volume.playingAxis}\n              appHeight={props.appHeight}\n              visibleControls={visibleControls}\n              clippingPanelOpen={clippingPanelOpen}\n              onClippingPanelOpenChange={setClippingPanelOpen}\n            />\n          </Content>\n        </Layout>\n      </Layout>\n    </StyleProvider>\n  );\n};\n\nexport default App;\n","import { Button } from \"antd\";\nimport React from \"react\";\nimport styled from \"styled-components\";\n\n// TODO: Make exports here for primary/tertiary buttons to abstract away\n// Ant button styling.\n\n// Enforce the primary type for behavior on hover.\nconst PrimaryButton = React.forwardRef<HTMLButtonElement, { children?: React.ReactNode }>((props, ref) => (\n  <Button {...props} ref={ref} type=\"primary\">\n    {props.children}\n  </Button>\n));\n// Used for debugging in React. Eslint complains if not set.\nPrimaryButton.displayName = \"PrimaryButton\";\n\n// Secondary button is outlined but turns solid on hover (uses primary button behavior).\nexport const SecondaryButton = styled(PrimaryButton)`\n  &&& {\n    background-color: var(--color-button-secondary-bg);\n    border: 1px solid var(--color-button-secondary-outline);\n    color: var(--color-button-secondary-text);\n  }\n` as typeof Button;\n","import { Button, Dropdown, type MenuProps, Modal } from \"antd\";\nimport React, { type ReactElement, useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\n\nimport { DropdownSVG } from \"../assets/icons\";\nimport { FlexColumnAlignCenter, FlexRowAlignCenter } from \"./LandingPage/utils\";\n\nimport { SecondaryButton } from \"./Buttons\";\n\n// Defined in webpack config\ndeclare const VOLEAPP_VERSION: string;\ndeclare const VOLECORE_VERSION: string;\n\nexport default function HelpDropdown(): ReactElement {\n  const [container, setContainer] = useState<HTMLDivElement | null>();\n  const containerRef = React.useRef<HTMLDivElement>(null);\n\n  const [showVersionModal, setShowVersionModal] = useState(false);\n\n  const items: MenuProps[\"items\"] = [\n    {\n      key: \"github\",\n      label: (\n        <Link to=\"https://github.com/allen-cell-animated/vole-app\" target=\"_blank\" rel=\"noreferrer noopener\">\n          Visit GitHub repository\n        </Link>\n      ),\n    },\n    {\n      key: \"github-issue\",\n      label: (\n        <Link\n          to=\"https://github.com/allen-cell-animated/vole-app/issues/new/choose\"\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n        >\n          Report issue via GitHub\n        </Link>\n      ),\n    },\n    {\n      key: \"forum\",\n      label: (\n        <Link to=\"https://forum.allencell.org/c/software-code/11\" target=\"_blank\" rel=\"noreferrer noopener\">\n          Allen Cell Discussion Forum\n        </Link>\n      ),\n    },\n    {\n      key: \"version\",\n      label: \"Version info\",\n      onClick: () => {\n        setShowVersionModal(true);\n      },\n    },\n  ];\n\n  // Use state update here to force a re-render so Dropdown is rendered with a valid `getContainer` callback.\n  // Otherwise, the `getContainer` callback will be undefined on the first render.\n  useEffect(() => {\n    setContainer(containerRef.current);\n  }, []);\n  const getContainer = container !== null ? () => container! : undefined;\n\n  const closeVersionModal = (): void => setShowVersionModal(false);\n\n  return (\n    <div ref={containerRef}>\n      <Dropdown menu={{ items: items }} getPopupContainer={getContainer} trigger={[\"click\"]}>\n        <SecondaryButton>\n          <FlexRowAlignCenter $gap={6}>\n            Help <DropdownSVG />\n          </FlexRowAlignCenter>\n        </SecondaryButton>\n      </Dropdown>\n      <Modal\n        open={showVersionModal}\n        title=\"Version info\"\n        getContainer={getContainer}\n        onCancel={() => setShowVersionModal(false)}\n        footer={<Button onClick={closeVersionModal}>Close</Button>}\n      >\n        <FlexColumnAlignCenter $gap={0}>\n          <p style={{ margin: 0 }}>Vol-E App v{VOLEAPP_VERSION}</p>\n          <p style={{ margin: 0 }}>Vol-E Core package v{VOLECORE_VERSION}</p>\n        </FlexColumnAlignCenter>\n      </Modal>\n    </div>\n  );\n}\n","import { useCallback, useMemo } from \"react\";\nimport { useLocalStorage } from \"usehooks-ts\";\n\n/** Key for local storage to read/write recently opened datasets */\nconst RECENT_DATASETS_STORAGE_KEY = \"WEBSITE_3D_CELL_VIEWER.recentDatasets\";\nconst MAX_RECENT_URLS = 100;\n\n// Label and URL are stored separately, so if a user provides an input URL (the label) that is transformed into an absolute\n// URL, we can check for duplicates using the absolute URL while still showing the user's input.\n// This is more relevant in nucmorph, where we're resolving filepaths to absolute URLs, but it's useful functionality to bake in\n// for future use.\n\nexport type RecentDataUrl = {\n  /** The absolute URL path, post any transformation or remapping. Stored for comparison between urls. */\n  url: string;\n  /** The user input that was used to load the data. */\n  label: string;\n};\n\n/**\n * Wrapper around locally-stored recent urls.\n * @returns an array containing the list of recent data urls and a function to add a new url to the list.\n */\nexport const useRecentDataUrls = (): [RecentDataUrl[], (newEntry: RecentDataUrl) => void] => {\n  const [storedRecentEntries, setRecentEntries] = useLocalStorage<RecentDataUrl[]>(RECENT_DATASETS_STORAGE_KEY, []);\n\n  // Sanitize/validate recent entries\n  let recentEntries: RecentDataUrl[] = useMemo(\n    () => storedRecentEntries.filter(({ url, label }) => typeof url === \"string\" && typeof label === \"string\"),\n    [storedRecentEntries]\n  );\n  if (recentEntries.length !== storedRecentEntries.length) {\n    setRecentEntries(recentEntries);\n  }\n\n  /** Adds a new URL entry (url + label) to the list of recent datasets. */\n  const addRecentEntry = useCallback(\n    (newEntry: RecentDataUrl): void => {\n      if (recentEntries === null) {\n        setRecentEntries([newEntry]);\n        return;\n      }\n\n      // Find matches by absolute URL and move to front of the list if a match exists.\n      const datasetIndex = recentEntries.findIndex(({ url }) => url === newEntry.url);\n      if (datasetIndex === -1) {\n        // New entry, add to front while maintaining max length\n        setRecentEntries([newEntry as RecentDataUrl, ...recentEntries.slice(0, MAX_RECENT_URLS - 1)]);\n      } else {\n        // Move to front; this also updates the label if it changed.\n        setRecentEntries([\n          newEntry as RecentDataUrl,\n          ...recentEntries.slice(0, datasetIndex),\n          ...recentEntries.slice(datasetIndex + 1),\n        ]);\n      }\n    },\n    [recentEntries, setRecentEntries]\n  );\n\n  return [recentEntries || [], addRecentEntry];\n};\n","import React, { type ReactElement } from \"react\";\nimport styled, { css } from \"styled-components\";\n\n// Adapted from \"CSS-only middle truncation with ellipsis\"\n// by Mark Chitty https://codepen.io/markchitty/pen/RNZbRE\n\ntype MiddleTruncatedTextProps = {\n  text: string;\n  /** Minimum characters to show at the start of the text. 3 by default. */\n  startCharacters?: number;\n  /**\n   * Minimum characters to show at the end of the text. Hidden by start characters if the container\n   * does not have enough space. 35 by default.\n   */\n  endCharacters?: number;\n};\n\nconst defaultProps: Partial<MiddleTruncatedTextProps> = {\n  startCharacters: 3,\n  endCharacters: 35,\n};\n\nconst MiddleTruncatedTextContainer = styled.div<{ $startChars: number; $endChars: number }>`\n  display: flex;\n  flex-direction: row;\n  vertical-align: bottom;\n  white-space: nowrap;\n\n  ${(props) => {\n    // Determined experimentally. If this is too high, excess padding will appear to the right of\n    // the end text. If this is too low, the end text will be clipped.\n    const characterPxWidthToFontSizeRatio = 0.5;\n    return css`\n      --startWidth: calc(1em * ${props.$startChars + 3} * ${characterPxWidthToFontSizeRatio});\n      --endWidth: calc(1em * ${props.$endChars} * ${characterPxWidthToFontSizeRatio});\n\n      & span {\n        display: inline-block;\n        vertical-align: bottom;\n        white-space: nowrap;\n        overflow: hidden;\n      }\n\n      & span:first-child {\n        max-width: calc(100% - var(--endWidth));\n        min-width: var(--startWidth);\n        text-overflow: ellipsis;\n        overflow: hidden;\n      }\n\n      & span:last-child {\n        max-width: calc(100% - var(--startWidth));\n        direction: rtl;\n        z-index: 800;\n      }\n    `;\n  }}\n`;\n\n/**\n * Renders text that will be truncated with ellipses in the middle of the text if there isn't\n * enough space to show the full text. The number of characters shown at the start and end of the text are configurable.\n *\n * @example\n * ```\n * <MiddleTruncatedText text=\"This is a long text that will be truncated in the middle\" startCharacters={3} endCharacters={5} />\n * ```\n * can be rendered as any of the following depending on the available space:\n * - `This is a long text that will be truncated in the middle`\n * - `This is a long text that will ...iddle`\n * - `This is a long text...iddle`\n * - `Thi...iddle`\n * - `Thi...`\n */\nexport default function MiddleTruncatedText(inputProps: MiddleTruncatedTextProps): ReactElement {\n  const props = { ...defaultProps, ...inputProps } as Required<MiddleTruncatedTextProps>;\n\n  let startChars = Math.max(0, props.startCharacters);\n  let endChars = Math.max(0, props.endCharacters);\n  if (props.text.length <= startChars + endChars) {\n    endChars = props.text.length - startChars;\n  }\n\n  const splitIndex = Math.max(0, props.text.length - endChars);\n  const startText = props.text.slice(0, splitIndex);\n  const endText = props.text.slice(splitIndex);\n\n  // TODO: Text characters in endText can be partially clipped. Is there a way to prevent this from happening?\n\n  return (\n    <MiddleTruncatedTextContainer\n      $startChars={startChars}\n      $endChars={endChars}\n      aria-label={props.text}\n      title={props.text}\n    >\n      {\n        // The `$lrm;` is a non-printing character that indicates text punctuation should be rendered as left-to-right instead of rtl.\n        // It's included to prevent a visual bug where punctuation at the start (ex: !?_.:, etc.)\n        // of `endText` is rendered at the end instead. See https://en.wikipedia.org/wiki/Left-to-right_mark.\n        // (we are using rtl rendering so that the ellipses render on the left side of the text. )\n      }\n      <span>{startText}</span>\n      <span>&lrm;{endText}</span>\n    </MiddleTruncatedTextContainer>\n  );\n}\n","import { UploadOutlined } from \"@ant-design/icons\";\nimport { AutoComplete, Button, Modal } from \"antd\";\nimport Fuse from \"fuse.js\";\nimport React, { type ReactElement, useMemo, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\n\nimport type { AppDataProps } from \"../../types\";\nimport { type RecentDataUrl, useRecentDataUrls } from \"../../utils/react_utils\";\nimport { isValidUrl } from \"../../utils/urls\";\nimport { FlexRow } from \"../LandingPage/utils\";\n\nimport MiddleTruncatedText from \"../MiddleTruncatedText\";\n\nconst MAX_RECENT_URLS_TO_DISPLAY = 20;\n\ntype LoadModalProps = {\n  onLoad: (appProps: AppDataProps) => void;\n};\n\nconst ModalContainer = styled.div`\n  // Get the dropdown to size itself based on the webpage width, but resize itself to match the\n  // input area (~100vw - 100px of padding) when the webpage is very narrow\n  .ant-select-dropdown {\n    // TODO: Size to max-content so there isn't extra dead space past the end of the current items.\n    // Setting width to max-content directly causes the dropdown to collapse to a width of\n    // 0 pixels when more than 8 items are present and scrolling becomes enabled.\n    width: 100% !important;\n    max-width: calc(max(50vw, min(400px, 100vw - 100px)));\n  }\n`;\n\nexport default function LoadModal(props: LoadModalProps): ReactElement {\n  const [showModal, _setShowModal] = useState(false);\n  const [urlInput, setUrlInput] = useState(\"\");\n  const [errorText, setErrorText] = useState<string>(\"\");\n\n  const [recentDataUrls, addRecentDataUrl] = useRecentDataUrls();\n\n  const modalContainerRef = useRef<HTMLDivElement>(null);\n\n  const setShowModal = (show: boolean): void => {\n    if (show) {\n      setUrlInput(\"\");\n      setErrorText(\"\");\n    }\n    _setShowModal(show);\n  };\n\n  const onClickLoad = (): void => {\n    // TODO: Handle multiple URLs?\n\n    // Note: S3 URIs, GCS URIs, and Vast file paths are handled by vole-core.\n    const trimmedUrlInput = urlInput.trim();\n    if (!isValidUrl(trimmedUrlInput)) {\n      setErrorText(\"Please enter a valid URL, starting with https://, s3://, or gs://.\");\n      return;\n    }\n\n    const appProps: AppDataProps = {\n      imageUrl: trimmedUrlInput,\n      imageDownloadHref: trimmedUrlInput,\n      cellId: \"1\",\n      parentImageUrl: \"\",\n      parentImageDownloadHref: \"\",\n      // Enable first three channels by default\n      viewerChannelSettings: {\n        groups: [\n          {\n            name: \"Channels\",\n            channels: [\n              { match: [0, 1, 2], enabled: true },\n              { match: \"(.+)\", enabled: false },\n            ],\n          },\n        ],\n      },\n    };\n    props.onLoad(appProps);\n    addRecentDataUrl({ url: urlInput, label: urlInput });\n    setShowModal(false);\n  };\n\n  // Set up fuse for fuzzy searching on the labels of recent datasets\n  const fuse = useMemo(() => {\n    return new Fuse(recentDataUrls, {\n      keys: [\"label\"],\n      isCaseSensitive: false,\n      shouldSort: true, // sorts by match score\n      ignoreLocation: true, // search more than first 60 characters\n      findAllMatches: true, // return all matches\n    });\n  }, [recentDataUrls]);\n\n  // This search could be done using a transition if needed, but since there is a max of 100 urls,\n  // performance hits should be minimal.\n  const autoCompleteOptions: { label: React.ReactNode; value: string }[] = useMemo(() => {\n    let filteredItems: RecentDataUrl[] = [];\n    if (urlInput === \"\") {\n      // Show first 20 recent data urls\n      filteredItems = recentDataUrls.slice(0, MAX_RECENT_URLS_TO_DISPLAY);\n    } else {\n      // Show first 20 search results\n      filteredItems = fuse\n        .search(urlInput)\n        .slice(0, MAX_RECENT_URLS_TO_DISPLAY)\n        .map((option) => option.item);\n    }\n    return filteredItems.map((item) => {\n      return {\n        label: <MiddleTruncatedText text={item.label} />,\n        value: item.url,\n      };\n    });\n  }, [urlInput, fuse, recentDataUrls]);\n\n  const getAutoCompletePopupContainer = modalContainerRef.current ? () => modalContainerRef.current! : undefined;\n\n  return (\n    <ModalContainer ref={modalContainerRef}>\n      <Button type=\"link\" onClick={() => setShowModal(!showModal)}>\n        <UploadOutlined />\n        Load\n      </Button>\n      <Modal\n        open={showModal}\n        title={\"Load\"}\n        onCancel={() => setShowModal(false)}\n        getContainer={modalContainerRef.current || undefined}\n        okButtonProps={{}}\n        footer={\n          <Button type=\"default\" onClick={() => setShowModal(false)}>\n            Cancel\n          </Button>\n        }\n        destroyOnClose={true}\n      >\n        <p style={{ fontSize: \"16px\" }}>Provide the URL to load your OME-Zarr or OME-TIFF* data.</p>\n        <p style={{ fontSize: \"12px\" }}>\n          <i>*Note: this tool is intended for OME-Zarr use. Large {\"(> 100 MB)\"} OME-TIFF files are not supported.</i>\n        </p>\n        <FlexRow $gap={6}>\n          <AutoComplete\n            value={urlInput}\n            onChange={(value) => setUrlInput(value)}\n            onSelect={setUrlInput}\n            style={{ width: \"100%\" }}\n            allowClear={true}\n            options={autoCompleteOptions}\n            getPopupContainer={getAutoCompletePopupContainer}\n            placeholder=\"Enter a URL...\"\n            autoFocus={true}\n          ></AutoComplete>\n          <Button type=\"primary\" onClick={onClickLoad}>\n            Load\n          </Button>\n        </FlexRow>\n        {errorText !== \"\" && <p style={{ color: \"var(--color-text-error)\" }}>{errorText}</p>}\n      </Modal>\n    </ModalContainer>\n  );\n}\n"],"names":["IssueLink","_ref","bug","children","React","href","concat","target","rel","UNKNOWN_ERROR_DESCRIPTION","ERROR_TYPE_DESCRIPTIONS","_defineProperty","VolumeLoadErrorType","UNKNOWN","NOT_FOUND","TOO_LARGE","LOAD_DATA_FAILED","INVALID_METADATA","INVALID_MULTI_SOURCE_ZARR","getErrorTitle","error","_error$toString","Error","toString","call","_typeof","title","ErrorAlert","_ref2","errors","_ref2$firstErrorCount","firstErrorCount","afterClose","onSkipError","_React$useState2","_slicedToArray","showDetails","setShowDetails","_React$useState4","errorsSeenCount","setErrorsSeenCount","Array","isArray","errorMessage","Button","type","onClick","style","display","undefined","_ERROR_TYPE_DESCRIPTI2","description","getErrorDescription","skipErrorButton","length","count","RightOutlined","Alert","showIcon","className","message","closable","action","useErrorAlert","_React$useState6","errorList","setErrorList","seenErrors","useConstructor","Map","_React$useState8","errorCounts","setErrorCounts","addError","_seenErrors$get","errorTitle","console","errorSeenCount","get","prev","_toConsumableArray","set","slice","errCount","CONTROL_PANEL_CLOSE_WIDTH","CLIPPING_PANEL_HEIGHT_DEFAULT","CLIPPING_PANEL_HEIGHT_TALL","BACKGROUND_COLOR_DEFAULT","BOUNDING_BOX_COLOR_DEFAULT","AXIS_MARGIN_DEFAULT","SCALE_BAR_MARGIN_DEFAULT","LUT_MIN_PERCENTILE","LUT_MAX_PERCENTILE","LEVELS_SLIDER_DEFAULT","OTHER_CHANNEL_KEY","SINGLE_GROUP_CHANNEL_KEY","TFEDITOR_DEFAULT_COLOR","TFEDITOR_MAX_BIN","CACHE_MAX_SIZE","QUEUE_MAX_SIZE","QUEUE_MAX_LOW_PRIORITY_SIZE","AXIS_TO_LOADER_PRIORITY","t","PrefetchDirection","T_PLUS","z","Z_PLUS","y","Y_PLUS","x","X_PLUS","DTYPE_RANGE","int8","min","Math","pow","max","int16","int32","uint8","uint16","uint32","float32","float64","PRESET_COLORS_0","PRESET_COLOR_MAP","Object","freeze","colors","name","viewModeToDefaultCameraPosition","ViewMode","threeD","xy","xz","yz","viewModeToDefaultCameraUp","getDefaultCameraState","viewMode","arguments","position","up","fov","orthoScale","getDefaultViewerChannelSettings","groups","channels","match","enabled","getDefaultViewerState","renderMode","RenderMode","volumetric","imageType","ImageType","segmentedCell","showAxes","showBoundingBox","backgroundColor","boundingBoxColor","autorotate","maskAlpha","brightness","density","levels","interpolationEnabled","region","time","scene","cameraState","INIT_COLORS","getDefaultChannelColor","channelIndex","getDefaultChannelState","displayName","volumeEnabled","isosurfaceEnabled","colorizeEnabled","colorizeAlpha","isovalue","opacity","color","useControlPoints","ramp","controlPoints","plotMin","plotMax","keepIntensityRange","useRefWithSetter","setter","init","value","useRef","wrappedSetter","useCallback","newValue","current","constructor","QUEUE_KEY","StorageEntryType","MAX_ENTRIES","scenes","meta","sanitizeStorageKey","key","includes","encodeURIComponent","safeSetItem","window","localStorage","setItem","e","DOMException","setStorageItem","queue","removedItems","join","evictKey","shift","_step","_iterator","_createForOfIteratorHelper","s","n","done","_step$value","unshift","err","f","removedValue","getItem","push","removeItem","getStorageQueue","_window$localStorage$","_window$localStorage$2","split","setStorageQueue","writeStorage","entries","entryType","prevQueue","typePrefix","escapedEntries","mapKeys","_","index","thisTypeIndexes","filter","k","startsWith","_i","_Object$keys","keys","_step2","_iterator2","reverse","splice","entryList","firstKey","allEntriesFit","_i2","_Object$entries","_Object$entries$_i","entryFits","queueFit","writeMetadata","mapValues","metaVal","JSON","stringify","Meta","writeScenes","url","Scenes","readStoredMetadata","skipCacheUpdate","keySet","Set","result","map","globalKey","add","parse","size","has","apply","readStoredScenes","entryIndex","indexOf","removeUndefinedProperties","obj","removeMatchingProperties","isEqual","_createClass","FirebaseRequest","firestore","_this","_classCallCheck","docPath","doc","collection","then","snapShot","datasets","forEach","host","metadata","data","location","hostname","production","id","collectionRef","ref","manifestDoc","getManifest","featuresDataPath","thumbnailRoot","downloadRoot","volumeViewerDataRoot","featuresDisplayOrder","cellLineDataPath","fileInfoPath","featuresDataOrder","featureDefsPath","albumPath","_objectSpread","cellId","getDoc","CellId","FOVId","cellIds","Promise","all","this","datasetId","clamp","r","Symbol","iterator","o","toStringTag","i","c","prototype","Generator","u","create","_regeneratorDefine2","p","G","v","a","d","bind","l","TypeError","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","_OverloadYield","asyncGeneratorStep","resolve","_asyncToGenerator","_next","_throw","ownKeys","getOwnPropertySymbols","getOwnPropertyDescriptor","getOwnPropertyDescriptors","defineProperties","_arrayWithHoles","next","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_n","F","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","_nonIterableSpread","test","_defineProperties","_toPropertyKey","toPrimitive","String","_toPrimitive","ENCODED_COMMA_REGEX","ENCODED_COLON_REGEX","DEFAULT_CONTROL_POINT_COLOR","FLOAT_REGEX","CHANNEL_STATE_KEY_REGEX","LUT_REGEX","RAMP_REGEX","RegExp","source","SLICE_REGEX","REGION_REGEX","HEX_COLOR_REGEX","CONTROL_POINT_REGEX","HEX_COLOR_STR_REGEX","LEGACY_CONTROL_POINTS_REGEX","CONTROL_POINTS_REGEX","ViewerStateKeys","CameraTransformKeys","ViewerChannelSettingKeys","Color","Colorize","ColorizeAlpha","IsosurfaceAlpha","Lut","ControlPointsLegacy","ControlPoints","ControlPointsEnabled","RampLegacy","Ramp","VolumeEnabled","SurfaceEnabled","IsosurfaceValue","KeepRange","_ViewerStateKeys$View","View","_ViewerStateKeys$Mode","Mode","_ViewerStateKeys$Mask","Mask","_ViewerStateKeys$Imag","Image","_ViewerStateKeys$Axes","Axes","_ViewerStateKeys$Boun","BoundingBox","_ViewerStateKeys$Boun2","BoundingBoxColor","_ViewerStateKeys$Back","BackgroundColor","_ViewerStateKeys$Auto","Autorotate","_ViewerStateKeys$Brig","Brightness","_ViewerStateKeys$Dens","Density","_ViewerStateKeys$Leve","Levels","_ViewerStateKeys$Inte","Interpolation","_ViewerStateKeys$Regi","Region","_ViewerStateKeys$Slic","Slice","_ViewerStateKeys$Time","Time","_ViewerStateKeys$Scen","Scene","_ViewerStateKeys$Came","CameraState","ViewerStateParams","DataParams","DeprecatedParams","allowedParamKeys","isParamKey","isChannelKey","getAllowedParams","searchParams","getSearchParamRaw","search","param","foundKeyValue","find","keyValue","decodeURLUntilParseable","condition","_url","decoded","URL","canParse","nextDecoded","decodeURIComponent","_unused","parseImageURLParam","urlParam","sourceUrls","parseKeyValueList","pair","splitIndex","trim","objectToKeyValueList","keyValuePairs","escapedValue","replace","parseStringFloat","number","Number","parseFloat","isNaN","parseStringInt","parseInt","parseStringEnum","enumValues","defaultValue","values","parseStringBoolean","parseHexColorAsColorArray","hexColor","colorArrayToHex","padStart","toLowerCase","parseStringSlice","_region$split$map2","val","parseThreeNumberArray","stringArr","options","_options$min","_options$max","_options$separator","NEGATIVE_INFINITY","POSITIVE_INFINITY","separator","_stringArr$split$map2","parseStringRegion","_region$split$map3","axis","_axis$split$map2","_region$split$map4","formatFloat","maxPrecision","isInteger","toPrecision","perAxisToArray","perAxis","serializeBoolean","parseCameraState","cameraSettings","parsedCameraSettings","Position","Target","Up","OrthoScale","Infinity","Fov","parseControlPoints","cp","reduce","acc","_val","array","_parseStringFloat","_parseStringFloat2","_parseHexColorAsColor","_cp","sort","b","deserializeViewerState","params","view","viewParamToViewMode","Z","Y","X","toUpperCase","parseDeprecatedChannelSettings","ch","initialChannelSettings","channelsOn","numstr","luts","warn","parseChannelSettings","channelIndexToSettings","channelSetting","jsonState","surfaceEnabled","surfaceOpacity","controlPointsEnabled","col","lut","_jsonState$ViewerChan2","intensity","_jsonState$ViewerChan4","_jsonState$ViewerChan6","parsedResult","deserializeViewerChannelSetting","loadDataset","_x","_x2","_x3","_loadDataset","_regeneratorRuntime","mark","_callee","dataset","db","args","datasetMeta","_iterator3","_step3","innerDatasets","names","matchingName","datasetData","baseUrl","fileInfo","wrap","_context","getAvailableDatasets","sent","abrupt","t0","finish","selectDataset","manifest","imageDownloadHref","getFileInfoByCellId","imageUrl","volumeviewerPath","parentImageUrl","fovVolumeviewerPath","stop","loadFromManifest","_x4","_loadFromManifest","_callee2","manifestUrl","response","manifestJson","_context2","fetch","ok","status","statusText","json","t1","arr","every","item","isStringArray","parseViewerUrlParams","_x5","_x6","_parseViewerUrlParams","_callee3","viewerSettings","deprecatedChannelSettings","channelSettings","_yield$loadFromManife","manifestScenes","manifestMetadata","collectionid","msgorigin","urlParamFromStorage","firstScene","firstUrl","imageUrls","datasetArgs","_context3","URLSearchParams","viewerChannelSettings","parentImageDownloadHref","endsWith","addViewerParamsFromMessage","_message$scenes","newImageUrl","messageMeta","newMetadata","serializeViewerUrlParams","state","_state$channelSetting","removeDefaults","_state$maskAlpha","_state$brightness","_state$density","_state$levels","_state$time","_state$scene","_result","cameraString","serializeCameraState","viewModeToViewParam","serializeViewerState","channelParams","_channelSetting$isova","_channelSetting$opaci","_channelSetting$color","_channelSetting$ramp","_removeUndefinedPrope","serializeViewerChannelSetting","matchChannel","channelName","findFirstChannelMatchOfGroup","channel","g","findFirstChannelMatch","settings","getDisplayName","makeChannelIndexGrouping","grouping","channelsMatched","_step4","_iterator4","_loop","groupMatch","remainderGroupName","getEnabledChannelIndices","enabledChannels","initializeOneChannelSetting","defaultColor","_initSettings$enabled","_initSettings$surface","_initSettings$coloriz","_initSettings$coloriz2","_initSettings$isovalu","_initSettings$surface2","_colorHexToArray","_initSettings$color","_initSettings$control","_initSettings$keepInt","_initSettings$control2","_initSettings$ramp","_findFirstChannelMatc","hex","defaultChannelState","initSettings","exec","isRecord","VIEWER_SETTINGS_CHANGE_HANDLERS","pathTrace","willPathtrace","_ref3","validateStateValue","currentState","changeHandler","currentValue","validateState","newState","validated","_arr","assign","resetState","newChannelStates","isInDifferentViewMode","isAtDifferentTime","isAtDifferentZSlice","isAtDifferentScene","willNeedResetOnLoad","viewerState","channelState","channelsToReset","channelsToResetOnLoad","createResetSlice","savedViewerChannelSettings","useDefaultViewerChannelSettings","onResetChannel","resetToSavedViewerState","savedState","_savedState$viewMode","newViewerState","newChannelSettings","resetToDefaultViewerState","defaultViewerState","defaultChannelStates","defaultState","useViewerState","subscribeWithSelector","_len","etc","_key","changeViewerSetting","mergeViewerSettings","changeChannelSetting","replaceAllChannelSettings","applyColorPresets","selectViewerSettings","store","select","parseLutValue","histogram","firstChar","charAt","parsedValue","substring","maxBin","findBinOfPercentile","findFractionalBinOfValue","initializeLut","aimg","_initSettings$intensi3","_initSettings$intensi4","_parseLutFromSettings","visibleLut","getHistogram","defaultLut","hmin","hmax","createFromMinMax","getDefaultLut","channelNames","_initSettings$intensi","_initSettings$intensi2","lutValues","settingsLut","findAutoIJBins","isFinite","sortedLutValues","createFromControlPoints","parseLutFromSettings","getValueFromBinIndex","rampToControlPoints","setLut","controlPointsToRamp","activeAxisMap","colorObjectToArray","colorArrayToObject","colorArrayToFloats","colorArrayToString","REF_EQ","fireImmediately","DEEP_EQ","equalityFn","shallow","selectAxisClipUpdateInfo","subscribeImageToState","view3d","image","axisClipUpdater","_ref2$region","minval","maxval","axismin","axismax","imageInfo","volumeSize","setZSlice","floor","setAxisClip","unsubscribers","subscribe","setShowBoundingBox","setBoundingBoxColor","setMaxProjectMode","maxProject","setVolumeRenderMode","RENDERMODE_PATHTRACE","RENDERMODE_RAYMARCH","updateActiveChannels","updateMaskAlpha","updateDensity","_gammaSliderToImageVa","sliderValues","mid","scale","gammaSliderToImageValues","setGamma","setInterpolationEnabled","unsubscribe","PlayControls","_this$onPlayingAxisCh","playingAxis","onPlayingAxisChanged","_this$getVolumeIsLoad","playHolding","stepAxis","getVolumeIsLoaded","playTimeoutId","setTimeout","playStep","playWaitingForLoad","willResume","clearTimeout","setPlayingAxis","pause","SceneStore","context","paths","loaders","fill","_getLoader","loader","path","currentScene","rawArrayOptions","fileType","VolumeFileFormat","DATA","onOpen","createLoader","syncMultichannelLoading","syncChannels","setPrefetchPriority","prefetchPriority","_loadScene","loadSpec","_options$onCreateScen","spec","getLoader","loadSpecRequired","createImageInfo","onCreateScene","loadVolumeData","onChannelLoaded","_createVolume","createVolume","_x7","_x8","sync","currentLoader","priority","ImageLoadStatus","LoadType","useEffectEventRef","callback","callbackRef","useEffect","_ref$step","step","_ref$precision","precision","_ref$min","_ref$max","MAX_SAFE_INTEGER","_ref$disabled","disabled","_ref$className","onChange","hasFocus","_setHasFocus","_useRefWithSetter2","hasFocusRef","setHasFocus","textContent","setTextContent","inputRef","roundToPrecision","round","shouldChange","displayedValue","changeByStep","_inputRef$current","focus","fullClassName","onKeyDown","event","preventDefault","_inputRef$current2","blur","autoComplete","role","inputStr","inputNum","handleTyping","onFocus","onBlur","CaretUpOutlined","CaretDownOutlined","MemoedNouislider","Nouislider","_prevProps","noUpdate","props","setNoUpdate","wrapEventHandler","shouldNotUpdate","handler","onStart","onEnd","AXES","SliderRow","label","vals","_ref$valsReadout","valsReadout","onSlide","_ref$onChange","isRange","wrappedOnSlide","wrappedOnChange","SmarterSlider","connect","range","start","margin","behaviour","pips","mode","format","to","NumericInput","PlaySliderRow","_useState2","useState","valReadout","setValReadout","_useState4","sliderHeld","setSliderHeld","wrappedSetValReadout","_ref4","wrappedOnStart","wrappedOnEnd","updateWhileSliding","Tooltip","placement","trigger","onTogglePlayback","playing","icon","PauseOutlined","CaretRightOutlined","activeAxis","pauseOnInput","playControls","numSlices","numSlicesLoaded","handlePlayPause","willPlay","play","slices","updateSlice","startHold","endHold","updateRegion","numTimesteps","updateTime","numScenes","_ref6","axes","_extends","xmlns","width","height","viewBox","cx","cy","boundingBox","camera","closePanel","download","dropdownArrow","preferences","resetView","turnTable","STYLE","fontSize","newProps","Icon","component","ICONS","openProp","open","onOpenChange","openState","setOpenState","toggleDrawer","optionsButton","ViewerIcon","Drawer","getContainer","mask","view3dviewerRef","appendChild","getDOMElement","spinner","noImageText","appHeight","visibleControls","clippingPanelTall","STYLES","viewer","BottomPanel","clippingPanelOpen","onClippingPanelOpenChange","axisClipSliders","AxisClipSliders","loadingImage","noImage","LoadingOutlined","zIndex","removeAllVolumes","overflow","top","left","bottom","right","justifyContent","alignItems","DEFAULT_COLOR","isOpen","setIsOpen","openAboveSwatch","setOpenAboveSwatch","currentColor","setCurrentColor","swatchRef","popoverDirectionStyle","swatch","swatchRect","getBoundingClientRect","noRoomBelowSwatch","innerHeight","background","ele","popover","cover","SketchPicker","_props$onColorChange","rgb","onColorChange","idx","onChangeComplete","_props$onColorChangeC","onColorChangeComplete","disableAlpha","borderRadius","border","cursor","verticalAlign","INTEGER_FORMATTER","_props$min","hideSlider","tooltips","formatInteger","onUpdate","TfEditorSliderHandle","TF_GENERATORS","autoXF","histo","_histo$findAutoMinMax2","findAutoMinMax","auto2XF","_histo$findAutoIJBins2","auto98XF","bestFitXF","_histo$findBestFitBin2","findBestFitBins","resetXF","_histo","createFullRange","sliderHandleSymbol","draw","sqrt","triangleHeight","halfWidth","moveTo","lineTo","closePath","BASE_AREA","BASE_HEIGHT","SQRT2","BASE_MARGIN","isovalueHandleSymbol","linesArea","coverRangeWithPoint","point","createPointOnRangeBoundary","outOfRangePt","inRangePt","rangeRatio","ControlPointGradientDef","gradientUnits","spreadMethod","x2","offset","stopColor","stopOpacity","numberFormatter","toFixed","innerWidth","selectedPointIdx","setSelectedPointIdx","draggedPointIdx","_setDraggedPointIdx","_setCPs","setRamp","_useState6","draggedIsovalue","setDraggedIsovalue","controlPointsRef","setControlPoints","_useRefWithSetter4","draggedPointIdxRef","setDraggedPointIdx","_useState8","colorPickerPosition","setColorPickerPosition","lastColorRef","svgRef","channelData","typeRange","dtype","xScale","useMemo","d3","domain","yScale","mouseEventToPlotValues","_svgRef$current$getBo","_svgRef$current","svgRect","invert","clientX","clientY","handleDragEnd","Isosurface","currentTarget","releasePointerCapture","pointerId","handleControlPointContextMenu","cpRect","xPosition","yPosition","controlPointsToRender","points","firstPoint","lastPoint","outOfRangePoint","pop","fitControlPointsToRange","areaPath","_areaGenerator","y0","y1","curve","areaGenerator","sliderHandlePath","_d3$symbol$type$size","isovalueHandlePath","_d3$symbol$type$size2","xAxisRef","el","ticks","_xScale$domain2","tickValues","tickPadding","yAxisRef","histogramRef","numBins","getNumBins","plotMinU8","plotMaxU8","_getHistogramBinLengt","binLengths","binLength","getBin","getHistogramBinLengths","ceil","end","binLengthsToRender","barWidth","binScale","base","selectAll","attr","len","applyTFGenerator","generator","valueIndexedControlPoints","controlPointCircles","onPointerDown","onContextMenu","dragClass","useRamp","_props$channelData","rawMin","rawMax","InputNumber","formatter","controls","abs","newControlPoints","button","_mouseEventToPlotValu2","setPointerCapture","nativeEvent","onPointerMove","buttons","stopPropagation","_mouseEventToPlotValu4","draggedIdx","draggedPoint","bisector","idxLeft","idxRight","numPointsToRemove","newIdx","dragControlPoint","handle","Min","Max","dragSlider","onPointerUp","transform","strokeDasharray","strokeWidth","Dropdown","menu","items","_ref5","flexDirection","gap","padding","PushpinFilled","PushpinOutlined","Checkbox","checked","marginLeft","saveIsosurface","_ref8","controlsOpen","setControlsOpen","changeSettingForThisChannel","saveThisIsosurface","visibilityControls","rowClass","List","Item","avatar","ColorPicker","newRGB","_oldRGB","TfEditor","channelDataForChannel","fontStyle","indeterminate","checkedList","allOptions","checkAll","useSelectFromAllChannels","useShallow","channelGroupedByType","channelDataChannels","filterFunc","selectVolumeEnabled","selectIsosurfaceEnabled","selectNames","createCheckboxHandler","channelArray","showVolumes","showSurfaces","renderVisibilityControls","volChecked","isoChecked","SharedCheckBox","flex","renderChannelRow","ChannelsWidgetRow","rows","itemLayout","dataSource","renderItem","extra","Collapse","bordered","defaultActiveKey","collapsible","ColorPickerRow","colorPickerRow","colorPicker","borderBottom","marginRight","backgroundColorPicker","boundingBoxColorPicker","createSliderRow","propKey","_strValues","_handle","selectValue","showControls","paddingTop","paddingBottom","alphaMaskSlider","brightnessSlider","densitySlider","levelsSliders","interpolationControl","isCategory","entry","MetadataCategory","collapsed","setCollapsed","collapsedClass","colSpan","MetadataTable","topLevel","metadataKeys","metadataIsArray","metadataValue","cats","sortCategoriesFirst","ControlTab","ControlTabNames","Channels","Advanced","Metadata","showCustomize","dropDownMenuProps","tab","_setTab","controlPanelContainerRef","getDropdownContainer","hasImage","renderTab","thisTab","metadataViewer","colorPresetsDropdown","preset","onApplyColorPresets","getPopupContainer","ChannelsWidget","GlobalVolumeControls","imageName","pixelSize","CustomizeWidget","Flex","vertical","MetadataViewer","fovDownloadHref","cellDownloadHref","hasFov","viewModes","Radio","onViewModeChange","visuallyHiddenStyle","clip","whiteSpace","borderWidth","containerRef","barRef","leftRef","rightRef","centerRef","scrollMode","setScrollMode","showScrollBtnLeft","setScrollBtnLeft","showScrollBtnRight","setScrollBtnRight","checkScrollBtnVisible","barEl","scrollLeft","scrollWidth","clientWidth","checkSize","debounce","leftRect","centerRect","rightRect","addEventListener","removeEventListener","scrollX","amount","classForToggleBtn","active","twoDMode","renderGroup1","viewModeRadioButtons","resetCameraButton","autoRotateButton","renderGroup4","showAxesButton","showBoundingBoxButton","axesToggleTitle","boundingBoxToggleTitle","turntableToggleTitle","onWheel","deltaY","onScroll","ReloadOutlined","ViewModeRadioButtons","newMode","resetCamera","fovCellSwitchControls","hasCellId","hasParentImage","fullField","Select","popupClassName","Option","canPathTrace","DownloadButton","downloadScreenshot","version","channelStateSelector","useImageEffect","effect","deps","setVolumeChannelEnabled","updateLuts","setVolumeChannelOptions","currentImage","isosurfaceOpacity","gradient","binIndexedControlPointsToLut","createLabelColors","setColorPalette","setColorPaletteAlpha","Sider","Layout","Content","defaultVisibleControls","saveSurfaceButtons","defaultProps","rawData","rawDims","canvasMargin","view3dRef","showError","_props$showError","_props$viewerChannelS","_scenes$length","_scenes2","_image$imageInfo$volu","_image$imageInfo$subr","_image$imageInfo$time","_props$transform2","_props$transform4","resetToSavedState","prevViewerSettingsPropsRef","_prevViewerSettingsPr","_prevViewerSettingsPr2","lastValue","getState","View3d","_useErrorAlert2","errorAlert","_showError","setLoadErrorHandler","_vol","imageUrlRef","scenesRef","_props","_scenes","maskChannelName","channelRangesRef","removePreviousImage","onImageTitleChange","onCreateImage","newImage","_removePreviousImage$","_newImage$imageInfo$c","_channelState$i","channelColorMeta","channelColors","addVolume","_channelColorMeta$ind","unsubscribeView","setCameraMode","resize","setCameraState","setAutoRotate","setShowAxis","setBackgroundColor","updateExposure","subscribeViewToState","unsubscribeImage","loadedScene","setLoadedScene","onChangeScene","sceneIndex","isInitialLoad","_useViewerState$getSt3","thisChannel","getChannel","noLut","hasOldRange","canInitializeToExistingRange","_initializeLut","defaultIsovalue","onVolumeData","setVolumeChannelAsMask","isLoaded","onError","volume","scenePaths","onErrorRef","onChannelLoadedRef","onChangeSceneRef","onCreateImageRef","setImage","loadContext","VolumeLoaderContext","sceneLoader","isPlaying","_image$imageInfo","subregionSize","shouldDownlevel","updateRequiredData","scaleLevelBias","channelVersions","_setChannelVersions","channelVersionsRef","setChannelVersions","loadThrewError","setLoadThrewError","inInitialLoadRef","imageLoadStatus","ERROR","_channelVersions$redu","allLoaded","noneLoaded","setting","loaded","_channelVersions$redu2","REQUESTED","LOADED","LOADING","setIsLoading","loadType","SCENE","_onErrorRef$current","_useState10","setChannelGroupedByType","onChannelDataLoaded","_onChannelLoadedRef$c","newVersions","onImageLoaded","setChannelStateForNewImage","_channelSettings$inde","openImage","_onCreateImageRef$cur","requiredLoadSpec","requiredChannelsToLoad","_useViewerState$getSt2","maskChannelIndex","LoadSpec","times","subregion","Box3","Vector3","loadScene","setTime","TIME","setScene","useVolume","controlPanelClosed","setControlPanelClosed","hasAutoClosedControlPanel","setHasAutoClosedControlPanel","setClippingPanelOpen","clippingPanelOpenTimeout","saveChannelIsosurface","saveScreenshot","capture","dataUrl","anchor","document","createElement","click","metadataFormatter","imageMetadata","sceneMeta","_sceneMeta","propsMetadata","hasTime","hasScenes","mode3d","panelOpen","isMode3d","axisY","_SCALE_BAR_MARGIN_DEF","scaleBarX","scaleBarY","clippingPanelHeight","setShowTimestepIndicator","setAxisPosition","setTimestepIndicatorPosition","setScaleBarPosition","setIndicatorPositions","setShowScaleBar","onResizeDebounced","onControlPanelToggle","dispatchEvent","Event","_initializeLut2","_props$transform","setVolumeTranslation","translation","_props$transform3","setVolumeRotation","rotation","physicalPixelSize","toArray","StyleProvider","ChannelUpdater","defaultCollapsed","collapsedWidth","ControlPanel","Toolbar","hasWebGL2","CellViewerCanvasWrapper","PrimaryButton","SecondaryButton","styled","_templateObject","HelpDropdown","container","setContainer","showVersionModal","setShowVersionModal","Link","FlexRowAlignCenter","$gap","DropdownSVG","Modal","onCancel","footer","FlexColumnAlignCenter","VOLEAPP_VERSION","VOLECORE_VERSION","startCharacters","endCharacters","MiddleTruncatedTextContainer","div","_taggedTemplateLiteral","css","_templateObject2","$startChars","$endChars","MiddleTruncatedText","inputProps","startChars","endChars","text","startText","endText","ModalContainer","LoadModal","showModal","_setShowModal","urlInput","setUrlInput","errorText","setErrorText","_useRecentDataUrls2","_useLocalStorage2","useLocalStorage","storedRecentEntries","setRecentEntries","recentEntries","addRecentEntry","newEntry","datasetIndex","findIndex","MAX_RECENT_URLS","useRecentDataUrls","recentDataUrls","addRecentDataUrl","modalContainerRef","setShowModal","show","fuse","Fuse","isCaseSensitive","shouldSort","ignoreLocation","findAllMatches","autoCompleteOptions","option","getAutoCompletePopupContainer","UploadOutlined","okButtonProps","destroyOnClose","FlexRow","AutoComplete","onSelect","allowClear","placeholder","autoFocus","trimmedUrlInput","isValidUrl","appProps","onLoad"],"sourceRoot":""}